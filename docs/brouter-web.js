!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(e.document)return t(e);throw new Error("jQuery requires a window with a document")}:t(e)}("undefined"!=typeof window?window:this,function(w,R){"use strict";function v(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item}function g(e){return null!=e&&e===e.window}var t=[],M=Object.getPrototypeOf,a=t.slice,I=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},W=t.push,F=t.indexOf,$={},B=$.toString,_=$.hasOwnProperty,z=_.toString,U=z.call(Object),y={},T=w.document,X={type:!0,src:!0,nonce:!0,noModule:!0};function V(e,t,n){var r,i,o=(n=n||T).createElement("script");if(o.text=e,t)for(r in X)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function h(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?$[B.call(e)]||"object":typeof e}var e="3.6.4",C=function(e,t){return new C.fn.init(e,t)};function G(e){var t=!!e&&"length"in e&&e.length,n=h(e);return!v(e)&&!g(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}C.fn=C.prototype={jquery:e,constructor:C,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){e=C.merge(this.constructor(),e);return e.prevObject=this,e},each:function(e){return C.each(this,e)},map:function(n){return this.pushStack(C.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(C.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(C.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,e=+e+(e<0?t:0);return this.pushStack(0<=e&&e<t?[this[e]]:[])},end:function(){return this.prevObject||this.constructor()},push:W,sort:t.sort,splice:t.splice},C.extend=C.fn.extend=function(){var e,t,n,r,i,o=arguments[0]||{},s=1,a=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"==typeof o||v(o)||(o={}),s===a&&(o=this,s--);s<a;s++)if(null!=(e=arguments[s]))for(t in e)n=e[t],"__proto__"!==t&&o!==n&&(u&&n&&(C.isPlainObject(n)||(r=Array.isArray(n)))?(i=o[t],i=r&&!Array.isArray(i)?[]:r||C.isPlainObject(i)?i:{},r=!1,o[t]=C.extend(u,i,n)):void 0!==n&&(o[t]=n));return o},C.extend({expando:"jQuery"+(e+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){return!(!e||"[object Object]"!==B.call(e)||(e=M(e))&&("function"!=typeof(e=_.call(e,"constructor")&&e.constructor)||z.call(e)!==U))},isEmptyObject:function(e){for(var t in e)return!1;return!0},globalEval:function(e,t,n){V(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(G(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){t=t||[];return null!=e&&(G(Object(e))?C.merge(t,"string"==typeof e?[e]:e):W.call(t,e)),t},inArray:function(e,t,n){return null==t?-1:F.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,s=!n;i<o;i++)!t(e[i],i)!=s&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,s=[];if(G(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&s.push(i);return I(s)},guid:1,support:y}),"function"==typeof Symbol&&(C.fn[Symbol.iterator]=t[Symbol.iterator]),C.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){$["[object "+t+"]"]=t.toLowerCase()});function r(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&C(e).is(n))break;r.push(e)}return r}function Y(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}var e=function(R){function f(e,t){return e="0x"+e.slice(1)-65536,t||(e<0?String.fromCharCode(65536+e):String.fromCharCode(e>>10|55296,1023&e|56320))}function M(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}function I(){T()}var e,p,b,o,W,d,F,$,w,u,l,T,C,n,E,h,r,i,g,S="sizzle"+ +new Date,c=R.document,k=0,B=0,_=q(),z=q(),U=q(),y=q(),X=function(e,t){return e===t&&(l=!0),0},V={}.hasOwnProperty,t=[],G=t.pop,Y=t.push,A=t.push,Q=t.slice,v=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",s="[\\x20\\t\\r\\n\\f]",a="(?:\\\\[\\da-fA-F]{1,6}"+s+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",K="\\["+s+"*("+a+")(?:"+s+"*([*^$|!~]?=)"+s+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+a+"))|)"+s+"*\\]",Z=":("+a+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+K+")*)|.*)\\)|)",ee=new RegExp(s+"+","g"),m=new RegExp("^"+s+"+|((?:^|[^\\\\])(?:\\\\.)*)"+s+"+$","g"),te=new RegExp("^"+s+"*,"+s+"*"),ne=new RegExp("^"+s+"*([>+~]|"+s+")"+s+"*"),re=new RegExp(s+"|>"),ie=new RegExp(Z),oe=new RegExp("^"+a+"$"),x={ID:new RegExp("^#("+a+")"),CLASS:new RegExp("^\\.("+a+")"),TAG:new RegExp("^("+a+"|[*])"),ATTR:new RegExp("^"+K),PSEUDO:new RegExp("^"+Z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+s+"*(even|odd|(([+-]|)(\\d*)n|)"+s+"*(?:([+-]|)"+s+"*(\\d+)|))"+s+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+s+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+s+"*((?:-\\d)?\\d*)"+s+"*\\)|)(?=[^-]|$)","i")},se=/HTML$/i,ae=/^(?:input|select|textarea|button)$/i,ue=/^h\d$/i,N=/^[^{]+\{\s*\[native \w/,le=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ce=/[+~]/,j=new RegExp("\\\\[\\da-fA-F]{1,6}"+s+"?|\\\\([^\\r\\n\\f])","g"),fe=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,pe=ve(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{A.apply(t=Q.call(c.childNodes),c.childNodes),t[c.childNodes.length].nodeType}catch(e){A={apply:t.length?function(e,t){Y.apply(e,Q.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function D(t,e,n,r){var i,o,s,a,u,l,c=e&&e.ownerDocument,f=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==f&&9!==f&&11!==f)return n;if(!r&&(T(e),e=e||C,E)){if(11!==f&&(a=le.exec(t)))if(i=a[1]){if(9===f){if(!(l=e.getElementById(i)))return n;if(l.id===i)return n.push(l),n}else if(c&&(l=c.getElementById(i))&&g(e,l)&&l.id===i)return n.push(l),n}else{if(a[2])return A.apply(n,e.getElementsByTagName(t)),n;if((i=a[3])&&p.getElementsByClassName&&e.getElementsByClassName)return A.apply(n,e.getElementsByClassName(i)),n}if(p.qsa&&!y[t+" "]&&(!h||!h.test(t))&&(1!==f||"object"!==e.nodeName.toLowerCase())){if(l=t,c=e,1===f&&(re.test(t)||ne.test(t))){for((c=ce.test(t)&&ye(e.parentNode)||e)===e&&p.scope||((s=e.getAttribute("id"))?s=s.replace(fe,M):e.setAttribute("id",s=S)),o=(u=d(t)).length;o--;)u[o]=(s?"#"+s:":scope")+" "+P(u[o]);l=u.join(",")}try{return A.apply(n,c.querySelectorAll(l)),n}catch(e){y(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return $(t.replace(m,"$1"),e,n,r)}function q(){var n=[];function r(e,t){return n.push(e+" ")>b.cacheLength&&delete r[n.shift()],r[e+" "]=t}return r}function L(e){return e[S]=!0,e}function H(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t)}}function de(e,t){for(var n=e.split("|"),r=n.length;r--;)b.attrHandle[n[r]]=t}function he(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&pe(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function O(s){return L(function(o){return o=+o,L(function(e,t){for(var n,r=s([],e.length,o),i=r.length;i--;)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in p=D.support={},W=D.isXML=function(e){var t=e&&e.namespaceURI,e=e&&(e.ownerDocument||e).documentElement;return!se.test(t||e&&e.nodeName||"HTML")},T=D.setDocument=function(e){var e=e?e.ownerDocument||e:c;return e!=C&&9===e.nodeType&&e.documentElement&&(n=(C=e).documentElement,E=!W(C),c!=C&&(e=C.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",I,!1):e.attachEvent&&e.attachEvent("onunload",I)),p.scope=H(function(e){return n.appendChild(e).appendChild(C.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),p.cssHas=H(function(){try{C.querySelector(":has(*,:jqfake)")}catch(e){return 1}}),p.attributes=H(function(e){return e.className="i",!e.getAttribute("className")}),p.getElementsByTagName=H(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),p.getElementsByClassName=N.test(C.getElementsByClassName),p.getById=H(function(e){return n.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),p.getById?(b.filter.ID=function(e){var t=e.replace(j,f);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if(void 0!==t.getElementById&&E)return(t=t.getElementById(e))?[t]:[]}):(b.filter.ID=function(e){var t=e.replace(j,f);return function(e){e=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return e&&e.value===t}},b.find.ID=function(e,t){if(void 0!==t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=p.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):p.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;n=o[i++];)1===n.nodeType&&r.push(n);return r},b.find.CLASS=p.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&E)return t.getElementsByClassName(e)},r=[],h=[],(p.qsa=N.test(C.querySelectorAll))&&(H(function(e){var t;n.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&h.push("[*^$]="+s+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||h.push("\\["+s+"*(?:value|"+J+")"),e.querySelectorAll("[id~="+S+"-]").length||h.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||h.push("\\["+s+"*name"+s+"*="+s+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||h.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||h.push(".#.+[+~]"),e.querySelectorAll("\\\f"),h.push("[\\r\\n\\f]")}),H(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&h.push("name"+s+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&h.push(":enabled",":disabled"),n.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&h.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),h.push(",.*:")})),(p.matchesSelector=N.test(i=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.oMatchesSelector||n.msMatchesSelector))&&H(function(e){p.disconnectedMatch=i.call(e,"*"),i.call(e,"[s!='']:x"),r.push("!=",Z)}),p.cssHas||h.push(":has"),h=h.length&&new RegExp(h.join("|")),r=r.length&&new RegExp(r.join("|")),e=N.test(n.compareDocumentPosition),g=e||N.test(n.contains)?function(e,t){var n=9===e.nodeType&&e.documentElement||e,t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(n.contains?n.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},X=e?function(e,t){var n;return e===t?(l=!0,0):(n=!e.compareDocumentPosition-!t.compareDocumentPosition)||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!p.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==c&&g(c,e)?-1:t==C||t.ownerDocument==c&&g(c,t)?1:u?v(u,e)-v(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?v(u,e)-v(u,t):0;if(i===o)return he(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?he(s[r],a[r]):s[r]==c?-1:a[r]==c?1:0}),C},D.matches=function(e,t){return D(e,null,null,t)},D.matchesSelector=function(e,t){if(T(e),p.matchesSelector&&E&&!y[t+" "]&&(!r||!r.test(t))&&(!h||!h.test(t)))try{var n=i.call(e,t);if(n||p.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){y(t,!0)}return 0<D(t,C,null,[e]).length},D.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),g(e,t)},D.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],n=n&&V.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==n?n:p.attributes||!E?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},D.escape=function(e){return(e+"").replace(fe,M)},D.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},D.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!p.detectDuplicates,u=!p.sortStable&&e.slice(0),e.sort(X),l){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return u=null,e},o=D.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=o(t);return n},(b=D.selectors={cacheLength:50,createPseudo:L,match:x,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(j,f),e[3]=(e[3]||e[4]||e[5]||"").replace(j,f),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||D.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&D.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return x.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ie.test(n)&&(t=(t=d(n,!0))&&n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(j,f).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=_[e+" "];return t||(t=new RegExp("(^|"+s+")"+e+"("+s+"|$)"))&&_(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(t,n,r){return function(e){e=D.attr(e,t);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e.replace(ee," ")+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(h,e,t,g,y){var m="nth"!==h.slice(0,3),v="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===y?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,s,a,u,l=m!=v?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(m){for(;l;){for(s=e;s=s[l];)if(x?s.nodeName.toLowerCase()===f:1===s.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[v?c.firstChild:c.lastChild],v&&p){for(d=(a=(r=(i=(o=(s=c)[S]||(s[S]={}))[s.uniqueID]||(o[s.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],s=a&&c.childNodes[a];s=++a&&s&&s[l]||(d=a=0,u.pop());)if(1===s.nodeType&&++d&&s===e){i[h]=[k,a,d];break}}else if(!1===(d=p?a=(r=(i=(o=(s=e)[S]||(s[S]={}))[s.uniqueID]||(o[s.uniqueID]={}))[h]||[])[0]===k&&r[1]:d))for(;(s=++a&&s&&s[l]||(d=a=0,u.pop()))&&((x?s.nodeName.toLowerCase()!==f:1!==s.nodeType)||!++d||(p&&((i=(o=s[S]||(s[S]={}))[s.uniqueID]||(o[s.uniqueID]={}))[h]=[k,d]),s!==e)););return(d-=y)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,s=b.pseudos[e]||b.setFilters[e.toLowerCase()]||D.error("unsupported pseudo: "+e);return s[S]?s(o):1<s.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?L(function(e,t){for(var n,r=s(e,o),i=r.length;i--;)e[n=v(e,r[i])]=!(t[n]=r[i])}):function(e){return s(e,0,t)}):s}},pseudos:{not:L(function(e){var r=[],i=[],a=F(e.replace(m,"$1"));return a[S]?L(function(e,t,n,r){for(var i,o=a(e,null,r,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(t[s]=i))}):function(e,t,n){return r[0]=e,a(r,null,n,i),r[0]=null,!i.pop()}}),has:L(function(t){return function(e){return 0<D(t,e).length}}),contains:L(function(t){return t=t.replace(j,f),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:L(function(n){return oe.test(n||"")||D.error("unsupported lang: "+n),n=n.replace(j,f).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=R.location&&R.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===n},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return ue.test(e.nodeName)},input:function(e){return ae.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:O(function(){return[0]}),last:O(function(e,t){return[t-1]}),eq:O(function(e,t,n){return[n<0?n+t:n]}),even:O(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:O(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:O(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:O(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=function(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}(e);function me(){}function P(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ve(s,e,t){var a=e.dir,u=e.next,l=u||a,c=t&&"parentNode"===l,f=B++;return e.first?function(e,t,n){for(;e=e[a];)if(1===e.nodeType||c)return s(e,t,n);return!1}:function(e,t,n){var r,i,o=[k,f];if(n){for(;e=e[a];)if((1===e.nodeType||c)&&s(e,t,n))return!0}else for(;e=e[a];)if(1===e.nodeType||c)if(i=(i=e[S]||(e[S]={}))[e.uniqueID]||(i[e.uniqueID]={}),u&&u===e.nodeName.toLowerCase())e=e[a]||e;else{if((r=i[l])&&r[0]===k&&r[1]===f)return o[2]=r[2];if((i[l]=o)[2]=s(e,t,n))return!0}return!1}}function xe(i){return 1<i.length?function(e,t,n){for(var r=i.length;r--;)if(!i[r](e,t,n))return!1;return!0}:i[0]}function be(e,t,n,r,i){for(var o,s=[],a=0,u=e.length,l=null!=t;a<u;a++)!(o=e[a])||n&&!n(o,r,i)||(s.push(o),l&&t.push(a));return s}function we(d,h,g,y,m,e){return y&&!y[S]&&(y=we(y)),m&&!m[S]&&(m=we(m,e)),L(function(e,t,n,r){var i,o,s,a=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)D(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:be(c,a,d,n,r),p=g?m||(e?d:l||y)?[]:t:f;if(g&&g(f,p,n,r),y)for(i=be(p,u),y(i,[],n,r),o=i.length;o--;)(s=i[o])&&(p[u[o]]=!(f[u[o]]=s));if(e){if(m||d){if(m){for(i=[],o=p.length;o--;)(s=p[o])&&i.push(f[o]=s);m(null,p=[],i,r)}for(o=p.length;o--;)(s=p[o])&&-1<(i=m?v(e,s):a[o])&&(e[i]=!(t[i]=s))}}else p=be(p===t?p.splice(l,p.length):p),m?m(null,t,p,r):A.apply(t,p)})}function Te(y,m){function e(e,t,n,r,i){var o,s,a,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){for(s=0,t||o.ownerDocument==C||(T(o),n=!E);a=y[s++];)if(a(o,t||C,n)){r.push(o);break}i&&(k=h)}v&&((o=!a&&o)&&u--,e)&&c.push(o)}if(u+=l,v&&l!==u){for(s=0;a=m[s++];)a(c,f,t,n);if(e){if(0<u)for(;l--;)c[l]||f[l]||(f[l]=G.call(r));f=be(f)}A.apply(r,f),i&&!e&&0<f.length&&1<u+m.length&&D.uniqueSort(r)}return i&&(k=h,w=p),c}var v=0<m.length,x=0<y.length;return v?L(e):e}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,d=D.tokenize=function(e,t){var n,r,i,o,s,a,u,l=z[e+" "];if(l)return t?0:l.slice(0);for(s=e,a=[],u=b.preFilter;s;){for(o in n&&!(r=te.exec(s))||(r&&(s=s.slice(r[0].length)||s),a.push(i=[])),n=!1,(r=ne.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(m," ")}),s=s.slice(n.length)),b.filter)!(r=x[o].exec(s))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?D.error(e):z(e,a).slice(0)},F=D.compile=function(e,t){var n,r=[],i=[],o=U[e+" "];if(!o){for(n=(t=t||d(e)).length;n--;)((o=function e(t){for(var r,n,i,o=t.length,s=b.relative[t[0].type],a=s||b.relative[" "],u=s?1:0,l=ve(function(e){return e===r},a,!0),c=ve(function(e){return-1<v(r,e)},a,!0),f=[function(e,t,n){return e=!s&&(n||t!==w)||((r=t).nodeType?l:c)(e,t,n),r=null,e}];u<o;u++)if(n=b.relative[t[u].type])f=[ve(xe(f),n)];else{if((n=b.filter[t[u].type].apply(null,t[u].matches))[S]){for(i=++u;i<o&&!b.relative[t[i].type];i++);return we(1<u&&xe(f),1<u&&P(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(m,"$1"),n,u<i&&e(t.slice(u,i)),i<o&&e(t=t.slice(i)),i<o&&P(t))}f.push(n)}return xe(f)}(t[n]))[S]?r:i).push(o);(o=U(e,Te(i,r))).selector=e}return o},$=D.select=function(e,t,n,r){var i,o,s,a,u,l="function"==typeof e&&e,c=!r&&d(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(s=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(s.matches[0].replace(j,f),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=x.needsContext.test(e)?0:o.length;i--&&(s=o[i],!b.relative[a=s.type]);)if((u=b.find[a])&&(r=u(s.matches[0].replace(j,f),ce.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),e=r.length&&P(o))break;return A.apply(n,r),n}}return(l||F(e,c))(r,t,!E,n,!t||ce.test(e)&&ye(t.parentNode)||t),n},p.sortStable=S.split("").sort(X).join("")===S,p.detectDuplicates=!!l,T(),p.sortDetached=H(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),H(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||de("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),p.attributes&&H(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||de("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),H(function(e){return null==e.getAttribute("disabled")})||de(J,function(e,t,n){if(!n)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),D}(w),Q=(C.find=e,C.expr=e.selectors,C.expr[":"]=C.expr.pseudos,C.uniqueSort=C.unique=e.uniqueSort,C.text=e.getText,C.isXMLDoc=e.isXML,C.contains=e.contains,C.escapeSelector=e.escape,C.expr.match.needsContext);function u(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var J=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function K(e,n,r){return v(n)?C.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?C.grep(e,function(e){return e===n!==r}):"string"!=typeof n?C.grep(e,function(e){return-1<F.call(n,e)!==r}):C.filter(n,e,r)}C.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?C.find.matchesSelector(r,e)?[r]:[]:C.find.matches(e,C.grep(t,function(e){return 1===e.nodeType}))},C.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(C(e).filter(function(){for(t=0;t<r;t++)if(C.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)C.find(e,i[t],n);return 1<r?C.uniqueSort(n):n},filter:function(e){return this.pushStack(K(this,e||[],!1))},not:function(e){return this.pushStack(K(this,e||[],!0))},is:function(e){return!!K(this,"string"==typeof e&&Q.test(e)?C(e):e||[],!1).length}});var Z,ee=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,te=((C.fn.init=function(e,t,n){if(e){if(n=n||Z,"string"!=typeof e)return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(C):C.makeArray(e,this);if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:ee.exec(e))||!r[1]&&t)return(!t||t.jquery?t||n:this.constructor(t)).find(e);if(r[1]){if(t=t instanceof C?t[0]:t,C.merge(this,C.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:T,!0)),J.test(r[1])&&C.isPlainObject(t))for(var r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r])}else(n=T.getElementById(r[2]))&&(this[0]=n,this.length=1)}return this}).prototype=C.fn,Z=C(T),/^(?:parents|prev(?:Until|All))/),ne={children:!0,contents:!0,next:!0,prev:!0};function re(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}C.fn.extend({has:function(e){var t=C(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(C.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],s="string"!=typeof e&&C(e);if(!Q.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?-1<s.index(n):1===n.nodeType&&C.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?C.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?F.call(C(e),this[0]):F.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(C.uniqueSort(C.merge(this.get(),C(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),C.each({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return r(e,"parentNode")},parentsUntil:function(e,t,n){return r(e,"parentNode",n)},next:function(e){return re(e,"nextSibling")},prev:function(e){return re(e,"previousSibling")},nextAll:function(e){return r(e,"nextSibling")},prevAll:function(e){return r(e,"previousSibling")},nextUntil:function(e,t,n){return r(e,"nextSibling",n)},prevUntil:function(e,t,n){return r(e,"previousSibling",n)},siblings:function(e){return Y((e.parentNode||{}).firstChild,e)},children:function(e){return Y(e.firstChild)},contents:function(e){return null!=e.contentDocument&&M(e.contentDocument)?e.contentDocument:(u(e,"template")&&(e=e.content||e),C.merge([],e.childNodes))}},function(r,i){C.fn[r]=function(e,t){var n=C.map(this,i,e);return(t="Until"!==r.slice(-5)?e:t)&&"string"==typeof t&&(n=C.filter(t,n)),1<this.length&&(ne[r]||C.uniqueSort(n),te.test(r))&&n.reverse(),this.pushStack(n)}});var E=/[^\x20\t\r\n\f]+/g;function c(e){return e}function ie(e){throw e}function oe(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}C.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},C.each(e.match(E)||[],function(e,t){n[t]=!0}),n):C.extend({},r);function i(){for(a=a||r.once,s=o=!0;l.length;c=-1)for(t=l.shift();++c<u.length;)!1===u[c].apply(t[0],t[1])&&r.stopOnFalse&&(c=u.length,t=!1);r.memory||(t=!1),o=!1,a&&(u=t?[]:"")}var o,t,s,a,u=[],l=[],c=-1,f={add:function(){return u&&(t&&!o&&(c=u.length-1,l.push(t)),function n(e){C.each(e,function(e,t){v(t)?r.unique&&f.has(t)||u.push(t):t&&t.length&&"string"!==h(t)&&n(t)})}(arguments),t)&&!o&&i(),this},remove:function(){return C.each(arguments,function(e,t){for(var n;-1<(n=C.inArray(t,u,n));)u.splice(n,1),n<=c&&c--}),this},has:function(e){return e?-1<C.inArray(e,u):0<u.length},empty:function(){return u=u&&[],this},disable:function(){return a=l=[],u=t="",this},disabled:function(){return!u},lock:function(){return a=l=[],t||o||(u=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],l.push(t),o)||i(),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!s}};return f},C.extend({Deferred:function(e){var o=[["notify","progress",C.Callbacks("memory"),C.Callbacks("memory"),2],["resolve","done",C.Callbacks("once memory"),C.Callbacks("once memory"),0,"resolved"],["reject","fail",C.Callbacks("once memory"),C.Callbacks("once memory"),1,"rejected"]],i="pending",s={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},catch:function(e){return s.then(null,e)},pipe:function(){var i=arguments;return C.Deferred(function(r){C.each(o,function(e,t){var n=v(i[t[4]])&&i[t[4]];a[t[1]](function(){var e=n&&n.apply(this,arguments);e&&v(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,s,a){return function(){function e(){var e,t;if(!(i<u)){if((e=s.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,v(t)?a?t.call(e,l(u,o,c,a),l(u,o,ie,a)):(u++,t.call(e,l(u,o,c,a),l(u,o,ie,a),l(u,o,c,o.notifyWith))):(s!==c&&(n=void 0,r=[e]),(a||o.resolveWith)(n,r))}}var n=this,r=arguments,t=a?e:function(){try{e()}catch(e){C.Deferred.exceptionHook&&C.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(s!==ie&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(C.Deferred.getStackHook&&(t.stackTrace=C.Deferred.getStackHook()),w.setTimeout(t))}}return C.Deferred(function(e){o[0][3].add(l(0,e,v(r)?r:c,e.notifyWith)),o[1][3].add(l(0,e,v(t)?t:c)),o[2][3].add(l(0,e,v(n)?n:ie))}).promise()},promise:function(e){return null!=e?C.extend(e,s):s}},a={};return C.each(o,function(e,t){var n=t[2],r=t[5];s[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),a[t[0]]=function(){return a[t[0]+"With"](this===a?void 0:this,arguments),this},a[t[0]+"With"]=n.fireWith}),s.promise(a),e&&e.call(a,a),a},when:function(e){function t(t){return function(e){i[t]=this,o[t]=1<arguments.length?a.call(arguments):e,--n||s.resolveWith(i,o)}}var n=arguments.length,r=n,i=Array(r),o=a.call(arguments),s=C.Deferred();if(n<=1&&(oe(e,s.done(t(r)).resolve,s.reject,!n),"pending"===s.state()||v(o[r]&&o[r].then)))return s.then();for(;r--;)oe(o[r],t(r),s.reject);return s.promise()}});var se=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/,ae=(C.Deferred.exceptionHook=function(e,t){w.console&&w.console.warn&&e&&se.test(e.name)&&w.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},C.readyException=function(e){w.setTimeout(function(){throw e})},C.Deferred());function ue(){T.removeEventListener("DOMContentLoaded",ue),w.removeEventListener("load",ue),C.ready()}C.fn.ready=function(e){return ae.then(e).catch(function(e){C.readyException(e)}),this},C.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--C.readyWait:C.isReady)||(C.isReady=!0)!==e&&0<--C.readyWait||ae.resolveWith(T,[C])}}),C.ready.then=ae.then,"complete"===T.readyState||"loading"!==T.readyState&&!T.documentElement.doScroll?w.setTimeout(C.ready):(T.addEventListener("DOMContentLoaded",ue),w.addEventListener("load",ue));function f(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===h(n))for(a in i=!0,n)f(e,t,a,n[a],!0,o,s);else if(void 0!==r&&(i=!0,v(r)||(s=!0),t=l?s?(t.call(e,r),null):(l=t,function(e,t,n){return l.call(C(e),n)}):t))for(;a<u;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o}var le=/^-ms-/,ce=/-([a-z])/g;function fe(e,t){return t.toUpperCase()}function x(e){return e.replace(le,"ms-").replace(ce,fe)}function m(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function pe(){this.expando=C.expando+pe.uid++}pe.uid=1,pe.prototype={cache:function(e){var t=e[this.expando];return t||(t={},m(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[x(t)]=n;else for(r in t)i[x(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][x(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(x):(t=x(t))in r?[t]:t.match(E)||[]).length;for(;n--;)delete r[t[n]]}void 0!==t&&!C.isEmptyObject(r)||(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){e=e[this.expando];return void 0!==e&&!C.isEmptyObject(e)}};var b=new pe,l=new pe,de=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,he=/[A-Z]/g;function ge(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(he,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:de.test(i)?JSON.parse(i):i)}catch(e){}l.set(e,t,n)}else n=void 0;return n}C.extend({hasData:function(e){return l.hasData(e)||b.hasData(e)},data:function(e,t,n){return l.access(e,t,n)},removeData:function(e,t){l.remove(e,t)},_data:function(e,t,n){return b.access(e,t,n)},_removeData:function(e,t){b.remove(e,t)}}),C.fn.extend({data:function(n,e){var t,r,i,o=this[0],s=o&&o.attributes;if(void 0!==n)return"object"==typeof n?this.each(function(){l.set(this,n)}):f(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=l.get(o,n))||void 0!==(t=ge(o,n))?t:void 0;this.each(function(){l.set(this,n,e)})},null,e,1<arguments.length,null,!0);if(this.length&&(i=l.get(o),1===o.nodeType)&&!b.get(o,"hasDataAttrs")){for(t=s.length;t--;)s[t]&&0===(r=s[t].name).indexOf("data-")&&(r=x(r.slice(5)),ge(o,r,i[r]));b.set(o,"hasDataAttrs",!0)}return i},removeData:function(e){return this.each(function(){l.remove(this,e)})}}),C.extend({queue:function(e,t,n){var r;if(e)return r=b.get(e,t=(t||"fx")+"queue"),n&&(!r||Array.isArray(n)?r=b.access(e,t,C.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=C.queue(e,t),r=n.length,i=n.shift(),o=C._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){C.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return b.get(e,n)||b.access(e,n,{empty:C.Callbacks("once memory").add(function(){b.remove(e,[t+"queue",n])})})}}),C.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?C.queue(this[0],t):void 0===n?this:this.each(function(){var e=C.queue(this,t,n);C._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&C.dequeue(this,t)})},dequeue:function(e){return this.each(function(){C.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--i||o.resolveWith(s,[s])}var r,i=1,o=C.Deferred(),s=this,a=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(r=b.get(s[a],e+"queueHooks"))&&r.empty&&(i++,r.empty.add(n));return n(),o.promise(t)}});function ye(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&k(e)&&"none"===C.css(e,"display")}var e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,me=new RegExp("^(?:([+-])=|)("+e+")([a-z%]*)$","i"),p=["Top","Right","Bottom","Left"],S=T.documentElement,k=function(e){return C.contains(e.ownerDocument,e)},ve={composed:!0};S.getRootNode&&(k=function(e){return C.contains(e.ownerDocument,e)||e.getRootNode(ve)===e.ownerDocument});function xe(e,t,n,r){var i,o,s=20,a=r?function(){return r.cur()}:function(){return C.css(e,t,"")},u=a(),l=n&&n[3]||(C.cssNumber[t]?"":"px"),c=e.nodeType&&(C.cssNumber[t]||"px"!==l&&+u)&&me.exec(C.css(e,t));if(c&&c[3]!==l){for(l=l||c[3],c=+(u/=2)||1;s--;)C.style(e,t,c+l),(1-o)*(1-(o=a()/u||.5))<=0&&(s=0),c/=o;C.style(e,t,(c*=2)+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r)&&(r.unit=l,r.start=c,r.end=i),i}var be={};function A(e,t){for(var n,r,i,o,s,a=[],u=0,l=e.length;u<l;u++)(r=e[u]).style&&(n=r.style.display,t?("none"===n&&(a[u]=b.get(r,"display")||null,a[u]||(r.style.display="")),""===r.style.display&&ye(r)&&(a[u]=(s=o=void 0,o=(i=r).ownerDocument,i=i.nodeName,(s=be[i])||(o=o.body.appendChild(o.createElement(i)),s=C.css(o,"display"),o.parentNode.removeChild(o),be[i]=s="none"===s?"block":s),s))):"none"!==n&&(a[u]="none",b.set(r,"display",n)));for(u=0;u<l;u++)null!=a[u]&&(e[u].style.display=a[u]);return e}C.fn.extend({show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ye(this)?C(this).show():C(this).hide()})}});var we=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i,N=(L=T.createDocumentFragment().appendChild(T.createElement("div")),(o=T.createElement("input")).setAttribute("type","radio"),o.setAttribute("checked","checked"),o.setAttribute("name","t"),L.appendChild(o),y.checkClone=L.cloneNode(!0).cloneNode(!0).lastChild.checked,L.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!L.cloneNode(!0).lastChild.defaultValue,L.innerHTML="<option></option>",y.option=!!L.lastChild,{thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]});function j(e,t){var n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&u(e,t)?C.merge([e],n):n}function Ee(e,t){for(var n=0,r=e.length;n<r;n++)b.set(e[n],"globalEval",!t||b.get(t[n],"globalEval"))}N.tbody=N.tfoot=N.colgroup=N.caption=N.thead,N.th=N.td,y.option||(N.optgroup=N.option=[1,"<select multiple='multiple'>","</select>"]);var Se=/<|&#?\w+;/;function ke(e,t,n,r,i){for(var o,s,a,u,l,c=t.createDocumentFragment(),f=[],p=0,d=e.length;p<d;p++)if((o=e[p])||0===o)if("object"===h(o))C.merge(f,o.nodeType?[o]:o);else if(Se.test(o)){for(s=s||c.appendChild(t.createElement("div")),a=(Te.exec(o)||["",""])[1].toLowerCase(),a=N[a]||N._default,s.innerHTML=a[1]+C.htmlPrefilter(o)+a[2],l=a[0];l--;)s=s.lastChild;C.merge(f,s.childNodes),(s=c.firstChild).textContent=""}else f.push(t.createTextNode(o));for(c.textContent="",p=0;o=f[p++];)if(r&&-1<C.inArray(o,r))i&&i.push(o);else if(u=k(o),s=j(c.appendChild(o),"script"),u&&Ee(s),n)for(l=0;o=s[l++];)Ce.test(o.type||"")&&n.push(o);return c}var Ae=/^([^.]*)(?:\.(.+)|)/;function n(){return!0}function d(){return!1}function Ne(e,t){return e===function(){try{return T.activeElement}catch(e){}}()==("focus"===t)}function je(e,t,n,r,i,o){var s,a;if("object"==typeof t){for(a in"string"!=typeof n&&(r=r||n,n=void 0),t)je(e,a,n,r,t[a],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=d;else if(!i)return e;return 1===o&&(s=i,(i=function(e){return C().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=C.guid++)),e.each(function(){C.event.add(this,t,i,r,n)})}function De(e,i,o){o?(b.set(e,i,!1),C.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=b.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(C.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=a.call(arguments),b.set(this,i,r),t=o(this,i),this[i](),r!==(n=b.get(this,i))||t?b.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(b.set(this,i,{value:C.event.trigger(C.extend(r[0],C.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===b.get(e,i)&&C.event.add(e,i,n)}C.event={global:{},add:function(t,e,n,r,i){var o,s,a,u,l,c,f,p,d,h=b.get(t);if(m(t))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&C.find.matchesSelector(S,i),n.guid||(n.guid=C.guid++),a=(a=h.events)||(h.events=Object.create(null)),s=(s=h.handle)||(h.handle=function(e){return void 0!==C&&C.event.triggered!==e.type?C.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(E)||[""]).length;u--;)f=d=(p=Ae.exec(e[u])||[])[1],p=(p[2]||"").split(".").sort(),f&&(l=C.event.special[f]||{},f=(i?l.delegateType:l.bindType)||f,l=C.event.special[f]||{},d=C.extend({type:f,origType:d,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&C.expr.match.needsContext.test(i),namespace:p.join(".")},o),(c=a[f])||((c=a[f]=[]).delegateCount=0,l.setup&&!1!==l.setup.call(t,r,p,s))||t.addEventListener&&t.addEventListener(f,s),l.add&&(l.add.call(t,d),d.handler.guid||(d.handler.guid=n.guid)),i?c.splice(c.delegateCount++,0,d):c.push(d),C.event.global[f]=!0)},remove:function(e,t,n,r,i){var o,s,a,u,l,c,f,p,d,h,g,y=b.hasData(e)&&b.get(e);if(y&&(u=y.events)){for(l=(t=(t||"").match(E)||[""]).length;l--;)if(d=g=(a=Ae.exec(t[l])||[])[1],h=(a[2]||"").split(".").sort(),d){for(f=C.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));s&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,y.handle)||C.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)C.event.remove(e,d+t[l],n,r,!0);C.isEmptyObject(u)&&b.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,s=new Array(arguments.length),a=C.event.fix(e),e=(b.get(this,"events")||Object.create(null))[a.type]||[],u=C.event.special[a.type]||{};for(s[0]=a,t=1;t<arguments.length;t++)s[t]=arguments[t];if(a.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,a)){for(o=C.event.handlers.call(this,a,e),t=0;(r=o[t++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!1!==i.namespace&&!a.rnamespace.test(i.namespace)||(a.handleObj=i,a.data=i.data,void 0!==(i=((C.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,s))&&!1===(a.result=i)&&(a.preventDefault(),a.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,a),a.result}},handlers:function(e,t){var n,r,i,o,s,a=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],s={},n=0;n<u;n++)void 0===s[i=(r=t[n]).selector+" "]&&(s[i]=r.needsContext?-1<C(i,this).index(l):C.find(i,this,null,[l]).length),s[i]&&o.push(r);o.length&&a.push({elem:l,handlers:o})}return l=this,u<t.length&&a.push({elem:l,handlers:t.slice(u)}),a},addProp:function(t,e){Object.defineProperty(C.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[C.expando]?e:new C.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){e=this||e;return we.test(e.type)&&e.click&&u(e,"input")&&De(e,"click",n),!1},trigger:function(e){e=this||e;return we.test(e.type)&&e.click&&u(e,"input")&&De(e,"click"),!0},_default:function(e){e=e.target;return we.test(e.type)&&e.click&&u(e,"input")&&b.get(e,"click")||u(e,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},C.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},C.Event=function(e,t){if(!(this instanceof C.Event))return new C.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?n:d,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&C.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[C.expando]=!0},C.Event.prototype={constructor:C.Event,isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=n,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=n,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=n,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},C.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},C.event.addProp),C.each({focus:"focusin",blur:"focusout"},function(t,e){C.event.special[t]={setup:function(){return De(this,t,Ne),!1},trigger:function(){return De(this,t),!0},_default:function(e){return b.get(e.target,t)},delegateType:e}}),C.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){C.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||C.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),C.fn.extend({on:function(e,t,n,r){return je(this,e,t,n,r)},one:function(e,t,n,r){return je(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)r=e.handleObj,C(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler);else{if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=d),this.each(function(){C.event.remove(this,e,n,t)});for(i in e)this.off(i,t,e[i])}return this}});var qe=/<script|<style|<link/i,Le=/checked\s*(?:[^=]|=\s*.checked.)/i,He=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Oe(e,t){return u(e,"table")&&u(11!==t.nodeType?t:t.firstChild,"tr")&&C(e).children("tbody")[0]||e}function Pe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Re(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Me(e,t){var n,r,i,o;if(1===t.nodeType){if(b.hasData(e)&&(o=b.get(e).events))for(i in b.remove(t,"handle events"),o)for(n=0,r=o[i].length;n<r;n++)C.event.add(t,i,o[i][n]);l.hasData(e)&&(e=l.access(e),e=C.extend({},e),l.set(t,e))}}function D(n,r,i,o){r=I(r);var e,t,s,a,u,l,c=0,f=n.length,p=f-1,d=r[0],h=v(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&Le.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),D(t,r,i,o)});if(f&&(t=(e=ke(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(a=(s=C.map(j(e,"script"),Pe)).length;c<f;c++)u=e,c!==p&&(u=C.clone(u,!0,!0),a)&&C.merge(s,j(u,"script")),i.call(n[c],u,c);if(a)for(l=s[s.length-1].ownerDocument,C.map(s,Re),c=0;c<a;c++)u=s[c],Ce.test(u.type||"")&&!b.access(u,"globalEval")&&C.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?C._evalUrl&&!u.noModule&&C._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):V(u.textContent.replace(He,""),u,l))}return n}function Ie(e,t,n){for(var r,i=t?C.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||C.cleanData(j(r)),r.parentNode&&(n&&k(r)&&Ee(j(r,"script")),r.parentNode.removeChild(r));return e}C.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,s,a,u,l,c=e.cloneNode(!0),f=k(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||C.isXMLDoc(e)))for(s=j(c),r=0,i=(o=j(e)).length;r<i;r++)a=o[r],u=s[r],l=void 0,"input"===(l=u.nodeName.toLowerCase())&&we.test(a.type)?u.checked=a.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=a.defaultValue);if(t)if(n)for(o=o||j(e),s=s||j(c),r=0,i=o.length;r<i;r++)Me(o[r],s[r]);else Me(e,c);return 0<(s=j(c,"script")).length&&Ee(s,!f&&j(e,"script")),c},cleanData:function(e){for(var t,n,r,i=C.event.special,o=0;void 0!==(n=e[o]);o++)if(m(n)){if(t=n[b.expando]){if(t.events)for(r in t.events)i[r]?C.event.remove(n,r):C.removeEvent(n,r,t.handle);n[b.expando]=void 0}n[l.expando]&&(n[l.expando]=void 0)}}}),C.fn.extend({detach:function(e){return Ie(this,e,!0)},remove:function(e){return Ie(this,e)},text:function(e){return f(this,function(e){return void 0===e?C.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return D(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Oe(this,e).appendChild(e)})},prepend:function(){return D(this,arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=Oe(this,e)).insertBefore(e,t.firstChild)})},before:function(){return D(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return D(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(C.cleanData(j(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return C.clone(this,e,t)})},html:function(e){return f(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!qe.test(e)&&!N[(Te.exec(e)||["",""])[1].toLowerCase()]){e=C.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(C.cleanData(j(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return D(this,arguments,function(e){var t=this.parentNode;C.inArray(this,n)<0&&(C.cleanData(j(this)),t)&&t.replaceChild(e,this)},n)}}),C.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,s){C.fn[e]=function(e){for(var t,n=[],r=C(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),C(r[o])[s](t),W.apply(n,t.get());return this.pushStack(n)}});function We(e){var t=e.ownerDocument.defaultView;return(t=t&&t.opener?t:w).getComputedStyle(e)}function Fe(e,t,n){var r,i={};for(r in t)i[r]=e.style[r],e.style[r]=t[r];for(r in n=n.call(e),t)e.style[r]=i[r];return n}var $e,Be,_e,ze,Ue,Xe,Ve,i,Ge=new RegExp("^("+e+")(?!px)[a-z%]+$","i"),Ye=/^--/,Qe=new RegExp(p.join("|"),"i"),o="[\\x20\\t\\r\\n\\f]",Je=new RegExp("^"+o+"+|((?:^|[^\\\\])(?:\\\\.)*)"+o+"+$","g");function Ke(){var e;i&&(Ve.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",i.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",S.appendChild(Ve).appendChild(i),e=w.getComputedStyle(i),$e="1%"!==e.top,Xe=12===Ze(e.marginLeft),i.style.right="60%",ze=36===Ze(e.right),Be=36===Ze(e.width),i.style.position="absolute",_e=12===Ze(i.offsetWidth/3),S.removeChild(Ve),i=null)}function Ze(e){return Math.round(parseFloat(e))}function et(e,t,n){var r,i=Ye.test(t),o=e.style;return(n=n||We(e))&&(r=n.getPropertyValue(t)||n[t],""!==(r=i?r&&(r.replace(Je,"$1")||void 0):r)||k(e)||(r=C.style(e,t)),!y.pixelBoxStyles())&&Ge.test(r)&&Qe.test(t)&&(i=o.width,e=o.minWidth,t=o.maxWidth,o.minWidth=o.maxWidth=o.width=r,r=n.width,o.width=i,o.minWidth=e,o.maxWidth=t),void 0!==r?r+"":r}function tt(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}Ve=T.createElement("div"),(i=T.createElement("div")).style&&(i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===i.style.backgroundClip,C.extend(y,{boxSizingReliable:function(){return Ke(),Be},pixelBoxStyles:function(){return Ke(),ze},pixelPosition:function(){return Ke(),$e},reliableMarginLeft:function(){return Ke(),Xe},scrollboxSize:function(){return Ke(),_e},reliableTrDimensions:function(){var e,t,n;return null==Ue&&(e=T.createElement("table"),t=T.createElement("tr"),n=T.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",S.appendChild(e).appendChild(t).appendChild(n),n=w.getComputedStyle(t),Ue=parseInt(n.height,10)+parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)===t.offsetHeight,S.removeChild(e)),Ue}}));var nt=["Webkit","Moz","ms"],rt=T.createElement("div").style,it={};function ot(e){var t=C.cssProps[e]||it[e];return t||(e in rt?e:it[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=nt.length;n--;)if((e=nt[n]+t)in rt)return e}(e)||e)}var st=/^(none|table(?!-c[ea]).+)/,at={position:"absolute",visibility:"hidden",display:"block"},ut={letterSpacing:"0",fontWeight:"400"};function lt(e,t,n){var r=me.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function ct(e,t,n,r,i,o){var s="width"===t?1:0,a=0,u=0;if(n===(r?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(u+=C.css(e,n+p[s],!0,i)),r?("content"===n&&(u-=C.css(e,"padding"+p[s],!0,i)),"margin"!==n&&(u-=C.css(e,"border"+p[s]+"Width",!0,i))):(u+=C.css(e,"padding"+p[s],!0,i),"padding"!==n?u+=C.css(e,"border"+p[s]+"Width",!0,i):a+=C.css(e,"border"+p[s]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-a-.5))||0),u}function ft(e,t,n){var r=We(e),i=(!y.boxSizingReliable()||n)&&"border-box"===C.css(e,"boxSizing",!1,r),o=i,s=et(e,t,r),a="offset"+t[0].toUpperCase()+t.slice(1);if(Ge.test(s)){if(!n)return s;s="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&u(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===C.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===C.css(e,"boxSizing",!1,r),o=a in e)&&(s=e[a]),(s=parseFloat(s)||0)+ct(e,t,n||(i?"border":"content"),o,r,s)+"px"}function s(e,t,n,r,i){return new s.prototype.init(e,t,n,r,i)}C.extend({cssHooks:{opacity:{get:function(e,t){if(t)return""===(t=et(e,"opacity"))?"1":t}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=x(t),u=Ye.test(t),l=e.style;if(u||(t=ot(a)),s=C.cssHooks[t]||C.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=me.exec(n))&&i[1]&&(n=xe(e,t,i),o="number"),null==n||n!=n||("number"!==o||u||(n+=i&&i[3]||(C.cssNumber[a]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r)))||(u?l.setProperty(t,n):l[t]=n)}},css:function(e,t,n,r){var i,o=x(t);return Ye.test(t)||(t=ot(o)),"normal"===(i=void 0===(i=(o=C.cssHooks[t]||C.cssHooks[o])&&"get"in o?o.get(e,!0,n):i)?et(e,t,r):i)&&t in ut&&(i=ut[t]),(""===n||n)&&(o=parseFloat(i),!0===n||isFinite(o))?o||0:i}}),C.each(["height","width"],function(e,s){C.cssHooks[s]={get:function(e,t,n){if(t)return!st.test(C.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ft(e,s,n):Fe(e,at,function(){return ft(e,s,n)})},set:function(e,t,n){var r=We(e),i=!y.scrollboxSize()&&"absolute"===r.position,o=(i||n)&&"border-box"===C.css(e,"boxSizing",!1,r),n=n?ct(e,s,n,o,r):0;return o&&i&&(n-=Math.ceil(e["offset"+s[0].toUpperCase()+s.slice(1)]-parseFloat(r[s])-ct(e,s,"border",!1,r)-.5)),n&&(o=me.exec(t))&&"px"!==(o[3]||"px")&&(e.style[s]=t,t=C.css(e,s)),lt(0,t,n)}}}),C.cssHooks.marginLeft=tt(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(et(e,"marginLeft"))||e.getBoundingClientRect().left-Fe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),C.each({margin:"",padding:"",border:"Width"},function(i,o){C.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+p[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(C.cssHooks[i+o].set=lt)}),C.fn.extend({css:function(e,t){return f(this,function(e,t,n){var r,i,o={},s=0;if(Array.isArray(t)){for(r=We(e),i=t.length;s<i;s++)o[t[s]]=C.css(e,t[s],!1,r);return o}return void 0!==n?C.style(e,t,n):C.css(e,t)},e,t,1<arguments.length)}}),((C.Tween=s).prototype={constructor:s,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||C.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(C.cssNumber[n]?"":"px")},cur:function(){var e=s.propHooks[this.prop];return(e&&e.get?e:s.propHooks._default).get(this)},run:function(e){var t,n=s.propHooks[this.prop];return this.options.duration?this.pos=t=C.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(n&&n.set?n:s.propHooks._default).set(this),this}}).init.prototype=s.prototype,(s.propHooks={_default:{get:function(e){return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(e=C.css(e.elem,e.prop,""))&&"auto"!==e?e:0},set:function(e){C.fx.step[e.prop]?C.fx.step[e.prop](e):1!==e.elem.nodeType||!C.cssHooks[e.prop]&&null==e.elem.style[ot(e.prop)]?e.elem[e.prop]=e.now:C.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=s.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},C.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},C.fx=s.prototype.init,C.fx.step={};var q,pt,L,dt=/^(?:toggle|show|hide)$/,ht=/queueHooks$/;function gt(){pt&&(!1===T.hidden&&w.requestAnimationFrame?w.requestAnimationFrame(gt):w.setTimeout(gt,C.fx.interval),C.fx.tick())}function yt(){return w.setTimeout(function(){q=void 0}),q=Date.now()}function mt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=p[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function vt(e,t,n){for(var r,i=(H.tweeners[t]||[]).concat(H.tweeners["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,t,e))return r}function H(i,e,t){var n,o,r,s,a,u,l,c=0,f=H.prefilters.length,p=C.Deferred().always(function(){delete d.elem}),d=function(){if(!o){for(var e=q||yt(),e=Math.max(0,h.startTime+h.duration-e),t=1-(e/h.duration||0),n=0,r=h.tweens.length;n<r;n++)h.tweens[n].run(t);if(p.notifyWith(i,[h,t,e]),t<1&&r)return e;r||p.notifyWith(i,[h,1,0]),p.resolveWith(i,[h])}return!1},h=p.promise({elem:i,props:C.extend({},e),opts:C.extend(!0,{specialEasing:{},easing:C.easing._default},t),originalProperties:e,originalOptions:t,startTime:q||yt(),duration:t.duration,tweens:[],createTween:function(e,t){t=C.Tween(i,h.opts,e,t,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(t),t},stop:function(e){var t=0,n=e?h.tweens.length:0;if(!o){for(o=!0;t<n;t++)h.tweens[t].run(1);e?(p.notifyWith(i,[h,1,0]),p.resolveWith(i,[h,e])):p.rejectWith(i,[h,e])}return this}}),g=h.props,y=g,m=h.opts.specialEasing;for(r in y)if(a=m[s=x(r)],u=y[r],Array.isArray(u)&&(a=u[1],u=y[r]=u[0]),r!==s&&(y[s]=u,delete y[r]),(l=C.cssHooks[s])&&"expand"in l)for(r in u=l.expand(u),delete y[s],u)r in y||(y[r]=u[r],m[r]=a);else m[s]=a;for(;c<f;c++)if(n=H.prefilters[c].call(h,i,g,h.opts))return v(n.stop)&&(C._queueHooks(h.elem,h.opts.queue).stop=n.stop.bind(n)),n;return C.map(g,vt,h),v(h.opts.start)&&h.opts.start.call(i,h),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always),C.fx.timer(C.extend(d,{elem:i,anim:h,queue:h.opts.queue})),h}C.Animation=C.extend(H,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return xe(n.elem,e,me.exec(t),n),n}]},tweener:function(e,t){for(var n,r=0,i=(e=v(e)?(t=e,["*"]):e.match(E)).length;r<i;r++)n=e[r],H.tweeners[n]=H.tweeners[n]||[],H.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,s,a,u,l,c="width"in t||"height"in t,f=this,p={},d=e.style,h=e.nodeType&&ye(e),g=b.get(e,"fxshow");for(r in n.queue||(null==(s=C._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,f.always(function(){f.always(function(){s.unqueued--,C.queue(e,"fx").length||s.empty.fire()})})),t)if(i=t[r],dt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;h=!0}p[r]=g&&g[r]||C.style(e,r)}if((u=!C.isEmptyObject(t))||!C.isEmptyObject(p))for(r in c&&1===e.nodeType&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],null==(l=g&&g.display)&&(l=b.get(e,"display")),"none"===(c=C.css(e,"display"))&&(l?c=l:(A([e],!0),l=e.style.display||l,c=C.css(e,"display"),A([e]))),"inline"===c||"inline-block"===c&&null!=l)&&"none"===C.css(e,"float")&&(u||(f.done(function(){d.display=l}),null==l&&(c=d.display,l="none"===c?"":c)),d.display="inline-block"),n.overflow&&(d.overflow="hidden",f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]})),u=!1,p)u||(g?"hidden"in g&&(h=g.hidden):g=b.access(e,"fxshow",{display:l}),o&&(g.hidden=!h),h&&A([e],!0),f.done(function(){for(r in h||A([e]),b.remove(e,"fxshow"),p)C.style(e,r,p[r])})),u=vt(h?g[r]:0,r,f),r in g||(g[r]=u.start,h&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?H.prefilters.unshift(e):H.prefilters.push(e)}}),C.speed=function(e,t,n){var r=e&&"object"==typeof e?C.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return C.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in C.fx.speeds?r.duration=C.fx.speeds[r.duration]:r.duration=C.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&C.dequeue(this,r.queue)},r},C.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ye).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){function i(){var e=H(this,C.extend({},t),s);(o||b.get(this,"finish"))&&e.stop(!0)}var o=C.isEmptyObject(t),s=C.speed(e,n,r);return i.finish=i,o||!1===s.queue?this.each(i):this.queue(s.queue,i)},stop:function(i,e,o){function s(e){var t=e.stop;delete e.stop,t(o)}return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=C.timers,r=b.get(this);if(t)r[t]&&r[t].stop&&s(r[t]);else for(t in r)r[t]&&r[t].stop&&ht.test(t)&&s(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||C.dequeue(this,i)})},finish:function(s){return!1!==s&&(s=s||"fx"),this.each(function(){var e,t=b.get(this),n=t[s+"queue"],r=t[s+"queueHooks"],i=C.timers,o=n?n.length:0;for(t.finish=!0,C.queue(this,s,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===s&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),C.each(["toggle","show","hide"],function(e,r){var i=C.fn[r];C.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(mt(r,!0),e,t,n)}}),C.each({slideDown:mt("show"),slideUp:mt("hide"),slideToggle:mt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){C.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),C.timers=[],C.fx.tick=function(){var e,t=0,n=C.timers;for(q=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||C.fx.stop(),q=void 0},C.fx.timer=function(e){C.timers.push(e),C.fx.start()},C.fx.interval=13,C.fx.start=function(){pt||(pt=!0,gt())},C.fx.stop=function(){pt=null},C.fx.speeds={slow:600,fast:200,_default:400},C.fn.delay=function(r,e){return r=C.fx&&C.fx.speeds[r]||r,this.queue(e=e||"fx",function(e,t){var n=w.setTimeout(e,r);t.stop=function(){w.clearTimeout(n)}})},L=T.createElement("input"),e=T.createElement("select").appendChild(T.createElement("option")),L.type="checkbox",y.checkOn=""!==L.value,y.optSelected=e.selected,(L=T.createElement("input")).value="t",L.type="radio",y.radioValue="t"===L.value;var xt,bt=C.expr.attrHandle,wt=(C.fn.extend({attr:function(e,t){return f(this,C.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){C.removeAttr(this,e)})}}),C.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?C.prop(e,t,n):(1===o&&C.isXMLDoc(e)||(i=C.attrHooks[t.toLowerCase()]||(C.expr.match.bool.test(t)?xt:void 0)),void 0!==n?null===n?void C.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):!(i&&"get"in i&&null!==(r=i.get(e,t)))&&null==(r=C.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){var n;if(!y.radioValue&&"radio"===t&&u(e,"input"))return n=e.value,e.setAttribute("type",t),n&&(e.value=n),t}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(E);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),xt={set:function(e,t,n){return!1===t?C.removeAttr(e,n):e.setAttribute(n,n),n}},C.each(C.expr.match.bool.source.match(/\w+/g),function(e,t){var s=bt[t]||C.find.attr;bt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=bt[o],bt[o]=r,r=null!=s(e,t,n)?o:null,bt[o]=i),r}}),/^(?:input|select|textarea|button)$/i),Tt=/^(?:a|area)$/i;function O(e){return(e.match(E)||[]).join(" ")}function P(e){return e.getAttribute&&e.getAttribute("class")||""}function Ct(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(E)||[]}C.fn.extend({prop:function(e,t){return f(this,C.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[C.propFix[e]||e]})}}),C.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&C.isXMLDoc(e)||(t=C.propFix[t]||t,i=C.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=C.find.attr(e,"tabindex");return t?parseInt(t,10):wt.test(e.nodeName)||Tt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),y.optSelected||(C.propHooks.selected={get:function(e){e=e.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(e){e=e.parentNode;e&&(e.selectedIndex,e.parentNode)&&e.parentNode.selectedIndex}}),C.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){C.propFix[this.toLowerCase()]=this}),C.fn.extend({addClass:function(t){var e,n,r,i,o,s;return v(t)?this.each(function(e){C(this).addClass(t.call(this,e,P(this)))}):(e=Ct(t)).length?this.each(function(){if(r=P(this),n=1===this.nodeType&&" "+O(r)+" "){for(o=0;o<e.length;o++)i=e[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");s=O(n),r!==s&&this.setAttribute("class",s)}}):this},removeClass:function(t){var e,n,r,i,o,s;return v(t)?this.each(function(e){C(this).removeClass(t.call(this,e,P(this)))}):arguments.length?(e=Ct(t)).length?this.each(function(){if(r=P(this),n=1===this.nodeType&&" "+O(r)+" "){for(o=0;o<e.length;o++)for(i=e[o];-1<n.indexOf(" "+i+" ");)n=n.replace(" "+i+" "," ");s=O(n),r!==s&&this.setAttribute("class",s)}}):this:this.attr("class","")},toggleClass:function(t,n){var e,r,i,o,s=typeof t,a="string"==s||Array.isArray(t);return v(t)?this.each(function(e){C(this).toggleClass(t.call(this,e,P(this),n),n)}):"boolean"==typeof n&&a?n?this.addClass(t):this.removeClass(t):(e=Ct(t),this.each(function(){if(a)for(o=C(this),i=0;i<e.length;i++)r=e[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!=s||((r=P(this))&&b.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",!r&&!1!==t&&b.get(this,"__className__")||""))}))},hasClass:function(e){for(var t,n=0,r=" "+e+" ";t=this[n++];)if(1===t.nodeType&&-1<(" "+O(P(t))+" ").indexOf(r))return!0;return!1}});function Et(e){e.stopPropagation()}var St=/\r/g,kt=(C.fn.extend({val:function(t){var n,e,r,i=this[0];return arguments.length?(r=v(t),this.each(function(e){1!==this.nodeType||(null==(e=r?t.call(this,e,C(this).val()):t)?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=C.map(e,function(e){return null==e?"":e+""})),(n=C.valHooks[this.type]||C.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value"))||(this.value=e)})):i?(n=C.valHooks[i.type]||C.valHooks[i.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(i,"value"))?e:"string"==typeof(e=i.value)?e.replace(St,""):null==e?"":e:void 0}}),C.extend({valHooks:{option:{get:function(e){var t=C.find.attr(e,"value");return null!=t?t:O(C.text(e))}},select:{get:function(e){for(var t,n=e.options,r=e.selectedIndex,i="select-one"===e.type,o=i?null:[],s=i?r+1:n.length,a=r<0?s:i?r:0;a<s;a++)if(((t=n[a]).selected||a===r)&&!t.disabled&&(!t.parentNode.disabled||!u(t.parentNode,"optgroup"))){if(t=C(t).val(),i)return t;o.push(t)}return o},set:function(e,t){for(var n,r,i=e.options,o=C.makeArray(t),s=i.length;s--;)((r=i[s]).selected=-1<C.inArray(C.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),C.each(["radio","checkbox"],function(){C.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<C.inArray(C(e).val(),t)}},y.checkOn||(C.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in w,/^(?:focusinfocus|focusoutblur)$/),At=(C.extend(C.event,{trigger:function(e,t,n,r){var i,o,s,a,u,l,c,f=[n||T],p=_.call(e,"type")?e.type:e,d=_.call(e,"namespace")?e.namespace.split("."):[],h=c=o=n=n||T;if(3!==n.nodeType&&8!==n.nodeType&&!kt.test(p+C.event.triggered)&&(-1<p.indexOf(".")&&(p=(d=p.split(".")).shift(),d.sort()),a=p.indexOf(":")<0&&"on"+p,(e=e[C.expando]?e:new C.Event(p,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=d.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:C.makeArray(t,[e]),l=C.event.special[p]||{},r||!l.trigger||!1!==l.trigger.apply(n,t))){if(!r&&!l.noBubble&&!g(n)){for(s=l.delegateType||p,kt.test(s+p)||(h=h.parentNode);h;h=h.parentNode)f.push(h),o=h;o===(n.ownerDocument||T)&&f.push(o.defaultView||o.parentWindow||w)}for(i=0;(h=f[i++])&&!e.isPropagationStopped();)c=h,e.type=1<i?s:l.bindType||p,(u=(b.get(h,"events")||Object.create(null))[e.type]&&b.get(h,"handle"))&&u.apply(h,t),(u=a&&h[a])&&u.apply&&m(h)&&(e.result=u.apply(h,t),!1===e.result)&&e.preventDefault();return e.type=p,r||e.isDefaultPrevented()||l._default&&!1!==l._default.apply(f.pop(),t)||!m(n)||a&&v(n[p])&&!g(n)&&((o=n[a])&&(n[a]=null),C.event.triggered=p,e.isPropagationStopped()&&c.addEventListener(p,Et),n[p](),e.isPropagationStopped()&&c.removeEventListener(p,Et),C.event.triggered=void 0,o)&&(n[a]=o),e.result}},simulate:function(e,t,n){n=C.extend(new C.Event,n,{type:e,isSimulated:!0});C.event.trigger(n,null,t)}}),C.fn.extend({trigger:function(e,t){return this.each(function(){C.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return C.event.trigger(e,t,n,!0)}}),y.focusin||C.each({focus:"focusin",blur:"focusout"},function(n,r){function i(e){C.event.simulate(r,e.target,C.event.fix(e))}C.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=b.access(e,r);t||e.addEventListener(n,i,!0),b.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=b.access(e,r)-1;t?b.access(e,r,t):(e.removeEventListener(n,i,!0),b.remove(e,r))}}}),w.location),Nt={guid:Date.now()},jt=/\?/,Dt=(C.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new w.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||C.error("Invalid XML: "+(n?C.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t},/\[\]$/),qt=/\r?\n/g,Lt=/^(?:submit|button|image|reset|file)$/i,Ht=/^(?:input|select|textarea|keygen)/i;C.param=function(e,t){function n(e,t){t=v(t)?t():t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==t?"":t)}var r,i=[];if(null==e)return"";if(Array.isArray(e)||e.jquery&&!C.isPlainObject(e))C.each(e,function(){n(this.name,this.value)});else for(r in e)!function n(r,e,i,o){if(Array.isArray(e))C.each(e,function(e,t){i||Dt.test(r)?o(r,t):n(r+"["+("object"==typeof t&&null!=t?e:"")+"]",t,i,o)});else if(i||"object"!==h(e))o(r,e);else for(var t in e)n(r+"["+t+"]",e[t],i,o)}(r,e[r],t,n);return i.join("&")},C.fn.extend({serialize:function(){return C.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=C.prop(this,"elements");return e?C.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!C(this).is(":disabled")&&Ht.test(this.nodeName)&&!Lt.test(e)&&(this.checked||!we.test(e))}).map(function(e,t){var n=C(this).val();return null==n?null:Array.isArray(n)?C.map(n,function(e){return{name:t.name,value:e.replace(qt,"\r\n")}}):{name:t.name,value:n.replace(qt,"\r\n")}}).get()}});var Ot=/%20/g,Pt=/#.*$/,Rt=/([?&])_=[^&]*/,Mt=/^(.*?):[ \t]*([^\r\n]*)$/gm,It=/^(?:GET|HEAD)$/,Wt=/^\/\//,Ft={},$t={},Bt="*/".concat("*"),_t=T.createElement("a");function zt(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(E)||[];if(v(t))for(;n=i[r++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Ut(t,r,i,o){var s={},a=t===$t;function u(e){var n;return s[e]=!0,C.each(t[e]||[],function(e,t){t=t(r,i,o);return"string"!=typeof t||a||s[t]?a?!(n=t):void 0:(r.dataTypes.unshift(t),u(t),!1)}),n}return u(r.dataTypes[0])||!s["*"]&&u("*")}function Xt(e,t){var n,r,i=C.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r=r||{})[n]=t[n]);return r&&C.extend(!0,e,r),e}_t.href=At.href,C.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:At.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(At.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":C.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Xt(Xt(e,C.ajaxSettings),t):Xt(C.ajaxSettings,e)},ajaxPrefilter:zt(Ft),ajaxTransport:zt($t),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0);var u,l,c,n,f,p,d,r,h=C.ajaxSetup({},t=t||{}),g=h.context||h,y=h.context&&(g.nodeType||g.jquery)?C(g):C.event,m=C.Deferred(),v=C.Callbacks("once memory"),x=h.statusCode||{},i={},o={},s="canceled",b={readyState:0,getResponseHeader:function(e){var t;if(p){if(!n)for(n={};t=Mt.exec(c);)n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return p?c:null},setRequestHeader:function(e,t){return null==p&&(e=o[e.toLowerCase()]=o[e.toLowerCase()]||e,i[e]=t),this},overrideMimeType:function(e){return null==p&&(h.mimeType=e),this},statusCode:function(e){if(e)if(p)b.always(e[b.status]);else for(var t in e)x[t]=[x[t],e[t]];return this},abort:function(e){e=e||s;return u&&u.abort(e),a(0,e),this}};if(m.promise(b),h.url=((e||h.url||At.href)+"").replace(Wt,At.protocol+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(E)||[""],null==h.crossDomain){e=T.createElement("a");try{e.href=h.url,e.href=e.href,h.crossDomain=_t.protocol+"//"+_t.host!=e.protocol+"//"+e.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=C.param(h.data,h.traditional)),Ut(Ft,h,t,b),!p){for(r in(d=C.event&&h.global)&&0==C.active++&&C.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!It.test(h.type),l=h.url.replace(Pt,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(Ot,"+")):(e=h.url.slice(l.length),h.data&&(h.processData||"string"==typeof h.data)&&(l+=(jt.test(l)?"&":"?")+h.data,delete h.data),!1===h.cache&&(l=l.replace(Rt,"$1"),e=(jt.test(l)?"&":"?")+"_="+Nt.guid+++e),h.url=l+e),h.ifModified&&(C.lastModified[l]&&b.setRequestHeader("If-Modified-Since",C.lastModified[l]),C.etag[l])&&b.setRequestHeader("If-None-Match",C.etag[l]),(h.data&&h.hasContent&&!1!==h.contentType||t.contentType)&&b.setRequestHeader("Content-Type",h.contentType),b.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Bt+"; q=0.01":""):h.accepts["*"]),h.headers)b.setRequestHeader(r,h.headers[r]);if(h.beforeSend&&(!1===h.beforeSend.call(g,b,h)||p))return b.abort();if(s="abort",v.add(h.complete),b.done(h.success),b.fail(h.error),u=Ut($t,h,t,b)){if(b.readyState=1,d&&y.trigger("ajaxSend",[b,h]),p)return b;h.async&&0<h.timeout&&(f=w.setTimeout(function(){b.abort("timeout")},h.timeout));try{p=!1,u.send(i,a)}catch(e){if(p)throw e;a(-1,e)}}else a(-1,"No Transport")}return b;function a(e,t,n,r){var i,o,s,a=t;p||(p=!0,f&&w.clearTimeout(f),u=void 0,c=r||"",b.readyState=0<e?4:0,r=200<=e&&e<300||304===e,n&&(s=function(e,t,n){for(var r,i,o,s,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s=s||i}o=o||s}if(o)return o!==u[0]&&u.unshift(o),n[o]}(h,b,n)),!r&&-1<C.inArray("script",h.dataTypes)&&C.inArray("json",h.dataTypes)<0&&(h.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=l[u+" "+o]||l["* "+o]))for(i in l)if((a=i.split(" "))[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[i]:!0!==l[i]&&(o=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(h,s,b,r),r?(h.ifModified&&((n=b.getResponseHeader("Last-Modified"))&&(C.lastModified[l]=n),n=b.getResponseHeader("etag"))&&(C.etag[l]=n),204===e||"HEAD"===h.type?a="nocontent":304===e?a="notmodified":(a=s.state,i=s.data,r=!(o=s.error))):(o=a,!e&&a||(a="error",e<0&&(e=0))),b.status=e,b.statusText=(t||a)+"",r?m.resolveWith(g,[i,a,b]):m.rejectWith(g,[b,a,o]),b.statusCode(x),x=void 0,d&&y.trigger(r?"ajaxSuccess":"ajaxError",[b,h,r?i:o]),v.fireWith(g,[b,a]),d&&(y.trigger("ajaxComplete",[b,h]),--C.active||C.event.trigger("ajaxStop")))}},getJSON:function(e,t,n){return C.get(e,t,n,"json")},getScript:function(e,t){return C.get(e,void 0,t,"script")}}),C.each(["get","post"],function(e,i){C[i]=function(e,t,n,r){return v(t)&&(r=r||n,n=t,t=void 0),C.ajax(C.extend({url:e,type:i,dataType:r,data:t,success:n},C.isPlainObject(e)&&e))}}),C.ajaxPrefilter(function(e){for(var t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),C._evalUrl=function(e,t,n){return C.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){C.globalEval(e,t,n)}})},C.fn.extend({wrapAll:function(e){return this[0]&&(v(e)&&(e=e.call(this[0])),e=C(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return v(n)?this.each(function(e){C(this).wrapInner(n.call(this,e))}):this.each(function(){var e=C(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=v(t);return this.each(function(e){C(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){C(this).replaceWith(this.childNodes)}),this}}),C.expr.pseudos.hidden=function(e){return!C.expr.pseudos.visible(e)},C.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},C.ajaxSettings.xhr=function(){try{return new w.XMLHttpRequest}catch(e){}};var Vt={0:200,1223:204},Gt=C.ajaxSettings.xhr(),Yt=(y.cors=!!Gt&&"withCredentials"in Gt,y.ajax=Gt=!!Gt,C.ajaxTransport(function(i){var o,s;if(y.cors||Gt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=s=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Vt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),s=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=s:r.onreadystatechange=function(){4===r.readyState&&w.setTimeout(function(){o&&s()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),C.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),C.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return C.globalEval(e),e}}}),C.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),C.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=C("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),T.head.appendChild(r[0])},abort:function(){i&&i()}}}),[]),Qt=/(=)\?(?=&|$)|\?\?/,Jt=(C.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Yt.pop()||C.expando+"_"+Nt.guid++;return this[e]=!0,e}}),C.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,s=!1!==e.jsonp&&(Qt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Qt,"$1"+r):!1!==e.jsonp&&(e.url+=(jt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||C.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=w[r],w[r]=function(){o=arguments},n.always(function(){void 0===i?C(w).removeProp(r):w[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Yt.push(r)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((o=T.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===o.childNodes.length),C.parseHTML=function(e,t,n){var r;return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=T.implementation.createHTMLDocument("")).createElement("base")).href=T.location.href,t.head.appendChild(r)):t=T),r=!n&&[],(n=J.exec(e))?[t.createElement(n[1])]:(n=ke([e],t,r),r&&r.length&&C(r).remove(),C.merge([],n.childNodes)))},C.fn.load=function(e,t,n){var r,i,o,s=this,a=e.indexOf(" ");return-1<a&&(r=O(e.slice(a)),e=e.slice(0,a)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<s.length&&C.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?C("<div>").append(C.parseHTML(e)).find(r):e)}).always(n&&function(e,t){s.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},C.expr.pseudos.animated=function(t){return C.grep(C.timers,function(e){return t===e.elem}).length},C.offset={setOffset:function(e,t,n){var r,i,o,s,a=C.css(e,"position"),u=C(e),l={};"static"===a&&(e.style.position="relative"),o=u.offset(),r=C.css(e,"top"),s=C.css(e,"left"),a=("absolute"===a||"fixed"===a)&&-1<(r+s).indexOf("auto")?(i=(a=u.position()).top,a.left):(i=parseFloat(r)||0,parseFloat(s)||0),null!=(t=v(t)?t.call(e,n,C.extend({},o)):t).top&&(l.top=t.top-o.top+i),null!=t.left&&(l.left=t.left-o.left+a),"using"in t?t.using.call(e,l):u.css(l)}},C.fn.extend({offset:function(t){var e,n;return arguments.length?void 0===t?this:this.each(function(e){C.offset.setOffset(this,t,e)}):(n=this[0])?n.getClientRects().length?(e=n.getBoundingClientRect(),n=n.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===C.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===C.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=C(e).offset()).top+=C.css(e,"borderTopWidth",!0),i.left+=C.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-C.css(r,"marginTop",!0),left:t.left-i.left-C.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===C.css(e,"position");)e=e.offsetParent;return e||S})}}),C.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;C.fn[t]=function(e){return f(this,function(e,t,n){var r;if(g(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),C.each(["top","left"],function(e,n){C.cssHooks[n]=tt(y.pixelPosition,function(e,t){if(t)return t=et(e,n),Ge.test(t)?C(e).position()[n]+"px":t})}),C.each({Height:"height",Width:"width"},function(s,a){C.each({padding:"inner"+s,content:a,"":"outer"+s},function(r,o){C.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return f(this,function(e,t,n){var r;return g(e)?0===o.indexOf("outer")?e["inner"+s]:e.document.documentElement["client"+s]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+s],r["scroll"+s],e.body["offset"+s],r["offset"+s],r["client"+s])):void 0===n?C.css(e,t,i):C.style(e,t,n,i)},a,n?e:void 0,n)}})}),C.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){C.fn[t]=function(e){return this.on(t,e)}}),C.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),C.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){C.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g),Kt=(C.proxy=function(e,t){var n,r;if("string"==typeof t&&(r=e[t],t=e,e=r),v(e))return n=a.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(a.call(arguments)))}).guid=e.guid=e.guid||C.guid++,r},C.holdReady=function(e){e?C.readyWait++:C.ready(!0)},C.isArray=Array.isArray,C.parseJSON=JSON.parse,C.nodeName=u,C.isFunction=v,C.isWindow=g,C.camelCase=x,C.type=h,C.now=Date.now,C.isNumeric=function(e){var t=C.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},C.trim=function(e){return null==e?"":(e+"").replace(Jt,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return C}),w.jQuery),Zt=w.$;return C.noConflict=function(e){return w.$===C&&(w.$=Zt),e&&w.jQuery===C&&(w.jQuery=Kt),C},void 0===R&&(w.jQuery=w.$=C),C});
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.async=n.async||{})}(this,function(n){"use strict";function d(n,t){t|=0;for(var e=Math.max(n.length-t,0),r=Array(e),o=0;o<e;o++)r[o]=n[t+o];return r}function q(t){var e=d(arguments,1);return function(){var n=d(arguments);return t.apply(null,e.concat(n))}}function a(e){return function(){var n=d(arguments),t=n.pop();e.call(this,n,t)}}function z(n){var t=typeof n;return null!=n&&("object"==t||"function"==t)}var P="function"==typeof setImmediate&&setImmediate,t="object"==typeof process&&"function"==typeof process.nextTick;function V(n){setTimeout(n,0)}function D(e){return function(n){var t=d(arguments,1);e(function(){n.apply(null,t)})}}var p=D(P?setImmediate:t?process.nextTick:V);function e(r){return a(function(n,t){var e;try{e=r.apply(this,n)}catch(n){return t(n)}z(e)&&"function"==typeof e.then?e.then(function(n){R(t,null,n)},function(n){R(t,n.message?n:new Error(n))}):t(null,e)})}function R(n,t,e){try{n(t,e)}catch(n){p(C,n)}}function C(n){throw n}var $="function"==typeof Symbol;function W(n){return $&&"AsyncFunction"===n[Symbol.toStringTag]}function m(n){return W(n)?e(n):n}function N(o){return function(t){var n=d(arguments,1),e=a(function(e,n){var r=this;return o(t,function(n,t){m(n).apply(r,e.concat(t))},n)});return n.length?e.apply(this,n):e}}var r="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,o=r||o||Function("return this")(),i=o.Symbol,u=Object.prototype,Q=u.hasOwnProperty,G=u.toString,c=i?i.toStringTag:void 0;var H=Object.prototype.toString;var J="[object Null]",K="[object Undefined]",X=i?i.toStringTag:void 0;function Y(n){if(null==n)return void 0===n?K:J;if(X&&X in Object(n)){var t=n,e=Q.call(t,c),r=t[c];try{var o=!(t[c]=void 0)}catch(n){}var i=G.call(t);return o&&(e?t[c]=r:delete t[c]),i}return H.call(n)}var Z="[object AsyncFunction]",nn="[object Function]",tn="[object GeneratorFunction]",en="[object Proxy]";var rn=9007199254740991;function on(n){return"number"==typeof n&&-1<n&&n%1==0&&n<=rn}function s(n){return null!=n&&on(n.length)&&!function(n){if(z(n))return(n=Y(n))==nn||n==tn||n==Z||n==en}(n)}var un={};function g(){}function b(t){return function(){var n;null!==t&&(n=t,t=null,n.apply(this,arguments))}}function cn(n){return an&&n[an]&&n[an]()}var an="function"==typeof Symbol&&Symbol.iterator;function fn(n){return null!=n&&"object"==typeof n}function ln(n){return fn(n)&&"[object Arguments]"==Y(n)}var u=Object.prototype,sn=u.hasOwnProperty,pn=u.propertyIsEnumerable,hn=ln(function(){return arguments}())?ln:function(n){return fn(n)&&sn.call(n,"callee")&&!pn.call(n,"callee")},j=Array.isArray;var u="object"==typeof n&&n&&!n.nodeType&&n,f=u&&"object"==typeof module&&module&&!module.nodeType&&module,f=f&&f.exports===u?o.Buffer:void 0,yn=(f?f.isBuffer:void 0)||function(){return!1},vn=/^(?:0|[1-9]\d*)$/;var l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l["[object Arguments]"]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l["[object Function]"]=l["[object Map]"]=l["[object Number]"]=l["[object Object]"]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var dn,u="object"==typeof n&&n&&!n.nodeType&&n,h=u&&"object"==typeof module&&module&&!module.nodeType&&module,mn=h&&h.exports===u&&r.process,o=function(){try{var n=h&&h.require&&h.require("util").types;return n?n:mn&&mn.binding&&mn.binding("util")}catch(n){}}(),f=o&&o.isTypedArray,gn=f?(dn=f,function(n){return dn(n)}):function(n){return fn(n)&&on(n.length)&&!!l[Y(n)]},bn=Object.prototype.hasOwnProperty;function jn(n,t){var e,r,o,i,u=j(n),c=!u&&hn(n),a=!u&&!c&&yn(n),f=!u&&!c&&!a&&gn(n),l=u||c||a||f,s=l?function(n,t){for(var e=-1,r=Array(n);++e<n;)r[e]=t(e);return r}(n.length,String):[],p=s.length;for(e in n)!t&&!bn.call(n,e)||l&&("length"==e||a&&("offset"==e||"parent"==e)||f&&("buffer"==e||"byteLength"==e||"byteOffset"==e)||(i=void 0,i=typeof(r=e),(o=null==(o=p)?9007199254740991:o)&&("number"==i||"symbol"!=i&&vn.test(r))&&-1<r&&r%1==0&&r<o))||s.push(e);return s}var Sn=Object.prototype;kn=Object.keys,Ln=Object;var kn,Ln,On=function(n){return kn(Ln(n))},wn=Object.prototype.hasOwnProperty;function xn(n){if(e=(t=n)&&t.constructor,t!==("function"==typeof e&&e.prototype||Sn))return On(n);var t,e,r,o=[];for(r in Object(n))wn.call(n,r)&&"constructor"!=r&&o.push(r);return o}function En(n){return(s(n)?jn:xn)(n)}function An(n){var t,e,r,o,i,u,c,a,f,l;return s(n)?(e=-1,r=(t=n).length,function(){return++e<r?{value:t[e],key:e}:null}):(o=cn(n))?(f=o,l=-1,function(){var n=f.next();return n.done?null:(l++,{value:n.value,key:l})}):(u=En(i=n),c=-1,a=u.length,function n(){var t=u[++c];return"__proto__"===t?n():c<a?{value:i[t],key:t}:null})}function S(t){return function(){if(null===t)throw new Error("Callback was already called.");var n=t;t=null,n.apply(this,arguments)}}function Tn(f){return function(n,t,e){if(e=b(e||g),f<=0||!n)return e(null);var r=An(n),o=!1,i=0,u=!1;function c(n,t){if(--i,n)o=!0,e(n);else{if(t===un||o&&i<=0)return o=!0,e(null);u||a()}}function a(){for(u=!0;i<f&&!o;){var n=r();if(null===n)return o=!0,void(i<=0&&e(null));i+=1,t(n.value,n.key,S(c))}u=!1}a()}}function y(n,t,e,r){Tn(t)(n,m(e),r)}function v(r,o){return function(n,t,e){return r(n,o,t,e)}}function _n(n,t,e){e=b(e||g);var r=0,o=0,i=n.length;function u(n,t){n?e(n):++o!==i&&t!==un||e(null)}for(0===i&&e(null);r<i;r++)t(n[r],r,S(u))}function k(n,t,e){(s(n)?_n:Bn)(n,m(t),e)}var Bn=v(y,1/0);function L(r){return function(n,t,e){return r(k,n,m(t),e)}}function Fn(n,t,e,r){r=r||g,t=t||[];var o=[],i=0,u=m(e);n(t,function(n,t,e){var r=i++;u(n,function(n,t){o[r]=t,e(n)})},function(n){r(n,o)})}var In=L(Fn),u=N(In);function O(o){return function(n,t,e,r){return o(Tn(t),n,m(e),r)}}var w=O(Fn),r=v(w,1),o=N(r);function Mn(n,t){for(var e=-1,r=null==n?0:n.length;++e<r&&!1!==t(n[e],e,n););}var Un,qn=function(n,t,e){for(var r=-1,o=Object(n),i=e(n),u=i.length;u--;){var c=i[Un?u:++r];if(!1===t(o[c],c,o))break}return n};function x(n,t){n&&qn(n,t,En)}function zn(n){return n!=n}function Pn(n,t,e){if(t==t){for(var r=n,o=t,i=e-1,u=r.length;++i<u;)if(r[i]===o)return i}else for(var c=n,a=zn,t=e,f=void 0,l=c.length,s=t+(f?1:-1);f?s--:++s<l;)if(a(c[s],s,c))return s;return-1}function Vn(c,n,u){"function"==typeof n&&(u=n,n=null),u=b(u||g);var t=En(c).length;if(!t)return u(null);n=n||t;var a={},f=0,l=!1,s=Object.create(null),e=[],p=[],h={};x(c,function(r,o){var i,u;j(r)?(i=r.slice(0,r.length-1),0===(u=i.length)?(y(o,r),p.push(o)):(h[o]=u,Mn(i,function(n){if(!c[n])throw new Error("async.auto task `"+o+"` has a non-existent dependency `"+n+"` in "+i.join(", "));var t=function(){0===--u&&y(o,r)},e=s[n];(e=e||(s[n]=[])).push(t)}))):(y(o,[r]),p.push(o))});for(var r,o=0;p.length;)r=p.pop(),o++,Mn(function(e){var r=[];return x(c,function(n,t){j(n)&&0<=Pn(n,e,0)&&r.push(t)}),r}(r),function(n){0==--h[n]&&p.push(n)});if(o!==t)throw new Error("async.auto cannot execute tasks due to a recursive dependency");function y(o,i){e.push(function(){var r,n,t,e;r=o,n=i,l||(t=S(function(n,t){var e;f--,2<arguments.length&&(t=d(arguments,1)),n?(e={},x(a,function(n,t){e[t]=n}),e[r]=t,l=!0,s=Object.create(null),u(n,e)):(a[r]=t,Mn(s[r]||[],function(n){n()}),v())}),f++,e=m(n[n.length-1]),1<n.length?e(a,t):e(t))})}function v(){if(0===e.length&&0===f)return u(null,a);for(;e.length&&f<n;)e.shift()()}v()}function E(n,t){for(var e=-1,r=null==n?0:n.length,o=Array(r);++e<r;)o[e]=t(n[e],e,n);return o}var f=i?i.prototype:void 0,Dn=f?f.toString:void 0;function Rn(n){var t;return"string"==typeof n?n:j(n)?E(n,Rn)+"":"symbol"==typeof(t=n)||fn(t)&&"[object Symbol]"==Y(t)?Dn?Dn.call(n):"":"0"==(t=n+"")&&1/n==-1/0?"-0":t}function Cn(n,t,e){var r=n.length;if(e=void 0===e?r:e,!t&&r<=e)return n;for(var o=n,i=t,r=e,u=-1,c=o.length,a=((r=c<r?c:r)<0&&(r+=c),c=r<(i=i<0?c<-i?0:c+i:i)?0:r-i>>>0,i>>>=0,Array(c));++u<c;)a[u]=o[u+i];return a}var $n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var i="\\ud800-\\udfff",f="["+i+"]",Wn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Nn="\\ud83c[\\udffb-\\udfff]",i="[^"+i+"]",A="(?:\\ud83c[\\udde6-\\uddff]){2}",T="[\\ud800-\\udbff][\\udc00-\\udfff]",_="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",B="[\\ufe0e\\ufe0f]?",B=B+_+("(?:\\u200d(?:"+[i,A,T].join("|")+")"+B+_+")*"),_="(?:"+[i+Wn+"?",Wn,A,T,f].join("|")+")",Qn=RegExp(Nn+"(?="+Nn+")|"+_+B,"g");function Gn(n){return $n.test(n)?n.match(Qn)||[]:n.split("")}var Hn=/^\s+|\s+$/g;function Jn(n,t,e){var r;return(n=null==(r=n)?"":Rn(r))&&(e||void 0===t)?n.replace(Hn,""):n&&(t=Rn(t))?Cn(r=Gn(n),function(n,t){for(var e=-1,r=n.length;++e<r&&-1<Pn(t,n[e],0););return e}(r,e=Gn(t)),function(n,t){for(var e=n.length;e--&&-1<Pn(t,n[e],0););return e}(r,e)+1).join(""):n}var Kn=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Xn=/,/,Yn=/(=.+)?(\s*)$/,Zn=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function nt(n,t){var u={};x(n,function(r,n){var o,t=W(r),e=!t&&1===r.length||t&&0===r.length;if(j(r))o=r.slice(0,-1),r=r[r.length-1],u[n]=o.concat(0<o.length?i:r);else if(e)u[n]=r;else{if(o=e=(e=(e=(e=(e=r).toString().replace(Zn,"")).match(Kn)[2].replace(" ",""))?e.split(Xn):[]).map(function(n){return Jn(n.replace(Yn,""))}),0===r.length&&!t&&0===o.length)throw new Error("autoInject task functions require explicit parameters.");t||o.pop(),u[n]=o.concat(i)}function i(t,n){var e=E(o,function(n){return t[n]});e.push(n),m(r).apply(null,e)}}),Vn(u,t)}function F(){this.head=this.tail=null,this.length=0}function tt(n,t){n.length=1,n.head=n.tail=t}function et(n,t,e){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var u=m(n),c=0,a=[],f=!1;function r(n,t,e){if(null!=e&&"function"!=typeof e)throw new Error("task callback must be a function");if(s.started=!0,0===(n=j(n)?n:[n]).length&&s.idle())return p(function(){s.drain()});for(var r=0,o=n.length;r<o;r++){var i={data:n[r],callback:e||g};t?s._tasks.unshift(i):s._tasks.push(i)}f||(f=!0,p(function(){f=!1,s.process()}))}var l=!1,s={_tasks:new F,concurrency:t,payload:e,saturated:g,unsaturated:g,buffer:t/4,empty:g,drain:g,error:g,started:!1,paused:!1,push:function(n,t){r(n,!1,t)},kill:function(){s.drain=g,s._tasks.empty()},unshift:function(n,t){r(n,!0,t)},remove:function(n){s._tasks.remove(n)},process:function(){if(!l){for(l=!0;!s.paused&&c<s.concurrency&&s._tasks.length;){var n=[],t=[],e=s._tasks.length;s.payload&&(e=Math.min(e,s.payload));for(var r=0;r<e;r++){var o=s._tasks.shift();n.push(o),a.push(o),t.push(o.data)}c+=1,0===s._tasks.length&&s.empty(),c===s.concurrency&&s.saturated();var i=S(function(i){return function(n){--c;for(var t=0,e=i.length;t<e;t++){var r=i[t],o=Pn(a,r,0);0===o?a.shift():0<o&&a.splice(o,1),r.callback.apply(r,arguments),null!=n&&s.error(n,r.data)}c<=s.concurrency-s.buffer&&s.unsaturated(),s.idle()&&s.drain(),s.process()}}(n));u(t,i)}l=!1}},length:function(){return s._tasks.length},running:function(){return c},workersList:function(){return a},idle:function(){return s._tasks.length+c===0},pause:function(){s.paused=!0},resume:function(){!1!==s.paused&&(s.paused=!1,p(s.process))}};return s}function rt(n,t){return et(n,1,t)}F.prototype.removeLink=function(n){return n.prev?n.prev.next=n.next:this.head=n.next,n.next?n.next.prev=n.prev:this.tail=n.prev,n.prev=n.next=null,--this.length,n},F.prototype.empty=function(){for(;this.head;)this.shift();return this},F.prototype.insertAfter=function(n,t){t.prev=n,t.next=n.next,n.next?n.next.prev=t:this.tail=t,n.next=t,this.length+=1},F.prototype.insertBefore=function(n,t){t.prev=n.prev,(t.next=n).prev?n.prev.next=t:this.head=t,n.prev=t,this.length+=1},F.prototype.unshift=function(n){this.head?this.insertBefore(this.head,n):tt(this,n)},F.prototype.push=function(n){this.tail?this.insertAfter(this.tail,n):tt(this,n)},F.prototype.shift=function(){return this.head&&this.removeLink(this.head)},F.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},F.prototype.toArray=function(){for(var n=Array(this.length),t=this.head,e=0;e<this.length;e++)n[e]=t.data,t=t.next;return n},F.prototype.remove=function(n){for(var t=this.head;t;){var e=t.next;n(t)&&this.removeLink(t),t=e}return this};var I=v(y,1);function M(n,r,t,e){e=b(e||g);var o=m(t);I(n,function(n,t,e){o(r,n,function(n,t){r=t,e(n)})},function(n){e(n,r)})}function ot(){var t=E(arguments,m);return function(){var n=d(arguments),r=this,e=n[n.length-1];"function"==typeof e?n.pop():e=g,M(t,n,function(n,t,e){t.apply(r,n.concat(function(n){var t=d(arguments,1);e(n,t)}))},function(n,t){e.apply(r,[n].concat(t))})}}function it(){return ot.apply(null,d(arguments).reverse())}function ut(n,t,e,o){o=o||g;var r=m(e);w(n,t,function(n,t){r(n,function(n){return n?t(n):t(null,d(arguments,1))})},function(n,t){for(var e=[],r=0;r<t.length;r++)t[r]&&(e=at.apply(e,t[r]));return o(n,e)})}function ct(){var n=d(arguments),t=[null].concat(n);return function(){return arguments[arguments.length-1].apply(this,t)}}var at=Array.prototype.concat,i=v(ut,1/0),Wn=v(ut,1);function ft(n){return n}function U(c,a){return function(n,t,o,e){e=e||g;var i,u=!1;n(t,function(e,n,r){o(e,function(n,t){n?r(n):c(t)&&!i?(i=a(u=!0,e),r(null,un)):r()})},function(n){n?e(n):e(null,u?i:a(!1))})}}function lt(n,t){return t}A=L(U(ft,lt)),T=O(U(ft,lt)),f=v(T,1);function st(e){return function(n){var t=d(arguments,1);t.push(function(n){var t=d(arguments,1);"object"==typeof console&&(n?console.error&&console.error(n):console[e]&&Mn(t,function(n){console[e](n)}))}),m(n).apply(null,t)}}Nn=st("dir");function pt(n,t,e){e=S(e||g);var r=m(n),o=m(t);function i(n){if(n)return e(n);n=d(arguments,1);n.push(u),o.apply(this,n)}function u(n,t){return n?e(n):t?void r(i):e(null)}u(null,!0)}function ht(n,t,e){e=S(e||g);function r(n){return n?e(n):(n=d(arguments,1),t.apply(this,n)?o(r):void e.apply(null,[null].concat(n)))}var o=m(n);o(r)}function yt(n,t,e){ht(n,function(){return!t.apply(this,arguments)},e)}function vt(n,t,e){e=S(e||g);var r=m(t),o=m(n);function i(n){if(n)return e(n);o(u)}function u(n,t){return n?e(n):t?void r(i):e(null)}o(u)}function dt(r){return function(n,t,e){return r(n,e)}}function mt(n,t,e){k(n,dt(m(t)),e)}function gt(n,t,e,r){Tn(t)(n,dt(m(e)),r)}var bt=v(gt,1);function jt(r){return W(r)?r:a(function(n,t){var e=!0;n.push(function(){var n=arguments;e?p(function(){t.apply(null,n)}):t.apply(null,n)}),r.apply(this,n),e=!1})}function St(n){return!n}var _=L(U(St,St)),B=O(U(St,St)),kt=v(B,1);function Lt(t){return function(n){return null==n?void 0:n[t]}}function Ot(n,r,t,o){var i=new Array(r.length);n(r,function(n,e,r){t(n,function(n,t){i[e]=!!t,r(n)})},function(n){if(n)return o(n);for(var t=[],e=0;e<r.length;e++)i[e]&&t.push(r[e]);o(null,t)})}function wt(n,t,i,e){var u=[];n(t,function(e,r,o){i(e,function(n,t){n?o(n):(t&&u.push({index:r,value:e}),o())})},function(n){n?e(n):e(null,E(u.sort(function(n,t){return n.index-t.index}),Lt("value")))})}function xt(n,t,e,r){(s(t)?Ot:wt)(n,t,m(e),r||g)}var Et=L(xt),At=O(xt),Tt=v(At,1);function _t(n,t){var e=S(t||g),r=m(jt(n));!function n(t){if(t)return e(t);r(n)}()}function Bt(n,t,e,c){c=c||g;var o=m(e);w(n,t,function(e,r){o(e,function(n,t){return n?r(n):r(null,{key:t,val:e})})},function(n,t){for(var e,r,o={},i=Object.prototype.hasOwnProperty,u=0;u<t.length;u++)t[u]&&(e=t[u].key,r=t[u].val,i.call(o,e)?o[e].push(r):o[e]=[r]);return c(n,o)})}var Ft=v(Bt,1/0),It=v(Bt,1),Mt=st("log");function Ut(n,t,e,r){r=b(r||g);var o={},i=m(e);y(n,t,function(n,e,r){i(n,e,function(n,t){if(n)return r(n);o[e]=t,r()})},function(n){r(n,o)})}var qt=v(Ut,1/0),zt=v(Ut,1);function Pt(n,e){var i=Object.create(null),u=Object.create(null),r=(e=e||ft,m(n)),t=a(function(n,t){var o=e.apply(null,n);o in i?p(function(){t.apply(null,i[o])}):o in u?u[o].push(t):(u[o]=[t],r.apply(null,n.concat(function(){var n=d(arguments),t=(i[o]=n,u[o]);delete u[o];for(var e=0,r=t.length;e<r;e++)t[e].apply(null,n)})))});return t.memo=i,t.unmemoized=n,t}t=D(t?process.nextTick:P?setImmediate:V);function Vt(n,t,e){e=e||g;var o=s(t)?[]:{};n(t,function(n,e,r){m(n)(function(n,t){2<arguments.length&&(t=d(arguments,1)),o[e]=t,r(n)})},function(n){e(n,o)})}function Dt(n,t){Vt(k,n,t)}function Rt(n,t,e){Vt(Tn(t),n,e)}function Ct(n,t){var e=m(n);return et(function(n,t){e(n[0],t)},t,1)}function $t(n,t){var c=Ct(n,t);return c.push=function(n,t,e){if("function"!=typeof(e=null==e?g:e))throw new Error("task callback must be a function");if(c.started=!0,0===(n=j(n)?n:[n]).length)return p(function(){c.drain()});t=t||0;for(var r=c._tasks.head;r&&t>=r.priority;)r=r.next;for(var o=0,i=n.length;o<i;o++){var u={data:n[o],priority:t,callback:e};r?c._tasks.insertBefore(r,u):c._tasks.push(u)}p(c.process)},delete c.unshift,c}function Wt(n,t){if(t=b(t||g),!j(n))return t(new TypeError("First argument to race must be an array of functions"));if(!n.length)return t();for(var e=0,r=n.length;e<r;e++)m(n[e])(t)}function Nt(n,t,e,r){M(d(n).reverse(),t,e,r)}function Qt(n){var t=m(n);return a(function(n,e){return n.push(function(n,t){n?e(null,{error:n}):(n=arguments.length<=2?t:d(arguments,1),e(null,{value:n}))}),t.apply(this,n)})}function Gt(n){var e;return j(n)?e=E(n,Qt):(e={},x(n,function(n,t){e[t]=Qt.call(this,n)})),e}function Ht(n,t,r,e){xt(n,t,function(n,e){r(n,function(n,t){e(n,!t)})},e)}var P=L(Ht),Jt=O(Ht),Kt=v(Jt,1);function Xt(n){return function(){return n}}function Yt(n,t,e){var r={times:5,intervalFunc:Xt(0)};if(arguments.length<3&&"function"==typeof n)e=t||g,t=n;else{var o=r;if("object"==typeof n)o.times=+n.times||5,o.intervalFunc="function"==typeof n.interval?n.interval:Xt(+n.interval||0),o.errorFilter=n.errorFilter;else{if("number"!=typeof n&&"string"!=typeof n)throw new Error("Invalid arguments for async.retry");o.times=+n||5}e=e||g}if("function"!=typeof t)throw new Error("Invalid arguments for async.retry");var i=m(t),u=1;!function t(){i(function(n){n&&u++<r.times&&("function"!=typeof r.errorFilter||r.errorFilter(n))?setTimeout(t,r.intervalFunc(u)):e.apply(null,arguments)})}()}function Zt(r,n){n||(n=r,r=null);var o=m(n);return a(function(t,n){function e(n){o.apply(null,t.concat(n))}r?Yt(r,e,n):Yt(e,n)})}function ne(n,t){Vt(I,n,t)}var te=L(U(Boolean,ft)),ee=O(U(Boolean,ft)),re=v(ee,1);function oe(n,t,e){var o=m(t);function r(n,t){n=n.criteria,t=t.criteria;return n<t?-1:t<n?1:0}In(n,function(e,r){o(e,function(n,t){if(n)return r(n);r(null,{value:e,criteria:t})})},function(n,t){if(n)return e(n);e(null,E(t.sort(r),Lt("value")))})}function ie(o,i,u){var c=m(o);return a(function(n,t){var e,r=!1;n.push(function(){r||(t.apply(null,arguments),clearTimeout(e))}),e=setTimeout(function(){var n=o.name||"anonymous";(n=new Error('Callback function "'+n+'" timed out.')).code="ETIMEDOUT",u&&(n.info=u),r=!0,t(n)},i),c.apply(null,n)})}var ue=Math.ceil,ce=Math.max;function ae(n,t,e,r){e=m(e);w(function(n,t,e,r){for(var o=-1,i=ce(ue((t-n)/(e||1)),0),u=Array(i);i--;)u[r?i:++o]=n,n+=e;return u}(0,n,1),t,e,r)}var fe=v(ae,1/0),le=v(ae,1);function se(n,r,t,e){arguments.length<=3&&(e=t,t=r,r=j(n)?[]:{}),e=b(e||g);var o=m(t);k(n,function(n,t,e){o(r,n,t,e)},function(n){e(n,r)})}function pe(n,t){var r,o=null;t=t||g,bt(n,function(n,e){m(n)(function(n,t){r=2<arguments.length?d(arguments,1):t,e(!(o=n))})},function(){t(o,r)})}function he(n){return function(){return(n.unmemoized||n).apply(null,arguments)}}function ye(t,n,e){e=S(e||g);var r=m(n);if(!t())return e(null);function o(n){return n?e(n):t()?r(o):(n=d(arguments,1),void e.apply(null,[null].concat(n)))}r(o)}function ve(n,t,e){ye(function(){return!n.apply(this,arguments)},t,e)}function de(e,t){var r;return t=b(t||g),j(e)?e.length?(r=0,void o([])):t():t(new Error("First argument to waterfall must be an array of functions"));function o(n){var t=m(e[r++]);n.push(S(i)),t.apply(null,n)}function i(n){if(n||r===e.length)return t.apply(null,arguments);o(d(arguments,1))}}n.default={apply:q,applyEach:u,applyEachSeries:o,asyncify:e,auto:Vn,autoInject:nt,cargo:rt,compose:it,concat:i,concatLimit:ut,concatSeries:Wn,constant:ct,detect:A,detectLimit:T,detectSeries:f,dir:Nn,doDuring:pt,doUntil:yt,doWhilst:ht,during:vt,each:mt,eachLimit:gt,eachOf:k,eachOfLimit:y,eachOfSeries:I,eachSeries:bt,ensureAsync:jt,every:_,everyLimit:B,everySeries:kt,filter:Et,filterLimit:At,filterSeries:Tt,forever:_t,groupBy:Ft,groupByLimit:Bt,groupBySeries:It,log:Mt,map:In,mapLimit:w,mapSeries:r,mapValues:qt,mapValuesLimit:Ut,mapValuesSeries:zt,memoize:Pt,nextTick:t,parallel:Dt,parallelLimit:Rt,priorityQueue:$t,queue:Ct,race:Wt,reduce:M,reduceRight:Nt,reflect:Qt,reflectAll:Gt,reject:P,rejectLimit:Jt,rejectSeries:Kt,retry:Yt,retryable:Zt,seq:ot,series:ne,setImmediate:p,some:te,someLimit:ee,someSeries:re,sortBy:oe,timeout:ie,times:fe,timesLimit:ae,timesSeries:le,transform:se,tryEach:pe,unmemoize:he,until:ve,waterfall:de,whilst:ye,all:_,allLimit:B,allSeries:kt,any:te,anyLimit:ee,anySeries:re,find:A,findLimit:T,findSeries:f,forEach:mt,forEachSeries:bt,forEachLimit:gt,forEachOf:k,forEachOfSeries:I,forEachOfLimit:y,inject:M,foldl:M,foldr:Nt,select:Et,selectLimit:At,selectSeries:Tt,wrapSync:e},n.apply=q,n.applyEach=u,n.applyEachSeries=o,n.asyncify=e,n.auto=Vn,n.autoInject=nt,n.cargo=rt,n.compose=it,n.concat=i,n.concatLimit=ut,n.concatSeries=Wn,n.constant=ct,n.detect=A,n.detectLimit=T,n.detectSeries=f,n.dir=Nn,n.doDuring=pt,n.doUntil=yt,n.doWhilst=ht,n.during=vt,n.each=mt,n.eachLimit=gt,n.eachOf=k,n.eachOfLimit=y,n.eachOfSeries=I,n.eachSeries=bt,n.ensureAsync=jt,n.every=_,n.everyLimit=B,n.everySeries=kt,n.filter=Et,n.filterLimit=At,n.filterSeries=Tt,n.forever=_t,n.groupBy=Ft,n.groupByLimit=Bt,n.groupBySeries=It,n.log=Mt,n.map=In,n.mapLimit=w,n.mapSeries=r,n.mapValues=qt,n.mapValuesLimit=Ut,n.mapValuesSeries=zt,n.memoize=Pt,n.nextTick=t,n.parallel=Dt,n.parallelLimit=Rt,n.priorityQueue=$t,n.queue=Ct,n.race=Wt,n.reduce=M,n.reduceRight=Nt,n.reflect=Qt,n.reflectAll=Gt,n.reject=P,n.rejectLimit=Jt,n.rejectSeries=Kt,n.retry=Yt,n.retryable=Zt,n.seq=ot,n.series=ne,n.setImmediate=p,n.some=te,n.someLimit=ee,n.someSeries=re,n.sortBy=oe,n.timeout=ie,n.times=fe,n.timesLimit=ae,n.timesSeries=le,n.transform=se,n.tryEach=pe,n.unmemoize=he,n.until=ve,n.waterfall=de,n.whilst=ye,n.all=_,n.allLimit=B,n.allSeries=kt,n.any=te,n.anyLimit=ee,n.anySeries=re,n.find=A,n.findLimit=T,n.findSeries=f,n.forEach=mt,n.forEachSeries=bt,n.forEachLimit=gt,n.forEachOf=k,n.forEachOfSeries=I,n.forEachOfLimit=y,n.inject=M,n.foldl=M,n.foldr=Nt,n.select=Et,n.selectLimit=At,n.selectSeries=Tt,n.wrapSync=e,Object.defineProperty(n,"__esModule",{value:!0})});
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.L={})}(this,function(t){"use strict";function h(t){for(var i,e,n=1,o=arguments.length;n<o;n++)for(i in e=arguments[n])t[i]=e[i];return t}var R=Object.create||function(t){return N.prototype=t,new N};function N(){}function _(t,i){var e,n=Array.prototype.slice;return t.bind?t.bind.apply(t,n.call(arguments,1)):(e=n.call(arguments,2),function(){return t.apply(i,e.length?e.concat(n.call(arguments)):arguments)})}var D=0;function m(t){return t._leaflet_id=t._leaflet_id||++D,t._leaflet_id}function j(t,i,e){var n,o,s=function(){n=!1,o&&(r.apply(e,o),o=!1)},r=function(){n?o=arguments:(t.apply(e,arguments),setTimeout(s,i),n=!0)};return r}function W(t,i,e){var n=i[1],i=i[0],o=n-i;return t===n&&e?t:((t-i)%o+o)%o+i}function a(){return!1}function e(t,i){i=Math.pow(10,void 0===i?6:i);return Math.round(t*i)/i}function H(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function F(t){return H(t).split(/\s+/)}function s(t,i){for(var e in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?R(t.options):{}),i)t.options[e]=i[e];return t.options}function U(t,i,e){var n,o=[];for(n in t)o.push(encodeURIComponent(e?n.toUpperCase():n)+"="+encodeURIComponent(t[n]));return(i&&-1!==i.indexOf("?")?"&":"?")+o.join("&")}var V=/\{ *([\w_-]+) *\}/g;function q(t,e){return t.replace(V,function(t,i){i=e[i];if(void 0===i)throw new Error("No value provided for variable "+t);return i="function"==typeof i?i(e):i})}var u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function G(t,i){for(var e=0;e<t.length;e++)if(t[e]===i)return e;return-1}var K="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Y(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var X=0;function J(t){var i=+new Date,e=Math.max(0,16-(i-X));return X=i+e,window.setTimeout(t,e)}var $=window.requestAnimationFrame||Y("RequestAnimationFrame")||J,Q=window.cancelAnimationFrame||Y("CancelAnimationFrame")||Y("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function x(t,i,e){if(!e||$!==J)return $.call(window,_(t,i));t.call(i)}function r(t){t&&Q.call(window,t)}var tt={extend:h,create:R,bind:_,lastId:D,stamp:m,throttle:j,wrapNum:W,falseFn:a,formatNum:e,trim:H,splitWords:F,setOptions:s,getParamString:U,template:q,isArray:u,indexOf:G,emptyImageUrl:K,requestFn:$,cancelFn:Q,requestAnimFrame:x,cancelAnimFrame:r};function it(){}it.extend=function(t){function i(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()}var e,n=i.__super__=this.prototype,o=R(n);for(e in(o.constructor=i).prototype=o,this)Object.prototype.hasOwnProperty.call(this,e)&&"prototype"!==e&&"__super__"!==e&&(i[e]=this[e]);if(t.statics&&(h(i,t.statics),delete t.statics),t.includes){var s=t.includes;if("undefined"!=typeof L&&L&&L.Mixin){s=u(s)?s:[s];for(var r=0;r<s.length;r++)s[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}h.apply(null,[o].concat(t.includes)),delete t.includes}return o.options&&(t.options=h(R(o.options),t.options)),h(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,i=o._initHooks.length;t<i;t++)o._initHooks[t].call(this)}},i},it.include=function(t){return h(this.prototype,t),this},it.mergeOptions=function(t){return h(this.prototype.options,t),this},it.addInitHook=function(t){var i=Array.prototype.slice.call(arguments,1),e="function"==typeof t?t:function(){this[t].apply(this,i)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(e),this};var i={on:function(t,i,e){if("object"==typeof t)for(var n in t)this._on(n,t[n],i);else for(var o=0,s=(t=F(t)).length;o<s;o++)this._on(t[o],i,e);return this},off:function(t,i,e){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],i);else for(var o=0,s=(t=F(t)).length;o<s;o++)this._off(t[o],i,e);else delete this._events;return this},_on:function(t,i,e){this._events=this._events||{};for(var n=this._events[t],t=(n||(this._events[t]=n=[]),{fn:i,ctx:e=e===this?void 0:e}),o=n,s=0,r=o.length;s<r;s++)if(o[s].fn===i&&o[s].ctx===e)return;o.push(t)},_off:function(t,i,e){var n,o,s;if(this._events&&(n=this._events[t]))if(i){if(e===this&&(e=void 0),n)for(o=0,s=n.length;o<s;o++){var r=n[o];if(r.ctx===e&&r.fn===i)return r.fn=a,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(o,1)}}else{for(o=0,s=n.length;o<s;o++)n[o].fn=a;delete this._events[t]}},fire:function(t,i,e){if(this.listens(t,e)){var n=h({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var s=0,r=o.length;s<r;s++){var a=o[s];a.fn.call(a.ctx||this,n)}this._firingCount--}}e&&this._propagateEvent(n)}return this},listens:function(t,i){var e=this._events&&this._events[t];if(e&&e.length)return!0;if(i)for(var n in this._eventParents)if(this._eventParents[n].listens(t,i))return!0;return!1},once:function(t,i,e){if("object"==typeof t){for(var n in t)this.once(n,t[n],i);return this}var o=_(function(){this.off(t,i,e).off(t,o,e)},this);return this.on(t,i,e).on(t,o,e)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[m(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[m(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,h({layer:t.target,propagatedFrom:t.target},t),!0)}},et=(i.addEventListener=i.on,i.removeEventListener=i.clearAllEventListeners=i.off,i.addOneTimeEventListener=i.once,i.fireEvent=i.fire,i.hasEventListeners=i.listens,it.extend(i));function p(t,i,e){this.x=e?Math.round(t):t,this.y=e?Math.round(i):i}var nt=Math.trunc||function(t){return 0<t?Math.floor(t):Math.ceil(t)};function l(t,i,e){return t instanceof p?t:u(t)?new p(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new p(t.x,t.y):new p(t,i,e)}function f(t,i){if(t)for(var e=i?[t,i]:t,n=0,o=e.length;n<o;n++)this.extend(e[n])}function c(t,i){return!t||t instanceof f?t:new f(t,i)}function d(t,i){if(t)for(var e=i?[t,i]:t,n=0,o=e.length;n<o;n++)this.extend(e[n])}function g(t,i){return t instanceof d?t:new d(t,i)}function v(t,i,e){if(isNaN(t)||isNaN(i))throw new Error("Invalid LatLng object: ("+t+", "+i+")");this.lat=+t,this.lng=+i,void 0!==e&&(this.alt=+e)}function w(t,i,e){return t instanceof v?t:u(t)&&"object"!=typeof t[0]?3===t.length?new v(t[0],t[1],t[2]):2===t.length?new v(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new v(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===i?null:new v(t,i,e)}p.prototype={clone:function(){return new p(this.x,this.y)},add:function(t){return this.clone()._add(l(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(l(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new p(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new p(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=nt(this.x),this.y=nt(this.y),this},distanceTo:function(t){var i=(t=l(t)).x-this.x,t=t.y-this.y;return Math.sqrt(i*i+t*t)},equals:function(t){return(t=l(t)).x===this.x&&t.y===this.y},contains:function(t){return t=l(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+e(this.x)+", "+e(this.y)+")"}},f.prototype={extend:function(t){return t=l(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new p((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new p(this.min.x,this.max.y)},getTopRight:function(){return new p(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var i,e;return(t=("number"==typeof t[0]||t instanceof p?l:c)(t))instanceof f?(i=t.min,e=t.max):i=e=t,i.x>=this.min.x&&e.x<=this.max.x&&i.y>=this.min.y&&e.y<=this.max.y},intersects:function(t){t=c(t);var i=this.min,e=this.max,n=t.min,t=t.max,o=t.x>=i.x&&n.x<=e.x,t=t.y>=i.y&&n.y<=e.y;return o&&t},overlaps:function(t){t=c(t);var i=this.min,e=this.max,n=t.min,t=t.max,o=t.x>i.x&&n.x<e.x,t=t.y>i.y&&n.y<e.y;return o&&t},isValid:function(){return!(!this.min||!this.max)}},d.prototype={extend:function(t){var i,e,n=this._southWest,o=this._northEast;if(t instanceof v)e=i=t;else{if(!(t instanceof d))return t?this.extend(w(t)||g(t)):this;if(i=t._southWest,e=t._northEast,!i||!e)return this}return n||o?(n.lat=Math.min(i.lat,n.lat),n.lng=Math.min(i.lng,n.lng),o.lat=Math.max(e.lat,o.lat),o.lng=Math.max(e.lng,o.lng)):(this._southWest=new v(i.lat,i.lng),this._northEast=new v(e.lat,e.lng)),this},pad:function(t){var i=this._southWest,e=this._northEast,n=Math.abs(i.lat-e.lat)*t,t=Math.abs(i.lng-e.lng)*t;return new d(new v(i.lat-n,i.lng-t),new v(e.lat+n,e.lng+t))},getCenter:function(){return new v((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new v(this.getNorth(),this.getWest())},getSouthEast:function(){return new v(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t=("number"==typeof t[0]||t instanceof v||"lat"in t?w:g)(t);var i,e,n=this._southWest,o=this._northEast;return t instanceof d?(i=t.getSouthWest(),e=t.getNorthEast()):i=e=t,i.lat>=n.lat&&e.lat<=o.lat&&i.lng>=n.lng&&e.lng<=o.lng},intersects:function(t){t=g(t);var i=this._southWest,e=this._northEast,n=t.getSouthWest(),t=t.getNorthEast(),o=t.lat>=i.lat&&n.lat<=e.lat,t=t.lng>=i.lng&&n.lng<=e.lng;return o&&t},overlaps:function(t){t=g(t);var i=this._southWest,e=this._northEast,n=t.getSouthWest(),t=t.getNorthEast(),o=t.lat>i.lat&&n.lat<e.lat,t=t.lng>i.lng&&n.lng<e.lng;return o&&t},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,i){return!!t&&(t=g(t),this._southWest.equals(t.getSouthWest(),i))&&this._northEast.equals(t.getNorthEast(),i)},isValid:function(){return!(!this._southWest||!this._northEast)}};var ot={latLngToPoint:function(t,i){t=this.projection.project(t),i=this.scale(i);return this.transformation._transform(t,i)},pointToLatLng:function(t,i){i=this.scale(i),t=this.transformation.untransform(t,i);return this.projection.unproject(t)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){var i;return this.infinite?null:(i=this.projection.bounds,t=this.scale(t),new f(this.transformation.transform(i.min,t),this.transformation.transform(i.max,t)))},infinite:!(v.prototype={equals:function(t,i){return!!t&&(t=w(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===i?1e-9:i))},toString:function(t){return"LatLng("+e(this.lat,t)+", "+e(this.lng,t)+")"},distanceTo:function(t){return st.distance(this,w(t))},wrap:function(){return st.wrapLatLng(this)},toBounds:function(t){var t=180*t/40075017,i=t/Math.cos(Math.PI/180*this.lat);return g([this.lat-t,this.lng-i],[this.lat+t,this.lng+i])},clone:function(){return new v(this.lat,this.lng,this.alt)}}),wrapLatLng:function(t){var i=this.wrapLng?W(t.lng,this.wrapLng,!0):t.lng;return new v(this.wrapLat?W(t.lat,this.wrapLat,!0):t.lat,i,t.alt)},wrapLatLngBounds:function(t){var i=t.getCenter(),e=this.wrapLatLng(i),n=i.lat-e.lat,i=i.lng-e.lng;return 0==n&&0==i?t:(e=t.getSouthWest(),t=t.getNorthEast(),new d(new v(e.lat-n,e.lng-i),new v(t.lat-n,t.lng-i)))}},st=h({},ot,{wrapLng:[-180,180],R:6371e3,distance:function(t,i){var e=Math.PI/180,n=t.lat*e,o=i.lat*e,s=Math.sin((i.lat-t.lat)*e/2),i=Math.sin((i.lng-t.lng)*e/2),t=s*s+Math.cos(n)*Math.cos(o)*i*i,e=2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t));return this.R*e}}),n=6378137,n={R:n,MAX_LATITUDE:85.0511287798,project:function(t){var i=Math.PI/180,e=this.MAX_LATITUDE,e=Math.max(Math.min(e,t.lat),-e),e=Math.sin(e*i);return new p(this.R*t.lng*i,this.R*Math.log((1+e)/(1-e))/2)},unproject:function(t){var i=180/Math.PI;return new v((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*i,t.x*i/this.R)},bounds:new f([-(n=n*Math.PI),-n],[n,n])};function rt(t,i,e,n){u(t)?(this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3]):(this._a=t,this._b=i,this._c=e,this._d=n)}function at(t,i,e,n){return new rt(t,i,e,n)}rt.prototype={transform:function(t,i){return this._transform(t.clone(),i)},_transform:function(t,i){return t.x=(i=i||1)*(this._a*t.x+this._b),t.y=i*(this._c*t.y+this._d),t},untransform:function(t,i){return new p((t.x/(i=i||1)-this._b)/this._a,(t.y/i-this._d)/this._c)}};var ht=h({},st,{code:"EPSG:3857",projection:n,transformation:at(ht=.5/(Math.PI*n.R),.5,-ht,.5)}),ut=h({},ht,{code:"EPSG:900913"});function lt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ct(t,i){for(var e,n,o,s,r="",a=0,h=t.length;a<h;a++){for(e=0,n=(o=t[a]).length;e<n;e++)r+=(e?"L":"M")+(s=o[e]).x+" "+s.y;r+=i?Nt?"z":"x":""}return r||"M0 0"}var _t=document.documentElement.style,dt="ActiveXObject"in window,pt=dt&&!document.addEventListener,mt="msLaunchUri"in navigator&&!("documentMode"in document),ft=jt("webkit"),gt=jt("android"),vt=jt("android 2")||jt("android 3"),yt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),xt=gt&&jt("Google")&&yt<537&&!("AudioNode"in window),yt=!!window.opera,wt=!mt&&jt("chrome"),Pt=jt("gecko")&&!ft&&!yt&&!dt,Lt=!wt&&jt("safari"),o=jt("phantom"),bt="OTransition"in _t,Tt=0===navigator.platform.indexOf("Win"),Mt=dt&&"transition"in _t,zt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!vt,_t="MozPerspective"in _t,P=!window.L_DISABLE_3D&&(Mt||zt||_t)&&!bt&&!o,Ct="undefined"!=typeof orientation||jt("mobile"),St=Ct&&ft,Zt=Ct&&zt,y=!window.PointerEvent&&window.MSPointerEvent,Et=!(!window.PointerEvent&&!y),kt=!window.L_NO_TOUCH&&(Et||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Bt=Ct&&yt,At=Ct&&Pt,It=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),Ot=function(){var t=!1;try{var i=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",a,i),window.removeEventListener("testPassiveEventSupport",a,i)}catch(t){}return t}(),Rt=!!document.createElement("canvas").getContext,Nt=!(!document.createElementNS||!lt("svg").createSVGRect),Dt=!Nt&&function(){try{var t=document.createElement("div"),i=(t.innerHTML='<v:shape adj="1"/>',t.firstChild);return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(t){return!1}}();function jt(t){return 0<=navigator.userAgent.toLowerCase().indexOf(t)}var dt={ie:dt,ielt9:pt,edge:mt,webkit:ft,android:gt,android23:vt,androidStock:xt,opera:yt,chrome:wt,gecko:Pt,safari:Lt,phantom:o,opera12:bt,win:Tt,ie3d:Mt,webkit3d:zt,gecko3d:_t,any3d:P,mobile:Ct,mobileWebkit:St,mobileWebkit3d:Zt,msPointer:y,pointer:Et,touch:kt,mobileOpera:Bt,mobileGecko:At,retina:It,passiveEvents:Ot,canvas:Rt,svg:Nt,vml:Dt},Wt=y?"MSPointerDown":"pointerdown",Ht=y?"MSPointerMove":"pointermove",Ft=y?"MSPointerUp":"pointerup",Ut=y?"MSPointerCancel":"pointercancel",Vt={},qt=!1;function Gt(t,i,e,n){function o(t){Jt(t,s)}var s,r,a,h,u,l;function c(t){t.pointerType===(t.MSPOINTER_TYPE_MOUSE||"mouse")&&0===t.buttons||Jt(t,r)}"touchstart"===i?(a=t,h=e,u=n,l=_(function(t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&B(t),Jt(t,h)}),a["_leaflet_touchstart"+u]=l,a.addEventListener(Wt,l,!1),qt||(document.addEventListener(Wt,Kt,!0),document.addEventListener(Ht,Yt,!0),document.addEventListener(Ft,Xt,!0),document.addEventListener(Ut,Xt,!0),qt=!0)):"touchmove"===i?(r=e,(u=t)["_leaflet_touchmove"+n]=c,u.addEventListener(Ht,c,!1)):"touchend"===i&&(s=e,(a=t)["_leaflet_touchend"+n]=o,a.addEventListener(Ft,o,!1),a.addEventListener(Ut,o,!1))}function Kt(t){Vt[t.pointerId]=t}function Yt(t){Vt[t.pointerId]&&(Vt[t.pointerId]=t)}function Xt(t){delete Vt[t.pointerId]}function Jt(t,i){for(var e in t.touches=[],Vt)t.touches.push(Vt[e]);t.changedTouches=[t],i(t)}var $t=y?"MSPointerDown":Et?"pointerdown":"touchstart",Qt=y?"MSPointerUp":Et?"pointerup":"touchend",ti="_leaflet_";var ii,ei,ni,oi,si,ri,ai=vi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),hi=vi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ui="webkitTransition"===hi||"OTransition"===hi?hi+"End":"transitionend";function li(t){return"string"==typeof t?document.getElementById(t):t}function ci(t,i){var e=t.style[i]||t.currentStyle&&t.currentStyle[i];return"auto"===(e=e&&"auto"!==e||!document.defaultView?e:(t=document.defaultView.getComputedStyle(t,null))?t[i]:null)?null:e}function b(t,i,e){t=document.createElement(t);return t.className=i||"",e&&e.appendChild(t),t}function T(t){var i=t.parentNode;i&&i.removeChild(t)}function _i(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function di(t){var i=t.parentNode;i&&i.lastChild!==t&&i.appendChild(t)}function pi(t){var i=t.parentNode;i&&i.firstChild!==t&&i.insertBefore(t,i.firstChild)}function mi(t,i){return void 0!==t.classList?t.classList.contains(i):0<(t=gi(t)).length&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(t)}function M(t,i){var e;if(void 0!==t.classList)for(var n=F(i),o=0,s=n.length;o<s;o++)t.classList.add(n[o]);else mi(t,i)||fi(t,((e=gi(t))?e+" ":"")+i)}function z(t,i){void 0!==t.classList?t.classList.remove(i):fi(t,H((" "+gi(t)+" ").replace(" "+i+" "," ")))}function fi(t,i){void 0===t.className.baseVal?t.className=i:t.className.baseVal=i}function gi(t){return void 0===(t=t.correspondingElement?t.correspondingElement:t).className.baseVal?t.className:t.className.baseVal}function C(t,i){if("opacity"in t.style)t.style.opacity=i;else if("filter"in t.style){var e=!1,n="DXImageTransform.Microsoft.Alpha";try{e=t.filters.item(n)}catch(t){if(1===i)return}i=Math.round(100*i),e?(e.Enabled=100!==i,e.Opacity=i):t.style.filter+=" progid:"+n+"(opacity="+i+")"}}function vi(t){for(var i=document.documentElement.style,e=0;e<t.length;e++)if(t[e]in i)return t[e];return!1}function yi(t,i,e){i=i||new p(0,0);t.style[ai]=(Mt?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(e?" scale("+e+")":"")}function S(t,i){t._leaflet_pos=i,P?yi(t,i):(t.style.left=i.x+"px",t.style.top=i.y+"px")}function xi(t){return t._leaflet_pos||new p(0,0)}function wi(){Z(window,"dragstart",B)}function Pi(){k(window,"dragstart",B)}function Li(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(bi(),ri=(si=t).style.outline,t.style.outline="none",Z(window,"keydown",bi))}function bi(){si&&(si.style.outline=ri,ri=si=void 0,k(window,"keydown",bi))}function Ti(t){for(;!((t=t.parentNode).offsetWidth&&t.offsetHeight||t===document.body););return t}function Mi(t){var i=t.getBoundingClientRect();return{x:i.width/t.offsetWidth||1,y:i.height/t.offsetHeight||1,boundingClientRect:i}}oi="onselectstart"in document?(ni=function(){Z(window,"selectstart",B)},function(){k(window,"selectstart",B)}):(ei=vi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),ni=function(){var t;ei&&(t=document.documentElement.style,ii=t[ei],t[ei]="none")},function(){ei&&(document.documentElement.style[ei]=ii,ii=void 0)});ft={TRANSFORM:ai,TRANSITION:hi,TRANSITION_END:ui,get:li,getStyle:ci,create:b,remove:T,empty:_i,toFront:di,toBack:pi,hasClass:mi,addClass:M,removeClass:z,setClass:fi,getClass:gi,setOpacity:C,testProp:vi,setTransform:yi,setPosition:S,getPosition:xi,disableTextSelection:ni,enableTextSelection:oi,disableImageDrag:wi,enableImageDrag:Pi,preventOutline:Li,restoreOutline:bi,getSizedParentNode:Ti,getScale:Mi};function Z(t,i,e,n){if("object"==typeof i)for(var o in i)Si(t,o,i[o],e);else for(var s=0,r=(i=F(i)).length;s<r;s++)Si(t,i[s],e,n);return this}var E="_leaflet_events";function k(t,i,e,n){if("object"==typeof i)for(var o in i)Zi(t,o,i[o],e);else if(i)for(var s=0,r=(i=F(i)).length;s<r;s++)Zi(t,i[s],e,n);else{for(var a in t[E])Zi(t,a,t[E][a]);delete t[E]}return this}function zi(){return Et&&!mt&&!Lt}var Ci={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Si(i,t,e,n){var o,s,r,a,h,u,l,c,_=t+m(e)+(n?"_"+m(n):"");function d(t){if(Et){if(!t.isPrimary)return;if("mouse"===t.pointerType)return}else if(1<t.touches.length)return;var i=Date.now(),e=i-(u||i);l=t.touches?t.touches[0]:t,c=0<e&&e<=250,u=i}function p(t){if(c&&!l.cancelBubble){if(Et){if("mouse"===t.pointerType)return;var i,e,n={};for(e in l)i=l[e],n[e]=i&&i.bind?i.bind(l):i;l=n}l.type="dblclick",l.button=0,a(l),u=null}}i[E]&&i[E][_]||(s=o=function(t){return e.call(n||i,t||window.event)},Et&&0===t.indexOf("touch")?Gt(i,t,o,_):kt&&"dblclick"===t&&!zi()?(a=o,c=!1,(r=i)[ti+$t+(h=_)]=d,r[ti+Qt+h]=p,r[ti+"dblclick"+h]=a,r.addEventListener($t,d,!!Ot&&{passive:!1}),r.addEventListener(Qt,p,!!Ot&&{passive:!1}),r.addEventListener("dblclick",a,!1)):"addEventListener"in i?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?i.addEventListener(Ci[t]||t,o,!!Ot&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?i.addEventListener(Ci[t],o=function(t){t=t||window.event,Wi(i,t)&&s(t)},!1):i.addEventListener(t,s,!1):"attachEvent"in i&&i.attachEvent("on"+t,o),i[E]=i[E]||{},i[E][_]=o)}function Zi(t,i,e,n){var o,s,r,a,e=i+m(e)+(n?"_"+m(n):""),n=t[E]&&t[E][e];n&&(Et&&0===i.indexOf("touch")?(a=(s=t)["_leaflet_"+(r=i)+(a=e)],"touchstart"===r?s.removeEventListener(Wt,a,!1):"touchmove"===r?s.removeEventListener(Ht,a,!1):"touchend"===r&&(s.removeEventListener(Ft,a,!1),s.removeEventListener(Ut,a,!1))):kt&&"dblclick"===i&&!zi()?(a=(r=t)[ti+$t+(s=e)],o=r[ti+Qt+e],s=r[ti+"dblclick"+e],r.removeEventListener($t,a,!!Ot&&{passive:!1}),r.removeEventListener(Qt,o,!!Ot&&{passive:!1}),r.removeEventListener("dblclick",s,!1)):"removeEventListener"in t?t.removeEventListener(Ci[i]||i,n,!1):"detachEvent"in t&&t.detachEvent("on"+i,n),t[E][e]=null)}function Ei(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,ji(t),this}function ki(t){return Si(t,"wheel",Ei),this}function Bi(t){return Z(t,"mousedown touchstart dblclick",Ei),Si(t,"click",Di),this}function B(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Ai(t){return B(t),Ei(t),this}function Ii(t,i){var e,n;return i?(n=(e=Mi(i)).boundingClientRect,new p((t.clientX-n.left)/e.x-i.clientLeft,(t.clientY-n.top)/e.y-i.clientTop)):new p(t.clientX,t.clientY)}var Oi=Tt&&wt?2*window.devicePixelRatio:Pt?window.devicePixelRatio:1;function Ri(t){return mt?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Oi:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var Ni={};function Di(t){Ni[t.type]=!0}function ji(t){var i=Ni[t.type];return Ni[t.type]=!1,i}function Wi(t,i){var e=i.relatedTarget;if(!e)return!0;try{for(;e&&e!==t;)e=e.parentNode}catch(t){return!1}return e!==t}var yt={on:Z,off:k,stopPropagation:Ei,disableScrollPropagation:ki,disableClickPropagation:Bi,preventDefault:B,stop:Ai,getMousePosition:Ii,getWheelDelta:Ri,fakeStop:Di,skipped:ji,isExternalTarget:Wi,addListener:Z,removeListener:k},Hi=et.extend({run:function(t,i,e,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=e||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=xi(t),this._offset=i.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=x(this._animate,this),this._step()},_step:function(t){var i=+new Date-this._startTime,e=1e3*this._duration;i<e?this._runFrame(this._easeOut(i/e),t):(this._runFrame(1),this._complete())},_runFrame:function(t,i){t=this._startPos.add(this._offset.multiplyBy(t));i&&t._round(),S(this._el,t),this.fire("step")},_complete:function(){r(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),A=et.extend({options:{crs:ht,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,i){i=s(this,i),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=_(this._onResize,this),this._initEvents(),i.maxBounds&&this.setMaxBounds(i.maxBounds),void 0!==i.zoom&&(this._zoom=this._limitZoom(i.zoom)),i.center&&void 0!==i.zoom&&this.setView(w(i.center),i.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=hi&&P&&!Bt&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Z(this._proxy,ui,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,i,e){if((i=void 0===i?this._zoom:this._limitZoom(i),t=this._limitCenter(w(t),i,this.options.maxBounds),e=e||{},this._stop(),this._loaded&&!e.reset&&!0!==e)&&(void 0!==e.animate&&(e.zoom=h({animate:e.animate},e.zoom),e.pan=h({animate:e.animate,duration:e.duration},e.pan)),this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,i,e.zoom):this._tryAnimatedPan(t,e.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,i),this},setZoom:function(t,i){return this._loaded?this.setView(this.getCenter(),t,{zoom:i}):(this._zoom=t,this)},zoomIn:function(t,i){return t=t||(P?this.options.zoomDelta:1),this.setZoom(this._zoom+t,i)},zoomOut:function(t,i){return t=t||(P?this.options.zoomDelta:1),this.setZoom(this._zoom-t,i)},setZoomAround:function(t,i,e){var n=this.getZoomScale(i),o=this.getSize().divideBy(2),t=(t instanceof p?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/n),n=this.containerPointToLatLng(o.add(t));return this.setView(n,i,{zoom:e})},_getBoundsCenterZoom:function(t,i){i=i||{},t=t.getBounds?t.getBounds():g(t);var e=l(i.paddingTopLeft||i.padding||[0,0]),n=l(i.paddingBottomRight||i.padding||[0,0]),o=this.getBoundsZoom(t,!1,e.add(n));return(o="number"==typeof i.maxZoom?Math.min(i.maxZoom,o):o)===1/0?{center:t.getCenter(),zoom:o}:(i=n.subtract(e).divideBy(2),n=this.project(t.getSouthWest(),o),e=this.project(t.getNorthEast(),o),{center:this.unproject(n.add(e).divideBy(2).add(i),o),zoom:o})},fitBounds:function(t,i){if((t=g(t)).isValid())return t=this._getBoundsCenterZoom(t,i),this.setView(t.center,t.zoom,i);throw new Error("Bounds are not valid.")},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,i){return this.setView(t,this._zoom,{pan:i})},panBy:function(t,i){var e;return i=i||{},(t=l(t).round()).x||t.y?(!0===i.animate||this.getSize().contains(t)?(this._panAnim||(this._panAnim=new Hi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.noMoveStart||this.fire("movestart"),!1!==i.animate?(M(this._mapPane,"leaflet-pan-anim"),e=this._getMapPanePos().subtract(t).round(),this._panAnim.run(this._mapPane,e,i.duration||.25,i.easeLinearity)):(this._rawPanBy(t),this.fire("move").fire("moveend"))):this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this):this.fire("moveend")},flyTo:function(n,o,t){if(!1===(t=t||{}).animate||!P)return this.setView(n,o,t);this._stop();var s=this.project(this.getCenter()),r=this.project(n),i=this.getSize(),a=this._zoom,h=(n=w(n),o=void 0===o?a:o,Math.max(i.x,i.y)),e=h*this.getZoomScale(a,o),u=r.distanceTo(s)||1,l=1.42,c=l*l;function _(t){t=(e*e-h*h+(t?-1:1)*c*c*u*u)/(2*(t?e:h)*c*u),t=Math.sqrt(t*t+1)-t;return t<1e-9?-18:Math.log(t)}function d(t){return(Math.exp(t)-Math.exp(-t))/2}function p(t){return(Math.exp(t)+Math.exp(-t))/2}var m=_(0);function f(t){return h*(p(m)*(d(t=m+l*t)/p(t))-d(m))/c}var g=Date.now(),v=(_(1)-m)/l,y=t.duration?1e3*t.duration:1e3*v*.8;return this._moveStart(!0,t.noMoveStart),function t(){var i=(Date.now()-g)/y,e=(1-Math.pow(1-i,1.5))*v;i<=1?(this._flyToFrame=x(t,this),this._move(this.unproject(s.add(r.subtract(s).multiplyBy(f(e)/u)),a),this.getScaleZoom(h/(i=e,h*(p(m)/p(m+l*i))),a),{flyTo:!0})):this._move(n,o)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,i){t=this._getBoundsCenterZoom(t,i);return this.flyTo(t.center,t.zoom,i)},setMaxBounds:function(t){return(t=g(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var i=this.options.minZoom;return this.options.minZoom=t,this._loaded&&i!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var i=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&i!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,i){this._enforcingBounds=!0;var e=this.getCenter(),t=this._limitCenter(e,this._zoom,g(t));return e.equals(t)||this.panTo(t,i),this._enforcingBounds=!1,this},panInside:function(t,i){var e,n,o=l((i=i||{}).paddingTopLeft||i.padding||[0,0]),s=l(i.paddingBottomRight||i.padding||[0,0]),r=this.getCenter(),r=this.project(r),t=this.project(t),a=this.getPixelBounds(),h=a.getSize().divideBy(2),a=c([a.min.add(o),a.max.subtract(s)]);return a.contains(t)||(this._enforcingBounds=!0,e=r.subtract(t),n=l(t.x+e.x,t.y+e.y),(t.x<a.min.x||t.x>a.max.x)&&(n.x=r.x-e.x,0<e.x?n.x+=h.x-o.x:n.x-=h.x-s.x),(t.y<a.min.y||t.y>a.max.y)&&(n.y=r.y-e.y,0<e.y?n.y+=h.y-o.y:n.y-=h.y-s.y),this.panTo(this.unproject(n),i),this._enforcingBounds=!1),this},invalidateSize:function(t){if(!this._loaded)return this;t=h({animate:!1,pan:!0},!0===t?{animate:!0}:t);var i=this.getSize(),e=(this._sizeChanged=!0,this._lastCenter=null,this.getSize()),n=i.divideBy(2).round(),o=e.divideBy(2).round(),n=n.subtract(o);return n.x||n.y?(t.animate&&t.pan?this.panBy(n):(t.pan&&this._rawPanBy(n),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(_(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:e})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){var i,e;return t=this._locateOptions=h({timeout:1e4,watch:!1},t),"geolocation"in navigator?(i=_(this._handleGeolocationResponse,this),e=_(this._handleGeolocationError,this),t.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,e,t):navigator.geolocation.getCurrentPosition(i,e,t)):this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var i=t.code,t=t.message||(1===i?"permission denied":2===i?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:i,message:"Geolocation error: "+t+"."})},_handleGeolocationResponse:function(t){var i,e,n=new v(t.coords.latitude,t.coords.longitude),o=n.toBounds(2*t.coords.accuracy),s=this._locateOptions,r=(s.setView&&(i=this.getBoundsZoom(o),this.setView(n,s.maxZoom?Math.min(i,s.maxZoom):i)),{latlng:n,bounds:o,timestamp:t.timestamp});for(e in t.coords)"number"==typeof t.coords[e]&&(r[e]=t.coords[e]);this.fire("locationfound",r)},addHandler:function(t,i){return i&&(i=this[t]=new i(this),this._handlers.push(i),this.options[t])&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}for(var t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),T(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(r(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)T(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,i){i=b("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),i||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new d(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,i,e){t=g(t),e=l(e||[0,0]);var n=this.getZoom()||0,o=this.getMinZoom(),s=this.getMaxZoom(),r=t.getNorthWest(),t=t.getSouthEast(),e=this.getSize().subtract(e),t=c(this.project(t,n),this.project(r,n)).getSize(),r=P?this.options.zoomSnap:1,a=e.x/t.x,e=e.y/t.y,t=i?Math.max(a,e):Math.min(a,e),n=this.getScaleZoom(t,n);return r&&(n=Math.round(n/(r/100))*(r/100),n=i?Math.ceil(n/r)*r:Math.floor(n/r)*r),Math.max(o,Math.min(s,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new p(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,i){t=this._getTopLeftPoint(t,i);return new f(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,i){var e=this.options.crs;return i=void 0===i?this._zoom:i,e.scale(t)/e.scale(i)},getScaleZoom:function(t,i){var e=this.options.crs,t=(i=void 0===i?this._zoom:i,e.zoom(t*e.scale(i)));return isNaN(t)?1/0:t},project:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.latLngToPoint(w(t),i)},unproject:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.pointToLatLng(l(t),i)},layerPointToLatLng:function(t){t=l(t).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(t){return this.project(w(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(w(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(g(t))},distance:function(t,i){return this.options.crs.distance(w(t),w(i))},containerPointToLayerPoint:function(t){return l(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return l(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){t=this.containerPointToLayerPoint(l(t));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(w(t)))},mouseEventToContainerPoint:function(t){return Ii(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){t=this._container=li(t);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");Z(t,"scroll",this._onScroll,this),this._containerId=m(t)},_initLayout:function(){var t=this._container,i=(this._fadeAnimated=this.options.fadeAnimation&&P,M(t,"leaflet-container"+(kt?" leaflet-touch":"")+(It?" leaflet-retina":"")+(pt?" leaflet-oldie":"")+(Lt?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":"")),ci(t,"position"));"absolute"!==i&&"relative"!==i&&"fixed"!==i&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),S(this._mapPane,new p(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(M(t.markerPane,"leaflet-zoom-hide"),M(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,i){S(this._mapPane,new p(0,0));var e=!this._loaded,n=(this._loaded=!0,i=this._limitZoom(i),this.fire("viewprereset"),this._zoom!==i);this._moveStart(n,!1)._move(t,i)._moveEnd(n),this.fire("viewreset"),e&&this.fire("load")},_moveStart:function(t,i){return t&&this.fire("zoomstart"),i||this.fire("movestart"),this},_move:function(t,i,e){void 0===i&&(i=this._zoom);var n=this._zoom!==i;return this._zoom=i,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||e&&e.pinch)&&this.fire("zoom",e),this.fire("move",e)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return r(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){S(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={};var i=t?k:Z;i((this._targets[m(this._container)]=this)._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&i(window,"resize",this._onResize,this),P&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){r(this._resizeRequest),this._resizeRequest=x(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,i){for(var e,n=[],o="mouseout"===i||"mouseover"===i,s=t.target||t.srcElement,r=!1;s;){if((e=this._targets[m(s)])&&("click"===i||"preclick"===i)&&!t._simulated&&this._draggableMoved(e)){r=!0;break}if(e&&e.listens(i,!0)){if(o&&!Wi(s,t))break;if(n.push(e),o)break}if(s===this._container)break;s=s.parentNode}return n=n.length||r||o||!Wi(s,t)?n:[this]},_handleDOMEvent:function(t){var i;this._loaded&&!ji(t)&&("mousedown"!==(i=t.type)&&"keypress"!==i&&"keyup"!==i&&"keydown"!==i||Li(t.target||t.srcElement),this._fireDOMEvent(t,i))},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,i,e){if("click"===t.type&&((o=h({},t)).type="preclick",this._fireDOMEvent(o,o.type,e)),!t._stopped&&(e=(e||[]).concat(this._findEventTargets(t,i))).length){var n,o=e[0],s=("contextmenu"===i&&o.listens(i,!0)&&B(t),{originalEvent:t});"keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type&&(n=o.getLatLng&&(!o._radius||o._radius<=10),s.containerPoint=n?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=n?o.getLatLng():this.layerPointToLatLng(s.layerPoint));for(var r=0;r<e.length;r++)if(e[r].fire(i,s,!0),s.originalEvent._stopped||!1===e[r].options.bubblingMouseEvents&&-1!==G(this._mouseEvents,i))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,i=this._handlers.length;t<i;t++)this._handlers[t].disable()},whenReady:function(t,i){return this._loaded?t.call(i||this,{target:this}):this.on("load",t,i),this},_getMapPanePos:function(){return xi(this._mapPane)||new p(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,i){return(t&&void 0!==i?this._getNewPixelOrigin(t,i):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,i){var e=this.getSize()._divideBy(2);return this.project(t,i)._subtract(e)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,i,e){e=this._getNewPixelOrigin(e,i);return this.project(t,i)._subtract(e)},_latLngBoundsToNewLayerBounds:function(t,i,e){e=this._getNewPixelOrigin(e,i);return c([this.project(t.getSouthWest(),i)._subtract(e),this.project(t.getNorthWest(),i)._subtract(e),this.project(t.getSouthEast(),i)._subtract(e),this.project(t.getNorthEast(),i)._subtract(e)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,i,e){var n,o;return!e||(n=this.project(t,i),o=this.getSize().divideBy(2),o=new f(n.subtract(o),n.add(o)),(o=this._getBoundsOffset(o,e,i)).round().equals([0,0]))?t:this.unproject(n.add(o),i)},_limitOffset:function(t,i){var e;return i?(e=new f((e=this.getPixelBounds()).min.add(t),e.max.add(t)),t.add(this._getBoundsOffset(e,i))):t},_getBoundsOffset:function(t,i,e){i=c(this.project(i.getNorthEast(),e),this.project(i.getSouthWest(),e)),e=i.min.subtract(t.min),i=i.max.subtract(t.max);return new p(this._rebound(e.x,-i.x),this._rebound(e.y,-i.y))},_rebound:function(t,i){return 0<t+i?Math.round(t-i)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(i))},_limitZoom:function(t){var i=this.getMinZoom(),e=this.getMaxZoom(),n=P?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(i,Math.min(e,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){z(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,i){t=this._getCenterOffset(t)._trunc();return!(!0!==(i&&i.animate)&&!this.getSize().contains(t)||(this.panBy(t,i),0))},_createAnimProxy:function(){var t=this._proxy=b("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var i=ai,e=this._proxy.style[i];yi(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),e===this._proxy.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){T(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),i=this.getZoom();yi(this._proxy,this.project(t,i),this.getZoomScale(i,1))},_catchTransitionEnd:function(t){this._animatingZoom&&0<=t.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,i,e){if(!this._animatingZoom){if(e=e||{},!this._zoomAnimated||!1===e.animate||this._nothingToAnimate()||Math.abs(i-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(i),n=this._getCenterOffset(t)._divideBy(1-1/n);if(!0!==e.animate&&!this.getSize().contains(n))return!1;x(function(){this._moveStart(!0,!1)._animateZoom(t,i,!0)},this)}return!0},_animateZoom:function(t,i,e,n){this._mapPane&&(e&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=i,M(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:i,noUpdate:n}),setTimeout(_(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&z(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),x(function(){this._moveEnd(!0)},this))}});function Fi(t){return new I(t)}var Ui,I=it.extend({options:{position:"topright"},initialize:function(t){s(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var i=this._map;return i&&i.removeControl(this),this.options.position=t,i&&i.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var i=this._container=this.onAdd(t),e=this.getPosition(),t=t._controlCorners[e];return M(i,"leaflet-control"),-1!==e.indexOf("bottom")?t.insertBefore(i,t.firstChild):t.appendChild(i),this._map.on("unload",this.remove,this),this},remove:function(){return this._map&&(T(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null),this},_refocusOnMap:function(t){this._map&&t&&0<t.screenX&&0<t.screenY&&this._map.getContainer().focus()}}),Vi=(A.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var e=this._controlCorners={},n="leaflet-",o=this._controlContainer=b("div",n+"control-container",this._container);function t(t,i){e[t+i]=b("div",n+t+" "+n+i,o)}t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)T(this._controlCorners[t]);T(this._controlContainer),delete this._controlCorners,delete this._controlContainer}}),I.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,i,e,n){return e<n?-1:n<e?1:0}},initialize:function(t,i,e){for(var n in s(this,e),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in i)this._addLayer(i[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),(this._map=t).on("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return I.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,i){return this._addLayer(t,i),this._map?this._update():this},addOverlay:function(t,i){return this._addLayer(t,i,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);t=this._getLayer(m(t));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){M(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(M(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):z(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return z(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",i=this._container=b("div",t),e=this.options.collapsed,n=(i.setAttribute("aria-haspopup",!0),Bi(i),ki(i),this._section=b("section",t+"-list")),o=(e&&(this._map.on("click",this.collapse,this),gt||Z(i,{mouseenter:this.expand,mouseleave:this.collapse},this)),this._layersLink=b("a",t+"-toggle",i));o.href="#",o.title="Layers",kt?(Z(o,"click",Ai),Z(o,"click",this.expand,this)):Z(o,"focus",this.expand,this),e||this.expand(),this._baseLayersList=b("div",t+"-base",n),this._separator=b("div",t+"-separator",n),this._overlaysList=b("div",t+"-overlays",n),i.appendChild(n)},_getLayer:function(t){for(var i=0;i<this._layers.length;i++)if(this._layers[i]&&m(this._layers[i].layer)===t)return this._layers[i]},_addLayer:function(t,i,e){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:i,overlay:e}),this.options.sortLayers&&this._layers.sort(_(function(t,i){return this.options.sortFunction(t.layer,i.layer,t.name,i.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(this._container){_i(this._baseLayersList),_i(this._overlaysList),this._layerControlInputs=[];for(var t,i,e,n=0,o=0;o<this._layers.length;o++)e=this._layers[o],this._addItem(e),i=i||e.overlay,t=t||!e.overlay,n+=e.overlay?0:1;this.options.hideSingleBase&&(this._baseLayersList.style.display=(t=t&&1<n)?"":"none"),this._separator.style.display=i&&t?"":"none"}return this},_onLayerChange:function(t){this._handlingClick||this._update();var i=this._getLayer(m(t.target)),t=i.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;t&&this._map.fire(t,i)},_createRadioElement:function(t,i){t='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(i?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=t,i.firstChild},_addItem:function(t){var i,e=document.createElement("label"),n=this._map.hasLayer(t.layer),n=(t.overlay?((i=document.createElement("input")).type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=n):i=this._createRadioElement("leaflet-base-layers_"+m(this),n),this._layerControlInputs.push(i),i.layerId=m(t.layer),Z(i,"click",this._onInputClick,this),document.createElement("span")),o=(n.innerHTML=" "+t.name,document.createElement("div"));return e.appendChild(o),o.appendChild(i),o.appendChild(n),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){var t,i,e=this._layerControlInputs,n=[],o=[];this._handlingClick=!0;for(var s=e.length-1;0<=s;s--)t=e[s],i=this._getLayer(t.layerId).layer,t.checked?n.push(i):t.checked||o.push(i);for(s=0;s<o.length;s++)this._map.hasLayer(o[s])&&this._map.removeLayer(o[s]);for(s=0;s<n.length;s++)this._map.hasLayer(n[s])||this._map.addLayer(n[s]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,i,e=this._layerControlInputs,n=this._map.getZoom(),o=e.length-1;0<=o;o--)t=e[o],i=this._getLayer(t.layerId).layer,t.disabled=void 0!==i.options.minZoom&&n<i.options.minZoom||void 0!==i.options.maxZoom&&n>i.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}})),qi=I.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var i="leaflet-control-zoom",e=b("div",i+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,i+"-in",e,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,i+"-out",e,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),e},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,i,e,n,o){e=b("a",e,n);return e.innerHTML=t,e.href="#",e.title=i,e.setAttribute("role","button"),e.setAttribute("aria-label",i),Bi(e),Z(e,"click",Ai),Z(e,"click",o,this),Z(e,"click",this._refocusOnMap,this),e},_updateDisabled:function(){var t=this._map,i="leaflet-disabled";z(this._zoomInButton,i),z(this._zoomOutButton,i),!this._disabled&&t._zoom!==t.getMinZoom()||M(this._zoomOutButton,i),!this._disabled&&t._zoom!==t.getMaxZoom()||M(this._zoomInButton,i)}}),Gi=(A.mergeOptions({zoomControl:!0}),A.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new qi,this.addControl(this.zoomControl))}),I.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var i="leaflet-control-scale",e=b("div",i),n=this.options;return this._addScales(n,i+"-line",e),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),e},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,i,e){t.metric&&(this._mScale=b("div",i,e)),t.imperial&&(this._iScale=b("div",i,e))},_update:function(){var t=this._map,i=t.getSize().y/2,t=t.distance(t.containerPointToLatLng([0,i]),t.containerPointToLatLng([this.options.maxWidth,i]));this._updateScales(t)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var i=this._getRoundNum(t);this._updateScale(this._mScale,i<1e3?i+" m":i/1e3+" km",i/t)},_updateImperial:function(t){var i,e,t=3.2808399*t;5280<t?(e=this._getRoundNum(i=t/5280),this._updateScale(this._iScale,e+" mi",e/i)):(e=this._getRoundNum(t),this._updateScale(this._iScale,e+" ft",e/t))},_updateScale:function(t,i,e){t.style.width=Math.round(this.options.maxWidth*e)+"px",t.innerHTML=i},_getRoundNum:function(t){var i=Math.pow(10,(Math.floor(t)+"").length-1),t=t/i;return i*(10<=t?10:5<=t?5:3<=t?3:2<=t?2:1)}})),Ki=I.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){s(this,t),this._attributions={}},onAdd:function(t){for(var i in(t.attributionControl=this)._container=b("div","leaflet-control-attribution"),Bi(this._container),t._layers)t._layers[i].getAttribution&&this.addAttribution(t._layers[i].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t&&(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update()),this},removeAttribution:function(t){return t&&this._attributions[t]&&(this._attributions[t]--,this._update()),this},_update:function(){if(this._map){var t,i=[];for(t in this._attributions)this._attributions[t]&&i.push(t);var e=[];this.options.prefix&&e.push(this.options.prefix),i.length&&e.push(i.join(", ")),this._container.innerHTML=e.join(" | ")}}}),o=(A.mergeOptions({attributionControl:!0}),A.addInitHook(function(){this.options.attributionControl&&(new Ki).addTo(this)}),I.Layers=Vi,I.Zoom=qi,I.Scale=Gi,I.Attribution=Ki,Fi.layers=function(t,i,e){return new Vi(t,i,e)},Fi.zoom=function(t){return new qi(t)},Fi.scale=function(t){return new Gi(t)},Fi.attribution=function(t){return new Ki(t)},it.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}})),bt=(o.addTo=function(t,i){return t.addHandler(i,this),this},{Events:i}),Yi=kt?"touchstart mousedown":"mousedown",Xi={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Ji={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},$i=et.extend({options:{clickTolerance:3},initialize:function(t,i,e,n){s(this,n),this._element=t,this._dragStartTarget=i||t,this._preventOutline=e},enable:function(){this._enabled||(Z(this._dragStartTarget,Yi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&($i._dragging===this&&this.finishDrag(),k(this._dragStartTarget,Yi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){var i,e;t._simulated||!this._enabled||(this._moved=!1,mi(this._element,"leaflet-zoom-anim"))||$i._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(($i._dragging=this)._preventOutline&&Li(this._element),wi(),ni(),this._moving)||(this.fire("down"),i=t.touches?t.touches[0]:t,e=Ti(this._element),this._startPoint=new p(i.clientX,i.clientY),this._parentScale=Mi(e),Z(document,Ji[t.type],this._onMove,this),Z(document,Xi[t.type],this._onUp,this))},_onMove:function(t){var i;!t._simulated&&this._enabled&&(t.touches&&1<t.touches.length?this._moved=!0:!(i=new p((i=t.touches&&1===t.touches.length?t.touches[0]:t).clientX,i.clientY)._subtract(this._startPoint)).x&&!i.y||Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,B(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=xi(this._element).subtract(i),M(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),M(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,r(this._animRequest),this._lastEvent=t,this._animRequest=x(this._updatePosition,this,!0)))},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),S(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in z(document.body,"leaflet-dragging"),this._lastTarget&&(z(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ji)k(document,Ji[t],this._onMove,this),k(document,Xi[t],this._onUp,this);Pi(),oi(),this._moved&&this._moving&&(r(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,$i._dragging=!1}});function Qi(t,i){if(i&&t.length){var e=t=function(t,i){for(var e=[t[0]],n=1,o=0,s=t.length;n<s;n++)(function(t,i){var e=i.x-t.x,i=i.y-t.y;return e*e+i*i})(t[n],t[o])>i&&(e.push(t[n]),o=n);o<s-1&&e.push(t[s-1]);return e}(t,i=i*i),n=e.length,o=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);o[0]=o[n-1]=1,function t(i,e,n,o,s){var r,a,h,u=0;for(a=o+1;a<=s-1;a++)h=oe(i[a],i[o],i[s],!0),u<h&&(r=a,u=h);n<u&&(e[r]=1,t(i,e,n,o,r),t(i,e,n,r,s))}(e,o,i,0,n-1);var s,r=[];for(s=0;s<n;s++)o[s]&&r.push(e[s]);return r}return t.slice()}function te(t,i,e){return Math.sqrt(oe(t,i,e,!0))}function ie(t,i,e,n,o){var s,r,a,h=n?Ui:ne(t,e),u=ne(i,e);for(Ui=u;;){if(!(h|u))return[t,i];if(h&u)return!1;a=ne(r=ee(t,i,s=h||u,e,o),e),s===h?(t=r,h=a):(i=r,u=a)}}function ee(t,i,e,n,o){var s,r,a=i.x-t.x,i=i.y-t.y,h=n.min,n=n.max;return 8&e?(s=t.x+a*(n.y-t.y)/i,r=n.y):4&e?(s=t.x+a*(h.y-t.y)/i,r=h.y):2&e?(s=n.x,r=t.y+i*(n.x-t.x)/a):1&e&&(s=h.x,r=t.y+i*(h.x-t.x)/a),new p(s,r,o)}function ne(t,i){var e=0;return t.x<i.min.x?e|=1:t.x>i.max.x&&(e|=2),t.y<i.min.y?e|=4:t.y>i.max.y&&(e|=8),e}function oe(t,i,e,n){var o=i.x,i=i.y,s=e.x-o,r=e.y-i,a=s*s+r*r;return 0<a&&(1<(a=((t.x-o)*s+(t.y-i)*r)/a)?(o=e.x,i=e.y):0<a&&(o+=s*a,i+=r*a)),s=t.x-o,r=t.y-i,n?s*s+r*r:new p(o,i)}function se(t){return!u(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function re(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),se(t)}zt={simplify:Qi,pointToSegmentDistance:te,closestPointOnSegment:function(t,i,e){return oe(t,i,e)},clipSegment:ie,_getEdgeIntersection:ee,_getBitCode:ne,_sqClosestPointOnSegment:oe,isFlat:se,_flat:re};function ae(t,i,e){for(var n,o,s,r,a,h,u,l=[1,4,2,8],c=0,_=t.length;c<_;c++)t[c]._code=ne(t[c],i);for(s=0;s<4;s++){for(h=l[s],n=[],c=0,o=(_=t.length)-1;c<_;o=c++)r=t[c],a=t[o],r._code&h?a._code&h||((u=ee(a,r,h,i,e))._code=ne(u,i),n.push(u)):(a._code&h&&((u=ee(a,r,h,i,e))._code=ne(u,i),n.push(u)),n.push(r));t=n}return t}var _t={clipPolygon:ae},St={project:function(t){return new p(t.lng,t.lat)},unproject:function(t){return new v(t.y,t.x)},bounds:new f([-180,-90],[180,90])},Zt={R:6378137,R_MINOR:6356752.314245179,bounds:new f([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var i=Math.PI/180,e=this.R,n=t.lat*i,o=this.R_MINOR/e,o=Math.sqrt(1-o*o),s=o*Math.sin(n),s=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),o/2),n=-e*Math.log(Math.max(s,1e-10));return new p(t.lng*i*e,n)},unproject:function(t){for(var i,e=180/Math.PI,n=this.R,o=this.R_MINOR/n,s=Math.sqrt(1-o*o),r=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(r),h=0,u=.1;h<15&&1e-7<Math.abs(u);h++)i=s*Math.sin(a),i=Math.pow((1-i)/(1+i),s/2),a+=u=Math.PI/2-2*Math.atan(r*i)-a;return new v(a*e,t.x*e/n)}},At={LonLat:St,Mercator:Zt,SphericalMercator:n},Tt=h({},st,{code:"EPSG:3395",projection:Zt,transformation:at(y=.5/(Math.PI*Zt.R),.5,-y,.5)}),he=h({},st,{code:"EPSG:4326",projection:St,transformation:at(1/180,1,-1/180,.5)}),wt=h({},ot,{projection:St,transformation:at(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,i){var e=i.lng-t.lng,i=i.lat-t.lat;return Math.sqrt(e*e+i*i)},infinite:!0}),O=(ot.Earth=st,ot.EPSG3395=Tt,ot.EPSG3857=ht,ot.EPSG900913=ut,ot.EPSG4326=he,ot.Simple=wt,et.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[m(t)]=this},removeInteractiveTarget:function(t){return delete this._map._targets[m(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var i,e=t.target;e.hasLayer(this)&&(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents&&(i=this.getEvents(),e.on(i,this),this.once("remove",function(){e.off(i,this)},this)),this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this}))}})),ue=(A.include({addLayer:function(t){var i;if(t._layerAdd)return i=m(t),this._layers[i]||((this._layers[i]=t)._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this;throw new Error("The provided object is not a Layer.")},removeLayer:function(t){var i=m(t);return this._layers[i]&&(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[i],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null),this},hasLayer:function(t){return!!t&&m(t)in this._layers},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},_addLayers:function(t){for(var i=0,e=(t=t?u(t)?t:[t]:[]).length;i<e;i++)this.addLayer(t[i])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[m(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){t=m(t);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var t,i=1/0,e=-1/0,n=this._getZoomSpan();for(t in this._zoomBoundLayers)var o=this._zoomBoundLayers[t].options,i=void 0===o.minZoom?i:Math.min(i,o.minZoom),e=void 0===o.maxZoom?e:Math.max(e,o.maxZoom);this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=i===1/0?void 0:i,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}}),O.extend({initialize:function(t,i){var e,n;if(s(this,i),this._layers={},t)for(e=0,n=t.length;e<n;e++)this.addLayer(t[e])},addLayer:function(t){var i=this.getLayerId(t);return this._layers[i]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){t=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(t){return!!t&&("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var i,e,n=Array.prototype.slice.call(arguments,1);for(i in this._layers)(e=this._layers[i])[t]&&e[t].apply(e,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:m})),le=ue.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),ue.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?((t=t in this._layers?this._layers[t]:t).removeEventParent(this),ue.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t,i=new d;for(t in this._layers){var e=this._layers[t];i.extend(e.getBounds?e.getBounds():e.getLatLng())}return i}}),ce=it.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){s(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,i){var e=this._getIconUrl(t);if(e)return e=this._createImg(e,i&&"IMG"===i.tagName?i:null),this._setIconStyles(e,t),e;if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null},_setIconStyles:function(t,i){var e=this.options,n=e[i+"Size"],n=l(n="number"==typeof n?[n,n]:n),o=l("shadow"===i&&e.shadowAnchor||e.iconAnchor||n&&n.divideBy(2,!0));t.className="leaflet-marker-"+i+" "+(e.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),n&&(t.style.width=n.x+"px",t.style.height=n.y+"px")},_createImg:function(t,i){return(i=i||document.createElement("img")).src=t,i},_getIconUrl:function(t){return It&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var _e=ce.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return _e.imagePath||(_e.imagePath=this._detectIconPath()),(this.options.imagePath||_e.imagePath)+ce.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=b("div","leaflet-default-icon-path",document.body),i=ci(t,"background-image")||ci(t,"backgroundImage");return document.body.removeChild(t),i=null===i||0!==i.indexOf("url")?"":i.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),de=o.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new $i(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),M(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&z(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var i=this._marker,e=i._map,n=this._marker.options.autoPanSpeed,o=this._marker.options.autoPanPadding,s=xi(i._icon),r=e.getPixelBounds(),a=e.getPixelOrigin(),a=c(r.min._subtract(a).add(o),r.max._subtract(a).subtract(o));a.contains(s)||(o=l((Math.max(a.max.x,s.x)-a.max.x)/(r.max.x-a.max.x)-(Math.min(a.min.x,s.x)-a.min.x)/(r.min.x-a.min.x),(Math.max(a.max.y,s.y)-a.max.y)/(r.max.y-a.max.y)-(Math.min(a.min.y,s.y)-a.min.y)/(r.min.y-a.min.y)).multiplyBy(n),e.panBy(o,{animate:!1}),this._draggable._newPos._add(o),this._draggable._startPos._add(o),S(i._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=x(this._adjustPan.bind(this,t)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(r(this._panRequest),this._panRequest=x(this._adjustPan.bind(this,t)))},_onDrag:function(t){var i=this._marker,e=i._shadow,n=xi(i._icon),o=i._map.layerPointToLatLng(n);e&&S(e,n),i._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,i.fire("move",t).fire("drag",t)},_onDragEnd:function(t){r(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),pe=O.extend({options:{icon:new _e,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,i){s(this,i),this._latlng=w(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var i=this._latlng;return this._latlng=w(t),this.update(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){var t;return this._icon&&this._map&&(t=this._map.latLngToLayerPoint(this._latlng).round(),this._setPos(t)),this},_initIcon:function(){var t=this.options,i="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),e=t.icon.createIcon(this._icon),n=!1,e=(e!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(e.title=t.title),"IMG"===e.tagName)&&(e.alt=t.alt||""),M(e,i),t.keyboard&&(e.tabIndex="0"),this._icon=e,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),t.icon.createShadow(this._shadow)),o=!1;e!==this._shadow&&(this._removeShadow(),o=!0),e&&(M(e,i),e.alt=""),this._shadow=e,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),e&&o&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),T(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&T(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&S(this._icon,t),this._shadow&&S(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){t=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(t)},_initInteraction:function(){var t;this.options.interactive&&(M(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),de)&&(t=this.options.draggable,this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new de(this),t)&&this.dragging.enable()},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&C(this._icon,t),this._shadow&&C(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var me=O.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return s(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke)&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds(),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),fe=me.extend({options:{fill:!0,radius:10},initialize:function(t,i){s(this,i),this._latlng=w(t),this._radius=this.options.radius},setLatLng:function(t){var i=this._latlng;return this._latlng=w(t),this.redraw(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var i=t&&t.radius||this._radius;return me.prototype.setStyle.call(this,t),this.setRadius(i),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,i=this._radiusY||t,e=this._clickTolerance(),t=[t+e,i+e];this._pxBounds=new f(this._point.subtract(t),this._point.add(t))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var ge=fe.extend({initialize:function(t,i,e){if(s(this,i="number"==typeof i?h({},e,{radius:i}):i),this._latlng=w(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new d(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:me.prototype.setStyle,_project:function(){var t,i,e,n,o,s=this._latlng.lng,r=this._latlng.lat,a=this._map,h=a.options.crs;h.distance===st.distance?(n=Math.PI/180,o=this._mRadius/st.R/n,t=a.project([r+o,s]),i=a.project([r-o,s]),i=t.add(i).divideBy(2),e=a.unproject(i).lat,n=Math.acos((Math.cos(o*n)-Math.sin(r*n)*Math.sin(e*n))/(Math.cos(r*n)*Math.cos(e*n)))/n,!isNaN(n)&&0!==n||(n=o/Math.cos(Math.PI/180*r)),this._point=i.subtract(a.getPixelOrigin()),this._radius=isNaN(n)?0:i.x-a.project([e,s-n]).x,this._radiusY=i.y-t.y):(o=h.unproject(h.project(this._latlng).subtract([this._mRadius,0])),this._point=a.latLngToLayerPoint(this._latlng),this._radius=this._point.x-a.latLngToLayerPoint(o).x),this._updateBounds()}});var ve=me.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,i){s(this,i),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var i=1/0,e=null,n=oe,o=0,s=this._parts.length;o<s;o++)for(var r=this._parts[o],a=1,h=r.length;a<h;a++){var u,l,c=n(t,u=r[a-1],l=r[a],!0);c<i&&(i=c,e=n(t,u,l))}return e&&(e.distance=Math.sqrt(i)),e},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,i,e,n,o,s,r=this._rings[0],a=r.length;if(!a)return null;for(i=t=0;t<a-1;t++)i+=r[t].distanceTo(r[t+1])/2;if(0===i)return this._map.layerPointToLatLng(r[0]);for(e=t=0;t<a-1;t++)if(n=r[t],o=r[t+1],i<(e+=s=n.distanceTo(o)))return this._map.layerPointToLatLng([o.x-(s=(e-i)/s)*(o.x-n.x),o.y-s*(o.y-n.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,i){return i=i||this._defaultShape(),t=w(t),i.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new d,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return se(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var i=[],e=se(t),n=0,o=t.length;n<o;n++)e?(i[n]=w(t[n]),this._bounds.extend(i[n])):i[n]=this._convertLatLngs(t[n]);return i},_project:function(){var t=new f;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),t=new p(t,t);this._pxBounds=new f([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)])},_projectLatlngs:function(t,i,e){var n,o,s=t[0]instanceof v,r=t.length;if(s){for(o=[],n=0;n<r;n++)o[n]=this._map.latLngToLayerPoint(t[n]),e.extend(o[n]);i.push(o)}else for(n=0;n<r;n++)this._projectLatlngs(t[n],i,e)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,e,n,o,s=this._parts,r=0,a=0,h=this._rings.length;r<h;r++)for(i=0,e=(o=this._rings[r]).length;i<e-1;i++)(n=ie(o[i],o[i+1],t,i,!0))&&(s[a]=s[a]||[],s[a].push(n[0]),n[1]===o[i+1]&&i!==e-2||(s[a].push(n[1]),a++))},_simplifyPoints:function(){for(var t=this._parts,i=this.options.smoothFactor,e=0,n=t.length;e<n;e++)t[e]=Qi(t[e],i)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,i){var e,n,o,s,r,a,h=this._clickTolerance();if(this._pxBounds&&this._pxBounds.contains(t))for(e=0,s=this._parts.length;e<s;e++)for(n=0,o=(r=(a=this._parts[e]).length)-1;n<r;o=n++)if((i||0!==n)&&te(t,a[o],a[n])<=h)return!0;return!1}});ve._flat=re;var ye=ve.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,i,e,n,o,s,r,a,h,u=this._rings[0],l=u.length;if(!l)return null;for(t=s=r=a=0,i=l-1;t<l;i=t++)e=u[t],n=u[i],o=e.y*n.x-n.y*e.x,r+=(e.x+n.x)*o,a+=(e.y+n.y)*o,s+=3*o;return h=0===s?u[0]:[r/s,a/s],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var t=ve.prototype._convertLatLngs.call(this,t),i=t.length;return 2<=i&&t[0]instanceof v&&t[0].equals(t[i-1])&&t.pop(),t},_setLatLngs:function(t){ve.prototype._setLatLngs.call(this,t),se(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return(se(this._latlngs[0])?this._latlngs:this._latlngs[0])[0]},_clipPoints:function(){var t=this._renderer._bounds,i=this.options.weight,i=new p(i,i),t=new f(t.min.subtract(i),t.max.add(i));if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var e,n=0,o=this._rings.length;n<o;n++)(e=ae(this._rings[n],t,!0)).length&&this._parts.push(e)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var i,e,n,o,s,r,a,h,u=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;o<a;o++)for(s=0,r=(h=(i=this._parts[o]).length)-1;s<h;r=s++)e=i[s],n=i[r],e.y>t.y!=n.y>t.y&&t.x<(n.x-e.x)*(t.y-e.y)/(n.y-e.y)+e.x&&(u=!u);return u||ve.prototype._containsPoint.call(this,t,!0)}});var xe=le.extend({initialize:function(t,i){s(this,i),this._layers={},t&&this.addData(t)},addData:function(t){var i,e,n,o=u(t)?t:t.features;if(o){for(i=0,e=o.length;i<e;i++)((n=o[i]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var s,r=this.options;return(!r.filter||r.filter(t))&&(s=we(t,r))?(s.feature=Ce(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=h({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(t){this._setLayerStyle(t,i)},this)},_setLayerStyle:function(t,i){t.setStyle&&("function"==typeof i&&(i=i(t.feature)),t.setStyle(i))}});function we(t,i){var e,n,o,s,r="Feature"===t.type?t.geometry:t,a=r?r.coordinates:null,h=[],u=i&&i.pointToLayer,l=i&&i.coordsToLatLng||Le;if(!a&&!r)return null;switch(r.type){case"Point":return Pe(u,t,e=l(a),i);case"MultiPoint":for(o=0,s=a.length;o<s;o++)e=l(a[o]),h.push(Pe(u,t,e,i));return new le(h);case"LineString":case"MultiLineString":return n=be(a,"LineString"===r.type?0:1,l),new ve(n,i);case"Polygon":case"MultiPolygon":return n=be(a,"Polygon"===r.type?1:2,l),new ye(n,i);case"GeometryCollection":for(o=0,s=r.geometries.length;o<s;o++){var c=we({geometry:r.geometries[o],type:"Feature",properties:t.properties},i);c&&h.push(c)}return new le(h);default:throw new Error("Invalid GeoJSON object.")}}function Pe(t,i,e,n){return t?t(i,e):new pe(e,n&&n.markersInheritOptions&&n)}function Le(t){return new v(t[1],t[0],t[2])}function be(t,i,e){for(var n,o=[],s=0,r=t.length;s<r;s++)n=i?be(t[s],i-1,e):(e||Le)(t[s]),o.push(n);return o}function Te(t,i){return i="number"==typeof i?i:6,void 0!==t.alt?[e(t.lng,i),e(t.lat,i),e(t.alt,i)]:[e(t.lng,i),e(t.lat,i)]}function Me(t,i,e,n){for(var o=[],s=0,r=t.length;s<r;s++)o.push(i?Me(t[s],i-1,e,n):Te(t[s],n));return!i&&e&&o.push(o[0]),o}function ze(t,i){return t.feature?h({},t.feature,{geometry:i}):Ce(i)}function Ce(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}Pt={toGeoJSON:function(t){return ze(this,{type:"Point",coordinates:Te(this.getLatLng(),t)})}};function Se(t,i){return new xe(t,i)}pe.include(Pt),ge.include(Pt),fe.include(Pt),ve.include({toGeoJSON:function(t){var i=!se(this._latlngs);return ze(this,{type:(i?"Multi":"")+"LineString",coordinates:Me(this._latlngs,i?1:0,!1,t)})}}),ye.include({toGeoJSON:function(t){var i=!se(this._latlngs),e=i&&!se(this._latlngs[0]),t=Me(this._latlngs,e?2:i?1:0,!0,t);return ze(this,{type:(e?"Multi":"")+"Polygon",coordinates:t=i?t:[t]})}}),ue.include({toMultiPoint:function(i){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON(i).geometry.coordinates)}),ze(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(i){var e,n,t=this.feature&&this.feature.geometry&&this.feature.geometry.type;return"MultiPoint"===t?this.toMultiPoint(i):(e="GeometryCollection"===t,n=[],this.eachLayer(function(t){t.toGeoJSON&&(t=t.toGeoJSON(i),e?n.push(t.geometry):"FeatureCollection"===(t=Ce(t)).type?n.push.apply(n,t.features):n.push(t))}),e?ze(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n})}});var i=Se,Ze=O.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,i,e){this._url=t,this._bounds=g(i),s(this,e)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(M(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){T(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&di(this._image),this},bringToBack:function(){return this._map&&pi(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=g(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,i=this._image=t?this._url:b("img");M(i,"leaflet-image-layer"),this._zoomAnimated&&M(i,"leaflet-zoom-animated"),this.options.className&&M(i,this.options.className),i.onselectstart=a,i.onmousemove=a,i.onload=_(this.fire,this,"load"),i.onerror=_(this._overlayOnError,this,"error"),!this.options.crossOrigin&&""!==this.options.crossOrigin||(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=i.src:(i.src=this._url,i.alt=this.options.alt)},_animateZoom:function(t){var i=this._map.getZoomScale(t.zoom),t=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;yi(this._image,t,i)},_reset:function(){var t=this._image,i=new f(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),e=i.getSize();S(t,i.min),t.style.width=e.x+"px",t.style.height=e.y+"px"},_updateOpacity:function(){C(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Ee=Ze.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var t="VIDEO"===this._url.tagName,i=this._image=t?this._url:b("video");if(M(i,"leaflet-image-layer"),this._zoomAnimated&&M(i,"leaflet-zoom-animated"),this.options.className&&M(i,this.options.className),i.onselectstart=a,i.onmousemove=a,i.onloadeddata=_(this.fire,this,"load"),t){for(var e=i.getElementsByTagName("source"),n=[],o=0;o<e.length;o++)n.push(e[o].src);this._url=0<e.length?n:[i.src]}else{u(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(i.style,"objectFit")&&(i.style.objectFit="fill"),i.autoplay=!!this.options.autoplay,i.loop=!!this.options.loop,i.muted=!!this.options.muted;for(var s=0;s<this._url.length;s++){var r=b("source");r.src=this._url[s],i.appendChild(r)}}}});var ke=Ze.extend({_initImage:function(){var t=this._image=this._url;M(t,"leaflet-image-layer"),this._zoomAnimated&&M(t,"leaflet-zoom-animated"),this.options.className&&M(t,this.options.className),t.onselectstart=a,t.onmousemove=a}});var Be=O.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,i){s(this,t),this._source=i},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&C(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&C(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(C(this._container,0),this._removeTimeout=setTimeout(_(T,void 0,this._container),200)):T(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=w(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&di(this._container),this},bringToBack:function(){return this._map&&pi(this._container),this},_prepareOpen:function(t,i,e){if(i instanceof O||(e=i,i=t),i instanceof le)for(var n in t._layers){i=t._layers[n];break}if(!e)if(i.getCenter)e=i.getCenter();else{if(!i.getLatLng)throw new Error("Unable to get source layer LatLng.");e=i.getLatLng()}return this._source=i,this.update(),e},_updateContent:function(){if(this._content){var t=this._contentNode,i="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof i)t.innerHTML=i;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(i)}this.fire("contentupdate")}},_updatePosition:function(){var t,i,e;this._map&&(i=this._map.latLngToLayerPoint(this._latlng),t=l(this.options.offset),e=this._getAnchor(),this._zoomAnimated?S(this._container,i.add(e)):t=t.add(i).add(e),i=this._containerBottom=-t.y,e=this._containerLeft=-Math.round(this._containerWidth/2)+t.x,this._container.style.bottom=i+"px",this._container.style.left=e+"px")},_getAnchor:function(){return[0,0]}}),Ae=Be.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Be.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof me||this._source.on("preclick",Ei))},onRemove:function(t){Be.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof me||this._source.off("preclick",Ei))},getEvents:function(){var t=Be.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",i=this._container=b("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),e=this._wrapper=b("div",t+"-content-wrapper",i);this._contentNode=b("div",t+"-content",e),Bi(i),ki(this._contentNode),Z(i,"contextmenu",Ei),this._tipContainer=b("div",t+"-tip-container",i),this._tip=b("div",t+"-tip",this._tipContainer),this.options.closeButton&&((e=this._closeButton=b("a",t+"-close-button",i)).href="#close",e.innerHTML="&#215;",Z(e,"click",this._onCloseButtonClick,this))},_updateLayout:function(){var t=this._contentNode,i=t.style,e=(i.width="",i.whiteSpace="nowrap",t.offsetWidth),e=Math.min(e,this.options.maxWidth),e=(e=Math.max(e,this.options.minWidth),i.width=e+1+"px",i.whiteSpace="",i.height="",t.offsetHeight),n=this.options.maxHeight,o="leaflet-popup-scrolled";(n&&n<e?(i.height=n+"px",M):z)(t,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var t=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();S(this._container,t.add(i))},_adjustPan:function(){var t,i,e,n,o,s,r,a;this.options.autoPan&&(this._map._panAnim&&this._map._panAnim.stop(),t=this._map,i=parseInt(ci(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+i,a=this._containerWidth,(e=new p(this._containerLeft,-i-this._containerBottom))._add(xi(this._container)),e=t.layerPointToContainerPoint(e),o=l(this.options.autoPanPadding),n=l(this.options.autoPanPaddingTopLeft||o),o=l(this.options.autoPanPaddingBottomRight||o),s=t.getSize(),r=0,e.x+a+o.x>s.x&&(r=e.x+a-s.x+o.x),e.x-r-n.x<(a=0)&&(r=e.x-n.x),e.y+i+o.y>s.y&&(a=e.y+i-s.y+o.y),e.y-a-n.y<0&&(a=e.y-n.y),r||a)&&t.fire("autopanstart").panBy([r,a])},_onCloseButtonClick:function(t){this._close(),Ai(t)},_getAnchor:function(){return l(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ie=(A.mergeOptions({closePopupOnClick:!0}),A.include({openPopup:function(t,i,e){return t instanceof Ae||(t=new Ae(e).setContent(t)),i&&t.setLatLng(i),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),O.include({bindPopup:function(t,i){return t instanceof Ae?(s(t,i),(this._popup=t)._source=this):(this._popup&&!i||(this._popup=new Ae(i,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,i){return this._popup&&this._map&&(i=this._popup._prepareOpen(this,t,i),this._map.openPopup(this._popup,i)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var i=t.layer||t.target;this._popup&&this._map&&(Ai(t),i instanceof me?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===i?this.closePopup():this.openPopup(i,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}}),Be.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Be.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Be.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Be.prototype.getEvents.call(this);return kt&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=b("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var i,e=this._map,n=this._container,o=e.latLngToContainerPoint(e.getCenter()),e=e.layerPointToContainerPoint(t),s=this.options.direction,r=n.offsetWidth,a=n.offsetHeight,h=l(this.options.offset),u=this._getAnchor(),e="top"===s?(i=r/2,a):"bottom"===s?(i=r/2,0):(i="center"===s?r/2:"right"===s?0:"left"===s?r:e.x<o.x?(s="right",0):(s="left",r+2*(h.x+u.x)),a/2);t=t.subtract(l(i,e,!0)).add(h).add(u),z(n,"leaflet-tooltip-right"),z(n,"leaflet-tooltip-left"),z(n,"leaflet-tooltip-top"),z(n,"leaflet-tooltip-bottom"),M(n,"leaflet-tooltip-"+s),S(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&C(this._container,t)},_animateZoom:function(t){t=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(t)},_getAnchor:function(){return l(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}})),Oe=(A.include({openTooltip:function(t,i,e){return t instanceof Ie||(t=new Ie(e).setContent(t)),i&&t.setLatLng(i),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),O.include({bindTooltip:function(t,i){return t instanceof Ie?(s(t,i),(this._tooltip=t)._source=this):(this._tooltip&&!i||(this._tooltip=new Ie(i,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){var i,e;!t&&this._tooltipHandlersAdded||(i=t?"off":"on",e={remove:this.closeTooltip,move:this._moveTooltip},this._tooltip.options.permanent?e.add=this._openTooltip:(e.mouseover=this._openTooltip,e.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(e.mousemove=this._moveTooltip),kt&&(e.click=this._openTooltip)),this[i](e),this._tooltipHandlersAdded=!t)},openTooltip:function(t,i){return this._tooltip&&this._map&&(i=this._tooltip._prepareOpen(this,t,i),this._map.openTooltip(this._tooltip,i),this._tooltip.options.interactive)&&this._tooltip._container&&(M(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container)),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive)&&this._tooltip._container&&(z(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container)),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var i=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(i,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(t=this._map.mouseEventToContainerPoint(t.originalEvent),t=this._map.containerPointToLayerPoint(t),i=this._map.layerPointToLatLng(t)),this._tooltip.setLatLng(i)}}),ce.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var t=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;return i.html instanceof Element?(_i(t),t.appendChild(i.html)):t.innerHTML=!1!==i.html?i.html:"",i.bgPos&&(i=l(i.bgPos),t.style.backgroundPosition=-i.x+"px "+-i.y+"px"),this._setIconStyles(t,"icon"),t},createShadow:function(){return null}}));ce.Default=_e;var Re=O.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ct,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){s(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),T(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(di(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(pi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=j(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof p?t:new p(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var i,e=this.getPane().children,n=-t(-1/0,1/0),o=0,s=e.length;o<s;o++)i=e[o].style.zIndex,e[o]!==this._container&&i&&(n=t(n,+i));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!pt){C(this._container,this.options.opacity);var t,i=+new Date,e=!1,n=!1;for(t in this._tiles){var o,s=this._tiles[t];s.current&&s.loaded&&(o=Math.min(1,(i-s.loaded)/200),C(s.el,o),o<1?e=!0:(s.active?n=!0:this._onOpaqueTile(s),s.active=!0))}n&&!this._noPrune&&this._pruneTiles(),e&&(r(this._fadeFrame),this._fadeFrame=x(this._updateOpacity,this))}},_onOpaqueTile:a,_initContainer:function(){this._container||(this._container=b("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,i=this.options.maxZoom;if(void 0!==t){for(var e in this._levels)e=Number(e),this._levels[e].el.children.length||e===t?(this._levels[e].el.style.zIndex=i-Math.abs(t-e),this._onUpdateLevel(e)):(T(this._levels[e].el),this._removeTilesAtZoom(e),this._onRemoveLevel(e),delete this._levels[e]);var n=this._levels[t],o=this._map;return n||((n=this._levels[t]={}).el=b("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=i,n.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,o.getCenter(),o.getZoom()),a(n.el.offsetWidth),this._onCreateLevel(n)),this._level=n}},_onUpdateLevel:a,_onRemoveLevel:a,_onCreateLevel:a,_pruneTiles:function(){if(this._map){var t,i,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)(e=this._tiles[t]).current&&!e.active&&(i=e.coords,this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2));for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var i in this._tiles)this._tiles[i].coords.z===t&&this._removeTile(i)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)T(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,i,e,n){var t=Math.floor(t/2),i=Math.floor(i/2),e=e-1,o=new p(+t,+i),o=(o.z=e,this._tileCoordsToKey(o)),o=this._tiles[o];return o&&o.active?o.retain=!0:(o&&o.loaded&&(o.retain=!0),n<e&&this._retainParent(t,i,e,n))},_retainChildren:function(t,i,e,n){for(var o=2*t;o<2*t+2;o++)for(var s=2*i;s<2*i+2;s++){var r=new p(o,s),r=(r.z=e+1,this._tileCoordsToKey(r)),r=this._tiles[r];r&&r.active?r.retain=!0:(r&&r.loaded&&(r.retain=!0),e+1<n&&this._retainChildren(o,s,e+1,n))}},_resetView:function(t){t=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var i=this.options;return void 0!==i.minNativeZoom&&t<i.minNativeZoom?i.minNativeZoom:void 0!==i.maxNativeZoom&&i.maxNativeZoom<t?i.maxNativeZoom:t},_setView:function(t,i,e,n){var o=Math.round(i),o=void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom?void 0:this._clampZoom(o),s=this.options.updateWhenZooming&&o!==this._tileZoom;n&&!s||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(t),e||this._pruneTiles(),this._noPrune=!!e),this._setZoomTransforms(t,i)},_setZoomTransforms:function(t,i){for(var e in this._levels)this._setZoomTransform(this._levels[e],t,i)},_setZoomTransform:function(t,i,e){var n=this._map.getZoomScale(e,t.zoom),i=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(i,e)).round();P?yi(t.el,i,n):S(t.el,i)},_resetGrid:function(){var t=this._map,i=t.options.crs,e=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=i.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,i.wrapLng[0]],n).x/e.x),Math.ceil(t.project([0,i.wrapLng[1]],n).x/e.y)],this._wrapY=i.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([i.wrapLat[0],0],n).y/e.x),Math.ceil(t.project([i.wrapLat[1],0],n).y/e.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var i=this._map,e=i._animatingZoom?Math.max(i._animateToZoom,i.getZoom()):i.getZoom(),e=i.getZoomScale(e,this._tileZoom),t=i.project(t,this._tileZoom).floor(),i=i.getSize().divideBy(2*e);return new f(t.subtract(i),t.add(i))},_update:function(t){var i=this._map;if(i){var e=this._clampZoom(i.getZoom());if(void 0===t&&(t=i.getCenter()),void 0!==this._tileZoom){var n,i=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(i),s=o.getCenter(),r=[],i=this.options.keepBuffer,a=new f(o.getBottomLeft().subtract([i,-i]),o.getTopRight().add([i,-i]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(n in this._tiles){var h=this._tiles[n].coords;h.z===this._tileZoom&&a.contains(new p(h.x,h.y))||(this._tiles[n].current=!1)}if(1<Math.abs(e-this._tileZoom))this._setView(t,e);else{for(var u=o.min.y;u<=o.max.y;u++)for(var l=o.min.x;l<=o.max.x;l++){var c,_=new p(l,u);_.z=this._tileZoom,this._isValidTile(_)&&((c=this._tiles[this._tileCoordsToKey(_)])?c.current=!0:r.push(_))}if(r.sort(function(t,i){return t.distanceTo(s)-i.distanceTo(s)}),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));for(var d=document.createDocumentFragment(),l=0;l<r.length;l++)this._addTile(r[l],d);this._level.el.appendChild(d)}}}}},_isValidTile:function(t){var i=this._map.options.crs;if(!i.infinite){var e=this._globalTileRange;if(!i.wrapLng&&(t.x<e.min.x||t.x>e.max.x)||!i.wrapLat&&(t.y<e.min.y||t.y>e.max.y))return!1}return!this.options.bounds||(i=this._tileCoordsToBounds(t),g(this.options.bounds).overlaps(i))},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var i=this._map,e=this.getTileSize(),n=t.scaleBy(e),e=n.add(e);return[i.unproject(n,t.z),i.unproject(e,t.z)]},_tileCoordsToBounds:function(t){t=this._tileCoordsToNwSe(t),t=new d(t[0],t[1]);return t=this.options.noWrap?t:this._map.wrapLatLngBounds(t)},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var t=t.split(":"),i=new p(+t[0],+t[1]);return i.z=+t[2],i},_removeTile:function(t){var i=this._tiles[t];i&&(T(i.el),delete this._tiles[t],this.fire("tileunload",{tile:i.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){M(t,"leaflet-tile");var i=this.getTileSize();t.style.width=i.x+"px",t.style.height=i.y+"px",t.onselectstart=a,t.onmousemove=a,pt&&this.options.opacity<1&&C(t,this.options.opacity),gt&&!vt&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,i){var e=this._getTilePos(t),n=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),_(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&x(_(this._tileReady,this,t,null,o)),S(o,e),this._tiles[n]={el:o,coords:t,current:!0},i.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,i,e){i&&this.fire("tileerror",{error:i,tile:e,coords:t});var n=this._tileCoordsToKey(t);(e=this._tiles[n])&&(e.loaded=+new Date,this._map._fadeAnimated?(C(e.el,0),r(this._fadeFrame),this._fadeFrame=x(this._updateOpacity,this)):(e.active=!0,this._pruneTiles()),i||(M(e.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:e.el,coords:t})),this._noTilesToLoad())&&(this._loading=!1,this.fire("load"),pt||!this._map._fadeAnimated?x(this._pruneTiles,this):setTimeout(_(this._pruneTiles,this),250))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var i=new p(this._wrapX?W(t.x,this._wrapX):t.x,this._wrapY?W(t.y,this._wrapY):t.y);return i.z=t.z,i},_pxBoundsToTileRange:function(t){var i=this.getTileSize();return new f(t.min.unscaleBy(i).floor(),t.max.unscaleBy(i).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var Ne=Re.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,i){this._url=t,(i=s(this,i)).detectRetina&&It&&0<i.maxZoom&&(i.tileSize=Math.floor(i.tileSize/2),i.zoomReverse?(i.zoomOffset--,i.minZoom++):(i.zoomOffset++,i.maxZoom--),i.minZoom=Math.max(0,i.minZoom)),"string"==typeof i.subdomains&&(i.subdomains=i.subdomains.split("")),gt||this.on("tileunload",this._onTileRemove)},setUrl:function(t,i){return this._url===t&&void 0===i&&(i=!0),this._url=t,i||this.redraw(),this},createTile:function(t,i){var e=document.createElement("img");return Z(e,"load",_(this._tileOnLoad,this,i,e)),Z(e,"error",_(this._tileOnError,this,i,e)),!this.options.crossOrigin&&""!==this.options.crossOrigin||(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),e.alt="",e.setAttribute("role","presentation"),e.src=this.getTileUrl(t),e},getTileUrl:function(t){var i={r:It?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};return this._map&&!this._map.options.crs.infinite&&(t=this._globalTileRange.max.y-t.y,this.options.tms&&(i.y=t),i["-y"]=t),q(this._url,h(i,this.options))},_tileOnLoad:function(t,i){pt?setTimeout(_(t,this,null,i),0):t(null,i)},_tileOnError:function(t,i,e){var n=this.options.errorTileUrl;n&&i.getAttribute("src")!==n&&(i.src=n),t(e,i)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,i=this.options.maxZoom;return(t=this.options.zoomReverse?i-t:t)+this.options.zoomOffset},_getSubdomain:function(t){t=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var t,i;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((i=this._tiles[t].el).onload=a,i.onerror=a,i.complete||(i.src=K,T(i),delete this._tiles[t]))},_removeTile:function(t){var i=this._tiles[t];if(i)return xt||i.el.setAttribute("src",K),Re.prototype._removeTile.call(this,t)},_tileReady:function(t,i,e){if(this._map&&(!e||e.getAttribute("src")!==K))return Re.prototype._tileReady.call(this,t,i,e)}});function De(t,i){return new Ne(t,i)}var je=Ne.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,i){this._url=t;var e,n=h({},this.defaultWmsParams);for(e in i)e in this.options||(n[e]=i[e]);var t=(i=s(this,i)).detectRetina&&It?2:1,o=this.getTileSize();n.width=o.x*t,n.height=o.y*t,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var i=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[i]=this._crs.code,Ne.prototype.onAdd.call(this,t)},getTileUrl:function(t){var i=this._tileCoordsToNwSe(t),e=this._crs,e=c(e.project(i[0]),e.project(i[1])),i=e.min,e=e.max,i=(1.3<=this._wmsVersion&&this._crs===he?[i.y,i.x,e.y,e.x]:[i.x,i.y,e.x,e.y]).join(","),e=Ne.prototype.getTileUrl.call(this,t);return e+U(this.wmsParams,e,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+i},setParams:function(t,i){return h(this.wmsParams,t),i||this.redraw(),this}});Ne.WMS=je,De.wms=function(t,i){return new je(t,i)};var We=O.extend({options:{padding:.1,tolerance:0},initialize:function(t){s(this,t),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&M(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,i){var e=this._map.getZoomScale(i,this._zoom),n=xi(this._container),o=this._map.getSize().multiplyBy(.5+this.options.padding),s=this._map.project(this._center,i),t=this._map.project(t,i).subtract(s),i=o.multiplyBy(-e).add(n).add(o).subtract(t);P?yi(this._container,i,e):S(this._container,i)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,i=this._map.getSize(),e=this._map.containerPointToLayerPoint(i.multiplyBy(-t)).round();this._bounds=new f(e,e.add(i.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),He=We.extend({getEvents:function(){var t=We.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){We.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Z(t,"mousemove",this._onMouseMove,this),Z(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Z(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){r(this._redrawRequest),delete this._ctx,T(this._container),k(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){var t,i,e,n;this._map._animatingZoom&&this._bounds||(We.prototype._update.call(this),t=this._bounds,i=this._container,e=t.getSize(),n=It?2:1,S(i,t.min),i.width=n*e.x,i.height=n*e.y,i.style.width=e.x+"px",i.style.height=e.y+"px",It&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update"))},_reset:function(){We.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t);t=(this._layers[m(t)]=t)._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var i=t._order,e=i.next,i=i.prev;e?e.prev=i:this._drawLast=i,i?i.next=e:this._drawFirst=e,delete t._order,delete this._layers[m(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){for(var i,e=t.options.dashArray.split(/[, ]+/),n=[],o=0;o<e.length;o++){if(i=Number(e[o]),isNaN(i))return;n.push(i)}t.options._dashArray=n}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||x(this._redraw,this))},_extendRedrawBounds:function(t){var i;t._pxBounds&&(i=(t.options.weight||0)+1,this._redrawBounds=this._redrawBounds||new f,this._redrawBounds.extend(t._pxBounds.min.subtract([i,i])),this._redrawBounds.extend(t._pxBounds.max.add([i,i])))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t,i=this._redrawBounds;i?(t=i.getSize(),this._ctx.clearRect(i.min.x,i.min.y,t.x,t.y)):(this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore())},_draw:function(){var t,i,e=this._redrawBounds;this._ctx.save(),e&&(i=e.getSize(),this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()),this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,i){if(this._drawing){var e,n,o,s,r=t._parts,a=r.length,h=this._ctx;if(a){for(h.beginPath(),e=0;e<a;e++){for(n=0,o=r[e].length;n<o;n++)s=r[e][n],h[n?"lineTo":"moveTo"](s.x,s.y);i&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){var i,e,n,o;this._drawing&&!t._empty()&&(i=t._point,e=this._ctx,n=Math.max(Math.round(t._radius),1),1!=(o=(Math.max(Math.round(t._radiusY),1)||n)/n)&&(e.save(),e.scale(1,o)),e.beginPath(),e.arc(i.x,i.y/o,n,0,2*Math.PI,!1),1!=o&&e.restore(),this._fillStroke(e,t))},_fillStroke:function(t,i){var e=i.options;e.fill&&(t.globalAlpha=e.fillOpacity,t.fillStyle=e.fillColor||e.color,t.fill(e.fillRule||"evenodd")),e.stroke&&0!==e.weight&&(t.setLineDash&&t.setLineDash(i.options&&i.options._dashArray||[]),t.globalAlpha=e.opacity,t.lineWidth=e.weight,t.strokeStyle=e.color,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.stroke())},_onClick:function(t){for(var i,e,n=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(i=o.layer).options.interactive&&i._containsPoint(n)&&(("click"===t.type||"preclick"!==t.type)&&this._map._draggableMoved(i)||(e=i));e&&(Di(t),this._fireEvent([e],t))},_onMouseMove:function(t){var i;!this._map||this._map.dragging.moving()||this._map._animatingZoom||(i=this._map.mouseEventToLayerPoint(t),this._handleMouseHover(t,i))},_handleMouseOut:function(t){var i=this._hoveredLayer;i&&(z(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,i){if(!this._mouseHoverThrottled){for(var e,n,o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(i)&&(n=e);n!==this._hoveredLayer&&(this._handleMouseOut(t),n)&&(M(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(_(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,i,e){this._map._fireDOMEvent(i,e||i.type,t)},_bringToFront:function(t){var i,e,n=t._order;n&&(i=n.next,e=n.prev,i)&&((i.prev=e)?e.next=i:i&&(this._drawFirst=i),n.prev=this._drawLast,(this._drawLast.next=n).next=null,this._drawLast=n,this._requestRedraw(t))},_bringToBack:function(t){var i,e,n=t._order;n&&(i=n.next,e=n.prev)&&((e.next=i)?i.prev=e:e&&(this._drawLast=e),n.prev=null,n.next=this._drawFirst,this._drawFirst.prev=n,this._drawFirst=n,this._requestRedraw(t))}});function Fe(t){return Rt?new He(t):null}var Ue=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),n={_initContainer:function(){this._container=b("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(We.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var i=t._container=Ue("shape");M(i,"leaflet-vml-shape "+(this.options.className||"")),i.coordsize="1 1",t._path=Ue("path"),i.appendChild(t._path),this._updateStyle(t),this._layers[m(t)]=t},_addPath:function(t){var i=t._container;this._container.appendChild(i),t.options.interactive&&t.addInteractiveTarget(i)},_removePath:function(t){var i=t._container;T(i),t.removeInteractiveTarget(i),delete this._layers[m(t)]},_updateStyle:function(t){var i=t._stroke,e=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(i=i||(t._stroke=Ue("stroke")),o.appendChild(i),i.weight=n.weight+"px",i.color=n.color,i.opacity=n.opacity,n.dashArray?i.dashStyle=u(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):i.dashStyle="",i.endcap=n.lineCap.replace("butt","flat"),i.joinstyle=n.lineJoin):i&&(o.removeChild(i),t._stroke=null),n.fill?(e=e||(t._fill=Ue("fill")),o.appendChild(e),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(o.removeChild(e),t._fill=null)},_updateCircle:function(t){var i=t._point.round(),e=Math.round(t._radius),n=Math.round(t._radiusY||e);this._setPath(t,t._empty()?"M0 0":"AL "+i.x+","+i.y+" "+e+","+n+" 0,23592600")},_setPath:function(t,i){t._path.v=i},_bringToFront:function(t){di(t._container)},_bringToBack:function(t){pi(t._container)}},Ve=Dt?Ue:lt,qe=We.extend({getEvents:function(){var t=We.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=Ve("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ve("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){T(this._container),k(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){var t,i,e;this._map._animatingZoom&&this._bounds||(We.prototype._update.call(this),i=(t=this._bounds).getSize(),e=this._container,this._svgSize&&this._svgSize.equals(i)||(this._svgSize=i,e.setAttribute("width",i.x),e.setAttribute("height",i.y)),S(e,t.min),e.setAttribute("viewBox",[t.min.x,t.min.y,i.x,i.y].join(" ")),this.fire("update"))},_initPath:function(t){var i=t._path=Ve("path");t.options.className&&M(i,t.options.className),t.options.interactive&&M(i,"leaflet-interactive"),this._updateStyle(t),this._layers[m(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){T(t._path),t.removeInteractiveTarget(t._path),delete this._layers[m(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var i=t._path,t=t.options;i&&(t.stroke?(i.setAttribute("stroke",t.color),i.setAttribute("stroke-opacity",t.opacity),i.setAttribute("stroke-width",t.weight),i.setAttribute("stroke-linecap",t.lineCap),i.setAttribute("stroke-linejoin",t.lineJoin),t.dashArray?i.setAttribute("stroke-dasharray",t.dashArray):i.removeAttribute("stroke-dasharray"),t.dashOffset?i.setAttribute("stroke-dashoffset",t.dashOffset):i.removeAttribute("stroke-dashoffset")):i.setAttribute("stroke","none"),t.fill?(i.setAttribute("fill",t.fillColor||t.color),i.setAttribute("fill-opacity",t.fillOpacity),i.setAttribute("fill-rule",t.fillRule||"evenodd")):i.setAttribute("fill","none"))},_updatePoly:function(t,i){this._setPath(t,ct(t._parts,i))},_updateCircle:function(t){var i=t._point,e=Math.max(Math.round(t._radius),1),n="a"+e+","+(Math.max(Math.round(t._radiusY),1)||e)+" 0 1,0 ",i=t._empty()?"M0 0":"M"+(i.x-e)+","+i.y+n+2*e+",0 "+n+2*-e+",0 ";this._setPath(t,i)},_setPath:function(t,i){t._path.setAttribute("d",i)},_bringToFront:function(t){di(t._path)},_bringToBack:function(t){pi(t._path)}});function Ge(t){return Nt||Dt?new qe(t):null}Dt&&qe.include(n),A.include({getRenderer:function(t){t=(t=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer)||(this._renderer=this._createRenderer());return this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(t){var i;return"overlayPane"!==t&&void 0!==t&&(void 0===(i=this._paneRenderers[t])&&(i=this._createRenderer({pane:t}),this._paneRenderers[t]=i),i)},_createRenderer:function(t){return this.options.preferCanvas&&Fe(t)||Ge(t)}});var Ke=ye.extend({initialize:function(t,i){ye.prototype.initialize.call(this,this._boundsToLatLngs(t),i)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=g(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});qe.create=Ve,qe.pointsToPath=ct,xe.geometryToLayer=we,xe.coordsToLatLng=Le,xe.coordsToLatLngs=be,xe.latLngToCoords=Te,xe.latLngsToCoords=Me,xe.getFeature=ze,xe.asFeature=Ce,A.mergeOptions({boxZoom:!0});var Zt=o.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Z(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){k(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){T(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),ni(),wi(),this._startPoint=this._map.mouseEventToContainerPoint(t),Z(document,{contextmenu:Ai,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=b("div","leaflet-zoom-box",this._container),M(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var t=new f(this._point,this._startPoint),i=t.getSize();S(this._box,t.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(T(this._box),z(this._container,"leaflet-crosshair")),oi(),Pi(),k(document,{contextmenu:Ai,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){1!==t.which&&1!==t.button||(this._finish(),this._moved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(_(this._resetState,this),0),t=new d(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})))},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),y=(A.addInitHook("addHandler","boxZoom",Zt),A.mergeOptions({doubleClickZoom:!0}),o.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var i=this._map,e=i.getZoom(),n=i.options.zoomDelta,e=t.originalEvent.shiftKey?e-n:e+n;"center"===i.options.doubleClickZoom?i.setZoom(e):i.setZoomAround(t.containerPoint,e)}})),St=(A.addInitHook("addHandler","doubleClickZoom",y),A.mergeOptions({dragging:!0,inertia:!vt,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),o.extend({addHooks:function(){var t;this._draggable||(t=this._map,this._draggable=new $i(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))),M(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){z(this._map._container,"leaflet-grab"),z(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t,i=this._map;i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity?(t=g(this._map.options.maxBounds),this._offsetLimit=c(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))):this._offsetLimit=null,i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){var i,e;this._map.options.inertia&&(i=this._lastTime=+new Date,e=this._lastPos=this._draggable._absPos||this._draggable._newPos,this._positions.push(e),this._times.push(i),this._prunePositions(i)),this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;1<this._positions.length&&50<t-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),i=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=i.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,i){return t-(t-i)*this._viscosity},_onPreDragLimit:function(){var t,i;this._viscosity&&this._offsetLimit&&(t=this._draggable._newPos.subtract(this._draggable._startPos),i=this._offsetLimit,t.x<i.min.x&&(t.x=this._viscousLimit(t.x,i.min.x)),t.y<i.min.y&&(t.y=this._viscousLimit(t.y,i.min.y)),t.x>i.max.x&&(t.x=this._viscousLimit(t.x,i.max.x)),t.y>i.max.y&&(t.y=this._viscousLimit(t.y,i.max.y)),this._draggable._newPos=this._draggable._startPos.add(t))},_onPreDragWrap:function(){var t=this._worldWidth,i=Math.round(t/2),e=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-i+e)%t+i-e,n=(n+i+e)%t-i-e,t=Math.abs(o+e)<Math.abs(n+e)?o:n;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=t},_onDragEnd:function(t){var i,e,n,o,s=this._map,r=s.options,a=!r.inertia||this._times.length<2;s.fire("dragend",t),!a&&(this._prunePositions(+new Date),t=this._lastPos.subtract(this._positions[0]),a=(this._lastTime-this._times[0])/1e3,i=r.easeLinearity,a=(t=t.multiplyBy(i/a)).distanceTo([0,0]),e=Math.min(r.inertiaMaxSpeed,a),t=t.multiplyBy(e/a),n=e/(r.inertiaDeceleration*i),(o=t.multiplyBy(-n/2).round()).x||o.y)?(o=s._limitOffset(o,s.options.maxBounds),x(function(){s.panBy(o,{duration:n,easeLinearity:i,noMoveStart:!0,animate:!0})})):s.fire("moveend")}})),Tt=(A.addInitHook("addHandler","dragging",St),A.mergeOptions({keyboard:!0,keyboardPanDelta:80}),o.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Z(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),k(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){var t,i,e;this._focused||(e=document.body,t=document.documentElement,i=e.scrollTop||t.scrollTop,e=e.scrollLeft||t.scrollLeft,this._map._container.focus(),window.scrollTo(e,i))},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){for(var i=this._panKeys={},e=this.keyCodes,n=0,o=e.left.length;n<o;n++)i[e.left[n]]=[-1*t,0];for(n=0,o=e.right.length;n<o;n++)i[e.right[n]]=[t,0];for(n=0,o=e.down.length;n<o;n++)i[e.down[n]]=[0,t];for(n=0,o=e.up.length;n<o;n++)i[e.up[n]]=[0,-1*t]},_setZoomDelta:function(t){for(var i=this._zoomKeys={},e=this.keyCodes,n=0,o=e.zoomIn.length;n<o;n++)i[e.zoomIn[n]]=t;for(n=0,o=e.zoomOut.length;n<o;n++)i[e.zoomOut[n]]=-t},_addHooks:function(){Z(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){k(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var i,e=t.keyCode,n=this._map;if(e in this._panKeys)n._panAnim&&n._panAnim._inProgress||(i=this._panKeys[e],t.shiftKey&&(i=l(i).multiplyBy(3)),n.panBy(i),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds));else if(e in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else{if(27!==e||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Ai(t)}}})),ht=(A.addInitHook("addHandler","keyboard",Tt),A.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),o.extend({addHooks:function(){Z(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){k(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var i=Ri(t),e=this._map.options.wheelDebounceTime,i=(this._delta+=i,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date),Math.max(e-(+new Date-this._startTime),0));clearTimeout(this._timer),this._timer=setTimeout(_(this._performZoom,this),i),Ai(t)},_performZoom:function(){var t=this._map,i=t.getZoom(),e=this._map.options.zoomSnap||0,n=(t._stop(),this._delta/(4*this._map.options.wheelPxPerZoomLevel)),n=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,e=e?Math.ceil(n/e)*e:n,n=t._limitZoom(i+(0<this._delta?e:-e))-i;this._delta=0,this._startTime=null,n&&("center"===t.options.scrollWheelZoom?t.setZoom(i+n):t.setZoomAround(this._lastMousePos,i+n))}})),ut=(A.addInitHook("addHandler","scrollWheelZoom",ht),A.mergeOptions({tap:!0,tapTolerance:15}),o.extend({addHooks:function(){Z(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){k(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){var i;t.touches&&(B(t),this._fireClick=!0,1<t.touches.length?(this._fireClick=!1,clearTimeout(this._holdTimeout)):(t=(i=t.touches[0]).target,this._startPos=this._newPos=new p(i.clientX,i.clientY),t.tagName&&"a"===t.tagName.toLowerCase()&&M(t,"leaflet-active"),this._holdTimeout=setTimeout(_(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),this._simulateEvent("mousedown",i),Z(document,{touchmove:this._onMove,touchend:this._onUp},this)))},_onUp:function(t){var i;clearTimeout(this._holdTimeout),k(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches&&((i=(t=t.changedTouches[0]).target)&&i.tagName&&"a"===i.tagName.toLowerCase()&&z(i,"leaflet-active"),this._simulateEvent("mouseup",t),this._isTapValid())&&this._simulateEvent("click",t)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){t=t.touches[0];this._newPos=new p(t.clientX,t.clientY),this._simulateEvent("mousemove",t)},_simulateEvent:function(t,i){var e=document.createEvent("MouseEvents");e._simulated=!0,i.target._simulatedClick=!0,e.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(e)}})),wt=(!kt||Et&&!Lt||A.addInitHook("addHandler","tap",ut),A.mergeOptions({touchZoom:kt&&!vt,bounceAtZoomLimits:!0}),o.extend({addHooks:function(){M(this._map._container,"leaflet-touch-zoom"),Z(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){z(this._map._container,"leaflet-touch-zoom"),k(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i,e,n=this._map;!t.touches||2!==t.touches.length||n._animatingZoom||this._zooming||(i=n.mouseEventToContainerPoint(t.touches[0]),e=n.mouseEventToContainerPoint(t.touches[1]),this._centerPoint=n.getSize()._divideBy(2),this._startLatLng=n.containerPointToLatLng(this._centerPoint),"center"!==n.options.touchZoom&&(this._pinchStartLatLng=n.containerPointToLatLng(i.add(e)._divideBy(2))),this._startDist=i.distanceTo(e),this._startZoom=n.getZoom(),this._moved=!1,this._zooming=!0,n._stop(),Z(document,"touchmove",this._onTouchMove,this),Z(document,"touchend",this._onTouchEnd,this),B(t))},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var i=this._map,e=i.mouseEventToContainerPoint(t.touches[0]),n=i.mouseEventToContainerPoint(t.touches[1]),o=e.distanceTo(n)/this._startDist;if(this._zoom=i.getScaleZoom(o,this._startZoom),!i.options.bounceAtZoomLimits&&(this._zoom<i.getMinZoom()&&o<1||this._zoom>i.getMaxZoom()&&1<o)&&(this._zoom=i._limitZoom(this._zoom)),"center"===i.options.touchZoom){if(this._center=this._startLatLng,1==o)return}else{e=e._add(n)._divideBy(2)._subtract(this._centerPoint);if(1==o&&0===e.x&&0===e.y)return;this._center=i.unproject(i.project(this._pinchStartLatLng,this._zoom).subtract(e),this._zoom)}this._moved||(i._moveStart(!0,!1),this._moved=!0),r(this._animRequest);n=_(i._move,i,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=x(n,this,!0),B(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,r(this._animRequest),k(document,"touchmove",this._onTouchMove,this),k(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}})),Ye=(A.addInitHook("addHandler","touchZoom",wt),A.BoxZoom=Zt,A.DoubleClickZoom=y,A.Drag=St,A.Keyboard=Tt,A.ScrollWheelZoom=ht,A.Tap=ut,A.TouchZoom=wt,t.version="1.7.1",t.Control=I,t.control=Fi,t.Browser=dt,t.Evented=et,t.Mixin=bt,t.Util=tt,t.Class=it,t.Handler=o,t.extend=h,t.bind=_,t.stamp=m,t.setOptions=s,t.DomEvent=yt,t.DomUtil=ft,t.PosAnimation=Hi,t.Draggable=$i,t.LineUtil=zt,t.PolyUtil=_t,t.Point=p,t.point=l,t.Bounds=f,t.bounds=c,t.Transformation=rt,t.transformation=at,t.Projection=At,t.LatLng=v,t.latLng=w,t.LatLngBounds=d,t.latLngBounds=g,t.CRS=ot,t.GeoJSON=xe,t.geoJSON=Se,t.geoJson=i,t.Layer=O,t.LayerGroup=ue,t.layerGroup=function(t,i){return new ue(t,i)},t.FeatureGroup=le,t.featureGroup=function(t,i){return new le(t,i)},t.ImageOverlay=Ze,t.imageOverlay=function(t,i,e){return new Ze(t,i,e)},t.VideoOverlay=Ee,t.videoOverlay=function(t,i,e){return new Ee(t,i,e)},t.SVGOverlay=ke,t.svgOverlay=function(t,i,e){return new ke(t,i,e)},t.DivOverlay=Be,t.Popup=Ae,t.popup=function(t,i){return new Ae(t,i)},t.Tooltip=Ie,t.tooltip=function(t,i){return new Ie(t,i)},t.Icon=ce,t.icon=function(t){return new ce(t)},t.DivIcon=Oe,t.divIcon=function(t){return new Oe(t)},t.Marker=pe,t.marker=function(t,i){return new pe(t,i)},t.TileLayer=Ne,t.tileLayer=De,t.GridLayer=Re,t.gridLayer=function(t){return new Re(t)},t.SVG=qe,t.svg=Ge,t.Renderer=We,t.Canvas=He,t.canvas=Fe,t.Path=me,t.CircleMarker=fe,t.circleMarker=function(t,i){return new fe(t,i)},t.Circle=ge,t.circle=function(t,i,e){return new ge(t,i,e)},t.Polyline=ve,t.polyline=function(t,i){return new ve(t,i)},t.Polygon=ye,t.polygon=function(t,i){return new ye(t,i)},t.Rectangle=Ke,t.rectangle=function(t,i){return new Ke(t,i)},t.Map=A,t.map=function(t,i){return new A(t,i)},window.L);t.noConflict=function(){return window.L=Ye,this},window.L=t});
L.Map.include({restoreView:function(){if(!function(e){try{var t=window[e],o="__storage_test__";return t.setItem(o,o),t.removeItem(o),1}catch(t){console.warn("Your browser blocks access to "+e)}}("localStorage"))return!1;var o=window.localStorage,t=(this.__initRestore||(this.on("moveend",function(t){var e;this._loaded&&(e={lat:this.getCenter().lat,lng:this.getCenter().lng,zoom:this.getZoom()},o.mapView=JSON.stringify(e))},this),this.__initRestore=!0),o.mapView);try{return t=JSON.parse(t||""),this.setView(L.latLng(t.lat,t.lng),t.zoom,!0),!0}catch(t){return!1}}});
"use strict";var polyline={};function py2_round(e){return Math.floor(Math.abs(e)+.5)*(0<=e?1:-1)}function encode(e,o,n){for(var r=(e=py2_round(e*n))-(o=py2_round(o*n)),t=(r<<=1,e-o<0&&(r=~r),"");32<=r;)t+=String.fromCharCode(63+(32|31&r)),r>>=5;return t+=String.fromCharCode(r+63)}function flipped(e){for(var o=[],n=0;n<e.length;n++){var r=e[n].slice();o.push([r[1],r[0]])}return o}polyline.decode=function(e,o){for(var n,r=0,t=0,i=0,l=[],u=0,p=0,d=null,c=Math.pow(10,Number.isInteger(o)?o:5);r<e.length;){for(d=null,p=u=0;p|=(31&(d=e.charCodeAt(r++)-63))<<u,u+=5,32<=d;);for(n=1&p?~(p>>1):p>>1,u=p=0;p|=(31&(d=e.charCodeAt(r++)-63))<<u,u+=5,32<=d;);l.push([(t+=n)/c,(i+=1&p?~(p>>1):p>>1)/c])}return l},polyline.encode=function(e,o){if(!e.length)return"";for(var n=Math.pow(10,Number.isInteger(o)?o:5),r=encode(e[0][0],0,n)+encode(e[0][1],0,n),t=1;t<e.length;t++)var i=e[t],l=e[t-1],r=(r+=encode(i[0],l[0],n))+encode(i[1],l[1],n);return r},polyline.fromGeoJSON=function(e,o){if((e=e&&"Feature"===e.type?e.geometry:e)&&"LineString"===e.type)return polyline.encode(flipped(e.coordinates),o);throw new Error("Input must be a GeoJSON LineString")},polyline.toGeoJSON=function(e,o){return{type:"LineString",coordinates:flipped(polyline.decode(e,o))}},"object"==typeof module&&module.exports&&(module.exports=polyline);
var toGeoJSON=function(){"use strict";var t,r=/\s*/g,i=/^\s*|\s*$/g,o=/\s+/;function p(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function x(e,t){return e.getElementsByTagName(t)}function b(e,t){return e.getAttribute(t)}function s(e,t){return parseFloat(b(e,t))}function N(e,t){e=x(e,t);return e.length?e[0]:null}function g(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function w(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function f(e,t){for(var r,n={},i=0;i<t.length;i++)(r=N(e,t[i]))&&(n[t[i]]=w(r));return n}function m(e,t){for(var r in t)e[r]=t[r]}function L(e){return g(e.replace(r,"").split(","))}function F(e){for(var t=e.replace(i,"").split(o),r=[],n=0;n<t.length;n++)r.push(L(t[n]));return r}function y(e){var t=[s(e,"lon"),s(e,"lat")],r=N(e,"ele"),n=N(e,"gpxtpx:hr")||N(e,"hr"),e=N(e,"time");return r&&(r=parseFloat(w(r)),isNaN(r)||t.push(r)),{coordinates:t,time:e?w(e):null,heartRate:n?parseFloat(w(n)):null}}function M(){return{type:"FeatureCollection",features:[]}}if("undefined"!=typeof XMLSerializer)t=new XMLSerializer;else{var e="object"==typeof process&&!process.browser,n="object"==typeof Titanium;if("object"!=typeof exports||!e&&!n)throw new Error("Unable to initialize serializer");t=new(require("@xmldom/xmldom").XMLSerializer)}function P(e){return void 0!==e.xml?e.xml:t.serializeToString(e)}return{kml:function(e){for(var t=M(),y={},d={},v={},k=["Polygon","LineString","Point","Track","gx:Track"],r=x(e,"Placemark"),n=x(e,"Style"),i=x(e,"StyleMap"),o=0;o<n.length;o++){var s=p(P(n[o])).toString(16);y["#"+b(n[o],"id")]=s,d[s]=n[o]}for(var a=0;a<i.length;a++){y["#"+b(i[a],"id")]=p(P(i[a])).toString(16);for(var l=x(i[a],"Pair"),u={},h=0;h<l.length;h++)u[w(N(l[h],"key"))]=w(N(l[h],"styleUrl"));v["#"+b(i[a],"id")]=u}for(var c=0;c<r.length;c++)t.features=t.features.concat(function(e){var t,r=function e(t){var r,n,i,o,s=[],a=[];if(N(t,"MultiGeometry"))return e(N(t,"MultiGeometry"));if(N(t,"MultiTrack"))return e(N(t,"MultiTrack"));if(N(t,"gx:MultiTrack"))return e(N(t,"gx:MultiTrack"));for(n=0;n<k.length;n++)if(r=x(t,k[n]))for(i=0;i<r.length;i++)if(h=r[i],"Point"===k[n])s.push({type:"Point",coordinates:L(w(N(h,"coordinates")))});else if("LineString"===k[n])s.push({type:"LineString",coordinates:F(w(N(h,"coordinates")))});else if("Polygon"===k[n]){var l=x(h,"LinearRing"),u=[];for(o=0;o<l.length;o++)u.push(F(w(N(l[o],"coordinates"))));s.push({type:"Polygon",coordinates:u})}else{var h;"Track"!==k[n]&&"gx:Track"!==k[n]||(h=T(h),s.push({type:"LineString",coordinates:h.coords}),h.times.length&&a.push(h.times))}return{geoms:s,coordTimes:a}}(e),n={},i=w(N(e,"name")),o=w(N(e,"address")),s=w(N(e,"styleUrl")),a=w(N(e,"description")),l=N(e,"TimeSpan"),u=N(e,"TimeStamp"),h=N(e,"ExtendedData"),c=N(e,"LineStyle"),p=N(e,"PolyStyle"),g=N(e,"visibility");if(!r.geoms.length)return[];i&&(n.name=i);o&&(n.address=o);s&&("#"!==s[0]&&(s="#"+s),y[n.styleUrl=s]&&(n.styleHash=y[s]),v[s]&&(n.styleMapHash=v[s],n.styleHash=y[v[s].normal]),i=d[n.styleHash])&&(c=c||N(i,"LineStyle"),p=p||N(i,"PolyStyle"),o=N(i,"IconStyle"))&&(s=N(o,"Icon"))&&(i=w(N(s,"href")))&&(n.icon=i);a&&(n.description=a);l&&(o=w(N(l,"begin")),s=w(N(l,"end")),n.timespan={begin:o,end:s});u&&(n.timestamp=w(N(u,"when")));c&&(i=S(w(N(c,"color"))),a=i[0],l=i[1],o=parseFloat(w(N(c,"width"))),a&&(n.stroke=a),isNaN(l)||(n["stroke-opacity"]=l),isNaN(o)||(n["stroke-width"]=o));p&&(s=S(w(N(p,"color"))),u=s[0],i=s[1],c=w(N(p,"fill")),a=w(N(p,"outline")),u&&(n.fill=u),isNaN(i)||(n["fill-opacity"]=i),c&&(n["fill-opacity"]="1"===c?n["fill-opacity"]||1:0),a)&&(n["stroke-opacity"]="1"===a?n["stroke-opacity"]||1:0);if(h){var f=x(h,"Data"),m=x(h,"SimpleData");for(t=0;t<f.length;t++)n[f[t].getAttribute("name")]=w(N(f[t],"value"));for(t=0;t<m.length;t++)n[m[t].getAttribute("name")]=w(m[t])}g&&(n.visibility=w(g));r.coordTimes.length&&(n.coordTimes=1===r.coordTimes.length?r.coordTimes[0]:r.coordTimes);l={type:"Feature",geometry:1===r.geoms.length?r.geoms[0]:{type:"GeometryCollection",geometries:r.geoms},properties:n};b(e,"id")&&(l.id=b(e,"id"));return[l]}(r[c]));function S(e){var t,r;return 6!==(e="#"===(e=e||"").substr(0,1)?e.substr(1):e).length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function T(e){var t=x(e,"coord"),r=[],n=[];0===t.length&&(t=x(e,"gx:coord"));for(var i=0;i<t.length;i++)r.push(g(w(t[i]).split(" ")));for(var o=x(e,"when"),s=0;s<o.length;s++)n.push(w(o[s]));return{coords:r,times:n}}return t},gpx:function(e){for(var t,r,n,i=x(e,"trk"),o=x(e,"rte"),s=x(e,"wpt"),a=M(),l=0;l<i.length;l++)(t=function(e){for(var t,r,n=x(e,"trkseg"),i=[],o=[],s=[],a=0;a<n.length;a++)if((t=h(n[a],"trkpt"))&&(t.line&&i.push(t.line),t.times&&t.times.length&&o.push(t.times),s.length||t.heartRates&&t.heartRates.length)){if(!s.length)for(var l=0;l<a;l++)s.push(u([],i[l].length));t.heartRates&&t.heartRates.length?s.push(t.heartRates):s.push(u([],t.line.length||0))}if(0!==i.length)return m(r=p(e),c(N(e,"extensions"))),o.length&&(r.coordTimes=1===i.length?o[0]:o),s.length&&(r.heartRates=1===i.length?s[0]:s),{type:"Feature",properties:r,geometry:{type:1===i.length?"LineString":"MultiLineString",coordinates:1===i.length?i[0]:i}}}(i[l]))&&a.features.push(t);for(l=0;l<o.length;l++)(t=function(e){var t,r=h(e,"rtept");if(r.line)return m(t=p(e),c(N(e,"extensions"))),{type:"Feature",properties:t,geometry:{type:"LineString",coordinates:r.line}}}(o[l]))&&a.features.push(t);for(l=0;l<s.length;l++)a.features.push((r=s[l],n=void 0,m(n=p(r),f(r,["sym"])),{type:"Feature",properties:n,geometry:{type:"Point",coordinates:y(r).coordinates}}));function u(e,t){for(var r=0;r<t;r++)e.push(null);return e}function h(e,t){var r=x(e,t),n=[],i=[],o=[],s=r.length;if(s<2)return{};for(var a=0;a<s;a++){var l=y(r[a]);n.push(l.coordinates),l.time&&i.push(l.time),(l.heartRate||o.length)&&(o.length||u(o,a),o.push(l.heartRate||null))}return{line:n,times:i,heartRates:o}}function c(e){var t,r,n={};return e&&(e=N(e,"line"))&&(t=w(N(e,"color")),r=parseFloat(w(N(e,"opacity"))),e=parseFloat(w(N(e,"width"))),t&&(n.stroke=t),isNaN(r)||(n["stroke-opacity"]=r),isNaN(e)||(n["stroke-width"]=96*e/25.4)),n}function p(e){var t=f(e,["name","cmt","desc","type","time","keywords"]),r=x(e,"link");r.length&&(t.links=[]);for(var n,i=0;i<r.length;i++)m(n={href:b(r[i],"href")},f(r[i],["text","type"])),t.links.push(n);return t}return a}}}();"undefined"!=typeof module&&(module.exports=toGeoJSON);
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports?exports.VectorMarkers=t(require("leaflet")):e.VectorMarkers=t(e.L)}(this,function(o){return n=[function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Icon=t.VectorMarkers=void 0;var r=i(o(1)),n=i(o(2)),o=i(o(3));function i(e){return e&&e.__esModule?e:{default:e}}t.VectorMarkers=n.default,t.Icon=o.default,r.default.VectorMarkers=n.default},function(e,t){e.exports=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=o(3),r=(o=o)&&o.__esModule?o:{default:o};t.default={version:"1.0.0",Icon:r.default,icon:function(e){return new r.default(e)}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e};function n(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=o(1),i=(o=o)&&o.__esModule?o:{default:o};var s={shadowUrl:"dist/images/marker-shadow.png",iconSize:[25,41],shadowSize:[41,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],className:"vector-marker",prefix:"fa",spinClass:"fa-spin",extraIconClasses:"",extraDivClasses:"",icon:"home",markerColor:"#338ACC",iconColor:"white",viewBox:"0 0 32 52"},o=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function o(e){var t;if(this instanceof o)return t=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e)),i.default.Util.setOptions(t,s),i.default.Util.setOptions(t,e),t;throw new TypeError("Cannot call a class as a function")}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),r(o,[{key:"createIcon",value:function(e){var e=e&&"DIV"===e.tagName?e:document.createElement("div"),t=this.options,o=t.map_pin||"M16,1 C7.7146,1 1,7.65636364 1,15.8648485 C1,24.0760606 16,51 16,51 C16,51 31,24.0760606 31,15.8648485 C31,7.65636364 24.2815,1 16,1 L16,1 Z";return e.innerHTML='<svg width="'+t.iconSize[0]+'px" height="'+t.iconSize[1]+'px" viewBox="'+t.viewBox+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="'+o+'" fill="'+t.markerColor+'"></path></svg>',t.icon&&e.appendChild(this._createInner()),t.className+=0<t.className.length?" "+t.extraDivClasses:t.extraDivClasses,this._setIconStyles(e,"icon"),this._setIconStyles(e,"icon-"+t.markerColor),e}},{key:"_createInner",value:function(){var e=document.createElement("i"),t=this.options;return e.classList.add(t.prefix),t.extraClasses&&e.classList.add(t.extraClasses),t.prefix?e.classList.add(t.prefix+"-"+t.icon):e.classList.add(t.icon),t.spin&&"string"==typeof t.spinClass&&e.classList.add(t.spinClass),t.iconColor&&("white"===t.iconColor||"black"===t.iconColor?e.classList.add("icon-"+t.iconColor):e.style.color=t.iconColor),t.iconSize&&(e.style.width=t.iconSize[0]+"px"),e}},{key:"_setIconStyles",value:function(e,t){var o=this.options,r=i.default.point(o["shadow"===t?"shadowSize":"iconSize"]),n=void 0;!(n="shadow"===t?i.default.point(o.shadowAnchor||o.iconAnchor):i.default.point(o.iconAnchor))&&r&&(n=r.divideBy(2,!0)),e.className="vector-marker-"+t+" "+o.className,n&&(e.style.marginLeft=-n.x+"px",e.style.marginTop=-n.y+"px"),r&&(e.style.width=r.x+"px",e.style.height=r.y+"px")}}]),o}(i.default.Icon);t.default=o}],i={},r.m=n,r.c=i,r.p="",r(0);function r(e){var t;return(i[e]||(t=i[e]={exports:{},id:e,loaded:!1},n[e].call(t.exports,t,t.exports,r),t.loaded=!0,t)).exports}var n,i});
!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}var e,t,s,b,r,p,y,d=function(){function e(){o(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return i(e,[{key:"addEventListener",value:function(e,t,r){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:r})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var r=this.listeners[e],n=0,o=r.length;n<o;n++)if(r[n].callback===t)return void r.splice(n,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),r=0,n=t.length;r<n;r++){var o=t[r];try{o.callback.call(this,e)}catch(e){Promise.resolve().then(function(){throw e})}o.options&&o.options.once&&this.removeEventListener(e.type,o.callback)}return!e.defaultPrevented}}}]),e}(),h=function(){var e=n,t=d;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t);var r=u(n);function n(){var e;return o(this,n),(e=r.call(this)).listeners||d.call(c(e)),Object.defineProperty(c(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(c(e),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(c(e),"reason",{value:void 0,writable:!0,configurable:!0}),e}return i(n,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort)&&this.onabort.call(this,e),f(l(n.prototype),"dispatchEvent",this).call(this,e)}}]),n}(),v=function(){function e(){o(this,e),Object.defineProperty(this,"signal",{value:new h,writable:!0,configurable:!0})}return i(e,[{key:"abort",value:function(t){var r;try{r=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(r=document.createEvent("Event")).initEvent("abort",!1,!1):(r=document.createEventObject()).type="abort":r={type:"abort",bubbles:!1,cancelable:!1}}if(void 0===t)if("undefined"==typeof document)(t=new Error("This operation was aborted")).name="AbortError";else try{t=new DOMException("signal is aborted without reason")}catch(e){(t=new Error("This operation was aborted")).name="AbortError"}this.signal.reason=t,this.signal.dispatchEvent(r)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();function O(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),1):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(v.prototype[Symbol.toStringTag]="AbortController",h.prototype[Symbol.toStringTag]="AbortSignal"),O(e="undefined"!=typeof self?self:global)&&(e.fetch?(r=(t=t="function"==typeof(t=e)?{fetch:t}:t).fetch,p=void 0===(y=t.Request)?r.Request:y,y=t.AbortController,t=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,t=(y=O({fetch:r,Request:p,AbortController:y,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:t=void 0!==t&&t})?(((s=p)&&!s.prototype.hasOwnProperty("signal")||t)&&((s=function(e,t){t&&t.signal&&(r=t.signal,delete t.signal);var r,e=new p(e,t);return r&&Object.defineProperty(e,"signal",{writable:!1,enumerable:!1,configurable:!0,value:r}),e}).prototype=p.prototype),b=r,{fetch:function(e,t){var r,n,o=s&&s.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(o){try{r=new DOMException("Aborted","AbortError")}catch(e){(r=new Error("Aborted")).name="AbortError"}return o.aborted?Promise.reject(r):(n=new Promise(function(e,t){o.addEventListener("abort",function(){return t(r)},{once:!0})}),t&&t.signal&&delete t.signal,Promise.race([n,b(e,t)]))}return b(e,t)},Request:s}):{fetch:r,Request:s}).Request,e.fetch=y.fetch,e.Request=t,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:v}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:h})):console.warn("fetch() is not available, cannot install abortcontroller-polyfill"))});
!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.bootbox=e(t.jQuery)}(this,function e(u,p){"use strict";Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,n=!{toString:null}.propertyIsEnumerable("toString"),l=(i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(t){if("function"!=typeof t&&("object"!=typeof t||null===t))throw new TypeError("Object.keys called on non-object");var e,o,a=[];for(e in t)r.call(t,e)&&a.push(e);if(n)for(o=0;o<l;o++)r.call(t,i[o])&&a.push(i[o]);return a}));var r,n,i,l,d={},s={ar:{OK:"ÙÙØ§ÙÙ",CANCEL:"Ø§ÙØºØ§Ø¡",CONFIRM:"ØªØ£ÙÙØ¯"},bg_BG:{OK:"ÐÐº",CANCEL:"ÐÑÐºÐ°Ð·",CONFIRM:"ÐÐ¾ÑÐ²ÑÑÐ¶Ð´Ð°Ð²Ð°Ð¼"},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"ZruÅ¡it",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"ÎÎ½ÏÎ¬Î¾ÎµÎ¹",CANCEL:"ÎÎºÏÏÏÏÎ·",CONFIRM:"ÎÏÎ¹Î²ÎµÎ²Î±Î¯ÏÏÎ·"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},eu:{OK:"OK",CANCEL:"Ezeztatu",CONFIRM:"Onartu"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fa:{OK:"ÙØ¨ÙÙ",CANCEL:"ÙØºÙ",CONFIRM:"ØªØ§ÛÛØ¯"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"Confirmer"},he:{OK:"×××©××¨",CANCEL:"×××××",CONFIRM:"×××©××¨"},hu:{OK:"OK",CANCEL:"MÃ©gsem",CONFIRM:"MegerÅsÃ­t"},hr:{OK:"OK",CANCEL:"Odustani",CONFIRM:"Potvrdi"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"ã­ã£ã³ã»ã«",CONFIRM:"ç¢ºèª"},ka:{OK:"OK",CANCEL:"ááá£á¥áááá",CONFIRM:"ááááá¡á¢á£á ááá"},ko:{OK:"OK",CANCEL:"ì·¨ì",CONFIRM:"íì¸"},lt:{OK:"Gerai",CANCEL:"AtÅ¡aukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"ApstiprinÄt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"PotwierdÅº"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"ÐÑÐ¼ÐµÐ½Ð°",CONFIRM:"ÐÑÐ¸Ð¼ÐµÐ½Ð¸ÑÑ"},sk:{OK:"OK",CANCEL:"ZruÅ¡iÅ¥",CONFIRM:"PotvrdiÅ¥"},sl:{OK:"OK",CANCEL:"PrekliÄi",CONFIRM:"Potrdi"},sq:{OK:"OK",CANCEL:"Anulo",CONFIRM:"Prano"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},sw:{OK:"Sawa",CANCEL:"Ghairi",CONFIRM:"Thibitisha"},ta:{OK:"à®à®°à®¿",CANCEL:"à®°à®¤à¯à®¤à¯ à®à¯à®¯à¯",CONFIRM:"à®à®±à¯à®¤à®¿ à®à¯à®¯à¯"},th:{OK:"à¸à¸à¸¥à¸",CANCEL:"à¸¢à¸à¹à¸¥à¸´à¸",CONFIRM:"à¸¢à¸·à¸à¸¢à¸±à¸"},tr:{OK:"Tamam",CANCEL:"Ä°ptal",CONFIRM:"Onayla"},uk:{OK:"OK",CANCEL:"ÐÑÐ´Ð¼ÑÐ½Ð°",CONFIRM:"ÐÑÐ¸Ð¹Ð½ÑÑÐ¸"},vi:{OK:"OK",CANCEL:"Há»§y bá»",CONFIRM:"XÃ¡c nháº­n"},zh_CN:{OK:"OK",CANCEL:"åæ¶",CONFIRM:"ç¡®è®¤"},zh_TW:{OK:"OK",CANCEL:"åæ¶",CONFIRM:"ç¢ºèª"}},b={dialog:'<div class="bootbox modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="bootbox-body"></div></div></div></div></div>',header:'<div class="modal-header"><h5 class="modal-title"></h5></div>',footer:'<div class="modal-footer"></div>',closeButton:'<button type="button" class="bootbox-close-button close" aria-hidden="true">&times;</button>',form:'<form class="bootbox-form"></form>',button:'<button type="button" class="btn"></button>',option:"<option></option>",promptMessage:'<div class="bootbox-prompt-message"></div>',inputs:{text:'<input class="bootbox-input bootbox-input-text form-control" autocomplete="off" type="text" />',textarea:'<textarea class="bootbox-input bootbox-input-textarea form-control"></textarea>',email:'<input class="bootbox-input bootbox-input-email form-control" autocomplete="off" type="email" />',select:'<select class="bootbox-input bootbox-input-select form-control"></select>',checkbox:'<div class="form-check checkbox"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-checkbox" type="checkbox" /></label></div>',radio:'<div class="form-check radio"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-radio" type="radio" name="bootbox-radio" /></label></div>',date:'<input class="bootbox-input bootbox-input-date form-control" autocomplete="off" type="date" />',time:'<input class="bootbox-input bootbox-input-time form-control" autocomplete="off" type="time" />',number:'<input class="bootbox-input bootbox-input-number form-control" autocomplete="off" type="number" />',password:'<input class="bootbox-input bootbox-input-password form-control" autocomplete="off" type="password" />',range:'<input class="bootbox-input bootbox-input-range form-control-range" autocomplete="off" type="range" />'}},f={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body",value:"",inputType:"text",swapButtonOrder:!(d.VERSION="5.5.3"),centerVertical:!1,multiple:!1,scrollable:!1,reusable:!1,relatedTarget:null};function c(t,e,o){return u.extend(!0,{},t,function(t,e){var o=t.length,a={};if(o<1||2<o)throw new Error("Invalid argument length");return 2===o||"string"==typeof t[0]?(a[e[0]]=t[0],a[e[1]]=t[1]):a=t[0],a}(e,o))}function m(t,e,o,a){var r,n,i,t={className:"bootbox-"+t,buttons:function(t,e){for(var o={},a=0,r=t.length;a<r;a++){var n=t[a],i=n.toLowerCase(),n=n.toUpperCase();o[i]={label:function(t,e){e=s[e];return(e||s.en)[t]}(n,e)}}return o}(e=a&&a[0]&&(r=a[0].locale||f.locale,a[0].swapButtonOrder||f.swapButtonOrder)?e.reverse():e,r)};return r=c(t,a,o),i={},C(n=e,function(t,e){i[e]=!0}),C(r.buttons,function(t){if(i[t]===p)throw new Error('button key "'+t+'" is not allowed (options are '+n.join(" ")+")")}),r}function h(t){return Object.keys(t).length}function C(t,o){var a=0;u.each(t,function(t,e){o(t,e,a++)})}function O(t){t.data.dialog.find(".bootbox-accept").first().trigger("focus")}function w(t){t.target===t.data.dialog[0]&&t.data.dialog.remove()}function g(t){t.target===t.data.dialog[0]&&(t.data.dialog.off("escape.close.bb"),t.data.dialog.off("click"))}function v(t,e,o){t.stopPropagation(),t.preventDefault(),u.isFunction(o)&&!1===o.call(e,t)||e.modal("hide")}function N(t){return/([01][0-9]|2[0-3]):[0-5][0-9]?:[0-5][0-9]/.test(t)}function y(t){return/(\d{4})-(\d{2})-(\d{2})/.test(t)}return d.locales=function(t){return t?s[t]:s},d.addLocale=function(t,o){return u.each(["OK","CANCEL","CONFIRM"],function(t,e){if(!o[e])throw new Error('Please supply a translation for "'+e+'"')}),s[t]={OK:o.OK,CANCEL:o.CANCEL,CONFIRM:o.CONFIRM},d},d.removeLocale=function(t){if("en"===t)throw new Error('"en" is used as the default and fallback locale and cannot be removed.');return delete s[t],d},d.setLocale=function(t){return d.setDefaults("locale",t)},d.setDefaults=function(){var t={};return 2===arguments.length?t[arguments[0]]=arguments[1]:t=arguments[0],u.extend(f,t),d},d.hideAll=function(){return u(".bootbox").modal("hide"),d},d.init=function(t){return e(t||u)},d.dialog=function(t){if(u.fn.modal===p)throw new Error('"$.fn.modal" is not defined; please double check you have included the Bootstrap JavaScript library. See https://getbootstrap.com/docs/4.4/getting-started/javascript/ for more details.');t=function(a){var r,n;if("object"!=typeof a)throw new Error("Please supply an object of options");if(!a.message)throw new Error('"message" option must not be null or an empty string.');(a=u.extend({},f,a)).backdrop?a.backdrop="string"!=typeof a.backdrop||"static"!==a.backdrop.toLowerCase()||"static":a.backdrop=!1!==a.backdrop&&0!==a.backdrop&&"static";a.buttons||(a.buttons={});return r=a.buttons,n=h(r),C(r,function(t,e,o){if(u.isFunction(e)&&(e=r[t]={callback:e}),"object"!==u.type(e))throw new Error('button with key "'+t+'" must be an object');e.label||(e.label=t),e.className||(t=!1,t=a.swapButtonOrder?0===o:o===n-1,e.className=n<=2&&t?"btn-primary":"btn-secondary btn-default")}),a}(t),u.fn.modal.Constructor.VERSION?(t.fullBootstrapVersion=u.fn.modal.Constructor.VERSION,a=t.fullBootstrapVersion.indexOf("."),t.bootstrap=t.fullBootstrapVersion.substring(0,a)):(t.bootstrap="2",t.fullBootstrapVersion="2.3.2",console.warn("Bootbox will *mostly* work with Bootstrap 2, but we do not officially support it. Please upgrade, if possible."));var o=u(b.dialog),e=o.find(".modal-dialog"),a=o.find(".modal-body"),r=u(b.header),n=u(b.footer),i=t.buttons,l={onEscape:t.onEscape};if(a.find(".bootbox-body").html(t.message),0<h(t.buttons)&&(C(i,function(t,e){var o=u(b.button);switch(o.data("bb-handler",t),o.addClass(e.className),t){case"ok":case"confirm":o.addClass("bootbox-accept");break;case"cancel":o.addClass("bootbox-cancel")}o.html(e.label),n.append(o),l[t]=e.callback}),a.after(n)),!0===t.animate&&o.addClass("fade"),t.className&&o.addClass(t.className),t.size)switch(t.fullBootstrapVersion.substring(0,3)<"3.1"&&console.warn('"size" requires Bootstrap 3.1.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option."),t.size){case"small":case"sm":e.addClass("modal-sm");break;case"large":case"lg":e.addClass("modal-lg");break;case"extra-large":case"xl":e.addClass("modal-xl"),t.fullBootstrapVersion.substring(0,3)<"4.2"&&console.warn('Using size "xl"/"extra-large" requires Bootstrap 4.2.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option.")}if(t.scrollable&&(e.addClass("modal-dialog-scrollable"),t.fullBootstrapVersion.substring(0,3)<"4.3")&&console.warn('Using "scrollable" requires Bootstrap 4.3.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option."),t.title&&(a.before(r),o.find(".modal-title").html(t.title)),t.closeButton&&(i=u(b.closeButton),t.title?3<t.bootstrap?o.find(".modal-header").append(i):o.find(".modal-header").prepend(i):i.prependTo(a)),t.centerVertical&&(e.addClass("modal-dialog-centered"),t.fullBootstrapVersion<"4.0.0")&&console.warn('"centerVertical" requires Bootstrap 4.0.0-beta.3 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option."),t.reusable||o.one("hide.bs.modal",{dialog:o},g),t.onHide){if(!u.isFunction(t.onHide))throw new Error('Argument supplied to "onHide" must be a function');o.on("hide.bs.modal",t.onHide)}if(t.reusable||o.one("hidden.bs.modal",{dialog:o},w),t.onHidden){if(!u.isFunction(t.onHidden))throw new Error('Argument supplied to "onHidden" must be a function');o.on("hidden.bs.modal",t.onHidden)}if(t.onShow){if(!u.isFunction(t.onShow))throw new Error('Argument supplied to "onShow" must be a function');o.on("show.bs.modal",t.onShow)}if(o.one("shown.bs.modal",{dialog:o},O),t.onShown){if(!u.isFunction(t.onShown))throw new Error('Argument supplied to "onShown" must be a function');o.on("shown.bs.modal",t.onShown)}return!0===t.backdrop&&o.on("click.dismiss.bs.modal",function(t){o.children(".modal-backdrop").length&&(t.currentTarget=o.children(".modal-backdrop").get(0)),t.target===t.currentTarget&&o.trigger("escape.close.bb")}),o.on("escape.close.bb",function(t){l.onEscape&&v(t,o,l.onEscape)}),o.on("click",".modal-footer button:not(.disabled)",function(t){var e=u(this).data("bb-handler");e!==p&&v(t,o,l[e])}),o.on("click",".bootbox-close-button",function(t){v(t,o,l.onEscape)}),o.on("keyup",function(t){27===t.which&&o.trigger("escape.close.bb")}),u(t.container).append(o),o.modal({backdrop:t.backdrop,keyboard:!1,show:!1}),t.show&&o.modal("show",t.relatedTarget),o},d.alert=function(){var t=m("alert",["ok"],["message","callback"],arguments);if(t.callback&&!u.isFunction(t.callback))throw new Error('alert requires the "callback" property to be a function when provided');return t.buttons.ok.callback=t.onEscape=function(){return!u.isFunction(t.callback)||t.callback.call(this)},d.dialog(t)},d.confirm=function(){var t=m("confirm",["cancel","confirm"],["message","callback"],arguments);if(u.isFunction(t.callback))return t.buttons.cancel.callback=t.onEscape=function(){return t.callback.call(this,!1)},t.buttons.confirm.callback=function(){return t.callback.call(this,!0)},d.dialog(t);throw new Error("confirm requires a callback")},d.prompt=function(){var e,t,o,a=u(b.form),r=m("prompt",["cancel","confirm"],["title","callback"],arguments);if(r.value||(r.value=f.value),r.inputType||(r.inputType=f.inputType),t=(r.show===p?f:r).show,r.show=!1,r.buttons.cancel.callback=r.onEscape=function(){return r.callback.call(this,null)},r.buttons.confirm.callback=function(){var t;if("checkbox"===r.inputType)t=s.find("input:checked").map(function(){return u(this).val()}).get();else if("radio"===r.inputType)t=s.find("input:checked").val();else{if(s[0].checkValidity&&!s[0].checkValidity())return!1;t="select"===r.inputType&&!0===r.multiple?s.find("option:selected").map(function(){return u(this).val()}).get():s.val()}return r.callback.call(this,t)},!r.title)throw new Error("prompt requires a title");if(!u.isFunction(r.callback))throw new Error("prompt requires a callback");if(!b.inputs[r.inputType])throw new Error("Invalid prompt type");switch(s=u(b.inputs[r.inputType]),r.inputType){case"text":case"textarea":case"email":case"password":s.val(r.value),r.placeholder&&s.attr("placeholder",r.placeholder),r.pattern&&s.attr("pattern",r.pattern),r.maxlength&&s.attr("maxlength",r.maxlength),r.required&&s.prop({required:!0}),r.rows&&!isNaN(parseInt(r.rows))&&"textarea"===r.inputType&&s.attr({rows:r.rows});break;case"date":case"time":case"number":case"range":if(s.val(r.value),r.placeholder&&s.attr("placeholder",r.placeholder),r.pattern&&s.attr("pattern",r.pattern),r.required&&s.prop({required:!0}),"date"!==r.inputType&&r.step){if(!("any"===r.step||!isNaN(r.step)&&0<parseFloat(r.step)))throw new Error('"step" must be a valid positive number or the value "any". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-step for more information.');s.attr("step",r.step)}!function(t,e,o){var a=!1,r=!0,n=!0;if("date"===t)e===p||(r=y(e))?o===p||(n=y(o))||console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your max value may not be enforced by this browser.'):console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your min value may not be enforced by this browser.');else if("time"===t){if(e!==p&&!(r=N(e)))throw new Error('"min" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');if(o!==p&&!(n=N(o)))throw new Error('"max" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.')}else{if(e!==p&&isNaN(e))throw r=!1,new Error('"min" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-min for more information.');if(o!==p&&isNaN(o))throw n=!1,new Error('"max" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.')}if(r&&n){if(o<=e)throw new Error('"max" must be greater than "min". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');a=!0}return a}(r.inputType,r.min,r.max)||(r.min!==p&&s.attr("min",r.min),r.max===p)||s.attr("max",r.max);break;case"select":var n={},i=r.inputOptions||[];if(!u.isArray(i))throw new Error("Please pass an array of input options");if(!i.length)throw new Error('prompt with "inputType" set to "select" requires at least one option');r.placeholder&&s.attr("placeholder",r.placeholder),r.required&&s.prop({required:!0}),r.multiple&&s.prop({multiple:!0}),C(i,function(t,e){var o=s;if(e.value===p||e.text===p)throw new Error('each option needs a "value" property and a "text" property');e.group&&(n[e.group]||(n[e.group]=u("<optgroup />").attr("label",e.group)),o=n[e.group]);var a=u(b.option);a.attr("value",e.value).text(e.text),o.append(a)}),C(n,function(t,e){s.append(e)}),s.val(r.value);break;case"checkbox":var l=u.isArray(r.value)?r.value:[r.value];if(!(i=r.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "checkbox" requires at least one option');s=u('<div class="bootbox-checkbox-list"></div>'),C(i,function(t,o){if(o.value===p||o.text===p)throw new Error('each option needs a "value" property and a "text" property');var a=u(b.inputs[r.inputType]);a.find("input").attr("value",o.value),a.find("label").append("\n"+o.text),C(l,function(t,e){e===o.value&&a.find("input").prop("checked",!0)}),s.append(a)});break;case"radio":if(r.value!==p&&u.isArray(r.value))throw new Error('prompt with "inputType" set to "radio" requires a single, non-array value for "value"');if(!(i=r.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "radio" requires at least one option');var s=u('<div class="bootbox-radiobutton-list"></div>'),c=!0;C(i,function(t,e){if(e.value===p||e.text===p)throw new Error('each option needs a "value" property and a "text" property');var o=u(b.inputs[r.inputType]);o.find("input").attr("value",e.value),o.find("label").append("\n"+e.text),r.value!==p&&e.value===r.value&&(o.find("input").prop("checked",!0),c=!1),s.append(o)}),c&&s.find('input[type="radio"]').first().prop("checked",!0)}return a.append(s),a.on("submit",function(t){t.preventDefault(),t.stopPropagation(),e.find(".bootbox-accept").trigger("click")}),""!==u.trim(r.message)&&(o=u(b.promptMessage).html(r.message),a.prepend(o)),r.message=a,(e=d.dialog(r)).off("shown.bs.modal",O),e.on("shown.bs.modal",function(){s.focus()}),!0===t&&e.modal("show"),e},d});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("jquery"),require("popper.js")):"function"==typeof define&&define.amd?define(["exports","jquery","popper.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).bootstrap={},t.jQuery,t.Popper)}(this,function(t,e,n){"use strict";function x(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var d=x(e),q=x(n);function F(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){e&&F(t.prototype,e),n&&F(t,n),Object.defineProperty(t,"prototype",{writable:!1})}function l(){return(l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Q(t,e){return(Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var B="transitionend";function H(t){var e=this,n=!1;return d.default(this).one(c.TRANSITION_END,function(){n=!0}),setTimeout(function(){n||c.triggerTransitionEnd(e)},t),this}var c={TRANSITION_END:"bsTransitionEnd",getUID:function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},getSelectorFromElement:function(t){var e=t.getAttribute("data-target");e&&"#"!==e||(e=(t=t.getAttribute("href"))&&"#"!==t?t.trim():"");try{return document.querySelector(e)?e:null}catch(t){return null}},getTransitionDurationFromElement:function(t){var e,n,i;return t&&(e=d.default(t).css("transition-duration"),t=d.default(t).css("transition-delay"),n=parseFloat(e),i=parseFloat(t),n||i)?(e=e.split(",")[0],t=t.split(",")[0],1e3*(parseFloat(e)+parseFloat(t))):0},reflow:function(t){return t.offsetHeight},triggerTransitionEnd:function(t){d.default(t).trigger(B)},supportsTransitionEnd:function(){return Boolean(B)},isElement:function(t){return(t[0]||t).nodeType},typeCheckConfig:function(t,e,n){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var o=n[i],a=e[i],a=a&&c.isElement(a)?"element":null==(a=a)?""+a:{}.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(o).test(a))throw new Error(t.toUpperCase()+': Option "'+i+'" provided type "'+a+'" but expected type "'+o+'".')}},findShadowRoot:function(t){var e;return document.documentElement.attachShadow?"function"==typeof t.getRootNode?(e=t.getRootNode())instanceof ShadowRoot?e:null:t instanceof ShadowRoot?t:t.parentNode?c.findShadowRoot(t.parentNode):null:null},jQueryDetection:function(){if(void 0===d.default)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var t=d.default.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1===t[0]&&9===t[1]&&t[2]<1||4<=t[0])throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}},i=(c.jQueryDetection(),d.default.fn.emulateTransitionEnd=H,d.default.event.special[c.TRANSITION_END]={bindType:B,delegateType:B,handle:function(t){if(d.default(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}},"alert"),U="bs.alert",M=d.default.fn[i],o=function(){function i(t){this._element=t}var t=i.prototype;return t.close=function(t){var e=this._element;t&&(e=this._getRootElement(t)),this._triggerCloseEvent(e).isDefaultPrevented()||this._removeElement(e)},t.dispose=function(){d.default.removeData(this._element,U),this._element=null},t._getRootElement=function(t){var e=c.getSelectorFromElement(t),n=!1;return n=(n=e?document.querySelector(e):n)||d.default(t).closest(".alert")[0]},t._triggerCloseEvent=function(t){var e=d.default.Event("close.bs.alert");return d.default(t).trigger(e),e},t._removeElement=function(e){var t,n=this;d.default(e).removeClass("show"),d.default(e).hasClass("fade")?(t=c.getTransitionDurationFromElement(e),d.default(e).one(c.TRANSITION_END,function(t){return n._destroyElement(e,t)}).emulateTransitionEnd(t)):this._destroyElement(e)},t._destroyElement=function(t){d.default(t).detach().trigger("closed.bs.alert").remove()},i._jQueryInterface=function(n){return this.each(function(){var t=d.default(this),e=t.data(U);e||(e=new i(this),t.data(U,e)),"close"===n&&e[n](this)})},i._handleDismiss=function(e){return function(t){t&&t.preventDefault(),e.close(this)}},s(i,null,[{key:"VERSION",get:function(){return"4.6.2"}}]),i}(),a=(d.default(document).on("click.bs.alert.data-api",'[data-dismiss="alert"]',o._handleDismiss(new o)),d.default.fn[i]=o._jQueryInterface,d.default.fn[i].Constructor=o,d.default.fn[i].noConflict=function(){return d.default.fn[i]=M,o._jQueryInterface},"button"),W="bs.button",V=d.default.fn[a],r="active",e='[data-toggle^="button"]',z='input:not([type="hidden"])',K=".btn",u=function(){function o(t){this._element=t,this.shouldAvoidTriggerChange=!1}var t=o.prototype;return t.toggle=function(){var t,e=!0,n=!0,i=d.default(this._element).closest('[data-toggle="buttons"]')[0];i&&(t=this._element.querySelector(z))&&("radio"===t.type&&(t.checked&&this._element.classList.contains(r)?e=!1:(i=i.querySelector(".active"))&&d.default(i).removeClass(r)),e&&("checkbox"!==t.type&&"radio"!==t.type||(t.checked=!this._element.classList.contains(r)),this.shouldAvoidTriggerChange||d.default(t).trigger("change")),t.focus(),n=!1),this._element.hasAttribute("disabled")||this._element.classList.contains("disabled")||(n&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(r)),e&&d.default(this._element).toggleClass(r))},t.dispose=function(){d.default.removeData(this._element,W),this._element=null},o._jQueryInterface=function(n,i){return this.each(function(){var t=d.default(this),e=t.data(W);e||(e=new o(this),t.data(W,e)),e.shouldAvoidTriggerChange=i,"toggle"===n&&e[n]()})},s(o,null,[{key:"VERSION",get:function(){return"4.6.2"}}]),o}(),f=(d.default(document).on("click.bs.button.data-api",e,function(t){var e,n=t.target,i=n;!(n=d.default(n).hasClass("btn")?n:d.default(n).closest(K)[0])||n.hasAttribute("disabled")||n.classList.contains("disabled")||(e=n.querySelector(z))&&(e.hasAttribute("disabled")||e.classList.contains("disabled"))?t.preventDefault():"INPUT"!==i.tagName&&"LABEL"===n.tagName||u._jQueryInterface.call(d.default(n),"toggle","INPUT"===i.tagName)}).on("focus.bs.button.data-api blur.bs.button.data-api",e,function(t){var e=d.default(t.target).closest(K)[0];d.default(e).toggleClass("focus",/^focus(in)?$/.test(t.type))}),d.default(window).on("load.bs.button.data-api",function(){for(var t=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),e=0,n=t.length;e<n;e++){var i=t[e],o=i.querySelector(z);o.checked||o.hasAttribute("checked")?i.classList.add(r):i.classList.remove(r)}for(var a=0,s=(t=[].slice.call(document.querySelectorAll('[data-toggle="button"]'))).length;a<s;a++){var l=t[a];"true"===l.getAttribute("aria-pressed")?l.classList.add(r):l.classList.remove(r)}}),d.default.fn[a]=u._jQueryInterface,d.default.fn[a].Constructor=u,d.default.fn[a].noConflict=function(){return d.default.fn[a]=V,u._jQueryInterface},"carousel"),h="bs.carousel",X="."+h,Y=d.default.fn[f],g="active",$="next",J="prev",G="slid"+X,Z=".active.carousel-item",tt={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},et={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},nt={TOUCH:"touch",PEN:"pen"},m=function(){function o(t,e){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(e),this._element=t,this._indicatorsElement=this._element.querySelector(".carousel-indicators"),this._touchSupported="ontouchstart"in document.documentElement||0<navigator.maxTouchPoints,this._pointerEvent=Boolean(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var t=o.prototype;return t.next=function(){this._isSliding||this._slide($)},t.nextWhenVisible=function(){var t=d.default(this._element);!document.hidden&&t.is(":visible")&&"hidden"!==t.css("visibility")&&this.next()},t.prev=function(){this._isSliding||this._slide(J)},t.pause=function(t){t||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(c.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},t.cycle=function(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},t.to=function(t){var e=this,n=(this._activeElement=this._element.querySelector(Z),this._getItemIndex(this._activeElement));t>this._items.length-1||t<0||(this._isSliding?d.default(this._element).one(G,function(){return e.to(t)}):n===t?(this.pause(),this.cycle()):this._slide(n<t?$:J,this._items[t]))},t.dispose=function(){d.default(this._element).off(X),d.default.removeData(this._element,h),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},t._getConfig=function(t){return t=l({},tt,t),c.typeCheckConfig(f,t,et),t},t._handleSwipe=function(){var t=Math.abs(this.touchDeltaX);t<=40||(t=t/this.touchDeltaX,(this.touchDeltaX=0)<t&&this.prev(),t<0&&this.next())},t._addEventListeners=function(){var e=this;this._config.keyboard&&d.default(this._element).on("keydown.bs.carousel",function(t){return e._keydown(t)}),"hover"===this._config.pause&&d.default(this._element).on("mouseenter.bs.carousel",function(t){return e.pause(t)}).on("mouseleave.bs.carousel",function(t){return e.cycle(t)}),this._config.touch&&this._addTouchEventListeners()},t._addTouchEventListeners=function(){var t,e,n=this;this._touchSupported&&(t=function(t){n._pointerEvent&&nt[t.originalEvent.pointerType.toUpperCase()]?n.touchStartX=t.originalEvent.clientX:n._pointerEvent||(n.touchStartX=t.originalEvent.touches[0].clientX)},e=function(t){n._pointerEvent&&nt[t.originalEvent.pointerType.toUpperCase()]&&(n.touchDeltaX=t.originalEvent.clientX-n.touchStartX),n._handleSwipe(),"hover"===n._config.pause&&(n.pause(),n.touchTimeout&&clearTimeout(n.touchTimeout),n.touchTimeout=setTimeout(function(t){return n.cycle(t)},500+n._config.interval))},d.default(this._element.querySelectorAll(".carousel-item img")).on("dragstart.bs.carousel",function(t){return t.preventDefault()}),this._pointerEvent?(d.default(this._element).on("pointerdown.bs.carousel",t),d.default(this._element).on("pointerup.bs.carousel",e),this._element.classList.add("pointer-event")):(d.default(this._element).on("touchstart.bs.carousel",t),d.default(this._element).on("touchmove.bs.carousel",function(t){t=t,n.touchDeltaX=t.originalEvent.touches&&1<t.originalEvent.touches.length?0:t.originalEvent.touches[0].clientX-n.touchStartX}),d.default(this._element).on("touchend.bs.carousel",e)))},t._keydown=function(t){if(!/input|textarea/i.test(t.target.tagName))switch(t.which){case 37:t.preventDefault(),this.prev();break;case 39:t.preventDefault(),this.next()}},t._getItemIndex=function(t){return this._items=t&&t.parentNode?[].slice.call(t.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(t)},t._getItemByDirection=function(t,e){var n=t===$,i=t===J,o=this._getItemIndex(e),a=this._items.length-1;return(i&&0===o||n&&o===a)&&!this._config.wrap?e:-1==(i=(o+(t===J?-1:1))%this._items.length)?this._items[this._items.length-1]:this._items[i]},t._triggerSlideEvent=function(t,e){var n=this._getItemIndex(t),i=this._getItemIndex(this._element.querySelector(Z)),t=d.default.Event("slide.bs.carousel",{relatedTarget:t,direction:e,from:i,to:n});return d.default(this._element).trigger(t),t},t._setActiveIndicatorElement=function(t){var e;this._indicatorsElement&&(e=[].slice.call(this._indicatorsElement.querySelectorAll(".active")),d.default(e).removeClass(g),e=this._indicatorsElement.children[this._getItemIndex(t)])&&d.default(e).addClass(g)},t._updateInterval=function(){var t=this._activeElement||this._element.querySelector(Z);t&&((t=parseInt(t.getAttribute("data-interval"),10))?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=t):this._config.interval=this._config.defaultInterval||this._config.interval)},t._slide=function(t,e){var n,i,o,a=this,s=this._element.querySelector(Z),l=this._getItemIndex(s),r=e||s&&this._getItemByDirection(t,s),e=this._getItemIndex(r),u=Boolean(this._interval),t=t===$?(n="carousel-item-left",i="carousel-item-next","left"):(n="carousel-item-right",i="carousel-item-prev","right");r&&d.default(r).hasClass(g)?this._isSliding=!1:this._triggerSlideEvent(r,t).isDefaultPrevented()||s&&r&&(this._isSliding=!0,u&&this.pause(),this._setActiveIndicatorElement(r),this._activeElement=r,o=d.default.Event(G,{relatedTarget:r,direction:t,from:l,to:e}),d.default(this._element).hasClass("slide")?(d.default(r).addClass(i),c.reflow(r),d.default(s).addClass(n),d.default(r).addClass(n),t=c.getTransitionDurationFromElement(s),d.default(s).one(c.TRANSITION_END,function(){d.default(r).removeClass(n+" "+i).addClass(g),d.default(s).removeClass(g+" "+i+" "+n),a._isSliding=!1,setTimeout(function(){return d.default(a._element).trigger(o)},0)}).emulateTransitionEnd(t)):(d.default(s).removeClass(g),d.default(r).addClass(g),this._isSliding=!1,d.default(this._element).trigger(o)),u)&&this.cycle()},o._jQueryInterface=function(i){return this.each(function(){var t=d.default(this).data(h),e=l({},tt,d.default(this).data()),n=("object"==typeof i&&(e=l({},e,i)),"string"==typeof i?i:e.slide);if(t||(t=new o(this,e),d.default(this).data(h,t)),"number"==typeof i)t.to(i);else if("string"==typeof n){if(void 0===t[n])throw new TypeError('No method named "'+n+'"');t[n]()}else e.interval&&e.ride&&(t.pause(),t.cycle())})},o._dataApiClickHandler=function(t){var e,n,i=c.getSelectorFromElement(this);i&&(i=d.default(i)[0])&&d.default(i).hasClass("carousel")&&(e=l({},d.default(i).data(),d.default(this).data()),(n=this.getAttribute("data-slide-to"))&&(e.interval=!1),o._jQueryInterface.call(d.default(i),e),n&&d.default(i).data(h).to(n),t.preventDefault())},s(o,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return tt}}]),o}(),_=(d.default(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",m._dataApiClickHandler),d.default(window).on("load.bs.carousel.data-api",function(){for(var t=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),e=0,n=t.length;e<n;e++){var i=d.default(t[e]);m._jQueryInterface.call(i,i.data())}}),d.default.fn[f]=m._jQueryInterface,d.default.fn[f].Constructor=m,d.default.fn[f].noConflict=function(){return d.default.fn[f]=Y,m._jQueryInterface},"collapse"),p="bs.collapse",it=d.default.fn[_],v="show",y="collapse",ot="collapsing",at="collapsed",st='[data-toggle="collapse"]',lt={toggle:!0,parent:""},rt={toggle:"boolean",parent:"(string|element)"},b=function(){function a(e,t){this._isTransitioning=!1,this._element=e,this._config=this._getConfig(t),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'));for(var n=[].slice.call(document.querySelectorAll(st)),i=0,o=n.length;i<o;i++){var a=n[i],s=c.getSelectorFromElement(a),l=[].slice.call(document.querySelectorAll(s)).filter(function(t){return t===e});null!==s&&0<l.length&&(this._selector=s,this._triggerArray.push(a))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var t=a.prototype;return t.toggle=function(){d.default(this._element).hasClass(v)?this.hide():this.show()},t.show=function(){var t,e,n,i,o=this;this._isTransitioning||d.default(this._element).hasClass(v)||(t=this._parent&&0===(t=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(t){return"string"==typeof o._config.parent?t.getAttribute("data-parent")===o._config.parent:t.classList.contains(y)})).length?null:t)&&(i=d.default(t).not(this._selector).data(p))&&i._isTransitioning||(n=d.default.Event("show.bs.collapse"),d.default(this._element).trigger(n),n.isDefaultPrevented())||(t&&(a._jQueryInterface.call(d.default(t).not(this._selector),"hide"),i||d.default(t).data(p,null)),e=this._getDimension(),d.default(this._element).removeClass(y).addClass(ot),this._element.style[e]=0,this._triggerArray.length&&d.default(this._triggerArray).removeClass(at).attr("aria-expanded",!0),this.setTransitioning(!0),n="scroll"+(e[0].toUpperCase()+e.slice(1)),i=c.getTransitionDurationFromElement(this._element),d.default(this._element).one(c.TRANSITION_END,function(){d.default(o._element).removeClass(ot).addClass(y+" "+v),o._element.style[e]="",o.setTransitioning(!1),d.default(o._element).trigger("shown.bs.collapse")}).emulateTransitionEnd(i),this._element.style[e]=this._element[n]+"px")},t.hide=function(){var t=this;if(!this._isTransitioning&&d.default(this._element).hasClass(v)){var e=d.default.Event("hide.bs.collapse");if(d.default(this._element).trigger(e),!e.isDefaultPrevented()){var e=this._getDimension(),n=(this._element.style[e]=this._element.getBoundingClientRect()[e]+"px",c.reflow(this._element),d.default(this._element).addClass(ot).removeClass(y+" "+v),this._triggerArray.length);if(0<n)for(var i=0;i<n;i++){var o=this._triggerArray[i],a=c.getSelectorFromElement(o);null===a||d.default([].slice.call(document.querySelectorAll(a))).hasClass(v)||d.default(o).addClass(at).attr("aria-expanded",!1)}this.setTransitioning(!0);this._element.style[e]="";e=c.getTransitionDurationFromElement(this._element);d.default(this._element).one(c.TRANSITION_END,function(){t.setTransitioning(!1),d.default(t._element).removeClass(ot).addClass(y).trigger("hidden.bs.collapse")}).emulateTransitionEnd(e)}}},t.setTransitioning=function(t){this._isTransitioning=t},t.dispose=function(){d.default.removeData(this._element,p),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},t._getConfig=function(t){return(t=l({},lt,t)).toggle=Boolean(t.toggle),c.typeCheckConfig(_,t,rt),t},t._getDimension=function(){return d.default(this._element).hasClass("width")?"width":"height"},t._getParent=function(){var t,n=this,e=(c.isElement(this._config.parent)?(t=this._config.parent,void 0!==this._config.parent.jquery&&(t=this._config.parent[0])):t=document.querySelector(this._config.parent),'[data-toggle="collapse"][data-parent="'+this._config.parent+'"]'),e=[].slice.call(t.querySelectorAll(e));return d.default(e).each(function(t,e){n._addAriaAndCollapsedClass(a._getTargetFromElement(e),[e])}),t},t._addAriaAndCollapsedClass=function(t,e){t=d.default(t).hasClass(v);e.length&&d.default(e).toggleClass(at,!t).attr("aria-expanded",t)},a._getTargetFromElement=function(t){t=c.getSelectorFromElement(t);return t?document.querySelector(t):null},a._jQueryInterface=function(i){return this.each(function(){var t=d.default(this),e=t.data(p),n=l({},lt,t.data(),"object"==typeof i&&i?i:{});if(!e&&n.toggle&&"string"==typeof i&&/show|hide/.test(i)&&(n.toggle=!1),e||(e=new a(this,n),t.data(p,e)),"string"==typeof i){if(void 0===e[i])throw new TypeError('No method named "'+i+'"');e[i]()}})},s(a,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return lt}}]),a}(),E=(d.default(document).on("click.bs.collapse.data-api",st,function(t){"A"===t.currentTarget.tagName&&t.preventDefault();var n=d.default(this),t=c.getSelectorFromElement(this),t=[].slice.call(document.querySelectorAll(t));d.default(t).each(function(){var t=d.default(this),e=t.data(p)?"toggle":n.data();b._jQueryInterface.call(t,e)})}),d.default.fn[_]=b._jQueryInterface,d.default.fn[_].Constructor=b,d.default.fn[_].noConflict=function(){return d.default.fn[_]=it,b._jQueryInterface},"dropdown"),T="bs.dropdown",ut="."+T,n=".data-api",dt=d.default.fn[E],ct=new RegExp("38|40|27"),ft="disabled",w="show",ht="dropdown-menu-right",gt="hide"+ut,mt="hidden"+ut,e="click"+ut+n,n="keydown"+ut+n,_t='[data-toggle="dropdown"]',pt=".dropdown-menu",vt={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},yt={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},C=function(){function u(t,e){this._element=t,this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var t=u.prototype;return t.toggle=function(){var t;this._element.disabled||d.default(this._element).hasClass(ft)||(t=d.default(this._menu).hasClass(w),u._clearMenus(),t)||this.show(!0)},t.show=function(t){if(void 0===t&&(t=!1),!(this._element.disabled||d.default(this._element).hasClass(ft)||d.default(this._menu).hasClass(w))){var e={relatedTarget:this._element},n=d.default.Event("show.bs.dropdown",e),i=u._getParentFromElement(this._element);if(d.default(i).trigger(n),!n.isDefaultPrevented()){if(!this._inNavbar&&t){if(void 0===q.default)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");n=this._element;"parent"===this._config.reference?n=i:c.isElement(this._config.reference)&&(n=this._config.reference,void 0!==this._config.reference.jquery)&&(n=this._config.reference[0]),"scrollParent"!==this._config.boundary&&d.default(i).addClass("position-static"),this._popper=new q.default(n,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===d.default(i).closest(".navbar-nav").length&&d.default(document.body).children().on("mouseover",null,d.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),d.default(this._menu).toggleClass(w),d.default(i).toggleClass(w).trigger(d.default.Event("shown.bs.dropdown",e))}}},t.hide=function(){var t,e,n;this._element.disabled||d.default(this._element).hasClass(ft)||!d.default(this._menu).hasClass(w)||(t={relatedTarget:this._element},e=d.default.Event(gt,t),n=u._getParentFromElement(this._element),d.default(n).trigger(e),e.isDefaultPrevented())||(this._popper&&this._popper.destroy(),d.default(this._menu).toggleClass(w),d.default(n).toggleClass(w).trigger(d.default.Event(mt,t)))},t.dispose=function(){d.default.removeData(this._element,T),d.default(this._element).off(ut),this._element=null,(this._menu=null)!==this._popper&&(this._popper.destroy(),this._popper=null)},t.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},t._addEventListeners=function(){var e=this;d.default(this._element).on("click.bs.dropdown",function(t){t.preventDefault(),t.stopPropagation(),e.toggle()})},t._getConfig=function(t){return t=l({},this.constructor.Default,d.default(this._element).data(),t),c.typeCheckConfig(E,t,this.constructor.DefaultType),t},t._getMenuElement=function(){var t;return this._menu||(t=u._getParentFromElement(this._element))&&(this._menu=t.querySelector(pt)),this._menu},t._getPlacement=function(){var t=d.default(this._element.parentNode),e="bottom-start";return t.hasClass("dropup")?e=d.default(this._menu).hasClass(ht)?"top-end":"top-start":t.hasClass("dropright")?e="right-start":t.hasClass("dropleft")?e="left-start":d.default(this._menu).hasClass(ht)&&(e="bottom-end"),e},t._detectNavbar=function(){return 0<d.default(this._element).closest(".navbar").length},t._getOffset=function(){var e=this,t={};return"function"==typeof this._config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e._config.offset(t.offsets,e._element)),t}:t.offset=this._config.offset,t},t._getPopperConfig=function(){var t={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(t.modifiers.applyStyle={enabled:!1}),l({},t,this._config.popperConfig)},u._jQueryInterface=function(e){return this.each(function(){var t=d.default(this).data(T);if(t||(t=new u(this,"object"==typeof e?e:null),d.default(this).data(T,t)),"string"==typeof e){if(void 0===t[e])throw new TypeError('No method named "'+e+'"');t[e]()}})},u._clearMenus=function(t){if(!t||3!==t.which&&("keyup"!==t.type||9===t.which))for(var e=[].slice.call(document.querySelectorAll(_t)),n=0,i=e.length;n<i;n++){var o,a,s=u._getParentFromElement(e[n]),l=d.default(e[n]).data(T),r={relatedTarget:e[n]};t&&"click"===t.type&&(r.clickEvent=t),l&&(o=l._menu,!d.default(s).hasClass(w)||t&&("click"===t.type&&/input|textarea/i.test(t.target.tagName)||"keyup"===t.type&&9===t.which)&&d.default.contains(s,t.target)||(a=d.default.Event(gt,r),d.default(s).trigger(a),a.isDefaultPrevented())||("ontouchstart"in document.documentElement&&d.default(document.body).children().off("mouseover",null,d.default.noop),e[n].setAttribute("aria-expanded","false"),l._popper&&l._popper.destroy(),d.default(o).removeClass(w),d.default(s).removeClass(w).trigger(d.default.Event(mt,r))))}},u._getParentFromElement=function(t){var e,n=c.getSelectorFromElement(t);return(e=n?document.querySelector(n):e)||t.parentNode},u._dataApiKeydownHandler=function(t){var e,n,i;(/input|textarea/i.test(t.target.tagName)?32===t.which||27!==t.which&&(40!==t.which&&38!==t.which||d.default(t.target).closest(pt).length):!ct.test(t.which))||this.disabled||d.default(this).hasClass(ft)||(e=u._getParentFromElement(this),!(n=d.default(e).hasClass(w))&&27===t.which)||(t.preventDefault(),t.stopPropagation(),n&&27!==t.which&&32!==t.which?0!==(n=[].slice.call(e.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(t){return d.default(t).is(":visible")})).length&&(i=n.indexOf(t.target),38===t.which&&0<i&&i--,40===t.which&&i<n.length-1&&i++,n[i=i<0?0:i].focus()):(27===t.which&&d.default(e.querySelector(_t)).trigger("focus"),d.default(this).trigger("click")))},s(u,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return vt}},{key:"DefaultType",get:function(){return yt}}]),u}(),S=(d.default(document).on(n,_t,C._dataApiKeydownHandler).on(n,pt,C._dataApiKeydownHandler).on(e+" keyup.bs.dropdown.data-api",C._clearMenus).on(e,_t,function(t){t.preventDefault(),t.stopPropagation(),C._jQueryInterface.call(d.default(this),"toggle")}).on(e,".dropdown form",function(t){t.stopPropagation()}),d.default.fn[E]=C._jQueryInterface,d.default.fn[E].Constructor=C,d.default.fn[E].noConflict=function(){return d.default.fn[E]=dt,C._jQueryInterface},"modal"),bt="bs.modal",N="."+bt,Et=d.default.fn[S],Tt="modal-open",D="fade",wt="show",Ct="modal-static",St="hidden"+N,Nt="show"+N,Dt="focusin"+N,At="resize"+N,It="click.dismiss"+N,kt="keydown.dismiss"+N,Ot="mousedown.dismiss"+N,jt=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Pt=".sticky-top",Lt={backdrop:!0,keyboard:!0,focus:!0,show:!0},Rt={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},xt=function(){function o(t,e){this._config=this._getConfig(e),this._element=t,this._dialog=t.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var t=o.prototype;return t.toggle=function(t){return this._isShown?this.hide():this.show(t)},t.show=function(t){var e,n=this;this._isShown||this._isTransitioning||(e=d.default.Event(Nt,{relatedTarget:t}),d.default(this._element).trigger(e),e.isDefaultPrevented())||(this._isShown=!0,d.default(this._element).hasClass(D)&&(this._isTransitioning=!0),this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),d.default(this._element).on(It,'[data-dismiss="modal"]',function(t){return n.hide(t)}),d.default(this._dialog).on(Ot,function(){d.default(n._element).one("mouseup.dismiss.bs.modal",function(t){d.default(t.target).is(n._element)&&(n._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return n._showElement(t)}))},t.hide=function(t){var e=this;t&&t.preventDefault(),this._isShown&&!this._isTransitioning&&(t=d.default.Event("hide.bs.modal"),d.default(this._element).trigger(t),this._isShown)&&!t.isDefaultPrevented()&&(this._isShown=!1,(t=d.default(this._element).hasClass(D))&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),d.default(document).off(Dt),d.default(this._element).removeClass(wt),d.default(this._element).off(It),d.default(this._dialog).off(Ot),t?(t=c.getTransitionDurationFromElement(this._element),d.default(this._element).one(c.TRANSITION_END,function(t){return e._hideModal(t)}).emulateTransitionEnd(t)):this._hideModal())},t.dispose=function(){[window,this._element,this._dialog].forEach(function(t){return d.default(t).off(N)}),d.default(document).off(Dt),d.default.removeData(this._element,bt),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},t.handleUpdate=function(){this._adjustDialog()},t._getConfig=function(t){return t=l({},Lt,t),c.typeCheckConfig(S,t,Rt),t},t._triggerBackdropTransition=function(){var t,e,n=this,i=d.default.Event("hidePrevented.bs.modal");d.default(this._element).trigger(i),i.isDefaultPrevented()||((t=this._element.scrollHeight>document.documentElement.clientHeight)||(this._element.style.overflowY="hidden"),this._element.classList.add(Ct),e=c.getTransitionDurationFromElement(this._dialog),d.default(this._element).off(c.TRANSITION_END),d.default(this._element).one(c.TRANSITION_END,function(){n._element.classList.remove(Ct),t||d.default(n._element).one(c.TRANSITION_END,function(){n._element.style.overflowY=""}).emulateTransitionEnd(n._element,e)}).emulateTransitionEnd(e),this._element.focus())},t._showElement=function(t){function e(){n._config.focus&&n._element.focus(),n._isTransitioning=!1,d.default(n._element).trigger(a)}var n=this,i=d.default(this._element).hasClass(D),o=this._dialog?this._dialog.querySelector(".modal-body"):null,a=(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),d.default(this._dialog).hasClass("modal-dialog-scrollable")&&o?o.scrollTop=0:this._element.scrollTop=0,i&&c.reflow(this._element),d.default(this._element).addClass(wt),this._config.focus&&this._enforceFocus(),d.default.Event("shown.bs.modal",{relatedTarget:t}));i?(o=c.getTransitionDurationFromElement(this._dialog),d.default(this._dialog).one(c.TRANSITION_END,e).emulateTransitionEnd(o)):e()},t._enforceFocus=function(){var e=this;d.default(document).off(Dt).on(Dt,function(t){document!==t.target&&e._element!==t.target&&0===d.default(e._element).has(t.target).length&&e._element.focus()})},t._setEscapeEvent=function(){var e=this;this._isShown?d.default(this._element).on(kt,function(t){e._config.keyboard&&27===t.which?(t.preventDefault(),e.hide()):e._config.keyboard||27!==t.which||e._triggerBackdropTransition()}):this._isShown||d.default(this._element).off(kt)},t._setResizeEvent=function(){var e=this;this._isShown?d.default(window).on(At,function(t){return e.handleUpdate(t)}):d.default(window).off(At)},t._hideModal=function(){var t=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop(function(){d.default(document.body).removeClass(Tt),t._resetAdjustments(),t._resetScrollbar(),d.default(t._element).trigger(St)})},t._removeBackdrop=function(){this._backdrop&&(d.default(this._backdrop).remove(),this._backdrop=null)},t._showBackdrop=function(t){var e,n=this,i=d.default(this._element).hasClass(D)?D:"";this._isShown&&this._config.backdrop?(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",i&&this._backdrop.classList.add(i),d.default(this._backdrop).appendTo(document.body),d.default(this._element).on(It,function(t){n._ignoreBackdropClick?n._ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"===n._config.backdrop?n._triggerBackdropTransition():n.hide())}),i&&c.reflow(this._backdrop),d.default(this._backdrop).addClass(wt),t&&(i?(i=c.getTransitionDurationFromElement(this._backdrop),d.default(this._backdrop).one(c.TRANSITION_END,t).emulateTransitionEnd(i)):t())):!this._isShown&&this._backdrop?(d.default(this._backdrop).removeClass(wt),i=function(){n._removeBackdrop(),t&&t()},d.default(this._element).hasClass(D)?(e=c.getTransitionDurationFromElement(this._backdrop),d.default(this._backdrop).one(c.TRANSITION_END,i).emulateTransitionEnd(e)):i()):t&&t()},t._adjustDialog=function(){var t=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&t&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!t&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},t._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},t._checkScrollbar=function(){var t=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(t.left+t.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},t._setScrollbar=function(){var t,e,o=this;this._isBodyOverflowing&&(t=[].slice.call(document.querySelectorAll(jt)),e=[].slice.call(document.querySelectorAll(Pt)),d.default(t).each(function(t,e){var n=e.style.paddingRight,i=d.default(e).css("padding-right");d.default(e).data("padding-right",n).css("padding-right",parseFloat(i)+o._scrollbarWidth+"px")}),d.default(e).each(function(t,e){var n=e.style.marginRight,i=d.default(e).css("margin-right");d.default(e).data("margin-right",n).css("margin-right",parseFloat(i)-o._scrollbarWidth+"px")}),t=document.body.style.paddingRight,e=d.default(document.body).css("padding-right"),d.default(document.body).data("padding-right",t).css("padding-right",parseFloat(e)+this._scrollbarWidth+"px")),d.default(document.body).addClass(Tt)},t._resetScrollbar=function(){var t=[].slice.call(document.querySelectorAll(jt)),t=(d.default(t).each(function(t,e){var n=d.default(e).data("padding-right");d.default(e).removeData("padding-right"),e.style.paddingRight=n||""}),[].slice.call(document.querySelectorAll(Pt))),t=(d.default(t).each(function(t,e){var n=d.default(e).data("margin-right");void 0!==n&&d.default(e).css("margin-right",n).removeData("margin-right")}),d.default(document.body).data("padding-right"));d.default(document.body).removeData("padding-right"),document.body.style.paddingRight=t||""},t._getScrollbarWidth=function(){var t=document.createElement("div"),e=(t.className="modal-scrollbar-measure",document.body.appendChild(t),t.getBoundingClientRect().width-t.clientWidth);return document.body.removeChild(t),e},o._jQueryInterface=function(n,i){return this.each(function(){var t=d.default(this).data(bt),e=l({},Lt,d.default(this).data(),"object"==typeof n&&n?n:{});if(t||(t=new o(this,e),d.default(this).data(bt,t)),"string"==typeof n){if(void 0===t[n])throw new TypeError('No method named "'+n+'"');t[n](i)}else e.show&&t.show(i)})},s(o,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return Lt}}]),o}(),qt=(d.default(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var e,n=this,i=c.getSelectorFromElement(this),i=(i&&(e=document.querySelector(i)),d.default(e).data(bt)?"toggle":l({},d.default(e).data(),d.default(this).data())),o=("A"!==this.tagName&&"AREA"!==this.tagName||t.preventDefault(),d.default(e).one(Nt,function(t){t.isDefaultPrevented()||o.one(St,function(){d.default(n).is(":visible")&&n.focus()})}));xt._jQueryInterface.call(d.default(e),i,this)}),d.default.fn[S]=xt._jQueryInterface,d.default.fn[S].Constructor=xt,d.default.fn[S].noConflict=function(){return d.default.fn[S]=Et,xt._jQueryInterface},["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),n={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Ft=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,Qt=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function Bt(t,a,e){if(0===t.length)return t;if(e&&"function"==typeof e)return e(t);for(var e=(new window.DOMParser).parseFromString(t,"text/html"),s=Object.keys(a),l=[].slice.call(e.body.querySelectorAll("*")),n=function(t,e){var n=l[t],t=n.nodeName.toLowerCase();if(-1===s.indexOf(n.nodeName.toLowerCase()))return n.parentNode.removeChild(n),"continue";var i=[].slice.call(n.attributes),o=[].concat(a["*"]||[],a[t]||[]);i.forEach(function(t){!function(t,e){var n=t.nodeName.toLowerCase();if(-1!==e.indexOf(n))return-1===qt.indexOf(n)||Boolean(Ft.test(t.nodeValue)||Qt.test(t.nodeValue));for(var i=e.filter(function(t){return t instanceof RegExp}),o=0,a=i.length;o<a;o++)if(i[o].test(n))return 1}(t,o)&&n.removeAttribute(t.nodeName)})},i=0,o=l.length;i<o;i++)n(i);return e.body.innerHTML}var A="tooltip",Ht="bs.tooltip",I="."+Ht,Ut=d.default.fn[A],Mt="bs-tooltip",Wt=new RegExp("(^|\\s)"+Mt+"\\S+","g"),Vt=["sanitize","whiteList","sanitizeFn"],zt="fade",Kt="show",Xt="show",Yt="hover",$t="focus",Jt={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},Gt={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",customClass:"",sanitize:!0,sanitizeFn:null,whiteList:n,popperConfig:null},Zt={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},te={HIDE:"hide"+I,HIDDEN:"hidden"+I,SHOW:"show"+I,SHOWN:"shown"+I,INSERTED:"inserted"+I,CLICK:"click"+I,FOCUSIN:"focusin"+I,FOCUSOUT:"focusout"+I,MOUSEENTER:"mouseenter"+I,MOUSELEAVE:"mouseleave"+I},k=function(){function o(t,e){if(void 0===q.default)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=t,this.config=this._getConfig(e),this.tip=null,this._setListeners()}var t=o.prototype;return t.enable=function(){this._isEnabled=!0},t.disable=function(){this._isEnabled=!1},t.toggleEnabled=function(){this._isEnabled=!this._isEnabled},t.toggle=function(t){var e,n;this._isEnabled&&(t?(e=this.constructor.DATA_KEY,(n=d.default(t.currentTarget).data(e))||(n=new this.constructor(t.currentTarget,this._getDelegateConfig()),d.default(t.currentTarget).data(e,n)),n._activeTrigger.click=!n._activeTrigger.click,n._isWithActiveTrigger()?n._enter(null,n):n._leave(null,n)):d.default(this.getTipElement()).hasClass(Kt)?this._leave(null,this):this._enter(null,this))},t.dispose=function(){clearTimeout(this._timeout),d.default.removeData(this.element,this.constructor.DATA_KEY),d.default(this.element).off(this.constructor.EVENT_KEY),d.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&d.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},t.show=function(){var e=this;if("none"===d.default(this.element).css("display"))throw new Error("Please use show on visible elements");var t,n,i=d.default.Event(this.constructor.Event.SHOW);this.isWithContent()&&this._isEnabled&&(d.default(this.element).trigger(i),n=c.findShadowRoot(this.element),n=d.default.contains(null!==n?n:this.element.ownerDocument.documentElement,this.element),!i.isDefaultPrevented())&&n&&(i=this.getTipElement(),n=c.getUID(this.constructor.NAME),i.setAttribute("id",n),this.element.setAttribute("aria-describedby",n),this.setContent(),this.config.animation&&d.default(i).addClass(zt),n="function"==typeof this.config.placement?this.config.placement.call(this,i,this.element):this.config.placement,n=this._getAttachment(n),this.addAttachmentClass(n),t=this._getContainer(),d.default(i).data(this.constructor.DATA_KEY,this),d.default.contains(this.element.ownerDocument.documentElement,this.tip)||d.default(i).appendTo(t),d.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new q.default(this.element,i,this._getPopperConfig(n)),d.default(i).addClass(Kt),d.default(i).addClass(this.config.customClass),"ontouchstart"in document.documentElement&&d.default(document.body).children().on("mouseover",null,d.default.noop),t=function(){e.config.animation&&e._fixTransition();var t=e._hoverState;e._hoverState=null,d.default(e.element).trigger(e.constructor.Event.SHOWN),"out"===t&&e._leave(null,e)},d.default(this.tip).hasClass(zt)?(n=c.getTransitionDurationFromElement(this.tip),d.default(this.tip).one(c.TRANSITION_END,t).emulateTransitionEnd(n)):t())},t.hide=function(t){function e(){n._hoverState!==Xt&&i.parentNode&&i.parentNode.removeChild(i),n._cleanTipClass(),n.element.removeAttribute("aria-describedby"),d.default(n.element).trigger(n.constructor.Event.HIDDEN),null!==n._popper&&n._popper.destroy(),t&&t()}var n=this,i=this.getTipElement(),o=d.default.Event(this.constructor.Event.HIDE);d.default(this.element).trigger(o),o.isDefaultPrevented()||(d.default(i).removeClass(Kt),"ontouchstart"in document.documentElement&&d.default(document.body).children().off("mouseover",null,d.default.noop),this._activeTrigger.click=!1,this._activeTrigger[$t]=!1,this._activeTrigger[Yt]=!1,d.default(this.tip).hasClass(zt)?(o=c.getTransitionDurationFromElement(i),d.default(i).one(c.TRANSITION_END,e).emulateTransitionEnd(o)):e(),this._hoverState="")},t.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},t.isWithContent=function(){return Boolean(this.getTitle())},t.addAttachmentClass=function(t){d.default(this.getTipElement()).addClass(Mt+"-"+t)},t.getTipElement=function(){return this.tip=this.tip||d.default(this.config.template)[0],this.tip},t.setContent=function(){var t=this.getTipElement();this.setElementContent(d.default(t.querySelectorAll(".tooltip-inner")),this.getTitle()),d.default(t).removeClass(zt+" "+Kt)},t.setElementContent=function(t,e){"object"==typeof e&&(e.nodeType||e.jquery)?this.config.html?d.default(e).parent().is(t)||t.empty().append(e):t.text(d.default(e).text()):this.config.html?(this.config.sanitize&&(e=Bt(e,this.config.whiteList,this.config.sanitizeFn)),t.html(e)):t.text(e)},t.getTitle=function(){return this.element.getAttribute("data-original-title")||("function"==typeof this.config.title?this.config.title.call(this.element):this.config.title)},t._getPopperConfig=function(t){var e=this;return l({},{placement:t,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(t){t.originalPlacement!==t.placement&&e._handlePopperPlacementChange(t)},onUpdate:function(t){return e._handlePopperPlacementChange(t)}},this.config.popperConfig)},t._getOffset=function(){var e=this,t={};return"function"==typeof this.config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e.config.offset(t.offsets,e.element)),t}:t.offset=this.config.offset,t},t._getContainer=function(){return!1===this.config.container?document.body:c.isElement(this.config.container)?d.default(this.config.container):d.default(document).find(this.config.container)},t._getAttachment=function(t){return Jt[t.toUpperCase()]},t._setListeners=function(){var n=this;this.config.trigger.split(" ").forEach(function(t){var e;"click"===t?d.default(n.element).on(n.constructor.Event.CLICK,n.config.selector,function(t){return n.toggle(t)}):"manual"!==t&&(e=t===Yt?n.constructor.Event.MOUSEENTER:n.constructor.Event.FOCUSIN,t=t===Yt?n.constructor.Event.MOUSELEAVE:n.constructor.Event.FOCUSOUT,d.default(n.element).on(e,n.config.selector,function(t){return n._enter(t)}).on(t,n.config.selector,function(t){return n._leave(t)}))}),this._hideModalHandler=function(){n.element&&n.hide()},d.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=l({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},t._fixTitle=function(){var t=typeof this.element.getAttribute("data-original-title");!this.element.getAttribute("title")&&"string"==t||(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},t._enter=function(t,e){var n=this.constructor.DATA_KEY;(e=e||d.default(t.currentTarget).data(n))||(e=new this.constructor(t.currentTarget,this._getDelegateConfig()),d.default(t.currentTarget).data(n,e)),t&&(e._activeTrigger["focusin"===t.type?$t:Yt]=!0),d.default(e.getTipElement()).hasClass(Kt)||e._hoverState===Xt?e._hoverState=Xt:(clearTimeout(e._timeout),e._hoverState=Xt,e.config.delay&&e.config.delay.show?e._timeout=setTimeout(function(){e._hoverState===Xt&&e.show()},e.config.delay.show):e.show())},t._leave=function(t,e){var n=this.constructor.DATA_KEY;(e=e||d.default(t.currentTarget).data(n))||(e=new this.constructor(t.currentTarget,this._getDelegateConfig()),d.default(t.currentTarget).data(n,e)),t&&(e._activeTrigger["focusout"===t.type?$t:Yt]=!1),e._isWithActiveTrigger()||(clearTimeout(e._timeout),e._hoverState="out",e.config.delay&&e.config.delay.hide?e._timeout=setTimeout(function(){"out"===e._hoverState&&e.hide()},e.config.delay.hide):e.hide())},t._isWithActiveTrigger=function(){for(var t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1},t._getConfig=function(t){var e=d.default(this.element).data();return Object.keys(e).forEach(function(t){-1!==Vt.indexOf(t)&&delete e[t]}),"number"==typeof(t=l({},this.constructor.Default,e,"object"==typeof t&&t?t:{})).delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),c.typeCheckConfig(A,t,this.constructor.DefaultType),t.sanitize&&(t.template=Bt(t.template,t.whiteList,t.sanitizeFn)),t},t._getDelegateConfig=function(){var t={};if(this.config)for(var e in this.config)this.constructor.Default[e]!==this.config[e]&&(t[e]=this.config[e]);return t},t._cleanTipClass=function(){var t=d.default(this.getTipElement()),e=t.attr("class").match(Wt);null!==e&&e.length&&t.removeClass(e.join(""))},t._handlePopperPlacementChange=function(t){this.tip=t.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(t.placement))},t._fixTransition=function(){var t=this.getTipElement(),e=this.config.animation;null===t.getAttribute("x-placement")&&(d.default(t).removeClass(zt),this.config.animation=!1,this.hide(),this.show(),this.config.animation=e)},o._jQueryInterface=function(i){return this.each(function(){var t=d.default(this),e=t.data(Ht),n="object"==typeof i&&i;if((e||!/dispose|hide/.test(i))&&(e||(e=new o(this,n),t.data(Ht,e)),"string"==typeof i)){if(void 0===e[i])throw new TypeError('No method named "'+i+'"');e[i]()}})},s(o,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return Gt}},{key:"NAME",get:function(){return A}},{key:"DATA_KEY",get:function(){return Ht}},{key:"Event",get:function(){return te}},{key:"EVENT_KEY",get:function(){return I}},{key:"DefaultType",get:function(){return Zt}}]),o}(),O=(d.default.fn[A]=k._jQueryInterface,d.default.fn[A].Constructor=k,d.default.fn[A].noConflict=function(){return d.default.fn[A]=Ut,k._jQueryInterface},"popover"),ee="bs.popover",j="."+ee,ne=d.default.fn[O],ie="bs-popover",oe=new RegExp("(^|\\s)"+ie+"\\S+","g"),ae=l({},k.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),se=l({},k.DefaultType,{content:"(string|element|function)"}),le={HIDE:"hide"+j,HIDDEN:"hidden"+j,SHOW:"show"+j,SHOWN:"shown"+j,INSERTED:"inserted"+j,CLICK:"click"+j,FOCUSIN:"focusin"+j,FOCUSOUT:"focusout"+j,MOUSEENTER:"mouseenter"+j,MOUSELEAVE:"mouseleave"+j},re=function(t){var e;function i(){return t.apply(this,arguments)||this}e=t,(n=i).prototype=Object.create(e.prototype),Q(n.prototype.constructor=n,e);var n=i.prototype;return n.isWithContent=function(){return this.getTitle()||this._getContent()},n.addAttachmentClass=function(t){d.default(this.getTipElement()).addClass(ie+"-"+t)},n.getTipElement=function(){return this.tip=this.tip||d.default(this.config.template)[0],this.tip},n.setContent=function(){var t=d.default(this.getTipElement()),e=(this.setElementContent(t.find(".popover-header"),this.getTitle()),this._getContent());"function"==typeof e&&(e=e.call(this.element)),this.setElementContent(t.find(".popover-body"),e),t.removeClass("fade show")},n._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},n._cleanTipClass=function(){var t=d.default(this.getTipElement()),e=t.attr("class").match(oe);null!==e&&0<e.length&&t.removeClass(e.join(""))},i._jQueryInterface=function(n){return this.each(function(){var t=d.default(this).data(ee),e="object"==typeof n?n:null;if((t||!/dispose|hide/.test(n))&&(t||(t=new i(this,e),d.default(this).data(ee,t)),"string"==typeof n)){if(void 0===t[n])throw new TypeError('No method named "'+n+'"');t[n]()}})},s(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return ae}},{key:"NAME",get:function(){return O}},{key:"DATA_KEY",get:function(){return ee}},{key:"Event",get:function(){return le}},{key:"EVENT_KEY",get:function(){return j}},{key:"DefaultType",get:function(){return se}}]),i}(k),P=(d.default.fn[O]=re._jQueryInterface,d.default.fn[O].Constructor=re,d.default.fn[O].noConflict=function(){return d.default.fn[O]=ne,re._jQueryInterface},"scrollspy"),ue="bs.scrollspy",de="."+ue,ce=d.default.fn[P],L="active",fe="position",he=".nav, .list-group",ge=".nav-link",me=".list-group-item",_e={offset:10,method:"auto",target:""},pe={offset:"number",method:"string",target:"(string|element)"},ve=function(){function n(t,e){var n=this;this._element=t,this._scrollElement="BODY"===t.tagName?window:t,this._config=this._getConfig(e),this._selector=this._config.target+" "+ge+","+this._config.target+" "+me+","+this._config.target+" .dropdown-item",this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,d.default(this._scrollElement).on("scroll.bs.scrollspy",function(t){return n._process(t)}),this.refresh(),this._process()}var t=n.prototype;return t.refresh=function(){var e=this,t=this._scrollElement===this._scrollElement.window?"offset":fe,i="auto"===this._config.method?t:this._config.method,o=i===fe?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(t){var e,t=c.getSelectorFromElement(t);if(e=t?document.querySelector(t):e){var n=e.getBoundingClientRect();if(n.width||n.height)return[d.default(e)[i]().top+o,t]}return null}).filter(Boolean).sort(function(t,e){return t[0]-e[0]}).forEach(function(t){e._offsets.push(t[0]),e._targets.push(t[1])})},t.dispose=function(){d.default.removeData(this._element,ue),d.default(this._scrollElement).off(de),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},t._getConfig=function(t){var e;return"string"!=typeof(t=l({},_e,"object"==typeof t&&t?t:{})).target&&c.isElement(t.target)&&((e=d.default(t.target).attr("id"))||(e=c.getUID(P),d.default(t.target).attr("id",e)),t.target="#"+e),c.typeCheckConfig(P,t,pe),t},t._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},t._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},t._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},t._process=function(){var t=this._getScrollTop()+this._config.offset,e=this._getScrollHeight(),n=this._config.offset+e-this._getOffsetHeight();if(this._scrollHeight!==e&&this.refresh(),n<=t)e=this._targets[this._targets.length-1],this._activeTarget!==e&&this._activate(e);else if(this._activeTarget&&t<this._offsets[0]&&0<this._offsets[0])this._activeTarget=null,this._clear();else for(var i=this._offsets.length;i--;)this._activeTarget!==this._targets[i]&&t>=this._offsets[i]&&(void 0===this._offsets[i+1]||t<this._offsets[i+1])&&this._activate(this._targets[i])},t._activate=function(e){this._activeTarget=e,this._clear();var t=this._selector.split(",").map(function(t){return t+'[data-target="'+e+'"],'+t+'[href="'+e+'"]'}),t=d.default([].slice.call(document.querySelectorAll(t.join(","))));(t.hasClass("dropdown-item")?(t.closest(".dropdown").find(".dropdown-toggle").addClass(L),t):(t.addClass(L),t.parents(he).prev(ge+", "+me).addClass(L),t.parents(he).prev(".nav-item").children(ge))).addClass(L),d.default(this._scrollElement).trigger("activate.bs.scrollspy",{relatedTarget:e})},t._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(t){return t.classList.contains(L)}).forEach(function(t){return t.classList.remove(L)})},n._jQueryInterface=function(e){return this.each(function(){var t=d.default(this).data(ue);if(t||(t=new n(this,"object"==typeof e&&e),d.default(this).data(ue,t)),"string"==typeof e){if(void 0===t[e])throw new TypeError('No method named "'+e+'"');t[e]()}})},s(n,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return _e}}]),n}(),ye=(d.default(window).on("load.bs.scrollspy.data-api",function(){for(var t=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),e=t.length;e--;){var n=d.default(t[e]);ve._jQueryInterface.call(n,n.data())}}),d.default.fn[P]=ve._jQueryInterface,d.default.fn[P].Constructor=ve,d.default.fn[P].noConflict=function(){return d.default.fn[P]=ce,ve._jQueryInterface},"bs.tab"),be=d.default.fn.tab,Ee="active",Te=".active",we="> li > .active",Ce=function(){function i(t){this._element=t}var t=i.prototype;return t.show=function(){var t,e,n,i,o,a,s=this;this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&d.default(this._element).hasClass(Ee)||d.default(this._element).hasClass("disabled")||this._element.hasAttribute("disabled")||(e=d.default(this._element).closest(".nav, .list-group")[0],n=c.getSelectorFromElement(this._element),e&&(o="UL"===e.nodeName||"OL"===e.nodeName?we:Te,i=(i=d.default.makeArray(d.default(e).find(o)))[i.length-1]),o=d.default.Event("hide.bs.tab",{relatedTarget:this._element}),a=d.default.Event("show.bs.tab",{relatedTarget:i}),i&&d.default(i).trigger(o),d.default(this._element).trigger(a),a.isDefaultPrevented())||o.isDefaultPrevented()||(n&&(t=document.querySelector(n)),this._activate(this._element,e),a=function(){var t=d.default.Event("hidden.bs.tab",{relatedTarget:s._element}),e=d.default.Event("shown.bs.tab",{relatedTarget:i});d.default(i).trigger(t),d.default(s._element).trigger(e)},t?this._activate(t,t.parentNode,a):a())},t.dispose=function(){d.default.removeData(this._element,ye),this._element=null},t._activate=function(t,e,n){function i(){return o._transitionComplete(t,a,n)}var o=this,a=(!e||"UL"!==e.nodeName&&"OL"!==e.nodeName?d.default(e).children(Te):d.default(e).find(we))[0],e=n&&a&&d.default(a).hasClass("fade");a&&e?(e=c.getTransitionDurationFromElement(a),d.default(a).removeClass("show").one(c.TRANSITION_END,i).emulateTransitionEnd(e)):i()},t._transitionComplete=function(t,e,n){e&&(d.default(e).removeClass(Ee),(i=d.default(e.parentNode).find("> .dropdown-menu .active")[0])&&d.default(i).removeClass(Ee),"tab"===e.getAttribute("role"))&&e.setAttribute("aria-selected",!1),d.default(t).addClass(Ee),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!0),c.reflow(t),t.classList.contains("fade")&&t.classList.add("show");var i=t.parentNode;(i=i&&"LI"===i.nodeName?i.parentNode:i)&&d.default(i).hasClass("dropdown-menu")&&((e=d.default(t).closest(".dropdown")[0])&&(i=[].slice.call(e.querySelectorAll(".dropdown-toggle")),d.default(i).addClass(Ee)),t.setAttribute("aria-expanded",!0)),n&&n()},i._jQueryInterface=function(n){return this.each(function(){var t=d.default(this),e=t.data(ye);if(e||(e=new i(this),t.data(ye,e)),"string"==typeof n){if(void 0===e[n])throw new TypeError('No method named "'+n+'"');e[n]()}})},s(i,null,[{key:"VERSION",get:function(){return"4.6.2"}}]),i}(),R=(d.default(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',function(t){t.preventDefault(),Ce._jQueryInterface.call(d.default(this),"show")}),d.default.fn.tab=Ce._jQueryInterface,d.default.fn.tab.Constructor=Ce,d.default.fn.tab.noConflict=function(){return d.default.fn.tab=be,Ce._jQueryInterface},"toast"),Se="bs.toast",e="."+Se,Ne=d.default.fn[R],De="show",Ae="showing",Ie="click.dismiss"+e,ke={animation:!0,autohide:!0,delay:500},Oe={animation:"boolean",autohide:"boolean",delay:"number"},je=function(){function i(t,e){this._element=t,this._config=this._getConfig(e),this._timeout=null,this._setListeners()}var t=i.prototype;return t.show=function(){var t,e=this,n=d.default.Event("show.bs.toast");d.default(this._element).trigger(n),n.isDefaultPrevented()||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),n=function(){e._element.classList.remove(Ae),e._element.classList.add(De),d.default(e._element).trigger("shown.bs.toast"),e._config.autohide&&(e._timeout=setTimeout(function(){e.hide()},e._config.delay))},this._element.classList.remove("hide"),c.reflow(this._element),this._element.classList.add(Ae),this._config.animation?(t=c.getTransitionDurationFromElement(this._element),d.default(this._element).one(c.TRANSITION_END,n).emulateTransitionEnd(t)):n())},t.hide=function(){var t;this._element.classList.contains(De)&&(t=d.default.Event("hide.bs.toast"),d.default(this._element).trigger(t),t.isDefaultPrevented()||this._close())},t.dispose=function(){this._clearTimeout(),this._element.classList.contains(De)&&this._element.classList.remove(De),d.default(this._element).off(Ie),d.default.removeData(this._element,Se),this._element=null,this._config=null},t._getConfig=function(t){return t=l({},ke,d.default(this._element).data(),"object"==typeof t&&t?t:{}),c.typeCheckConfig(R,t,this.constructor.DefaultType),t},t._setListeners=function(){var t=this;d.default(this._element).on(Ie,'[data-dismiss="toast"]',function(){return t.hide()})},t._close=function(){function t(){n._element.classList.add("hide"),d.default(n._element).trigger("hidden.bs.toast")}var e,n=this;this._element.classList.remove(De),this._config.animation?(e=c.getTransitionDurationFromElement(this._element),d.default(this._element).one(c.TRANSITION_END,t).emulateTransitionEnd(e)):t()},t._clearTimeout=function(){clearTimeout(this._timeout),this._timeout=null},i._jQueryInterface=function(n){return this.each(function(){var t=d.default(this),e=t.data(Se);if(e||(e=new i(this,"object"==typeof n&&n),t.data(Se,e)),"string"==typeof n){if(void 0===e[n])throw new TypeError('No method named "'+n+'"');e[n](this)}})},s(i,null,[{key:"VERSION",get:function(){return"4.6.2"}},{key:"DefaultType",get:function(){return Oe}},{key:"Default",get:function(){return ke}}]),i}();d.default.fn[R]=je._jQueryInterface,d.default.fn[R].Constructor=je,d.default.fn[R].noConflict=function(){return d.default.fn[R]=Ne,je._jQueryInterface},t.Alert=o,t.Button=u,t.Carousel=m,t.Collapse=b,t.Dropdown=C,t.Modal=xt,t.Popover=re,t.Scrollspy=ve,t.Tab=Ce,t.Toast=je,t.Tooltip=k,t.Util=c,Object.defineProperty(t,"__esModule",{value:!0})});
!function(I){"use strict";var P=["sanitize","whiteList","sanitizeFn"],W=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],B={"*":["class","dir","id","lang","role","tabindex","style",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},R=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,M=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function C(e,t,i){if(i&&"function"==typeof i)return i(e);for(var s=Object.keys(t),n=0,o=e.length;n<o;n++)for(var l=e[n].querySelectorAll("*"),r=0,a=l.length;r<a;r++){var c=l[r],d=c.nodeName.toLowerCase();if(-1===s.indexOf(d))c.parentNode.removeChild(c);else for(var h=[].slice.call(c.attributes),p=[].concat(t["*"]||[],t[d]||[]),u=0,f=h.length;u<f;u++){var m=h[u];!function(e,t){var i=e.nodeName.toLowerCase();if(-1!==I.inArray(i,t))return-1===I.inArray(i,W)||Boolean(e.nodeValue.match(R)||e.nodeValue.match(M));for(var s=I(t).filter(function(e,t){return t instanceof RegExp}),n=0,o=s.length;n<o;n++)if(i.match(s[n]))return 1}(m,p)&&c.removeAttribute(m.nodeName)}}}if(!("classList"in document.createElement("_"))&&"Element"in(i=window)){var t="classList",e="prototype",i=i.Element[e],s=Object,n=function(){var i=I(this);return{add:function(e){return e=Array.prototype.slice.call(arguments).join(" "),i.addClass(e)},remove:function(e){return e=Array.prototype.slice.call(arguments).join(" "),i.removeClass(e)},toggle:function(e,t){return i.toggleClass(e,t)},contains:function(e){return i.hasClass(e)}}};if(s.defineProperty){var o={get:n,enumerable:!0,configurable:!0};try{s.defineProperty(i,t,o)}catch(e){void 0!==e.number&&-2146823252!==e.number||(o.enumerable=!1,s.defineProperty(i,t,o))}}else s[e].__defineGetter__&&i.__defineGetter__(t,n)}var l,r,a,c,o=document.createElement("_");function d(e){if(null==this)throw new TypeError;var t=String(this);if(e&&"[object RegExp]"==c.call(e))throw new TypeError;var i=t.length,s=String(e),n=s.length,e=1<arguments.length?arguments[1]:void 0,e=e?Number(e):0,o=(e!=e&&(e=0),Math.min(Math.max(e,0),i));if(i<n+o)return!1;for(var l=-1;++l<n;)if(t.charCodeAt(o+l)!=s.charCodeAt(l))return!1;return!0}function x(e,t){var i,s=e.selectedOptions,n=[];if(t){for(var o=0,l=s.length;o<l;o++)(i=s[o]).disabled||"OPTGROUP"===i.parentNode.tagName&&i.parentNode.disabled||n.push(i);return n}return s}function k(e,t){for(var i,s=[],n=t||e.selectedOptions,o=0,l=n.length;o<l;o++)(i=n[o]).disabled||"OPTGROUP"===i.parentNode.tagName&&i.parentNode.disabled||s.push(i.value);return e.multiple?s:s.length?s[0]:null}o.classList.add("c1","c2"),o.classList.contains("c2")||(l=DOMTokenList.prototype.add,r=DOMTokenList.prototype.remove,DOMTokenList.prototype.add=function(){Array.prototype.forEach.call(arguments,l.bind(this))},DOMTokenList.prototype.remove=function(){Array.prototype.forEach.call(arguments,r.bind(this))}),o.classList.toggle("c3",!1),o.classList.contains("c3")&&(a=DOMTokenList.prototype.toggle,DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:a.call(this,e)}),o=null,String.prototype.startsWith||(s=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(e){}return i}(),c={}.toString,s?s(String.prototype,"startsWith",{value:d,configurable:!0,writable:!0}):String.prototype.startsWith=d),Object.keys||(Object.keys=function(e,t,i){for(t in i=[],e)i.hasOwnProperty.call(e,t)&&i.push(t);return i}),HTMLSelectElement&&!HTMLSelectElement.prototype.hasOwnProperty("selectedOptions")&&Object.defineProperty(HTMLSelectElement.prototype,"selectedOptions",{get:function(){return this.querySelectorAll(":checked")}});var h={useDefault:!1,_set:I.valHooks.select.set},y=(I.valHooks.select.set=function(e,t){return t&&!h.useDefault&&I(e).data("selected",!0),h._set.apply(this,arguments)},null),U=function(){try{return new Event("change"),!0}catch(e){return!1}}();function b(e,t,i,s){for(var n=["display","subtext","tokens"],o=!1,l=0;l<n.length;l++){var r=n[l],a=e[r];if(a&&(a=a.toString(),"display"===r&&(a=a.replace(/<[^>]+>/g,"")),a=(a=s?u(a):a).toUpperCase(),o="contains"===i?0<=a.indexOf(t):a.startsWith(t)))break}return o}function g(e){return parseInt(e,10)||0}I.fn.triggerNative=function(e){var t,i=this[0];i.dispatchEvent?(U?t=new Event(e,{bubbles:!0}):(t=document.createEvent("Event")).initEvent(e,!0,!1),i.dispatchEvent(t)):i.fireEvent?((t=document.createEventObject()).eventType=e,i.fireEvent("on"+e,t)):this.trigger(e)};var V={"Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã":"C","Ã§":"c","Ã":"D","Ã°":"d","Ã":"E","Ã":"E","Ã":"E","Ã":"E","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã":"I","Ã":"I","Ã":"I","Ã":"I","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã":"N","Ã±":"n","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã":"U","Ã":"U","Ã":"U","Ã":"U","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã":"Y","Ã½":"y","Ã¿":"y","Ã":"Ae","Ã¦":"ae","Ã":"Th","Ã¾":"th","Ã":"ss","Ä":"A","Ä":"A","Ä":"A","Ä":"a","Ä":"a","Ä":"a","Ä":"C","Ä":"C","Ä":"C","Ä":"C","Ä":"c","Ä":"c","Ä":"c","Ä":"c","Ä":"D","Ä":"D","Ä":"d","Ä":"d","Ä":"E","Ä":"E","Ä":"E","Ä":"E","Ä":"E","Ä":"e","Ä":"e","Ä":"e","Ä":"e","Ä":"e","Ä":"G","Ä":"G","Ä ":"G","Ä¢":"G","Ä":"g","Ä":"g","Ä¡":"g","Ä£":"g","Ä¤":"H","Ä¦":"H","Ä¥":"h","Ä§":"h","Ä¨":"I","Äª":"I","Ä¬":"I","Ä®":"I","Ä°":"I","Ä©":"i","Ä«":"i","Ä­":"i","Ä¯":"i","Ä±":"i","Ä´":"J","Äµ":"j","Ä¶":"K","Ä·":"k","Ä¸":"k","Ä¹":"L","Ä»":"L","Ä½":"L","Ä¿":"L","Å":"L","Äº":"l","Ä¼":"l","Ä¾":"l","Å":"l","Å":"l","Å":"N","Å":"N","Å":"N","Å":"N","Å":"n","Å":"n","Å":"n","Å":"n","Å":"O","Å":"O","Å":"O","Å":"o","Å":"o","Å":"o","Å":"R","Å":"R","Å":"R","Å":"r","Å":"r","Å":"r","Å":"S","Å":"S","Å":"S","Å ":"S","Å":"s","Å":"s","Å":"s","Å¡":"s","Å¢":"T","Å¤":"T","Å¦":"T","Å£":"t","Å¥":"t","Å§":"t","Å¨":"U","Åª":"U","Å¬":"U","Å®":"U","Å°":"U","Å²":"U","Å©":"u","Å«":"u","Å­":"u","Å¯":"u","Å±":"u","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Å»":"Z","Å½":"Z","Åº":"z","Å¼":"z","Å¾":"z","Ä²":"IJ","Ä³":"ij","Å":"Oe","Å":"oe","Å":"'n","Å¿":"s"},j=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,F=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\u1ab0-\\u1aff\\u1dc0-\\u1dff]","g");function _(e){return V[e]}function u(e){return(e=e.toString())&&e.replace(j,_).replace(F,"")}p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},e="(?:"+Object.keys(p).join("|")+")",f=RegExp(e),m=RegExp(e,"g");var p,f,m,$=function(e){return f.test(e=null==e?"":""+e)?e.replace(m,G):e};function G(e){return p[e]}var K={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},w=27,q=13,S=32,E=9,O=38,z=40,T={success:!1,major:"3"};try{T.full=(I.fn.dropdown.Constructor.VERSION||"").split(" ")[0].split("."),T.major=T.full[0],T.success=!0}catch(e){}var v=0,N=".bs.select",A={DISABLED:"disabled",DIVIDER:"divider",SHOW:"open",DROPUP:"dropup",MENU:"dropdown-menu",MENURIGHT:"dropdown-menu-right",MENULEFT:"dropdown-menu-left",BUTTONCLASS:"btn-default",POPOVERHEADER:"popover-title",ICONBASE:"glyphicon",TICKICON:"glyphicon-ok"},Y={MENU:"."+A.MENU},L={div:document.createElement("div"),span:document.createElement("span"),i:document.createElement("i"),subtext:document.createElement("small"),a:document.createElement("a"),li:document.createElement("li"),whitespace:document.createTextNode("Â "),fragment:document.createDocumentFragment()},Z=(L.noResults=L.li.cloneNode(!1),L.noResults.className="no-results",L.a.setAttribute("role","option"),L.a.className="dropdown-item",L.subtext.className="text-muted",L.text=L.span.cloneNode(!1),L.text.className="text",L.checkMark=L.span.cloneNode(!1),new RegExp(O+"|"+z)),J=new RegExp("^"+E+"$|"+w),D={li:function(e,t,i){var s=L.li.cloneNode(!1);return e&&(1===e.nodeType||11===e.nodeType?s.appendChild(e):s.innerHTML=e),void 0!==t&&""!==t&&(s.className=t),null!=i&&s.classList.add("optgroup-"+i),s},a:function(e,t,i){var s=L.a.cloneNode(!0);return e&&(11===e.nodeType?s.appendChild(e):s.insertAdjacentHTML("beforeend",e)),void 0!==t&&""!==t&&s.classList.add.apply(s.classList,t.split(/\s+/)),i&&s.setAttribute("style",i),s},text:function(e,t){var i,s,n=L.text.cloneNode(!1);if(e.content?n.innerHTML=e.content:(n.textContent=e.text,e.icon&&(i=L.whitespace.cloneNode(!1),(s=(!0===t?L.i:L.span).cloneNode(!1)).className=this.options.iconBase+" "+e.icon,L.fragment.appendChild(s),L.fragment.appendChild(i)),e.subtext&&((s=L.subtext.cloneNode(!1)).textContent=e.subtext,n.appendChild(s))),!0===t)for(;0<n.childNodes.length;)L.fragment.appendChild(n.childNodes[0]);else L.fragment.appendChild(n);return L.fragment},label:function(e){var t,i,s=L.text.cloneNode(!1);return s.innerHTML=e.display,e.icon&&(t=L.whitespace.cloneNode(!1),(i=L.span.cloneNode(!1)).className=this.options.iconBase+" "+e.icon,L.fragment.appendChild(i),L.fragment.appendChild(t)),e.subtext&&((i=L.subtext.cloneNode(!1)).textContent=e.subtext,s.appendChild(i)),L.fragment.appendChild(s),L.fragment}};function H(e,t){var i=this;h.useDefault||(I.valHooks.select.set=h._set,h.useDefault=!0),this.$element=I(e),this.$newElement=null,this.$button=null,this.$menu=null,this.options=t,this.selectpicker={main:{},search:{},current:{},view:{},isSearching:!1,keydown:{keyHistory:"",resetKeyHistory:{start:function(){return setTimeout(function(){i.selectpicker.keydown.keyHistory=""},800)}}}},this.sizeInfo={},null===this.options.title&&(this.options.title=this.$element.attr("title")),"number"==typeof(e=this.options.windowPadding)&&(this.options.windowPadding=[e,e,e,e]),this.val=H.prototype.val,this.render=H.prototype.render,this.refresh=H.prototype.refresh,this.setStyle=H.prototype.setStyle,this.selectAll=H.prototype.selectAll,this.deselectAll=H.prototype.deselectAll,this.destroy=H.prototype.destroy,this.remove=H.prototype.remove,this.show=H.prototype.show,this.hide=H.prototype.hide,this.init()}function Q(e){var r,a=arguments,c=e;if([].shift.apply(a),!T.success){try{T.full=(I.fn.dropdown.Constructor.VERSION||"").split(" ")[0].split(".")}catch(e){H.BootstrapVersion?T.full=H.BootstrapVersion.split(" ")[0].split("."):(T.full=[T.major,"0","0"],console.warn("There was an issue retrieving Bootstrap's version. Ensure Bootstrap is being loaded before bootstrap-select and there is no namespace collision. If loading Bootstrap asynchronously, the version may need to be manually specified via $.fn.selectpicker.Constructor.BootstrapVersion.",e))}T.major=T.full[0],T.success=!0}if("4"===T.major){var t=[];H.DEFAULTS.style===A.BUTTONCLASS&&t.push({name:"style",className:"BUTTONCLASS"}),H.DEFAULTS.iconBase===A.ICONBASE&&t.push({name:"iconBase",className:"ICONBASE"}),H.DEFAULTS.tickIcon===A.TICKICON&&t.push({name:"tickIcon",className:"TICKICON"}),A.DIVIDER="dropdown-divider",A.SHOW="show",A.BUTTONCLASS="btn-light",A.POPOVERHEADER="popover-header",A.ICONBASE="",A.TICKICON="bs-ok-default";for(var i=0;i<t.length;i++){e=t[i];H.DEFAULTS[e.name]=A[e.className]}}var s=this.each(function(){var e=I(this);if(e.is("select")){var t=e.data("selectpicker"),i="object"==typeof c&&c;if(t){if(i)for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t.options[s]=i[s])}else{var n,o=e.data();for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&-1!==I.inArray(n,P)&&delete o[n];var l=I.extend({},H.DEFAULTS,I.fn.selectpicker.defaults||{},o,i);l.template=I.extend({},H.DEFAULTS.template,I.fn.selectpicker.defaults?I.fn.selectpicker.defaults.template:{},o.template,i.template),e.data("selectpicker",t=new H(this,l))}"string"==typeof c&&(r=t[c]instanceof Function?t[c].apply(t,a):t.options[c])}});return void 0!==r?r:s}H.VERSION="1.13.18",H.DEFAULTS={noneSelectedText:"Nothing selected",noneResultsText:"No results matched {0}",countSelectedText:function(e,t){return 1==e?"{0} item selected":"{0} items selected"},maxOptionsText:function(e,t){return[1==e?"Limit reached ({n} item max)":"Limit reached ({n} items max)",1==t?"Group limit reached ({n} item max)":"Group limit reached ({n} items max)"]},selectAllText:"Select All",deselectAllText:"Deselect All",doneButton:!1,doneButtonText:"Close",multipleSeparator:", ",styleBase:"btn",style:A.BUTTONCLASS,size:"auto",title:null,selectedTextFormat:"values",width:!1,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0,showContent:!0,dropupAuto:!0,header:!1,liveSearch:!1,liveSearchPlaceholder:null,liveSearchNormalize:!1,liveSearchStyle:"contains",actionsBox:!1,iconBase:A.ICONBASE,tickIcon:A.TICKICON,showTick:!1,template:{caret:'<span class="caret"></span>'},maxOptions:!1,mobile:!1,selectOnTab:!1,dropdownAlignRight:!1,windowPadding:0,virtualScroll:600,display:!1,sanitize:!0,sanitizeFn:null,whiteList:B},H.prototype={constructor:H,init:function(){var i=this,e=this.$element.attr("id"),t=this.$element[0],s=t.form;v++,this.selectId="bs-select-"+v,t.classList.add("bs-select-hidden"),this.multiple=this.$element.prop("multiple"),this.autofocus=this.$element.prop("autofocus"),t.classList.contains("show-tick")&&(this.options.showTick=!0),this.$newElement=this.createDropdown(),this.buildData(),this.$element.after(this.$newElement).prependTo(this.$newElement),s&&null===t.form&&(s.id||(s.id="form-"+this.selectId),t.setAttribute("form",s.id)),this.$button=this.$newElement.children("button"),this.$menu=this.$newElement.children(Y.MENU),this.$menuInner=this.$menu.children(".inner"),this.$searchbox=this.$menu.find("input"),t.classList.remove("bs-select-hidden"),!0===this.options.dropdownAlignRight&&this.$menu[0].classList.add(A.MENURIGHT),void 0!==e&&this.$button.attr("data-id",e),this.checkDisabled(),this.clickListener(),this.options.liveSearch?(this.liveSearchListener(),this.focusedParent=this.$searchbox[0]):this.focusedParent=this.$menuInner[0],this.setStyle(),this.render(),this.setWidth(),this.options.container?this.selectPosition():this.$element.on("hide"+N,function(){var e,t;i.isVirtual()&&(t=(e=i.$menuInner[0]).firstChild.cloneNode(!1),e.replaceChild(t,e.firstChild),e.scrollTop=0)}),this.$menu.data("this",this),this.$newElement.data("this",this),this.options.mobile&&this.mobile(),this.$newElement.on({"hide.bs.dropdown":function(e){i.$element.trigger("hide"+N,e)},"hidden.bs.dropdown":function(e){i.$element.trigger("hidden"+N,e)},"show.bs.dropdown":function(e){i.$element.trigger("show"+N,e)},"shown.bs.dropdown":function(e){i.$element.trigger("shown"+N,e)}}),t.hasAttribute("required")&&this.$element.on("invalid"+N,function(){i.$button[0].classList.add("bs-invalid"),i.$element.on("shown"+N+".invalid",function(){i.$element.val(i.$element.val()).off("shown"+N+".invalid")}).on("rendered"+N,function(){this.validity.valid&&i.$button[0].classList.remove("bs-invalid"),i.$element.off("rendered"+N)}),i.$button.on("blur"+N,function(){i.$element.trigger("focus").trigger("blur"),i.$button.off("blur"+N)})}),setTimeout(function(){i.buildList(),i.$element.trigger("loaded"+N)})},createDropdown:function(){var e=this.multiple||this.options.showTick?" show-tick":"",t=this.multiple?' aria-multiselectable="true"':"",i="",s=this.autofocus?" autofocus":"";T.major<4&&this.$element.parent().hasClass("input-group")&&(i=" input-group-btn");var n="",o="",l="",r="";return this.options.header&&(n='<div class="'+A.POPOVERHEADER+'"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>"),this.options.liveSearch&&(o='<div class="bs-searchbox"><input type="search" class="form-control" autocomplete="off"'+(null===this.options.liveSearchPlaceholder?"":' placeholder="'+$(this.options.liveSearchPlaceholder)+'"')+' role="combobox" aria-label="Search" aria-controls="'+this.selectId+'" aria-autocomplete="list"></div>'),this.multiple&&this.options.actionsBox&&(l='<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn '+A.BUTTONCLASS+'">'+this.options.selectAllText+'</button><button type="button" class="actions-btn bs-deselect-all btn '+A.BUTTONCLASS+'">'+this.options.deselectAllText+"</button></div></div>"),this.multiple&&this.options.doneButton&&(r='<div class="bs-donebutton"><div class="btn-group btn-block"><button type="button" class="btn btn-sm '+A.BUTTONCLASS+'">'+this.options.doneButtonText+"</button></div></div>"),e='<div class="dropdown bootstrap-select'+e+i+'"><button type="button" tabindex="-1" class="'+this.options.styleBase+' dropdown-toggle" '+("static"===this.options.display?'data-display="static"':"")+'data-toggle="dropdown"'+s+' role="combobox" aria-owns="'+this.selectId+'" aria-haspopup="listbox" aria-expanded="false"><div class="filter-option"><div class="filter-option-inner"><div class="filter-option-inner-inner"></div></div> </div>'+("4"===T.major?"":'<span class="bs-caret">'+this.options.template.caret+"</span>")+'</button><div class="'+A.MENU+" "+("4"===T.major?"":A.SHOW)+'">'+n+o+l+'<div class="inner '+A.SHOW+'" role="listbox" id="'+this.selectId+'" tabindex="-1" '+t+'><ul class="'+A.MENU+" inner "+("4"===T.major?A.SHOW:"")+'" role="presentation"></ul></div>'+r+"</div></div>",I(e)},setPositionData:function(){this.selectpicker.view.canHighlight=[],this.selectpicker.view.size=0,this.selectpicker.view.firstHighlightIndex=!1;for(var e=0;e<this.selectpicker.current.data.length;e++){var t=this.selectpicker.current.data[e],i=!0;"divider"===t.type?(i=!1,t.height=this.sizeInfo.dividerHeight):"optgroup-label"===t.type?(i=!1,t.height=this.sizeInfo.dropdownHeaderHeight):t.height=this.sizeInfo.liHeight,t.disabled&&(i=!1),this.selectpicker.view.canHighlight.push(i),i&&(this.selectpicker.view.size++,t.posinset=this.selectpicker.view.size,!1===this.selectpicker.view.firstHighlightIndex)&&(this.selectpicker.view.firstHighlightIndex=e),t.position=(0===e?0:this.selectpicker.current.data[e-1].position)+t.height}},isVirtual:function(){return!1!==this.options.virtualScroll&&this.selectpicker.main.elements.length>=this.options.virtualScroll||!0===this.options.virtualScroll},createView:function(k,e,t){var y,$,S=this,i=0,E=[];function s(e,t){var i,s=S.selectpicker.current.elements.length,n=[],o=!0,l=S.isVirtual();S.selectpicker.view.scrollTop=e;for(var r,a=Math.ceil(S.sizeInfo.menuInnerHeight/S.sizeInfo.liHeight*1.5),c=Math.round(s/a)||1,d=0;d<c;d++){var h=d===c-1?s:(d+1)*a;if(n[d]=[d*a+(d?1:0),h],!s)break;void 0===i&&e-1<=S.selectpicker.current.data[h-1].position-S.sizeInfo.menuInnerHeight&&(i=d)}if(void 0===i&&(i=0),g=[S.selectpicker.view.position0,S.selectpicker.view.position1],p=Math.max(0,i-1),f=Math.min(c-1,i+1),S.selectpicker.view.position0=!1!==l&&Math.max(0,n[p][0])||0,S.selectpicker.view.position1=!1===l?s:Math.min(s,n[f][1])||0,p=g[0]!==S.selectpicker.view.position0||g[1]!==S.selectpicker.view.position1,void 0!==S.activeIndex&&($=S.selectpicker.main.elements[S.prevActiveIndex],E=S.selectpicker.main.elements[S.activeIndex],y=S.selectpicker.main.elements[S.selectedIndex],t&&(S.activeIndex!==S.selectedIndex&&S.defocusItem(E),S.activeIndex=void 0),S.activeIndex)&&S.activeIndex!==S.selectedIndex&&S.defocusItem(y),void 0!==S.prevActiveIndex&&S.prevActiveIndex!==S.activeIndex&&S.prevActiveIndex!==S.selectedIndex&&S.defocusItem($),(t||p)&&(f=S.selectpicker.view.visibleElements?S.selectpicker.view.visibleElements.slice():[],S.selectpicker.view.visibleElements=!1===l?S.selectpicker.current.elements:S.selectpicker.current.elements.slice(S.selectpicker.view.position0,S.selectpicker.view.position1),S.setOptionStatus(),(k||!1===l&&t)&&(g=f,r=S.selectpicker.view.visibleElements,o=!(g.length===r.length&&g.every(function(e,t){return e===r[t]}))),t||!0===l)&&o){var p=S.$menuInner[0],u=document.createDocumentFragment(),f=p.firstChild.cloneNode(!1),m=S.selectpicker.view.visibleElements,v=[];p.replaceChild(f,p.firstChild);for(var g,d=0,b=m.length;d<b;d++){var w,I,x=m[d];S.options.sanitize&&(w=x.lastChild)&&(I=S.selectpicker.current.data[d+S.selectpicker.view.position0])&&I.content&&!I.sanitized&&(v.push(w),I.sanitized=!0),u.appendChild(x)}S.options.sanitize&&v.length&&C(v,S.options.whiteList,S.options.sanitizeFn),!0===l?(g=0===S.selectpicker.view.position0?0:S.selectpicker.current.data[S.selectpicker.view.position0-1].position,o=S.selectpicker.view.position1>s-1?0:S.selectpicker.current.data[s-1].position-S.selectpicker.current.data[S.selectpicker.view.position1-1].position,p.firstChild.style.marginTop=g+"px",p.firstChild.style.marginBottom=o+"px"):(p.firstChild.style.marginTop=0,p.firstChild.style.marginBottom=0),p.firstChild.appendChild(u),!0===l&&S.sizeInfo.hasScrollBar&&(f=p.firstChild.offsetWidth,t&&f<S.sizeInfo.menuInnerInnerWidth&&S.sizeInfo.totalMenuWidth>S.sizeInfo.selectWidth?p.firstChild.style.minWidth=S.sizeInfo.menuInnerInnerWidth+"px":f>S.sizeInfo.menuInnerInnerWidth&&(S.$menu[0].style.minWidth=0,(g=p.firstChild.offsetWidth)>S.sizeInfo.menuInnerInnerWidth&&(S.sizeInfo.menuInnerInnerWidth=g,p.firstChild.style.minWidth=S.sizeInfo.menuInnerInnerWidth+"px"),S.$menu[0].style.minWidth=""))}S.prevActiveIndex=S.activeIndex,S.options.liveSearch?k&&t&&(S.selectpicker.view.canHighlight[o=0]||(o=1+S.selectpicker.view.canHighlight.slice(1).indexOf(!0)),l=S.selectpicker.view.visibleElements[o],S.defocusItem(S.selectpicker.view.currentActive),S.activeIndex=(S.selectpicker.current.data[o]||{}).index,S.focusItem(l)):S.$menuInner.trigger("focus")}this.selectpicker.isSearching=k,this.selectpicker.current=k?this.selectpicker.search:this.selectpicker.main,this.setPositionData(),e&&(t?i=this.$menuInner[0].scrollTop:S.multiple||"number"==typeof(t=((e=S.$element[0]).options[e.selectedIndex]||{}).liIndex)&&!1!==S.options.size&&(t=(e=S.selectpicker.main.data[t])&&e.position)&&(i=t-(S.sizeInfo.menuInnerHeight+S.sizeInfo.liHeight)/2)),s(i,!0),this.$menuInner.off("scroll.createView").on("scroll.createView",function(e,t){S.noScroll||s(this.scrollTop,t),S.noScroll=!1}),I(window).off("resize"+N+"."+this.selectId+".createView").on("resize"+N+"."+this.selectId+".createView",function(){S.$newElement.hasClass(A.SHOW)&&s(S.$menuInner[0].scrollTop)})},focusItem:function(e,t,i){var s;e&&(t=t||this.selectpicker.main.data[this.activeIndex],s=e.firstChild)&&(s.setAttribute("aria-setsize",this.selectpicker.view.size),s.setAttribute("aria-posinset",t.posinset),!0!==i)&&(this.focusedParent.setAttribute("aria-activedescendant",s.id),e.classList.add("active"),s.classList.add("active"))},defocusItem:function(e){e&&(e.classList.remove("active"),e.firstChild)&&e.firstChild.classList.remove("active")},setPlaceholder:function(){var e,t,i,s,n,o,l=this,r=!1;return this.options.title&&!this.multiple&&(this.selectpicker.view.titleOption||(this.selectpicker.view.titleOption=document.createElement("option")),e=this.$element[0],t=!(r=!0),i=!this.selectpicker.view.titleOption.parentNode,s=e.selectedIndex,n=e.options[s],o=(o=window.performance&&window.performance.getEntriesByType("navigation"))&&o.length?"back_forward"!==o[0].type:2!==window.performance.navigation.type,i&&(this.selectpicker.view.titleOption.className="bs-title-option",this.selectpicker.view.titleOption.value="",t=!n||0===s&&!1===n.defaultSelected&&void 0===this.$element.data("selected")),!i&&0===this.selectpicker.view.titleOption.index||e.insertBefore(this.selectpicker.view.titleOption,e.firstChild),t&&o?e.selectedIndex=0:"complete"!==document.readyState&&window.addEventListener("pageshow",function(){l.selectpicker.view.displayedValue!==e.value&&l.render()})),r},buildData:function(){var e=':not([hidden]):not([data-hidden="true"])',o=[],t=0,i=this.setPlaceholder()?1:0,s=(this.options.hideDisabled&&(e+=":not(:disabled)"),this.$element[0].querySelectorAll("select > *"+e));function l(e){var t=o[o.length-1];t&&"divider"===t.type&&(t.optID||e.optID)||((e=e||{}).type="divider",o.push(e))}function n(e,t){var i,s,n;(t=t||{}).divider="true"===e.getAttribute("data-divider"),t.divider?l({optID:t.optID}):(i=o.length,s=(s=e.style.cssText)?$(s):"",n=(e.className||"")+(t.optgroupClass||""),t.optID&&(n="opt "+n),t.optionClass=n.trim(),t.inlineStyle=s,t.text=e.textContent,t.content=e.getAttribute("data-content"),t.tokens=e.getAttribute("data-tokens"),t.subtext=e.getAttribute("data-subtext"),t.icon=e.getAttribute("data-icon"),e.liIndex=i,t.display=t.content||t.text,t.type="option",t.index=i,t.option=e,t.selected=!!e.selected,t.disabled=t.disabled||!!e.disabled,o.push(t))}for(var r=s.length,a=i;a<r;a++){var c=s[a];if("OPTGROUP"!==c.tagName)n(c,{});else{w=b=g=m=f=v=u=h=d=p=c=void 0;var c=a,d=(p=s)[c],h=!(c-1<i)&&p[c-1],p=p[c+1],u=d.querySelectorAll("option"+e);if(u.length){var f,m,v={display:$(d.label),subtext:d.getAttribute("data-subtext"),icon:d.getAttribute("data-icon"),type:"optgroup-label",optgroupClass:" "+(d.className||"")};t++,h&&l({optID:t}),v.optID=t,o.push(v);for(var g=0,b=u.length;g<b;g++){var w=u[g];0===g&&(m=(f=o.length-1)+b),n(w,{headerIndex:f,lastIndex:m,optID:v.optID,optgroupClass:v.optgroupClass,disabled:d.disabled})}p&&l({optID:t})}}}this.selectpicker.main.data=this.selectpicker.current.data=o},buildList:function(){var e=this,t=this.selectpicker.main.data,i=[],s=0;!e.options.showTick&&!e.multiple||L.checkMark.parentNode||(L.checkMark.className=this.options.iconBase+" "+e.options.tickIcon+" check-mark",L.a.appendChild(L.checkMark));for(var n=t.length,o=0;o<n;o++){var l,r=t[o],a=(c=l=a=void 0,r),c=0;switch(a.type){case"divider":l=D.li(!1,A.DIVIDER,a.optID?a.optID+"div":void 0);break;case"option":(l=D.li(D.a(D.text.call(e,a),a.optionClass,a.inlineStyle),"",a.optID)).firstChild&&(l.firstChild.id=e.selectId+"-"+a.index);break;case"optgroup-label":l=D.li(D.label.call(e,a),"dropdown-header"+a.optgroupClass,a.optID)}a.element=l,i.push(l),a.display&&(c+=a.display.length),a.subtext&&(c+=a.subtext.length),a.icon&&(c+=1),s<c&&(s=c,e.selectpicker.view.widestOption=i[i.length-1])}this.selectpicker.main.elements=this.selectpicker.current.elements=i},findLis:function(){return this.$menuInner.find(".inner > li")},render:function(){var e=this,t=this.$element[0],i=this.setPlaceholder()&&0===t.selectedIndex,s=x(t,this.options.hideDisabled),n=s.length,o=this.$button[0],l=o.querySelector(".filter-option-inner-inner"),r=document.createTextNode(this.options.multipleSeparator),a=L.fragment.cloneNode(!1),c=!1;if(o.classList.toggle("bs-placeholder",e.multiple?!n:!k(t,s)),e.multiple||1!==s.length||(e.selectpicker.view.displayedValue=k(t,s)),"static"===this.options.selectedTextFormat)a=D.text.call(this,{text:this.options.title},!0);else if(!1===(this.multiple&&-1!==this.options.selectedTextFormat.indexOf("count")&&1<n&&(1<(t=this.options.selectedTextFormat.split(">")).length&&n>t[1]||1===t.length&&2<=n))){if(!i){for(var d=0;d<n&&d<50;d++){var h=s[d],p=this.selectpicker.main.data[h.liIndex],u={};this.multiple&&0<d&&a.appendChild(r.cloneNode(!1)),h.title?u.text=h.title:p&&(p.content&&e.options.showContent?(u.content=p.content.toString(),c=!0):(e.options.showIcon&&(u.icon=p.icon),e.options.showSubtext&&!e.multiple&&p.subtext&&(u.subtext=" "+p.subtext),u.text=h.textContent.trim())),a.appendChild(D.text.call(this,u,!0))}49<n&&a.appendChild(document.createTextNode("..."))}}else var t=':not([hidden]):not([data-hidden="true"]):not([data-divider="true"])',i=(this.options.hideDisabled&&(t+=":not(:disabled)"),this.$element[0].querySelectorAll("select > option"+t+", optgroup"+t+" option"+t).length),t="function"==typeof this.options.countSelectedText?this.options.countSelectedText(n,i):this.options.countSelectedText,a=D.text.call(this,{text:t.replace("{0}",n.toString()).replace("{1}",i.toString())},!0);null==this.options.title&&(this.options.title=this.$element.attr("title")),a.childNodes.length||(a=D.text.call(this,{text:void 0!==this.options.title?this.options.title:this.options.noneSelectedText},!0)),o.title=a.textContent.replace(/<[^>]*>?/g,"").trim(),this.options.sanitize&&c&&C([a],e.options.whiteList,e.options.sanitizeFn),l.innerHTML="",l.appendChild(a),T.major<4&&this.$newElement[0].classList.contains("bs3-has-addon")&&(t=o.querySelector(".filter-expand"),(i=l.cloneNode(!0)).className="filter-expand",t?o.replaceChild(i,t):o.appendChild(i)),this.$element.trigger("rendered"+N)},setStyle:function(e,t){var i=this.$button[0],s=this.$newElement[0],n=this.options.style.trim();this.$element.attr("class")&&this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|bs-select-hidden|validate\[.*\]/gi,"")),T.major<4&&(s.classList.add("bs3"),s.parentNode.classList)&&s.parentNode.classList.contains("input-group")&&(s.previousElementSibling||s.nextElementSibling)&&(s.previousElementSibling||s.nextElementSibling).classList.contains("input-group-addon")&&s.classList.add("bs3-has-addon"),s=e?e.trim():n,"add"==t?s&&i.classList.add.apply(i.classList,s.split(" ")):"remove"==t?s&&i.classList.remove.apply(i.classList,s.split(" ")):(n&&i.classList.remove.apply(i.classList,n.split(" ")),s&&i.classList.add.apply(i.classList,s.split(" ")))},liHeight:function(e){if(e||!1!==this.options.size&&!Object.keys(this.sizeInfo).length){var t,e=L.div.cloneNode(!1),i=L.div.cloneNode(!1),s=L.div.cloneNode(!1),n=document.createElement("ul"),o=L.li.cloneNode(!1),l=L.li.cloneNode(!1),r=L.a.cloneNode(!1),a=L.span.cloneNode(!1),c=this.options.header&&0<this.$menu.find("."+A.POPOVERHEADER).length?this.$menu.find("."+A.POPOVERHEADER)[0].cloneNode(!0):null,d=this.options.liveSearch?L.div.cloneNode(!1):null,h=this.options.actionsBox&&this.multiple&&0<this.$menu.find(".bs-actionsbox").length?this.$menu.find(".bs-actionsbox")[0].cloneNode(!0):null,p=this.options.doneButton&&this.multiple&&0<this.$menu.find(".bs-donebutton").length?this.$menu.find(".bs-donebutton")[0].cloneNode(!0):null,u=this.$element.find("option")[0];if(this.sizeInfo.selectWidth=this.$newElement[0].offsetWidth,a.className="text",r.className="dropdown-item "+(u?u.className:""),e.className=this.$menu[0].parentNode.className+" "+A.SHOW,e.style.width=0,"auto"===this.options.width&&(i.style.minWidth=0),i.className=A.MENU+" "+A.SHOW,s.className="inner "+A.SHOW,n.className=A.MENU+" inner "+("4"===T.major?A.SHOW:""),o.className=A.DIVIDER,l.className="dropdown-header",a.appendChild(document.createTextNode("â")),this.selectpicker.current.data.length)for(var f=0;f<this.selectpicker.current.data.length;f++){var m=this.selectpicker.current.data[f];if("option"===m.type){t=m.element;break}}else t=L.li.cloneNode(!1),r.appendChild(a),t.appendChild(r);l.appendChild(a.cloneNode(!0)),this.selectpicker.view.widestOption&&n.appendChild(this.selectpicker.view.widestOption.cloneNode(!0)),n.appendChild(t),n.appendChild(o),n.appendChild(l),c&&i.appendChild(c),d&&(u=document.createElement("input"),d.className="bs-searchbox",u.className="form-control",d.appendChild(u),i.appendChild(d)),h&&i.appendChild(h),s.appendChild(n),i.appendChild(s),p&&i.appendChild(p),e.appendChild(i),document.body.appendChild(e);var r=t.offsetHeight,a=l?l.offsetHeight:0,u=c?c.offsetHeight:0,n=d?d.offsetHeight:0,l=h?h.offsetHeight:0,c=p?p.offsetHeight:0,d=I(o).outerHeight(!0),h=!!window.getComputedStyle&&window.getComputedStyle(i),p=i.offsetWidth,o=h?null:I(i),v={vert:g(h?h.paddingTop:o.css("paddingTop"))+g(h?h.paddingBottom:o.css("paddingBottom"))+g(h?h.borderTopWidth:o.css("borderTopWidth"))+g(h?h.borderBottomWidth:o.css("borderBottomWidth")),horiz:g(h?h.paddingLeft:o.css("paddingLeft"))+g(h?h.paddingRight:o.css("paddingRight"))+g(h?h.borderLeftWidth:o.css("borderLeftWidth"))+g(h?h.borderRightWidth:o.css("borderRightWidth"))},h={vert:v.vert+g(h?h.marginTop:o.css("marginTop"))+g(h?h.marginBottom:o.css("marginBottom"))+2,horiz:v.horiz+g(h?h.marginLeft:o.css("marginLeft"))+g(h?h.marginRight:o.css("marginRight"))+2};s.style.overflowY="scroll",o=i.offsetWidth-p,document.body.removeChild(e),this.sizeInfo.liHeight=r,this.sizeInfo.dropdownHeaderHeight=a,this.sizeInfo.headerHeight=u,this.sizeInfo.searchHeight=n,this.sizeInfo.actionsHeight=l,this.sizeInfo.doneButtonHeight=c,this.sizeInfo.dividerHeight=d,this.sizeInfo.menuPadding=v,this.sizeInfo.menuExtras=h,this.sizeInfo.menuWidth=p,this.sizeInfo.menuInnerInnerWidth=p-v.horiz,this.sizeInfo.totalMenuWidth=this.sizeInfo.menuWidth,this.sizeInfo.scrollBarWidth=o,this.sizeInfo.selectHeight=this.$newElement[0].offsetHeight,this.setPositionData()}},getSelectPosition:function(){var e,t=I(window),i=this.$newElement.offset(),s=I(this.options.container),s=(this.options.container&&s.length&&!s.is("body")?((e=s.offset()).top+=parseInt(s.css("borderTopWidth")),e.left+=parseInt(s.css("borderLeftWidth"))):e={top:0,left:0},this.options.windowPadding);this.sizeInfo.selectOffsetTop=i.top-e.top-t.scrollTop(),this.sizeInfo.selectOffsetBot=t.height()-this.sizeInfo.selectOffsetTop-this.sizeInfo.selectHeight-e.top-s[2],this.sizeInfo.selectOffsetLeft=i.left-e.left-t.scrollLeft(),this.sizeInfo.selectOffsetRight=t.width()-this.sizeInfo.selectOffsetLeft-this.sizeInfo.selectWidth-e.left-s[1],this.sizeInfo.selectOffsetTop-=s[0],this.sizeInfo.selectOffsetLeft-=s[3]},setMenuSize:function(e){this.getSelectPosition();var t,i,s,n,o,l,r=this.sizeInfo.selectWidth,a=this.sizeInfo.liHeight,c=this.sizeInfo.headerHeight,d=this.sizeInfo.searchHeight,h=this.sizeInfo.actionsHeight,p=this.sizeInfo.doneButtonHeight,u=this.sizeInfo.dividerHeight,f=this.sizeInfo.menuPadding,m=0;if(this.options.dropupAuto&&(l=a*this.selectpicker.current.elements.length+f.vert,l=this.sizeInfo.selectOffsetTop-this.sizeInfo.selectOffsetBot>this.sizeInfo.menuExtras.vert&&l+this.sizeInfo.menuExtras.vert+50>this.sizeInfo.selectOffsetBot,!0===this.selectpicker.isSearching&&(l=this.selectpicker.dropup),this.$newElement.toggleClass(A.DROPUP,l),this.selectpicker.dropup=l),"auto"===this.options.size)l=3<this.selectpicker.current.elements.length?3*this.sizeInfo.liHeight+this.sizeInfo.menuExtras.vert-2:0,i=this.sizeInfo.selectOffsetBot-this.sizeInfo.menuExtras.vert,s=l+c+d+h+p,o=Math.max(l-f.vert,0),t=(n=i=this.$newElement.hasClass(A.DROPUP)?this.sizeInfo.selectOffsetTop-this.sizeInfo.menuExtras.vert:i)-c-d-h-p-f.vert;else if(this.options.size&&"auto"!=this.options.size&&this.selectpicker.current.elements.length>this.options.size){for(var v=0;v<this.options.size;v++)"divider"===this.selectpicker.current.data[v].type&&m++;t=(i=a*this.options.size+m*u+f.vert)-f.vert,n=i+c+d+h+p,s=o=""}this.$menu.css({"max-height":n+"px",overflow:"hidden","min-height":s+"px"}),this.$menuInner.css({"max-height":t+"px","overflow-y":"auto","min-height":o+"px"}),this.sizeInfo.menuInnerHeight=Math.max(t,1),this.selectpicker.current.data.length&&this.selectpicker.current.data[this.selectpicker.current.data.length-1].position>this.sizeInfo.menuInnerHeight&&(this.sizeInfo.hasScrollBar=!0,this.sizeInfo.totalMenuWidth=this.sizeInfo.menuWidth+this.sizeInfo.scrollBarWidth),"auto"===this.options.dropdownAlignRight&&this.$menu.toggleClass(A.MENURIGHT,this.sizeInfo.selectOffsetLeft>this.sizeInfo.selectOffsetRight&&this.sizeInfo.selectOffsetRight<this.sizeInfo.totalMenuWidth-r),this.dropdown&&this.dropdown._popper&&this.dropdown._popper.update()},setSize:function(e){var t,i;this.liHeight(e),this.options.header&&this.$menu.css("padding-top",0),!1!==this.options.size&&(t=this,i=I(window),this.setMenuSize(),this.options.liveSearch&&this.$searchbox.off("input.setMenuSize propertychange.setMenuSize").on("input.setMenuSize propertychange.setMenuSize",function(){return t.setMenuSize()}),"auto"===this.options.size?i.off("resize"+N+"."+this.selectId+".setMenuSize scroll"+N+"."+this.selectId+".setMenuSize").on("resize"+N+"."+this.selectId+".setMenuSize scroll"+N+"."+this.selectId+".setMenuSize",function(){return t.setMenuSize()}):this.options.size&&"auto"!=this.options.size&&this.selectpicker.current.elements.length>this.options.size&&i.off("resize"+N+"."+this.selectId+".setMenuSize scroll"+N+"."+this.selectId+".setMenuSize")),this.createView(!1,!0,e)},setWidth:function(){var i=this;"auto"===this.options.width?requestAnimationFrame(function(){i.$menu.css("min-width","0"),i.$element.on("loaded"+N,function(){i.liHeight(),i.setMenuSize();var e=i.$newElement.clone().appendTo("body"),t=e.css("width","auto").children("button").outerWidth();e.remove(),i.sizeInfo.selectWidth=Math.max(i.sizeInfo.totalMenuWidth,t),i.$newElement.css("width",i.sizeInfo.selectWidth+"px")})}):"fit"===this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width","").addClass("fit-width")):this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width",this.options.width)):(this.$menu.css("min-width",""),this.$newElement.css("width","")),this.$newElement.hasClass("fit-width")&&"fit"!==this.options.width&&this.$newElement[0].classList.remove("fit-width")},selectPosition:function(){this.$bsContainer=I('<div class="bs-container" />');function e(e){var t={},i=l.options.display||!!I.fn.dropdown.Constructor.Default&&I.fn.dropdown.Constructor.Default.display;l.$bsContainer.addClass(e.attr("class").replace(/form-control|fit-width/gi,"")).toggleClass(A.DROPUP,e.hasClass(A.DROPUP)),s=e.offset(),r.is("body")?n={top:0,left:0}:((n=r.offset()).top+=parseInt(r.css("borderTopWidth"))-r.scrollTop(),n.left+=parseInt(r.css("borderLeftWidth"))-r.scrollLeft()),o=e.hasClass(A.DROPUP)?0:e[0].offsetHeight,(T.major<4||"static"===i)&&(t.top=s.top-n.top+o,t.left=s.left-n.left),t.width=e[0].offsetWidth,l.$bsContainer.css(t)}var s,n,o,l=this,r=I(this.options.container);this.$button.on("click.bs.dropdown.data-api",function(){l.isDisabled()||(e(l.$newElement),l.$bsContainer.appendTo(l.options.container).toggleClass(A.SHOW,!l.$button.hasClass(A.SHOW)).append(l.$menu))}),I(window).off("resize"+N+"."+this.selectId+" scroll"+N+"."+this.selectId).on("resize"+N+"."+this.selectId+" scroll"+N+"."+this.selectId,function(){l.$newElement.hasClass(A.SHOW)&&e(l.$newElement)}),this.$element.on("hide"+N,function(){l.$menu.data("height",l.$menu.height()),l.$bsContainer.detach()})},setOptionStatus:function(e){var t=this;if(t.noScroll=!1,t.selectpicker.view.visibleElements&&t.selectpicker.view.visibleElements.length)for(var i=0;i<t.selectpicker.view.visibleElements.length;i++){var s=t.selectpicker.current.data[i+t.selectpicker.view.position0],n=s.option;n&&(!0!==e&&t.setDisabled(s.index,s.disabled),t.setSelected(s.index,n.selected))}},setSelected:function(e,t){var i,s=this.selectpicker.main.elements[e],n=this.selectpicker.main.data[e],o=void 0!==this.activeIndex,l=this.activeIndex===e||t&&!this.multiple&&!o;n.selected=t,i=s.firstChild,t&&(this.selectedIndex=e),s.classList.toggle("selected",t),l?(this.focusItem(s,n),this.selectpicker.view.currentActive=s,this.activeIndex=e):this.defocusItem(s),i&&(i.classList.toggle("selected",t),t?i.setAttribute("aria-selected",!0):this.multiple?i.setAttribute("aria-selected",!1):i.removeAttribute("aria-selected")),l||o||!t||void 0===this.prevActiveIndex||(n=this.selectpicker.main.elements[this.prevActiveIndex],this.defocusItem(n))},setDisabled:function(e,t){var i=this.selectpicker.main.elements[e];this.selectpicker.main.data[e].disabled=t,e=i.firstChild,i.classList.toggle(A.DISABLED,t),e&&("4"===T.major&&e.classList.toggle(A.DISABLED,t),t?(e.setAttribute("aria-disabled",t),e.setAttribute("tabindex",-1)):(e.removeAttribute("aria-disabled"),e.setAttribute("tabindex",0)))},isDisabled:function(){return this.$element[0].disabled},checkDisabled:function(){this.isDisabled()?(this.$newElement[0].classList.add(A.DISABLED),this.$button.addClass(A.DISABLED).attr("aria-disabled",!0)):this.$button[0].classList.contains(A.DISABLED)&&(this.$newElement[0].classList.remove(A.DISABLED),this.$button.removeClass(A.DISABLED).attr("aria-disabled",!1))},clickListener:function(){var w=this,t=I(document);function e(){(w.options.liveSearch?w.$searchbox:w.$menuInner).trigger("focus")}function i(){w.dropdown&&w.dropdown._popper&&w.dropdown._popper.state.isCreated?e():requestAnimationFrame(i)}t.data("spaceSelect",!1),this.$button.on("keyup",function(e){/(32)/.test(e.keyCode.toString(10))&&t.data("spaceSelect")&&(e.preventDefault(),t.data("spaceSelect",!1))}),this.$newElement.on("show.bs.dropdown",function(){3<T.major&&!w.dropdown&&(w.dropdown=w.$button.data("bs.dropdown"),w.dropdown._menu=w.$menu[0])}),this.$button.on("click.bs.dropdown.data-api",function(){w.$newElement.hasClass(A.SHOW)||w.setSize()}),this.$element.on("shown"+N,function(){w.$menuInner[0].scrollTop!==w.selectpicker.view.scrollTop&&(w.$menuInner[0].scrollTop=w.selectpicker.view.scrollTop),3<T.major?requestAnimationFrame(i):e()}),this.$menuInner.on("mouseenter","li a",function(e){var t=this.parentElement,i=w.isVirtual()?w.selectpicker.view.position0:0,s=Array.prototype.indexOf.call(t.parentElement.children,t),s=w.selectpicker.current.data[s+i];w.focusItem(t,s,!0)}),this.$menuInner.on("click","li a",function(e,t){var i=I(this),s=w.$element[0],n=w.isVirtual()?w.selectpicker.view.position0:0,n=w.selectpicker.current.data[i.parent().index()+n],o=n.index,l=k(s),r=s.selectedIndex,a=s.options[r],c=!0;if(w.multiple&&1!==w.options.maxOptions&&e.stopPropagation(),e.preventDefault(),!w.isDisabled()&&!i.parent().hasClass(A.DISABLED)){var e=n.option,i=I(e),n=e.selected,d=i.parent("optgroup"),h=d.find("option"),p=w.options.maxOptions,u=d.data("maxOptions")||!1;if((t=o===w.activeIndex?!0:t)||(w.prevActiveIndex=w.activeIndex,w.activeIndex=void 0),w.multiple){if(e.selected=!n,w.setSelected(o,!n),w.focusedParent.focus(),!1!==p||!1!==u){t=p<x(s).length,n=u<d.find("option:selected").length;if(p&&t||u&&n)if(p&&1==p)s.selectedIndex=-1,e.selected=!0,w.setOptionStatus(!0);else if(u&&1==u){for(var f=0;f<h.length;f++){var m=h[f];m.selected=!1,w.setSelected(m.liIndex,!1)}e.selected=!0,w.setSelected(o,!0)}else{var d="string"==typeof w.options.maxOptionsText?[w.options.maxOptionsText,w.options.maxOptionsText]:w.options.maxOptionsText,d="function"==typeof d?d(p,u):d,v=d[0].replace("{n}",p),g=d[1].replace("{n}",u),b=I('<div class="notify"></div>');d[2]&&(v=v.replace("{var}",d[2][1<p?0:1]),g=g.replace("{var}",d[2][1<u?0:1])),e.selected=!1,w.$menu.append(b),p&&t&&(b.append(I("<div>"+v+"</div>")),c=!1,w.$element.trigger("maxReached"+N)),u&&n&&(b.append(I("<div>"+g+"</div>")),c=!1,w.$element.trigger("maxReachedGrp"+N)),setTimeout(function(){w.setSelected(o,!1)},10),b[0].classList.add("fadeOut"),setTimeout(function(){b.remove()},1050)}}}else a&&(a.selected=!1),e.selected=!0,w.setSelected(o,!0);!w.multiple||w.multiple&&1===w.options.maxOptions?w.$button.trigger("focus"):w.options.liveSearch&&w.$searchbox.trigger("focus"),!c||!w.multiple&&r===s.selectedIndex||(y=[e.index,i.prop("selected"),l],w.$element.triggerNative("change"))}}),this.$menu.on("click","li."+A.DISABLED+" a, ."+A.POPOVERHEADER+", ."+A.POPOVERHEADER+" :not(.close)",function(e){e.currentTarget==this&&(e.preventDefault(),e.stopPropagation(),(w.options.liveSearch&&!I(e.target).hasClass("close")?w.$searchbox:w.$button).trigger("focus"))}),this.$menuInner.on("click",".divider, .dropdown-header",function(e){e.preventDefault(),e.stopPropagation(),(w.options.liveSearch?w.$searchbox:w.$button).trigger("focus")}),this.$menu.on("click","."+A.POPOVERHEADER+" .close",function(){w.$button.trigger("click")}),this.$searchbox.on("click",function(e){e.stopPropagation()}),this.$menu.on("click",".actions-btn",function(e){(w.options.liveSearch?w.$searchbox:w.$button).trigger("focus"),e.preventDefault(),e.stopPropagation(),I(this).hasClass("bs-select-all")?w.selectAll():w.deselectAll()}),this.$button.on("focus"+N,function(e){var t=w.$element[0].getAttribute("tabindex");void 0!==t&&e.originalEvent&&e.originalEvent.isTrusted&&(this.setAttribute("tabindex",t),w.$element[0].setAttribute("tabindex",-1),w.selectpicker.view.tabindex=t)}).on("blur"+N,function(e){void 0!==w.selectpicker.view.tabindex&&e.originalEvent&&e.originalEvent.isTrusted&&(w.$element[0].setAttribute("tabindex",w.selectpicker.view.tabindex),this.setAttribute("tabindex",-1),w.selectpicker.view.tabindex=void 0)}),this.$element.on("change"+N,function(){w.render(),w.$element.trigger("changed"+N,y),y=null}).on("focus"+N,function(){w.options.mobile||w.$button[0].focus()})},liveSearchListener:function(){var p=this;this.$button.on("click.bs.dropdown.data-api",function(){p.$searchbox.val()&&(p.$searchbox.val(""),p.selectpicker.search.previousValue=void 0)}),this.$searchbox.on("click.bs.dropdown.data-api focus.bs.dropdown.data-api touchend.bs.dropdown.data-api",function(e){e.stopPropagation()}),this.$searchbox.on("input propertychange",function(){var e=p.$searchbox[0].value;if(p.selectpicker.search.elements=[],p.selectpicker.search.data=[],e){var t=[],i=e.toUpperCase(),s={},n=[],o=p._searchStyle(),l=p.options.liveSearchNormalize;l&&(i=u(i));for(var r=0;r<p.selectpicker.main.data.length;r++){var a=p.selectpicker.main.data[r];s[r]||(s[r]=b(a,i,o,l)),s[r]&&void 0!==a.headerIndex&&-1===n.indexOf(a.headerIndex)&&(0<a.headerIndex&&(s[a.headerIndex-1]=!0,n.push(a.headerIndex-1)),s[a.headerIndex]=!0,n.push(a.headerIndex),s[a.lastIndex+1]=!0),s[r]&&"optgroup-label"!==a.type&&n.push(r)}for(var r=0,c=n.length;r<c;r++){var d=n[r],a=p.selectpicker.main.data[d],h=p.selectpicker.main.data[n[r-1]];("divider"!==a.type||"divider"===a.type&&h&&"divider"!==h.type&&c-1!==r)&&(p.selectpicker.search.data.push(a),t.push(p.selectpicker.main.elements[d]))}p.activeIndex=void 0,p.noScroll=!0,p.$menuInner.scrollTop(0),p.selectpicker.search.elements=t,p.createView(!0),!function(e,t){e.length||(L.noResults.innerHTML=this.options.noneResultsText.replace("{0}",'"'+$(t)+'"'),this.$menuInner[0].firstChild.appendChild(L.noResults))}.call(p,t,e)}else p.selectpicker.search.previousValue&&(p.$menuInner.scrollTop(0),p.createView(!1));p.selectpicker.search.previousValue=e})},_searchStyle:function(){return this.options.liveSearchStyle||"contains"},val:function(e){var t,i=this.$element[0];return void 0!==e?(t=k(i),y=[null,null,t],this.$element.val(e).trigger("changed"+N,y),this.$newElement.hasClass(A.SHOW)&&(this.multiple?this.setOptionStatus(!0):"number"==typeof(t=(i.options[i.selectedIndex]||{}).liIndex)&&(this.setSelected(this.selectedIndex,!1),this.setSelected(t,!0))),this.render(),y=null,this.$element):this.$element.val()},changeAll:function(e){if(this.multiple){void 0===e&&(e=!0);var t=this.$element[0],i=0,s=0,n=k(t);t.classList.add("bs-select-hidden");for(var o=0,l=this.selectpicker.current.data,r=l.length;o<r;o++){var a=l[o],c=a.option;c&&!a.disabled&&"divider"!==a.type&&(a.selected&&i++,!0===(c.selected=e))&&s++}t.classList.remove("bs-select-hidden"),i!==s&&(this.setOptionStatus(),y=[null,null,n],this.$element.triggerNative("change"))}},selectAll:function(){return this.changeAll(!0)},deselectAll:function(){return this.changeAll(!1)},toggle:function(e){(e=e||window.event)&&e.stopPropagation(),this.$button.trigger("click.bs.dropdown.data-api")},keydown:function(e){var t,i,s,n,o=I(this),l=o.hasClass("dropdown-toggle"),r=(l?o.closest(".dropdown"):o.closest(Y.MENU)).data("this"),a=r.findLis(),c=!1,l=e.which===E&&!l&&!r.options.selectOnTab,d=Z.test(e.which)||l,h=r.$menuInner[0].scrollTop,p=!0===r.isVirtual()?r.selectpicker.view.position0:0;if(!(112<=e.which&&e.which<=123))if(!(t=r.$newElement.hasClass(A.SHOW))&&(d||48<=e.which&&e.which<=57||96<=e.which&&e.which<=105||65<=e.which&&e.which<=90)&&(r.$button.trigger("click.bs.dropdown.data-api"),r.options.liveSearch))r.$searchbox.trigger("focus");else{if(e.which===w&&t&&(e.preventDefault(),r.$button.trigger("click.bs.dropdown.data-api").trigger("focus")),d){if(!a.length)return;-1!==(d=(i=r.selectpicker.main.elements[r.activeIndex])?Array.prototype.indexOf.call(i.parentElement.children,i):-1)&&r.defocusItem(i),e.which===O?(-1!==d&&d--,d+p<0&&(d+=a.length),r.selectpicker.view.canHighlight[d+p]||-1===(d=r.selectpicker.view.canHighlight.slice(0,d+p).lastIndexOf(!0)-p)&&(d=a.length-1)):e.which!==z&&!l||(++d+p>=r.selectpicker.view.canHighlight.length&&(d=r.selectpicker.view.firstHighlightIndex),r.selectpicker.view.canHighlight[d+p])||(d=d+1+r.selectpicker.view.canHighlight.slice(d+p+1).indexOf(!0)),e.preventDefault();var u=p+d;e.which===O?0===p&&d===a.length-1?(r.$menuInner[0].scrollTop=r.$menuInner[0].scrollHeight,u=r.selectpicker.current.elements.length-1):c=(n=(s=r.selectpicker.current.data[u]).position-s.height)<h:e.which!==z&&!l||(d===r.selectpicker.view.firstHighlightIndex?(r.$menuInner[0].scrollTop=0,u=r.selectpicker.view.firstHighlightIndex):c=h<(n=(s=r.selectpicker.current.data[u]).position-r.sizeInfo.menuInnerHeight)),i=r.selectpicker.current.elements[u],r.activeIndex=r.selectpicker.current.data[u].index,r.focusItem(i),r.selectpicker.view.currentActive=i,c&&(r.$menuInner[0].scrollTop=n),(r.options.liveSearch?r.$searchbox:o).trigger("focus")}else if(!o.is("input")&&!J.test(e.which)||e.which===S&&r.selectpicker.keydown.keyHistory){var f,m=[];e.preventDefault(),r.selectpicker.keydown.keyHistory+=K[e.which],r.selectpicker.keydown.resetKeyHistory.cancel&&clearTimeout(r.selectpicker.keydown.resetKeyHistory.cancel),r.selectpicker.keydown.resetKeyHistory.cancel=r.selectpicker.keydown.resetKeyHistory.start(),f=r.selectpicker.keydown.keyHistory,/^(.)\1+$/.test(f)&&(f=f.charAt(0));for(var v=0;v<r.selectpicker.current.data.length;v++){var g=r.selectpicker.current.data[v];b(g,f,"startsWith",!0)&&r.selectpicker.view.canHighlight[v]&&m.push(g.index)}m.length&&(p=0,a.removeClass("active").find("a").removeClass("active"),1===f.length&&(-1===(p=m.indexOf(r.activeIndex))||p===m.length-1?p=0:p++),c=0<h-(s=r.selectpicker.main.data[l=m[p]]).position?(n=s.position-s.height,!0):(n=s.position-r.sizeInfo.menuInnerHeight,s.position>h+r.sizeInfo.menuInnerHeight),i=r.selectpicker.main.elements[l],r.activeIndex=m[p],r.focusItem(i),i&&i.firstChild.focus(),c&&(r.$menuInner[0].scrollTop=n),o.trigger("focus"))}t&&(e.which===S&&!r.selectpicker.keydown.keyHistory||e.which===q||e.which===E&&r.options.selectOnTab)&&(e.which!==S&&e.preventDefault(),r.options.liveSearch&&e.which===S||(r.$menuInner.find(".active a").trigger("click",!0),o.trigger("focus"),r.options.liveSearch)||(e.preventDefault(),I(document).data("spaceSelect",!0)))}},mobile:function(){this.options.mobile=!0,this.$element[0].classList.add("mobile-device")},refresh:function(){var e=I.extend({},this.options,this.$element.data());this.options=e,this.checkDisabled(),this.buildData(),this.setStyle(),this.render(),this.buildList(),this.setWidth(),this.setSize(!0),this.$element.trigger("refreshed"+N)},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},remove:function(){this.$newElement.remove(),this.$element.remove()},destroy:function(){this.$newElement.before(this.$element).remove(),(this.$bsContainer||this.$menu).remove(),this.selectpicker.view.titleOption&&this.selectpicker.view.titleOption.parentNode&&this.selectpicker.view.titleOption.parentNode.removeChild(this.selectpicker.view.titleOption),this.$element.off(N).removeData("selectpicker").removeClass("bs-select-hidden selectpicker"),I(window).off(N+"."+this.selectId)}};var X=I.fn.selectpicker;function ee(){if(I.fn.dropdown)return(I.fn.dropdown.Constructor._dataApiKeydownHandler||I.fn.dropdown.Constructor.prototype.keydown).apply(this,arguments)}I.fn.selectpicker=Q,I.fn.selectpicker.Constructor=H,I.fn.selectpicker.noConflict=function(){return I.fn.selectpicker=X,this},I(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.dropdown.data-api",':not(.bootstrap-select) > [data-toggle="dropdown"]',ee).on("keydown.bs.dropdown.data-api",":not(.bootstrap-select) > .dropdown-menu",ee).on("keydown"+N,'.bootstrap-select [data-toggle="dropdown"], .bootstrap-select [role="listbox"], .bootstrap-select .bs-searchbox input',H.prototype.keydown).on("focusin.modal",'.bootstrap-select [data-toggle="dropdown"], .bootstrap-select [role="listbox"], .bootstrap-select .bs-searchbox input',function(e){e.stopPropagation()}),I(window).on("load"+N+".data-api",function(){I(".selectpicker").each(function(){var e=I(this);Q.call(e,e.data())})})}(jQuery);
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},windowIsDefined="object"===("undefined"==typeof window?"undefined":_typeof(window));!function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){var e;try{e=require("jquery")}catch(t){e=null}module.exports=t(e)}else window&&(window.Slider=t(window.jQuery))}(function(t){var r,d,p,P,i,s,A,o="slider",n="bootstrapSlider";function e(){}function a(t,e){this._state={value:null,enabled:null,offset:null,size:null,percentage:null,inDrag:!1,over:!1,tickIndex:null},this.ticksCallbackMap={},this.handleCallbackMap={},"string"==typeof t?this.element=document.querySelector(t):t instanceof HTMLElement&&(this.element=t),e=e||{};for(var i=Object.keys(this.defaultOptions),t=e.hasOwnProperty("min"),s=e.hasOwnProperty("max"),o=0;o<i.length;o++){var n=i[o],a=e[n];a=null!==(a=void 0!==a?a:function(e,t){t="data-slider-"+t.replace(/_/g,"-"),e=e.getAttribute(t);try{return JSON.parse(e)}catch(t){return e}}(this.element,n))?a:this.defaultOptions[n],this.options||(this.options={}),this.options[n]=a}this.ticksAreValid=Array.isArray(this.options.ticks)&&0<this.options.ticks.length,this.ticksAreValid||(this.options.lock_to_ticks=!1),"auto"===this.options.rtl&&(c=window.getComputedStyle(this.element),this.options.rtl=null!=c?"rtl"===c.direction:"rtl"===this.element.style.direction),"vertical"!==this.options.orientation||"top"!==this.options.tooltip_position&&"bottom"!==this.options.tooltip_position?"horizontal"!==this.options.orientation||"left"!==this.options.tooltip_position&&"right"!==this.options.tooltip_position||(this.options.tooltip_position="top"):this.options.rtl?this.options.tooltip_position="left":this.options.tooltip_position="right";var h,l,r,d,p,c=this.element.style.width,u=!1,m=this.element.parentNode;if(this.sliderElem)u=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var _=document.createElement("div"),v=(_.className="slider-track",(l=document.createElement("div")).className="slider-track-low",(h=document.createElement("div")).className="slider-selection",(r=document.createElement("div")).className="slider-track-high",(d=document.createElement("div")).className="slider-handle min-slider-handle",d.setAttribute("role","slider"),d.setAttribute("aria-valuemin",this.options.min),d.setAttribute("aria-valuemax",this.options.max),(p=document.createElement("div")).className="slider-handle max-slider-handle",p.setAttribute("role","slider"),p.setAttribute("aria-valuemin",this.options.min),p.setAttribute("aria-valuemax",this.options.max),_.appendChild(l),_.appendChild(h),_.appendChild(r),this.rangeHighlightElements=[],this.options.rangeHighlights);if(Array.isArray(v)&&0<v.length)for(var g=0;g<v.length;g++){var f=document.createElement("div"),b=v[g].class||"";f.className="slider-rangeHighlight slider-selection "+b,this.rangeHighlightElements.push(f),_.appendChild(f)}var y=Array.isArray(this.options.labelledby);if(y&&this.options.labelledby[0]&&d.setAttribute("aria-labelledby",this.options.labelledby[0]),y&&this.options.labelledby[1]&&p.setAttribute("aria-labelledby",this.options.labelledby[1]),!y&&this.options.labelledby&&(d.setAttribute("aria-labelledby",this.options.labelledby),p.setAttribute("aria-labelledby",this.options.labelledby)),this.ticks=[],Array.isArray(this.options.ticks)&&0<this.options.ticks.length){for(this.ticksContainer=document.createElement("div"),this.ticksContainer.className="slider-tick-container",o=0;o<this.options.ticks.length;o++){var k,E,C=document.createElement("div");C.className="slider-tick",this.options.ticks_tooltip&&(k=(E=this._addTickListener()).addMouseEnter(this,C,o),E=E.addMouseLeave(this,C),this.ticksCallbackMap[o]={mouseEnter:k,mouseLeave:E}),this.ticks.push(C),this.ticksContainer.appendChild(C)}h.className+=" tick-slider-selection"}if(this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&0<this.options.ticks_labels.length)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",o=0;o<this.options.ticks_labels.length;o++){var w=document.createElement("div"),x=0===this.options.ticks_positions.length,x=this.options.reversed&&x?this.options.ticks_labels.length-(o+1):o;w.className="slider-tick-label",w.innerHTML=this.options.ticks_labels[x],this.tickLabels.push(w),this.tickLabelContainer.appendChild(w)}var y=function(t){var e=document.createElement("div"),i=(e.className="arrow",document.createElement("div"));i.className="tooltip-inner",t.appendChild(e),t.appendChild(i)},L=document.createElement("div"),T=(L.className="tooltip tooltip-main",L.setAttribute("role","presentation"),y(L),document.createElement("div")),M=(T.className="tooltip tooltip-min",T.setAttribute("role","presentation"),y(T),document.createElement("div"));M.className="tooltip tooltip-max",M.setAttribute("role","presentation"),y(M),this.sliderElem.appendChild(_),this.sliderElem.appendChild(L),this.sliderElem.appendChild(T),this.sliderElem.appendChild(M),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),this.ticksContainer&&this.sliderElem.appendChild(this.ticksContainer),this.sliderElem.appendChild(d),this.sliderElem.appendChild(p),m.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(P&&(this.$element=P(this.element),this.$sliderElem=P(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.touchX=0,this.touchY=0,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),A[this.options.scale]&&(this.options.scale=A[this.options.scale]),!0===u&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.sliderElem,"slider-rtl"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","right","top","width","height"].forEach(function(t){this._removeProperty(this.trackLow,t),this._removeProperty(this.trackSelection,t),this._removeProperty(this.trackHigh,t)},this),[this.handle1,this.handle2].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(t){this._removeProperty(t,"bs-tooltip-left"),this._removeProperty(t,"bs-tooltip-right"),this._removeProperty(t,"bs-tooltip-top"),this._removeClass(t,"bs-tooltip-right"),this._removeClass(t,"bs-tooltip-left"),this._removeClass(t,"bs-tooltip-top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=c,this.options.orientation="horizontal",this.options.rtl?this.stylePos="right":this.stylePos="left",this.mousePos="clientX",this.sizePos="offsetWidth"),this.options.rtl&&this._addClass(this.sliderElem,"slider-rtl"),this._setTooltipPosition(),Array.isArray(this.options.ticks)&&0<this.options.ticks.length&&(s||(this.options.max=Math.max.apply(Math,this.options.ticks)),t||(this.options.min=Math.min.apply(Math,this.options.ticks))),Array.isArray(this.options.value)?(this.options.range=!0,this._state.value=this.options.value):this.options.range?this._state.value=[this.options.value,this.options.max]:this._state.value=this.options.value,this.trackLow=l||this.trackLow,this.trackSelection=h||this.trackSelection,this.trackHigh=r||this.trackHigh,"none"===this.options.selection?(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")):"after"!==this.options.selection&&"before"!==this.options.selection||(this._removeClass(this.trackLow,"hide"),this._removeClass(this.trackSelection,"hide"),this._removeClass(this.trackHigh,"hide")),this.handle1=d||this.handle1,this.handle2=p||this.handle2,!0===u)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),o=0;o<this.ticks.length;o++)this._removeClass(this.ticks[o],"round triangle hide");if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),o=0;o<this.ticks.length;o++)this._addClass(this.ticks[o],this.options.handle);this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this.setValue(this._state.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchstart=this._touchstart.bind(this),this.touchmove=this._touchmove.bind(this),this.touchCapable&&(this.sliderElem.addEventListener("touchstart",this.touchstart,!1),this.sliderElem.addEventListener("touchmove",this.touchmove,!1)),this.sliderElem.addEventListener("mousedown",this.mousedown,!1),this.resize=this._resize.bind(this),window.addEventListener("resize",this.resize,!1),"hide"===this.options.tooltip?(this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide")):"always"===this.options.tooltip?(this._showTooltip(),this._alwaysShowTooltip=!0):(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.options.ticks_tooltip?(L=(y=this._addTickListener()).addMouseEnter(this,this.handle1),T=y.addMouseLeave(this,this.handle1),this.handleCallbackMap.handle1={mouseEnter:L,mouseLeave:T},L=y.addMouseEnter(this,this.handle2),T=y.addMouseLeave(this,this.handle2),this.handleCallbackMap.handle2={mouseEnter:L,mouseLeave:T}):(this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1),this.touchCapable&&(this.sliderElem.addEventListener("touchstart",this.showTooltip,!1),this.sliderElem.addEventListener("touchmove",this.showTooltip,!1),this.sliderElem.addEventListener("touchend",this.hideTooltip,!1))),this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1),this.touchCapable&&(this.handle1.addEventListener("touchstart",this.showTooltip,!1),this.handle1.addEventListener("touchmove",this.showTooltip,!1),this.handle1.addEventListener("touchend",this.hideTooltip,!1),this.handle2.addEventListener("touchstart",this.showTooltip,!1),this.handle2.addEventListener("touchmove",this.showTooltip,!1),this.handle2.addEventListener("touchend",this.hideTooltip,!1))),this.options.enabled?this.enable():this.disable()}return windowIsDefined&&!window.console&&(window.console={}),windowIsDefined&&!window.console.log&&(window.console.log=function(){}),windowIsDefined&&!window.console.warn&&(window.console.warn=function(){}),p=Array.prototype.slice,(r=t)&&(d="undefined"==typeof console?e:function(t){console.error(t)},r.bridget=function(t,e){var i,h,l;(i=e).prototype.option||(i.prototype.option=function(t){r.isPlainObject(t)&&(this.options=r.extend(!0,this.options,t))}),h=t,l=e,r.fn[h]=function(e){var t;if("string"!=typeof e)return 1===(t=this.map(function(){var t=r.data(this,h);return t?(t.option(e),t._init()):(t=new l(this,e),r.data(this,h,t)),r(this)})).length?t[0]:t;for(var i=p.call(arguments,1),s=0,o=this.length;s<o;s++){var n=this[s],n=r.data(n,h);if(n)if(r.isFunction(n[e])&&"_"!==e.charAt(0)){var a=n[e].apply(n,i);if(void 0!==a&&a!==n)return a}else d("no such method '"+e+"' for "+h+" instance");else d("cannot call methods on "+h+" prior to initialization; attempted to call '"+e+"'")}return this}},r.bridget),P=t,i=void 0,s=function(t){return"Invalid input value '"+t+"' passed in"},A={linear:{getValue:function(t,e){return t<e.min?e.min:t>e.max?e.max:t},toValue:function(t){var e=t/100*(this.options.max-this.options.min),i=!0;if(0<this.options.ticks_positions.length){for(var s,o,n,a=0,h=1;h<this.options.ticks_positions.length;h++)if(t<=this.options.ticks_positions[h]){s=this.options.ticks[h-1],n=this.options.ticks_positions[h-1],o=this.options.ticks[h],a=this.options.ticks_positions[h];break}e=s+(t-n)/(a-n)*(o-s),i=!1}i=(i?this.options.min:0)+Math.round(e/this.options.step)*this.options.step;return A.linear.getValue(i,this.options)},toPercentage:function(t){if(this.options.max===this.options.min)return 0;if(0<this.options.ticks_positions.length){for(var e,i,s,o=0,n=0;n<this.options.ticks.length;n++)if(t<=this.options.ticks[n]){e=0<n?this.options.ticks[n-1]:0,s=0<n?this.options.ticks_positions[n-1]:0,i=this.options.ticks[n],o=this.options.ticks_positions[n];break}if(0<n)return s+(t-e)/(i-e)*(o-s)}return 100*(t-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(t){var e=1-this.options.min,i=Math.log(this.options.min+e),s=Math.log(this.options.max+e),i=Math.exp(i+(s-i)*t/100)-e;return Math.round(i)===s?s:(i=this.options.min+Math.round((i-this.options.min)/this.options.step)*this.options.step,A.linear.getValue(i,this.options))},toPercentage:function(t){var e,i,s;return this.options.max===this.options.min?0:(e=1-this.options.min,i=Math.log(this.options.max+e),s=Math.log(this.options.min+e),100*(Math.log(t+e)-s)/(i-s))}}},(t=function(t,e){return a.call(this,t,e),this}).prototype={_init:function(){},constructor:t,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,lock_to_ticks:!1,handle:"round",reversed:!1,rtl:"auto",enabled:!0,formatter:function(t){return Array.isArray(t)?t[0]+" : "+t[1]:t},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,ticks_tooltip:!1,scale:"linear",focus:!1,tooltip_position:null,labelledby:null,rangeHighlights:[]},getElement:function(){return this.sliderElem},getValue:function(){return this.options.range?this._state.value:this._state.value[0]},setValue:function(t,e,i){t=t||0;var s=this.getValue(),t=(this._state.value=this._validateInputValue(t),this._applyPrecision.bind(this)),t=(this.options.range?(this._state.value[0]=t(this._state.value[0]),this._state.value[1]=t(this._state.value[1]),this.ticksAreValid&&this.options.lock_to_ticks&&(this._state.value[0]=this.options.ticks[this._getClosestTickIndex(this._state.value[0])],this._state.value[1]=this.options.ticks[this._getClosestTickIndex(this._state.value[1])]),this._state.value[0]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[0])),this._state.value[1]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[1]))):(this._state.value=t(this._state.value),this.ticksAreValid&&this.options.lock_to_ticks&&(this._state.value=this.options.ticks[this._getClosestTickIndex(this._state.value)]),this._state.value=[Math.max(this.options.min,Math.min(this.options.max,this._state.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this._state.value[1]=this.options.max:this._state.value[1]=this.options.min),this._setTickIndex(),this.options.max>this.options.min?this._state.percentage=[this._toPercentage(this._state.value[0]),this._toPercentage(this._state.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this._state.percentage=[0,0,100],this._layout(),this.options.range?this._state.value:this._state.value[0]);this._setDataVal(t),!0===e&&this._trigger("slide",t);return(Array.isArray(t)?s[0]!==t[0]||s[1]!==t[1]:s!==t)&&!0===i&&this._trigger("change",{oldValue:s,newValue:t}),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),P&&(this._unbindJQueryEventHandlers(),i===o&&this.$element.removeData(i),this.$element.removeData(n))},disable:function(){return this._state.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this._state.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this._state.enabled?this.disable():this.enable(),this},isEnabled:function(){return this._state.enabled},on:function(t,e){return this._bindNonQueryEventHandler(t,e),this},off:function(t,e){P?(this.$element.off(t,e),this.$sliderElem.off(t,e)):this._unbindNonQueryEventHandler(t,e)},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(t){var e=this.getValue();return this._removeSliderEventHandlers(),a.call(this,this.element,this.options),t&&!0===t.useCurrentValue&&this.setValue(e),P&&(i===o&&P.data(this.element,o,this),P.data(this.element,n,this)),this},relayout:function(){return this._resize(),this},_removeTooltipListener:function(t,e){this.handle1.removeEventListener(t,e,!1),this.handle2.removeEventListener(t,e,!1)},_removeSliderEventHandlers:function(){if(this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.options.ticks_tooltip){for(var t=this.ticksContainer.getElementsByClassName("slider-tick"),e=0;e<t.length;e++)t[e].removeEventListener("mouseenter",this.ticksCallbackMap[e].mouseEnter,!1),t[e].removeEventListener("mouseleave",this.ticksCallbackMap[e].mouseLeave,!1);this.handleCallbackMap.handle1&&this.handleCallbackMap.handle2&&(this.handle1.removeEventListener("mouseenter",this.handleCallbackMap.handle1.mouseEnter,!1),this.handle2.removeEventListener("mouseenter",this.handleCallbackMap.handle2.mouseEnter,!1),this.handle1.removeEventListener("mouseleave",this.handleCallbackMap.handle1.mouseLeave,!1),this.handle2.removeEventListener("mouseleave",this.handleCallbackMap.handle2.mouseLeave,!1))}this.handleCallbackMap=null,this.ticksCallbackMap=null,this.showTooltip&&this._removeTooltipListener("focus",this.showTooltip),this.hideTooltip&&this._removeTooltipListener("blur",this.hideTooltip),this.showTooltip&&this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.hideTooltip&&this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1),this.touchCapable&&(this.showTooltip&&(this.handle1.removeEventListener("touchstart",this.showTooltip,!1),this.handle1.removeEventListener("touchmove",this.showTooltip,!1),this.handle2.removeEventListener("touchstart",this.showTooltip,!1),this.handle2.removeEventListener("touchmove",this.showTooltip,!1)),this.hideTooltip&&(this.handle1.removeEventListener("touchend",this.hideTooltip,!1),this.handle2.removeEventListener("touchend",this.hideTooltip,!1)),this.showTooltip&&(this.sliderElem.removeEventListener("touchstart",this.showTooltip,!1),this.sliderElem.removeEventListener("touchmove",this.showTooltip,!1)),this.hideTooltip&&this.sliderElem.removeEventListener("touchend",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.touchstart,!1),this.sliderElem.removeEventListener("touchmove",this.touchmove,!1)),window.removeEventListener("resize",this.resize,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_unbindNonQueryEventHandler:function(t,e){var i=this.eventToCallbackMap[t];if(void 0!==i)for(var s=0;s<i.length;s++)if(i[s]===e){i.splice(s,1);break}},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var i=t[e];delete this.eventToCallbackMap[i]}},_showTooltip:function(){!1===this.options.tooltip_split?(this._addClass(this.tooltip,"show"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"show"),this._addClass(this.tooltip_max,"show"),this.tooltip.style.display="none"),this._state.over=!0},_hideTooltip:function(){!1===this._state.inDrag&&!0!==this._alwaysShowTooltip&&(this._removeClass(this.tooltip,"show"),this._removeClass(this.tooltip_min,"show"),this._removeClass(this.tooltip_max,"show")),this._state.over=!1},_setToolTipOnMouseOver:function(t){var i=this,e=this.options.formatter((t||this._state).value[0]),t=s(t||this._state,this.options.reversed);function s(t,e){return e?[100-t.percentage[0],i.options.range?100-t.percentage[1]:t.percentage[1]]:[t.percentage[0],t.percentage[1]]}this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=t[0]+"%"},_copyState:function(){return{value:[this._state.value[0],this._state.value[1]],enabled:this._state.enabled,offset:this._state.offset,size:this._state.size,percentage:[this._state.percentage[0],this._state.percentage[1],this._state.percentage[2]],inDrag:this._state.inDrag,over:this._state.over,dragged:this._state.dragged,keyCtrl:this._state.keyCtrl}},_addTickListener:function(){return{addMouseEnter:function(s,o,n){function t(){var t=s._copyState(),e=o===s.handle1?t.value[0]:t.value[1],i=void 0,i=void 0!==n?(e=s.options.ticks[n],0<s.options.ticks_positions.length&&s.options.ticks_positions[n]||s._toPercentage(s.options.ticks[n])):s._toPercentage(e);t.value[0]=e,t.percentage[0]=i,s._setToolTipOnMouseOver(t),s._showTooltip()}return o.addEventListener("mouseenter",t,!1),t},addMouseLeave:function(t,e){function i(){t._hideTooltip()}return e.addEventListener("mouseleave",i,!1),i}}},_layout:function(){var t,e,i=this.options.reversed?[100-this._state.percentage[0],this.options.range?100-this._state.percentage[1]:this._state.percentage[1]]:[this._state.percentage[0],this._state.percentage[1]];if(this.handle1.style[this.stylePos]=i[0]+"%",this.handle1.setAttribute("aria-valuenow",this._state.value[0]),t=this.options.formatter(this._state.value[0]),isNaN(t)?this.handle1.setAttribute("aria-valuetext",t):this.handle1.removeAttribute("aria-valuetext"),this.handle2.style[this.stylePos]=i[1]+"%",this.handle2.setAttribute("aria-valuenow",this._state.value[1]),t=this.options.formatter(this._state.value[1]),isNaN(t)?this.handle2.setAttribute("aria-valuetext",t):this.handle2.removeAttribute("aria-valuetext"),0<this.rangeHighlightElements.length&&Array.isArray(this.options.rangeHighlights)&&0<this.options.rangeHighlights.length)for(var s=0;s<this.options.rangeHighlights.length;s++){var o=this._toPercentage(this.options.rangeHighlights[s].start),n=this._toPercentage(this.options.rangeHighlights[s].end),a=(this.options.reversed&&(a=100-n,n=100-o,o=a),this._createHighlightRange(o,n));a?"vertical"===this.options.orientation?(this.rangeHighlightElements[s].style.top=a.start+"%",this.rangeHighlightElements[s].style.height=a.size+"%"):(this.options.rtl?this.rangeHighlightElements[s].style.right=a.start+"%":this.rangeHighlightElements[s].style.left=a.start+"%",this.rangeHighlightElements[s].style.width=a.size+"%"):this.rangeHighlightElements[s].style.display="none"}if(Array.isArray(this.options.ticks)&&0<this.options.ticks.length){var h="vertical"===this.options.orientation?"height":"width",l="vertical"===this.options.orientation?"marginTop":this.options.rtl?"marginRight":"marginLeft",r=this._state.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var d=0;if(0===this.options.ticks_positions.length)"vertical"!==this.options.orientation&&(this.tickLabelContainer.style[l]=-r/2+"px"),d=this.tickLabelContainer.offsetHeight;else for(p=0;p<this.tickLabelContainer.childNodes.length;p++)this.tickLabelContainer.childNodes[p].offsetHeight>d&&(d=this.tickLabelContainer.childNodes[p].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=d+"px")}for(var p=0;p<this.options.ticks.length;p++){var c=this.options.ticks_positions[p]||this._toPercentage(this.options.ticks[p]);this.options.reversed&&(c=100-c),this.ticks[p].style[this.stylePos]=c+"%",this._removeClass(this.ticks[p],"in-selection"),this.options.range?c>=i[0]&&c<=i[1]&&this._addClass(this.ticks[p],"in-selection"):("after"===this.options.selection&&c>=i[0]||"before"===this.options.selection&&c<=i[0])&&this._addClass(this.ticks[p],"in-selection"),this.tickLabels[p]&&(this.tickLabels[p].style[h]=r+"px","vertical"!==this.options.orientation&&void 0!==this.options.ticks_positions[p]?(this.tickLabels[p].style.position="absolute",this.tickLabels[p].style[this.stylePos]=c+"%",this.tickLabels[p].style[l]=-r/2+"px"):"vertical"===this.options.orientation&&(this.options.rtl?this.tickLabels[p].style.marginRight=this.sliderElem.offsetWidth+"px":this.tickLabels[p].style.marginLeft=this.sliderElem.offsetWidth+"px",this.tickLabelContainer.style[l]=this.sliderElem.offsetWidth/2*-1+"px"),this._removeClass(this.tickLabels[p],"label-in-selection label-is-selection"),this.options.range?c>=i[0]&&c<=i[1]&&(this._addClass(this.tickLabels[p],"label-in-selection"),c!==i[0]&&!i[1]||this._addClass(this.tickLabels[p],"label-is-selection")):(("after"===this.options.selection&&c>=i[0]||"before"===this.options.selection&&c<=i[0])&&this._addClass(this.tickLabels[p],"label-in-selection"),c===i[0]&&this._addClass(this.tickLabels[p],"label-is-selection")))}}this.options.range?(e=this.options.formatter(this._state.value),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=(i[1]+i[0])/2+"%",t=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner_min,t),t=this.options.formatter(this._state.value[1]),this._setText(this.tooltipInner_max,t),this.tooltip_min.style[this.stylePos]=i[0]+"%",this.tooltip_max.style[this.stylePos]=i[1]+"%"):(e=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=i[0]+"%"),"vertical"===this.options.orientation?(this.trackLow.style.top="0",this.trackLow.style.height=Math.min(i[0],i[1])+"%",this.trackSelection.style.top=Math.min(i[0],i[1])+"%",this.trackSelection.style.height=Math.abs(i[0]-i[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(i[0],i[1])-Math.abs(i[0]-i[1])+"%"):("right"===this.stylePos?this.trackLow.style.right="0":this.trackLow.style.left="0",this.trackLow.style.width=Math.min(i[0],i[1])+"%","right"===this.stylePos?this.trackSelection.style.right=Math.min(i[0],i[1])+"%":this.trackSelection.style.left=Math.min(i[0],i[1])+"%",this.trackSelection.style.width=Math.abs(i[0]-i[1])+"%","right"===this.stylePos?this.trackHigh.style.left="0":this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(i[0],i[1])-Math.abs(i[0]-i[1])+"%",t=this.tooltip_min.getBoundingClientRect(),e=this.tooltip_max.getBoundingClientRect(),"bottom"===this.options.tooltip_position?t.right>e.left?(this._removeClass(this.tooltip_max,"bs-tooltip-bottom"),this._addClass(this.tooltip_max,"bs-tooltip-top"),this.tooltip_max.style.top="",this.tooltip_max.style.bottom="22px"):(this._removeClass(this.tooltip_max,"bs-tooltip-top"),this._addClass(this.tooltip_max,"bs-tooltip-bottom"),this.tooltip_max.style.top=this.tooltip_min.style.top,this.tooltip_max.style.bottom=""):t.right>e.left?(this._removeClass(this.tooltip_max,"bs-tooltip-top"),this._addClass(this.tooltip_max,"bs-tooltip-bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bs-tooltip-bottom"),this._addClass(this.tooltip_max,"bs-tooltip-top"),this.tooltip_max.style.top=this.tooltip_min.style.top))},_createHighlightRange:function(t,e){return this._isHighlightRange(t,e)?e<t?{start:e,size:t-e}:{start:t,size:e-t}:null},_isHighlightRange:function(t,e){return 0<=t&&t<=100&&0<=e&&e<=100},_resize:function(t){this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this._layout()},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this._state.enabled)return!1;t.preventDefault&&t.preventDefault(),this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos];var e,i=this._getPercentage(t),s=(this.options.range?(s=Math.abs(this._state.percentage[0]-i),e=Math.abs(this._state.percentage[1]-i),this._state.dragged=s<e?0:1,this._adjustPercentageForRangeSliders(i)):this._state.dragged=0,this._state.percentage[this._state.dragged]=i,this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!0,this._calculateValue());return this._trigger("slideStart",s),this.setValue(s,!1,!0),t.returnValue=!1,this.options.focus&&this._triggerFocusOnHandle(this._state.dragged),!0},_touchstart:function(t){this._mousedown(t)},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this._state.enabled)return!1;var i,s,o,n,a;switch(e.keyCode){case 37:case 40:i=-1;break;case 39:case 38:i=1}return i?(this.options.natural_arrow_keys&&(n="horizontal"===this.options.orientation,s="vertical"===this.options.orientation,a=this.options.rtl,o=this.options.reversed,n?a?o||(i=-i):o&&(i=-i):s&&!o&&(i=-i)),a=this.ticksAreValid&&this.options.lock_to_ticks?(n=void 0,-1===(n=this.options.ticks.indexOf(this._state.value[t]))&&(n=0,window.console.warn("(lock_to_ticks) _keydown: index should not be -1")),n+=i,n=Math.max(0,Math.min(this.options.ticks.length-1,n)),this.options.ticks[n]):this._state.value[t]+i*this.options.step,s=this._toPercentage(a),this._state.keyCtrl=t,a=this.options.range?(this._adjustPercentageForRangeSliders(s),o=this._state.keyCtrl?this._state.value[0]:a,n=this._state.keyCtrl?a:this._state.value[1],[Math.max(this.options.min,Math.min(this.options.max,o)),Math.max(this.options.min,Math.min(this.options.max,n))]):Math.max(this.options.min,Math.min(this.options.max,a)),this._trigger("slideStart",a),this.setValue(a,!0,!0),this._trigger("slideStop",a),this._pauseEvent(e),delete this._state.keyCtrl,!1):void 0},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){return this._state.enabled&&(t=this._getPercentage(t),this._adjustPercentageForRangeSliders(t),this._state.percentage[this._state.dragged]=t,t=this._calculateValue(!0),this.setValue(t,!0,!0)),!1},_touchmove:function(t){void 0!==t.changedTouches&&t.preventDefault&&t.preventDefault()},_adjustPercentageForRangeSliders:function(t){var e,i;this.options.range&&(e=this._getNumDigitsAfterDecimalPlace(t),i=this._applyToFixedAndParseFloat(t,e=e?e-1:0),0===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[1],e)<i?(this._state.percentage[0]=this._state.percentage[1],this._state.dragged=1):1===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[0],e)>i?(this._state.percentage[1]=this._state.percentage[0],this._state.dragged=0):0===this._state.keyCtrl&&this._toPercentage(this._state.value[1])<t?(this._state.percentage[0]=this._state.percentage[1],this._state.keyCtrl=1,this.handle2.focus()):1===this._state.keyCtrl&&this._toPercentage(this._state.value[0])>t&&(this._state.percentage[1]=this._state.percentage[0],this._state.keyCtrl=0,this.handle1.focus()))},_mouseup:function(t){return this._state.enabled&&(t=this._getPercentage(t),this._adjustPercentageForRangeSliders(t),this._state.percentage[this._state.dragged]=t,this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),(this._state.inDrag=!1)===this._state.over&&this._hideTooltip(),t=this._calculateValue(!0),this.setValue(t,!1,!0),this._trigger("slideStop",t),this._state.dragged=null),!1},_setValues:function(t,e){this._state.percentage[t]!==(0===t?0:100)&&(e.data[t]=this._toValue(this._state.percentage[t]),e.data[t]=this._applyPrecision(e.data[t]))},_calculateValue:function(t){var e={};return this.options.range?(e.data=[this.options.min,this.options.max],this._setValues(0,e),this._setValues(1,e),t&&(e.data[0]=this._snapToClosestTick(e.data[0]),e.data[1]=this._snapToClosestTick(e.data[1]))):(e.data=this._toValue(this._state.percentage[0]),e.data=parseFloat(e.data),e.data=this._applyPrecision(e.data),t&&(e.data=this._snapToClosestTick(e.data))),e.data},_snapToClosestTick:function(t){for(var e=[t,1/0],i=0;i<this.options.ticks.length;i++){var s=Math.abs(this.options.ticks[i]-t);s<=e[1]&&(e=[this.options.ticks[i],s])}return e[1]<=this.options.ticks_snap_bounds?e[0]:t},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){t=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){t=t.toFixed(e);return parseFloat(t)},_getPercentage:function(t){t=(t=!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type&&"touchend"!==t.type?t:t.changedTouches[0])[this.mousePos]-this._state.offset[this.stylePos],t=(t="right"===this.stylePos?-t:t)/this._state.size*100,t=Math.round(t/this._state.percentage[2])*this._state.percentage[2];return this.options.reversed&&(t=100-t),Math.max(0,Math.min(100,t))},_validateInputValue:function(t){if(isNaN(+t)){if(Array.isArray(t))return this._validateArray(t),t;throw new Error(s(t))}return+t},_validateArray:function(t){for(var e=0;e<t.length;e++){var i=t[e];if("number"!=typeof i)throw new Error(s(i))}},_setDataVal:function(t){this.element.setAttribute("data-value",t),this.element.setAttribute("value",t),this.element.value=t},_trigger:function(t,e){e=e||0===e?e:void 0;var i=this.eventToCallbackMap[t];if(i&&i.length)for(var s=0;s<i.length;s++)(0,i[s])(e);P&&this._triggerJQueryEvent(t,e)},_triggerJQueryEvent:function(t,e){t={type:t,value:e};this.$element.trigger(t),this.$sliderElem.trigger(t)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.textContent?t.textContent=e:void 0!==t.innerText&&(t.innerText=e)},_removeClass:function(t,e){for(var i=e.split(" "),s=t.className,o=0;o<i.length;o++)var n=i[o],n=new RegExp("(?:\\s|^)"+n+"(?:\\s|$)"),s=s.replace(n," ");t.className=s.trim()},_addClass:function(t,e){for(var i=e.split(" "),s=t.className,o=0;o<i.length;o++){var n=i[o];new RegExp("(?:\\s|^)"+n+"(?:\\s|$)").test(s)||(s+=" "+n)}t.className=s.trim()},_offsetLeft:function(t){return t.getBoundingClientRect().left},_offsetRight:function(t){return t.getBoundingClientRect().right},_offsetTop:function(t){for(var e=t.offsetTop;(t=t.offsetParent)&&!isNaN(t.offsetTop);)e+=t.offsetTop,"BODY"!==t.tagName&&(e-=t.scrollTop);return e},_offset:function(t){return{left:this._offsetLeft(t),right:this._offsetRight(t),top:this._offsetTop(t)}},_css:function(t,e,i){P?P.style(t,e,i):(e=e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()}),t.style[e]=i)},_toValue:function(t){return this.options.scale.toValue.apply(this,[t])},_toPercentage:function(t){return this.options.scale.toPercentage.apply(this,[t])},_setTooltipPosition:function(){var e,i,t=[this.tooltip,this.tooltip_min,this.tooltip_max];"vertical"===this.options.orientation?(e=this.options.tooltip_position||(this.options.rtl?"left":"right"),i="left"===e?"right":"left",t.forEach(function(t){this._addClass(t,"bs-tooltip-"+e),t.style[i]="100%"}.bind(this))):"bottom"===this.options.tooltip_position?t.forEach(function(t){this._addClass(t,"bs-tooltip-bottom"),t.style.top="22px"}.bind(this)):t.forEach(function(t){this._addClass(t,"bs-tooltip-top"),t.style.top=-this.tooltip.outerHeight-14+"px"}.bind(this))},_getClosestTickIndex:function(t){for(var e=Math.abs(t-this.options.ticks[0]),i=0,s=0;s<this.options.ticks.length;++s){var o=Math.abs(t-this.options.ticks[s]);o<e&&(e=o,i=s)}return i},_setTickIndex:function(){this.ticksAreValid&&(this._state.tickIndex=[this.options.ticks.indexOf(this._state.value[0]),this.options.ticks.indexOf(this._state.value[1])])}},P&&P.fn&&(i=P.fn.slider?(windowIsDefined&&window.console.warn("bootstrap-slider.js - WARNING: $.fn.slider namespace is already bound. Use the $.fn.bootstrapSlider namespace instead."),n):(P.bridget(o,t),o),P.bridget(n,t),P(function(){P("input[data-provide=slider]")[i]()})),t});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).CodeMirror=t()}(this,function(){"use strict";var e=navigator.userAgent,s=navigator.platform,m=/gecko\/\d/i.test(e),t=/MSIE \d/.test(e),a=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),u=/Edge\/(\d+)/.exec(e),w=t||a||u,v=w&&(t?document.documentMode||6:+(u||a)[1]),x=!u&&/WebKit\//.test(e),t=x&&/Qt\/\d+\.\d+/.test(e),U=!u&&/Chrome\/(\d+)/.exec(e),V=U&&+U[1],K=/Opera\//.test(e),j=/Apple Computer/.test(navigator.vendor),c=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),X=/PhantomJS/.test(e),d=j&&(/Mobile\/\w+/.test(e)||2<navigator.maxTouchPoints),Y=/Android/.test(e),$=d||Y||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),C=d||/Mac/.test(s),_=/\bCrOS\b/.test(e),a=/win/i.test(s),u=K&&e.match(/Version\/(\d*\.\d*)/),q=((u=u&&Number(u[1]))&&15<=u&&(x=!(K=!1)),C&&(t||K&&(null==u||u<12.11))),Z=m||w&&9<=v;function Q(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var J=function(e,t){var n,r=e.className,t=Q(t).exec(r);t&&(n=r.slice(t.index+t[0].length),e.className=r.slice(0,t.index)+(n?t[1]+n:""))};function ee(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function y(e,t){return ee(e).appendChild(t)}function M(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function te(e,t,n,r){e=M(e,t,n,r);return e.setAttribute("role","presentation"),e}function ne(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if((t=11==t.nodeType?t.host:t)==e)return!0}while(t=t.parentNode)}function N(t){var n;try{n=t.activeElement}catch(e){n=t.body||null}for(;n&&n.shadowRoot&&n.shadowRoot.activeElement;)n=n.shadowRoot.activeElement;return n}function re(e,t){var n=e.className;Q(t).test(n)||(e.className+=(n?" ":"")+t)}function ie(e,t){for(var n=e.split(" "),r=0;r<n.length;r++)n[r]&&!Q(n[r]).test(t)&&(t+=" "+n[r]);return t}var oe=document.createRange?function(e,t,n,r){var i=document.createRange();return i.setEnd(r||e,n),i.setStart(e,t),i}:function(e,t,n){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch(e){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r},le=function(e){e.select()};function se(e){return e.display.wrapper.ownerDocument}function ae(e){return se(e).defaultView}function ue(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function ce(e,t,n){for(var r in t=t||{},e)!e.hasOwnProperty(r)||!1===n&&t.hasOwnProperty(r)||(t[r]=e[r]);return t}function he(e,t,n,r,i){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=r||0,l=i||0;;){var s=e.indexOf("\t",o);if(s<0||t<=s)return l+(t-o);l=(l+=s-o)+(n-l%n),o=s+1}}d?le=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:w&&(le=function(e){try{e.select()}catch(e){}});function de(){this.id=null,this.f=null,this.time=0,this.handler=ue(this.onTimeout,this)}function S(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}de.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)};var fe=50,pe={toString:function(){return"CodeMirror.Pass"}},ge={scroll:!(de.prototype.set=function(e,t){this.f=t;t=+new Date+e;(!this.id||t<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=t)})},me={origin:"*mouse"},ve={origin:"+move"};function ye(e,t,n){for(var r=0,i=0;;){var o=e.indexOf("\t",r),l=(o=-1==o?e.length:o)-r;if(o==e.length||t<=i+l)return r+Math.min(l,t-i);if(i+=o-r,r=o+1,t<=(i+=n-i%n))return r}}var be=[""];function we(e){for(;be.length<=e;)be.push(I(be)+" ");return be[e]}function I(e){return e[e.length-1]}function xe(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function Ce(){}function Se(e,t){e=Object.create?Object.create(e):(Ce.prototype=e,new Ce);return t&&ce(t,e),e}var Le=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function ke(e){return/\w/.test(e)||"Â"<e&&(e.toUpperCase()!=e.toLowerCase()||Le.test(e))}function Te(e,t){return t?!!(-1<t.source.indexOf("\\w")&&ke(e))||t.test(e):ke(e)}function Me(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return;return 1}var Ne=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Oe(e){return 768<=e.charCodeAt(0)&&Ne.test(e)}function Ae(e,t,n){for(;(n<0?0<t:t<e.length)&&Oe(e.charAt(t));)t+=n;return t}function De(e,t,n){for(var r=n<t?-1:1;;){if(t==n)return t;var i=(t+n)/2,i=r<0?Math.ceil(i):Math.floor(i);if(i==t)return e(i)?t:n;e(i)?n=i:t=i+r}}var We=null;function He(e,t,n){var r;We=null;for(var i=0;i<e.length;++i){var o=e[i];if(o.from<t&&o.to>t)return i;o.to==t&&(o.from!=o.to&&"before"==n?r=i:We=i),o.from==t&&(o.from!=o.to&&"before"!=n?r=i:We=i)}return null!=r?r:We}Fe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,Pe=/[stwN]/,Ee=/[LRr]/,ze=/[Lb1n]/,Ie=/[1n]/;var Fe,Pe,Ee,ze,Ie,Re=function(e,t){var n="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!Fe.test(e))return!1;for(var r,i=e.length,o=[],l=0;l<i;++l)o.push((r=e.charCodeAt(l))<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(r):1424<=r&&r<=1524?"R":1536<=r&&r<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(r-1536):1774<=r&&r<=2220?"r":8192<=r&&r<=8203?"w":8204==r?"b":"L");for(var s=0,a=n;s<i;++s){var u=o[s];"m"==u?o[s]=a:a=u}for(var c=0,h=n;c<i;++c){var d=o[c];"1"==d&&"r"==h?o[c]="n":Ee.test(d)&&"r"==(h=d)&&(o[c]="R")}for(var f=1,p=o[0];f<i-1;++f){var g=o[f];"+"==g&&"1"==p&&"1"==o[f+1]?o[f]="1":","!=g||p!=o[f+1]||"1"!=p&&"n"!=p||(o[f]=p),p=g}for(var m=0;m<i;++m){var v=o[m];if(","==v)o[m]="N";else if("%"==v){for(var y=void 0,y=m+1;y<i&&"%"==o[y];++y);for(var b=m&&"!"==o[m-1]||y<i&&"1"==o[y]?"1":"N",w=m;w<y;++w)o[w]=b;m=y-1}}for(var x=0,C=n;x<i;++x){var S=o[x];"L"==C&&"1"==S?o[x]="L":Ee.test(S)&&(C=S)}for(var L=0;L<i;++L)if(Pe.test(o[L])){for(var k=void 0,k=L+1;k<i&&Pe.test(o[k]);++k);for(var T="L"==(L?o[L-1]:n),M=T==("L"==(k<i?o[k]:n))?T?"L":"R":n,N=L;N<k;++N)o[N]=M;L=k-1}for(var O,A=[],D=0;D<i;)if(ze.test(o[D])){var E=D;for(++D;D<i&&ze.test(o[D]);++D);A.push(new Be(0,E,D))}else{var W=D,H=A.length,F="rtl"==t?1:0;for(++D;D<i&&"L"!=o[D];++D);for(var P=W;P<D;)if(Ie.test(o[P])){W<P&&(A.splice(H,0,new Be(1,W,P)),H+=F);var z=P;for(++P;P<D&&Ie.test(o[P]);++P);A.splice(H,0,new Be(2,z,P)),H+=F,W=P}else++P;W<D&&A.splice(H,0,new Be(1,W,D))}return"ltr"==t&&(1==A[0].level&&(O=e.match(/^\s+/))&&(A[0].from=O[0].length,A.unshift(new Be(0,0,O[0].length))),1==I(A).level)&&(O=e.match(/\s+$/))&&(I(A).to-=O[0].length,A.push(new Be(0,i-O[0].length,i))),"rtl"==t?A.reverse():A};function Be(e,t,n){this.level=e,this.from=t,this.to=n}function Ge(e,t){var n=e.order;return n=null==n?e.order=Re(e.text,t):n}var Ue=[],L=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):(e=e._handlers||(e._handlers={}))[t]=(e[t]||Ue).concat(n)};function Ve(e,t){return e._handlers&&e._handlers[t]||Ue}function k(e,t,n){var r;e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):(r=(e=e._handlers)&&e[t])&&-1<(n=S(r,n))&&(e[t]=r.slice(0,n).concat(r.slice(n+1)))}function O(e,t){var n=Ve(e,t);if(n.length)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function A(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),O(e,n||t.type,e,t),$e(t)||t.codemirrorIgnore}function Ke(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)-1==S(n,t[r])&&n.push(t[r])}function je(e,t){return 0<Ve(e,t).length}function Xe(e){e.prototype.on=function(e,t){L(this,e,t)},e.prototype.off=function(e,t){k(this,e,t)}}function T(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Ye(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function $e(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function _e(e){T(e),Ye(e)}function qe(e){return e.target||e.srcElement}function Ze(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),t=C&&e.ctrlKey&&1==t?3:t}var Qe,Je,et=!(w&&v<9)&&("draggable"in(s=M("div"))||"dragDrop"in s);var tt=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;t<=r;){var i=e.indexOf("\n",t),o=(-1==i&&(i=e.length),e.slice(t,"\r"==e.charAt(i-1)?i-1:i)),l=o.indexOf("\r");-1!=l?(n.push(o.slice(0,l)),t+=l+1):(n.push(o),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},nt=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},rt="oncopy"in(e=M("div"))||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy),it=null;var ot={},lt={};function st(e){if("string"==typeof e&&lt.hasOwnProperty(e))e=lt[e];else if(e&&"string"==typeof e.name&&lt.hasOwnProperty(e.name)){var t=lt[e.name];(e=Se(t="string"==typeof t?{name:t}:t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return st("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return st("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function at(e,t){t=st(t);var n=ot[t.name];if(!n)return at(e,"text/plain");var r=n(e,t);if(ut.hasOwnProperty(t.name)){var i,o=ut[t.name];for(i in o)o.hasOwnProperty(i)&&(r.hasOwnProperty(i)&&(r["_"+i]=r[i]),r[i]=o[i])}if(r.name=t.name,t.helperType&&(r.helperType=t.helperType),t.modeProps)for(var l in t.modeProps)r[l]=t.modeProps[l];return r}var ut={};function ct(e,t){ce(t,ut.hasOwnProperty(e)?ut[e]:ut[e]={})}function ht(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n,r={};for(n in t){var i=t[n];i instanceof Array&&(i=i.concat([])),r[n]=i}return r}function dt(e,t){for(var n;e.innerMode&&(n=e.innerMode(t))&&n.mode!=e;)t=n.state,e=n.mode;return n||{mode:e,state:t}}function ft(e,t,n){return!e.startState||e.startState(t,n)}var g=function(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};function D(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var r=0;;++r){var i=n.children[r],o=i.chunkSize();if(t<o){n=i;break}t-=o}return n.lines[t]}function pt(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){e=e.text;i==n.line&&(e=e.slice(0,n.ch)),i==t.line&&(e=e.slice(t.ch)),r.push(e),++i}),r}function gt(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function mt(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function W(e){if(null==e.parent)return null;for(var t=e.parent,n=S(t.lines,e),r=t.parent;r;r=(t=r).parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n+t.first}function vt(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],o=i.height;if(t<o){e=i;continue e}t-=o,n+=i.chunkSize()}return n}while(!e.lines);for(var l=0;l<e.lines.length;++l){var s=e.lines[l].height;if(t<s)break;t-=s}return n+l}function yt(e,t){return t>=e.first&&t<e.first+e.size}function bt(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function H(e,t,n){if(void 0===n&&(n=null),!(this instanceof H))return new H(e,t,n);this.line=e,this.ch=t,this.sticky=n}function F(e,t){return e.line-t.line||e.ch-t.ch}function wt(e,t){return e.sticky==t.sticky&&0==F(e,t)}function xt(e){return H(e.line,e.ch)}function Ct(e,t){return F(e,t)<0?t:e}function St(e,t){return F(e,t)<0?e:t}function Lt(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function P(e,t){var n;return t.line<e.first?H(e.first,0):(n=e.first+e.size-1,t.line>n?H(n,D(e,n).text.length):(e=D(e,(n=t).line).text.length,null==(t=n.ch)||e<t?H(n.line,e):t<0?H(n.line,0):n))}function kt(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=P(e,t[r]);return n}g.prototype.eol=function(){return this.pos>=this.string.length},g.prototype.sol=function(){return this.pos==this.lineStart},g.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},g.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},g.prototype.eat=function(e){var t=this.string.charAt(this.pos),e="string"==typeof e?t==e:t&&(e.test?e.test(t):e(t));if(e)return++this.pos,t},g.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},g.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},g.prototype.skipToEnd=function(){this.pos=this.string.length},g.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},g.prototype.backUp=function(e){this.pos-=e},g.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=he(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?he(this.string,this.lineStart,this.tabSize):0)},g.prototype.indentation=function(){return he(this.string,null,this.tabSize)-(this.lineStart?he(this.string,this.lineStart,this.tabSize):0)},g.prototype.match=function(e,t,n){var r;return"string"!=typeof e?(r=this.string.slice(this.pos).match(e))&&0<r.index?null:(r&&!1!==t&&(this.pos+=r[0].length),r):(r=function(e){return n?e.toLowerCase():e})(this.string.substr(this.pos,e.length))==r(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},g.prototype.current=function(){return this.string.slice(this.start,this.pos)},g.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},g.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},g.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function Tt(e,t){this.state=e,this.lookAhead=t}var Mt=function(e,t,n,r){this.state=t,this.doc=e,this.line=n,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1};function Nt(t,n,r,e){for(var a=[t.state.modeGen],i={},u=(zt(t,n.text,t.doc.mode,r,function(e,t){a.push(e,t)},i,e),r.state),o=0;o<t.state.overlays.length;++o)!function(e){r.baseTokens=a;var o=t.state.overlays[e],l=1,s=0;r.state=!0,zt(t,n.text,o.mode,r,function(e,t){for(var n=l;s<e;){var r=a[l];e<r&&a.splice(l,1,e,a[l+1],r),l+=2,s=Math.min(e,r)}if(t)if(o.opaque)a.splice(n,l-n,e,"overlay "+t),l=n+2;else for(;n<l;n+=2){var i=a[n+1];a[n+1]=(i?i+" ":"")+"overlay "+t}},i),r.state=u,r.baseTokens=null,r.baseTokenPos=1}(o);return{styles:a,classes:i.bgClass||i.textClass?i:null}}function Ot(e,t,n){var r,i,o;return t.styles&&t.styles[0]==e.state.modeGen||(r=At(e,W(t)),i=t.text.length>e.options.maxHighlightLength&&ht(e.doc.mode,r.state),o=Nt(e,t,r),i&&(r.state=i),t.stateAfter=r.save(!i),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))),t.styles}function At(n,r,e){var t,i,o,l=n.doc,s=n.display;return l.mode.startState?(i=(t=function(e,t,n){for(var r,i,o=e.doc,l=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;l<s;--s){if(s<=o.first)return o.first;var a=D(o,s-1),u=a.stateAfter;if(u&&(!n||s+(u instanceof Tt?u.lookAhead:0)<=o.modeFrontier))return s;u=he(a.text,null,e.options.tabSize);(null==i||u<r)&&(i=s-1,r=u)}return i}(n,r,e))>l.first&&D(l,t-1).stateAfter,o=i?Mt.fromSaved(l,i,t):new Mt(l,ft(l.mode),t),l.iter(t,r,function(e){Dt(n,e.text,o);var t=o.line;e.stateAfter=t==r-1||t%5==0||t>=s.viewFrom&&t<s.viewTo?o.save():null,o.nextLine()}),e&&(l.modeFrontier=o.line),o):new Mt(l,!0,r)}function Dt(e,t,n,r){var i=e.doc.mode,o=new g(t,e.options.tabSize,n);for(o.start=o.pos=r||0,""==t&&Wt(i,n.state);!o.eol();)Ht(i,o,n.state),o.start=o.pos}function Wt(e,t){return e.blankLine?e.blankLine(t):e.innerMode&&(e=dt(e,t)).mode.blankLine?e.mode.blankLine(e.state):void 0}function Ht(e,t,n,r){for(var i=0;i<10;i++){r&&(r[0]=dt(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}Mt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},Mt.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},Mt.prototype.nextLine=function(){this.line++,0<this.maxLookAhead&&this.maxLookAhead--},Mt.fromSaved=function(e,t,n){return t instanceof Tt?new Mt(e,ht(e.mode,t.state),n,t.lookAhead):new Mt(e,ht(e.mode,t),n)},Mt.prototype.save=function(e){e=!1!==e?ht(this.doc.mode,this.state):this.state;return 0<this.maxLookAhead?new Tt(e,this.maxLookAhead):e};var Ft=function(e,t,n){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=n};function Pt(e,t,n,r){var i,o,l=e.doc,s=l.mode,a=D(l,(t=P(l,t)).line),u=At(e,t.line,n),c=new g(a.text,e.options.tabSize,u);for(r&&(o=[]);(r||c.pos<t.ch)&&!c.eol();)c.start=c.pos,i=Ht(s,c,u.state),r&&o.push(new Ft(c,i,ht(l.mode,u.state)));return r?o:new Ft(c,i,u.state)}function Et(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==t[r]?t[r]=n[2]:new RegExp("(?:^|\\s)"+n[2]+"(?:$|\\s)").test(t[r])||(t[r]+=" "+n[2])}return e}function zt(e,t,n,r,i,o,l){var s=n.flattenSpans,a=(null==s&&(s=e.options.flattenSpans),0),u=null,c=new g(t,e.options.tabSize,r),h=e.options.addModeClass&&[null];for(""==t&&Et(Wt(n,r.state),o);!c.eol();){var d,f=c.pos>e.options.maxHighlightLength?(s=!1,l&&Dt(e,t,r,c.pos),c.pos=t.length,null):Et(Ht(n,c,r.state,h),o);if(h&&(d=h[0].name)&&(f="m-"+(f?d+" "+f:d)),!s||u!=f){for(;a<c.start;)i(a=Math.min(c.start,a+5e3),u);u=f}c.start=c.pos}for(;a<c.pos;){var p=Math.min(c.pos,a+5e3);i(p,u),a=p}}var It=!1,Rt=!1;function Bt(e,t,n){this.marker=e,this.from=t,this.to=n}function Gt(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Ut(e,t){if(t.full)return null;var n=yt(e,t.from.line)&&D(e,t.from.line).markedSpans,e=yt(e,t.to.line)&&D(e,t.to.line).markedSpans;if(!n&&!e)return null;var r=t.from.ch,i=t.to.ch,o=0==F(t.from,t.to),l=function(e,t,n){var r;if(e)for(var i=0;i<e.length;++i){var o,l=e[i],s=l.marker;!(null==l.from||(s.inclusiveLeft?l.from<=t:l.from<t))&&(l.from!=t||"bookmark"!=s.type||n&&l.marker.insertLeft)||(o=null==l.to||(s.inclusiveRight?l.to>=t:l.to>t),(r=r||[]).push(new Bt(s,l.from,o?null:l.to)))}return r}(n,r,o),s=function(e,t,n){var r;if(e)for(var i=0;i<e.length;++i){var o,l=e[i],s=l.marker;!(null==l.to||(s.inclusiveRight?l.to>=t:l.to>t))&&(l.from!=t||"bookmark"!=s.type||n&&!l.marker.insertLeft)||(o=null==l.from||(s.inclusiveLeft?l.from<=t:l.from<t),(r=r||[]).push(new Bt(s,o?null:l.from-t,null==l.to?null:l.to-t)))}return r}(e,i,o),a=1==t.text.length,u=I(t.text).length+(a?r:0);if(l)for(var c=0;c<l.length;++c){var h,d=l[c];null==d.to&&((h=Gt(s,d.marker))?a&&(d.to=null==h.to?null:h.to+u):d.to=r)}if(s)for(var f=0;f<s.length;++f){var p=s[f];null!=p.to&&(p.to+=u),null==p.from?Gt(l,p.marker)||(p.from=u,a&&(l=l||[]).push(p)):(p.from+=u,a&&(l=l||[]).push(p))}l=l&&Vt(l),s&&s!=l&&(s=Vt(s));var g=[l];if(!a){var m,v=t.text.length-2;if(0<v&&l)for(var y=0;y<l.length;++y)null==l[y].to&&(m=m||[]).push(new Bt(l[y].marker,null,null));for(var b=0;b<v;++b)g.push(m);g.push(s)}return g}function Vt(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function Kt(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function jt(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Xt(e){return e.inclusiveLeft?-1:0}function Yt(e){return e.inclusiveRight?1:0}function $t(e,t){var n,r,i=e.lines.length-t.lines.length;return 0!=i?i:(i=e.find(),n=t.find(),(r=F(i.from,n.from)||Xt(e)-Xt(t))?-r:F(i.to,n.to)||Yt(e)-Yt(t)||t.id-e.id)}function _t(e,t){var n,r=Rt&&e.markedSpans;if(r)for(var i,o=0;o<r.length;++o)(i=r[o]).marker.collapsed&&null==(t?i.from:i.to)&&(!n||$t(n,i.marker)<0)&&(n=i.marker);return n}function qt(e){return _t(e,!0)}function Zt(e){return _t(e,!1)}function Qt(e,t,n,r,i){var e=D(e,t),o=Rt&&e.markedSpans;if(o)for(var l=0;l<o.length;++l){var s=o[l];if(s.marker.collapsed){var a=s.marker.find(0),u=F(a.from,n)||Xt(s.marker)-Xt(i),c=F(a.to,r)||Yt(s.marker)-Yt(i);if(!(0<=u&&c<=0||u<=0&&0<=c)&&(u<=0&&(s.marker.inclusiveRight&&i.inclusiveLeft?0<=F(a.to,n):0<F(a.to,n))||0<=u&&(s.marker.inclusiveRight&&i.inclusiveLeft?F(a.from,r)<=0:F(a.from,r)<0)))return 1}}}function Jt(e){for(var t;t=qt(e);)e=t.find(-1,!0).line;return e}function en(e,t){var e=D(e,t),n=Jt(e);return e==n?t:W(n)}function tn(e,t){if(t>e.lastLine())return t;var n,r=D(e,t);if(!nn(e,r))return t;for(;n=Zt(r);)r=n.find(1,!0).line;return W(r)+1}function nn(e,t){var n=Rt&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if((r=n[i]).marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&function e(t,n,r){{var i;if(null==r.to)return i=r.marker.find(1,!0),e(t,i.line,Gt(i.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==n.text.length)return!0;for(var o=void 0,l=0;l<n.markedSpans.length;++l)if((o=n.markedSpans[l]).marker.collapsed&&!o.marker.widgetNode&&o.from==r.to&&(null==o.to||o.to!=r.from)&&(o.marker.inclusiveLeft||r.marker.inclusiveRight)&&e(t,n,o))return!0}(e,t,r))return!0}}function rn(e){for(var t=0,n=(e=Jt(e)).parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var o=n.parent;o;o=(n=o).parent)for(var l=0;l<o.children.length;++l){var s=o.children[l];if(s==n)break;t+=s.height}return t}function on(e){if(0==e.height)return 0;for(var t,n=e.text.length,r=e;t=qt(r);){var i=t.find(0,!0),r=i.from.line;n+=i.from.ch-i.to.ch}for(r=e;t=Zt(r);)var o=t.find(0,!0),n=(n-=r.text.length-o.from.ch)+((r=o.to.line).text.length-o.to.ch);return n}function ln(e){var n=e.display,e=e.doc;n.maxLine=D(e,e.first),n.maxLineLength=on(n.maxLine),n.maxLineChanged=!0,e.iter(function(e){var t=on(e);t>n.maxLineLength&&(n.maxLineLength=t,n.maxLine=e)})}var sn=function(e,t,n){this.text=e,jt(this,t),this.height=n?n(this):1};sn.prototype.lineNo=function(){return W(this)},Xe(sn);var an={},un={};function cn(e,t){return!e||/^\s*$/.test(e)?null:(t=t.addModeClass?un:an)[e]||(t[e]=e.replace(/\S+/g,"cm-$&"))}function hn(e,t){var n=te("span",null,null,x?"padding-right: .1px":null),r={pre:te("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i,o,l=0;l<=(t.rest?t.rest.length:0);l++){var s=l?t.rest[l-1]:t.line,a=void 0,u=(r.pos=0,r.addToken=fn,u=e.display.measure,o=i=void 0,(null!=Je?Je:(o=y(u,document.createTextNode("AØ®A")),i=oe(o,0,1).getBoundingClientRect(),o=oe(o,1,2).getBoundingClientRect(),ee(u),i&&i.left!=i.right&&(Je=o.right-i.right<3)))&&(a=Ge(s,e.doc.direction))&&(r.addToken=function(h,d){return function(e,t,n,r,i,o,l){n=n?n+" cm-force-border":"cm-force-border";for(var s=e.pos,a=s+t.length;;){for(var u=void 0,c=0;c<d.length&&!((u=d[c]).to>s&&u.from<=s);c++);if(u.to>=a)return h(e,t,n,r,i,o,l);h(e,t.slice(0,u.to-s),n,r,null,o,l),r=null,t=t.slice(u.to-s),s=u.to}}}(r.addToken,a)),r.map=[],t!=e.display.externalMeasured&&W(s));!function(e,t,n){var r=e.markedSpans,i=e.text,o=0;if(r)for(var l,s,a,u,c,h,d,f=i.length,p=0,g=1,m="",v=0;;){if(v==p){a=u=c=s="",h=d=null,v=1/0;for(var y=[],b=void 0,w=0;w<r.length;++w){var x=r[w],C=x.marker;if("bookmark"==C.type&&x.from==p&&C.widgetNode)y.push(C);else if(x.from<=p&&(null==x.to||x.to>p||C.collapsed&&x.to==p&&x.from==p)){if(null!=x.to&&x.to!=p&&v>x.to&&(v=x.to,u=""),C.className&&(a+=" "+C.className),C.css&&(s=(s?s+";":"")+C.css),C.startStyle&&x.from==p&&(c+=" "+C.startStyle),C.endStyle&&x.to==v&&(b=b||[]).push(C.endStyle,x.to),C.title&&((d=d||{}).title=C.title),C.attributes)for(var S in C.attributes)(d=d||{})[S]=C.attributes[S];C.collapsed&&(!h||$t(h.marker,C)<0)&&(h=x)}else x.from>p&&v>x.from&&(v=x.from)}if(b)for(var L=0;L<b.length;L+=2)b[L+1]==v&&(u+=" "+b[L]);if(!h||h.from==p)for(var k=0;k<y.length;++k)pn(t,0,y[k]);if(h&&(h.from||0)==p){if(pn(t,(null==h.to?f+1:h.to)-p,h.marker,null==h.from),null==h.to)return;h.to==p&&(h=!1)}}if(f<=p)break;for(var T=Math.min(f,v);;){if(m){var M,N=p+m.length;if(h||(M=T<N?m.slice(0,T-p):m,t.addToken(t,M,l?l+a:a,c,p+M.length==v?u:"",s,d)),T<=N){m=m.slice(T-p),p=T;break}p=N,c=""}m=i.slice(o,o=n[g++]),l=cn(n[g++],t.cm.options)}}else for(var O=1;O<n.length;O+=2)t.addToken(t,i.slice(o,o=n[O]),cn(n[O+1],t.cm.options))}(s,r,Ot(e,s,u)),s.styleClasses&&(s.styleClasses.bgClass&&(r.bgClass=ie(s.styleClasses.bgClass,r.bgClass||"")),s.styleClasses.textClass)&&(r.textClass=ie(s.styleClasses.textClass,r.textClass||"")),0==r.map.length&&r.map.push(0,0,r.content.appendChild((o=e.display.measure,i=void 0,(o=(Qe=null==Qe&&(i=M("span","â"),y(o,M("span",[i,document.createTextNode("x")])),0!=o.firstChild.offsetHeight)?i.offsetWidth<=1&&2<i.offsetHeight&&!(w&&v<8):Qe)?M("span","â"):M("span","Â ",null,"display: inline-block; width: 1px; margin-right: -1px")).setAttribute("cm-text",""),o))),0==l?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return x&&(n=r.content.lastChild,/\bcm-tab\b/.test(n.className)||n.querySelector&&n.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack"),O(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=ie(r.pre.className,r.textClass||"")),r}function dn(e){var t=M("span","â¢","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function fn(e,t,n,r,i,o,l){if(t){var s=e.splitSpaces?function(e,t){if(1<e.length&&!/  /.test(e))return e;for(var n=t,r="",i=0;i<e.length;i++){var o=e.charAt(i);" "!=o||!n||i!=e.length-1&&32!=e.charCodeAt(i+1)||(o="Â "),r+=o,n=" "==o}return r}(t,e.trailingSpace):t,a=e.cm.state.specialChars,u=!1;if(a.test(t))for(var c=document.createDocumentFragment(),h=0;;){a.lastIndex=h;var d=a.exec(t),f=d?d.index-h:t.length-h;if(f&&(p=document.createTextNode(s.slice(h,h+f)),w&&v<9?c.appendChild(M("span",[p])):c.appendChild(p),e.map.push(e.pos,e.pos+f,p),e.col+=f,e.pos+=f),!d)break;h+=1+f;var p=void 0;"\t"==d[0]?(f=(f=e.cm.options.tabSize)-e.col%f,(p=c.appendChild(M("span",we(f),"cm-tab"))).setAttribute("role","presentation"),p.setAttribute("cm-text","\t"),e.col+=f):("\r"==d[0]||"\n"==d[0]?(p=c.appendChild(M("span","\r"==d[0]?"â":"â¤","cm-invalidchar"))).setAttribute("cm-text",d[0]):((p=e.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),w&&v<9?c.appendChild(M("span",[p])):c.appendChild(p)),e.col+=1),e.map.push(e.pos,e.pos+1,p),e.pos++}else e.col+=t.length,c=document.createTextNode(s),e.map.push(e.pos,e.pos+t.length,c),w&&v<9&&(u=!0),e.pos+=t.length;if(e.trailingSpace=32==s.charCodeAt(t.length-1),n||r||i||u||o||l){var u=n||"",g=(r&&(u+=r),i&&(u+=i),M("span",[c],u,o));if(l)for(var m in l)l.hasOwnProperty(m)&&"style"!=m&&"class"!=m&&g.setAttribute(m,l[m]);return e.content.appendChild(g)}e.content.appendChild(c)}}function pn(e,t,n,r){var i=!r&&n.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!r&&e.cm.display.input.needsContentAttribute&&(i=i||e.content.appendChild(document.createElement("span"))).setAttribute("cm-marker",n.id),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t,e.trailingSpace=!1}function gn(e,t,n){this.line=t,this.rest=function(e){for(var t,n;t=Zt(e);)e=t.find(1,!0).line,(n=n||[]).push(e);return n}(t),this.size=this.rest?W(I(this.rest))-n+1:1,this.node=this.text=null,this.hidden=nn(e,t)}function mn(e,t,n){for(var r=[],i=t;i<n;i=l){var o=new gn(e.doc,D(e.doc,i),i),l=i+o.size;r.push(o)}return r}var vn=null;var yn=null;function b(e,t){var n=Ve(e,t);if(n.length)for(var r,i=Array.prototype.slice.call(arguments,2),o=(vn?r=vn.delayedCallbacks:yn?r=yn:(r=yn=[],setTimeout(bn,0)),0);o<n.length;++o)!function(e){r.push(function(){return n[e].apply(null,i)})}(o)}function bn(){var e=yn;yn=null;for(var t=0;t<e.length;++t)e[t]()}function wn(e,t,n,r){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];if("text"==o){u=a=s=l=void 0;var l=e,s=t,a=s.text.className,u=Cn(l,s);s.text==s.node&&(s.node=u.pre),s.text.parentNode.replaceChild(u.pre,s.text),s.text=u.pre,u.bgClass!=s.bgClass||u.textClass!=s.textClass?(s.bgClass=u.bgClass,s.textClass=u.textClass,Sn(l,s)):a&&(s.text.className=a)}else if("gutter"==o)Ln(e,t,n,r);else if("class"==o)Sn(e,t);else if("widget"==o){f=d=h=l=c=u=void 0;var u=e,c=t,l=r;c.alignable&&(c.alignable=null);for(var h=Q("CodeMirror-linewidget"),d=c.node.firstChild,f=void 0;d;d=f)f=d.nextSibling,h.test(d.className)&&c.node.removeChild(d);kn(u,c,l)}}t.changes=null}function xn(e){return e.node==e.text&&(e.node=M("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),w)&&v<8&&(e.node.style.zIndex=2),e.node}function Cn(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):hn(e,t)}function Sn(e,t){e=e,(i=(n=t).bgClass?n.bgClass+" "+(n.line.bgClass||""):n.line.bgClass)&&(i+=" CodeMirror-linebackground"),n.background?i?n.background.className=i:(n.background.parentNode.removeChild(n.background),n.background=null):i&&(r=xn(n),n.background=r.insertBefore(M("div",null,i),r.firstChild),e.display.input.setUneditable(n.background)),t.line.wrapClass?xn(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var n,r,i=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=i||""}function Ln(e,t,n,r){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass&&(o=xn(t),t.gutterBackground=M("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),o.insertBefore(t.gutterBackground,t.text));var i=t.line.gutterMarkers;if(e.options.lineNumbers||i){var o=xn(t),l=t.gutter=M("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(l.setAttribute("aria-hidden","true"),e.display.input.setUneditable(l),o.insertBefore(l,t.text),t.line.gutterClass&&(l.className+=" "+t.line.gutterClass),!e.options.lineNumbers||i&&i["CodeMirror-linenumbers"]||(t.lineNumber=l.appendChild(M("div",bt(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),i)for(var s=0;s<e.display.gutterSpecs.length;++s){var a=e.display.gutterSpecs[s].className,u=i.hasOwnProperty(a)&&i[a];u&&l.appendChild(M("div",[u],"CodeMirror-gutter-elt","left: "+r.gutterLeft[a]+"px; width: "+r.gutterWidth[a]+"px"))}}}function kn(e,t,n){if(Tn(e,t.line,t,n,!0),t.rest)for(var r=0;r<t.rest.length;r++)Tn(e,t.rest[r],t,n,!1)}function Tn(e,t,n,r,i){if(t.widgets)for(var o=xn(n),l=0,s=t.widgets;l<s.length;++l){var a=s[l],u=M("div",[a.node],"CodeMirror-linewidget"+(a.className?" "+a.className:"")),c=(a.handleMouseEvents||u.setAttribute("cm-ignore-events","true"),f=d=h=c=void 0,a),h=u,d=n,f=r;c.noHScroll&&((d.alignable||(d.alignable=[])).push(h),d=f.wrapperWidth,h.style.left=f.fixedPos+"px",c.coverGutter||(d-=f.gutterTotalWidth,h.style.paddingLeft=f.gutterTotalWidth+"px"),h.style.width=d+"px"),c.coverGutter&&(h.style.zIndex=5,h.style.position="relative",c.noHScroll||(h.style.marginLeft=-f.gutterTotalWidth+"px")),e.display.input.setUneditable(u),i&&a.above?o.insertBefore(u,n.gutter||n.text):o.appendChild(u),b(a,"redraw")}}function Mn(e){var t,n;return null!=e.height?e.height:(t=e.doc.cm)?(ne(document.body,e.node)||(n="position: relative;",e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),y(t.display.measure,M("div",[e.node],null,n))),e.height=e.node.parentNode.offsetHeight):0}function Nn(e,t){for(var n=qe(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return 1}function On(e){return e.lineSpace.offsetTop}function An(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Dn(e){var t;return e.cachedPaddingH||(t=y(e.measure,M("pre","x","CodeMirror-line-like")),t=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,t={left:parseInt(t.paddingLeft),right:parseInt(t.paddingRight)},isNaN(t.left)||isNaN(t.right)||(e.cachedPaddingH=t),t)}function Wn(e){return fe-e.display.nativeBarWidth}function Hn(e){return e.display.scroller.clientWidth-Wn(e)-e.display.barWidth}function Fn(e){return e.display.scroller.clientHeight-Wn(e)-e.display.barHeight}function Pn(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var i=0;i<e.rest.length;i++)if(W(e.rest[i])>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}}function En(e,t,n,r){return Rn(e,In(e,t),n,r)}function zn(e,t){return t>=e.display.viewFrom&&t<e.display.viewTo?e.display.view[pr(e,t)]:(e=e.display.externalMeasured)&&t>=e.lineN&&t<e.lineN+e.size?e:void 0}function In(e,t){var n,r,i=W(t),o=zn(e,i),e=(o&&!o.text?o=null:o&&o.changes&&(wn(e,o,i,ur(e)),e.curOp.forceUpdate=!0),o||(e=e,r=W(n=Jt(n=t)),(n=e.display.externalMeasured=new gn(e.doc,n,r)).lineN=r,r=n.built=hn(e,n),n.text=r.pre,y(e.display.lineMeasure,r.pre),o=n),Pn(o,t,i));return{line:t,view:o,rect:null,map:e.map,cache:e.cache,before:e.before,hasHeights:!1}}function Rn(e,t,n,r,i){var o,l=(n=t.before?-1:n)+(r||"");if(t.cache.hasOwnProperty(l))o=t.cache[l];else{if(t.rect||(t.rect=t.view.text.getBoundingClientRect()),!t.hasHeights){var s=e,a=t.view,u=t.rect,c=s.options.lineWrapping,s=c&&Hn(s);if(!a.measure.heights||c&&a.measure.width!=s){var h=a.measure.heights=[];if(c){a.measure.width=s;for(var d=a.text.firstChild.getClientRects(),f=0;f<d.length-1;f++){var p=d[f],g=d[f+1];2<Math.abs(p.bottom-g.bottom)&&h.push((p.bottom+g.top)/2-u.top)}}h.push(u.bottom-u.top)}t.hasHeights=!0}(o=function(e,t,n,r){var i,o=Un(t.map,n,r),l=o.node,s=o.start,a=o.end,u=o.collapse;if(3==l.nodeType){for(var c=0;c<4;c++){for(;s&&Oe(t.line.text.charAt(o.coverStart+s));)--s;for(;o.coverStart+a<o.coverEnd&&Oe(t.line.text.charAt(o.coverStart+a));)++a;if((i=w&&v<9&&0==s&&a==o.coverEnd-o.coverStart?l.parentNode.getBoundingClientRect():function(e,t){var n=Gn;if("left"==t)for(var r=0;r<e.length&&(n=e[r]).left==n.right;r++);else for(var i=e.length-1;0<=i&&(n=e[i]).left==n.right;i--);return n}(oe(l,s,a).getClientRects(),r)).left||i.right||0==s)break;a=s,s-=1,u="right"}w&&v<11&&(i=function(e,t){var n;return window.screen&&null!=screen.logicalXDPI&&screen.logicalXDPI!=screen.deviceXDPI&&function(e){var t;return null!=it?it:(t=(e=y(e,M("span","x"))).getBoundingClientRect(),e=oe(e,0,1).getBoundingClientRect(),it=1<Math.abs(t.left-e.left))}(e)?(e=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI,{left:t.left*e,right:t.right*e,top:t.top*n,bottom:t.bottom*n}):t}(e.display.measure,i))}else 0<s&&(u=r="right"),i=e.options.lineWrapping&&1<(n=l.getClientRects()).length?n["right"==r?n.length-1:0]:l.getBoundingClientRect();!(w&&v<9)||s||i&&(i.left||i.right)||(n=l.parentNode.getClientRects()[0],i=n?{left:n.left,right:n.left+ar(e.display),top:n.top,bottom:n.bottom}:Gn);for(var n=i.top-t.rect.top,h=i.bottom-t.rect.top,d=(n+h)/2,f=t.view.measure.heights,p=0;p<f.length-1&&!(d<f[p]);p++);var g=p?f[p-1]:0,m=f[p],g={left:("right"==u?i.right:i.left)-t.rect.left,right:("left"==u?i.left:i.right)-t.rect.left,top:g,bottom:m};i.left||i.right||(g.bogus=!0);e.options.singleCursorHeightPerLine||(g.rtop=n,g.rbottom=h);return g}(e,t,n,r)).bogus||(t.cache[l]=o)}return{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}var Bn,Gn={left:0,right:0,top:0,bottom:0};function Un(e,t,n){for(var r,i,o,l,s,a,u=0;u<e.length;u+=3)if(s=e[u],a=e[u+1],t<s?(i=0,o=1,l="left"):t<a?o=(i=t-s)+1:(u==e.length-3||t==a&&e[u+3]>t)&&(i=(o=a-s)-1,a<=t)&&(l="right"),null!=i){if(r=e[u+2],s==a&&n==(r.insertLeft?"left":"right")&&(l=n),"left"==n&&0==i)for(;u&&e[u-2]==e[u-3]&&e[u-1].insertLeft;)r=e[2+(u-=3)],l="left";if("right"==n&&i==a-s)for(;u<e.length-3&&e[u+3]==e[u+4]&&!e[u+5].insertLeft;)r=e[(u+=3)+2],l="right";break}return{node:r,start:i,end:o,collapse:l,coverStart:s,coverEnd:a}}function Vn(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Kn(e){e.display.externalMeasure=null,ee(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Vn(e.display.view[t])}function jn(e){Kn(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Xn(e){return U&&Y?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function Yn(e){return U&&Y?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function $n(e){var t=Jt(e).widgets,n=0;if(t)for(var r=0;r<t.length;++r)t[r].above&&(n+=Mn(t[r]));return n}function _n(e,t,n,r,i){return i||(i=$n(t),n.top+=i,n.bottom+=i),"line"!=r&&(r=r||"local",i=rn(t),"local"==r?i+=On(e.display):i-=e.display.viewOffset,"page"!=r&&"window"!=r||(i+=(t=e.display.lineSpace.getBoundingClientRect()).top+("window"==r?0:Yn(se(e))),t=t.left+("window"==r?0:Xn(se(e))),n.left+=t,n.right+=t),n.top+=i,n.bottom+=i),n}function qn(e,t,n){var r;return"div"==n?t:(r=t.left,t=t.top,"page"==n?(r-=Xn(se(e)),t-=Yn(se(e))):"local"!=n&&n||(r+=(n=e.display.sizer.getBoundingClientRect()).left,t+=n.top),{left:r-(n=e.display.lineSpace.getBoundingClientRect()).left,top:t-n.top})}function Zn(e,t,n,r,i){return _n(e,r=r||D(e.doc,t.line),En(e,r,t.ch,i),n)}function Qn(n,e,r,i,o,l){function s(e,t){e=Rn(n,o,e,t?"right":"left",l);return t?e.left=e.right:e.right=e.left,_n(n,i,e,r)}i=i||D(n.doc,e.line),o=o||In(n,i);var t,a,u=Ge(i,n.doc.direction),c=e.ch,e=e.sticky;return c>=i.text.length?(c=i.text.length,e="before"):c<=0&&(c=0,e="after"),u?(a=He(u,c,e),t=We,a=h(c,a,"before"==e),null!=t&&(a.other=h(c,t,"before"!=e)),a):s("before"==e?c-1:c,"before"==e);function h(e,t,n){return s(n?e-1:e,1==u[t].level!=n)}}function Jn(e,t){var n=0,t=(t=P(e.doc,t),e.options.lineWrapping||(n=ar(e.display)*t.ch),D(e.doc,t.line)),e=rn(t)+On(e.display);return{left:n,right:n,top:e,bottom:e+t.height}}function er(e,t,n,r,i){e=H(e,t,n);return e.xRel=i,r&&(e.outside=r),e}function tr(e,t,n){var r=e.doc;if((n+=e.display.viewOffset)<0)return er(r.first,0,null,-1,-1);var i=vt(r,n),o=r.first+r.size-1;if(o<i)return er(r.first+r.size-1,D(r,o).text.length,null,1,1);t<0&&(t=0);for(var l=D(r,i);;){var s=function(n,e,t,r,i){i-=rn(e);var o=In(n,e),l=$n(e),s=0,a=e.text.length,u=!0,c=Ge(e,n.doc.direction);c&&(c=(n.options.lineWrapping?lr:or)(n,e,t,o,c,r,i),u=1!=c.level,s=u?c.from:c.to-1,a=u?c.to:c.from-1);var h=null,d=null,c=De(function(e){var t=Rn(n,o,e);return t.top+=l,t.bottom+=l,ir(t,r,i,!1)&&(t.top<=i&&t.left<=r&&(h=e,d=t),1)},s,a),f=!1;{var p,g;d?(p=r-d.left<d.right-r,c=h+((g=p==u)?0:1),g=g?"after":"before",p=p?d.left:d.right):(u||c!=a&&c!=s||c++,g=0==c||c!=e.text.length&&Rn(n,o,c-(u?1:0)).bottom+l<=i==u?"after":"before",a=Qn(n,H(t,c,g),"line",e,o),p=a.left,f=i<a.top?-1:i>=a.bottom?1:0)}return c=Ae(e.text,c,1),er(t,c,g,f,r-p)}(e,l,i,t,n),a=function(e,t){var n,r=Rt&&e.markedSpans;if(r)for(var i=0;i<r.length;++i){var o=r[i];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!n||$t(n,o.marker)<0)&&(n=o.marker)}return n}(l,s.ch+(0<s.xRel||0<s.outside?1:0));if(!a)return s;s=a.find(1);if(s.line==i)return s;l=D(r,i=s.line)}}function nr(t,e,n,r){r-=$n(e);var e=e.text.length,i=De(function(e){return Rn(t,n,e-1).bottom<=r},e,0);return{begin:i,end:De(function(e){return Rn(t,n,e).top>r},i,e)}}function rr(e,t,n,r){return nr(e,t,n=n||In(e,t),_n(e,t,Rn(e,n,r),"line").top)}function ir(e,t,n,r){return!(e.bottom<=n)&&(e.top>n||(r?e.left:e.right)>t)}function or(n,r,i,o,l,s,a){var e,t=De(function(e){var e=l[e],t=1!=e.level;return ir(Qn(n,H(i,t?e.to:e.from,t?"before":"after"),"line",r,o),s,a,!0)},0,l.length-1),u=l[t];return u=0<t&&(e=1!=u.level,ir(e=Qn(n,H(i,e?u.from:u.to,e?"after":"before"),"line",r,o),s,a,!0))&&e.top>a?l[t-1]:u}function lr(e,t,n,r,i,o,l){for(var l=nr(e,t,r,l),s=l.begin,a=l.end,u=(/\s/.test(t.text.charAt(a-1))&&a--,null),c=null,h=0;h<i.length;h++){var d,f=i[h];f.from>=a||f.to<=s||(d=(d=Rn(e,r,1!=f.level?Math.min(a,f.to)-1:Math.max(s,f.from)).right)<o?o-d+1e9:d-o,(!u||d<c)&&(u=f,c=d))}return u=(u=(u=u||i[i.length-1]).from<s?{from:s,to:u.to,level:u.level}:u).to>a?{from:u.from,to:a,level:u.level}:u}function sr(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Bn){Bn=M("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)Bn.appendChild(document.createTextNode("x")),Bn.appendChild(M("br"));Bn.appendChild(document.createTextNode("x"))}y(e.measure,Bn);var n=Bn.offsetHeight/50;return 3<n&&(e.cachedTextHeight=n),ee(e.measure),n||1}function ar(e){var t,n;return null!=e.cachedCharWidth?e.cachedCharWidth:(n=M("span","xxxxxxxxxx"),t=M("pre",[n],"CodeMirror-line-like"),y(e.measure,t),2<(n=((t=n.getBoundingClientRect()).right-t.left)/10)&&(e.cachedCharWidth=n),n||10)}function ur(e){for(var t=e.display,n={},r={},i=t.gutters.clientLeft,o=t.gutters.firstChild,l=0;o;o=o.nextSibling,++l){var s=e.display.gutterSpecs[l].className;n[s]=o.offsetLeft+o.clientLeft+i,r[s]=o.clientWidth}return{fixedPos:cr(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function cr(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function hr(r){var i=sr(r.display),o=r.options.lineWrapping,l=o&&Math.max(5,r.display.scroller.clientWidth/ar(r.display)-3);return function(e){if(nn(r.doc,e))return 0;var t=0;if(e.widgets)for(var n=0;n<e.widgets.length;n++)e.widgets[n].height&&(t+=e.widgets[n].height);return o?t+(Math.ceil(e.text.length/l)||1)*i:t+i}}function dr(e){var t=e.doc,n=hr(e);t.iter(function(e){var t=n(e);t!=e.height&&mt(e,t)})}function fr(e,t,n,r){var i=e.display;if(!n&&"true"==qe(t).getAttribute("cm-not-content"))return null;var o,l,n=i.lineSpace.getBoundingClientRect();try{o=t.clientX-n.left,l=t.clientY-n.top}catch(e){return null}i=tr(e,o,l);return r&&0<i.xRel&&(t=D(e.doc,i.line).text).length==i.ch&&(n=he(t,t.length,e.options.tabSize)-t.length,i=H(i.line,Math.max(0,Math.round((o-Dn(e.display).left)/ar(e.display))-n))),i}function pr(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,r=0;r<n.length;r++)if((t-=n[r].size)<0)return r}function E(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size);var i,o=e.display,l=((r=r||0)&&n<o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>t)&&(o.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=o.viewTo?Rt&&en(e.doc,t)<o.viewTo&&mr(e):n<=o.viewFrom?Rt&&tn(e.doc,n+r)>o.viewFrom?mr(e):(o.viewFrom+=r,o.viewTo+=r):t<=o.viewFrom&&n>=o.viewTo?mr(e):t<=o.viewFrom?(l=vr(e,n,n+r,1))?(o.view=o.view.slice(l.index),o.viewFrom=l.lineN,o.viewTo+=r):mr(e):n>=o.viewTo?(l=vr(e,t,t,-1))?(o.view=o.view.slice(0,l.index),o.viewTo=l.lineN):mr(e):(l=vr(e,t,t,-1),i=vr(e,n,n+r,1),l&&i?(o.view=o.view.slice(0,l.index).concat(mn(e,l.lineN,i.lineN)).concat(o.view.slice(i.index)),o.viewTo+=r):mr(e)),o.externalMeasured);l&&(n<l.lineN?l.lineN+=r:t<l.lineN+l.size&&(o.externalMeasured=null))}function gr(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null),t<r.viewFrom||t>=r.viewTo||null!=(i=r.view[pr(e,t)]).node&&-1==S(r=i.changes||(i.changes=[]),n)&&r.push(n)}function mr(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function vr(e,t,n,r){var i,o=pr(e,t),l=e.display.view;if(Rt&&n!=e.doc.first+e.doc.size){for(var s=e.display.viewFrom,a=0;a<o;a++)s+=l[a].size;if(s!=t){if(0<r){if(o==l.length-1)return null;i=s+l[o].size-t,o++}else i=s-t;t+=i,n+=i}for(;en(e.doc,n)!=n;){if(o==(r<0?0:l.length-1))return null;n+=r*l[o-(r<0?1:0)].size,o+=r}}return{index:o,lineN:n}}function yr(e){for(var t=e.display.view,n=0,r=0;r<t.length;r++){var i=t[r];i.hidden||i.node&&!i.changes||++n}return n}function br(e){e.display.input.showSelection(e.display.input.prepareSelection())}function wr(e,t){void 0===t&&(t=!0);var n=e.doc,r={},i=r.cursors=document.createDocumentFragment(),o=r.selection=document.createDocumentFragment(),l=e.options.$customCursor;l&&(t=!0);for(var s,a,u,c=0;c<n.sel.ranges.length;c++)!t&&c==n.sel.primIndex||((s=n.sel.ranges[c]).from().line>=e.display.viewTo||s.to().line<e.display.viewFrom||(a=s.empty(),l?(u=l(e,s))&&xr(e,u,i):(a||e.options.showCursorWhenSelecting)&&xr(e,s.head,i),a))||function(i,e,t){var n=i.display,o=i.doc,l=document.createDocumentFragment(),r=Dn(i.display),S=r.left,L=Math.max(n.sizerWidth,Hn(i)-n.sizer.offsetLeft)-r.right,k="ltr"==o.direction;function T(e,t,n,r){t<0&&(t=0),t=Math.round(t),r=Math.round(r),l.appendChild(M("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?L-e:n)+"px;\n                             height: "+(r-t)+"px"))}function s(n,g,m){var v,y,r=D(o,n),b=r.text.length;function w(e,t){return Zn(i,H(n,e),"div",r,t)}function x(e,t,n){e=rr(i,r,null,e),t="ltr"==t==("after"==n)?"left":"right";return w("after"==n?e.begin:e.end-(/\s/.test(r.text.charAt(e.end-1))?2:1),t)[t]}var C=Ge(r,o.direction);return function(e,t,n,r){if(!e)return r(t,n,"ltr",0);for(var i=!1,o=0;o<e.length;++o){var l=e[o];(l.from<n&&l.to>t||t==n&&l.to==t)&&(r(Math.max(l.from,t),Math.min(l.to,n),1==l.level?"rtl":"ltr",o),i=!0)}i||r(t,n,"ltr")}(C,g||0,null==m?b:m,function(e,t,n,r){var i,o,l,s,a,u="ltr"==n,c=w(e,u?"left":"right"),h=w(t-1,u?"right":"left"),d=null==g&&0==e,f=null==m&&t==b,p=0==r,r=!C||r==C.length-1;h.top-c.top<=3?(i=(k?d:f)&&p?S:(u?c:h).left,a=(k?f:d)&&r?L:(u?h:c).right,T(i,c.top,a-i,c.bottom)):(a=u?(o=k&&d&&p?S:c.left,l=k?L:x(e,n,"before"),s=k?S:x(t,n,"after"),k&&f&&r?L:h.right):(o=k?x(e,n,"before"):S,l=!k&&d&&p?L:c.right,s=!k&&f&&r?S:h.left,k?x(t,n,"after"):L),T(o,c.top,l-o,c.bottom),c.bottom<h.top&&T(S,c.bottom,null,h.top),T(s,h.top,a-s,h.bottom)),(!v||Cr(c,v)<0)&&(v=c),Cr(h,v)<0&&(v=h),(!y||Cr(c,y)<0)&&(y=c),Cr(h,y)<0&&(y=h)}),{start:v,end:y}}n=e.from(),r=e.to();{var a;n.line==r.line?s(n.line,n.ch,r.ch):(e=D(o,n.line),a=D(o,r.line),a=Jt(e)==Jt(a),n=s(n.line,n.ch,a?e.text.length+1:null).end,e=s(r.line,a?0:null,r.ch).start,a&&(n.top<e.top-2?(T(n.right,n.top,null,n.bottom),T(S,e.top,e.left,e.bottom)):T(n.right,n.top,e.left-n.right,n.bottom)),n.bottom<e.top&&T(S,n.bottom,null,e.top))}t.appendChild(l)}(e,s,o);return r}function xr(e,t,n){var r=Qn(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=n.appendChild(M("div","Â ","CodeMirror-cursor"));i.style.left=r.left+"px",i.style.top=r.top+"px",i.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)&&(t=(t=Zn(e,t,"div",null,null)).right-t.left,i.style.width=(0<t?t:e.defaultCharWidth())+"px"),r.other&&((i=n.appendChild(M("div","Â ","CodeMirror-cursor CodeMirror-secondarycursor"))).style.display="",i.style.left=r.other.left+"px",i.style.top=r.other.top+"px",i.style.height=.85*(r.other.bottom-r.other.top)+"px")}function Cr(e,t){return e.top-t.top||e.left-t.left}function Sr(e){var t,n;e.state.focused&&(t=e.display,clearInterval(t.blinker),n=!0,t.cursorDiv.style.visibility="",0<e.options.cursorBlinkRate?t.blinker=setInterval(function(){e.hasFocus()||Mr(e),t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function Lr(e){e.hasFocus()||(e.display.input.focus(),e.state.focused)||Tr(e)}function kr(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused)&&Mr(e)},100)}function Tr(e,t){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(O(e,"focus",e,t),e.state.focused=!0,re(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),x&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Sr(e))}function Mr(e,t){e.state.delayingBlurEvent||(e.state.focused&&(O(e,"blur",e,t),e.state.focused=!1,J(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Nr(e){for(var t=e.display,n=t.lineDiv.offsetTop,r=Math.max(0,t.scroller.getBoundingClientRect().top),i=t.lineDiv.getBoundingClientRect().top,o=0,l=0;l<t.view.length;l++){var s=t.view[l],a=e.options.lineWrapping,u=void 0,c=0;if(!s.hidden){i+=s.line.height,w&&v<8?(u=(h=s.node.offsetTop+s.node.offsetHeight)-n,n=h):(u=(h=s.node.getBoundingClientRect()).bottom-h.top,!a&&s.text.firstChild&&(c=s.text.firstChild.getBoundingClientRect().right-h.left-1));var h,a=s.line.height-u;if((.005<a||a<-.005)&&(i<r&&(o-=a),mt(s.line,u),Or(s.line),s.rest))for(var d=0;d<s.rest.length;d++)Or(s.rest[d]);c>e.display.sizerWidth&&(a=Math.ceil(c/ar(e.display)))>e.display.maxLineLength&&(e.display.maxLineLength=a,e.display.maxLine=s.line,e.display.maxLineChanged=!0)}}2<Math.abs(o)&&(t.scroller.scrollTop+=o)}function Or(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var n=e.widgets[t],r=n.node.parentNode;r&&(n.height=r.offsetHeight)}}function Ar(e,t,n){var r,i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop,i=Math.floor(i-On(e)),o=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,i=vt(t,i),o=vt(t,o);return n&&n.ensure&&(r=n.ensure.from.line,n=n.ensure.to.line,r<i?o=vt(t,rn(D(t,i=r))+e.wrapper.clientHeight):Math.min(n,t.lastLine())>=o&&(i=vt(t,rn(D(t,n))-e.wrapper.clientHeight),o=n)),{from:i,to:Math.max(o,i+1)}}function Dr(e,t){var n=e.display,r=sr(e.display),i=(t.top<0&&(t.top=0),(e.curOp&&null!=e.curOp.scrollTop?e.curOp:n.scroller).scrollTop),o=Fn(e),l={},s=(t.bottom-t.top>o&&(t.bottom=t.top+o),e.doc.height+An(n)),a=t.top<r,r=t.bottom>s-r,r=(t.top<i?l.scrollTop=a?0:t.top:t.bottom>i+o&&(a=Math.min(t.top,(r?s:t.bottom)-o))!=i&&(l.scrollTop=a),e.options.fixedGutter?0:n.gutters.offsetWidth),s=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:n.scroller.scrollLeft-r,o=Hn(e)-n.gutters.offsetWidth,i=t.right-t.left>o;return i&&(t.right=t.left+o),t.left<10?l.scrollLeft=0:t.left<s?l.scrollLeft=Math.max(0,t.left+r-(i?0:10)):t.right>o+s-3&&(l.scrollLeft=t.right+(i?0:10)-o),l}function Wr(e,t){null!=t&&(Pr(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc:e.curOp).scrollTop+t)}function Hr(e){Pr(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function Fr(e,t,n){null==t&&null==n||Pr(e),null!=t&&(e.curOp.scrollLeft=t),null!=n&&(e.curOp.scrollTop=n)}function Pr(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,Er(e,Jn(e,t.from),Jn(e,t.to),t.margin))}function Er(e,t,n,r){t=Dr(e,{left:Math.min(t.left,n.left),top:Math.min(t.top,n.top)-r,right:Math.max(t.right,n.right),bottom:Math.max(t.bottom,n.bottom)+r});Fr(e,t.scrollLeft,t.scrollTop)}function zr(e,t){Math.abs(e.doc.scrollTop-t)<2||(m||ti(e,{top:t}),Ir(e,t,!0),m&&ti(e),qr(e,100))}function Ir(e,t,n){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),e.display.scroller.scrollTop==t&&!n||(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop==t)||(e.display.scroller.scrollTop=t)}function Rr(e,t,n,r){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!r||(e.doc.scrollLeft=t,ii(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Br(e){var t=e.display,n=t.gutters.offsetWidth,r=Math.round(e.doc.height+An(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+Wn(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function Gr(e,t,n){this.cm=n;var r=this.vert=M("div",[M("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=M("div",[M("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");r.tabIndex=i.tabIndex=-1,e(r),e(i),L(r,"scroll",function(){r.clientHeight&&t(r.scrollTop,"vertical")}),L(i,"scroll",function(){i.clientWidth&&t(i.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,w&&v<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function Ur(){}Gr.prototype.update=function(e){var t,n=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;return r?(this.vert.style.display="block",this.vert.style.bottom=n?i+"px":"0",t=e.viewHeight-(n?i:0),this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+t)+"px"):(this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0"),n?(this.horiz.style.display="block",this.horiz.style.right=r?i+"px":"0",this.horiz.style.left=e.barLeft+"px",t=e.viewWidth-e.barLeft-(r?i:0),this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+t)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&0<e.clientHeight&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?i:0,bottom:n?i:0}},Gr.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Gr.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Gr.prototype.zeroWidthHack=function(){this.horiz.style.height=this.vert.style.width=C&&!c?"12px":"18px",this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new de,this.disableVert=new de},Gr.prototype.enableZeroWidthBar=function(n,r,i){n.style.visibility="",r.set(1e3,function e(){var t=n.getBoundingClientRect();("vert"==i?document.elementFromPoint(t.right-1,(t.top+t.bottom)/2):document.elementFromPoint((t.right+t.left)/2,t.bottom-1))!=n?n.style.visibility="hidden":r.set(1e3,e)})},Gr.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};function Vr(e,t){t=t||Br(e);var n=e.display.barWidth,r=e.display.barHeight;Kr(e,t);for(var i=0;i<4&&n!=e.display.barWidth||r!=e.display.barHeight;i++)n!=e.display.barWidth&&e.options.lineWrapping&&Nr(e),Kr(e,Br(e)),n=e.display.barWidth,r=e.display.barHeight}function Kr(e,t){var n=e.display,r=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",n.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}Ur.prototype.update=function(){return{bottom:0,right:0}},Ur.prototype.setScrollLeft=function(){},Ur.prototype.setScrollTop=function(){},Ur.prototype.clear=function(){};var jr={native:Gr,null:Ur};function Xr(n){n.display.scrollbars&&(n.display.scrollbars.clear(),n.display.scrollbars.addClass)&&J(n.display.wrapper,n.display.scrollbars.addClass),n.display.scrollbars=new jr[n.options.scrollbarStyle](function(e){n.display.wrapper.insertBefore(e,n.display.scrollbarFiller),L(e,"mousedown",function(){n.state.focused&&setTimeout(function(){return n.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,t){("horizontal"==t?Rr:zr)(n,e)},n),n.display.scrollbars.addClass&&re(n.display.wrapper,n.display.scrollbars.addClass)}var Yr=0;function $r(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Yr,markArrays:null},e=e.curOp,vn?vn.ops.push(e):e.ownsGroup=vn={ops:[e],delayedCallbacks:[]}}function _r(e){e=e.curOp;if(e){var t=function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;for(var n=e.ops,r=0;r<n.length;r++){l=o=i=void 0;var i=n[r],o=i.cm,l=o.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Wn(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Wn(e)+"px",t.scrollbarsClipped=!0)})(o),i.updateMaxLine&&ln(o),i.mustUpdate=i.viewChanged||i.forceUpdate||null!=i.scrollTop||i.scrollToPos&&(i.scrollToPos.from.line<l.viewFrom||i.scrollToPos.to.line>=l.viewTo)||l.maxLineChanged&&o.options.lineWrapping,i.update=i.mustUpdate&&new Qr(o,i.mustUpdate&&{top:i.scrollTop,ensure:i.scrollToPos},i.forceUpdate)}for(var s=0;s<n.length;s++){a=void 0;var a=n[s];a.updatedDisplay=a.mustUpdate&&Jr(a.cm,a.update)}for(var u=0;u<n.length;u++){c=void 0;h=void 0;d=void 0;var c=n[u];var h=c.cm,d=h.display;c.updatedDisplay&&Nr(h);c.barMeasure=Br(h),d.maxLineChanged&&!h.options.lineWrapping&&(c.adjustWidthTo=En(h,d.maxLine,d.maxLine.text.length).left+3,h.display.sizerWidth=c.adjustWidthTo,c.barMeasure.scrollWidth=Math.max(d.scroller.clientWidth,d.sizer.offsetLeft+c.adjustWidthTo+Wn(h)+h.display.barWidth),c.maxScrollLeft=Math.max(0,d.sizer.offsetLeft+c.adjustWidthTo-Hn(h)));(c.updatedDisplay||c.selectionChanged)&&(c.preparedSelection=d.input.prepareSelection())}for(var f=0;f<n.length;f++){p=void 0;g=void 0;m=void 0;var p=n[f];var g=p.cm;null!=p.adjustWidthTo&&(g.display.sizer.style.minWidth=p.adjustWidthTo+"px",p.maxScrollLeft<g.doc.scrollLeft&&Rr(g,Math.min(g.display.scroller.scrollLeft,p.maxScrollLeft),!0),g.display.maxLineChanged=!1);var m=p.focus&&p.focus==N(se(g));p.preparedSelection&&g.display.input.showSelection(p.preparedSelection,m);!p.updatedDisplay&&p.startHeight==g.doc.height||Vr(g,p.barMeasure);p.updatedDisplay&&ri(g,p.barMeasure);p.selectionChanged&&Sr(g);g.state.focused&&p.updateInput&&g.display.input.reset(p.typing);m&&Lr(p.cm)}for(var v,y=0;y<n.length;y++){b=void 0;w=void 0;x=void 0;C=void 0;v=void 0;S=void 0;L=void 0;k=void 0;T=void 0;var b=n[y];var w=b.cm,x=w.display,C=w.doc;b.updatedDisplay&&ei(w,b.update);null==x.wheelStartX||null==b.scrollTop&&null==b.scrollLeft&&!b.scrollToPos||(x.wheelStartX=x.wheelStartY=null);null!=b.scrollTop&&Ir(w,b.scrollTop,b.forceScroll);null!=b.scrollLeft&&Rr(w,b.scrollLeft,!0,!0);b.scrollToPos&&(v=function(e,t,n,r){null==r&&(r=0),e.options.lineWrapping||t!=n||(n="before"==t.sticky?H(t.line,t.ch+1,"before"):t,t=t.ch?H(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t);for(var i=0;i<5;i++){var o,l=!1,s=Qn(e,t),a=n&&n!=t?Qn(e,n):s,s=Dr(e,o={left:Math.min(s.left,a.left),top:Math.min(s.top,a.top)-r,right:Math.max(s.left,a.left),bottom:Math.max(s.bottom,a.bottom)+r}),a=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=s.scrollTop&&(zr(e,s.scrollTop),1<Math.abs(e.doc.scrollTop-a))&&(l=!0),!(l=null!=s.scrollLeft&&(Rr(e,s.scrollLeft),1<Math.abs(e.doc.scrollLeft-u))?!0:l))break}return o}(w,P(C,b.scrollToPos.from),P(C,b.scrollToPos.to),b.scrollToPos.margin),function(e,t){var n,r,i,o;A(e,"scrollCursorIntoView")||(o=(n=e.display).sizer.getBoundingClientRect(),r=null,i=n.wrapper.ownerDocument,t.top+o.top<0?r=!0:t.bottom+o.top>(i.defaultView.innerHeight||i.documentElement.clientHeight)&&(r=!1),null==r)||X||(o=M("div","â",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-On(e.display))+"px;\n                         height: "+(t.bottom-t.top+Wn(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),e.display.lineSpace.appendChild(o),o.scrollIntoView(r),e.display.lineSpace.removeChild(o))}(w,v));var S=b.maybeHiddenMarkers,L=b.maybeUnhiddenMarkers;if(S)for(var k=0;k<S.length;++k)S[k].lines.length||O(S[k],"hide");if(L)for(var T=0;T<L.length;++T)L[T].lines.length&&O(L[T],"unhide");x.wrapper.offsetHeight&&(C.scrollTop=w.display.scroller.scrollTop);b.changeObjs&&O(w,"changes",w,b.changeObjs);b.update&&b.update.finish()}};if(e=e.ownsGroup)try{var n=e,r=n.delayedCallbacks,i=0;do{for(;i<r.length;i++)r[i].call(null);for(var o=0;o<n.ops.length;o++){var l=n.ops[o];if(l.cursorActivityHandlers)for(;l.cursorActivityCalled<l.cursorActivityHandlers.length;)l.cursorActivityHandlers[l.cursorActivityCalled++].call(null,l.cm)}}while(i<r.length)}finally{vn=null,t(e)}}}function h(e,t){if(e.curOp)return t();$r(e);try{return t()}finally{_r(e)}}function z(e,t){return function(){if(e.curOp)return t.apply(e,arguments);$r(e);try{return t.apply(e,arguments)}finally{_r(e)}}}function n(e){return function(){if(this.curOp)return e.apply(this,arguments);$r(this);try{return e.apply(this,arguments)}finally{_r(this)}}}function r(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);$r(e);try{return t.apply(this,arguments)}finally{_r(e)}}}function qr(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,ue(Zr,e))}function Zr(l){var s,a,u,c=l.doc;c.highlightFrontier>=l.display.viewTo||(s=+new Date+l.options.workTime,a=At(l,c.highlightFrontier),u=[],c.iter(a.line,Math.min(c.first+c.size,l.display.viewTo+500),function(e){if(a.line>=l.display.viewFrom){for(var t=e.styles,n=e.text.length>l.options.maxHighlightLength?ht(c.mode,a.state):null,r=Nt(l,e,a,!0),n=(n&&(a.state=n),e.styles=r.styles,e.styleClasses),r=r.classes,i=(r?e.styleClasses=r:n&&(e.styleClasses=null),!t||t.length!=e.styles.length||n!=r&&(!n||!r||n.bgClass!=r.bgClass||n.textClass!=r.textClass)),o=0;!i&&o<t.length;++o)i=t[o]!=e.styles[o];i&&u.push(a.line),e.stateAfter=a.save()}else e.text.length<=l.options.maxHighlightLength&&Dt(l,e.text,a),e.stateAfter=a.line%5==0?a.save():null;if(a.nextLine(),+new Date>s)return qr(l,l.options.workDelay),!0}),c.highlightFrontier=a.line,c.modeFrontier=Math.max(c.modeFrontier,a.line),u.length&&h(l,function(){for(var e=0;e<u.length;e++)gr(l,u[e],"text")}))}var Qr=function(e,t,n){var r=e.display;this.viewport=t,this.visible=Ar(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=Hn(e),this.force=n,this.dims=ur(e),this.events=[]};function Jr(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return mr(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==yr(e))return!1;oi(e)&&(mr(e),t.dims=ur(e));var i=r.first+r.size,o=Math.max(t.visible.from-e.options.viewportMargin,r.first),l=Math.min(i,t.visible.to+e.options.viewportMargin),r=(n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(r.first,n.viewFrom)),n.viewTo>l&&n.viewTo-l<20&&(l=Math.min(i,n.viewTo)),Rt&&(o=en(e.doc,o),l=tn(e.doc,l)),o!=n.viewFrom||l!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth),i=(i=o,o=l,0==(s=(l=e).display).view.length||i>=s.viewTo||o<=s.viewFrom?(s.view=mn(l,i,o),s.viewFrom=i):(s.viewFrom>i?s.view=mn(l,i,s.viewFrom).concat(s.view):s.viewFrom<i&&(s.view=s.view.slice(pr(l,i))),s.viewFrom=i,s.viewTo<o?s.view=s.view.concat(mn(l,s.viewTo,o)):s.viewTo>o&&(s.view=s.view.slice(0,pr(l,o)))),s.viewTo=o,n.viewOffset=rn(D(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px",yr(e));if(!r&&0==i&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var s,l=!(l=e).hasFocus()&&(s=N(se(l)))&&ne(l.display.lineDiv,s)?(s={activeElt:s},window.getSelection&&(o=ae(l).getSelection()).anchorNode&&o.extend&&ne(l.display.lineDiv,o.anchorNode)&&(s.anchorNode=o.anchorNode,s.anchorOffset=o.anchorOffset,s.focusNode=o.focusNode,s.focusOffset=o.focusOffset),s):null,a=(4<i&&(n.lineDiv.style.display="none"),e),u=n.updateLineNumbers,c=t.dims,o=a.display,h=a.options.lineNumbers,d=o.lineDiv,f=d.firstChild;function p(e){var t=e.nextSibling;return x&&C&&a.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),t}for(var g=o.view,m=o.viewFrom,v=0;v<g.length;v++){var y=g[v];if(!y.hidden)if(y.node&&y.node.parentNode==d){for(;f!=y.node;)f=p(f);var b=h&&null!=u&&u<=m&&y.lineNumber;y.changes&&(-1<S(y.changes,"gutter")&&(b=!1),wn(a,y,m,c)),b&&(ee(y.lineNumber),y.lineNumber.appendChild(document.createTextNode(bt(a.options,m)))),f=y.node.nextSibling}else{b=function(e,t,n,r){var i=Cn(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),Sn(e,t),Ln(e,t,n,r),kn(e,t,r),t.node}(a,y,m,c);d.insertBefore(b,f)}m+=y.size}for(;f;)f=p(f);return 4<i&&(n.lineDiv.style.display=""),n.renderedView=n.view,(s=l)&&s.activeElt&&s.activeElt!=N(s.activeElt.ownerDocument)&&(s.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(s.activeElt.nodeName))&&s.anchorNode&&ne(document.body,s.anchorNode)&&ne(document.body,s.focusNode)&&(i=(o=s.activeElt.ownerDocument).defaultView.getSelection(),(o=o.createRange()).setEnd(s.anchorNode,s.anchorOffset),o.collapse(!1),i.removeAllRanges(),i.addRange(o),i.extend(s.focusNode,s.focusOffset)),ee(n.cursorDiv),ee(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,r&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,qr(e,400)),!(n.updateLineNumbers=null)}function ei(e,t){for(var n=t.viewport,r=!0;;r=!1){if(r&&e.options.lineWrapping&&t.oldDisplayWidth!=Hn(e))r&&(t.visible=Ar(e.display,e.doc,n));else if(n&&null!=n.top&&(n={top:Math.min(e.doc.height+An(e.display)-Fn(e),n.top)}),t.visible=Ar(e.display,e.doc,n),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!Jr(e,t))break;Nr(e);var i=Br(e);br(e),Vr(e,i),ri(e,i),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function ti(e,t){var n,t=new Qr(e,t);Jr(e,t)&&(Nr(e),ei(e,t),n=Br(e),br(e),Vr(e,n),ri(e,n),t.finish())}function ni(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px",b(e,"gutterChanged",e)}function ri(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Wn(e)+"px"}function ii(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var r=cr(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=r+"px",l=0;l<n.length;l++)if(!n[l].hidden){e.options.fixedGutter&&(n[l].gutter&&(n[l].gutter.style.left=o),n[l].gutterBackground)&&(n[l].gutterBackground.style.left=o);var s=n[l].alignable;if(s)for(var a=0;a<s.length;a++)s[a].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}}function oi(e){var t,n,r,i;if(e.options.lineNumbers)return t=e.doc,t=bt(e.options,t.first+t.size-1),n=e.display,t.length!=n.lineNumChars?(r=(i=n.measure.appendChild(M("div",[M("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt"))).firstChild.offsetWidth,i=i.offsetWidth-r,n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(r,n.lineGutter.offsetWidth-i)+1,n.lineNumWidth=n.lineNumInnerWidth+i,n.lineNumChars=n.lineNumInnerWidth?t.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",ni(e.display),1):void 0}function li(e,t){for(var n=[],r=!1,i=0;i<e.length;i++){var o=e[i],l=null;if("string"!=typeof o&&(l=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;r=!0}n.push({className:o,style:l})}return t&&!r&&n.push({className:"CodeMirror-linenumbers",style:null}),n}function si(e){var t=e.gutters,n=e.gutterSpecs;ee(t),e.lineGutter=null;for(var r=0;r<n.length;++r){var i=n[r],o=i.className,i=i.style,l=t.appendChild(M("div",null,"CodeMirror-gutter "+o));i&&(l.style.cssText=i),"CodeMirror-linenumbers"==o&&((e.lineGutter=l).style.width=(e.lineNumWidth||1)+"px")}t.style.display=n.length?"":"none",ni(e)}function ai(e){si(e.display),E(e),ii(e)}function ui(e,t,n,r){var i=this,o=(this.input=n,i.scrollbarFiller=M("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=M("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=te("div",null,"CodeMirror-code"),i.selectionDiv=M("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=M("div",null,"CodeMirror-cursors"),i.measure=M("div",null,"CodeMirror-measure"),i.lineMeasure=M("div",null,"CodeMirror-measure"),i.lineSpace=te("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),te("div",[i.lineSpace],"CodeMirror-lines"));i.mover=M("div",[o],null,"position: relative"),i.sizer=M("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=M("div",null,null,"position: absolute; height: "+fe+"px; width: 1px;"),i.gutters=M("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=M("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=M("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),U&&105<=V&&(i.wrapper.style.clipPath="inset(0px)"),i.wrapper.setAttribute("translate","no"),w&&v<8&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),x||m&&$||(i.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(i.wrapper):e(i.wrapper)),i.viewFrom=i.viewTo=t.first,i.reportedViewFrom=i.reportedViewTo=t.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,i.gutterSpecs=li(r.gutters,r.lineNumbers),si(i),n.init(i)}Qr.prototype.signal=function(e,t){je(e,t)&&this.events.push(arguments)},Qr.prototype.finish=function(){for(var e=0;e<this.events.length;e++)O.apply(null,this.events[e])};var ci=0,hi=null;function di(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function fi(e){e=di(e);return e.x*=hi,e.y*=hi,e}function pi(e,t){U&&102==V&&(null==e.display.chromeScrollHack?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout(function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""},100));var n,r,i=di(t),o=i.x,i=i.y,l=hi,s=(0===t.deltaMode&&(o=t.deltaX,i=t.deltaY,l=1),e.display),a=s.scroller,u=a.scrollWidth>a.clientWidth,c=a.scrollHeight>a.clientHeight;if(o&&u||i&&c){if(i&&C&&x)e:for(var h=t.target,d=s.view;h!=a;h=h.parentNode)for(var f=0;f<d.length;f++)if(d[f].node==h){e.display.currentWheelTarget=h;break e}!o||m||K||null==l?(i&&null!=l&&(r=(u=e.doc.scrollTop)+s.wrapper.clientHeight,(n=i*l)<0?u=Math.max(0,u+n-50):r=Math.min(e.doc.height,r+n+50),ti(e,{top:u,bottom:r})),ci<20&&0!==t.deltaMode&&(null==s.wheelStartX?(s.wheelStartX=a.scrollLeft,s.wheelStartY=a.scrollTop,s.wheelDX=o,s.wheelDY=i,setTimeout(function(){var e,t;null!=s.wheelStartX&&(e=a.scrollLeft-s.wheelStartX,t=(t=a.scrollTop-s.wheelStartY)&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX,s.wheelStartX=s.wheelStartY=null,t)&&(hi=(hi*ci+t)/(ci+1),++ci)},200)):(s.wheelDX+=o,s.wheelDY+=i))):(i&&c&&zr(e,Math.max(0,a.scrollTop+i*l)),Rr(e,Math.max(0,a.scrollLeft+o*l)),i&&!c||T(t),s.wheelStartX=null)}}w?hi=-.53:m?hi=15:U?hi=-.7:j&&(hi=-1/3);var R=function(e,t){this.ranges=e,this.primIndex=t},B=(R.prototype.primary=function(){return this.ranges[this.primIndex]},R.prototype.equals=function(e){if(e!=this){if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],r=e.ranges[t];if(!wt(n.anchor,r.anchor)||!wt(n.head,r.head))return!1}}return!0},R.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new B(xt(this.ranges[t].anchor),xt(this.ranges[t].head));return new R(e,this.primIndex)},R.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},R.prototype.contains=function(e,t){t=t||e;for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(0<=F(t,r.from())&&F(e,r.to())<=0)return n}return-1},function(e,t){this.anchor=e,this.head=t});function gi(e,t,n){var r=e&&e.options.selectionsMayTouch,e=t[n];t.sort(function(e,t){return F(e.from(),t.from())}),n=S(t,e);for(var i=1;i<t.length;i++){var o,l=t[i],s=t[i-1],a=F(s.to(),l.from());(r&&!l.empty()?0<a:0<=a)&&(a=St(s.from(),l.from()),o=Ct(s.to(),l.to()),l=s.empty()?l.from()==l.head:s.from()==s.head,i<=n&&--n,t.splice(--i,2,new B(l?o:a,l?a:o)))}return new R(t,n)}function mi(e,t){return new R([new B(e,t||e)],0)}function vi(e){return e.text?H(e.from.line+e.text.length-1,I(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function yi(e,t){var n,r;return F(e,t.from)<0?e:F(e,t.to)<=0?vi(t):(n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch,e.line==t.to.line&&(r+=vi(t).ch-t.to.ch),H(n,r))}function bi(e,t){for(var n=[],r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new B(yi(i.anchor,t),yi(i.head,t)))}return gi(e.cm,n,e.sel.primIndex)}function wi(e,t,n){return e.line==t.line?H(n.line,e.ch-t.ch+n.ch):H(n.line+(e.line-t.line),e.ch)}function xi(e){e.doc.mode=at(e.options,e.doc.modeOption),Ci(e)}function Ci(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,qr(e,100),e.state.modeGen++,e.curOp&&E(e)}function Si(e,t){return 0==t.from.ch&&0==t.to.ch&&""==I(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Li(e,o,t,l){function i(e){return t?t[e]:null}function n(e,t,n){var r,i;t=t,n=n,i=l,(r=e).text=t,r.stateAfter&&(r.stateAfter=null),r.styles&&(r.styles=null),null!=r.order&&(r.order=null),Kt(r),jt(r,n),(t=i?i(r):1)!=r.height&&mt(r,t),b(e,"change",e,o)}function r(e,t){for(var n=[],r=e;r<t;++r)n.push(new sn(c[r],i(r),l));return n}var s,a=o.from,u=o.to,c=o.text,h=D(e,a.line),d=D(e,u.line),f=I(c),p=i(c.length-1),g=u.line-a.line;o.full?(e.insert(0,r(0,c.length)),e.remove(c.length,e.size-c.length)):Si(e,o)?(s=r(0,c.length-1),n(d,d.text,p),g&&e.remove(a.line,g),s.length&&e.insert(a.line,s)):h==d?1==c.length?n(h,h.text.slice(0,a.ch)+f+h.text.slice(u.ch),p):((s=r(1,c.length-1)).push(new sn(f+h.text.slice(u.ch),p,l)),n(h,h.text.slice(0,a.ch)+c[0],i(0)),e.insert(a.line+1,s)):1==c.length?(n(h,h.text.slice(0,a.ch)+c[0]+d.text.slice(u.ch),i(0)),e.remove(a.line+1,g)):(n(h,h.text.slice(0,a.ch)+c[0],i(0)),n(d,f+d.text.slice(u.ch),p),s=r(1,c.length-1),1<g&&e.remove(a.line+1,g-1),e.insert(a.line+1,s)),b(e,"change",e,o)}function ki(e,s,a){!function e(t,n,r){if(t.linked)for(var i=0;i<t.linked.length;++i){var o,l=t.linked[i];l.doc!=n&&(o=r&&l.sharedHist,!a||o)&&(s(l.doc,o),e(l.doc,t,o))}}(e,null,!0)}function Ti(e,t){if(t.cm)throw new Error("This document is already in use.");dr((e.doc=t).cm=e),xi(e),Mi(e),e.options.direction=t.direction,e.options.lineWrapping||ln(e),e.options.mode=t.modeOption,E(e)}function Mi(e){("rtl"==e.doc.direction?re:J)(e.display.lineDiv,"CodeMirror-rtl")}function Ni(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function Oi(e,t){var n={from:xt(t.from),to:vi(t),text:pt(e,t.from,t.to)};return Fi(e,n,t.from.line,t.to.line+1),ki(e,function(e){return Fi(e,n,t.from.line,t.to.line+1)},!0),n}function Ai(e){for(;e.length;){if(!I(e).ranges)break;e.pop()}}function Di(e,t,n,r){var i,o,l=e.history,s=(l.undone.length=0,+new Date);if((l.lastOp==r||l.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&l.lastModTime>s-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=(o=l).lastOp==r?(Ai(o.done),I(o.done)):o.done.length&&!I(o.done).ranges?I(o.done):1<o.done.length&&!o.done[o.done.length-2].ranges?(o.done.pop(),I(o.done)):void 0))i=I(o.changes),0==F(t.from,t.to)&&0==F(t.from,i.to)?i.to=vi(t):o.changes.push(Oi(e,t));else{var a=I(l.done);for(a&&a.ranges||Hi(e.sel,l.done),o={changes:[Oi(e,t)],generation:l.generation},l.done.push(o);l.done.length>l.undoDepth;)l.done.shift(),l.done[0].ranges||l.done.shift()}l.done.push(n),l.generation=++l.maxGeneration,l.lastModTime=l.lastSelTime=s,l.lastOp=l.lastSelOp=r,l.lastOrigin=l.lastSelOrigin=t.origin,i||O(e,"historyAdded")}function Wi(e,t,n,r){var i,o,l,s=e.history,a=r&&r.origin;n==s.lastSelOp||a&&s.lastSelOrigin==a&&(s.lastModTime==s.lastSelTime&&s.lastOrigin==a||(e=e,i=a,o=I(s.done),l=t,"*"==(i=i.charAt(0)))||"+"==i&&o.ranges.length==l.ranges.length&&o.somethingSelected()==l.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500))?s.done[s.done.length-1]=t:Hi(t,s.done),s.lastSelTime=+new Date,s.lastSelOrigin=a,s.lastSelOp=n,r&&!1!==r.clearRedo&&Ai(s.undone)}function Hi(e,t){var n=I(t);n&&n.ranges&&n.equals(e)||t.push(e)}function Fi(t,n,e,r){var i=n["spans_"+t.id],o=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,r),function(e){e.markedSpans&&((i=i||(n["spans_"+t.id]={}))[o]=e.markedSpans),++o})}function Pi(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=[],i=0;i<t.text.length;++i)r.push(function(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t=t||e.slice(0,n):t&&t.push(e[n]);return t?t.length?t:null:e}(n[i]));return r}function Ei(e,t){var n=Pi(e,t),r=Ut(e,t);if(!n)return r;if(r)for(var i=0;i<n.length;++i){var o=n[i],l=r[i];if(o&&l)e:for(var s=0;s<l.length;++s){for(var a=l[s],u=0;u<o.length;++u)if(o[u].marker==a.marker)continue e;o.push(a)}else l&&(n[i]=l)}return n}function zi(e,t,n){for(var r=[],i=0;i<e.length;++i){var o=e[i];if(o.ranges)r.push(n?R.prototype.deepCopy.call(o):o);else{var l=o.changes,s=[];r.push({changes:s});for(var a=0;a<l.length;++a){var u,c=l[a];if(s.push({from:c.from,to:c.to,text:c.text}),t)for(var h in c)(u=h.match(/^spans_(\d+)$/))&&-1<S(t,Number(u[1]))&&(I(s)[h]=c[h],delete c[h])}}}return r}function Ii(e,t,n,r){return r?(r=e.anchor,n&&((e=F(t,r)<0)!=F(n,r)<0?(r=t,t=n):e!=F(t,n)<0&&(t=n)),new B(r,t)):new B(n||t,t)}function Ri(e,t,n,r,i){null==i&&(i=e.cm&&(e.cm.display.shift||e.extend)),G(e,new R([Ii(e.sel.primary(),t,n,i)],0),r)}function Bi(e,t,n){for(var r=[],i=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)r[o]=Ii(e.sel.ranges[o],t[o],null,i);G(e,gi(e.cm,r,e.sel.primIndex),n)}function Gi(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,G(e,gi(e.cm,i,e.sel.primIndex),r)}function Ui(e,t,n,r){G(e,mi(t,n),r)}function Vi(e,t,n){var r=e.history.done,i=I(r);i&&i.ranges?Ki(e,r[r.length-1]=t,n):G(e,t,n)}function G(e,t,n){Ki(e,t,n),Wi(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Ki(e,t,n){(je(e,"beforeSelectionChange")||e.cm&&je(e.cm,"beforeSelectionChange"))&&(r=e,o=n,o={ranges:(i=t).ranges,update:function(e){this.ranges=[];for(var t=0;t<e.length;t++)this.ranges[t]=new B(P(r,e[t].anchor),P(r,e[t].head))},origin:o&&o.origin},O(r,"beforeSelectionChange",r,o),r.cm&&O(r.cm,"beforeSelectionChange",r.cm,o),t=o.ranges!=i.ranges?gi(r.cm,o.ranges,o.ranges.length-1):i);var r,i,o=n&&n.bias||(F(t.primary().head,e.sel.primary().head)<0?-1:1);ji(e,Yi(e,t,o,!0)),n&&!1===n.scroll||!e.cm||"nocursor"==e.cm.getOption("readOnly")||Hr(e.cm)}function ji(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,Ke(e.cm)),b(e,"cursorActivity",e))}function Xi(e){ji(e,Yi(e,e.sel,null,!1))}function Yi(e,t,n,r){for(var i,o=0;o<t.ranges.length;o++){var l=t.ranges[o],s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],a=_i(e,l.anchor,s&&s.anchor,n,r),s=l.head==l.anchor?a:_i(e,l.head,s&&s.head,n,r);!i&&a==l.anchor&&s==l.head||((i=i||t.ranges.slice(0,o))[o]=new B(a,s))}return i?gi(e.cm,i,t.primIndex):t}function $i(e,t,n,r,i){var o=D(e,t.line);if(o.markedSpans)for(var l=0;l<o.markedSpans.length;++l){var s=o.markedSpans[l],a=s.marker,u="selectLeft"in a?!a.selectLeft:a.inclusiveLeft,c="selectRight"in a?!a.selectRight:a.inclusiveRight;if((null==s.from||(u?s.from<=t.ch:s.from<t.ch))&&(null==s.to||(c?s.to>=t.ch:s.to>t.ch))){if(i&&(O(a,"beforeCursorEnter"),a.explicitlyCleared)){if(o.markedSpans){--l;continue}break}if(a.atomic){if(n){var s=a.find(r<0?1:-1),h=void 0;if((s=(r<0?c:u)?qi(e,s,-r,s&&s.line==t.line?o:null):s)&&s.line==t.line&&(h=F(s,n))&&(r<0?h<0:0<h))return $i(e,s,t,r,i)}h=a.find(r<0?-1:1);return(h=(r<0?u:c)?qi(e,h,r,h.line==t.line?o:null):h)?$i(e,h,t,r,i):null}}}return t}function _i(e,t,n,r,i){r=r||1,i=$i(e,t,n,r,i)||!i&&$i(e,t,n,r,!0)||$i(e,t,n,-r,i)||!i&&$i(e,t,n,-r,!0);return i||(e.cantEdit=!0,H(e.first,0))}function qi(e,t,n,r){return n<0&&0==t.ch?t.line>e.first?P(e,H(t.line-1)):null:0<n&&t.ch==(r||D(e,t.line)).text.length?t.line<e.first+e.size-1?H(t.line+1,0):null:new H(t.line,t.ch+n)}function Zi(e){e.setSelection(H(e.firstLine(),0),H(e.lastLine()),ge)}function Qi(i,e,t){var o={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return o.canceled=!0}};return t&&(o.update=function(e,t,n,r){e&&(o.from=P(i,e)),t&&(o.to=P(i,t)),n&&(o.text=n),void 0!==r&&(o.origin=r)}),O(i,"beforeChange",i,o),i.cm&&O(i.cm,"beforeChange",i.cm,o),o.canceled?(i.cm&&(i.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function Ji(e,t,n){if(e.cm){if(!e.cm.curOp)return z(e.cm,Ji)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(je(e,"beforeChange")||e.cm&&je(e.cm,"beforeChange"))||(t=Qi(e,t,!0))){var r=It&&!n&&function(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=S(r,n)||(r=r||[]).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],o=0;o<r.length;++o)for(var l=r[o],s=l.find(0),a=0;a<i.length;++a){var u,c,h,d=i[a];F(d.to,s.from)<0||0<F(d.from,s.to)||(u=[a,1],c=F(d.from,s.from),h=F(d.to,s.to),(c<0||!l.inclusiveLeft&&!c)&&u.push({from:d.from,to:s.from}),(0<h||!l.inclusiveRight&&!h)&&u.push({from:s.to,to:d.to}),i.splice.apply(i,u),a+=u.length-3)}return i}(e,t.from,t.to);if(r)for(var i=r.length-1;0<=i;--i)eo(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text,origin:t.origin});else eo(e,t)}}function eo(e,n){var t,r;1==n.text.length&&""==n.text[0]&&0==F(n.from,n.to)||(t=bi(e,n),Di(e,n,t,e.cm?e.cm.curOp.id:NaN),ro(e,n,t,Ut(e,n)),r=[],ki(e,function(e,t){t||-1!=S(r,e.history)||(so(e.history,n),r.push(e.history)),ro(e,n,null,Ut(e,n))}))}function to(i,o,e){var t=i.cm&&i.cm.state.suppressEdits;if(!t||e){for(var l,n=i.history,r=i.sel,s="undo"==o?n.done:n.undone,a="undo"==o?n.undone:n.done,u=0;u<s.length&&(l=s[u],e?!l.ranges||l.equals(i.sel):l.ranges);u++);if(u!=s.length){for(n.lastOrigin=n.lastSelOrigin=null;;){if(!(l=s.pop()).ranges){if(t)return void s.push(l);break}if(Hi(l,a),e&&!l.equals(i.sel))return void G(i,l,{clearRedo:!1});r=l}for(var c=[],h=(Hi(r,a),a.push({changes:c,generation:n.generation}),n.generation=l.generation||++n.maxGeneration,je(i,"beforeChange")||i.cm&&je(i.cm,"beforeChange")),d=l.changes.length-1;0<=d;--d){var f=function(e){var n=l.changes[e];if(n.origin=o,h&&!Qi(i,n,!1))return s.length=0,{};c.push(Oi(i,n));var t=e?bi(i,n):I(s),r=(ro(i,n,t,Ei(i,n)),!e&&i.cm&&i.cm.scrollIntoView({from:n.from,to:vi(n)}),[]);ki(i,function(e,t){t||-1!=S(r,e.history)||(so(e.history,n),r.push(e.history)),ro(e,n,null,Ei(e,n))})}(d);if(f)return f.v}}}}function no(e,t){if(0!=t&&(e.first+=t,e.sel=new R(xe(e.sel.ranges,function(e){return new B(H(e.anchor.line+t,e.anchor.ch),H(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){E(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)gr(e.cm,r,"gutter")}}function ro(e,t,n,r){if(e.cm&&!e.cm.curOp)return z(e.cm,ro)(e,t,n,r);if(t.to.line<e.first)no(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){t.from.line<e.first&&(no(e,i=t.text.length-1-(e.first-t.from.line)),t={from:H(e.first,0),to:H(t.to.line+i,t.to.ch),text:[I(t.text)],origin:t.origin});var i=e.lastLine();if((t=t.to.line>i?{from:t.from,to:H(i,D(e,i).text.length),text:[t.text[0]],origin:t.origin}:t).removed=pt(e,t.from,t.to),n=n||bi(e,t),e.cm){var i=e.cm,o=t,l=r,s=i.doc,a=i.display,u=o.from,c=o.to,h=!1,d=u.line,f=(i.options.lineWrapping||(d=W(Jt(D(s,u.line))),s.iter(d,c.line+1,function(e){if(e==a.maxLine)return h=!0})),-1<s.sel.contains(o.from,o.to)&&Ke(i),Li(s,o,l,hr(i)),i.options.lineWrapping||(s.iter(d,u.line+o.text.length,function(e){var t=on(e);t>a.maxLineLength&&(a.maxLine=e,a.maxLineLength=t,a.maxLineChanged=!0,h=!1)}),h&&(i.curOp.updateMaxLine=!0)),s),p=u.line;if(f.modeFrontier=Math.min(f.modeFrontier,p),!(f.highlightFrontier<p-10)){for(var g=f.first,m=p-1;g<m;m--){var v=D(f,m).stateAfter;if(v&&(!(v instanceof Tt)||m+v.lookAhead<p)){g=m+1;break}}f.highlightFrontier=Math.min(f.highlightFrontier,g)}qr(i,400),l=o.text.length-(c.line-u.line)-1,o.full?E(i):u.line!=c.line||1!=o.text.length||Si(i.doc,o)?E(i,u.line,c.line+1,l):gr(i,u.line,"text"),d=je(i,"changes"),((s=je(i,"change"))||d)&&(l={from:u,to:c,text:o.text,removed:o.removed,origin:o.origin},s&&b(i,"change",i,l),d)&&(i.curOp.changeObjs||(i.curOp.changeObjs=[])).push(l),i.display.selForContextMenu=null}else Li(e,t,r);Ki(e,n,ge),e.cantEdit&&_i(e,H(e.firstLine(),0))&&(e.cantEdit=!1)}}function io(e,t,n,r,i){var o;F(r=r||n,n)<0&&(n=(o=[r,n])[0],r=o[1]),"string"==typeof t&&(t=e.splitLines(t)),Ji(e,{from:n,to:r,text:t,origin:i})}function oo(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function lo(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i],l=!0;if(o.ranges){o.copied||((o=e[i]=o.deepCopy()).copied=!0);for(var s=0;s<o.ranges.length;s++)oo(o.ranges[s].anchor,t,n,r),oo(o.ranges[s].head,t,n,r)}else{for(var a=0;a<o.changes.length;++a){var u=o.changes[a];if(n<u.from.line)u.from=H(u.from.line+r,u.from.ch),u.to=H(u.to.line+r,u.to.ch);else if(t<=u.to.line){l=!1;break}}l||(e.splice(0,i+1),i=0)}}}function so(e,t){var n=t.from.line,r=t.to.line,t=t.text.length-(r-n)-1;lo(e.done,n,r,t),lo(e.undone,n,r,t)}function ao(e,t,n,r){var i=t,o=t;return"number"==typeof t?o=D(e,Lt(e,t)):i=W(t),null==i?null:(r(o,i)&&e.cm&&gr(e.cm,i,n),o)}function uo(e){this.lines=e,this.parent=null;for(var t=0,n=0;n<e.length;++n)e[n].parent=this,t+=e[n].height;this.height=t}function co(e){this.children=e;for(var t=0,n=0,r=0;r<e.length;++r){var i=e[r];t+=i.chunkSize(),n+=i.height,i.parent=this}this.size=t,this.height=n,this.parent=null}B.prototype.from=function(){return St(this.anchor,this.head)},B.prototype.to=function(){return Ct(this.anchor,this.head)},B.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},uo.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n,r=e,i=e+t;r<i;++r){var o=this.lines[r];this.height-=o.height,(n=o).parent=null,Kt(n),b(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;e<r;++e)if(n(this.lines[e]))return!0}},co.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n,r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<o){var l=Math.min(t,o-e),s=i.height;if(i.removeInner(e,l),this.height-=s-i.height,o==l&&(this.children.splice(r--,1),i.parent=null),0==(t-=l))break;e=0}else e-=o}this.size-t<25&&(1<this.children.length||!(this.children[0]instanceof uo))&&(this.collapse(n=[]),this.children=[new uo(n)],this.children[0].parent=this)},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<=o){if(i.insertInner(e,t,n),i.lines&&50<i.lines.length){for(var l=i.lines.length%25+25,s=l;s<i.lines.length;){var a=new uo(i.lines.slice(s,s+=25));i.height-=a.height,this.children.splice(++r,0,a),a.parent=this}i.lines=i.lines.slice(0,l),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t,n=new co(e.children.splice(e.children.length-5,5))}while(e.parent?(e.size-=n.size,e.height-=n.height,t=S(e.parent.children,e),e.parent.children.splice(t+1,0,n)):(((t=new co(e.children)).parent=e).children=[t,n],e=t),n.parent=e.parent,10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<o){var l=Math.min(t,o-e);if(i.iterN(e,l,n))return!0;if(0==(t-=l))break;e=0}else e-=o}}};function ho(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.doc=e,this.node=t}function fo(e,t,n){rn(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Wr(e,n)}ho.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,r=W(n);if(null!=r&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(n.widgets=null);var o=Mn(this);mt(n,Math.max(0,n.height-o)),e&&(h(e,function(){fo(e,n,-o),gr(e,r,"widget")}),b(e,"lineWidgetCleared",e,this,r))}},ho.prototype.changed=function(){var e=this,t=this.height,n=this.doc.cm,r=this.line,i=(this.height=null,Mn(this)-t);i&&(nn(this.doc,r)||mt(r,r.height+i),n)&&h(n,function(){n.curOp.forceUpdate=!0,fo(n,r,i),b(n,"lineWidgetChanged",n,e,W(r))})},Xe(ho);function po(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++go}var go=0;function mo(r,i,o,e,t){if(e&&e.shared)return f=r,n=i,l=o,a=t,(s=ce(s=e)).shared=!1,u=[mo(f,n,l,s,a)],c=u[0],h=s.widgetNode,ki(f,function(e){h&&(s.widgetNode=h.cloneNode(!0)),u.push(mo(e,P(e,n),P(e,l),s,a));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;c=I(u)}),new vo(u,c);var n,l,s,a,u,c,h;if(r.cm&&!r.cm.curOp)return z(r.cm,mo)(r,i,o,e,t);var d=new po(r,t),f=F(i,o);if(e&&ce(e,d,!1),!(0<f||0==f&&!1!==d.clearWhenEmpty)){if(d.replacedWith&&(d.collapsed=!0,d.widgetNode=te("span",[d.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||d.widgetNode.setAttribute("cm-ignore-events","true"),e.insertLeft)&&(d.widgetNode.insertLeft=!0),d.collapsed){if(Qt(r,i.line,i,o,d)||i.line!=o.line&&Qt(r,o.line,i,o,d))throw new Error("Inserting collapsed marker partially overlapping an existing one");Rt=!0}d.addToHistory&&Di(r,{from:i,to:o,origin:"markText"},r.sel,NaN);var p,g=i.line,m=r.cm;if(r.iter(g,o.line+1,function(e){var t,n;m&&d.collapsed&&!m.options.lineWrapping&&Jt(e)==m.display.maxLine&&(p=!0),d.collapsed&&g!=i.line&&mt(e,0),e=e,t=new Bt(d,g==i.line?i.ch:null,g==o.line?o.ch:null),(n=(n=r.cm&&r.cm.curOp)&&window.WeakSet&&(n.markedSpans||(n.markedSpans=new WeakSet)))&&e.markedSpans&&n.has(e.markedSpans)?e.markedSpans.push(t):(e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],n&&n.add(e.markedSpans)),t.marker.attachLine(e),++g}),d.collapsed&&r.iter(i.line,o.line+1,function(e){nn(r,e)&&mt(e,0)}),d.clearOnEnter&&L(d,"beforeCursorEnter",function(){return d.clear()}),d.readOnly&&(It=!0,r.history.done.length||r.history.undone.length)&&r.clearHistory(),d.collapsed&&(d.id=++go,d.atomic=!0),m){if(p&&(m.curOp.updateMaxLine=!0),d.collapsed)E(m,i.line,o.line+1);else if(d.className||d.startStyle||d.endStyle||d.css||d.attributes||d.title)for(var v=i.line;v<=o.line;v++)gr(m,v,"text");d.atomic&&Xi(m.doc),b(m,"markerAdded",m,d)}}return d}po.prototype.clear=function(){if(!this.explicitlyCleared){for(var e,t=this.doc.cm,n=t&&!t.curOp,r=(n&&$r(t),je(this,"clear")&&(e=this.find())&&b(this,"clear",e.from,e.to),null),i=null,o=0;o<this.lines.length;++o){var l=this.lines[o],s=Gt(l.markedSpans,this);t&&!this.collapsed?gr(t,W(l),"text"):t&&(null!=s.to&&(i=W(l)),null!=s.from)&&(r=W(l)),l.markedSpans=function(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n=n||[]).push(e[r]);return n}(l.markedSpans,s),null==s.from&&this.collapsed&&!nn(this.doc,l)&&t&&mt(l,sr(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var a=0;a<this.lines.length;++a){var u=Jt(this.lines[a]),c=on(u);c>t.display.maxLineLength&&(t.display.maxLine=u,t.display.maxLineLength=c,t.display.maxLineChanged=!0)}null!=r&&t&&this.collapsed&&E(t,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t)&&Xi(t.doc),t&&b(t,"markerCleared",t,this,r,i),n&&_r(t),this.parent&&this.parent.clear()}},po.prototype.find=function(e,t){var n,r;null==e&&"bookmark"==this.type&&(e=1);for(var i=0;i<this.lines.length;++i){var o=this.lines[i],l=Gt(o.markedSpans,this);if(null!=l.from&&(n=H(t?o:W(o),l.from),-1==e))return n;if(null!=l.to&&(r=H(t?o:W(o),l.to),1==e))return r}return n&&{from:n,to:r}},po.prototype.changed=function(){var n=this,r=this.find(-1,!0),i=this,o=this.doc.cm;r&&o&&h(o,function(){var e=r.line,t=W(r.line),t=zn(o,t);t&&(Vn(t),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,!nn(i.doc,e)&&null!=i.height&&(t=i.height,i.height=null,t=Mn(i)-t)&&mt(e,e.height+t),b(o,"markerChanged",o,n)})},po.prototype.attachLine=function(e){var t;this.lines.length||!this.doc.cm||(t=this.doc.cm.curOp).maybeHiddenMarkers&&-1!=S(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this),this.lines.push(e)},po.prototype.detachLine=function(e){this.lines.splice(S(this.lines,e),1),!this.lines.length&&this.doc.cm&&((e=this.doc.cm.curOp).maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},Xe(po);var vo=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};function yo(e){return e.findMarks(H(e.first,0),e.clipPos(H(e.lastLine())),function(e){return e.parent})}function bo(o){for(var e=0;e<o.length;e++)!function(e){var t=o[e],n=[t.primary.doc];ki(t.primary.doc,function(e){return n.push(e)});for(var r=0;r<t.markers.length;r++){var i=t.markers[r];-1==S(n,i.doc)&&(i.parent=null,t.markers.splice(r--,1))}}(e)}vo.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();b(this,"clear")}},vo.prototype.find=function(e,t){return this.primary.find(e,t)},Xe(vo);function f(e,t,n,r,i){if(!(this instanceof f))return new f(e,t,n,r,i);null==n&&(n=0),co.call(this,[new uo([new sn("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,n=H(this.modeFrontier=this.highlightFrontier=n,0),this.sel=mi(n),this.history=new Ni(null),this.id=++wo,this.modeOption=t,this.lineSep=r,this.direction="rtl"==i?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Li(this,{from:n,to:n,text:e}),G(this,mi(n),ge)}var wo=0,xo=((f.prototype=Se(co.prototype,{constructor:f,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=gt(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:r(function(e){var t=H(this.first,0),n=this.first+this.size-1;Ji(this,{from:t,to:H(n,D(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&Fr(this.cm,0,0),G(this,mi(t),ge)}),replaceRange:function(e,t,n,r){io(this,e,t=P(this,t),n=n?P(this,n):t,r)},getRange:function(e,t,n){e=pt(this,P(this,e),P(this,t));return!1===n?e:""===n?e.join(""):e.join(n||this.lineSeparator())},getLine:function(e){e=this.getLineHandle(e);return e&&e.text},getLineHandle:function(e){if(yt(this,e))return D(this,e)},getLineNumber:W,getLineHandleVisualStart:function(e){return Jt(e="number"==typeof e?D(this,e):e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return P(this,e)},getCursor:function(e){var t=this.sel.primary(),e=null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from();return e},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:r(function(e,t,n){Ui(this,P(this,"number"==typeof e?H(e,t||0):e),null,n)}),setSelection:r(function(e,t,n){Ui(this,P(this,e),P(this,t||e),n)}),extendSelection:r(function(e,t,n){Ri(this,P(this,e),t&&P(this,t),n)}),extendSelections:r(function(e,t){Bi(this,kt(this,e),t)}),extendSelectionsBy:r(function(e,t){Bi(this,kt(this,xe(this.sel.ranges,e)),t)}),setSelections:r(function(e,t,n){if(e.length){for(var r=[],i=0;i<e.length;i++)r[i]=new B(P(this,e[i].anchor),P(this,e[i].head||e[i].anchor));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),G(this,gi(this.cm,r,t),n)}}),addSelection:r(function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new B(P(this,e),P(this,t||e))),G(this,gi(this.cm,r,r.length-1),n)}),getSelection:function(e){for(var t=this.sel.ranges,n=0;n<t.length;n++)var r=pt(this,t[n].from(),t[n].to()),i=i?i.concat(r):r;return!1===e?i:i.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,r=0;r<n.length;r++){var i=pt(this,n[r].from(),n[r].to());!1!==e&&(i=i.join(e||this.lineSeparator())),t[r]=i}return t},replaceSelection:function(e,t,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:r(function(e,t,n){for(var r=[],i=this.sel,o=0;o<i.ranges.length;o++){var l=i.ranges[o];r[o]={from:l.from(),to:l.to(),text:this.splitLines(e[o]),origin:n}}for(var t=t&&"end"!=t&&function(e,t,n){for(var r=[],i=u=H(e.first,0),o=0;o<t.length;o++){var l=t[o],s=wi(l.from,u,i),a=wi(vi(l),u,i),u=l.to,i=a;"around"==n?(l=F((l=e.sel.ranges[o]).head,l.anchor)<0,r[o]=new B(l?a:s,l?s:a)):r[o]=new B(s,s)}return new R(r,e.sel.primIndex)}(this,r,t),s=r.length-1;0<=s;s--)Ji(this,r[s]);t?Vi(this,t):this.cm&&Hr(this.cm)}),undo:r(function(){to(this,"undo")}),redo:r(function(){to(this,"redo")}),undoSelection:r(function(){to(this,"undo",!0)}),redoSelection:r(function(){to(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){var t=this;this.history=new Ni(this.history),ki(this,function(e){return e.history=t.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:zi(this.history.done),undone:zi(this.history.undone)}},setHistory:function(e){var t=this.history=new Ni(this.history);t.done=zi(e.done.slice(0),null,!0),t.undone=zi(e.undone.slice(0),null,!0)},setGutterMarker:r(function(e,n,r){return ao(this,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[n]=r)&&Me(t)&&(e.gutterMarkers=null),1})}),clearGutter:r(function(t){var n=this;this.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&ao(n,e,"gutter",function(){return e.gutterMarkers[t]=null,Me(e.gutterMarkers)&&(e.gutterMarkers=null),1})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!yt(this,e))return null;if(!(e=D(this,t=e)))return null}else if(null==(t=W(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:r(function(e,n,r){return ao(this,e,"gutter"==n?"gutter":"class",function(e){var t="text"==n?"textClass":"background"==n?"bgClass":"gutter"==n?"gutterClass":"wrapClass";if(e[t]){if(Q(r).test(e[t]))return;e[t]+=" "+r}else e[t]=r;return 1})}),removeLineClass:r(function(e,o,l){return ao(this,e,"gutter"==o?"gutter":"class",function(e){var t="text"==o?"textClass":"background"==o?"bgClass":"gutter"==o?"gutterClass":"wrapClass",n=e[t];if(n){if(null==l)e[t]=null;else{var r=n.match(Q(l));if(!r)return;var i=r.index+r[0].length;e[t]=n.slice(0,r.index)+(r.index&&i!=n.length?" ":"")+n.slice(i)||null}return 1}})}),addLineWidget:r(function(e,t,n){return e=e,i=new ho(r=this,t,n),(o=r.cm)&&i.noHScroll&&(o.display.alignWidgets=!0),ao(r,e,"widget",function(e){var t=e.widgets||(e.widgets=[]);return null==i.insertAt?t.push(i):t.splice(Math.min(t.length,Math.max(0,i.insertAt)),0,i),i.line=e,o&&!nn(r,e)&&(t=rn(e)<r.scrollTop,mt(e,e.height+Mn(i)),t&&Wr(o,i.height),o.curOp.forceUpdate=!0),1}),o&&b(o,"lineWidgetAdded",o,i,"number"==typeof e?e:W(e)),i;var r,i,o}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return mo(this,P(this,e),P(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){t={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return mo(this,e=P(this,e),e,t,"bookmark")},findMarksAt:function(e){var t=[],n=D(this,(e=P(this,e)).line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(i,o,l){i=P(this,i),o=P(this,o);var s=[],a=i.line;return this.iter(i.line,o.line+1,function(e){var t=e.markedSpans;if(t)for(var n=0;n<t.length;n++){var r=t[n];null!=r.to&&a==i.line&&i.ch>=r.to||null==r.from&&a!=i.line||null!=r.from&&a==o.line&&r.from>=o.ch||l&&!l(r.marker)||s.push(r.marker.parent||r.marker)}++a}),s},getAllMarks:function(){var r=[];return this.iter(function(e){var t=e.markedSpans;if(t)for(var n=0;n<t.length;++n)null!=t[n].from&&r.push(t[n].marker)}),r},posFromIndex:function(t){var n,r=this.first,i=this.lineSeparator().length;return this.iter(function(e){e=e.text.length+i;if(t<e)return n=t,!0;t-=e,++r}),P(this,H(r,n))},indexFromPos:function(e){var t,n=(e=P(this,e)).ch;return e.line<this.first||e.ch<0?0:(t=this.lineSeparator().length,this.iter(this.first,e.line,function(e){n+=e.text.length+t}),n)},copy:function(e){var t=new f(gt(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){for(var t=this.first,n=this.first+this.size,n=(null!=(e=e||{}).from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to),new f(gt(this,t,n),e.mode||this.modeOption,t,this.lineSep,this.direction)),r=(e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],n),i=yo(this),o=0;o<i.length;o++){var l=i[o],s=l.find(),a=r.clipPos(s.from),s=r.clipPos(s.to);F(a,s)&&(a=mo(r,a,s,l.primary,l.primary.type),l.markers.push(a),a.parent=l)}return n},unlinkDoc:function(e){if(e instanceof p&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){var n=this.linked[t];if(n.doc==e){this.linked.splice(t,1),e.unlinkDoc(this),bo(yo(this));break}}var r;e.history==this.history&&(r=[e.id],ki(e,function(e){return r.push(e.id)},!0),e.history=new Ni(null),e.history.done=zi(this.history.done,r),e.history.undone=zi(this.history.undone,r))},iterLinkedDocs:function(e){ki(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):tt(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:r(function(e){var t;(e="rtl"!=e?"ltr":e)!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm)&&h(t=this.cm,function(){Mi(t),E(t)})})})).eachLine=f.prototype.iter,0);function Co(e){var r=this;if(So(r),!A(r,e)&&!Nn(r.display,e)){T(e),w&&(xo=+new Date);var t=fr(r,e,!0),n=e.dataTransfer.files;if(t&&!r.isReadOnly())if(n&&n.length&&window.FileReader&&window.File)for(var i=n.length,o=Array(i),l=0,s=function(){++l==i&&z(r,function(){var e={from:t=P(r.doc,t),to:t,text:r.doc.splitLines(o.filter(function(e){return null!=e}).join(r.doc.lineSeparator())),origin:"paste"};Ji(r.doc,e),Vi(r.doc,mi(P(r.doc,t),P(r.doc,vi(e))))})()},a=0;a<n.length;a++)!function(e,t){var n;r.options.allowDropFileTypes&&-1==S(r.options.allowDropFileTypes,e.type)?s():((n=new FileReader).onerror=function(){return s()},n.onload=function(){var e=n.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)||(o[t]=e),s()},n.readAsText(e))}(n[a],a);else if(r.state.draggingText&&-1<r.doc.sel.contains(t))r.state.draggingText(e),setTimeout(function(){return r.display.input.focus()},20);else try{var u,c=e.dataTransfer.getData("Text");if(c){if(r.state.draggingText&&!r.state.draggingText.copy&&(u=r.listSelections()),Ki(r.doc,mi(t,t)),u)for(var h=0;h<u.length;++h)io(r.doc,"",u[h].anchor,u[h].head,"drag");r.replaceSelection(c,"around","paste"),r.display.input.focus()}}catch(e){}}}function So(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Lo(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),n=[],r=0;r<e.length;r++){var i=e[r].CodeMirror;i&&n.push(i)}n.length&&n[0].operation(function(){for(var e=0;e<n.length;e++)t(n[e])})}}var ko=!1;function To(){var e;ko||(L(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Lo(Mo)},100))}),L(window,"blur",function(){return Lo(Mr)}),ko=!0)}function Mo(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var No={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Oo=0;Oo<10;Oo++)No[Oo+48]=No[Oo+96]=String(Oo);for(var Ao=65;Ao<=90;Ao++)No[Ao]=String.fromCharCode(Ao);for(var Do=1;Do<=12;Do++)No[Do+111]=No[Do+63235]="F"+Do;var Wo={};function Ho(e){var t,n,r,i,o=e.split(/-(?!$)/);e=o[o.length-1];for(var l=0;l<o.length-1;l++){var s=o[l];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)?$/i.test(s))throw new Error("Unrecognized modifier name: "+s);r=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),e=r?"Shift-"+e:e}function Fo(e){var t,n,r={};for(t in e)if(e.hasOwnProperty(t)){var i=e[t];if(!/^(name|fallthrough|(de|at)tach)$/.test(t)){if("..."!=i)for(var o=xe(t.split(" "),Ho),l=0;l<o.length;l++){var s=void 0,a=void 0,s=l==o.length-1?(a=o.join(" "),i):(a=o.slice(0,l+1).join(" "),"..."),u=r[a];if(u){if(u!=s)throw new Error("Inconsistent bindings for "+a)}else r[a]=s}delete e[t]}}for(n in r)e[n]=r[n];return e}function Po(e,t,n,r){var i=(t=Ro(t)).call?t.call(e,r):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Po(e,t.fallthrough,n,r);for(var o=0;o<t.fallthrough.length;o++){var l=Po(e,t.fallthrough[o],n,r);if(l)return l}}}function Eo(e){e="string"==typeof e?e:No[e.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function zo(e,t,n){var r=e;return t.altKey&&"Alt"!=r&&(e="Alt-"+e),(q?t.metaKey:t.ctrlKey)&&"Ctrl"!=r&&(e="Ctrl-"+e),(q?t.ctrlKey:t.metaKey)&&"Mod"!=r&&(e="Cmd-"+e),e=!n&&t.shiftKey&&"Shift"!=r?"Shift-"+e:e}function Io(e,t){var n;return!(K&&34==e.keyCode&&e.char||null==(n=No[e.keyCode])||e.altGraphKey)&&zo(n=3==e.keyCode&&e.code?e.code:n,e,t)}function Ro(e){return"string"==typeof e?Wo[e]:e}function Bo(t,e){for(var n=t.doc.sel.ranges,r=[],i=0;i<n.length;i++){for(var o=e(n[i]);r.length&&F(o.from,I(r).to)<=0;){var l=r.pop();if(F(l.from,o.from)<0){o.from=l.from;break}}r.push(o)}h(t,function(){for(var e=r.length-1;0<=e;e--)io(t.doc,"",r[e].from,r[e].to,"+delete");Hr(t)})}function Go(e,t,n){t=Ae(e.text,t+n,n);return t<0||t>e.text.length?null:t}function Uo(e,t,n){e=Go(e,t.ch,n);return null==e?null:new H(t.line,e,n<0?"after":"before")}function Vo(e,t,n,r,i){if(e){"rtl"==t.doc.direction&&(i=-i);var o,l,s,a,e=Ge(n,t.doc.direction);if(e)return o=i<0==(1==(e=i<0?I(e):e[0]).level)?"after":"before",0<e.level||"rtl"==t.doc.direction?(l=In(t,n),s=i<0?n.text.length-1:0,a=Rn(t,l,s).top,s=De(function(e){return Rn(t,l,e).top==a},i<0==(1==e.level)?e.from:e.to-1,s),"before"==o&&(s=Go(n,s,1))):s=i<0?e.to:e.from,new H(r,s,o)}return new H(r,i<0?n.text.length:0,i<0?"before":"after")}function Ko(t,n,s,e){var a=Ge(n,t.doc.direction);if(!a)return Uo(n,s,e);s.ch>=n.text.length?(s.ch=n.text.length,s.sticky="before"):s.ch<=0&&(s.ch=0,s.sticky="after");var r=He(a,s.ch,s.sticky),i=a[r];if("ltr"==t.doc.direction&&i.level%2==0&&(0<e?i.to>s.ch:i.from<s.ch))return Uo(n,s,e);function u(e,t){return Go(n,e instanceof H?e.ch:e,t)}function o(e){return t.options.lineWrapping?(l=l||In(t,n),rr(t,n,l,e)):{begin:0,end:n.text.length}}var l,c=o("before"==s.sticky?u(s,-1):s.ch);if("rtl"==t.doc.direction||1==i.level){var h=1==i.level==e<0,d=u(s,h?1:-1);if(null!=d&&(h?d<=i.to&&d<=c.end:d>=i.from&&d>=c.begin))return new H(s.line,d,h?"before":"after")}function f(e,t,n){for(var r=function(e,t){return t?new H(s.line,u(e,1),"before"):new H(s.line,e,"after")};0<=e&&e<a.length;e+=t){var i=a[e],o=0<t==(1!=i.level),l=o?n.begin:u(n.end,-1);if(i.from<=l&&l<i.to)return r(l,o);if(l=o?i.from:u(i.to,-1),n.begin<=l&&l<n.end)return r(l,o)}}i=f(r+e,e,c);return i||(null==(d=0<e?c.end:u(c.begin,-1))||0<e&&d==n.text.length||!(i=f(0<e?0:a.length-1,e,o(d)))?null:i)}Wo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Wo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Wo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Wo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Wo.default=C?Wo.macDefault:Wo.pcDefault;var jo={selectAll:Zi,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),ge)},killLine:function(n){return Bo(n,function(e){var t;return e.empty()?(t=D(n.doc,e.head.line).text.length,e.head.ch==t&&e.head.line<n.lastLine()?{from:e.head,to:H(e.head.line+1,0)}:{from:e.head,to:H(e.head.line,t)}):{from:e.from(),to:e.to()}})},deleteLine:function(t){return Bo(t,function(e){return{from:H(e.from().line,0),to:P(t.doc,H(e.to().line+1,0))}})},delLineLeft:function(e){return Bo(e,function(e){return{from:H(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(n){return Bo(n,function(e){var t=n.charCoords(e.head,"div").top+5;return{from:n.coordsChar({left:0,top:t},"div"),to:e.from()}})},delWrappedLineRight:function(n){return Bo(n,function(e){var t=n.charCoords(e.head,"div").top+5,t=n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:t}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(H(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(H(e.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return Xo(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return Yo(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(i){return i.extendSelectionsBy(function(e){var t=i,e=e.head.line,n=D(t.doc,e),r=function(e){for(var t;t=Zt(e);)e=t.find(1,!0).line;return e}(n);return r!=n&&(e=W(r)),Vo(!0,t,n,e,-1)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:e},"div")},ve)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:e},"div")},ve)},goLineLeftSmart:function(n){return n.extendSelectionsBy(function(e){var t=n.cursorCoords(e.head,"div").top+5,t=n.coordsChar({left:0,top:t},"div");return t.ch<n.getLine(t.line).search(/\S/)?Yo(n,e.head):t},ve)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),r=e.options.tabSize,i=0;i<n.length;i++){var o=n[i].from(),o=he(e.getLine(o.line),o.ch,r);t.push(we(r-o%r))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(l){return h(l,function(){for(var e,t,n,r=l.listSelections(),i=[],o=0;o<r.length;o++)r[o].empty()&&(e=r[o].head,(t=D(l.doc,e.line).text)&&(0<(e=e.ch==t.length?new H(e.line,e.ch-1):e).ch?(e=new H(e.line,e.ch+1),l.replaceRange(t.charAt(e.ch-1)+t.charAt(e.ch-2),H(e.line,e.ch-2),e,"+transpose")):e.line>l.doc.first&&(n=D(l.doc,e.line-1).text)&&(e=new H(e.line,1),l.replaceRange(t.charAt(0)+l.doc.lineSeparator()+n.charAt(n.length-1),H(e.line-1,n.length-1),e,"+transpose"))),i.push(new B(e,e)));l.setSelections(i)})},newlineAndIndent:function(r){return h(r,function(){for(var e=(t=r.listSelections()).length-1;0<=e;e--)r.replaceRange(r.doc.lineSeparator(),t[e].anchor,t[e].head,"+input");for(var t=r.listSelections(),n=0;n<t.length;n++)r.indentLine(t[n].from().line,null,!0);Hr(r)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Xo(e,t){var n=D(e.doc,t),r=Jt(n);return Vo(!0,e,r,t=r!=n?W(r):t,1)}function Yo(e,t){var n=Xo(e,t.line),r=D(e.doc,n.line),e=Ge(r,e.doc.direction);return e&&0!=e[0].level?n:(e=Math.max(n.ch,r.text.search(/\S/)),r=t.line==n.line&&t.ch<=e&&t.ch,H(n.line,r?0:e,n.sticky))}function $o(e,t,n){if("string"==typeof t&&!(t=jo[t]))return!1;e.display.input.ensurePolled();var r=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=pe}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}var _o=new de;function qo(e,t,n,r){var i=e.state.keySeq;if(i){if(Eo(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:_o.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())}),Zo(e,i+" "+t,n,r))return!0}return Zo(e,t,n,r)}function Zo(e,t,n,r){r=function(e,t,n){for(var r=0;r<e.state.keyMaps.length;r++){var i=Po(t,e.state.keyMaps[r],n,e);if(i)return i}return e.options.extraKeys&&Po(t,e.options.extraKeys,n,e)||Po(t,e.options.keyMap,n,e)}(e,t,r);return"multi"==r&&(e.state.keySeq=t),"handled"==r&&b(e,"keyHandled",e,t,n),"handled"!=r&&"multi"!=r||(T(n),Sr(e)),!!r}function Qo(t,e){var n=Io(e,!0);return!!n&&(e.shiftKey&&!t.state.keySeq?qo(t,"Shift-"+n,e,function(e){return $o(t,e,!0)})||qo(t,n,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return $o(t,e)}):qo(t,n,e,function(e){return $o(t,e)}))}var Jo=null;function el(e){var t,n,r,i=this;function o(e){18!=e.keyCode&&e.altKey||(J(r,"CodeMirror-crosshair"),k(document,"keyup",o),k(document,"mouseover",o))}e.target&&e.target!=i.display.input.getField()||(i.curOp.focus=N(se(i)),A(i,e))||(w&&v<11&&27==e.keyCode&&(e.returnValue=!1),t=e.keyCode,i.display.shift=16==t||e.shiftKey,n=Qo(i,e),K&&(Jo=n?t:null,!n)&&88==t&&!rt&&(C?e.metaKey:e.ctrlKey)&&i.replaceSelection("",null,"cut"),m&&!C&&!n&&46==t&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=t)||/\bCodeMirror-crosshair\b/.test(i.display.lineDiv.className)||(re(r=i.display.lineDiv,"CodeMirror-crosshair"),L(document,"keyup",o),L(document,"mouseover",o))}function tl(e){16==e.keyCode&&(this.doc.sel.shift=!1),A(this,e)}function nl(e){var t,n,r,i=this;e.target&&e.target!=i.display.input.getField()||Nn(i.display,e)||A(i,e)||e.ctrlKey&&!e.altKey||C&&e.metaKey||(n=e.keyCode,t=e.charCode,K&&n==Jo?(Jo=null,T(e)):K&&(!e.which||e.which<10)&&Qo(i,e)||"\b"==(n=String.fromCharCode(null==t?n:t))||qo(r=i,"'"+n+"'",e,function(e){return $o(r,e,!0)})||i.display.input.onKeyPress(e))}function rl(e,t,n){this.time=e,this.pos=t,this.button=n}var il,ol;function ll(e){var t,n,r,i,o,l,s,a,u,c=this,h=c.display;A(c,e)||h.activeTouch&&h.input.supportsTouch()||(h.input.ensurePolled(),h.shift=e.shiftKey,Nn(h,e)?x||(h.scroller.draggable=!1,setTimeout(function(){return h.scroller.draggable=!0},100)):ul(c,e)||(t=fr(c,e),n=Ze(e),r=t?(i=t,o=n,r=+new Date,ol&&ol.compare(r,i,o)?(il=ol=null,"triple"):il&&il.compare(r,i,o)?(ol=new rl(r,i,o),il=null,"double"):(il=new rl(r,i,o),ol=null,"single")):"single",ae(c).focus(),1==n&&c.state.selectingText&&c.state.selectingText(e),t&&function(n,e,r,t,i){var o="Click";"double"==t?o="Double"+o:"triple"==t&&(o="Triple"+o);return qo(n,zo(o=(1==e?"Left":2==e?"Middle":"Right")+o,i),i,function(e){if(!(e="string"==typeof e?jo[e]:e))return!1;var t=!1;try{n.isReadOnly()&&(n.state.suppressEdits=!0),t=e(n,r)!=pe}finally{n.state.suppressEdits=!1}return t})}(c,n,t,r,e))||(1==n?t?(i=c,o=t,l=r,s=e,w?setTimeout(ue(Lr,i),0):i.curOp.focus=N(se(i)),a=function(e,t,n){var r=e.getOption("configureMouse"),r=r?r(e,t,n):{};{var i;null==r.unit&&(i=_?n.shiftKey&&n.metaKey:n.altKey,r.unit=i?"rectangle":"single"==t?"char":"double"==t?"word":"line")}null!=r.extend&&!e.doc.extend||(r.extend=e.doc.extend||n.shiftKey);null==r.addNew&&(r.addNew=C?n.metaKey:n.ctrlKey);null==r.moveOnDrag&&(r.moveOnDrag=!(C?n.altKey:n.ctrlKey));return r}(i,l,s),u=i.doc.sel,(i.options.dragDrop&&et&&!i.isReadOnly()&&"single"==l&&-1<(l=u.contains(o))&&(F((l=u.ranges[l]).from(),o)<0||0<o.xRel)&&(0<F(l.to(),o)||o.xRel<0)?function(t,n,r,i){var o=t.display,l=!1,s=z(t,function(e){x&&(o.scroller.draggable=!1),t.state.draggingText=!1,t.state.delayingBlurEvent&&(t.hasFocus()?t.state.delayingBlurEvent=!1:kr(t)),k(o.wrapper.ownerDocument,"mouseup",s),k(o.wrapper.ownerDocument,"mousemove",a),k(o.scroller,"dragstart",u),k(o.scroller,"drop",s),l||(T(e),i.addNew||Ri(t.doc,r,null,null,i.extend),x&&!j||w&&9==v?setTimeout(function(){o.wrapper.ownerDocument.body.focus({preventScroll:!0}),o.input.focus()},20):o.input.focus())}),a=function(e){l=l||10<=Math.abs(n.clientX-e.clientX)+Math.abs(n.clientY-e.clientY)},u=function(){return l=!0};x&&(o.scroller.draggable=!0);(t.state.draggingText=s).copy=!i.moveOnDrag,L(o.wrapper.ownerDocument,"mouseup",s),L(o.wrapper.ownerDocument,"mousemove",a),L(o.scroller,"dragstart",u),L(o.scroller,"drop",s),t.state.delayingBlurEvent=!0,setTimeout(function(){return o.input.focus()},20),o.scroller.dragDrop&&o.scroller.dragDrop()}:function(d,e,f,p){w&&kr(d);var l=d.display,g=d.doc;T(e);var m,v,y=g.sel,t=y.ranges;p.addNew&&!p.extend?(v=g.sel.contains(f),m=-1<v?t[v]:new B(f,f)):(m=g.sel.primary(),v=g.sel.primIndex);"rectangle"==p.unit?(p.addNew||(m=new B(f,f)),f=fr(d,e,!0,!0),v=-1):(e=sl(d,f,p.unit),m=p.extend?Ii(m,e.anchor,e.head,p.extend):e);p.addNew?-1==v?(v=t.length,G(g,gi(d,t.concat([m]),v),{scroll:!1,origin:"*mouse"})):1<t.length&&t[v].empty()&&"char"==p.unit&&!p.extend?(G(g,gi(d,t.slice(0,v).concat(t.slice(v+1)),0),{scroll:!1,origin:"*mouse"}),y=g.sel):Gi(g,v,m,me):(G(g,new R([m],v=0),me),y=g.sel);var b=f;function s(e){if(0!=F(b,e))if(b=e,"rectangle"==p.unit){for(var t=[],n=d.options.tabSize,r=he(D(g,f.line).text,f.ch,n),i=he(D(g,e.line).text,e.ch,n),o=Math.min(r,i),l=Math.max(r,i),s=Math.min(f.line,e.line),a=Math.min(d.lastLine(),Math.max(f.line,e.line));s<=a;s++){var u=D(g,s).text,c=ye(u,o,n);o==l?t.push(new B(H(s,c),H(s,c))):u.length>c&&t.push(new B(H(s,c),H(s,ye(u,l,n))))}t.length||t.push(new B(f,f)),G(g,gi(d,y.ranges.slice(0,v).concat(t),v),{origin:"*mouse",scroll:!1}),d.scrollIntoView(e)}else{var h,r=m,i=sl(d,e,p.unit),e=r.anchor,e=0<F(i.anchor,e)?(h=i.head,St(r.from(),i.anchor)):(h=i.anchor,Ct(r.to(),i.head)),r=y.ranges.slice(0);r[v]=function(e,t){var n=t.anchor,r=t.head,i=D(e.doc,n.line);if(0==F(n,r)&&n.sticky==r.sticky)return t;i=Ge(i);if(!i)return t;var o=He(i,n.ch,n.sticky),l=i[o];if(l.from!=n.ch&&l.to!=n.ch)return t;var s=o+(l.from==n.ch==(1!=l.level)?0:1);if(0==s||s==i.length)return t;l=r.line!=n.line?0<(r.line-n.line)*("ltr"==e.doc.direction?1:-1):(e=He(i,r.ch,r.sticky),o=e-o||(r.ch-n.ch)*(1==l.level?-1:1),e==s-1||e==s?o<0:0<o);e=i[s+(l?-1:0)],o=l==(1==e.level),i=o?e.from:e.to,s=o?"after":"before";return n.ch==i&&n.sticky==s?t:new B(new H(n.line,i,s),r)}(d,new B(P(g,e),h)),G(g,gi(d,r,v),me)}}var a=l.wrapper.getBoundingClientRect(),u=0;function n(e){d.state.selectingText=!1,u=1/0,e&&(T(e),l.input.focus()),k(l.wrapper.ownerDocument,"mousemove",r),k(l.wrapper.ownerDocument,"mouseup",i),g.history.lastSelOrigin=null}var r=z(d,function(e){(0!==e.buttons&&Ze(e)?function e(t){var n,r,i=++u,o=fr(d,t,!0,"rectangle"==p.unit);o&&(0!=F(o,b)?(d.curOp.focus=N(se(d)),s(o),n=Ar(l,g),(o.line>=n.to||o.line<n.from)&&setTimeout(z(d,function(){u==i&&e(t)}),150)):(r=t.clientY<a.top?-20:t.clientY>a.bottom?20:0)&&setTimeout(z(d,function(){u==i&&(l.scroller.scrollTop+=r,e(t))}),50))}:n)(e)}),i=z(d,n);d.state.selectingText=i,L(l.wrapper.ownerDocument,"mousemove",r),L(l.wrapper.ownerDocument,"mouseup",i)})(i,s,o,a)):qe(e)==h.scroller&&T(e):2==n?(t&&Ri(c.doc,t),setTimeout(function(){return h.input.focus()},20)):3==n&&(Z?c.display.input.onContextMenu(e):kr(c))))}function sl(e,t,n){return"char"==n?new B(t,t):"word"==n?e.findWordAt(t):"line"==n?new B(H(t.line,0),P(e.doc,H(t.line+1,0))):(n=n(e,t),new B(n.from,n.to))}function al(e,t,n,r){var i,o;if(t.touches)i=t.touches[0].clientX,o=t.touches[0].clientY;else try{i=t.clientX,o=t.clientY}catch(e){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&T(t);var l=e.display,r=l.lineDiv.getBoundingClientRect();if(o>r.bottom||!je(e,n))return $e(t);o-=r.top-l.viewOffset;for(var s=0;s<e.display.gutterSpecs.length;++s){var a=l.gutters.childNodes[s];if(a&&a.getBoundingClientRect().right>=i)return O(e,n,e,vt(e.doc,o),e.display.gutterSpecs[s].className,t),$e(t)}}function ul(e,t){return al(e,t,"gutterClick",!0)}function cl(e,t){var n,r;Nn(e.display,t)||(r=t,je(n=e,"gutterContextMenu")&&al(n,r,"gutterContextMenu",!1))||(A(e,t,"contextmenu")||Z||e.display.input.onContextMenu(t))}function hl(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),jn(e)}rl.prototype.compare=function(e,t,n){return this.time+400>e&&0==F(t,this.pos)&&n==this.button};var dl={toString:function(){return"CodeMirror.Init"}},fl={},pl={};function gl(e,t,n){!t!=!(n&&n!=dl)&&(n=e.display.dragFunctions,(t=t?L:k)(e.display.scroller,"dragstart",n.start),t(e.display.scroller,"dragenter",n.enter),t(e.display.scroller,"dragover",n.over),t(e.display.scroller,"dragleave",n.leave),t(e.display.scroller,"drop",n.drop))}function ml(e){e.options.lineWrapping?(re(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(J(e.display.wrapper,"CodeMirror-wrap"),ln(e)),dr(e),E(e),jn(e),setTimeout(function(){return Vr(e)},100)}function p(e,t){var n=this;if(!(this instanceof p))return new p(e,t);this.options=t=t?ce(t):{},ce(fl,t,!1);var r,i=t.value,o=("string"==typeof i?i=new f(i,t.mode,null,t.lineSeparator,t.direction):t.mode&&(i.modeOption=t.mode),this.doc=i,new p.inputStyles[t.inputStyle](this)),e=this.display=new ui(e,i,o,t),l=(hl(e.wrapper.CodeMirror=this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Xr(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new de,keySeq:null,specialChars:null},t.autofocus&&!$&&e.input.focus(),w&&v<11&&setTimeout(function(){return n.display.input.reset(!0)},20),this),s=l.display;L(s.scroller,"mousedown",z(l,ll)),L(s.scroller,"dblclick",w&&v<11?z(l,function(e){var t;A(l,e)||!(t=fr(l,e))||ul(l,e)||Nn(l.display,e)||(T(e),e=l.findWordAt(t),Ri(l.doc,e.anchor,e.head))}):function(e){return A(l,e)||T(e)}),L(s.scroller,"contextmenu",function(e){return cl(l,e)}),L(s.input.getField(),"contextmenu",function(e){s.scroller.contains(e.target)||cl(l,e)});var a,u={end:0};function c(){s.activeTouch&&(a=setTimeout(function(){return s.activeTouch=null},1e3),(u=s.activeTouch).end=+new Date)}function h(e,t){var n;return null==t.left||400<(n=t.left-e.left)*n+(n=t.top-e.top)*n}L(s.scroller,"touchstart",function(e){var t;A(l,e)||function(e){if(1==e.touches.length)return(e=e.touches[0]).radiusX<=1&&e.radiusY<=1}(e)||ul(l,e)||(s.input.ensurePolled(),clearTimeout(a),t=+new Date,s.activeTouch={start:t,moved:!1,prev:t-u.end<=300?u:null},1==e.touches.length&&(s.activeTouch.left=e.touches[0].pageX,s.activeTouch.top=e.touches[0].pageY))}),L(s.scroller,"touchmove",function(){s.activeTouch&&(s.activeTouch.moved=!0)}),L(s.scroller,"touchend",function(e){var t,n=s.activeTouch;n&&!Nn(s,e)&&null!=n.left&&!n.moved&&new Date-n.start<300&&(t=l.coordsChar(s.activeTouch,"page"),n=!n.prev||h(n,n.prev)?new B(t,t):!n.prev.prev||h(n,n.prev.prev)?l.findWordAt(t):new B(H(t.line,0),P(l.doc,H(t.line+1,0))),l.setSelection(n.anchor,n.head),l.focus(),T(e)),c()}),L(s.scroller,"touchcancel",c),L(s.scroller,"scroll",function(){s.scroller.clientHeight&&(zr(l,s.scroller.scrollTop),Rr(l,s.scroller.scrollLeft,!0),O(l,"scroll",l))}),L(s.scroller,"mousewheel",function(e){return pi(l,e)}),L(s.scroller,"DOMMouseScroll",function(e){return pi(l,e)}),L(s.wrapper,"scroll",function(){return s.wrapper.scrollTop=s.wrapper.scrollLeft=0}),s.dragFunctions={enter:function(e){A(l,e)||_e(e)},over:function(e){var t,n;A(l,e)||((n=fr(t=l,n=e))&&(xr(t,n,n=document.createDocumentFragment()),t.display.dragCursor||(t.display.dragCursor=M("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),y(t.display.dragCursor,n)),_e(e))},start:function(e){var t,n;t=l,e=e,w&&(!t.state.draggingText||+new Date-xo<100)?_e(e):A(t,e)||Nn(t.display,e)||(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!j&&((n=M("img",null,null,"position: fixed; left: 0; top: 0;")).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",K&&(n.width=n.height=1,t.display.wrapper.appendChild(n),n._top=n.offsetTop),e.dataTransfer.setDragImage(n,0,0),K)&&n.parentNode.removeChild(n))},drop:z(l,Co),leave:function(e){A(l,e)||So(l)}};o=s.input.getField();for(r in L(o,"keyup",function(e){return tl.call(l,e)}),L(o,"keydown",z(l,el)),L(o,"keypress",z(l,nl)),L(o,"focus",function(e){return Tr(l,e)}),L(o,"blur",function(e){return Mr(l,e)}),To(),$r(this),this.curOp.forceUpdate=!0,Ti(this,i),t.autofocus&&!$||this.hasFocus()?setTimeout(function(){n.hasFocus()&&!n.state.focused&&Tr(n)},20):Mr(this),pl)pl.hasOwnProperty(r)&&pl[r](this,t[r],dl);oi(this),t.finishInit&&t.finishInit(this);for(var d=0;d<vl.length;++d)vl[d](this);_r(this),x&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(e.lineDiv).textRendering&&(e.lineDiv.style.textRendering="auto")}p.defaults=fl,p.optionHandlers=pl;var vl=[];function yl(e,t,n,r){var i,o=e.doc,l=("smart"==(n=null==n?"add":n)&&(o.mode.indent?i=At(e,t).state:n="prev"),e.options.tabSize),s=D(o,t),a=he(s.text,null,l),u=(s.stateAfter&&(s.stateAfter=null),s.text.match(/^\s*/)[0]);if(r||/\S/.test(s.text)){if("smart"==n&&((c=o.mode.indent(i,s.text.slice(u.length),s.text))==pe||150<c)){if(!r)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?he(D(o,t-1).text,null,l):0:"add"==n?c=a+e.options.indentUnit:"subtract"==n?c=a-e.options.indentUnit:"number"==typeof n&&(c=a+n);var c=Math.max(0,c),h="",d=0;if(e.options.indentWithTabs)for(var f=Math.floor(c/l);f;--f)d+=l,h+="\t";if(d<c&&(h+=we(c-d)),h!=u)return io(o,h,H(t,0),H(t,u.length),"+input"),!(s.stateAfter=null);for(var p=0;p<o.sel.ranges.length;p++){var g=o.sel.ranges[p];if(g.head.line==t&&g.head.ch<u.length){g=H(t,u.length);Gi(o,p,new B(g,g));break}}}p.defineInitHook=function(e){return vl.push(e)};var bl=null;function wl(e){bl=e}function xl(e,t,n,r,i){var o=e.doc,l=(e.display.shift=!1,r=r||o.sel,+new Date-200),s="paste"==i||e.state.pasteIncoming>l,a=tt(t),u=null;if(s&&1<r.ranges.length)if(bl&&bl.text.join("\n")==t){if(r.ranges.length%bl.text.length==0)for(var u=[],c=0;c<bl.text.length;c++)u.push(o.splitLines(bl.text[c]))}else a.length==r.ranges.length&&e.options.pasteLinesPerSelection&&(u=xe(a,function(e){return[e]}));for(var h=e.curOp.updateInput,d=r.ranges.length-1;0<=d;d--){var f=r.ranges[d],p=f.from(),g=f.to(),f=(f.empty()&&(n&&0<n?p=H(p.line,p.ch-n):e.state.overwrite&&!s?g=H(g.line,Math.min(D(o,g.line).text.length,g.ch+I(a).length)):s&&bl&&bl.lineWise&&bl.text.join("\n")==a.join("\n")&&(p=g=H(p.line,0))),{from:p,to:g,text:u?u[d%u.length]:a,origin:i||(s?"paste":e.state.cutIncoming>l?"cut":"+input")});Ji(e.doc,f),b(e,"inputRead",e,f)}t&&!s&&Sl(e,t),Hr(e),e.curOp.updateInput<2&&(e.curOp.updateInput=h),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Cl(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");return n&&(e.preventDefault(),t.isReadOnly()||t.options.disableInput||!t.hasFocus()||h(t,function(){return xl(t,n,0,null,"paste")}),1)}function Sl(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,r=n.ranges.length-1;0<=r;r--){var i=n.ranges[r];if(!(100<i.head.ch||r&&n.ranges[r-1].head.line==i.head.line)){var o=e.getModeAt(i.head),l=!1;if(o.electricChars){for(var s=0;s<o.electricChars.length;s++)if(-1<t.indexOf(o.electricChars.charAt(s))){l=yl(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(D(e.doc,i.head.line).text.slice(0,i.head.ch))&&(l=yl(e,i.head.line,"smart"));l&&b(e,"electricInput",e,i.head.line)}}}function Ll(e){for(var t=[],n=[],r=0;r<e.doc.sel.ranges.length;r++){var i=e.doc.sel.ranges[r].head.line,i={anchor:H(i,0),head:H(i+1,0)};n.push(i),t.push(e.getRange(i.anchor,i.head))}return{text:t,ranges:n}}function kl(e,t,n,r){e.setAttribute("autocorrect",n?"on":"off"),e.setAttribute("autocapitalize",r?"on":"off"),e.setAttribute("spellcheck",!!t)}function Tl(){var e=M("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),t=M("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return x?e.style.width="1000px":e.setAttribute("wrap","off"),d&&(e.style.border="1px solid black"),t}function Ml(n,r,i,o,l){var e=r,t=i,s=D(n,r.line),a=l&&"rtl"==n.direction?-i:i;function u(e){var t;if(null==(t="codepoint"==o?(t=s.text.charCodeAt(r.ch+(0<i?0:-1)),isNaN(t)?null:(t=0<i?55296<=t&&t<56320:56320<=t&&t<57343,new H(r.line,Math.max(0,Math.min(s.text.length,r.ch+i*(t?2:1))),-i))):l?Ko(n.cm,s,r,i):Uo(s,r,i))){if(e||(e=r.line+a)<n.first||e>=n.first+n.size||(r=new H(e,r.ch,r.sticky),!(s=D(n,e))))return;r=Vo(l,n.cm,s,r.line,a)}else r=t;return 1}if("char"==o||"codepoint"==o)u();else if("column"==o)u(!0);else if("word"==o||"group"==o)for(var c=null,h="group"==o,d=n.cm&&n.cm.getHelper(r,"wordChars"),f=!0;!(i<0)||u(!f);f=!1){var p=s.text.charAt(r.ch)||"\n",p=Te(p,d)?"w":h&&"\n"==p?"n":!h||/\s/.test(p)?null:"p";if(h&&!f&&(p=p||"s"),c&&c!=p){i<0&&(i=1,u(),r.sticky="after");break}if(p&&(c=p),0<i&&!u(!f))break}t=_i(n,r,e,t,!0);return wt(e,t)&&(t.hitSide=!0),t}function Nl(e,t,n,r){var i,o,l,s=e.doc,a=t.left;for("page"==r?(i=Math.min(e.display.wrapper.clientHeight,ae(e).innerHeight||s(e).documentElement.clientHeight),i=Math.max(i-.5*sr(e.display),3),o=(0<n?t.bottom:t.top)+n*i):"line"==r&&(o=0<n?t.bottom+3:t.top-3);(l=tr(e,a,o)).outside;){if(n<0?o<=0:o>=s.height){l.hitSide=!0;break}o+=5*n}return l}function i(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new de,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null}function Ol(e,t){var n,r,i=zn(e,t.line);return!i||i.hidden?null:(n=Pn(i,i=D(e.doc,t.line),t.line),r="left",(i=Ge(i,e.doc.direction))&&(r=He(i,t.ch)%2?"right":"left"),(e=Un(n.map,t.ch,r)).offset="right"==e.collapse?e.end:e.start,e)}function Al(e,t){return t&&(e.bad=!0),e}function Dl(e,t,n){var r;if(t==e.display.lineDiv){if(!(r=e.display.lineDiv.childNodes[n]))return Al(e.clipPos(H(e.display.viewTo-1)),!0);t=null,n=0}else for(r=t;;r=r.parentNode){if(!r||r==e.display.lineDiv)return null;if(r.parentNode&&r.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==r){var u=o,o=t,l=n,s=u.text.firstChild,a=!1;if(!o||!ne(s,o))return Al(H(W(u.line),0),!0);if(o==s)if(a=!0,o=s.childNodes[l],l=0,!o)return Al(H(W(c=u.rest?I(u.rest):u.line),c.text.length),a);var c=3==o.nodeType?o:null,h=o;for(c||1!=o.childNodes.length||3!=o.firstChild.nodeType||(c=o.firstChild,l=l&&c.nodeValue.length);h.parentNode!=s;)h=h.parentNode;var d=u.measure,f=d.maps;function p(e,t,n){for(var r=-1;r<(f?f.length:0);r++)for(var i=r<0?d.map:f[r],o=0;o<i.length;o+=3){var l,s,a=i[o+2];if(a==e||a==t)return l=W(r<0?u.line:u.rest[r]),s=i[o]+n,H(l,s=n<0||a!=e?i[o+(n?1:0)]:s)}}var g=p(c,h,l);if(g)return Al(g,a);for(var m=h.nextSibling,v=c?c.nodeValue.length-l:0;m;m=m.nextSibling){if(g=p(m,m.firstChild,0))return Al(H(g.line,g.ch-v),a);v+=m.textContent.length}for(var y=h.previousSibling,b=l;y;y=y.previousSibling){if(g=p(y,y.firstChild,-1))return Al(H(g.line,g.ch+b),a);b+=y.textContent.length}return}}}i.prototype.init=function(e){var t=this,o=this,l=o.cm,s=o.div=e.lineDiv;function a(e){for(var t=e.target;t;t=t.parentNode){if(t==s)return 1;if(/\bCodeMirror-(?:line)?widget\b/.test(t.className))break}}function n(e){if(a(e)&&!A(l,e)){if(l.somethingSelected())wl({lineWise:!1,text:l.getSelections()}),"cut"==e.type&&l.replaceSelection("",null,"cut");else{if(!l.options.lineWiseCopyCut)return;var t=Ll(l);wl({lineWise:!0,text:t.text}),"cut"==e.type&&l.operation(function(){l.setSelections(t.ranges,0,ge),l.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var n=bl.text.join("\n");if(e.clipboardData.setData("Text",n),e.clipboardData.getData("Text")==n)return void e.preventDefault()}var r=Tl(),n=r.firstChild,i=(kl(n),l.display.lineSpace.insertBefore(r,l.display.lineSpace.firstChild),n.value=bl.text.join("\n"),N(s.ownerDocument));le(n),setTimeout(function(){l.display.lineSpace.removeChild(r),i.focus(),i==s&&o.showPrimarySelection()},50)}}s.contentEditable=!0,kl(s,l.options.spellcheck,l.options.autocorrect,l.options.autocapitalize),L(s,"paste",function(e){!a(e)||A(l,e)||Cl(e,l)||v<=11&&setTimeout(z(l,function(){return t.updateFromDOM()}),20)}),L(s,"compositionstart",function(e){t.composing={data:e.data,done:!1}}),L(s,"compositionupdate",function(e){t.composing||(t.composing={data:e.data,done:!1})}),L(s,"compositionend",function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),L(s,"touchstart",function(){return o.forceCompositionEnd()}),L(s,"input",function(){t.composing||t.readFromDOMSoon()}),L(s,"copy",n),L(s,"cut",n)},i.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},i.prototype.prepareSelection=function(){var e=wr(this.cm,!1);return e.focus=N(this.div.ownerDocument)==this.div,e},i.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},i.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},i.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,n=t.doc.sel.primary(),r=n.from(),n=n.to();if(t.display.viewTo==t.display.viewFrom||r.line>=t.display.viewTo||n.line<t.display.viewFrom)e.removeAllRanges();else{var i=Dl(t,e.anchorNode,e.anchorOffset),o=Dl(t,e.focusNode,e.focusOffset);if(!i||i.bad||!o||o.bad||0!=F(St(i,o),r)||0!=F(Ct(i,o),n)){var i=t.display.view,o=r.line>=t.display.viewFrom&&Ol(t,r)||{node:i[0].measure.map[2],offset:0},r=n.line<t.display.viewTo&&Ol(t,n);if(r||(r={node:(i=(n=i[i.length-1].measure).maps?n.maps[n.maps.length-1]:n.map)[i.length-1],offset:i[i.length-2]-i[i.length-3]}),o&&r){var l,n=e.rangeCount&&e.getRangeAt(0);try{l=oe(o.node,o.offset,r.offset,r.node)}catch(e){}l&&(!m&&t.state.focused&&(e.collapse(o.node,o.offset),l.collapsed)||(e.removeAllRanges(),e.addRange(l)),n&&null==e.anchorNode?e.addRange(n):m&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},i.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},i.prototype.showMultipleSelections=function(e){y(this.cm.display.cursorDiv,e.cursors),y(this.cm.display.selectionDiv,e.selection)},i.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},i.prototype.selectionInEditor=function(){var e=this.getSelection();return!!e.rangeCount&&(e=e.getRangeAt(0).commonAncestorContainer,ne(this.div,e))},i.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&N(this.div.ownerDocument)==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},i.prototype.blur=function(){this.div.blur()},i.prototype.getField=function(){return this.div},i.prototype.supportsTouch=function(){return!0},i.prototype.receivedFocus=function(){var e=this,t=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):h(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},i.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},i.prototype.pollSelection=function(){var e,t,n,r;null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()&&(e=this.getSelection(),t=this.cm,Y&&U&&this.cm.display.gutterSpecs.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return 1;return}(e.anchorNode)?(this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus()):this.composing||(this.rememberSelection(),n=Dl(t,e.anchorNode,e.anchorOffset),r=Dl(t,e.focusNode,e.focusOffset),n&&r&&h(t,function(){G(t.doc,mi(n,r),ge),(n.bad||r.bad)&&(t.curOp.selectionChanged=!0)})))},i.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t=this.cm,n=t.display,r=t.doc.sel.primary(),i=r.from(),r=r.to();if(0==i.ch&&i.line>t.firstLine()&&(i=H(i.line-1,D(t.doc,i.line-1).length)),r.ch==D(t.doc,r.line).text.length&&r.line<t.lastLine()&&(r=H(r.line+1,0)),i.line<n.viewFrom||r.line>n.viewTo-1)return!1;var o,l=i.line==n.viewFrom||0==(l=pr(t,i.line))?(e=W(n.view[0].line),n.view[0].node):(e=W(n.view[l].line),n.view[l-1].node.nextSibling),r=pr(t,r.line),n=r==n.view.length-1?(o=n.viewTo-1,n.lineDiv.lastChild):(o=W(n.view[r+1].line)-1,n.view[r+1].node.previousSibling);if(!l)return!1;for(var s=t.doc.splitLines(function(o,e,t,l,s){var n="",a=!1,u=o.doc.lineSeparator(),c=!1;function h(){a&&(n+=u,c&&(n+=u),a=c=!1)}function d(e){e&&(h(),n+=e)}for(;!function e(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(n)d(n);else if(n=t.getAttribute("cm-marker"))(n=o.findMarks(H(l,0),H(s+1,0),(i=+n,function(e){return e.id==i}))).length&&(n=n[0].find(0))&&d(pt(o.doc,n.from,n.to).join(u));else if("false"!=t.getAttribute("contenteditable")&&(n=/^(pre|div|p|li|table|br)$/i.test(t.nodeName),/^br$/i.test(t.nodeName)||0!=t.textContent.length)){n&&h();for(var r=0;r<t.childNodes.length;r++)e(t.childNodes[r]);/^(pre|p)$/i.test(t.nodeName)&&(c=!0),n&&(a=!0)}}else 3==t.nodeType&&d(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var i}(e),e!=t;)e=e.nextSibling,c=!1;return n}(t,l,n,e,o)),a=pt(t.doc,H(e,0),H(o,D(t.doc,o).text.length));1<s.length&&1<a.length;)if(I(s)==I(a))s.pop(),a.pop(),o--;else{if(s[0]!=a[0])break;s.shift(),a.shift(),e++}for(var u=0,c=0,h=s[0],d=a[0],f=Math.min(h.length,d.length);u<f&&h.charCodeAt(u)==d.charCodeAt(u);)++u;for(var p=I(s),g=I(a),m=Math.min(p.length-(1==s.length?u:0),g.length-(1==a.length?u:0));c<m&&p.charCodeAt(p.length-c-1)==g.charCodeAt(g.length-c-1);)++c;if(1==s.length&&1==a.length&&e==i.line)for(;u&&u>i.ch&&p.charCodeAt(p.length-c-1)==g.charCodeAt(g.length-c-1);)u--,c++;s[s.length-1]=p.slice(0,p.length-c).replace(/^\u200b+/,""),s[0]=s[0].slice(u).replace(/\u200b+$/,"");r=H(e,u),l=H(o,a.length?I(a).length-c:0);return 1<s.length||s[0]||F(r,l)?(io(t.doc,s,r,l,"+input"),!0):void 0},i.prototype.ensurePolled=function(){this.forceCompositionEnd()},i.prototype.reset=function(){this.forceCompositionEnd()},i.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},i.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},i.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||h(this.cm,function(){return E(e.cm)})},i.prototype.setUneditable=function(e){e.contentEditable="false"},i.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly())||z(this.cm,xl)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},i.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},i.prototype.onContextMenu=function(){},i.prototype.resetPosition=function(){},i.prototype.needsContentAttribute=!0;function o(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new de,this.hasSelection=!1,this.composing=null,this.resetting=!1}var Wl,Hl,Fl,Pl,El;function l(e,t,r,n){Wl.defaults[e]=t,r&&(Hl[e]=n?function(e,t,n){n!=dl&&r(e,t,n)}:r)}o.prototype.init=function(n){var e=this,r=this,i=this.cm,o=(this.createField(n),this.textarea);function t(e){if(!A(i,e)){if(i.somethingSelected())wl({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var t=Ll(i);wl({lineWise:!0,text:t.text}),"cut"==e.type?i.setSelections(t.ranges,null,ge):(r.prevInput="",o.value=t.text.join("\n"),le(o))}"cut"==e.type&&(i.state.cutIncoming=+new Date)}}n.wrapper.insertBefore(this.wrapper,n.wrapper.firstChild),d&&(o.style.width="0px"),L(o,"input",function(){w&&9<=v&&e.hasSelection&&(e.hasSelection=null),r.poll()}),L(o,"paste",function(e){A(i,e)||Cl(e,i)||(i.state.pasteIncoming=+new Date,r.fastPoll())}),L(o,"cut",t),L(o,"copy",t),L(n.scroller,"paste",function(e){var t;Nn(n,e)||A(i,e)||(o.dispatchEvent?((t=new Event("paste")).clipboardData=e.clipboardData,o.dispatchEvent(t)):(i.state.pasteIncoming=+new Date,r.focus()))}),L(n.lineSpace,"selectstart",function(e){Nn(n,e)||T(e)}),L(o,"compositionstart",function(){var e=i.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),L(o,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},o.prototype.createField=function(e){this.wrapper=Tl(),this.textarea=this.wrapper.firstChild;var t=this.cm.options;kl(this.textarea,t.spellcheck,t.autocorrect,t.autocapitalize)},o.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},o.prototype.prepareSelection=function(){var e,t=this.cm,n=t.display,r=t.doc,i=wr(t);return t.options.moveInputWithCursor&&(t=Qn(t,r.sel.primary().head,"div"),r=n.wrapper.getBoundingClientRect(),e=n.lineDiv.getBoundingClientRect(),i.teTop=Math.max(0,Math.min(n.wrapper.clientHeight-10,t.top+e.top-r.top)),i.teLeft=Math.max(0,Math.min(n.wrapper.clientWidth-10,t.left+e.left-r.left))),i},o.prototype.showSelection=function(e){var t=this.cm.display;y(t.cursorDiv,e.cursors),y(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},o.prototype.reset=function(e){var t,n;this.contextMenuPending||this.composing&&e||(t=this.cm,this.resetting=!0,t.somethingSelected()?(this.prevInput="",n=t.getSelection(),this.textarea.value=n,t.state.focused&&le(this.textarea),w&&9<=v&&(this.hasSelection=n)):e||(this.prevInput=this.textarea.value="",w&&9<=v&&(this.hasSelection=null)),this.resetting=!1)},o.prototype.getField=function(){return this.textarea},o.prototype.supportsTouch=function(){return!1},o.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!$||N(this.textarea.ownerDocument)!=this.textarea))try{this.textarea.focus()}catch(e){}},o.prototype.blur=function(){this.textarea.blur()},o.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},o.prototype.receivedFocus=function(){this.slowPoll()},o.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},o.prototype.fastPoll=function(){var t=!1,n=this;n.pollingFast=!0,n.polling.set(20,function e(){n.poll()||t?(n.pollingFast=!1,n.slowPoll()):(t=!0,n.polling.set(60,e))})},o.prototype.poll=function(){var e=this,t=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||this.resetting||!t.state.focused||nt(n)&&!r&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=n.value;if(i==r&&!t.somethingSelected())return!1;if(w&&9<=v&&this.hasSelection===i||C&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=i.charCodeAt(0);if(8203==o&&(r=r||"â"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var l=0,s=Math.min(r.length,i.length);l<s&&r.charCodeAt(l)==i.charCodeAt(l);)++l;return h(t,function(){xl(t,i.slice(l),r.length-l,null,e.composing?"*compose":null),1e3<i.length||-1<i.indexOf("\n")?n.value=e.prevInput="":e.prevInput=i,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},o.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},o.prototype.onKeyPress=function(){w&&9<=v&&(this.hasSelection=null),this.fastPoll()},o.prototype.onContextMenu=function(e){var n,r,t,i,o=this,l=o.cm,s=l.display,a=o.textarea,u=(o.contextMenuPending&&o.contextMenuPending(),fr(l,e)),c=s.scroller.scrollTop;function h(){var e,t;null!=a.selectionStart&&(t="â"+((e=l.somethingSelected())?a.value:""),a.value="â",a.value=t,o.prevInput=e?"":"â",a.selectionStart=1,a.selectionEnd=t.length,s.selForContextMenu=l.doc.sel)}function d(){var e,t;o.contextMenuPending==d&&(o.contextMenuPending=!1,o.wrapper.style.cssText=r,a.style.cssText=n,w&&v<9&&s.scrollbars.setScrollTop(s.scroller.scrollTop=c),null!=a.selectionStart)&&((!w||v<9)&&h(),e=0,t=function(){s.selForContextMenu==l.doc.sel&&0==a.selectionStart&&0<a.selectionEnd&&"â"==o.prevInput?z(l,Zi)(l):e++<10?s.detectingSelectAll=setTimeout(t,500):(s.selForContextMenu=null,s.input.reset())},s.detectingSelectAll=setTimeout(t,200))}u&&!K&&(l.options.resetSelectionOnContextMenu&&-1==l.doc.sel.contains(u)&&z(l,G)(l.doc,mi(u),ge),n=a.style.cssText,r=o.wrapper.style.cssText,u=o.wrapper.offsetParent.getBoundingClientRect(),o.wrapper.style.cssText="position: static",a.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-u.top-5)+"px; left: "+(e.clientX-u.left-5)+"px;\n      z-index: 1000; background: "+(w?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",x&&(t=a.ownerDocument.defaultView.scrollY),s.input.focus(),x&&a.ownerDocument.defaultView.scrollTo(null,t),s.input.reset(),l.somethingSelected()||(a.value=o.prevInput=" "),o.contextMenuPending=d,s.selForContextMenu=l.doc.sel,clearTimeout(s.detectingSelectAll),w&&9<=v&&h(),Z?(_e(e),i=function(){k(window,"mouseup",i),setTimeout(d,20)},L(window,"mouseup",i)):setTimeout(d,50))},o.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e,this.textarea.readOnly=!!e},o.prototype.setUneditable=function(){},o.prototype.needsContentAttribute=!1,Hl=(Wl=p).optionHandlers,Wl.defineOption=l,Wl.Init=dl,l("value","",function(e,t){return e.setValue(t)},!0),l("mode",null,function(e,t){e.doc.modeOption=t,xi(e)},!0),l("indentUnit",2,xi,!0),l("indentWithTabs",!1),l("smartIndent",!0),l("tabSize",4,function(e){Ci(e),jn(e),E(e)},!0),l("lineSeparator",null,function(e,r){if(e.doc.lineSep=r){var i=[],o=e.doc.first;e.doc.iter(function(e){for(var t=0;;){var n=e.text.indexOf(r,t);if(-1==n)break;t=n+r.length,i.push(H(o,n))}o++});for(var t=i.length-1;0<=t;t--)io(e.doc,r,i[t],H(i[t].line,i[t].ch+r.length))}}),l("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=dl&&e.refresh()}),l("specialCharPlaceholder",dn,function(e){return e.refresh()},!0),l("electricChars",!0),l("inputStyle",$?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),l("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),l("autocorrect",!1,function(e,t){return e.getInputField().autocorrect=t},!0),l("autocapitalize",!1,function(e,t){return e.getInputField().autocapitalize=t},!0),l("rtlMoveVisually",!a),l("wholeLineUpdateBefore",!0),l("theme","default",function(e){hl(e),ai(e)},!0),l("keyMap","default",function(e,t,n){t=Ro(t),n=n!=dl&&Ro(n);n&&n.detach&&n.detach(e,t),t.attach&&t.attach(e,n||null)}),l("extraKeys",null),l("configureMouse",null),l("lineWrapping",!1,ml,!0),l("gutters",[],function(e,t){e.display.gutterSpecs=li(t,e.options.lineNumbers),ai(e)},!0),l("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?cr(e.display)+"px":"0",e.refresh()},!0),l("coverGutterNextToScrollbar",!1,function(e){return Vr(e)},!0),l("scrollbarStyle","native",function(e){Xr(e),Vr(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),l("lineNumbers",!1,function(e,t){e.display.gutterSpecs=li(e.options.gutters,t),ai(e)},!0),l("firstLineNumber",1,ai,!0),l("lineNumberFormatter",function(e){return e},ai,!0),l("showCursorWhenSelecting",!1,br,!0),l("resetSelectionOnContextMenu",!0),l("lineWiseCopyCut",!0),l("pasteLinesPerSelection",!0),l("selectionsMayTouch",!1),l("readOnly",!1,function(e,t){"nocursor"==t&&(Mr(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),l("screenReaderLabel",null,function(e,t){e.display.input.screenReaderLabelChanged(t=""===t?null:t)}),l("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),l("dragDrop",!0,gl),l("allowDropFileTypes",null),l("cursorBlinkRate",530),l("cursorScrollMargin",0),l("cursorHeight",1,br,!0),l("singleCursorHeightPerLine",!0,br,!0),l("workTime",100),l("workDelay",100),l("flattenSpans",!0,Ci,!0),l("addModeClass",!1,Ci,!0),l("pollInterval",100),l("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),l("historyEventDelay",1250),l("viewportMargin",10,function(e){return e.refresh()},!0),l("maxHighlightLength",1e4,Ci,!0),l("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),l("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),l("autofocus",null),l("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),l("phrases",null),Pl=(Fl=p).optionHandlers,El=Fl.helpers={},Fl.prototype={constructor:Fl,focus:function(){ae(this).focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,r=n[e];n[e]==t&&"mode"!=e||(n[e]=t,Pl.hasOwnProperty(e)&&z(this,Pl[e])(this,t,r),O(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Ro(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:n(function(e,t){var n=e.token?e:Fl.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");for(var r=this.state.overlays,n={mode:n,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},i=function(e){return e.priority},o=0,l=i(n);o<r.length&&i(r[o])<=l;)o++;r.splice(o,0,n),this.state.modeGen++,E(this)}),removeOverlay:n(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return t.splice(n,1),this.state.modeGen++,void E(this)}}),indentLine:n(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),yt(this.doc,e)&&yl(this,e,t,n)}),indentSelection:n(function(e){for(var t=this.doc.sel.ranges,n=-1,r=0;r<t.length;r++){var i=t[r];if(i.empty())i.head.line>n&&(yl(this,i.head.line,e,!0),n=i.head.line,r==this.doc.sel.primIndex)&&Hr(this);else{for(var o=i.from(),i=i.to(),l=Math.max(n,o.line),n=Math.min(this.lastLine(),i.line-(i.ch?0:1))+1,s=l;s<n;++s)yl(this,s,e);i=this.doc.sel.ranges;0==o.ch&&t.length==i.length&&0<i[r].from().ch&&Gi(this.doc,r,new B(o,i[r].to()),ge)}}}),getTokenAt:function(e,t){return Pt(this,e,t)},getLineTokens:function(e,t){return Pt(this,H(e),t,!0)},getTokenTypeAt:function(e){e=P(this.doc,e);var t,n=Ot(this,D(this.doc,e.line)),r=0,i=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var l=r+i>>1;if((l?n[2*l-1]:0)>=o)i=l;else{if(!(n[2*l+1]<o)){t=n[2*l+2];break}r=1+l}}e=t?t.indexOf("overlay "):-1;return e<0?t:0==e?null:t.slice(0,e-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?Fl.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(El.hasOwnProperty(t)){var r=El[t],i=this.getModeAt(e);if("string"==typeof i[t])r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var o=0;o<i[t].length;o++){var l=r[i[t][o]];l&&n.push(l)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(var s=0;s<r._global.length;s++){var a=r._global[s];a.pred(i,this)&&-1==S(n,a.val)&&n.push(a.val)}}return n},getStateAfter:function(e,t){var n=this.doc;return At(this,(e=Lt(n,null==e?n.first+n.size-1:e))+1,t).state},cursorCoords:function(e,t){var n=this.doc.sel.primary(),e=null==e?n.head:"object"==typeof e?P(this.doc,e):e?n.from():n.to();return Qn(this,e,t||"page")},charCoords:function(e,t){return Zn(this,P(this.doc,e),t||"page")},coordsChar:function(e,t){return tr(this,(e=qn(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=qn(this,{top:e,left:0},t||"page").top,vt(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var r=!1,i="number"==typeof e?(i=this.doc.first+this.doc.size-1,e<this.doc.first?e=this.doc.first:i<e&&(e=i,r=!0),D(this.doc,e)):e;return _n(this,i,{top:0,left:0},t||"page",n||r).top+(r?this.doc.height-rn(i):0)},defaultTextHeight:function(){return sr(this.display)},defaultCharWidth:function(){return ar(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var o,l,s=this.display,a=(e=Qn(this,P(this.doc,e))).bottom,u=e.left;t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),s.sizer.appendChild(t),"over"==r?a=e.top:"above"!=r&&"near"!=r||(l=Math.max(s.wrapper.clientHeight,this.doc.height),o=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth),("above"==r||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),u+t.offsetWidth>o&&(u=o-t.offsetWidth)),t.style.top=a+"px",t.style.left=t.style.right="","right"==i?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&(r=this,l={left:u,top:a,right:u+t.offsetWidth,bottom:a+t.offsetHeight},null!=(l=Dr(r,l)).scrollTop&&zr(r,l.scrollTop),null!=l.scrollLeft)&&Rr(r,l.scrollLeft)},triggerOnKeyDown:n(el),triggerOnKeyPress:n(nl),triggerOnKeyUp:tl,triggerOnMouseDown:n(ll),execCommand:function(e){if(jo.hasOwnProperty(e))return jo[e].call(null,this)},triggerElectric:n(function(e){Sl(this,e)}),findPosH:function(e,t,n,r){for(var i=1,o=(t<0&&(i=-1,t=-t),P(this.doc,e)),l=0;l<t&&!(o=Ml(this.doc,o,i,n,r)).hitSide;++l);return o},moveH:n(function(t,n){var r=this;this.extendSelectionsBy(function(e){return r.display.shift||r.doc.extend||e.empty()?Ml(r.doc,e.head,t,n,r.options.rtlMoveVisually):t<0?e.from():e.to()},ve)}),deleteH:n(function(n,r){var e=this.doc.sel,i=this.doc;e.somethingSelected()?i.replaceSelection("",null,"+delete"):Bo(this,function(e){var t=Ml(i,e.head,n,r,!1);return n<0?{from:t,to:e.head}:{from:e.head,to:t}})}),findPosV:function(e,t,n,r){for(var i=1,o=r,l=(t<0&&(i=-1,t=-t),P(this.doc,e)),s=0;s<t;++s){var a=Qn(this,l,"div");if(null==o?o=a.left:a.left=o,(l=Nl(this,a,i,n)).hitSide)break}return l},moveV:n(function(r,i){var o=this,l=this.doc,s=[],a=!this.display.shift&&!l.extend&&l.sel.somethingSelected();if(l.extendSelectionsBy(function(e){var t,n;return a?r<0?e.from():e.to():(t=Qn(o,e.head,"div"),null!=e.goalColumn&&(t.left=e.goalColumn),s.push(t.left),n=Nl(o,t,r,i),"page"==i&&e==l.sel.primary()&&Wr(o,Zn(o,n,"div").top-t.top),n)},ve),s.length)for(var e=0;e<l.sel.ranges.length;e++)l.sel.ranges[e].goalColumn=s[e]}),findWordAt:function(e){var t=D(this.doc,e.line).text,n=e.ch,r=e.ch;if(t){for(var i=this.getHelper(e,"wordChars"),o=("before"!=e.sticky&&r!=t.length||!n?++r:--n,t.charAt(n)),l=Te(o,i)?function(e){return Te(e,i)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Te(e)};0<n&&l(t.charAt(n-1));)--n;for(;r<t.length&&l(t.charAt(r));)++r}return new B(H(e.line,n),H(e.line,r))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||(((this.state.overwrite=!this.state.overwrite)?re:J)(this.display.cursorDiv,"CodeMirror-overwrite"),O(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==N(se(this))},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:n(function(e,t){Fr(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Wn(this)-this.display.barHeight,width:e.scrollWidth-Wn(this)-this.display.barWidth,clientHeight:Fn(this),clientWidth:Hn(this)}},scrollIntoView:n(function(e,t){var n;null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:H(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?(t=e,Pr(n=this),n.curOp.scrollToPos=t):Er(this,e.from,e.to,e.margin)}),setSize:n(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var r=this,i=(null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.options.lineWrapping&&Kn(this),this.display.viewFrom);this.doc.iter(i,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){gr(r,i,"widget");break}++i}),this.curOp.forceUpdate=!0,O(this,"refresh",this)}),operation:function(e){return h(this,e)},startOperation:function(){return $r(this)},endOperation:function(){return _r(this)},refresh:n(function(){var e=this.display.cachedTextHeight;E(this),this.curOp.forceUpdate=!0,jn(this),Fr(this,this.doc.scrollLeft,this.doc.scrollTop),ni(this.display),(null==e||.5<Math.abs(e-sr(this.display))||this.options.lineWrapping)&&dr(this),O(this,"refresh",this)}),swapDoc:n(function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),Ti(this,e),jn(this),this.display.input.reset(),Fr(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,b(this,"swapDoc",this,t),t}),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Xe(Fl),Fl.registerHelper=function(e,t,n){El.hasOwnProperty(e)||(El[e]=Fl[e]={_global:[]}),El[e][t]=n},Fl.registerGlobalHelper=function(e,t,n,r){Fl.registerHelper(e,t,r),El[e]._global.push({pred:n,val:r})};var zl,Il="iter insert remove copy getEditor constructor".split(" ");for(zl in f.prototype)f.prototype.hasOwnProperty(zl)&&S(Il,zl)<0&&(p.prototype[zl]=function(e){return function(){return e.apply(this.doc,arguments)}}(f.prototype[zl]));return Xe(f),p.inputStyles={textarea:o,contenteditable:i},p.defineMode=function(e){p.defaults.mode||"null"==e||(p.defaults.mode=e),function(e,t){2<arguments.length&&(t.dependencies=Array.prototype.slice.call(arguments,2)),ot[e]=t}.apply(this,arguments)},p.defineMIME=function(e,t){lt[e]=t},p.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),p.defineMIME("text/plain","null"),p.defineExtension=function(e,t){p.prototype[e]=t},p.defineDocExtension=function(e,t){f.prototype[e]=t},p.fromTextArea=function(t,n){var e;function r(){t.value=s.getValue()}if((n=n?ce(n):{}).value=t.value,!n.tabindex&&t.tabIndex&&(n.tabindex=t.tabIndex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus&&(e=N(t.ownerDocument),n.autofocus=e==t||null!=t.getAttribute("autofocus")&&e==document.body),t.form&&(L(t.form,"submit",r),!n.leaveSubmitMethodAlone)){var i=t.form,o=i.submit;try{var l=i.submit=function(){r(),i.submit=o,i.submit(),i.submit=l}}catch(e){}}n.finishInit=function(e){e.save=r,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,r(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(k(t.form,"submit",r),n.leaveSubmitMethodAlone||"function"!=typeof t.form.submit||(t.form.submit=o))}},t.style.display="none";var s=p(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},n);return s},(t=p).off=k,t.on=L,t.wheelEventPixels=fi,t.Doc=f,t.splitLines=tt,t.countColumn=he,t.findColumn=ye,t.isWordChar=ke,t.Pass=pe,t.signal=O,t.Line=sn,t.changeEnd=vi,t.scrollbarModel=jr,t.Pos=H,t.cmpPos=F,t.modes=ot,t.mimeModes=lt,t.resolveMode=st,t.getMode=at,t.modeExtensions=ut,t.extendMode=ct,t.copyState=ht,t.startState=ft,t.innerMode=dt,t.commands=jo,t.keyMap=Wo,t.keyName=Io,t.isModifierKey=Eo,t.lookupKey=Po,t.normalizeKeyMap=Fo,t.StringStream=g,t.SharedTextMarker=vo,t.TextMarker=po,t.LineWidget=ho,t.e_preventDefault=T,t.e_stopPropagation=Ye,t.e_stop=_e,t.addClass=re,t.contains=ne,t.rmClass=J,t.keyNames=No,p.version="5.65.13",p});
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).compareVersions={})}(this,function(e){"use strict";const t=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,l=e=>{if("string"!=typeof e)throw new TypeError("Invalid argument expected string");var r=e.match(t);if(r)return r.shift(),r;throw new Error(`Invalid argument not valid semver ('${e}' received)`)},i=e=>"*"===e||"x"===e||"X"===e,n=e=>{var r=parseInt(e,10);return isNaN(r)?e:r},o=(e,r)=>{return i(e)||i(r)?0:([e,r]=(e=n(e),r=n(r),typeof e!=typeof r?[String(e),String(r)]:[e,r]),r<e?1:e<r?-1:0)},d=(r,t)=>{for(let e=0;e<Math.max(r.length,t.length);e++){var i=o(r[e]||"0",t[e]||"0");if(0!==i)return i}return 0},s=(e,r)=>{var e=l(e),r=l(r),t=e.pop(),i=r.pop(),e=d(e,r);return 0!==e?e:t&&i?d(t.split("."),i.split(".")):t||i?t?-1:1:0},u=(e,r,t)=>{var i=t;if("string"!=typeof i)throw new TypeError("Invalid operator type, expected string but got "+typeof i);if(-1===p.indexOf(i))throw new Error("Invalid operator, expected one of "+p.join("|"));i=s(e,r);return f[t].includes(i)},f={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1],"!=":[-1,1]},p=Object.keys(f),c=(r,e)=>{if((e=e.replace(/([><=]+)\s+/g,"$1")).includes("||"))return e.split("||").some(e=>c(r,e));if(e.includes(" - "))return[t,i]=e.split(" - ",2),c(r,`>=${t} <=`+i);if(e.includes(" "))return e.trim().replace(/\s{2,}/g," ").split(" ").every(e=>c(r,e));var t=e.match(/^([<>=~^]+)/),i=t?t[1]:"=";if("^"!==i&&"~"!==i)return u(r,e,i);var[t,n,o,,s]=l(r),[e,f,p,,a]=l(e),t=[t,n,o],n=[e,null!=f?f:"x",null!=p?p:"x"];if(a){if(!s)return!1;if(0!==d(t,n))return!1;if(-1===d(s.split("."),a.split(".")))return!1}o=n.findIndex(e=>"0"!==e)+1,e="~"===i?2:1<o?o:1;return 0===d(t.slice(0,e),n.slice(0,e))&&-1!==d(t.slice(e),n.slice(e))};e.compare=u,e.compareVersions=s,e.satisfies=c,e.validate=e=>"string"==typeof e&&/^[v\d]/.test(e)&&t.test(e)});
!function(n){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(t){return n(t,window,document)}):"object"==typeof exports?module.exports=function(t,e){return t=t||window,e=e||("undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(e,t,t.document)}:n(jQuery,window,document)}(function(j,U,m,N){"use strict";function d(t){var e=parseInt(t,10);return!isNaN(e)&&isFinite(t)?e:null}function s(t,e,n){var a="string"==typeof t;return!!r(t)||(e&&a&&(t=G(t,e)),n&&a&&(t=t.replace(q,"")),!isNaN(parseFloat(t))&&isFinite(t))}function n(t,e,n){var a;return!!r(t)||(r(a=t)||"string"==typeof a)&&!!s(t.replace(V,""),e,n)||null}function S(t,e,n,a){var r=[],o=0,i=e.length;if(a!==N)for(;o<i;o++)t[e[o]][n]&&r.push(t[e[o]][n][a]);else for(;o<i;o++)r.push(t[e[o]][n]);return r}function f(t,e){var n,a=[];e===N?(e=0,n=t):(n=e,e=t);for(var r=e;r<n;r++)a.push(r);return a}function y(t){for(var e=[],n=0,a=t.length;n<a;n++)t[n]&&e.push(t[n]);return e}var p,e,t,C=function(D){this.$=function(t,e){return this.api(!0).$(t,e)},this._=function(t,e){return this.api(!0).rows(t,e).data()},this.api=function(t){return new B(t?fe(this[p.iApiIndex]):this)},this.fnAddData=function(t,e){var n=this.api(!0),t=(j.isArray(t)&&(j.isArray(t[0])||j.isPlainObject(t[0]))?n.rows:n.row).add(t);return e!==N&&!e||n.draw(),t.flatten().toArray()},this.fnAdjustColumnSizing=function(t){var e=this.api(!0).columns.adjust(),n=e.settings()[0],a=n.oScroll;t===N||t?e.draw(!1):""===a.sX&&""===a.sY||Yt(n)},this.fnClearTable=function(t){var e=this.api(!0).clear();t!==N&&!t||e.draw()},this.fnClose=function(t){this.api(!0).row(t).child.hide()},this.fnDeleteRow=function(t,e,n){var a=this.api(!0),t=a.rows(t),r=t.settings()[0],o=r.aoData[t[0][0]];return t.remove(),e&&e.call(this,r,o),n!==N&&!n||a.draw(),o},this.fnDestroy=function(t){this.api(!0).destroy(t)},this.fnDraw=function(t){this.api(!0).draw(t)},this.fnFilter=function(t,e,n,a,r,o){var i=this.api(!0);(null===e||e===N?i:i.column(e)).search(t,n,a,o),i.draw()},this.fnGetData=function(t,e){var n,a=this.api(!0);return t!==N?(n=t.nodeName?t.nodeName.toLowerCase():"",e!==N||"td"==n||"th"==n?a.cell(t,e).data():a.row(t).data()||null):a.data().toArray()},this.fnGetNodes=function(t){var e=this.api(!0);return t!==N?e.row(t).node():e.rows().nodes().flatten().toArray()},this.fnGetPosition=function(t){var e=this.api(!0),n=t.nodeName.toUpperCase();return"TR"==n?e.row(t).index():"TD"==n||"TH"==n?[(n=e.cell(t).index()).row,n.columnVisible,n.column]:null},this.fnIsOpen=function(t){return this.api(!0).row(t).child.isShown()},this.fnOpen=function(t,e,n){return this.api(!0).row(t).child(e,n).show().child()[0]},this.fnPageChange=function(t,e){t=this.api(!0).page(t);e!==N&&!e||t.draw(!1)},this.fnSetColumnVis=function(t,e,n){t=this.api(!0).column(t).visible(e);n!==N&&!n||t.columns.adjust().draw()},this.fnSettings=function(){return fe(this[p.iApiIndex])},this.fnSort=function(t){this.api(!0).order(t).draw()},this.fnSortListener=function(t,e,n){this.api(!0).order.listener(t,e,n)},this.fnUpdate=function(t,e,n,a,r){var o=this.api(!0);return(n===N||null===n?o.row(e):o.cell(e,n)).data(t),r!==N&&!r||o.columns.adjust(),a!==N&&!a||o.draw(),0},this.fnVersionCheck=p.fnVersionCheck;var t,v=this,y=D===N,_=this.length;for(t in y&&(D={}),this.oApi=this.internal=p.internal,C.ext.internal)t&&(this[t]=Ne(t));return this.each(function(){var a=1<_?de({},D,!0):D,r=0,t=this.getAttribute("id"),o=!1,e=C.defaults,i=j(this);if("table"!=this.nodeName.toLowerCase())E(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{Z(e),K(e.column),T(e,e,!0),T(e.column,e.column,!0),T(e,j.extend(a,i.data()));for(var n=C.settings,r=0,l=n.length;r<l;r++){var s=n[r];if(s.nTable==this||s.nTHead&&s.nTHead.parentNode==this||s.nTFoot&&s.nTFoot.parentNode==this){var u=(a.bRetrieve!==N?a:e).bRetrieve,c=(a.bDestroy!==N?a:e).bDestroy;if(y||u)return s.oInstance;if(c){s.oInstance.fnDestroy();break}return void E(s,0,"Cannot reinitialise DataTable",3)}if(s.sTableId==this.id){n.splice(r,1);break}}null!==t&&""!==t||(t="DataTables_Table_"+C.ext._unique++,this.id=t);var f,d,h=j.extend(!0,{},C.models.oSettings,{sDestroyWidth:i[0].style.width,sInstance:t,sTableId:t}),p=(h.nTable=this,h.oApi=v.internal,h.oInit=a,n.push(h),h.oInstance=1===v.length?v:i.dataTable(),Z(a),Y(a.oLanguage),a.aLengthMenu&&!a.iDisplayLength&&(a.iDisplayLength=(j.isArray(a.aLengthMenu[0])?a.aLengthMenu[0]:a.aLengthMenu)[0]),a=de(j.extend(!0,{},e),a),F(h.oFeatures,a,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),F(h,a,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"]]),F(h.oScroll,a,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),F(h.oLanguage,a,"fnInfoCallback"),L(h,"aoDrawCallback",a.fnDrawCallback,"user"),L(h,"aoServerParams",a.fnServerParams,"user"),L(h,"aoStateSaveParams",a.fnStateSaveParams,"user"),L(h,"aoStateLoadParams",a.fnStateLoadParams,"user"),L(h,"aoStateLoaded",a.fnStateLoaded,"user"),L(h,"aoRowCallback",a.fnRowCallback,"user"),L(h,"aoRowCreatedCallback",a.fnCreatedRow,"user"),L(h,"aoHeaderCallback",a.fnHeaderCallback,"user"),L(h,"aoFooterCallback",a.fnFooterCallback,"user"),L(h,"aoInitComplete",a.fnInitComplete,"user"),L(h,"aoPreDrawCallback",a.fnPreDrawCallback,"user"),h.rowIdFn=I(a.rowId),Q(h),h.oClasses),g=(j.extend(p,C.ext.classes,a.oClasses),i.addClass(p.sTable),h.iInitDisplayStart===N&&(h.iInitDisplayStart=a.iDisplayStart,h._iDisplayStart=a.iDisplayStart),null!==a.iDeferLoading&&(h.bDeferLoading=!0,t=j.isArray(a.iDeferLoading),h._iRecordsDisplay=t?a.iDeferLoading[0]:a.iDeferLoading,h._iRecordsTotal=t?a.iDeferLoading[1]:a.iDeferLoading),h.oLanguage),t=(j.extend(!0,g,a.oLanguage),g.sUrl&&(j.ajax({dataType:"json",url:g.sUrl,success:function(t){Y(t),T(e.oLanguage,t),j.extend(!0,g,t),Ut(h)},error:function(){Ut(h)}}),o=!0),null===a.asStripeClasses&&(h.asStripeClasses=[p.sStripeOdd,p.sStripeEven]),h.asStripeClasses),b=i.children("tbody").find("tr").eq(0),S=(-1!==j.inArray(!0,j.map(t,function(t,e){return b.hasClass(t)}))&&(j("tbody tr",this).removeClass(t.join(" ")),h.asDestroyStripes=t.slice()),[]),t=this.getElementsByTagName("thead");if(0!==t.length&&(vt(h.aoHeader,t[0]),S=yt(h)),null===a.aoColumns)for(f=[],r=0,l=S.length;r<l;r++)f.push(null);else f=a.aoColumns;for(r=0,l=f.length;r<l;r++)et(h,S?S[r]:null);ot(h,a.aoColumnDefs,f,function(t,e){nt(h,t,e)}),b.length&&(d=function(t,e){return null!==t.getAttribute("data-"+e)?e:null},j(b[0]).children("th, td").each(function(t,e){var n,a=h.aoColumns[t];a.mData===t&&(n=d(e,"sort")||d(e,"order"),e=d(e,"filter")||d(e,"search"),null===n&&null===e||(a.mData={_:t+".display",sort:null!==n?t+".@data-"+n:N,type:null!==n?t+".@data-"+n:N,filter:null!==e?t+".@data-"+e:N},nt(h,t)))}));var m=h.oFeatures,t=function(){if(a.aaSorting===N){var t=h.aaSorting;for(r=0,l=t.length;r<l;r++)t[r][1]=h.aoColumns[r].asSorting[0]}le(h),m.bSort&&L(h,"aoDrawCallback",function(){var t,n;h.bSorted&&(t=A(h),n={},j.each(t,function(t,e){n[e.src]=e.dir}),P(h,null,"order",[h,t,n]),re(h))}),L(h,"aoDrawCallback",function(){(h.bSorted||"ssp"===R(h)||m.bDeferRender)&&le(h)},"sc");var e=i.children("caption").each(function(){this._captionSide=j(this).css("caption-side")}),n=i.children("thead"),n=(0===n.length&&(n=j("<thead/>").appendTo(i)),h.nTHead=n[0],i.children("tbody")),n=(0===n.length&&(n=j("<tbody/>").appendTo(i)),h.nTBody=n[0],i.children("tfoot"));if(0===(n=0===n.length&&0<e.length&&(""!==h.oScroll.sX||""!==h.oScroll.sY)?j("<tfoot/>").appendTo(i):n).length||0===n.children().length?i.addClass(p.sNoFooter):0<n.length&&(h.nTFoot=n[0],vt(h.aoFooter,h.nTFoot)),a.aaData)for(r=0;r<a.aaData.length;r++)x(h,a.aaData[r]);else!h.bDeferLoading&&"dom"!=R(h)||it(h,j(h.nTBody).children("tr"));h.aiDisplay=h.aiDisplayMaster.slice(),!(h.bInitialised=!0)===o&&Ut(h)};a.bStateSave?(m.bStateSave=!0,L(h,"aoDrawCallback",ue,"state_save"),ce(h,0,t)):t()}}),v=null,this},a={},_=/[\r\n]/g,V=/<.*?>/g,X=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/,J=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),q=/[',$Â£â¬Â¥%\u2009\u202F\u20BD\u20a9\u20BArfkÉÎ]/gi,r=function(t){return!t||!0===t||"-"===t},G=function(t,e){return a[e]||(a[e]=new RegExp(jt(e),"g")),"string"==typeof t&&"."!==e?t.replace(/\./g,"").replace(a[e],"."):t},H=function(t,e,n){var a=[],r=0,o=t.length;if(n!==N)for(;r<o;r++)t[r]&&t[r][e]&&a.push(t[r][e][n]);else for(;r<o;r++)t[r]&&a.push(t[r][e]);return a},$=function(t){if(!(t.length<2))for(var e=t.slice().sort(),n=e[0],a=1,r=e.length;a<r;a++){if(e[a]===n)return!1;n=e[a]}return!0},z=function(t){if($(t))return t.slice();var e,n,a,r=[],o=t.length,i=0;t:for(n=0;n<o;n++){for(e=t[n],a=0;a<i;a++)if(r[a]===e)continue t;r.push(e),i++}return r};function i(n){var a,r,o={};j.each(n,function(t,e){(a=t.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(a[1]+" ")&&(r=t.replace(a[0],a[2].toLowerCase()),o[r]=t,"o"===a[1])&&i(n[t])}),n._hungarianMap=o}function T(n,a,r){var o;n._hungarianMap||i(n),j.each(a,function(t,e){(o=n._hungarianMap[t])===N||!r&&a[o]!==N||("o"===o.charAt(0)?(a[o]||(a[o]={}),j.extend(!0,a[o],a[t]),T(n[o],a[o],r)):a[o]=a[t])})}function Y(t){var e,n=C.defaults.oLanguage,a=n.sDecimal;a&&Re(a),t&&(e=t.sZeroRecords,!t.sEmptyTable&&e&&"No data available in table"===n.sEmptyTable&&F(t,t,"sZeroRecords","sEmptyTable"),!t.sLoadingRecords&&e&&"Loading..."===n.sLoadingRecords&&F(t,t,"sZeroRecords","sLoadingRecords"),t.sInfoThousands&&(t.sThousands=t.sInfoThousands),e=t.sDecimal)&&a!==e&&Re(e)}C.util={throttle:function(a,t){var r,o,i=t!==N?t:200;return function(){var t=this,e=+new Date,n=arguments;r&&e<r+i?(clearTimeout(o),o=setTimeout(function(){r=N,a.apply(t,n)},i)):(r=e,a.apply(t,n))}},escapeRegex:function(t){return t.replace(J,"\\$1")}};var o=function(t,e,n){t[e]!==N&&(t[n]=t[e])};function Z(t){o(t,"ordering","bSort"),o(t,"orderMulti","bSortMulti"),o(t,"orderClasses","bSortClasses"),o(t,"orderCellsTop","bSortCellsTop"),o(t,"order","aaSorting"),o(t,"orderFixed","aaSortingFixed"),o(t,"paging","bPaginate"),o(t,"pagingType","sPaginationType"),o(t,"pageLength","iDisplayLength"),o(t,"searching","bFilter"),"boolean"==typeof t.sScrollX&&(t.sScrollX=t.sScrollX?"100%":""),"boolean"==typeof t.scrollX&&(t.scrollX=t.scrollX?"100%":"");var e=t.aoSearchCols;if(e)for(var n=0,a=e.length;n<a;n++)e[n]&&T(C.models.oSearch,e[n])}function K(t){o(t,"orderable","bSortable"),o(t,"orderData","aDataSort"),o(t,"orderSequence","asSorting"),o(t,"orderDataType","sortDataType");var e=t.aDataSort;"number"!=typeof e||j.isArray(e)||(t.aDataSort=[e])}function Q(t){var e,n,a,r;C.__browser||(C.__browser=e={},r=(a=(n=j("<div/>").css({position:"fixed",top:0,left:-1*j(U).scrollLeft(),height:1,width:1,overflow:"hidden"}).append(j("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(j("<div/>").css({width:"100%",height:10}))).appendTo("body")).children()).children(),e.barWidth=a[0].offsetWidth-a[0].clientWidth,e.bScrollOversize=100===r[0].offsetWidth&&100!==a[0].clientWidth,e.bScrollbarLeft=1!==Math.round(r.offset().left),e.bBounding=!!n[0].getBoundingClientRect().width,n.remove()),j.extend(t.oBrowser,C.__browser),t.oScroll.iBarWidth=C.__browser.barWidth}function tt(t,e,n,a,r,o){var i,l=a,s=!1;for(n!==N&&(i=n,s=!0);l!==r;)t.hasOwnProperty(l)&&(i=s?e(i,t[l],l,t):t[l],s=!0,l+=o);return i}function et(t,e){var n=C.defaults.column,a=t.aoColumns.length,n=j.extend({},C.models.oColumn,n,{nTh:e||m.createElement("th"),sTitle:n.sTitle||(e?e.innerHTML:""),aDataSort:n.aDataSort||[a],mData:n.mData||a,idx:a}),n=(t.aoColumns.push(n),t.aoPreSearchCols);n[a]=j.extend({},C.models.oSearch,n[a]),nt(t,a,j(e).data())}function nt(t,e,n){function a(t){return"string"==typeof t&&-1!==t.indexOf("@")}var e=t.aoColumns[e],r=t.oClasses,o=j(e.nTh),i=(!e.sWidthOrig&&(e.sWidthOrig=o.attr("width")||null,u=(o.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/))&&(e.sWidthOrig=u[1]),n!==N&&null!==n&&(K(n),T(C.defaults.column,n),n.mDataProp===N||n.mData||(n.mData=n.mDataProp),n.sType&&(e._sManualType=n.sType),n.className&&!n.sClass&&(n.sClass=n.className),n.sClass&&o.addClass(n.sClass),j.extend(e,n),F(e,n,"sWidth","sWidthOrig"),n.iDataSort!==N&&(e.aDataSort=[n.iDataSort]),F(e,n,"aDataSort")),e.mData),l=I(i),s=e.mRender?I(e.mRender):null,u=(e._bAttrSrc=j.isPlainObject(i)&&(a(i.sort)||a(i.type)||a(i.filter)),e._setter=null,e.fnGetData=function(t,e,n){var a=l(t,e,N,n);return s&&e?s(a,e,t,n):a},e.fnSetData=function(t,e,n){return b(i)(t,e,n)},"number"!=typeof i&&(t._rowReadObject=!0),t.oFeatures.bSort||(e.bSortable=!1,o.addClass(r.sSortableNone)),-1!==j.inArray("asc",e.asSorting)),n=-1!==j.inArray("desc",e.asSorting);e.bSortable&&(u||n)?u&&!n?(e.sSortingClass=r.sSortableAsc,e.sSortingClassJUI=r.sSortJUIAscAllowed):!u&&n?(e.sSortingClass=r.sSortableDesc,e.sSortingClassJUI=r.sSortJUIDescAllowed):(e.sSortingClass=r.sSortable,e.sSortingClassJUI=r.sSortJUI):(e.sSortingClass=r.sSortableNone,e.sSortingClassJUI="")}function O(t){if(!1!==t.oFeatures.bAutoWidth){var e=t.aoColumns;Kt(t);for(var n=0,a=e.length;n<a;n++)e[n].nTh.style.width=e[n].sWidth}var r=t.oScroll;""===r.sY&&""===r.sX||Yt(t),P(t,null,"column-sizing",[t])}function k(t,e){t=at(t,"bVisible");return"number"==typeof t[e]?t[e]:null}function c(t,e){t=at(t,"bVisible"),e=j.inArray(e,t);return-1!==e?e:null}function w(t){var n=0;return j.each(t.aoColumns,function(t,e){e.bVisible&&"none"!==j(e.nTh).css("display")&&n++}),n}function at(t,n){var a=[];return j.map(t.aoColumns,function(t,e){t[n]&&a.push(e)}),a}function rt(t){for(var e,n,a,r,o,i,l,s=t.aoColumns,u=t.aoData,c=C.ext.type.detect,f=0,d=s.length;f<d;f++)if(l=[],!(o=s[f]).sType&&o._sManualType)o.sType=o._sManualType;else if(!o.sType){for(e=0,n=c.length;e<n;e++){for(a=0,r=u.length;a<r&&(l[a]===N&&(l[a]=D(t,a,f,"type")),(i=c[e](l[a],t))||e===c.length-1)&&"html"!==i;a++);if(i){o.sType=i;break}}o.sType||(o.sType="string")}}function ot(t,e,n,a){var r,o,i,l,s=t.aoColumns;if(e)for(r=e.length-1;0<=r;r--)for(var u,c=(u=e[r]).targets!==N?u.targets:u.aTargets,f=0,d=(c=j.isArray(c)?c:[c]).length;f<d;f++)if("number"==typeof c[f]&&0<=c[f]){for(;s.length<=c[f];)et(t);a(c[f],u)}else if("number"==typeof c[f]&&c[f]<0)a(s.length+c[f],u);else if("string"==typeof c[f])for(i=0,l=s.length;i<l;i++)"_all"!=c[f]&&!j(s[i].nTh).hasClass(c[f])||a(i,u);if(n)for(r=0,o=n.length;r<o;r++)a(r,n[r])}function x(t,e,n,a){for(var r=t.aoData.length,o=j.extend(!0,{},C.models.oRow,{src:n?"dom":"data",idx:r}),i=(o._aData=e,t.aoData.push(o),t.aoColumns),l=0,s=i.length;l<s;l++)i[l].sType=null;t.aiDisplayMaster.push(r);e=t.rowIdFn(e);return e!==N&&(t.aIds[e]=o),!n&&t.oFeatures.bDeferRender||gt(t,r,n,a),r}function it(n,t){var a;return(t=t instanceof j?t:j(t)).map(function(t,e){return a=pt(n,e),x(n,a.data,e,a.cells)})}function D(t,e,n,a){var r=t.iDraw,o=t.aoColumns[n],i=t.aoData[e]._aData,l=o.sDefaultContent,s=o.fnGetData(i,a,{settings:t,row:e,col:n});if(s===N)return t.iDrawError!=r&&null===l&&(E(t,0,"Requested unknown parameter "+("function"==typeof o.mData?"{function}":"'"+o.mData+"'")+" for row "+e+", column "+n,4),t.iDrawError=r),l;if(s!==i&&null!==s||null===l||a===N){if("function"==typeof s)return s.call(i)}else s=l;return null===s&&"display"==a?"":s}function lt(t,e,n,a){var r=t.aoColumns[n],o=t.aoData[e]._aData;r.fnSetData(o,a,{settings:t,row:e,col:n})}var st=/\[.*?\]$/,h=/\(\)$/;function ut(t){return j.map(t.match(/(\\.|[^\.])+/g)||[""],function(t){return t.replace(/\\\./g,".")})}function I(r){var o,d;return j.isPlainObject(r)?(o={},j.each(r,function(t,e){e&&(o[t]=I(e))}),function(t,e,n,a){var r=o[e]||o._;return r!==N?r(t,e,n,a):t}):null===r?function(t){return t}:"function"==typeof r?function(t,e,n,a){return r(t,e,n,a)}:"string"!=typeof r||-1===r.indexOf(".")&&-1===r.indexOf("[")&&-1===r.indexOf("(")?function(t,e){return t[r]}:(d=function(t,e,n){var a,r,o;if(""!==n)for(var i=ut(n),l=0,s=i.length;l<s;l++){if(f=i[l].match(st),a=i[l].match(h),f){if(i[l]=i[l].replace(st,""),""!==i[l]&&(t=t[i[l]]),r=[],i.splice(0,l+1),o=i.join("."),j.isArray(t))for(var u=0,c=t.length;u<c;u++)r.push(d(t[u],e,o));var f=f[0].substring(1,f[0].length-1);t=""===f?r:r.join(f);break}if(a)i[l]=i[l].replace(h,""),t=t[i[l]]();else{if(null===t||t[i[l]]===N)return N;t=t[i[l]]}}return t},function(t,e){return d(t,e,r)})}function b(a){var d;return j.isPlainObject(a)?b(a._):null===a?function(){}:"function"==typeof a?function(t,e,n){a(t,"set",e,n)}:"string"!=typeof a||-1===a.indexOf(".")&&-1===a.indexOf("[")&&-1===a.indexOf("(")?function(t,e){t[a]=e}:(d=function(t,e,n){for(var a,r,o,i,l=ut(n),n=l[l.length-1],s=0,u=l.length-1;s<u;s++){if(a=l[s].match(st),r=l[s].match(h),a){if(l[s]=l[s].replace(st,""),t[l[s]]=[],(a=l.slice()).splice(0,s+1),i=a.join("."),j.isArray(e))for(var c=0,f=e.length;c<f;c++)d(o={},e[c],i),t[l[s]].push(o);else t[l[s]]=e;return}r&&(l[s]=l[s].replace(h,""),t=t[l[s]](e)),null!==t[l[s]]&&t[l[s]]!==N||(t[l[s]]={}),t=t[l[s]]}n.match(h)?t[n.replace(h,"")](e):t[n.replace(st,"")]=e},function(t,e){return d(t,e,a)})}function ct(t){return H(t.aoData,"_aData")}function ft(t){t.aoData.length=0,t.aiDisplayMaster.length=0,t.aiDisplay.length=0,t.aIds={}}function dt(t,e,n){for(var a=-1,r=0,o=t.length;r<o;r++)t[r]==e?a=r:t[r]>e&&t[r]--;-1!=a&&n===N&&t.splice(a,1)}function ht(n,a,t,e){function r(t,e){for(;t.childNodes.length;)t.removeChild(t.firstChild);t.innerHTML=D(n,a,e,"display")}var o,i,l=n.aoData[a];if("dom"!==t&&(t&&"auto"!==t||"dom"!==l.src)){var s=l.anCells;if(s)if(e!==N)r(s[e],e);else for(o=0,i=s.length;o<i;o++)r(s[o],o)}else l._aData=pt(n,l,e,e===N?N:l._aData).data;l._aSortData=null,l._aFilterData=null;var u=n.aoColumns;if(e!==N)u[e].sType=null;else{for(o=0,i=u.length;o<i;o++)u[o].sType=null;bt(n,l)}}function pt(t,e,n,a){function r(t,e){var n;"string"==typeof t&&-1!==(n=t.indexOf("@"))&&(n=t.substring(n+1),b(t)(a,e.getAttribute(n)))}function o(t){n!==N&&n!==f||(l=d[f],s=j.trim(t.innerHTML),l&&l._bAttrSrc?(b(l.mData._)(a,s),r(l.mData.sort,t),r(l.mData.type,t),r(l.mData.filter,t)):h?(l._setter||(l._setter=b(l.mData)),l._setter(a,s)):a[f]=s),f++}var i,l,s,u=[],c=e.firstChild,f=0,d=t.aoColumns,h=t._rowReadObject;a=a!==N?a:h?{}:[];if(c)for(;c;)"TD"!=(i=c.nodeName.toUpperCase())&&"TH"!=i||(o(c),u.push(c)),c=c.nextSibling;else for(var p=0,g=(u=e.anCells).length;p<g;p++)o(u[p]);var e=e.firstChild?e:e.nTr;return e&&(e=e.getAttribute("id"))&&b(t.rowId)(a,e),{data:a,cells:u}}function gt(t,e,n,a){var r,o,i,l,s,u=t.aoData[e],c=u._aData,f=[];if(null===u.nTr){for(r=n||m.createElement("tr"),u.nTr=r,u.anCells=f,r._DT_RowIndex=e,bt(t,u),l=0,s=t.aoColumns.length;l<s;l++)i=t.aoColumns[l],(o=n?a[l]:m.createElement(i.sCellType))._DT_CellIndex={row:e,column:l},f.push(o),n&&!i.mRender&&i.mData===l||j.isPlainObject(i.mData)&&i.mData._===l+".display"||(o.innerHTML=D(t,e,l,"display")),i.sClass&&(o.className+=" "+i.sClass),i.bVisible&&!n?r.appendChild(o):!i.bVisible&&n&&o.parentNode.removeChild(o),i.fnCreatedCell&&i.fnCreatedCell.call(t.oInstance,o,D(t,e,l),c,e,l);P(t,"aoRowCreatedCallback",null,[r,c,e,f])}u.nTr.setAttribute("role","row")}function bt(t,e){var n=e.nTr,a=e._aData;n&&((t=t.rowIdFn(a))&&(n.id=t),a.DT_RowClass&&(t=a.DT_RowClass.split(" "),e.__rowc=e.__rowc?z(e.__rowc.concat(t)):t,j(n).removeClass(e.__rowc.join(" ")).addClass(a.DT_RowClass)),a.DT_RowAttr&&j(n).attr(a.DT_RowAttr),a.DT_RowData)&&j(n).data(a.DT_RowData)}function St(t){var e,n,a,r=t.nTHead,o=t.nTFoot,i=0===j("th, td",r).length,l=t.oClasses,s=t.aoColumns;for(i&&(n=j("<tr/>").appendTo(r)),c=0,f=s.length;c<f;c++)a=s[c],e=j(a.nTh).addClass(a.sClass),i&&e.appendTo(n),t.oFeatures.bSort&&(e.addClass(a.sSortingClass),!1!==a.bSortable)&&(e.attr("tabindex",t.iTabIndex).attr("aria-controls",t.sTableId),ie(t,a.nTh,c)),a.sTitle!=e[0].innerHTML&&e.html(a.sTitle),ge(t,"header")(t,e,a,l);if(i&&vt(t.aoHeader,r),j(r).find(">tr").attr("role","row"),j(r).find(">tr>th, >tr>td").addClass(l.sHeaderTH),j(o).find(">tr>th, >tr>td").addClass(l.sFooterTH),null!==o)for(var u=t.aoFooter[0],c=0,f=u.length;c<f;c++)(a=s[c]).nTf=u[c].cell,a.sClass&&j(a.nTf).addClass(a.sClass)}function mt(t,e,n){var a,r,o,i,l,s,u,c,f,d=[],h=[],p=t.aoColumns.length;if(e){for(n===N&&(n=!1),a=0,r=e.length;a<r;a++){for(d[a]=e[a].slice(),d[a].nTr=e[a].nTr,o=p-1;0<=o;o--)t.aoColumns[o].bVisible||n||d[a].splice(o,1);h.push([])}for(a=0,r=d.length;a<r;a++){if(u=d[a].nTr)for(;s=u.firstChild;)u.removeChild(s);for(o=0,i=d[a].length;o<i;o++)if(f=c=1,h[a][o]===N){for(u.appendChild(d[a][o].cell),h[a][o]=1;d[a+c]!==N&&d[a][o].cell==d[a+c][o].cell;)h[a+c][o]=1,c++;for(;d[a][o+f]!==N&&d[a][o].cell==d[a][o+f].cell;){for(l=0;l<c;l++)h[a+l][o+f]=1;f++}j(d[a][o].cell).attr("rowspan",c).attr("colspan",f)}}}}function g(t){var e=P(t,"aoPreDrawCallback","preDraw",[t]);if(-1!==j.inArray(!1,e))v(t,!1);else{var n=[],a=0,r=t.asStripeClasses,o=r.length,e=(t.aoOpenRows.length,t.oLanguage),i=t.iInitDisplayStart,l="ssp"==R(t),s=t.aiDisplay,i=(t.bDrawing=!0,i!==N&&-1!==i&&(t._iDisplayStart=!l&&i>=t.fnRecordsDisplay()?0:i,t.iInitDisplayStart=-1),t._iDisplayStart),u=t.fnDisplayEnd();if(t.bDeferLoading)t.bDeferLoading=!1,t.iDraw++,v(t,!1);else if(l){if(!t.bDestroying&&!Ct(t))return}else t.iDraw++;if(0!==s.length)for(var c=l?t.aoData.length:u,f=l?0:i;f<c;f++){var d,h=s[f],p=t.aoData[h],g=(null===p.nTr&&gt(t,h),p.nTr);0!==o&&(d=r[a%o],p._sRowStripe!=d)&&(j(g).removeClass(p._sRowStripe).addClass(d),p._sRowStripe=d),P(t,"aoRowCallback",null,[g,p._aData,a,f,h]),n.push(g),a++}else{l=e.sZeroRecords;1==t.iDraw&&"ajax"==R(t)?l=e.sLoadingRecords:e.sEmptyTable&&0===t.fnRecordsTotal()&&(l=e.sEmptyTable),n[0]=j("<tr/>",{class:o?r[0]:""}).append(j("<td />",{valign:"top",colSpan:w(t),class:t.oClasses.sRowEmpty}).html(l))[0]}P(t,"aoHeaderCallback","header",[j(t.nTHead).children("tr")[0],ct(t),i,u,s]),P(t,"aoFooterCallback","footer",[j(t.nTFoot).children("tr")[0],ct(t),i,u,s]);e=j(t.nTBody);e.children().detach(),e.append(j(n)),P(t,"aoDrawCallback","draw",[t]),t.bSorted=!1,t.bFiltered=!1,t.bDrawing=!1}}function u(t,e){var n=t.oFeatures,a=n.bSort,n=n.bFilter;a&&ae(t),n?At(t,t.oPreviousSearch):t.aiDisplay=t.aiDisplayMaster.slice(),!0!==e&&(t._iDisplayStart=0),t._drawHold=e,g(t),t._drawHold=!1}function Dt(t){for(var e,n,a,r,o,i,l,s=t.oClasses,u=j(t.nTable),u=j("<div/>").insertBefore(u),c=t.oFeatures,f=j("<div/>",{id:t.sTableId+"_wrapper",class:s.sWrapper+(t.nTFoot?"":" "+s.sNoFooter)}),d=(t.nHolding=u[0],t.nTableWrapper=f[0],t.nTableReinsertBefore=t.nTable.nextSibling,t.sDom.split("")),h=0;h<d.length;h++){if(e=null,"<"==(n=d[h])){if(a=j("<div/>")[0],"'"==(r=d[h+1])||'"'==r){for(o="",i=2;d[h+i]!=r;)o+=d[h+i],i++;"H"==o?o=s.sJUIHeader:"F"==o&&(o=s.sJUIFooter),-1!=o.indexOf(".")?(l=o.split("."),a.id=l[0].substr(1,l[0].length-1),a.className=l[1]):"#"==o.charAt(0)?a.id=o.substr(1,o.length-1):a.className=o,h+=i}f.append(a),f=j(a)}else if(">"==n)f=f.parent();else if("l"==n&&c.bPaginate&&c.bLengthChange)e=Jt(t);else if("f"==n&&c.bFilter)e=It(t);else if("r"==n&&c.bProcessing)e=$t(t);else if("t"==n)e=zt(t);else if("i"==n&&c.bInfo)e=Wt(t);else if("p"==n&&c.bPaginate)e=qt(t);else if(0!==C.ext.feature.length)for(var p=C.ext.feature,g=0,b=p.length;g<b;g++)if(n==p[g].cFeature){e=p[g].fnInit(t);break}e&&((l=t.aanFeatures)[n]||(l[n]=[]),l[n].push(e),f.append(e))}u.replaceWith(f),t.nHolding=null}function vt(t,e){var n,a,r,o,i,l,s,u,c,f,d=j(e).children("tr");for(t.splice(0,t.length),r=0,l=d.length;r<l;r++)t.push([]);for(r=0,l=d.length;r<l;r++)for(a=(n=d[r]).firstChild;a;){if("TD"==a.nodeName.toUpperCase()||"TH"==a.nodeName.toUpperCase())for(u=(u=+a.getAttribute("colspan"))&&0!=u&&1!=u?u:1,c=(c=+a.getAttribute("rowspan"))&&0!=c&&1!=c?c:1,s=function(t,e,n){for(var a=t[e];a[n];)n++;return n}(t,r,0),f=1==u,i=0;i<u;i++)for(o=0;o<c;o++)t[r+o][s+i]={cell:a,unique:f},t[r+o].nTr=n;a=a.nextSibling}}function yt(t,e,n){var a=[];n||(n=t.aoHeader,e&&vt(n=[],e));for(var r=0,o=n.length;r<o;r++)for(var i=0,l=n[r].length;i<l;i++)!n[r][i].unique||a[i]&&t.bSortCellsTop||(a[i]=n[r][i].cell);return a}function _t(r,t,e){function n(t){P(r,null,"xhr",[r,t,r.jqXHR]),e(t)}P(r,"aoServerParams","serverParams",[t]),t&&j.isArray(t)&&(a={},o=/(.*?)\[\]$/,j.each(t,function(t,e){var n=e.name.match(o);n?(n=n[0],a[n]||(a[n]=[]),a[n].push(e.value)):a[e.name]=e.value}),t=a);var a,o,i,l=r.ajax,s=r.oInstance,u=(j.isPlainObject(l)&&l.data&&(u="function"==typeof(i=l.data)?i(t,r):i,t="function"==typeof i&&u?u:j.extend(!0,t,u),delete l.data),{data:t,success:function(t){var e=t.error||t.sError;e&&E(r,0,e),r.json=t,n(t)},dataType:"json",cache:!1,type:r.sServerMethod,error:function(t,e,n){var a=P(r,null,"xhr",[r,null,r.jqXHR]);-1===j.inArray(!0,a)&&("parsererror"==e?E(r,0,"Invalid JSON response",1):4===t.readyState&&E(r,0,"Ajax error",7)),v(r,!1)}});r.oAjaxData=t,P(r,null,"preXhr",[r,t]),r.fnServerData?r.fnServerData.call(s,r.sAjaxSource,j.map(t,function(t,e){return{name:e,value:t}}),n,r):r.sAjaxSource||"string"==typeof l?r.jqXHR=j.ajax(j.extend(u,{url:l||r.sAjaxSource})):"function"==typeof l?r.jqXHR=l.call(s,t,n,r):(r.jqXHR=j.ajax(j.extend(u,l)),l.data=i)}function Ct(e){return!e.bAjaxDataGet||(e.iDraw++,v(e,!0),_t(e,Tt(e),function(t){wt(e,t)}),!1)}function Tt(t){for(var e,n,a,r=t.aoColumns,o=r.length,i=t.oFeatures,l=t.oPreviousSearch,s=t.aoPreSearchCols,u=[],c=A(t),f=t._iDisplayStart,d=!1!==i.bPaginate?t._iDisplayLength:-1,h=function(t,e){u.push({name:t,value:e})},p=(h("sEcho",t.iDraw),h("iColumns",o),h("sColumns",H(r,"sName").join(",")),h("iDisplayStart",f),h("iDisplayLength",d),{draw:t.iDraw,columns:[],order:[],start:f,length:d,search:{value:l.sSearch,regex:l.bRegex}}),g=0;g<o;g++)n=r[g],a=s[g],e="function"==typeof n.mData?"function":n.mData,p.columns.push({data:e,name:n.sName,searchable:n.bSearchable,orderable:n.bSortable,search:{value:a.sSearch,regex:a.bRegex}}),h("mDataProp_"+g,e),i.bFilter&&(h("sSearch_"+g,a.sSearch),h("bRegex_"+g,a.bRegex),h("bSearchable_"+g,n.bSearchable)),i.bSort&&h("bSortable_"+g,n.bSortable);i.bFilter&&(h("sSearch",l.sSearch),h("bRegex",l.bRegex)),i.bSort&&(j.each(c,function(t,e){p.order.push({column:e.col,dir:e.dir}),h("iSortCol_"+t,e.col),h("sSortDir_"+t,e.dir)}),h("iSortingCols",c.length));f=C.ext.legacy.ajax;return null===f?t.sAjaxSource?u:p:f?u:p}function wt(t,n){function e(t,e){return n[t]!==N?n[t]:n[e]}var a=xt(t,n),r=e("sEcho","draw"),o=e("iTotalRecords","recordsTotal"),i=e("iTotalDisplayRecords","recordsFiltered");if(r){if(+r<t.iDraw)return;t.iDraw=+r}ft(t),t._iRecordsTotal=parseInt(o,10),t._iRecordsDisplay=parseInt(i,10);for(var l=0,s=a.length;l<s;l++)x(t,a[l]);t.aiDisplay=t.aiDisplayMaster.slice(),t.bAjaxDataGet=!1,g(t),t._bInitComplete||Vt(t,n),t.bAjaxDataGet=!0,v(t,!1)}function xt(t,e){t=j.isPlainObject(t.ajax)&&t.ajax.dataSrc!==N?t.ajax.dataSrc:t.sAjaxDataProp;return"data"===t?e.aaData||e[t]:""!==t?I(t)(e):e}function It(n){function t(){i.f;var t=this.value||"";t!=o.sSearch&&(At(n,{sSearch:t,bRegex:o.bRegex,bSmart:o.bSmart,bCaseInsensitive:o.bCaseInsensitive}),n._iDisplayStart=0,g(n))}var e=n.oClasses,a=n.sTableId,r=n.oLanguage,o=n.oPreviousSearch,i=n.aanFeatures,l='<input type="search" class="'+e.sFilterInput+'"/>',s=(s=r.sSearch).match(/_INPUT_/)?s.replace("_INPUT_",l):s+l,l=j("<div/>",{id:i.f?null:a+"_filter",class:e.sFilter}).append(j("<label/>").append(s)),e=null!==n.searchDelay?n.searchDelay:"ssp"===R(n)?400:0,u=j("input",l).val(o.sSearch).attr("placeholder",r.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",e?Qt(t,e):t).on("keypress.DT",function(t){if(13==t.keyCode)return!1}).attr("aria-controls",a);return j(n.nTable).on("search.dt.DT",function(t,e){if(n===e)try{u[0]!==m.activeElement&&u.val(o.sSearch)}catch(t){}}),l[0]}function At(t,e,n){function a(t){o.sSearch=t.sSearch,o.bRegex=t.bRegex,o.bSmart=t.bSmart,o.bCaseInsensitive=t.bCaseInsensitive}function r(t){return t.bEscapeRegex!==N?!t.bEscapeRegex:t.bRegex}var o=t.oPreviousSearch,i=t.aoPreSearchCols;if(rt(t),"ssp"!=R(t)){Pt(t,e.sSearch,n,r(e),e.bSmart,e.bCaseInsensitive),a(e);for(var l=0;l<i.length;l++)Lt(t,i[l].sSearch,l,r(i[l]),i[l].bSmart,i[l].bCaseInsensitive);Ft(t)}else a(e);t.bFiltered=!0,P(t,null,"search",[t])}function Ft(t){for(var e,n,a=C.ext.search,r=t.aiDisplay,o=0,i=a.length;o<i;o++){for(var l=[],s=0,u=r.length;s<u;s++)n=r[s],e=t.aoData[n],a[o](t,e._aFilterData,n,e._aData,s)&&l.push(n);r.length=0,j.merge(r,l)}}function Lt(t,e,n,a,r,o){if(""!==e){for(var i,l=[],s=t.aiDisplay,u=Rt(e,a,r,o),c=0;c<s.length;c++)i=t.aoData[s[c]]._aFilterData[n],u.test(i)&&l.push(s[c]);t.aiDisplay=l}}function Pt(t,e,n,a,r,o){var i,l,s=Rt(e,a,r,o),a=t.oPreviousSearch.sSearch,r=t.aiDisplayMaster,u=[];if(0!==C.ext.search.length&&(n=!0),o=Ot(t),e.length<=0)t.aiDisplay=r.slice();else{for((o||n||a.length>e.length||0!==e.indexOf(a)||t.bSorted)&&(t.aiDisplay=r.slice()),i=t.aiDisplay,l=0;l<i.length;l++)s.test(t.aoData[i[l]]._sFilterRow)&&u.push(i[l]);t.aiDisplay=u}}function Rt(t,e,n,a){return t=e?t:jt(t),n&&(t="^(?=.*?"+j.map(t.match(/"[^"]+"|[^ ]+/g)||[""],function(t){var e;return(t='"'===t.charAt(0)?(e=t.match(/^"(.*)"$/))?e[1]:t:t).replace('"',"")}).join(")(?=.*?")+").*$"),new RegExp(t,a?"i":"")}var jt=C.util.escapeRegex,Nt=j("<div>")[0],Ht=Nt.textContent!==N;function Ot(t){for(var e,n,a,r,o,i,l=t.aoColumns,s=C.ext.type.search,u=!1,c=0,f=t.aoData.length;c<f;c++)if(!(i=t.aoData[c])._aFilterData){for(r=[],n=0,a=l.length;n<a;n++)(e=l[n]).bSearchable?(o=D(t,c,n,"filter"),"string"!=typeof(o=null===(o=s[e.sType]?s[e.sType](o):o)?"":o)&&o.toString&&(o=o.toString())):o="",o.indexOf&&-1!==o.indexOf("&")&&(Nt.innerHTML=o,o=Ht?Nt.textContent:Nt.innerText),o.replace&&(o=o.replace(/[\r\n]/g,"")),r.push(o);i._aFilterData=r,i._sFilterRow=r.join("  "),u=!0}return u}function kt(t){return{search:t.sSearch,smart:t.bSmart,regex:t.bRegex,caseInsensitive:t.bCaseInsensitive}}function Mt(t){return{sSearch:t.search,bSmart:t.smart,bRegex:t.regex,bCaseInsensitive:t.caseInsensitive}}function Wt(t){var e=t.sTableId,n=t.aanFeatures.i,a=j("<div/>",{class:t.oClasses.sInfo,id:n?null:e+"_info"});return n||(t.aoDrawCallback.push({fn:Et,sName:"information"}),a.attr("role","status").attr("aria-live","polite"),j(t.nTable).attr("aria-describedby",e+"_info")),a[0]}function Et(t){var e,n,a,r,o,i,l=t.aanFeatures.i;0!==l.length&&(i=t.oLanguage,e=t._iDisplayStart+1,n=t.fnDisplayEnd(),a=t.fnRecordsTotal(),o=(r=t.fnRecordsDisplay())?i.sInfo:i.sInfoEmpty,r!==a&&(o+=" "+i.sInfoFiltered),o=Bt(t,o+=i.sInfoPostFix),null!==(i=i.fnInfoCallback)&&(o=i.call(t.oInstance,t,e,n,a,r,o)),j(l).html(o))}function Bt(t,e){var n=t.fnFormatNumber,a=t._iDisplayStart+1,r=t._iDisplayLength,o=t.fnRecordsDisplay(),i=-1===r;return e.replace(/_START_/g,n.call(t,a)).replace(/_END_/g,n.call(t,t.fnDisplayEnd())).replace(/_MAX_/g,n.call(t,t.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(t,o)).replace(/_PAGE_/g,n.call(t,i?1:Math.ceil(a/r))).replace(/_PAGES_/g,n.call(t,i?1:Math.ceil(o/r)))}function Ut(n){var a,t,e,r=n.iInitDisplayStart,o=n.aoColumns,i=n.oFeatures,l=n.bDeferLoading;if(n.bInitialised){for(Dt(n),St(n),mt(n,n.aoHeader),mt(n,n.aoFooter),v(n,!0),i.bAutoWidth&&Kt(n),a=0,t=o.length;a<t;a++)(e=o[a]).sWidth&&(e.nTh.style.width=W(e.sWidth));P(n,null,"preInit",[n]),u(n);i=R(n);"ssp"==i&&!l||("ajax"==i?_t(n,[],function(t){var e=xt(n,t);for(a=0;a<e.length;a++)x(n,e[a]);n.iInitDisplayStart=r,u(n),v(n,!1),Vt(n,t)}):(v(n,!1),Vt(n)))}else setTimeout(function(){Ut(n)},200)}function Vt(t,e){t._bInitComplete=!0,(e||t.oInit.aaData)&&O(t),P(t,null,"plugin-init",[t,e]),P(t,"aoInitComplete","init",[t,e])}function Xt(t,e){e=parseInt(e,10);t._iDisplayLength=e,pe(t),P(t,null,"length",[t,e])}function Jt(a){for(var t=a.oClasses,e=a.sTableId,n=a.aLengthMenu,r=j.isArray(n[0]),o=r?n[0]:n,i=r?n[1]:n,l=j("<select/>",{name:e+"_length","aria-controls":e,class:t.sLengthSelect}),s=0,u=o.length;s<u;s++)l[0][s]=new Option("number"==typeof i[s]?a.fnFormatNumber(i[s]):i[s],o[s]);var c=j("<div><label/></div>").addClass(t.sLength);return a.aanFeatures.l||(c[0].id=e+"_length"),c.children().append(a.oLanguage.sLengthMenu.replace("_MENU_",l[0].outerHTML)),j("select",c).val(a._iDisplayLength).on("change.DT",function(t){Xt(a,j(this).val()),g(a)}),j(a.nTable).on("length.dt.DT",function(t,e,n){a===e&&j("select",c).val(n)}),c[0]}function qt(t){function c(t){g(t)}var e=t.sPaginationType,f=C.ext.pager[e],d="function"==typeof f,e=j("<div/>").addClass(t.oClasses.sPaging+e)[0],h=t.aanFeatures;return d||f.fnInit(t,e,c),h.p||(e.id=t.sTableId+"_paginate",t.aoDrawCallback.push({fn:function(t){if(d)for(var e=t._iDisplayStart,n=t._iDisplayLength,a=t.fnRecordsDisplay(),r=-1===n,o=r?0:Math.ceil(e/n),i=r?1:Math.ceil(a/n),l=f(o,i),s=0,u=h.p.length;s<u;s++)ge(t,"pageButton")(t,h.p[s],s,l,o,i);else f.fnUpdate(t,c)},sName:"pagination"})),e}function Gt(t,e,n){var a=t._iDisplayStart,r=t._iDisplayLength,o=t.fnRecordsDisplay(),o=(0===o||-1===r?a=0:"number"==typeof e?o<(a=e*r)&&(a=0):"first"==e?a=0:"previous"==e?(a=0<=r?a-r:0)<0&&(a=0):"next"==e?a+r<o&&(a+=r):"last"==e?a=Math.floor((o-1)/r)*r:E(t,0,"Unknown paging action: "+e,5),t._iDisplayStart!==a);return t._iDisplayStart=a,o&&(P(t,null,"page",[t]),n)&&g(t),o}function $t(t){return j("<div/>",{id:t.aanFeatures.r?null:t.sTableId+"_processing",class:t.oClasses.sProcessing}).html(t.oLanguage.sProcessing).insertBefore(t.nTable)[0]}function v(t,e){t.oFeatures.bProcessing&&j(t.aanFeatures.r).css("display",e?"block":"none"),P(t,null,"processing",[t,e])}function zt(t){var e,n,a,r,o,i,l,s,u,c,f,d,h=j(t.nTable),p=(h.attr("role","grid"),t.oScroll);return""===p.sX&&""===p.sY?t.nTable:(e=p.sX,n=p.sY,a=t.oClasses,o=(r=h.children("caption")).length?r[0]._captionSide:null,s=j(h[0].cloneNode(!1)),i=j(h[0].cloneNode(!1)),u=function(t){return t?W(t):null},(l=h.children("tfoot")).length||(l=null),s=j(f="<div/>",{class:a.sScrollWrapper}).append(j(f,{class:a.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:e?u(e):"100%"}).append(j(f,{class:a.sScrollHeadInner}).css({"box-sizing":"content-box",width:p.sXInner||"100%"}).append(s.removeAttr("id").css("margin-left",0).append("top"===o?r:null).append(h.children("thead"))))).append(j(f,{class:a.sScrollBody}).css({position:"relative",overflow:"auto",width:u(e)}).append(h)),l&&s.append(j(f,{class:a.sScrollFoot}).css({overflow:"hidden",border:0,width:e?u(e):"100%"}).append(j(f,{class:a.sScrollFootInner}).append(i.removeAttr("id").css("margin-left",0).append("bottom"===o?r:null).append(h.children("tfoot"))))),u=s.children(),c=u[0],f=u[1],d=l?u[2]:null,e&&j(f).on("scroll.DT",function(t){var e=this.scrollLeft;c.scrollLeft=e,l&&(d.scrollLeft=e)}),j(f).css(n&&p.bCollapse?"max-height":"height",n),t.nScrollHead=c,t.nScrollBody=f,t.nScrollFoot=d,t.aoDrawCallback.push({fn:Yt,sName:"scrolling"}),s[0])}function Yt(n){function t(t){(t=t.style).paddingTop="0",t.paddingBottom="0",t.borderTopWidth="0",t.borderBottomWidth="0",t.height=0}var e,a,r,o,i,l=n.oScroll,s=l.sX,u=l.sXInner,c=l.sY,l=l.iBarWidth,f=j(n.nScrollHead),d=f[0].style,h=f.children("div"),p=h[0].style,h=h.children("table"),g=n.nScrollBody,b=j(g),S=g.style,m=j(n.nScrollFoot).children("div"),D=m.children("table"),v=j(n.nTHead),y=j(n.nTable),_=y[0],C=_.style,T=n.nTFoot?j(n.nTFoot):null,w=n.oBrowser,x=w.bScrollOversize,I=H(n.aoColumns,"nTh"),A=[],F=[],L=[],P=[],R=g.scrollHeight>g.clientHeight;n.scrollBarVis!==R&&n.scrollBarVis!==N?(n.scrollBarVis=R,O(n)):(n.scrollBarVis=R,y.children("thead, tfoot").remove(),T&&(R=T.clone().prependTo(y),i=T.find("tr"),a=R.find("tr")),R=v.clone().prependTo(y),v=v.find("tr"),e=R.find("tr"),R.find("th, td").removeAttr("tabindex"),s||(S.width="100%",f[0].style.width="100%"),j.each(yt(n,R),function(t,e){r=k(n,t),e.style.width=n.aoColumns[r].sWidth}),T&&M(function(t){t.style.width=""},a),f=y.outerWidth(),""===s?(C.width="100%",x&&(y.find("tbody").height()>g.offsetHeight||"scroll"==b.css("overflow-y"))&&(C.width=W(y.outerWidth()-l)),f=y.outerWidth()):""!==u&&(C.width=W(u),f=y.outerWidth()),M(t,e),M(function(t){L.push(t.innerHTML),A.push(W(j(t).css("width")))},e),M(function(t,e){-1!==j.inArray(t,I)&&(t.style.width=A[e])},v),j(e).height(0),T&&(M(t,a),M(function(t){P.push(t.innerHTML),F.push(W(j(t).css("width")))},a),M(function(t,e){t.style.width=F[e]},i),j(a).height(0)),M(function(t,e){t.innerHTML='<div class="dataTables_sizing">'+L[e]+"</div>",t.childNodes[0].style.height="0",t.childNodes[0].style.overflow="hidden",t.style.width=A[e]},e),T&&M(function(t,e){t.innerHTML='<div class="dataTables_sizing">'+P[e]+"</div>",t.childNodes[0].style.height="0",t.childNodes[0].style.overflow="hidden",t.style.width=F[e]},a),y.outerWidth()<f?(o=g.scrollHeight>g.offsetHeight||"scroll"==b.css("overflow-y")?f+l:f,x&&(g.scrollHeight>g.offsetHeight||"scroll"==b.css("overflow-y"))&&(C.width=W(o-l)),""!==s&&""===u||E(n,1,"Possible column misalignment",6)):o="100%",S.width=W(o),d.width=W(o),T&&(n.nScrollFoot.style.width=W(o)),c||x&&(S.height=W(_.offsetHeight+l)),R=y.outerWidth(),h[0].style.width=W(R),p.width=W(R),v=y.height()>g.clientHeight||"scroll"==b.css("overflow-y"),p[i="padding"+(w.bScrollbarLeft?"Left":"Right")]=v?l+"px":"0px",T&&(D[0].style.width=W(R),m[0].style.width=W(R),m[0].style[i]=v?l+"px":"0px"),y.children("colgroup").insertBefore(y.children("thead")),b.scroll(),!n.bSorted&&!n.bFiltered||n._drawHold||(g.scrollTop=0))}function M(t,e,n){for(var a,r,o=0,i=0,l=e.length;i<l;){for(a=e[i].firstChild,r=n?n[i].firstChild:null;a;)1===a.nodeType&&(n?t(a,r,o):t(a,o),o++),a=a.nextSibling,r=n?r.nextSibling:null;i++}}var Zt=/<.*?>/g;function Kt(t){var e,n,a=t.nTable,r=t.aoColumns,o=t.oScroll,i=o.sY,l=o.sX,o=o.sXInner,s=r.length,u=at(t,"bVisible"),c=j("th",t.nTHead),f=a.getAttribute("width"),d=a.parentNode,h=!1,p=t.oBrowser,g=p.bScrollOversize,b=a.style.width;for(b&&-1!==b.indexOf("%")&&(f=b),y=0;y<u.length;y++)null!==(e=r[u[y]]).sWidth&&(e.sWidth=te(e.sWidthOrig,d),h=!0);if(g||!h&&!l&&!i&&s==w(t)&&s==c.length)for(y=0;y<s;y++){var S=k(t,y);null!==S&&(r[S].sWidth=W(c.eq(y).width()))}else{var b=j(a).clone().css("visibility","hidden").removeAttr("id"),m=(b.find("tbody tr").remove(),j("<tr/>").appendTo(b.find("tbody")));for(b.find("thead, tfoot").remove(),b.append(j(t.nTHead).clone()).append(j(t.nTFoot).clone()),b.find("tfoot th, tfoot td").css("width",""),c=yt(t,b.find("thead")[0]),y=0;y<u.length;y++)e=r[u[y]],c[y].style.width=null!==e.sWidthOrig&&""!==e.sWidthOrig?W(e.sWidthOrig):"",e.sWidthOrig&&l&&j(c[y]).append(j("<div/>").css({width:e.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(t.aoData.length)for(y=0;y<u.length;y++)e=r[n=u[y]],j(ee(t,n)).clone(!1).append(e.sContentPadding).appendTo(m);j("[name]",b).removeAttr("name");for(var D=j("<div/>").css(l||i?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(b).appendTo(d),v=(l&&o?b.width(o):l?(b.css("width","auto"),b.removeAttr("width"),b.width()<d.clientWidth&&f&&b.width(d.clientWidth)):i?b.width(d.clientWidth):f&&b.width(f),0),y=0;y<u.length;y++){var _=j(c[y]),C=_.outerWidth()-_.width(),_=p.bBounding?Math.ceil(c[y].getBoundingClientRect().width):_.outerWidth();v+=_,r[u[y]].sWidth=W(_-C)}a.style.width=W(v),D.remove()}f&&(a.style.width=W(f)),!f&&!l||t._reszEvt||(o=function(){j(U).on("resize.DT-"+t.sInstance,Qt(function(){O(t)}))},g?setTimeout(o,1e3):o(),t._reszEvt=!0)}var Qt=C.util.throttle;function te(t,e){return t?(e=(t=j("<div/>").css("width",W(t)).appendTo(e||m.body))[0].offsetWidth,t.remove(),e):0}function ee(t,e){var n,a=ne(t,e);return a<0?null:(n=t.aoData[a]).nTr?n.anCells[e]:j("<td/>").html(D(t,a,e,"display"))[0]}function ne(t,e){for(var n,a=-1,r=-1,o=0,i=t.aoData.length;o<i;o++)(n=(n=(n=D(t,o,e,"display")+"").replace(Zt,"")).replace(/&nbsp;/g," ")).length>a&&(a=n.length,r=o);return r}function W(t){return null===t?"0px":"number"==typeof t?t<0?"0px":t+"px":t.match(/\d$/)?t+"px":t}function A(t){function e(t){t.length&&!j.isArray(t[0])?h.push(t):j.merge(h,t)}var n,a,r,o,i,l,s,u=[],c=t.aoColumns,f=t.aaSortingFixed,d=j.isPlainObject(f),h=[];for(j.isArray(f)&&e(f),d&&f.pre&&e(f.pre),e(t.aaSorting),d&&f.post&&e(f.post),n=0;n<h.length;n++)for(r=(o=c[s=h[n][a=0]].aDataSort).length;a<r;a++)l=c[i=o[a]].sType||"string",h[n]._idx===N&&(h[n]._idx=j.inArray(h[n][1],c[i].asSorting)),u.push({src:s,col:i,dir:h[n][1],index:h[n]._idx,type:l,formatter:C.ext.type.order[l+"-pre"]});return u}function ae(t){var e,n,a,r,c,f=[],u=C.ext.type.order,d=t.aoData,o=(t.aoColumns,0),i=t.aiDisplayMaster;for(rt(t),e=0,n=(c=A(t)).length;e<n;e++)(r=c[e]).formatter&&o++,se(t,r.col);if("ssp"!=R(t)&&0!==c.length){for(e=0,a=i.length;e<a;e++)f[i[e]]=e;o===c.length?i.sort(function(t,e){for(var n,a,r,o,i=c.length,l=d[t]._aSortData,s=d[e]._aSortData,u=0;u<i;u++)if(0!=(r=(n=l[(o=c[u]).col])<(a=s[o.col])?-1:a<n?1:0))return"asc"===o.dir?r:-r;return(n=f[t])<(a=f[e])?-1:a<n?1:0}):i.sort(function(t,e){for(var n,a,r,o=c.length,i=d[t]._aSortData,l=d[e]._aSortData,s=0;s<o;s++)if(n=i[(r=c[s]).col],a=l[r.col],0!==(r=(u[r.type+"-"+r.dir]||u["string-"+r.dir])(n,a)))return r;return(n=f[t])<(a=f[e])?-1:a<n?1:0})}t.bSorted=!0}function re(t){for(var e=t.aoColumns,n=A(t),a=t.oLanguage.oAria,r=0,o=e.length;r<o;r++){var i=e[r],l=i.asSorting,s=i.sTitle.replace(/<.*?>/g,""),u=i.nTh;u.removeAttribute("aria-sort"),i=i.bSortable?s+("asc"===(0<n.length&&n[0].col==r&&(u.setAttribute("aria-sort","asc"==n[0].dir?"ascending":"descending"),l[n[0].index+1])||l[0])?a.sSortAscending:a.sSortDescending):s,u.setAttribute("aria-label",i)}}function oe(t,e,n,a){function r(t,e){var n=t._idx;return(n=n===N?j.inArray(t[1],s):n)+1<s.length?n+1:e?null:0}var o,i=t.aoColumns[e],l=t.aaSorting,s=i.asSorting;"number"==typeof l[0]&&(l=t.aaSorting=[l]),n&&t.oFeatures.bSortMulti?-1!==(i=j.inArray(e,H(l,"0")))?null===(o=null===(o=r(l[i],!0))&&1===l.length?0:o)?l.splice(i,1):(l[i][1]=s[o],l[i]._idx=o):(l.push([e,s[0],0]),l[l.length-1]._idx=0):l.length&&l[0][0]==e?(o=r(l[0]),l.length=1,l[0][1]=s[o],l[0]._idx=o):(l.length=0,l.push([e,s[0]]),l[0]._idx=0),u(t),"function"==typeof a&&a(t)}function ie(e,t,n,a){var r=e.aoColumns[n];he(t,{},function(t){!1!==r.bSortable&&(e.oFeatures.bProcessing?(v(e,!0),setTimeout(function(){oe(e,n,t.shiftKey,a),"ssp"!==R(e)&&v(e,!1)},0)):oe(e,n,t.shiftKey,a))})}function le(t){var e,n,a,r=t.aLastSort,o=t.oClasses.sSortColumn,i=A(t),l=t.oFeatures;if(l.bSort&&l.bSortClasses){for(e=0,n=r.length;e<n;e++)a=r[e].src,j(H(t.aoData,"anCells",a)).removeClass(o+(e<2?e+1:3));for(e=0,n=i.length;e<n;e++)a=i[e].src,j(H(t.aoData,"anCells",a)).addClass(o+(e<2?e+1:3))}t.aLastSort=i}function se(t,e){for(var n,a,r,o=t.aoColumns[e],i=C.ext.order[o.sSortDataType],l=(i&&(n=i.call(t.oInstance,t,e,c(t,e))),C.ext.type.order[o.sType+"-pre"]),s=0,u=t.aoData.length;s<u;s++)(a=t.aoData[s])._aSortData||(a._aSortData=[]),a._aSortData[e]&&!i||(r=i?n[s]:D(t,s,e,"sort"),a._aSortData[e]=l?l(r):r)}function ue(n){var t;n.oFeatures.bStateSave&&!n.bDestroying&&(t={time:+new Date,start:n._iDisplayStart,length:n._iDisplayLength,order:j.extend(!0,[],n.aaSorting),search:kt(n.oPreviousSearch),columns:j.map(n.aoColumns,function(t,e){return{visible:t.bVisible,search:kt(n.aoPreSearchCols[e])}})},P(n,"aoStateSaveParams","stateSaveParams",[n,t]),n.oSavedState=t,n.fnStateSaveCallback.call(n.oInstance,n,t))}function ce(a,t,r){function e(t){if(t&&t.time){var e=P(a,"aoStateLoadParams","stateLoadParams",[a,t]);if(-1===j.inArray(!1,e)){e=a.iStateDuration;if(!(0<e&&t.time<+new Date-1e3*e||t.columns&&l.length!==t.columns.length)){if(a.oLoadedState=j.extend(!0,{},t),t.start!==N&&(a._iDisplayStart=t.start,a.iInitDisplayStart=t.start),t.length!==N&&(a._iDisplayLength=t.length),t.order!==N&&(a.aaSorting=[],j.each(t.order,function(t,e){a.aaSorting.push(e[0]>=l.length?[0,e[1]]:e)})),t.search!==N&&j.extend(a.oPreviousSearch,Mt(t.search)),t.columns)for(o=0,i=t.columns.length;o<i;o++){var n=t.columns[o];n.visible!==N&&(l[o].bVisible=n.visible),n.search!==N&&j.extend(a.aoPreSearchCols[o],Mt(n.search))}P(a,"aoStateLoaded","stateLoaded",[a,t])}}}r()}var o,i,n,l=a.aoColumns;a.oFeatures.bStateSave?(n=a.fnStateLoadCallback.call(a.oInstance,a,e))!==N&&e(n):r()}function fe(t){var e=C.settings,t=j.inArray(t,H(e,"nTable"));return-1!==t?e[t]:null}function E(t,e,n,a){if(n="DataTables warning: "+(t?"table id="+t.sTableId+" - ":"")+n,a&&(n+=". For more information about this error, please see http://datatables.net/tn/"+a),e)U.console&&console.log&&console.log(n);else{e=C.ext,e=e.sErrMode||e.errMode;if(t&&P(t,null,"error",[t,a,n]),"alert"==e)alert(n);else{if("throw"==e)throw new Error(n);"function"==typeof e&&e(t,a,n)}}}function F(n,a,t,e){j.isArray(t)?j.each(t,function(t,e){j.isArray(e)?F(n,a,e[0],e[1]):F(n,a,e)}):(e===N&&(e=t),a[t]!==N&&(n[e]=a[t]))}function de(t,e,n){var a,r;for(r in e)e.hasOwnProperty(r)&&(a=e[r],j.isPlainObject(a)?(j.isPlainObject(t[r])||(t[r]={}),j.extend(!0,t[r],a)):n&&"data"!==r&&"aaData"!==r&&j.isArray(a)?t[r]=a.slice():t[r]=a);return t}function he(e,t,n){j(e).on("click.DT",t,function(t){j(e).blur(),n(t)}).on("keypress.DT",t,function(t){13===t.which&&(t.preventDefault(),n(t))}).on("selectstart.DT",function(){return!1})}function L(t,e,n,a){n&&t[e].push({fn:n,sName:a})}function P(n,t,e,a){var r=[];return t&&(r=j.map(n[t].slice().reverse(),function(t,e){return t.fn.apply(n.oInstance,a)})),null!==e&&(t=j.Event(e+".dt"),j(n.nTable).trigger(t,a),r.push(t.result)),r}function pe(t){var e=t._iDisplayStart,n=t.fnDisplayEnd(),a=t._iDisplayLength;n<=e&&(e=n-a),e-=e%a,t._iDisplayStart=e=-1===a||e<0?0:e}function ge(t,e){var t=t.renderer,n=C.ext.renderer[e];return j.isPlainObject(t)&&t[e]?n[t[e]]||n._:"string"==typeof t&&n[t]||n._}function R(t){return t.oFeatures.bServerSide?"ssp":t.ajax||t.sAjaxSource?"ajax":"dom"}function be(r,o,t){var e,n;t&&(e=new B(r)).one("draw",function(){t(e.ajax.json())}),"ssp"==R(r)?u(r,o):(v(r,!0),(n=r.jqXHR)&&4!==n.readyState&&n.abort(),_t(r,[],function(t){ft(r);for(var e=xt(r,t),n=0,a=e.length;n<a;n++)x(r,e[n]);u(r,o),v(r,!1)}))}function Se(t,e,n,a,r){for(var o,i,l,s,u=[],c=typeof e,f=0,d=(e=e&&"string"!=c&&"function"!=c&&e.length!==N?e:[e]).length;f<d;f++)for(l=0,s=(i=e[f]&&e[f].split&&!e[f].match(/[\[\(:]/)?e[f].split(","):[e[f]]).length;l<s;l++)(o=n("string"==typeof i[l]?j.trim(i[l]):i[l]))&&o.length&&(u=u.concat(o));var h=p.selector[t];if(h.length)for(f=0,d=h.length;f<d;f++)u=h[f](a,r,u);return z(u)}function me(t){return(t=t||{}).filter&&t.search===N&&(t.search=t.filter),j.extend({search:"none",order:"current",page:"all"},t)}function De(t){for(var e=0,n=t.length;e<n;e++)if(0<t[e].length)return t[0]=t[e],t[0].length=1,t.length=1,t.context=[t.context[e]],t;return t.length=0,t}function ve(o,t,e,n){function i(t,e){var n;if(j.isArray(t)||t instanceof j)for(var a=0,r=t.length;a<r;a++)i(t[a],e);else t.nodeName&&"tr"===t.nodeName.toLowerCase()?l.push(t):(n=j("<tr><td/></tr>").addClass(e),j("td",n).addClass(e).html(t)[0].colSpan=w(o),l.push(n[0]))}var l=[];i(e,n),t._details&&t._details.detach(),t._details=j(l),t._detailsShow&&t._details.insertAfter(t.nTr)}function ye(t,e){if((n=t.context).length&&t.length){t=n[0].aoData[t[0]];if(t._details){(t._detailsShow=e)?t._details.insertAfter(t.nTr):t._details.detach();var s=n[0],r=new B(s),e=".dt.DT_details",t="draw"+e,n="column-visibility"+e,e="destroy"+e,u=s.aoData;if(r.off(t+" "+n+" "+e),H(u,"_details").length>0){r.on(t,function(t,e){if(s!==e)return;r.rows({page:"current"}).eq(0).each(function(t){var e=u[t];if(e._detailsShow)e._details.insertAfter(e.nTr)})});r.on(n,function(t,e,n,a){if(s!==e)return;var r,o=w(e);for(var i=0,l=u.length;i<l;i++){r=u[i];if(r._details)r._details.children("td[colspan]").attr("colspan",o)}});r.on(e,function(t,e){if(s!==e)return;for(var n=0,a=u.length;n<a;n++)if(u[n]._details)we(r,n)})}}}}function _e(t,e,n,a,r){for(var o=[],i=0,l=r.length;i<l;i++)o.push(D(t,r[i],e));return o}var Ce=[],l=Array.prototype,B=function(t,e){if(!(this instanceof B))return new B(t,e);function n(t){var e,n,a,r;t=t,a=C.settings,r=j.map(a,function(t,e){return t.nTable}),(t=t?t.nTable&&t.oApi?[t]:t.nodeName&&"table"===t.nodeName.toLowerCase()?-1!==(e=j.inArray(t,r))?[a[e]]:null:t&&"function"==typeof t.settings?t.settings().toArray():("string"==typeof t?n=j(t):t instanceof j&&(n=t),n?n.map(function(t){return-1!==(e=j.inArray(this,r))?a[e]:null}).toArray():void 0):[])&&(o=o.concat(t))}var o=[];if(j.isArray(t))for(var a=0,r=t.length;a<r;a++)n(t[a]);else n(t);this.context=z(o),e&&j.merge(this,e),this.selector={rows:null,cols:null,opts:null},B.extend(this,this,Ce)},Te=(C.Api=B,j.extend(B.prototype,{any:function(){return 0!==this.count()},concat:l.concat,context:[],count:function(){return this.flatten().length},each:function(t){for(var e=0,n=this.length;e<n;e++)t.call(this,this[e],e,this);return this},eq:function(t){var e=this.context;return e.length>t?new B(e[t],this[t]):null},filter:function(t){var e=[];if(l.filter)e=l.filter.call(this,t,this);else for(var n=0,a=this.length;n<a;n++)t.call(this,this[n],n,this)&&e.push(this[n]);return new B(this.context,e)},flatten:function(){var t=[];return new B(this.context,t.concat.apply(t,this.toArray()))},join:l.join,indexOf:l.indexOf||function(t,e){for(var n=e||0,a=this.length;n<a;n++)if(this[n]===t)return n;return-1},iterator:function(t,e,n,a){var r,o,i,l,s,u,c,f,d=[],h=this.context,p=this.selector;for("string"==typeof t&&(a=n,n=e,e=t,t=!1),o=0,i=h.length;o<i;o++){var g=new B(h[o]);if("table"===e)(r=n.call(g,h[o],o))!==N&&d.push(r);else if("columns"===e||"rows"===e)(r=n.call(g,h[o],this[o],o))!==N&&d.push(r);else if("column"===e||"column-rows"===e||"row"===e||"cell"===e)for(c=this[o],"column-rows"===e&&(u=Te(h[o],p.opts)),l=0,s=c.length;l<s;l++)f=c[l],(r="cell"===e?n.call(g,h[o],f.row,f.column,o,l):n.call(g,h[o],f,o,l,u))!==N&&d.push(r)}return d.length||a?((t=(a=new B(h,t?d.concat.apply([],d):d)).selector).rows=p.rows,t.cols=p.cols,t.opts=p.opts,a):this},lastIndexOf:l.lastIndexOf||function(t,e){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(t){var e=[];if(l.map)e=l.map.call(this,t,this);else for(var n=0,a=this.length;n<a;n++)e.push(t.call(this,this[n],n));return new B(this.context,e)},pluck:function(e){return this.map(function(t){return t[e]})},pop:l.pop,push:l.push,reduce:l.reduce||function(t,e){return tt(this,t,e,0,this.length,1)},reduceRight:l.reduceRight||function(t,e){return tt(this,t,e,this.length-1,-1,-1)},reverse:l.reverse,selector:null,shift:l.shift,slice:function(){return new B(this.context,this)},sort:l.sort,splice:l.splice,toArray:function(){return l.slice.call(this)},to$:function(){return j(this)},toJQuery:function(){return j(this)},unique:function(){return new B(this.context,z(this))},unshift:l.unshift}),B.extend=function(t,e,n){if(n.length&&e&&(e instanceof B||e.__dt_wrapper))for(var a,r=0,o=n.length;r<o;r++)e[(a=n[r]).name]="function"==typeof a.val?function(e,n,a){return function(){var t=n.apply(e,arguments);return B.extend(t,t,a.methodExt),t}}(t,a.val,a):j.isPlainObject(a.val)?{}:a.val,e[a.name].__dt_wrapper=!0,B.extend(t,e[a.name],a.propExt)},B.register=e=function(t,e){if(j.isArray(t))for(var n=0,a=t.length;n<a;n++)B.register(t[n],e);else for(var r=t.split("."),o=Ce,i=0,l=r.length;i<l;i++){var s,u,c=function(t,e){for(var n=0,a=t.length;n<a;n++)if(t[n].name===e)return t[n];return null}(o,u=(s=-1!==r[i].indexOf("()"))?r[i].replace("()",""):r[i]);c||o.push(c={name:u,val:{},methodExt:[],propExt:[]}),i===l-1?c.val=e:o=s?c.methodExt:c.propExt}},B.registerPlural=t=function(t,e,n){B.register(t,n),B.register(e,function(){var t=n.apply(this,arguments);return t===this?this:t instanceof B?t.length?j.isArray(t[0])?new B(t.context,t[0]):t[0]:N:t})},e("tables()",function(t){return t?new B((t=t,n=this.context,"number"==typeof t?[n[t]]:(a=j.map(n,function(t,e){return t.nTable}),j(a).filter(t).map(function(t){var e=j.inArray(this,a);return n[e]}).toArray()))):this;var n,a}),e("table()",function(t){var t=this.tables(t),e=t.context;return e.length?new B(e[0]):t}),t("tables().nodes()","table().node()",function(){return this.iterator("table",function(t){return t.nTable},1)}),t("tables().body()","table().body()",function(){return this.iterator("table",function(t){return t.nTBody},1)}),t("tables().header()","table().header()",function(){return this.iterator("table",function(t){return t.nTHead},1)}),t("tables().footer()","table().footer()",function(){return this.iterator("table",function(t){return t.nTFoot},1)}),t("tables().containers()","table().container()",function(){return this.iterator("table",function(t){return t.nTableWrapper},1)}),e("draw()",function(e){return this.iterator("table",function(t){"page"===e?g(t):u(t,!1===(e="string"==typeof e?"full-hold"!==e:e))})}),e("page()",function(e){return e===N?this.page.info().page:this.iterator("table",function(t){Gt(t,e)})}),e("page.info()",function(t){var e,n,a,r,o;return 0===this.context.length?N:(n=(e=this.context[0])._iDisplayStart,a=e.oFeatures.bPaginate?e._iDisplayLength:-1,r=e.fnRecordsDisplay(),{page:(o=-1===a)?0:Math.floor(n/a),pages:o?1:Math.ceil(r/a),start:n,end:e.fnDisplayEnd(),length:a,recordsTotal:e.fnRecordsTotal(),recordsDisplay:r,serverSide:"ssp"===R(e)})}),e("page.len()",function(e){return e===N?0!==this.context.length?this.context[0]._iDisplayLength:N:this.iterator("table",function(t){Xt(t,e)})}),e("ajax.json()",function(){var t=this.context;if(0<t.length)return t[0].json}),e("ajax.params()",function(){var t=this.context;if(0<t.length)return t[0].oAjaxData}),e("ajax.reload()",function(e,n){return this.iterator("table",function(t){be(t,!1===n,e)})}),e("ajax.url()",function(e){var t=this.context;return e===N?0===t.length?N:(t=t[0]).ajax?j.isPlainObject(t.ajax)?t.ajax.url:t.ajax:t.sAjaxSource:this.iterator("table",function(t){j.isPlainObject(t.ajax)?t.ajax.url=e:t.ajax=e})}),e("ajax.url().load()",function(e,n){return this.iterator("table",function(t){be(t,!1===n,e)})}),function(t,e){var n,a=[],r=t.aiDisplay,o=t.aiDisplayMaster,i=e.search,l=e.order,e=e.page;if("ssp"==R(t))return"removed"===i?[]:f(0,o.length);if("current"==e)for(u=t._iDisplayStart,c=t.fnDisplayEnd();u<c;u++)a.push(r[u]);else if("current"==l||"applied"==l){if("none"==i)a=o.slice();else if("applied"==i)a=r.slice();else if("removed"==i){for(var s={},u=0,c=r.length;u<c;u++)s[r[u]]=null;a=j.map(o,function(t){return s.hasOwnProperty(t)?null:t})}}else if("index"==l||"original"==l)for(u=0,c=t.aoData.length;u<c;u++)("none"==i||-1===(n=j.inArray(u,r))&&"removed"==i||0<=n&&"applied"==i)&&a.push(u);return a}),we=(e("rows()",function(e,n){e===N?e="":j.isPlainObject(e)&&(n=e,e=""),n=me(n);var t=this.iterator("table",function(t){return Se("row",e,function(n){var t=d(n),a=r.aoData;if(null!==t&&!o)return[t];if(i=i||Te(r,o),null!==t&&-1!==j.inArray(t,i))return[t];if(null===n||n===N||""===n)return i;if("function"==typeof n)return j.map(i,function(t){var e=a[t];return n(t,e._aData,e.nTr)?t:null});if(n.nodeName)return t=n._DT_RowIndex,e=n._DT_CellIndex,t!==N?a[t]&&a[t].nTr===n?[t]:[]:e?a[e.row]&&a[e.row].nTr===n?[e.row]:[]:(t=j(n).closest("*[data-dt-row]")).length?[t.data("dt-row")]:[];if("string"==typeof n&&"#"===n.charAt(0)){var e=r.aIds[n.replace(/^#/,"")];if(e!==N)return[e.idx]}t=y(S(r.aoData,i,"nTr"));return j(t).filter(n).map(function(){return this._DT_RowIndex}).toArray()},r=t,o=n);var r,o,i},1);return t.selector.rows=e,t.selector.opts=n,t}),e("rows().nodes()",function(){return this.iterator("row",function(t,e){return t.aoData[e].nTr||N},1)}),e("rows().data()",function(){return this.iterator(!0,"rows",function(t,e){return S(t.aoData,e,"_aData")},1)}),t("rows().cache()","row().cache()",function(n){return this.iterator("row",function(t,e){t=t.aoData[e];return"search"===n?t._aFilterData:t._aSortData},1)}),t("rows().invalidate()","row().invalidate()",function(n){return this.iterator("row",function(t,e){ht(t,e,n)})}),t("rows().indexes()","row().index()",function(){return this.iterator("row",function(t,e){return e},1)}),t("rows().ids()","row().id()",function(t){for(var e=[],n=this.context,a=0,r=n.length;a<r;a++)for(var o=0,i=this[a].length;o<i;o++){var l=n[a].rowIdFn(n[a].aoData[this[a][o]]._aData);e.push((!0===t?"#":"")+l)}return new B(n,e)}),t("rows().remove()","row().remove()",function(){var f=this;return this.iterator("row",function(t,e,n){var a,r,o,i,l,s,u=t.aoData,c=u[e];for(u.splice(e,1),a=0,r=u.length;a<r;a++)if(s=(l=u[a]).anCells,null!==l.nTr&&(l.nTr._DT_RowIndex=a),null!==s)for(o=0,i=s.length;o<i;o++)s[o]._DT_CellIndex.row=a;dt(t.aiDisplayMaster,e),dt(t.aiDisplay,e),dt(f[n],e,!1),0<t._iRecordsDisplay&&t._iRecordsDisplay--,pe(t);n=t.rowIdFn(c._aData);n!==N&&delete t.aIds[n]}),this.iterator("table",function(t){for(var e=0,n=t.aoData.length;e<n;e++)t.aoData[e].idx=e}),this}),e("rows.add()",function(o){var t=this.iterator("table",function(t){for(var e,n=[],a=0,r=o.length;a<r;a++)(e=o[a]).nodeName&&"TR"===e.nodeName.toUpperCase()?n.push(it(t,e)[0]):n.push(x(t,e));return n},1),e=this.rows(-1);return e.pop(),j.merge(e,t),e}),e("row()",function(t,e){return De(this.rows(t,e))}),e("row().data()",function(t){var e,n=this.context;return t===N?n.length&&this.length?n[0].aoData[this[0]]._aData:N:((e=n[0].aoData[this[0]])._aData=t,j.isArray(t)&&e.nTr.id&&b(n[0].rowId)(t,e.nTr.id),ht(n[0],this[0],"data"),this)}),e("row().node()",function(){var t=this.context;return t.length&&this.length&&t[0].aoData[this[0]].nTr||null}),e("row.add()",function(e){e instanceof j&&e.length&&(e=e[0]);var t=this.iterator("table",function(t){return e.nodeName&&"TR"===e.nodeName.toUpperCase()?it(t,e)[0]:x(t,e)});return this.row(t[0])}),function(t,e){var n=t.context;n.length&&(n=n[0].aoData[e!==N?e:t[0]])&&n._details&&(n._details.remove(),n._detailsShow=N,n._details=N)}),xe="row().child",Ie=xe+"()",Ae=(e(Ie,function(t,e){var n=this.context;return t===N?n.length&&this.length?n[0].aoData[this[0]]._details:N:(!0===t?this.child.show():!1===t?we(this):n.length&&this.length&&ve(n[0],n[0].aoData[this[0]],t,e),this)}),e([xe+".show()",Ie+".show()"],function(t){return ye(this,!0),this}),e([xe+".hide()",Ie+".hide()"],function(){return ye(this,!1),this}),e([xe+".remove()",Ie+".remove()"],function(){return we(this),this}),e(xe+".isShown()",function(){var t=this.context;return t.length&&this.length&&t[0].aoData[this[0]]._detailsShow||!1}),/^([^:]+):(name|visIdx|visible)$/),Fe=(e("columns()",function(n,a){n===N?n="":j.isPlainObject(n)&&(a=n,n=""),a=me(a);var t=this.iterator("table",function(t){return e=n,l=a,s=(i=t).aoColumns,u=H(s,"sName"),c=H(s,"nTh"),Se("column",e,function(n){var a,t=d(n);if(""===n)return f(s.length);if(null!==t)return[0<=t?t:s.length+t];if("function"==typeof n)return a=Te(i,l),j.map(s,function(t,e){return n(e,_e(i,e,0,0,a),c[e])?e:null});var r="string"==typeof n?n.match(Ae):"";if(r)switch(r[2]){case"visIdx":case"visible":var e,o=parseInt(r[1],10);return o<0?[(e=j.map(s,function(t,e){return t.bVisible?e:null}))[e.length+o]]:[k(i,o)];case"name":return j.map(u,function(t,e){return t===r[1]?e:null});default:return[]}return n.nodeName&&n._DT_CellIndex?[n._DT_CellIndex.column]:(t=j(c).filter(n).map(function(){return j.inArray(this,c)}).toArray()).length||!n.nodeName?t:(t=j(n).closest("*[data-dt-column]")).length?[t.data("dt-column")]:[]},i,l);var i,e,l,s,u,c},1);return t.selector.cols=n,t.selector.opts=a,t}),t("columns().header()","column().header()",function(t,e){return this.iterator("column",function(t,e){return t.aoColumns[e].nTh},1)}),t("columns().footer()","column().footer()",function(t,e){return this.iterator("column",function(t,e){return t.aoColumns[e].nTf},1)}),t("columns().data()","column().data()",function(){return this.iterator("column-rows",_e,1)}),t("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].mData},1)}),t("columns().cache()","column().cache()",function(o){return this.iterator("column-rows",function(t,e,n,a,r){return S(t.aoData,r,"search"===o?"_aFilterData":"_aSortData",e)},1)}),t("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(t,e,n,a,r){return S(t.aoData,r,"anCells",e)},1)}),t("columns().visible()","column().visible()",function(f,n){var t=this.iterator("column",function(t,e){if(f===N)return t.aoColumns[e].bVisible;var n,a,r=e,e=f,o=t.aoColumns,i=o[r],l=t.aoData;if(e===N)i.bVisible;else if(i.bVisible!==e){if(e)for(var s=j.inArray(!0,H(o,"bVisible"),r+1),u=0,c=l.length;u<c;u++)a=l[u].nTr,n=l[u].anCells,a&&a.insertBefore(n[r],n[s]||null);else j(H(t.aoData,"anCells",r)).detach();i.bVisible=e,mt(t,t.aoHeader),mt(t,t.aoFooter),t.aiDisplay.length||j(t.nTBody).find("td[colspan]").attr("colspan",w(t)),ue(t)}});return f!==N&&(this.iterator("column",function(t,e){P(t,null,"column-visibility",[t,e,f,n])}),n!==N&&!n||this.columns.adjust()),t}),t("columns().indexes()","column().index()",function(n){return this.iterator("column",function(t,e){return"visible"===n?c(t,e):e},1)}),e("columns.adjust()",function(){return this.iterator("table",function(t){O(t)},1)}),e("column.index()",function(t,e){var n;if(0!==this.context.length)return n=this.context[0],"fromVisible"===t||"toData"===t?k(n,e):"fromData"===t||"toVisible"===t?c(n,e):void 0}),e("column()",function(t,e){return De(this.columns(t,e))}),e("cells()",function(g,t,b){var n,a,r,o,i,l,s,e;return j.isPlainObject(g)&&(g.row===N?(b=g,g=null):(b=t,t=null)),j.isPlainObject(t)&&(b=t,t=null),null===t||t===N?this.iterator("table",function(t){return a=t,t=g,e=me(b),f=a.aoData,d=Te(a,e),n=y(S(f,d,"anCells")),h=j([].concat.apply([],n)),p=a.aoColumns.length,Se("cell",t,function(t){var e,n="function"==typeof t;if(null===t||t===N||n){for(o=[],i=0,l=d.length;i<l;i++)for(r=d[i],s=0;s<p;s++)u={row:r,column:s},(!n||(c=f[r],t(u,D(a,r,s),c.anCells?c.anCells[s]:null)))&&o.push(u);return o}return j.isPlainObject(t)?t.column!==N&&t.row!==N&&-1!==j.inArray(t.row,d)?[t]:[]:(e=h.filter(t).map(function(t,e){return{row:e._DT_CellIndex.row,column:e._DT_CellIndex.column}}).toArray()).length||!t.nodeName?e:(c=j(t).closest("*[data-dt-row]")).length?[{row:c.data("dt-row"),column:c.data("dt-column")}]:[]},a,e);var a,e,r,o,i,l,s,u,c,f,d,n,h,p}):(n=this.columns(t),a=this.rows(g),this.iterator("table",function(t,e){for(r=[],o=0,i=a[e].length;o<i;o++)for(l=0,s=n[e].length;l<s;l++)r.push({row:a[e][o],column:n[e][l]})},1),e=this.cells(r,b),j.extend(e.selector,{cols:t,rows:g,opts:b}),e)}),t("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(t,e,n){t=t.aoData[e];return t&&t.anCells?t.anCells[n]:N},1)}),e("cells().data()",function(){return this.iterator("cell",function(t,e,n){return D(t,e,n)},1)}),t("cells().cache()","cell().cache()",function(a){return a="search"===a?"_aFilterData":"_aSortData",this.iterator("cell",function(t,e,n){return t.aoData[e][a][n]},1)}),t("cells().render()","cell().render()",function(a){return this.iterator("cell",function(t,e,n){return D(t,e,n,a)},1)}),t("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(t,e,n){return{row:e,column:n,columnVisible:c(t,n)}},1)}),t("cells().invalidate()","cell().invalidate()",function(a){return this.iterator("cell",function(t,e,n){ht(t,e,a,n)})}),e("cell()",function(t,e,n){return De(this.cells(t,e,n))}),e("cell().data()",function(t){var e=this.context,n=this[0];return t===N?e.length&&n.length?D(e[0],n[0].row,n[0].column):N:(lt(e[0],n[0].row,n[0].column,t),ht(e[0],n[0].row,"data",n[0].column),this)}),e("order()",function(e,t){var n=this.context;return e===N?0!==n.length?n[0].aaSorting:N:("number"==typeof e?e=[[e,t]]:e.length&&!j.isArray(e[0])&&(e=Array.prototype.slice.call(arguments)),this.iterator("table",function(t){t.aaSorting=e.slice()}))}),e("order.listener()",function(e,n,a){return this.iterator("table",function(t){ie(t,e,n,a)})}),e("order.fixed()",function(e){var t;return e?this.iterator("table",function(t){t.aaSortingFixed=j.extend(!0,{},e)}):(t=(t=this.context).length?t[0].aaSortingFixed:N,j.isArray(t)?{pre:t}:t)}),e(["columns().order()","column().order()"],function(a){var r=this;return this.iterator("table",function(t,e){var n=[];j.each(r[e],function(t,e){n.push([e,a])}),t.aaSorting=n})}),e("search()",function(e,n,a,r){var t=this.context;return e===N?0!==t.length?t[0].oPreviousSearch.sSearch:N:this.iterator("table",function(t){t.oFeatures.bFilter&&At(t,j.extend({},t.oPreviousSearch,{sSearch:e+"",bRegex:null!==n&&n,bSmart:null===a||a,bCaseInsensitive:null===r||r}),1)})}),t("columns().search()","column().search()",function(a,r,o,i){return this.iterator("column",function(t,e){var n=t.aoPreSearchCols;if(a===N)return n[e].sSearch;t.oFeatures.bFilter&&(j.extend(n[e],{sSearch:a+"",bRegex:null!==r&&r,bSmart:null===o||o,bCaseInsensitive:null===i||i}),At(t,t.oPreviousSearch,1))})}),e("state()",function(){return this.context.length?this.context[0].oSavedState:null}),e("state.clear()",function(){return this.iterator("table",function(t){t.fnStateSaveCallback.call(t.oInstance,t,{})})}),e("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),e("state.save()",function(){return this.iterator("table",function(t){ue(t)})}),C.versionCheck=C.fnVersionCheck=function(t){for(var e,n,a=C.version.split("."),r=t.split("."),o=0,i=r.length;o<i;o++)if((e=parseInt(a[o],10)||0)!==(n=parseInt(r[o],10)||0))return n<e;return!0},C.isDataTable=C.fnIsDataTable=function(t){var r=j(t).get(0),o=!1;return t instanceof C.Api||(j.each(C.settings,function(t,e){var n=e.nScrollHead?j("table",e.nScrollHead)[0]:null,a=e.nScrollFoot?j("table",e.nScrollFoot)[0]:null;e.nTable!==r&&n!==r&&a!==r||(o=!0)}),o)},C.tables=C.fnTables=function(e){var t=!1,n=(j.isPlainObject(e)&&(t=e.api,e=e.visible),j.map(C.settings,function(t){if(!e||j(t.nTable).is(":visible"))return t.nTable}));return t?new B(n):n},C.camelToHungarian=T,e("$()",function(t,e){e=this.rows(e).nodes(),e=j(e);return j([].concat(e.filter(t).toArray(),e.find(t).toArray()))}),j.each(["on","one","off"],function(t,n){e(n+"()",function(){var t=Array.prototype.slice.call(arguments),e=(t[0]=j.map(t[0].split(/\s/),function(t){return t.match(/\.dt\b/)?t:t+".dt"}).join(" "),j(this.tables().nodes()));return e[n].apply(e,t),this})}),e("clear()",function(){return this.iterator("table",function(t){ft(t)})}),e("settings()",function(){return new B(this.context,this.context)}),e("init()",function(){var t=this.context;return t.length?t[0].oInit:null}),e("data()",function(){return this.iterator("table",function(t){return H(t.aoData,"_aData")}).flatten()}),e("destroy()",function(f){return f=f||!1,this.iterator("table",function(e){var n,t=e.nTableWrapper.parentNode,a=e.oClasses,r=e.nTable,o=e.nTBody,i=e.nTHead,l=e.nTFoot,s=j(r),o=j(o),u=j(e.nTableWrapper),c=j.map(e.aoData,function(t){return t.nTr}),l=(e.bDestroying=!0,P(e,"aoDestroyCallback","destroy",[e]),f||new B(e).columns().visible(!0),u.off(".DT").find(":not(tbody *)").off(".DT"),j(U).off(".DT-"+e.sInstance),r!=i.parentNode&&(s.children("thead").detach(),s.append(i)),l&&r!=l.parentNode&&(s.children("tfoot").detach(),s.append(l)),e.aaSorting=[],e.aaSortingFixed=[],le(e),j(c).removeClass(e.asStripeClasses.join(" ")),j("th, td",i).removeClass(a.sSortable+" "+a.sSortableAsc+" "+a.sSortableDesc+" "+a.sSortableNone),o.children().detach(),o.append(c),f?"remove":"detach"),i=(s[l](),u[l](),!f&&t&&(t.insertBefore(r,e.nTableReinsertBefore),s.css("width",e.sDestroyWidth).removeClass(a.sTable),n=e.asDestroyStripes.length)&&o.children().each(function(t){j(this).addClass(e.asDestroyStripes[t%n])}),j.inArray(e,C.settings));-1!==i&&C.settings.splice(i,1)})}),j.each(["column","row","cell"],function(t,s){e(s+"s().every()",function(o){var i=this.selector.opts,l=this;return this.iterator(s,function(t,e,n,a,r){o.call(l[s](e,"cell"===s?n:i,"cell"===s?i:N),e,n,a,r)})})}),e("i18n()",function(t,e,n){var a=this.context[0],t=I(t)(a.oLanguage);return t===N&&(t=e),(t=n!==N&&j.isPlainObject(t)?t[n]!==N?t[n]:t._:t).replace("%d",n)}),C.version="1.10.18",C.settings=[],C.models={},C.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},C.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},C.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},C.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(t){try{return JSON.parse((-1===t.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+t.sInstance+"_"+location.pathname))}catch(t){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(t,e){try{(-1===t.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+t.sInstance+"_"+location.pathname,JSON.stringify(e))}catch(t){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:j.extend({},C.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},i(C.defaults),C.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},i(C.defaults.column),C.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:N,oAjaxData:N,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==R(this)?+this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==R(this)?+this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var t=this._iDisplayLength,e=this._iDisplayStart,n=e+t,a=this.aiDisplay.length,r=this.oFeatures,o=r.bPaginate;return r.bServerSide?!1===o||-1===t?e+a:Math.min(e+t,this._iRecordsDisplay):!o||a<n||-1===t?a:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},C.ext=p={buttons:{},classes:{},builder:"-source-",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:C.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:C.version},j.extend(p,{afnFiltering:p.search,aTypes:p.type.detect,ofnSearch:p.type.search,oSort:p.type.order,afnSortData:p.order,aoFeatures:p.feature,oApi:p.internal,oStdClasses:p.classes,oPagination:p.pager}),j.extend(C.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""}),C.ext.pager);function Le(t,e){var n=[],a=Fe.numbers_length,r=Math.floor(a/2);return e<=a?n=f(0,e):t<=r?((n=f(0,a-2)).push("ellipsis"),n.push(e-1)):((e-1-r<=t?n=f(e-(a-2),e):((n=f(t-r+2,t+r-1)).push("ellipsis"),n.push(e-1),n)).splice(0,0,"ellipsis"),n.splice(0,0,0)),n.DT_el="span",n}j.extend(Fe,{simple:function(t,e){return["previous","next"]},full:function(t,e){return["first","previous","next","last"]},numbers:function(t,e){return[Le(t,e)]},simple_numbers:function(t,e){return["previous",Le(t,e),"next"]},full_numbers:function(t,e){return["first","previous",Le(t,e),"next","last"]},first_last_numbers:function(t,e){return["first",Le(t,e),"last"]},_numbers:Le,numbers_length:7}),j.extend(!0,C.ext.renderer,{pageButton:{_:function(l,t,s,e,u,c){function f(t,e){for(var n,a=function(t){Gt(l,t.data.action,!0)},r=0,o=e.length;r<o;r++)if(n=e[r],j.isArray(n)){var i=j("<"+(n.DT_el||"div")+"/>").appendTo(t);f(i,n)}else{switch(d=null,h="",n){case"ellipsis":t.append('<span class="ellipsis">&#x2026;</span>');break;case"first":d=g.sFirst,h=n+(0<u?"":" "+p.sPageButtonDisabled);break;case"previous":d=g.sPrevious,h=n+(0<u?"":" "+p.sPageButtonDisabled);break;case"next":d=g.sNext,h=n+(u<c-1?"":" "+p.sPageButtonDisabled);break;case"last":d=g.sLast,h=n+(u<c-1?"":" "+p.sPageButtonDisabled);break;default:d=n+1,h=u===n?p.sPageButtonActive:""}null!==d&&(he(j("<a>",{class:p.sPageButton+" "+h,"aria-controls":l.sTableId,"aria-label":b[n],"data-dt-idx":S,tabindex:l.iTabIndex,id:0===s&&"string"==typeof n?l.sTableId+"_"+n:null}).html(d).appendTo(t),{action:n},a),S++)}}var d,h,n,p=l.oClasses,g=l.oLanguage.oPaginate,b=l.oLanguage.oAria.paginate||{},S=0;try{n=j(t).find(m.activeElement).data("dt-idx")}catch(t){}f(j(t).empty(),e),n!==N&&j(t).find("[data-dt-idx="+n+"]").focus()}}}),j.extend(C.ext.type.detect,[function(t,e){e=e.oLanguage.sDecimal;return s(t,e)?"num"+e:null},function(t,e){var n;return(!t||t instanceof Date||X.test(t))&&(null!==(n=Date.parse(t))&&!isNaN(n)||r(t))?"date":null},function(t,e){e=e.oLanguage.sDecimal;return s(t,e,!0)?"num-fmt"+e:null},function(t,e){e=e.oLanguage.sDecimal;return n(t,e)?"html-num"+e:null},function(t,e){e=e.oLanguage.sDecimal;return n(t,e,!0)?"html-num-fmt"+e:null},function(t,e){return r(t)||"string"==typeof t&&-1!==t.indexOf("<")?"html":null}]),j.extend(C.ext.type.search,{html:function(t){return r(t)?t:"string"==typeof t?t.replace(_," ").replace(V,""):""},string:function(t){return!r(t)&&"string"==typeof t?t.replace(_," "):t}});function Pe(t,e,n,a){return 0===t||t&&"-"!==t?+(t=(t=e?G(t,e):t).replace&&(n&&(t=t.replace(n,"")),a)?t.replace(a,""):t):-1/0}function Re(n){j.each({num:function(t){return Pe(t,n)},"num-fmt":function(t){return Pe(t,n,q)},"html-num":function(t){return Pe(t,n,V)},"html-num-fmt":function(t){return Pe(t,n,V,q)}},function(t,e){p.type.order[t+n+"-pre"]=e,t.match(/^html\-/)&&(p.type.search[t+n]=p.type.search.html)})}j.extend(p.type.order,{"date-pre":function(t){t=Date.parse(t);return isNaN(t)?-1/0:t},"html-pre":function(t){return r(t)?"":t.replace?t.replace(/<.*?>/g,"").toLowerCase():t+""},"string-pre":function(t){return r(t)?"":"string"==typeof t?t.toLowerCase():t.toString?t.toString():""},"string-asc":function(t,e){return t<e?-1:e<t?1:0},"string-desc":function(t,e){return t<e?1:e<t?-1:0}}),Re(""),j.extend(!0,C.ext.renderer,{header:{_:function(r,o,i,l){j(r.nTable).on("order.dt.DT",function(t,e,n,a){r===e&&(e=i.idx,o.removeClass(i.sSortingClass+" "+l.sSortAsc+" "+l.sSortDesc).addClass("asc"==a[e]?l.sSortAsc:"desc"==a[e]?l.sSortDesc:i.sSortingClass))})},jqueryui:function(r,o,i,l){j("<div/>").addClass(l.sSortJUIWrapper).append(o.contents()).append(j("<span/>").addClass(l.sSortIcon+" "+i.sSortingClassJUI)).appendTo(o),j(r.nTable).on("order.dt.DT",function(t,e,n,a){r===e&&(e=i.idx,o.removeClass(l.sSortAsc+" "+l.sSortDesc).addClass("asc"==a[e]?l.sSortAsc:"desc"==a[e]?l.sSortDesc:i.sSortingClass),o.find("span."+l.sSortIcon).removeClass(l.sSortJUIAsc+" "+l.sSortJUIDesc+" "+l.sSortJUI+" "+l.sSortJUIAscAllowed+" "+l.sSortJUIDescAllowed).addClass("asc"==a[e]?l.sSortJUIAsc:"desc"==a[e]?l.sSortJUIDesc:i.sSortingClassJUI))})}}});function je(t){return"string"==typeof t?t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):t}function Ne(e){return function(){var t=[fe(this[C.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return C.ext.internal[e].apply(this,t)}}return C.render={number:function(a,r,o,i,l){return{display:function(t){if("number"!=typeof t&&"string"!=typeof t)return t;var e=t<0?"-":"",n=parseFloat(t);if(isNaN(n))return je(t);n=n.toFixed(o),t=Math.abs(n);n=parseInt(t,10),t=o?r+(t-n).toFixed(o).substring(2):"";return e+(i||"")+n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a)+t+(l||"")}}},text:function(){return{display:je}}},j.extend(C.ext.internal,{_fnExternApiFunc:Ne,_fnBuildAjax:_t,_fnAjaxUpdate:Ct,_fnAjaxParameters:Tt,_fnAjaxUpdateDraw:wt,_fnAjaxDataSrc:xt,_fnAddColumn:et,_fnColumnOptions:nt,_fnAdjustColumnSizing:O,_fnVisibleToColumnIndex:k,_fnColumnIndexToVisible:c,_fnVisbleColumns:w,_fnGetColumns:at,_fnColumnTypes:rt,_fnApplyColumnDefs:ot,_fnHungarianMap:i,_fnCamelToHungarian:T,_fnLanguageCompat:Y,_fnBrowserDetect:Q,_fnAddData:x,_fnAddTr:it,_fnNodeToDataIndex:function(t,e){return e._DT_RowIndex!==N?e._DT_RowIndex:null},_fnNodeToColumnIndex:function(t,e,n){return j.inArray(n,t.aoData[e].anCells)},_fnGetCellData:D,_fnSetCellData:lt,_fnSplitObjNotation:ut,_fnGetObjectDataFn:I,_fnSetObjectDataFn:b,_fnGetDataMaster:ct,_fnClearTable:ft,_fnDeleteIndex:dt,_fnInvalidate:ht,_fnGetRowElements:pt,_fnCreateTr:gt,_fnBuildHead:St,_fnDrawHead:mt,_fnDraw:g,_fnReDraw:u,_fnAddOptionsHtml:Dt,_fnDetectHeader:vt,_fnGetUniqueThs:yt,_fnFeatureHtmlFilter:It,_fnFilterComplete:At,_fnFilterCustom:Ft,_fnFilterColumn:Lt,_fnFilter:Pt,_fnFilterCreateSearch:Rt,_fnEscapeRegex:jt,_fnFilterData:Ot,_fnFeatureHtmlInfo:Wt,_fnUpdateInfo:Et,_fnInfoMacros:Bt,_fnInitialise:Ut,_fnInitComplete:Vt,_fnLengthChange:Xt,_fnFeatureHtmlLength:Jt,_fnFeatureHtmlPaginate:qt,_fnPageChange:Gt,_fnFeatureHtmlProcessing:$t,_fnProcessingDisplay:v,_fnFeatureHtmlTable:zt,_fnScrollDraw:Yt,_fnApplyToChildren:M,_fnCalculateColumnWidths:Kt,_fnThrottle:Qt,_fnConvertToWidth:te,_fnGetWidestNode:ee,_fnGetMaxLenString:ne,_fnStringToCss:W,_fnSortFlatten:A,_fnSort:ae,_fnSortAria:re,_fnSortListener:oe,_fnSortAttachListener:ie,_fnSortingClasses:le,_fnSortData:se,_fnSaveState:ue,_fnLoadState:ce,_fnSettingsFromNode:fe,_fnLog:E,_fnMap:F,_fnBindAction:he,_fnCallbackReg:L,_fnCallbackFire:P,_fnLengthOverflow:pe,_fnRenderer:ge,_fnDataSource:R,_fnRowAttributes:bt,_fnExtend:de,_fnCalculateEnd:function(){}}),((j.fn.dataTable=C).$=j).fn.dataTableSettings=C.settings,j.fn.dataTableExt=C.ext,j.fn.DataTable=function(t){return j(this).dataTable(t).api()},j.each(C,function(t,e){j.fn.DataTable[t]=e}),j.fn.dataTable});
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return a};var a={},e=Object.prototype,s=e.hasOwnProperty,c=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i,o,a,u,t=t&&t.prototype instanceof p?t:p,t=Object.create(t.prototype),n=new w(n||[]);return c(t,"_invoke",{value:(i=e,o=r,a=n,u="suspendedStart",function(e,t){if("executing"===u)throw new Error("Generator is already running");if("completed"===u){if("throw"===e)throw t;return x()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=l(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,a);if(r){if(r===f)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===u)throw u="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);u="executing";r=l(i,o,a);if("normal"===r.type){if(u=a.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(u="completed",a.method="throw",a.arg=r.arg)}})}),t}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=u;var f={};function p(){}function m(){}function y(){}var t={},h=(o(t,n,function(){return this}),Object.getPrototypeOf),h=h&&h(h(k([]))),d=(h&&h!==e&&s.call(h,n)&&(t=h),y.prototype=p.prototype=Object.create(t));function g(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function b(a,u){var t;c(this,"_invoke",{value:function(r,n){function e(){return new u(function(e,t){!function t(e,r,n,i){var o,e=l(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==_typeof(r)&&s.call(r,"__await")?u.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):u.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function v(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(v,this),this.reset(!0)}function k(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(s.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:x}}function x(){return{value:void 0,done:!0}}return c(d,"constructor",{value:m.prototype=y,configurable:!0}),c(y,"constructor",{value:m,configurable:!0}),m.displayName=o(y,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,o(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e},a.awrap=function(e){return{__await:e}},g(b.prototype),o(b.prototype,r,function(){return this}),a.AsyncIterator=b,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new b(u(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},g(d),o(d,i,"Generator"),o(d,n,function(){return this}),o(d,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=k,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=s.call(i,"catchLoc"),u=s.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,_(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},a}function _createForOfIteratorHelper(e,t){var r,n,i,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return n=!(r=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){n=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(n)throw i}}};if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){function e(e){var t=r[e];return{size:1,baseType:0,mapValue:function(e){return t[e]},setValue:DataView.prototype.setUint8}}var a=_regeneratorRuntime().mark(k),i=_regeneratorRuntime().mark(x),r={file:{course:6},sport:{cycling:2},event:{timer:0},event_type:{start:0,stop_disable_all:9},course_point:{generic:0,summit:1,valley:2,water:3,food:4,danger:5,left:6,right:7,straight:8,first_aid:9,fourth_category:10,third_category:11,second_category:12,first_category:13,hors_category:14,sprint:15,left_fork:16,right_fork:17,middle_fork:18,slight_left:19,sharp_left:20,slight_right:21,sharp_right:22,u_turn:23,segment_start:24,segment_end:25}},t=e("file"),n=e("sport"),o=e("event"),u=e("event_type"),s=e("course_point"),c={size:1,baseType:1,setValue:DataView.prototype.setInt8},l={size:1,baseType:2,setValue:DataView.prototype.setUint8},f={size:2,baseType:131,setValue:DataView.prototype.setInt16},p={size:2,baseType:132,setValue:DataView.prototype.setUint16},m={size:4,baseType:133,setValue:DataView.prototype.setInt32},y={size:4,baseType:134,setValue:DataView.prototype.setUint32},h={size:0,baseType:7,mapValue:function(e){return Array.from(k(e))},setValue:function(e,t){var r,n=_createForOfIteratorHelper(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.setUint8(e++,i)}}catch(e){n.e(e)}finally{n.f()}}},d=_objectSpread(_objectSpread({},y),{},{mapValue:function(e){return Math.round(1e3*e)}}),g=_objectSpread(_objectSpread({},y),{},{mapValue:function(e){return Math.round(100*e)}}),b=_objectSpread(_objectSpread({},p),{},{mapValue:function(e){return Math.round(5*(e+500))}}),v=_objectSpread(_objectSpread({},y),{},{mapValue:function(e){return Math.round(e/1e3)-631065600}}),_={enum_file:t,enum_sport:n,enum_event:o,enum_event_type:u,enum_course_point:s,sint8:c,uint8:l,sint16:f,uint16:p,sint32:m,uint32:y,string:h,seconds:d,distance:g,semicircles:_objectSpread(_objectSpread({},m),{},{mapValue:function(e){return Math.round(e/180*2147483648)}}),altitude:b,date_time:v};function w(e){return Array.from(k(e)).length}function k(t){var r,n,i,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=_createForOfIteratorHelper(x(t)),e.prev=1,r.s();case 3:if((n=r.n()).done)e.next=37;else{if((i=n.value)<128)return e.next=8,i;e.next=10}break;case 8:e.next=35;break;case 10:if(o=[63&i,i>>6&63,i>>12&63,i>>18],i<2048)return e.next=14,192|o[1];e.next=18;break;case 14:return e.next=16,128|o[0];case 16:e.next=35;break;case 18:if(i<65536)return e.next=21,224|o[2];e.next=27;break;case 21:return e.next=23,128|o[1];case 23:return e.next=25,128|o[0];case 25:e.next=35;break;case 27:return e.next=29,240|o[3];case 29:return e.next=31,128|o[2];case 31:return e.next=33,128|o[1];case 33:return e.next=35,128|o[0];case 35:e.next=3;break;case 37:e.next=42;break;case 39:e.prev=39,e.t0=e.catch(1),r.e(e.t0);case 42:return e.prev=42,r.f(),e.finish(42);case 45:return e.next=47,0;case 47:case"end":return e.stop()}},a,null,[[1,39,42,45]])}function x(t){var r,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(r<t.length)return 65535<(n=t.codePointAt(r))&&r++,e.next=6,n;e.next=9;break;case 6:r++,e.next=1;break;case 9:case"end":return e.stop()}},i)}function j(e,t){return e.map(function(e){return _objectSpread(_objectSpread({},e),{},{value:t[e.name]})}).filter(function(e){return void 0!==e.value})}function O(e,t){return e>>4&4095^L[15&e]^L[t]}var S={file_id:{mesgNum:0,fieldDefns:[{name:"type",number:0,type:"enum_file"},{name:"time_created",number:4,type:"date_time"}]},lap:{mesgNum:19,fieldDefns:[{name:"timestamp",number:253,type:"date_time"},{name:"start_time",number:2,type:"date_time"},{name:"start_position_lat",number:3,type:"semicircles"},{name:"start_position_long",number:4,type:"semicircles"},{name:"end_position_lat",number:5,type:"semicircles"},{name:"end_position_long",number:6,type:"semicircles"},{name:"total_timer_time",number:8,type:"seconds"},{name:"total_distance",number:9,type:"distance"},{name:"total_ascent",number:21,type:"uint16"},{name:"total_descent",number:22,type:"uint16"}]},record:{mesgNum:20,fieldDefns:[{name:"timestamp",number:253,type:"date_time"},{name:"position_lat",number:0,type:"semicircles"},{name:"position_long",number:1,type:"semicircles"},{name:"altitude",number:2,type:"altitude"},{name:"distance",number:5,type:"distance"}]},course_point:{mesgNum:32,fieldDefns:[{name:"message_index",number:0,type:"uint16"},{name:"timestamp",number:1,type:"date_time"},{name:"position_lat",number:2,type:"semicircles"},{name:"position_long",number:3,type:"semicircles"},{name:"distance",number:4,type:"distance"},{name:"type",number:5,type:"enum_course_point"},{name:"name",number:6,type:"string"},{name:"favorite",number:8,type:"string"}]},event:{mesgNum:21,fieldDefns:[{name:"timestamp",number:253,type:"date_time"},{name:"event",number:0,type:"enum_event"},{name:"event_type",number:1,type:"enum_event_type"},{name:"event_group",number:4,type:"uint8"}]},course:{mesgNum:31,fieldDefns:[{name:"name",number:5,type:"string"}]}},D=function(){"use strict";function o(e,t,r){_classCallCheck(this,o);var n=S[t],i=n.mesgNum,n=n.fieldDefns;o.check(t,i,n,r),this.localNum=e,this.mesgNum=i,this.fields=j(n,r)}return _createClass(o,[{key:"mesgDefn",get:function(){var e=this.fields.map(function(e){var t=e.number,r=e.type,e=e.value,n=_[r],i=n.size,n=n.baseType;return"string"===r?{number:t,size:w(e),baseType:n}:{number:t,size:i,baseType:n}});return{localNum:this.localNum,mesgNum:this.mesgNum,fieldDefns:e}}},{key:"isSameDefn",value:function(e){var r,t=this.mesgDefn,n=t.localNum,i=t.mesgNum,t=t.fieldDefns;return i===e.mesgNum&&n===e.localNum&&(i=t,r=e.fieldDefns,i.length===r.length)&&i.every(function(e,t){return e=e,t=r[t],e.number===t.number&&e.size===t.size&&e.baseType===t.baseType})}},{key:"defnRecord",get:function(){var e,t=this.mesgDefn,r=t.localNum,n=t.mesgNum,t=t.fieldDefns,i=6+3*t.length,o=new DataView(new ArrayBuffer(i)),a=(o.setUint8(0,64|r),o.setUint8(2,1),o.setUint16(3,n),o.setUint8(5,t.length),6),u=_createForOfIteratorHelper(t);try{for(u.s();!(e=u.n()).done;){var s=e.value;o.setUint8(a++,s.number),o.setUint8(a++,s.size),o.setUint8(a++,s.baseType)}}catch(e){u.e(e)}finally{u.f()}return o.buffer}},{key:"dataRecord",get:function(){var e,t=this.mesgDefn,r=t.localNum,t=1+t.fieldDefns.reduce(function(e,t){return e+t.size},0),n=new DataView(new ArrayBuffer(t)),i=(n.setUint8(0,r),1),o=_createForOfIteratorHelper(this.fields);try{for(o.s();!(e=o.n()).done;){var a=e.value,u=a.value,s=a.type,c=_[s],l=c.size,f=c.mapValue;c.setValue.call(n,i,f?f(u):u),i+=l}}catch(e){o.e(e)}finally{o.f()}return n.buffer}}],[{key:"check",value:function(e,t,r,n){if(void 0===t)throw new Error("Message '".concat(e,"' not known"));if(void 0===r)throw new Error("Message '".concat(e,"' has no field definitions"));var i=r.map(function(e){return e.name}),t=Object.keys(n).filter(function(e){return!i.includes(e)});if(t.length)throw new Error("Message '".concat(e,"' has no field definitions named '").concat(t,"'"))}}]),o}(),L=[0,52225,55297,5120,61441,15360,10240,58369,40961,27648,30720,46081,20480,39937,34817,17408],E=function(e,t,r){return O(O(e,t),r)};function T(e,t){var r=1<arguments.length&&void 0!==t?t:0;return new Uint8Array(e).reduce(function(e,t){return E(e,15&t,t>>4&15)},r)}var N=function(){"use strict";function e(){_classCallCheck(this,e),this.localNum={},this.mesgDefn=[],this.messages=[]}return _createClass(e,[{key:"writeFileId",value:function(e){this.writeMesg("file_id",e)}},{key:"writeLap",value:function(e){this.writeMesg("lap",e)}},{key:"writeRecord",value:function(e){this.writeMesg("record",e)}},{key:"writeCourse",value:function(e){this.writeMesg("course",e)}},{key:"writeCoursePoint",value:function(e){this.writeMesg("course_point",e)}},{key:"writeEvent",value:function(e){this.writeMesg("event",e)}},{key:"writeMesg",value:function(e,t){var r=this.localNum[e],e=(void 0===r&&(r=this.localNum[e]=Object.keys(this.localNum).length),new D(r,e,t)),t=this.mesgDefn[r];t&&e.isSameDefn(t)||(this.messages.push(e.defnRecord),this.mesgDefn[r]=e.mesgDefn),this.messages.push(e.dataRecord)}},{key:"blob",get:function(){var e=[this.header].concat(_toConsumableArray(this.messages),[this.trailer]);return new Blob(e,{type:"application/octet-stream"})}},{key:"dataLen",get:function(){return this.messages.reduce(function(e,t){return e+t.byteLength},0)}},{key:"dataCrc",get:function(){return this.messages.reduce(function(e,t){return T(t,e)},0)}},{key:"header",get:function(){var e=new DataView(new ArrayBuffer(14));return e.setUint8(0,14),e.setUint8(1,16),e.setUint16(2,2078,!0),e.setUint32(4,this.dataLen,!0),e.setUint32(8,776358228),e.setUint16(12,T(e.buffer.slice(0,12)),!0),e.buffer}},{key:"trailer",get:function(){var e=new DataView(new ArrayBuffer(2));return e.setUint16(0,this.dataCrc,!0),e.buffer}}]),e}(),t=function(){"use strict";function s(e,t,r,n,i,o,a){_classCallCheck(this,s),this.encoder=new N;var u=Date.now();this.encoder.writeFileId({type:"course",time_created:u}),this.encoder.writeCourse({name:e}),this.encoder.writeLap({timestamp:u,start_time:t,total_timer_time:r,start_position_long:n[0],start_position_lat:n[1],end_position_long:i[0],end_position_lat:i[1],total_ascent:o,total_descent:a}),this.encoder.writeEvent({timestamp:t,event:"timer",event_type:"start",event_group:0})}return _createClass(s,[{key:"point",value:function(e,t,r,n){return this.encoder.writeRecord({timestamp:e,position_long:t[0],position_lat:t[1],altitude:r,distance:n}),this}},{key:"turn",value:function(e,t,r,n,i){return this.encoder.writeCoursePoint({timestamp:e,position_long:t[0],position_lat:t[1],type:r,name:n,distance:i}),this}},{key:"finalize",value:function(e){return this.encoder.writeEvent({timestamp:e,event:"timer",event_type:"stop_disable_all",event_group:0}),this.encoder.blob}}]),s}();window.FITEncoder=N,window.FITCourseFile=t}();
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.geoDataExchange=e.geoDataExchange||{})}(this,function(e){"use strict";var n={},l=(e.internal=n,{interpolateElevation:!1,normalize:!1,chartWidthInPixels:1600,minNormalizationDistanceInPixels:5});function o(e,n,t,i){var a=[];if(0!==e.length){var r=m(e);if(r.length<2)a.push(y(e,b([]),n));else{0<r[0].index&&(x=e.slice(0,r[0].index+1),a.push(y(x,b([]),n)));for(var l=0,o=0,s=F(e.slice(r[0].index,r[1].index+1)),c=b(r.slice(0,2).map(e=>e.point)),u=2;u<r.length;u++){var f,d,g=b(r.slice(u-1,u+1).map(e=>e.point));c!=g&&(c=!0===t&&s<i?b(r.slice(l,u+1).map(e=>e.point)):(f=r[l],d=r[u-1],x=e.slice(f.index,d.index+1),a.push(y(x,c,n)),o=l,l=u-1,s=0,g)),s+=F(e.slice(r[u-1].index,r[u].index+1))}var h,p,v=r.slice(-1)[0],x=e.slice(r[l].index,v.index+1);!0===t&&F(x)<i?(a.pop(),p=e.slice(r[o].index,v.index+1),h=b(r.slice(o).map(e=>e.point)),a.push(y(p,h,n))):a.push(y(x,c,n)),v.index<e.length-1&&(p=e.slice(v.index,e.length),a.push(y(p,b([]),n)))}}return a}function m(e){for(var n=[],t=0;t<e.length;t++){var i=e[t];if(0!=E(i)){if(0<n.length)if(a(n.slice(-1)[0].point,i))continue;n.push({point:i,index:t})}}return n}function E(e){return void 0!==e.alt}function a(e,n){return F([e,n])<30}function F(e){for(var n=0,t=1;t<e.length;t++)n+=e[t].distanceTo(e[t-1]);return n}function b(e){if(e.length<2)return s(0);for(var n=-1,t=0;t<e.length;t++)if(E(e[t])){n=t;break}if(-1==n)return s(0);for(var i,a,r=-1,t=e.length-1;n<t;t--)if(E(e[t])){r=t;break}return-1==r?s(0):(i=e[r].alt-e[n].alt,s(0==(a=F(e.slice(n,r+1)))?0:100*i/a))}function y(e,n,t){return{type:"Feature",geometry:{type:"LineString",coordinates:i(e,t).map(e=>[e.lng,e.lat,e.alt])},properties:{attributeType:n}}}function i(e,n){if(!0!==n||0===e.length)return e;var t=e.slice(),i=t;if(0!=i.length&&!E(i[0])){for(var a=0,r=0;a<i.length;a++)if(E(i[a])){r=i[a].alt;break}for(var l=0;l<a;l++){var o=i[l];i[l]=L.latLng(o.lat,o.lng,r)}}var s=t;if(0!=s.length&&!E(s[s.length-1])){for(var c=s.length-1,u=0;0<=c;c--)if(E(s[c])){u=s[c].alt;break}for(var f=c+1;f<s.length;f++){var d=s[f];s[f]=L.latLng(d.lat,d.lng,u)}}for(var g=-1,h=0;h<t.length;h++)if(E(t[h]))g=h;else if(-1!=g){for(var p=h+1;p<t.length&&!E(t[p]);p++);if(p!=t.length){D=P=I=_=z=y=b=m=x=v=void 0;for(var v=t,x=g+1,m=p-1,b=x-1,y=m+1,z=F(v.slice(b,y+1)),y=v[y].alt-v[b].alt,_=0==z?0:100*y/z,I=x;I<=m;I++){var P=v[I].distanceTo(v[I-1]),P=_*P/100+v[I-1].alt,D=v[I];v[I]=L.latLng(D.lat,D.lng,Number(P.toFixed(1)))}h=p-1}}return t}function s(e){var n=Math.round(e);return n<-16?-16:16<n?16:-16<=n&&n<=16?n:(console.log("Unknown gradientPercentage: ",e),0)}e.defaultOptions=l,e.buildGeojsonFeatures=function(e,n){var t,i=(n=void 0===n?l:n).interpolateElevation||l.interpolateElevation,a=n.normalize||l.normalize,r=0;return a&&(t=n.chartWidthInPixels||l.chartWidthInPixels,r=(n.minNormalizationDistanceInPixels||l.minNormalizationDistanceInPixels)*F(e)/t),[{type:"FeatureCollection",features:n=o(e,i,a,r),properties:{Creator:"github.com/alexcojocaru/geo-data-exchange",records:n.length,summary:"gradient"}}]},n._buildFeatures=o,n._filterCoordinatesWithAltitude=m,n._hasAltitude=E,n._isInFuzzyRange=a,n._calculateDistance=F,n._calculateGradient=b,n._interpolateElevation=i,n._mapGradient=s});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).i18next=t()}(this,function(){"use strict";function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(o){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?Object(arguments[e]):{},t=Object.keys(i);(t="function"==typeof Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})):t).forEach(function(e){var t,n;t=o,n=i[e=e],e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n})}return o}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function e(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?r(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}var i={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}};function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};a(this,s),this.init(e,t)}e(s,[{key:"init",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||i,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,o){return o&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(e){return new s(this.logger,N({},{prefix:"".concat(this.prefix,":").concat(e,":")},this.options))}}]);var c=new s,p=(e(g,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach(function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)}),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter(function(e){return e!==t}):delete this.observers[e])}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.observers[t]&&[].concat(this.observers[t]).forEach(function(e){e.apply(void 0,n)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(function(e){e.apply(e,[t].concat(n))})}}]),g);function g(){a(this,g),this.observers={}}function f(){var n,o,e=new Promise(function(e,t){n=e,o=t});return e.resolve=n,e.reject=o,e}function h(e){return null==e?"":""+e}function d(e,t,n){function o(e){return e&&-1<e.indexOf("###")?e.replace(/###/g,"."):e}function i(){return!e||"string"==typeof e}for(var s="string"!=typeof t?[].concat(t):t.split(".");1<s.length;){if(i())return{};var a=o(s.shift());!e[a]&&n&&(e[a]=new n),e=Object.prototype.hasOwnProperty.call(e,a)?e[a]:{}}return i()?{}:{obj:e,k:o(s.shift())}}function v(e,t,n){e=d(e,t,Object);e.obj[e.k]=n}function y(e,t){e=d(e,t),t=e.obj,e=e.k;if(t)return t[e]}function m(e,t,n){e=y(e,n);return void 0!==e?e:y(t,n)}function b(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function D(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,function(e){return U[e]}):e}var k="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&-1<window.navigator.userAgent.indexOf("MSIE"),I=(t(x,p),e(x,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){e=this.options.ns.indexOf(e);-1<e&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},o=(void 0!==o.keySeparator?o:this.options).keySeparator,t=[e,t];return n&&"string"!=typeof n&&(t=t.concat(n)),n&&"string"==typeof n&&(t=t.concat(o?n.split(o):n)),-1<e.indexOf(".")&&(t=e.split(".")),y(this.data,t)}},{key:"addResource",value:function(e,t,n,o){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{silent:!1},s=this.options.keySeparator,a=(void 0===s&&(s="."),[e,t]);n&&(a=a.concat(s?n.split(s):n)),-1<e.indexOf(".")&&(o=t,t=(a=e.split("."))[1]),this.addNamespaces(t),v(this.data,a,o),i.silent||this.emit("added",e,t,n,o)}},{key:"addResources",value:function(e,t,n){var o,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(o in n)"string"!=typeof n[o]&&"[object Array]"!==Object.prototype.toString.apply(n[o])||this.addResource(e,t,o,n[o],{silent:!0});i.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,o,i){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{silent:!1},a=[e,t],r=(-1<e.indexOf(".")&&(o=n,n=t,t=(a=e.split("."))[1]),this.addNamespaces(t),y(this.data,a)||{});o?function e(t,n,o){for(var i in n)"__proto__"!==i&&"constructor"!==i&&(i in t?"string"==typeof t[i]||t[i]instanceof String||"string"==typeof n[i]||n[i]instanceof String?o&&(t[i]=n[i]):e(t[i],n[i],o):t[i]=n[i])}(r,n,i):r=N({},r,n),v(this.data,a,r),s.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t=t||this.options.defaultNS,"v1"===this.options.compatibilityAPI?N({},{},this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"toJSON",value:function(){return this.data}}]),x);function x(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return a(this,x),t=l(this,u(x).call(this)),k&&p.call(r(t)),t.data=e||{},t.options=n,void 0===t.options.keySeparator&&(t.options.keySeparator="."),t}var w={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,o,i){var s=this;return e.forEach(function(e){s.processors[e]&&(t=s.processors[e].process(t,n,o,i))}),t}},S={},L=(t(j,p),e(j,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){e=this.resolve(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{interpolation:{}});return e&&void 0!==e.res}},{key:"extractFromKey",value:function(e,t){var n=(void 0!==t.nsSeparator?t:this.options).nsSeparator,o=(void 0!==t.keySeparator?t:this.options).keySeparator,t=t.ns||this.options.defaultNS;if((n=void 0===n?":":n)&&-1<e.indexOf(n)){var i=e.match(this.interpolator.nestingRegexp);if(i&&0<i.length)return{key:e,namespaces:t};i=e.split(n);(n!==o||n===o&&-1<this.options.ns.indexOf(i[0]))&&(t=i.shift()),e=i.join(o)}return{key:e,namespaces:t="string"==typeof t?[t]:t}}},{key:"translate",value:function(e,o,t){var i=this;if(o=(o="object"!==R(o)&&this.options.overloadTranslationOptionHandler?this.options.overloadTranslationOptionHandler(arguments):o)||{},null==e)return"";Array.isArray(e)||(e=[String(e)]);var n=(void 0!==o.keySeparator?o:this.options).keySeparator,s=this.extractFromKey(e[e.length-1],o),a=s.key,r=s.namespaces,l=r[r.length-1],s=o.lng||this.language,u=o.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(s&&"cimode"===s.toLowerCase())return u?(u=o.nsSeparator||this.options.nsSeparator,l+u+a):a;var u=this.resolve(e,o),c=u&&u.res,p=u&&u.usedKey||a,g=u&&u.exactUsedKey||a,f=Object.prototype.toString.apply(c),h=(void 0!==o.joinArrays?o:this.options).joinArrays,d=!this.i18nFormat||this.i18nFormat.handleAsObject;if(d&&c&&("string"!=typeof c&&"boolean"!=typeof c&&"number"!=typeof c)&&["[object Number]","[object Function]","[object RegExp]"].indexOf(f)<0&&("string"!=typeof h||"[object Array]"!==f)){if(!o.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(p,c,o):"key '".concat(a," (").concat(this.language,")' returned an object instead of string.");if(n){var v,y,m="[object Array]"===f,b=m?[]:{},k=m?g:p;for(v in c)Object.prototype.hasOwnProperty.call(c,v)&&(y="".concat(k).concat(n).concat(v),b[v]=this.translate(y,N({},o,{joinArrays:!1,ns:r})),b[v]===y)&&(b[v]=c[v]);c=b}}else if(d&&"string"==typeof h&&"[object Array]"===f)c=(c=c.join(h))&&this.extendTranslation(c,e,o,t);else{var m=!1,g=!1,p=void 0!==o.count&&"string"!=typeof o.count,d=j.hasDefaultValue(o),f=p?this.pluralResolver.getSuffix(s,o.count):"",x=o["defaultValue".concat(f)]||o.defaultValue,w=(!this.isValidLookup(c)&&d&&(m=!0,c=x),this.isValidLookup(c)||(g=!0,c=a),d&&x!==c&&this.options.updateMissing);if(g||m||w){this.logger.log(w?"updateKey":"missingKey",s,l,a,w?x:c),n&&(h=this.resolve(a,N({},o,{keySeparator:!1})))&&h.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.");var S=[],L=this.languageUtils.getFallbackCodes(this.options.fallbackLng,o.lng||this.language);if("fallback"===this.options.saveMissingTo&&L&&L[0])for(var O=0;O<L.length;O++)S.push(L[O]);else"all"===this.options.saveMissingTo?S=this.languageUtils.toResolveHierarchy(o.lng||this.language):S.push(o.lng||this.language);var C=function(e,t,n){i.options.missingKeyHandler?i.options.missingKeyHandler(e,l,t,w?n:c,w,o):i.backendConnector&&i.backendConnector.saveMissing&&i.backendConnector.saveMissing(e,l,t,w?n:c,w,o),i.emit("missingKey",e,l,t,c)};this.options.saveMissing&&(this.options.saveMissingPlurals&&p?S.forEach(function(t){i.pluralResolver.getSuffixes(t).forEach(function(e){C([t],a+e,o["defaultValue".concat(e)]||x)})}):C(S,a,x))}c=this.extendTranslation(c,e,o,u,t),g&&c===a&&this.options.appendNamespaceToMissingKey&&(c="".concat(l,":").concat(a)),g&&this.options.parseMissingKeyHandler&&(c=this.options.parseMissingKeyHandler(c))}return c}},{key:"extendTranslation",value:function(e,o,i,t,s){var n,a=this,r=(this.i18nFormat&&this.i18nFormat.parse?e=this.i18nFormat.parse(e,i,t.usedLng,t.usedNS,t.usedKey,{resolved:t}):i.skipInterpolation||(i.interpolation&&this.interpolator.init(N({},i,{interpolation:N({},this.options.interpolation,i.interpolation)})),(r=i.interpolation&&i.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables)&&(l=(l=e.match(this.interpolator.nestingRegexp))&&l.length),n=i.replace&&"string"!=typeof i.replace?i.replace:i,this.options.interpolation.defaultVariables&&(n=N({},this.options.interpolation.defaultVariables,n)),e=this.interpolator.interpolate(e,n,i.lng||this.language,i),r&&l<((n=e.match(this.interpolator.nestingRegexp))&&n.length)&&(i.nest=!1),!1!==i.nest&&(e=this.interpolator.nest(e,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s&&s[0]===t[0]&&!i.context?(a.logger.warn("It seems you are nesting recursively key: ".concat(t[0]," in key: ").concat(o[0])),null):a.translate.apply(a,t.concat([o]))},i)),i.interpolation&&this.interpolator.reset()),i.postProcess||this.options.postProcess),l="string"==typeof r?[r]:r;return e=null!=e&&l&&l.length&&!1!==i.applyPostProcessor?w.handle(l,e,o,this.options&&this.options.postProcessPassResolved?N({i18nResolved:t},i):i,this):e}},{key:"resolve",value:function(e){var u,n,c,p,o,g=this,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return(e="string"==typeof e?[e]:e).forEach(function(e){var a,r,l,t;g.isValidLookup(u)||(e=g.extractFromKey(e,f),a=e.key,n=a,e=e.namespaces,g.options.fallbackNS&&(e=e.concat(g.options.fallbackNS)),r=void 0!==f.count&&"string"!=typeof f.count,l=void 0!==f.context&&"string"==typeof f.context&&""!==f.context,t=f.lngs||g.languageUtils.toResolveHierarchy(f.lng||g.language,f.fallbackLng),e.forEach(function(s){g.isValidLookup(u)||(o=s,!S["".concat(t[0],"-").concat(s)]&&g.utils&&g.utils.hasLoadedNamespace&&!g.utils.hasLoadedNamespace(o)&&(S["".concat(t[0],"-").concat(s)]=!0,g.logger.warn('key "'.concat(n,'" for languages "').concat(t.join(", "),'" won\'t get resolved as namespace "').concat(o,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),t.forEach(function(e){if(!g.isValidLookup(u)){p=e;var t,n,o=a,i=[o];for(g.i18nFormat&&g.i18nFormat.addLookupKeys?g.i18nFormat.addLookupKeys(i,a,e,s,f):(r&&(t=g.pluralResolver.getSuffix(e,f.count)),r&&l&&i.push(o+t),l&&i.push(o+="".concat(g.options.contextSeparator).concat(f.context)),r&&i.push(o+=t));n=i.pop();)g.isValidLookup(u)||(c=n,u=g.getResource(e,s,n,f))}}))}))}),{res:u,usedKey:n,exactUsedKey:c,usedLng:p,usedNS:o}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return(this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat:this.resourceStore).getResource(e,t,n,o)}}],[{key:"hasDefaultValue",value:function(e){var t,n="defaultValue";for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n===t.substring(0,n.length)&&void 0!==e[t])return!0;return!1}}]),j);function j(e){var t,n,o,i,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return a(this,j),t=l(this,u(j).call(this)),k&&p.call(r(t)),n=["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],o=e,i=r(t),n.forEach(function(e){o[e]&&(i[e]=o[e])}),t.options=s,void 0===t.options.keySeparator&&(t.options.keySeparator="."),t.logger=c.create("translator"),t}function O(e){return e.charAt(0).toUpperCase()+e.slice(1)}e(C,[{key:"getScriptPartFromCode",value:function(e){return!e||e.indexOf("-")<0||2===(e=e.split("-")).length||(e.pop(),"x"===e[e.length-1].toLowerCase())?null:this.formatLanguageCode(e.join("-"))}},{key:"getLanguagePartFromCode",value:function(e){return!e||e.indexOf("-")<0?e:(e=e.split("-"),this.formatLanguageCode(e[0]))}},{key:"formatLanguageCode",value:function(e){var t,n;return"string"==typeof e&&-1<e.indexOf("-")?(t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-"),this.options.lowerCaseLng?n=n.map(function(e){return e.toLowerCase()}):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),-1<t.indexOf(n[1].toLowerCase())&&(n[1]=O(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),-1<t.indexOf(n[1].toLowerCase())&&(n[1]=O(n[1].toLowerCase())),-1<t.indexOf(n[2].toLowerCase()))&&(n[2]=O(n[2].toLowerCase())),n.join("-")):this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isWhitelisted",value:function(e){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(e)}},{key:"isSupportedCode",value:function(e){return"languageOnly"!==this.options.load&&!this.options.nonExplicitSupportedLngs||(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||-1<this.supportedLngs.indexOf(e)}},{key:"getBestMatchFromCodes",value:function(e){var n,o=this;return e?(e.forEach(function(e){n||(e=o.formatLanguageCode(e),o.options.supportedLngs&&!o.isSupportedCode(e))||(n=e)}),!n&&this.options.supportedLngs&&e.forEach(function(e){var t;if(!n)return t=o.getLanguagePartFromCode(e),o.isSupportedCode(t)?n=t:void(n=o.options.supportedLngs.find(function(e){if(0===e.indexOf(t))return e}))}),n=n||this.getFallbackCodes(this.options.fallbackLng)[0]):null}},{key:"getFallbackCodes",value:function(e,t){return e?("string"==typeof(e="function"==typeof e?e(t):e)&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e)?e:t?e[t]||e[this.getScriptPartFromCode(t)]||e[this.formatLanguageCode(t)]||e[this.getLanguagePartFromCode(t)]||e.default||[]:e.default||[]):[]}},{key:"toResolveHierarchy",value:function(e,t){function n(e){e&&(o.isSupportedCode(e)?i.push(e):o.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))}var o=this,t=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[];return"string"==typeof e&&-1<e.indexOf("-")?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(e))):"string"==typeof e&&n(this.formatLanguageCode(e)),t.forEach(function(e){i.indexOf(e)<0&&n(o.formatLanguageCode(e))}),i}}]);var M=C;function C(e){a(this,C),this.options=e,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=c.create("languageUtils")}var H=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],K={1:function(e){return Number(1<e)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:2<=e%10&&e%10<=4&&(e%100<10||20<=e%100)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:3<=e%100&&e%100<=10?3:11<=e%100?4:5)},6:function(e){return Number(1==e?0:2<=e&&e<=4?1:2)},7:function(e){return Number(1==e?0:2<=e%10&&e%10<=4&&(e%100<10||20<=e%100)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(2<=e)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:2<e&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:2<=e%10&&(e%100<10||20<=e%100)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||1<e%100&&e%100<11?1:10<e%100&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||0<e%100&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||10<e)&&e%10==0?2:3)}};e(E,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){e=this.getRule(e);return e&&1<e.numbers.length}},{key:"getPluralFormsOfKey",value:function(e,t){return this.getSuffixes(e).map(function(e){return t+e})}},{key:"getSuffixes",value:function(t){var n=this,e=this.getRule(t);return e?e.numbers.map(function(e){return n.getSuffix(t,e)}):[]}},{key:"getSuffix",value:function(e,t){var n,o,i=this,s=this.getRule(e);return s?(t=s.noAbs?s.plurals(t):s.plurals(Math.abs(t)),n=s.numbers[t],this.options.simplifyPluralSuffix&&2===s.numbers.length&&1===s.numbers[0]&&(2===n?n="plural":1===n&&(n="")),o=function(){return i.options.prepend&&n.toString()?i.options.prepend+n.toString():n.toString()},"v1"===this.options.compatibilityJSON?1===n?"":"number"==typeof n?"_plural_".concat(n.toString()):o():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===s.numbers.length&&1===s.numbers[0]?o():this.options.prepend&&t.toString()?this.options.prepend+t.toString():t.toString()):(this.logger.warn("no plural rule found for: ".concat(e)),"")}}]);var B=E;function E(e){var n,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};a(this,E),this.languageUtils=e,this.options=t,this.logger=c.create("pluralResolver"),this.rules=(n={},H.forEach(function(t){t.lngs.forEach(function(e){n[e]={numbers:t.nr,plurals:K[t.fc]}})}),n)}e(P,[{key:"init",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.interpolation||(e.interpolation={escapeValue:!0}),e.interpolation);this.escape=void 0!==e.escape?e.escape:D,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?b(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?b(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator||e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=!this.unescapePrefix&&e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?b(e.nestingPrefix):e.nestingPrefixEscaped||b("$t("),this.nestingSuffix=e.nestingSuffix?b(e.nestingSuffix):e.nestingSuffixEscaped||b(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator||e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces||1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix),e=(this.regexp=new RegExp(e,"g"),"".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix)),e=(this.regexpUnescape=new RegExp(e,"g"),"".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix));this.nestingRegexp=new RegExp(e,"g")}},{key:"interpolate",value:function(o,i,s,a){var r,l,u,c=this,p=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function t(e){return e.replace(/\$/g,"$$$$")}this.resetRegExp();var g=a&&a.missingInterpolationHandler||this.options.missingInterpolationHandler,f=a&&a.interpolation&&a.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t},{regex:this.regexp,safeValue:function(e){return c.escapeValue?t(c.escape(e)):t(e)}}].forEach(function(e){for(u=0;r=e.regex.exec(o);){if(t=r[1].trim(),(n=void 0)===(l=t.indexOf(c.formatSeparator)<0?(n=m(i,p,t),c.alwaysFormat?c.format(n,void 0,s):n):(t=(n=t.split(c.formatSeparator)).shift().trim(),n=n.join(c.formatSeparator).trim(),c.format(m(i,p,t),n,s,a))))if("function"==typeof g){t=g(o,r,a);l="string"==typeof t?t:""}else{if(f){l=r[0];continue}c.logger.warn("missed to pass in variable ".concat(r[1]," for interpolating ").concat(o)),l=""}else"string"==typeof l||c.useRawValueToEscape||(l=h(l));if(o=o.replace(r[0],e.safeValue(l)),e.regex.lastIndex=0,++u>=c.maxReplaces)break}var t,n}),o}},{key:"nest",value:function(e,t){var n,o=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=N({},i);function a(t,e){var n=this.nestingOptionsSeparator;if(!(t.indexOf(n)<0)){var o=t.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(o[1]);t=o[0],i=(i=this.interpolate(i,s)).replace(/'/g,'"');try{s=JSON.parse(i),e&&(s=N({},e,s))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(n).concat(i)}delete s.defaultValue}return t}for(s.applyPostProcessor=!1,delete s.defaultValue;n=this.nestingRegexp.exec(e);){var r,l=[],u=!1;if(n[0].includes(this.formatSeparator)&&!/{.*}/.test(n[1])&&(r=n[1].split(this.formatSeparator).map(function(e){return e.trim()}),n[1]=r.shift(),l=r,u=!0),(r=t(a.call(this,n[1].trim(),s),s))&&n[0]===e&&"string"!=typeof r)return r;(r="string"!=typeof r?h(r):r)||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),r=""),u&&(r=l.reduce(function(e,t){return o.format(e,t,i.lng,i)},r.trim())),e=e.replace(n[0],r),this.regexp.lastIndex=0}return e}}]);var z=P;function P(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,P),this.logger=c.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(e){return e},this.init(e)}t(F,p),e(F,[{key:"queueLoad",value:function(e,t,i,n){var s=this,a=[],r=[],l=[],u=[];return e.forEach(function(n){var o=!0;t.forEach(function(e){var t="".concat(n,"|").concat(e);!i.reload&&s.store.hasResourceBundle(n,e)?s.state[t]=2:s.state[t]<0||(1===s.state[t]?r.indexOf(t)<0&&r.push(t):(s.state[t]=1,o=!1,r.indexOf(t)<0&&r.push(t),a.indexOf(t)<0&&a.push(t),u.indexOf(e)<0&&u.push(e)))}),o||l.push(n)}),(a.length||r.length)&&this.queue.push({pending:r,loaded:{},errors:[],callback:n}),{toLoad:a,pending:r,toLoadLanguages:l,toLoadNamespaces:u}}},{key:"loaded",value:function(l,u,e){var t=l.split("|"),c=t[0],p=t[1],g=(u&&this.emit("failedLoading",c,p,u),e&&this.store.addResourceBundle(c,p,e),this.state[l]=u?-1:2,{});this.queue.forEach(function(e){t=e.loaded,o=p,n=(t=d(t,n=[c],Object)).obj,t=t.k,n[t]=n[t]||[],i&&(n[t]=n[t].concat(o)),i||n[t].push(o);for(var t,n,o,i,s=e.pending,a=l,r=s.indexOf(a);-1!==r;)s.splice(r,1),r=s.indexOf(a);u&&e.errors.push(u),0!==e.pending.length||e.done||(Object.keys(e.loaded).forEach(function(t){g[t]||(g[t]=[]),e.loaded[t].length&&e.loaded[t].forEach(function(e){g[t].indexOf(e)<0&&g[t].push(e)})}),e.done=!0,e.errors.length?e.callback(e.errors):e.callback())}),this.emit("loaded",g),this.queue=this.queue.filter(function(e){return!e.done})}},{key:"read",value:function(n,o,i){var s=this,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:350,l=5<arguments.length?arguments[5]:void 0;return n.length?this.backend[i](n,o,function(e,t){e&&t&&a<5?setTimeout(function(){s.read.call(s,n,o,i,a+1,2*r,l)},r):l(e,t)}):l(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=3<arguments.length?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e));e=this.queueLoad(e,t="string"==typeof t?[t]:t,o,i);if(!e.toLoad.length)return e.pending.length||i(),null;e.toLoad.forEach(function(e){n.loadOne(e)})}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(n){var o=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",e=n.split("|"),s=e[0],a=e[1];this.read(s,a,"read",void 0,void 0,function(e,t){e&&o.logger.warn("".concat(i,"loading namespace ").concat(a," for language ").concat(s," failed"),e),!e&&t&&o.logger.log("".concat(i,"loaded namespace ").concat(a," for language ").concat(s),t),o.loaded(n,e,t)})}},{key:"saveMissing",value:function(e,t,n,o,i){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,o,null,N({},s,{isUpdate:i})),e)&&e[0]&&this.store.addResource(e[0],t,n,o)}}]);var _=F;function F(e,t,n){var o,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return a(this,F),o=l(this,u(F).call(this)),k&&p.call(r(o)),o.backend=e,o.store=t,o.services=n,o.languageUtils=n.languageUtils,o.options=i,o.logger=c.create("backendConnector"),o.state={},o.queue=[],o.backend&&o.backend.init&&o.backend.init(n,i.backend,i),o}function V(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&(e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e.supportedLngs=e.whitelist),e.nonExplicitWhitelist&&(e.nonExplicitSupportedLngs=e.nonExplicitWhitelist),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function T(){}function A(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;if(a(this,A),e=l(this,u(A).call(this)),k&&p.call(r(e)),e.options=V(t),e.services={},e.logger=c,e.modules={external:[]},n&&!e.isInitialized&&!t.isClone){if(!e.options.initImmediate)return e.init(t,n),l(e,r(e));setTimeout(function(){e.init(t,n)},0)}return e}return t(A,p),e(A,[{key:"init",value:function(){var e,i=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;function o(e){return e?"function"==typeof e?new e:e:null}"function"==typeof t&&(n=t,t={}),t.whitelist&&!t.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),t.nonExplicitWhitelist&&!t.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=N({},{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t,n={};return"object"===R(e[1])&&(n=e[1]),"string"==typeof e[1]&&(n.defaultValue=e[1]),"string"==typeof e[2]&&(n.tDescription=e[2]),"object"!==R(e[2])&&"object"!==R(e[3])||(t=e[3]||e[2],Object.keys(t).forEach(function(e){n[e]=t[e]})),n},interpolation:{escapeValue:!0,format:function(e,t,n,o){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}},this.options,V(t)),this.format=this.options.interpolation.format,n=n||T,this.options.isClone||(this.modules.logger?c.init(o(this.modules.logger),this.options):c.init(null,this.options),t=new M(this.options),this.store=new I(this.options.resources,this.options),(e=this.services).logger=c,e.resourceStore=this.store,e.languageUtils=t,e.pluralResolver=new B(t,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),e.interpolator=new z(this.options),e.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},e.backendConnector=new _(o(this.modules.backend),e.resourceStore,e,this.options),e.backendConnector.on("*",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];i.emit.apply(i,[e].concat(n))}),this.modules.languageDetector&&(e.languageDetector=o(this.modules.languageDetector),e.languageDetector.init(e,this.options.detection,this.options)),this.modules.i18nFormat&&(e.i18nFormat=o(this.modules.i18nFormat),e.i18nFormat.init)&&e.i18nFormat.init(this),this.translator=new L(this.services,this.options),this.translator.on("*",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];i.emit.apply(i,[e].concat(n))}),this.modules.external.forEach(function(e){e.init&&e.init(i)})),!this.options.fallbackLng||this.services.languageDetector||this.options.lng||0<(t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng)).length&&"dev"!==t[0]&&(this.options.lng=t[0]),this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(function(t){i[t]=function(){var e;return(e=i.store)[t].apply(e,arguments)}});function s(){function e(e,t){i.isInitialized&&i.logger.warn("init: i18next is already initialized. You should call init just once!"),i.isInitialized=!0,i.options.isClone||i.logger.log("initialized",i.options),i.emit("initialized",i.options),a.resolve(t),n(e,t)}if(i.languages&&"v1"!==i.options.compatibilityAPI&&!i.isInitialized)return e(null,i.t.bind(i));i.changeLanguage(i.options.lng,e)}["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(function(t){i[t]=function(){var e;return(e=i.store)[t].apply(e,arguments),i}});var a=f();return this.options.resources||!this.options.initImmediate?s():setTimeout(s,0),a}},{key:"loadResources",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:T,o="string"==typeof e?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(o&&"cimode"===o.toLowerCase())return n();var i=[],e=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach(function(e){i.indexOf(e)<0&&i.push(e)})};o?e(o):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e),this.options.preload&&this.options.preload.forEach(e),this.services.backendConnector.load(i,this.options.ns,n)}else n(null)}},{key:"reloadResources",value:function(e,t,n){var o=f();return e=e||this.languages,t=t||this.options.ns,n=n||T,this.services.backendConnector.reload(e,t,function(e){o.resolve(),n(e)}),o}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(e.type)return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&w.addPostProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this;throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()")}},{key:"changeLanguage",value:function(e,n){function t(e){var t="string"==typeof e?e:o.services.languageUtils.getBestMatchFromCodes(e);t&&(o.language||(o.language=t,o.languages=o.services.languageUtils.toResolveHierarchy(t)),o.translator.language||o.translator.changeLanguage(t),o.services.languageDetector)&&o.services.languageDetector.cacheUserLanguage(t),o.loadResources(t,function(e){s(e,t)})}var o=this,i=(this.isLanguageChangingTo=e,f()),s=(this.emit("languageChanging",e),function(e,t){t?(o.language=t,o.languages=o.services.languageUtils.toResolveHierarchy(t),o.translator.changeLanguage(t),o.isLanguageChangingTo=void 0,o.emit("languageChanged",t),o.logger.log("languageChanged",t)):o.isLanguageChangingTo=void 0,i.resolve(function(){return o.t.apply(o,arguments)}),n&&n(e,function(){return o.t.apply(o,arguments)})});return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(t):t(e):t(this.services.languageDetector.detect()),i}},{key:"getFixedT",value:function(e,t){function a(e,t){var n;if("object"!==R(t)){for(var o=arguments.length,i=new Array(2<o?o-2:0),s=2;s<o;s++)i[s-2]=arguments[s];n=r.options.overloadTranslationOptionHandler([e,t].concat(i))}else n=N({},t);return n.lng=n.lng||a.lng,n.lngs=n.lngs||a.lngs,n.ns=n.ns||a.ns,r.t(e,n)}var r=this;return"string"==typeof e?a.lng=e:a.lngs=e,a.ns=t,a}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var o=this.languages[0],i=!!this.options&&this.options.fallbackLng,s=this.languages[this.languages.length-1];if("cimode"===o.toLowerCase())return!0;function a(e,t){return-1===(e=n.services.backendConnector.state["".concat(e,"|").concat(t)])||2===e}if(t.precheck){t=t.precheck(this,a);if(void 0!==t)return t}return!!this.hasResourceBundle(o,e)||!this.services.backendConnector.backend||!(!a(o,e)||i&&!a(s,e))}},{key:"loadNamespaces",value:function(e,t){var n=this,o=f();return this.options.ns?((e="string"==typeof e?[e]:e).forEach(function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)}),this.loadResources(function(e){o.resolve(),t&&t(e)}),o):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=f(),o=this.options.preload||[],e=(e="string"==typeof e?[e]:e).filter(function(e){return o.indexOf(e)<0});return e.length?(this.options.preload=o.concat(e),this.loadResources(function(e){n.resolve(),t&&t(e)}),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){return!(e=e||(this.languages&&0<this.languages.length?this.languages[0]:this.language))||0<=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))?"rtl":"ltr"}},{key:"createInstance",value:function(){return new A(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)}},{key:"cloneInstance",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:T,e=N({},this.options,e,{isClone:!0}),i=new A(e);return["store","services","language"].forEach(function(e){i[e]=t[e]}),i.services=N({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new L(i.services,i.options),i.translator.on("*",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];i.emit.apply(i,[e].concat(n))}),i.init(e,n),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}}]),new A});
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(e="undefined"!=typeof globalThis?globalThis:e||self).i18nextBrowserLanguageDetector=o()}(this,function(){"use strict";function n(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var e=[],a=e.forEach,r=e.slice;function t(){if(null===o)try{o="undefined"!==window&&null!==window.localStorage;var e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch(e){o=!1}return o}function i(){if(null===f)try{f="undefined"!==window&&null!==window.sessionStorage;var e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch(e){f=!1}return f}var s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,u=function(e,o,t,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};t&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+60*t*1e3)),n&&(i.domain=n),document.cookie=function(e,o,t){var t=t||{},o=(t.path=t.path||"/",encodeURIComponent(o)),n="".concat(e,"=").concat(o);if(0<t.maxAge){e=+t.maxAge;if(Number.isNaN(e))throw new Error("maxAge should be a Number");n+="; Max-Age=".concat(Math.floor(e))}if(t.domain){if(!s.test(t.domain))throw new TypeError("option domain is invalid");n+="; Domain=".concat(t.domain)}if(t.path){if(!s.test(t.path))throw new TypeError("option path is invalid");n+="; Path=".concat(t.path)}if(t.expires){if("function"!=typeof t.expires.toUTCString)throw new TypeError("option expires is invalid");n+="; Expires=".concat(t.expires.toUTCString())}if(t.httpOnly&&(n+="; HttpOnly"),t.secure&&(n+="; Secure"),t.sameSite)switch("string"==typeof t.sameSite?t.sameSite.toLowerCase():t.sameSite){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return n}(e,encodeURIComponent(o),i)},c=function(e){for(var o="".concat(e,"="),t=document.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(o))return i.substring(o.length,i.length)}return null},l={name:"cookie",lookup:function(e){var o;return o=e.lookupCookie&&"undefined"!=typeof document&&(e=c(e.lookupCookie))?e:o},cacheUserLanguage:function(e,o){o.lookupCookie&&"undefined"!=typeof document&&u(o.lookupCookie,e,o.cookieMinutes,o.cookieDomain,o.cookieOptions)}},d={name:"querystring",lookup:function(e){var o;if("undefined"!=typeof window)for(var t=window.location.search,n=(t=!window.location.search&&window.location.hash&&-1<window.location.hash.indexOf("?")?window.location.hash.substring(window.location.hash.indexOf("?")):t).substring(1).split("&"),i=0;i<n.length;i++){var a=n[i].indexOf("=");0<a&&n[i].substring(0,a)===e.lookupQuerystring&&(o=n[i].substring(a+1))}return o}},o=null,g={name:"localStorage",lookup:function(e){var o;return o=e.lookupLocalStorage&&t()&&(e=window.localStorage.getItem(e.lookupLocalStorage))?e:o},cacheUserLanguage:function(e,o){o.lookupLocalStorage&&t()&&window.localStorage.setItem(o.lookupLocalStorage,e)}},f=null,p={name:"sessionStorage",lookup:function(e){var o;return o=e.lookupSessionStorage&&i()&&(e=window.sessionStorage.getItem(e.lookupSessionStorage))?e:o},cacheUserLanguage:function(e,o){o.lookupSessionStorage&&i()&&window.sessionStorage.setItem(o.lookupSessionStorage,e)}},h={name:"navigator",lookup:function(e){var o=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var t=0;t<navigator.languages.length;t++)o.push(navigator.languages[t]);navigator.userLanguage&&o.push(navigator.userLanguage),navigator.language&&o.push(navigator.language)}return 0<o.length?o:void 0}},m={name:"htmlTag",lookup:function(e){var o,e=e.htmlTag||("undefined"!=typeof document?document.documentElement:null);return o=e&&"function"==typeof e.getAttribute?e.getAttribute("lang"):o}},w={name:"path",lookup:function(e){var o;if("undefined"!=typeof window){var t=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(t instanceof Array)if("number"==typeof e.lookupFromPathIndex){if("string"!=typeof t[e.lookupFromPathIndex])return;o=t[e.lookupFromPathIndex].replace("/","")}else o=t[0].replace("/","")}return o}},v={name:"subdomain",lookup:function(e){var e="number"==typeof e.lookupFromSubdomainIndex?e.lookupFromSubdomainIndex+1:1,o="undefined"!=typeof window&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(o)return o[e]}};e=function(){function i(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=this,n=i;if(!(t instanceof n))throw new TypeError("Cannot call a class as a function");this.type="languageDetector",this.detectors={},this.init(e,o)}var e,o,t;return e=i,(o=[{key:"init",value:function(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.services=e||{languageUtils:{}},this.options=function(t){return a.call(r.call(arguments,1),function(e){if(e)for(var o in e)void 0===t[o]&&(t[o]=e[o])}),t}(o,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=t,this.addDetector(l),this.addDetector(d),this.addDetector(g),this.addDetector(p),this.addDetector(h),this.addDetector(m),this.addDetector(w),this.addDetector(v)}},{key:"addDetector",value:function(e){this.detectors[e.name]=e}},{key:"detect",value:function(e){var o=this,t=(e=e||this.options.order,[]);return e.forEach(function(e){o.detectors[e]&&(e=(e=o.detectors[e].lookup(o.options))&&"string"==typeof e?[e]:e)&&(t=t.concat(e))}),this.services.languageUtils.getBestMatchFromCodes?t:0<t.length?t[0]:null}},{key:"cacheUserLanguage",value:function(o,e){var t=this;!(e=e||this.options.caches)||this.options.excludeCacheFor&&-1<this.options.excludeCacheFor.indexOf(o)||e.forEach(function(e){t.detectors[e]&&t.detectors[e].cacheUserLanguage(o,t.options)})}}])&&n(e.prototype,o),t&&n(e,t),Object.defineProperty(e,"prototype",{writable:!1}),i}();return e.type="languageDetector",e});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).i18nextXHRBackend=e()}(this,function(){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var t=[],r=t.forEach,a=t.slice;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l="function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?function(t){return e(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)})(t)}function u(t,e){if(e&&"object"===l(e)){var n,o="",i=encodeURIComponent;for(n in e)o+="&"+i(n)+"="+i(e[n]);if(!o)return t;t=t+(-1!==t.indexOf("?")?"&":"?")+o.slice(1)}return t}function n(t,e,n,o,i){o&&"object"===l(o)&&(i||(o._t=new Date),o=u("",o).slice(1)),e.queryStringParams&&(t=u(t,e.queryStringParams));try{var r=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0"),a=(r.open(o?"POST":"GET",t,1),e.crossDomain||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.withCredentials=!!e.withCredentials,o&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.overrideMimeType&&r.overrideMimeType("application/json"),e.customHeaders);if(a="function"==typeof a?a():a)for(var s in a)r.setRequestHeader(s,a[s]);r.onreadystatechange=function(){3<r.readyState&&n&&n(r.responseText,r)},r.send(o)}catch(t){console&&console.log(t)}}function s(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:JSON.parse,parsePayload:function(t,e,n){return n=n||"",(e=e)in(o={})?Object.defineProperty(o,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[e]=n,o;var o},crossDomain:!1,ajax:n}}t=function(){function i(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this,o=i;if(!(n instanceof o))throw new TypeError("Cannot call a class as a function");this.init(t,e),this.type="backend"}var t,e,n;return t=i,(e=[{key:"init",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.services=t,this.options=function(n){return r.call(a.call(arguments,1),function(t){if(t)for(var e in t)void 0===n[e]&&(n[e]=t[e])}),n}(e,this.options||{},s())}},{key:"readMulti",value:function(t,e,n){var o=this.options.loadPath,o=("function"==typeof this.options.loadPath&&(o=this.options.loadPath(t,e)),this.services.interpolator.interpolate(o,{lng:t.join("+"),ns:e.join("+")}));this.loadUrl(o,n)}},{key:"read",value:function(t,e,n){var o=this.options.loadPath,o=("function"==typeof this.options.loadPath&&(o=this.options.loadPath([t],[e])),this.services.interpolator.interpolate(o,{lng:t,ns:e}));this.loadUrl(o,n)}},{key:"loadUrl",value:function(i,r){var a=this;this.options.ajax(i,this.options,function(t,e){if(500<=e.status&&e.status<600)return r("failed loading "+i,!0);if(400<=e.status&&e.status<500)return r("failed loading "+i,!1);var n,o;try{n=a.options.parse(t,i)}catch(t){o="failed parsing "+i+" to json"}if(o)return r(o,!1);r(null,n)})}},{key:"create",value:function(t,e,n,o){var i=this,r=("string"==typeof t&&(t=[t]),this.options.parsePayload(e,n,o));t.forEach(function(t){t=i.services.interpolator.interpolate(i.options.addPath,{lng:t,ns:e});i.options.ajax(t,i.options,function(t,e){},r)})}}])&&o(t.prototype,e),n&&o(t,n),i}();return t.type="backend",t});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.jqueryI18next=e()}(this,function(){"use strict";var d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,a=arguments[e];for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},t={tName:"t",i18nName:"i18n",handleName:"localize",selectorAttr:"data-i18n",targetAttr:"i18n-target",optionsAttr:"i18n-options",useOptionsAttr:!1,parseDefaultValueFromContent:!0};return{init:function(l,i){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};function o(t,e,n){var a,r,i;function o(t,e){return s.parseDefaultValueFromContent?d({},t,{defaultValue:e}):t}0!==e.length&&(a="text",0===e.indexOf("[")&&(e=(r=e.split("]"))[1],a=r[0].substr(1,r[0].length-1)),e.indexOf(";")===e.length-1&&(e=e.substr(0,e.length-2)),"html"===a?t.html(l.t(e,o(n,t.html()))):"text"===a?t.text(l.t(e,o(n,t.text()))):"prepend"===a?t.prepend(l.t(e,o(n,t.html()))):"append"===a?t.append(l.t(e,o(n,t.html()))):0===a.indexOf("data-")?(r=a.substr("data-".length),i=l.t(e,o(n,t.data(r))),t.data(r,i),t.attr(a,i)):t.attr(a,l.t(e,o(n,t.attr(a)))))}function e(t,n){var a,e,r=t.attr(s.selectorAttr);(r=r||void 0===r||!1===r?r:t.text()||t.val())&&((e=(a=t).data(s.targetAttr))&&(a=t.find(e)||t),n=(n=n||!0!==s.useOptionsAttr?n:t.data(s.optionsAttr))||{},0<=r.indexOf(";")?(e=r.split(";"),i.each(e,function(t,e){""!==e&&o(a,e.trim(),n)})):o(a,r,n),!0===s.useOptionsAttr)&&(delete(e=d({clone:e={}},n)).lng,t.data(s.optionsAttr,e))}s=d({},t,s),i[s.tName]=l.t.bind(l),i[s.i18nName]=l,i.fn[s.handleName]=function(t){return this.each(function(){e(i(this),t),i(this).find("["+s.selectorAttr+"]").each(function(){e(i(this),t)})})}}}});
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(E,P){"use strict";if(!E.jstree){var l,h,_,s,a,g,u,r,n=0,o=!1,d=!1,c=!1,i=[],e=E("script:last").attr("src"),v=window.document,f=window.setImmediate,p=window.Promise,m=(!f&&p&&(f=function(e,t){p.resolve(t).then(e)}),E.jstree={version:"3.3.12",defaults:{plugins:[]},plugins:{},path:e&&-1!==e.indexOf("/")?e.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},E.jstree.create=function(e,i){var r=new E.jstree.core(++n),t=i;return i=E.extend(!0,{},E.jstree.defaults,i),t&&t.plugins&&(i.plugins=t.plugins),E.each(i.plugins,function(e,t){"core"!==e&&(r=r.plugin(t,i[t]))}),E(e).data("jstree",r),r.init(e,i),r},E.jstree.destroy=function(){E(".jstree:jstree").jstree("destroy"),E(v).off(".jstree")},E.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},E.jstree.reference=function(t){var i=null,e=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!e||!e.length)try{e=E(t)}catch(e){}if(!e||!e.length)try{e=E("#"+t.replace(E.jstree.idregex,"\\$&"))}catch(e){}return e&&e.length&&(e=e.closest(".jstree")).length&&(e=e.data("jstree"))?i=e:E(".jstree").each(function(){var e=E(this).data("jstree");if(e&&e._model.data[t])return i=e,!1}),i},E.fn.jstree=function(i){var r="string"==typeof i,s=Array.prototype.slice.call(arguments,1),a=null;return!(!0===i&&!this.length)&&(this.each(function(){var e=E.jstree.reference(this),t=r&&e?e[i]:null;if(a=r&&t?t.apply(e,s):null,e||r||i!==P&&!E.isPlainObject(i)||E.jstree.create(this,i),null!==(a=e&&!r||!0===i?e||!1:a)&&a!==P)return!1}),null!==a&&a!==P?a:this)},E.expr.pseudos.jstree=E.expr.createPseudo(function(e){return function(e){return E(e).hasClass("jstree")&&E(e).data("jstree")!==P}}),E.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:E.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,compute_elements_positions:!1,keyboard:{"ctrl-space":function(e){e.type="click",E(e.currentTarget).trigger(e)},enter:function(e){e.type="click",E(e.currentTarget).trigger(e)},left:function(e){e.preventDefault(),this.is_open(e.currentTarget)?this.close_node(e.currentTarget):(e=this.get_parent(e.currentTarget))&&e.id!==E.jstree.root&&this.get_node(e,!0).children(".jstree-anchor").trigger("focus")},up:function(e){e.preventDefault();e=this.get_prev_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").trigger("focus")},right:function(e){e.preventDefault(),this.is_closed(e.currentTarget)?this.open_node(e.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").trigger("focus")}):this.is_open(e.currentTarget)&&(e=this.get_node(e.currentTarget,!0).children(".jstree-children")[0])&&E(this._firstChild(e)).children(".jstree-anchor").trigger("focus")},down:function(e){e.preventDefault();e=this.get_next_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").trigger("focus")},"*":function(e){this.open_all()},home:function(e){e.preventDefault();e=this._firstChild(this.get_container_ul()[0]);e&&E(e).children(".jstree-anchor").filter(":visible").trigger("focus")},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().trigger("focus")},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}}},E.jstree.core.prototype={plugin:function(e,t){var i=E.jstree.plugins[e];return i?(this._data[e]={},i.prototype=this,new i(t,this)):this},init:function(e,t){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[E.jstree.root]={id:E.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=E(e).addClass("jstree jstree-"+this._id),this.settings=t,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(E.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e,t,i=v.createElement("LI");return i.setAttribute("role","none"),(e=v.createElement("I")).className="jstree-icon jstree-ocl",e.setAttribute("role","presentation"),i.appendChild(e),(e=v.createElement("A")).className="jstree-anchor",e.setAttribute("href","#"),e.setAttribute("tabindex","-1"),e.setAttribute("role","treeitem"),(t=v.createElement("I")).className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),e.appendChild(t),i.appendChild(e),e=t=null,i},_kbevent_to_func:function(e){var t=[];if(e.ctrlKey&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift"),t.push({8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"}[e.which]||e.which),"shift-shift"!==(t=t.sort().join("-").toLowerCase())&&"ctrl-ctrl"!==t&&"alt-alt"!==t){var i,r,s=this.settings.core.keyboard;for(i in s)if(s.hasOwnProperty(i)&&(r="-"!==(r=i)&&"+"!==r?(r=r.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS")).split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase():r)===t)return s[i]}return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var s="",a=null,t=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(v.selection&&v.selection.empty)v.selection.empty();else if(window.getSelection){e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(e){}}}).on("mousedown.jstree",function(e){e.target===this.element[0]&&(e.preventDefault(),t=+new Date)}.bind(this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",function(e){this.toggle_node(e.target)}.bind(this)).on("dblclick.jstree",".jstree-anchor",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this.settings.core.dblclick_toggle&&this.toggle_node(e.target)}.bind(this)).on("click.jstree",".jstree-anchor",function(e){e.preventDefault(),e.currentTarget!==v.activeElement&&E(e.currentTarget).trigger("focus"),this.activate_node(e.currentTarget,e)}.bind(this)).on("keydown.jstree",".jstree-anchor",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37));var t=this._kbevent_to_func(e);if(t){t=t.call(this,e);if(!1===t||!0===t)return t}}.bind(this)).on("load_node.jstree",function(e,t){t.status&&(t.node.id!==E.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var e=[],t=0,i=this._data.core.selected.length;t<i;t++)e=e.concat(this._model.data[this._data.core.selected[t]].parents);for(t=0,i=(e=E.vakata.array_unique(e)).length;t<i;t++)this.open_node(e[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}}.bind(this),0))}.bind(this)).on("keypress.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;a&&clearTimeout(a),a=setTimeout(function(){s=""},500);var i=String.fromCharCode(e.which).toLowerCase(),e=this.element.find(".jstree-anchor").filter(":visible"),t=e.index(v.activeElement)||0,r=!1;if(1<(s+=i).length){if(e.slice(t).each(function(e,t){if(0===E(t).text().toLowerCase().indexOf(s))return E(t).trigger("focus"),!(r=!0)}.bind(this)),r)return;if(e.slice(0,t).each(function(e,t){if(0===E(t).text().toLowerCase().indexOf(s))return E(t).trigger("focus"),!(r=!0)}.bind(this)),r)return}new RegExp("^"+i.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(s)&&(e.slice(t+1).each(function(e,t){if(E(t).text().toLowerCase().charAt(0)===i)return E(t).trigger("focus"),!(r=!0)}.bind(this)),r||e.slice(0,t+1).each(function(e,t){if(E(t).text().toLowerCase().charAt(0)===i)return E(t).trigger("focus"),!(r=!0)}.bind(this)))}.bind(this)).on("init.jstree",function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this._data.core.themes.ellipsis=e.ellipsis,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)}.bind(this)).on("loading.jstree",function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()}.bind(this)).on("blur.jstree",".jstree-anchor",function(e){this._data.core.focused=null,E(e.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0")}.bind(this)).on("focus.jstree",".jstree-anchor",function(e){var t=this.get_node(e.currentTarget);t&&t.id&&(this._data.core.focused=t.id),this.element.find(".jstree-hovered").not(e.currentTarget).trigger("mouseleave"),E(e.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1")}.bind(this)).on("focus.jstree",function(){var e;500<+new Date-t&&!this._data.core.focused&&this.settings.core.restore_focus&&(t=0,e=this.get_node(this.element.attr("aria-activedescendant"),!0))&&e.find("> .jstree-anchor").trigger("focus")}.bind(this)).on("mouseenter.jstree",".jstree-anchor",function(e){this.hover_node(e.currentTarget)}.bind(this)).on("mouseleave.jstree",".jstree-anchor",function(e){this.dehover_node(e.currentTarget)}.bind(this))},unbind:function(){this.element.off(".jstree"),E(v).off(".jstree-"+this._id)},trigger:function(e,t){((t=t||{}).instance=this).element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(e){var t=this.settings.core.strings;return E.vakata.is_function(t)?t.call(this,e):t&&t[e]?t[e]:e},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(e,t){var i;(e=e&&e.id?e.id:e)instanceof E&&e.length&&e[0].id&&(e=e[0].id);try{if(this._model.data[e])e=this._model.data[e];else if("string"==typeof e&&this._model.data[e.replace(/^#/,"")])e=this._model.data[e.replace(/^#/,"")];else if("string"==typeof e&&(i=E("#"+e.replace(E.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])e=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=this.element.find(e)).length&&this._model.data[i.closest(".jstree-node").attr("id")])e=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=this.element.find(e)).length||!i.hasClass("jstree"))return!1;e=this._model.data[E.jstree.root]}return e=t?e.id===E.jstree.root?this.element:E("#"+e.id.replace(E.jstree.idregex,"\\$&"),this.element):e}catch(e){return!1}},get_path:function(e,t,i){if(!(e=e.parents?e:this.get_node(e))||e.id===E.jstree.root||!e.parents)return!1;var r,s,a=[];for(a.push(i?e.id:e.text),r=0,s=e.parents.length;r<s;r++)a.push(i?e.parents[r]:this.get_text(e.parents[r]));return a=a.reverse().slice(1),t?a.join(t):a},get_next_dom:function(e,t){var i;if((e=this.get_node(e,!0))[0]===this.element[0]){for(i=this._firstChild(this.get_container_ul()[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);return!!i&&E(i)}if(!e||!e.length)return!1;if(t){for(i=e[0];(i=this._nextSibling(i))&&0===i.offsetHeight;);return!!i&&E(i)}if(e.hasClass("jstree-open")){for(i=this._firstChild(e.children(".jstree-children")[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);if(null!==i)return E(i)}for(i=e[0];(i=this._nextSibling(i))&&0===i.offsetHeight;);return null!==i?E(i):e.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(e,t){var i;if((e=this.get_node(e,!0))[0]===this.element[0]){for(i=this.get_container_ul()[0].lastChild;i&&0===i.offsetHeight;)i=this._previousSibling(i);return!!i&&E(i)}if(!e||!e.length)return!1;if(t){for(i=e[0];(i=this._previousSibling(i))&&0===i.offsetHeight;);return!!i&&E(i)}for(i=e[0];(i=this._previousSibling(i))&&0===i.offsetHeight;);if(null===i)return!(!(i=e[0].parentNode.parentNode)||!i.className||-1===i.className.indexOf("jstree-node"))&&E(i);for(e=E(i);e.hasClass("jstree-open");)e=e.children(".jstree-children").first().children(".jstree-node:visible:last");return e},get_parent:function(e){return!(!(e=this.get_node(e))||e.id===E.jstree.root)&&e.parent},get_children_dom:function(e){return(e=this.get_node(e,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||0<e.children.length)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(n,o){var e,t,i,r,s;if(E.vakata.is_array(n))this._load_nodes(n.slice(),o);else{if(!(n=this.get_node(n)))return o&&o.call(this,n,!1),!1;if(n.state.loaded){for(n.state.loaded=!1,i=0,r=n.parents.length;i<r;i++)this._model.data[n.parents[i]].children_d=E.vakata.array_filter(this._model.data[n.parents[i]].children_d,function(e){return-1===E.inArray(e,n.children_d)});for(e=0,t=n.children_d.length;e<t;e++)this._model.data[n.children_d[e]].state.selected&&(s=!0),delete this._model.data[n.children_d[e]];s&&(this._data.core.selected=E.vakata.array_filter(this._data.core.selected,function(e){return-1===E.inArray(e,n.children_d)})),n.children=[],n.children_d=[],s&&this.trigger("changed",{action:"load_node",node:n,selected:this._data.core.selected})}n.state.failed=!1,n.state.loading=!0,this.get_node(n,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(n,function(e){(n=this._model.data[n.id]).state.loading=!1,n.state.loaded=e,n.state.failed=!n.state.loaded;for(var t=this.get_node(n,!0),i=0,r=this._model.data,s=!1,i=0,a=n.children.length;i<a;i++)if(r[n.children[i]]&&!r[n.children[i]].state.hidden){s=!0;break}n.state.loaded&&t&&t.length&&(t.removeClass("jstree-closed jstree-open jstree-leaf"),s?"#"!==n.id&&t.addClass(n.state.opened?"jstree-open":"jstree-closed"):t.addClass("jstree-leaf")),t.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:n,status:e}),o&&o.call(this,n,e)}.bind(this))}return!0},_load_nodes:function(e,t,i,r){for(var s=!0,a=function(){this._load_nodes(e,t,!0)},n=this._model.data,o=[],d=0,c=e.length;d<c;d++)n[e[d]]&&(!n[e[d]].state.loaded&&!n[e[d]].state.failed||!i&&r)&&(this.is_loading(e[d])||this.load_node(e[d],a),s=!1);if(s){for(d=0,c=e.length;d<c;d++)n[e[d]]&&n[e[d]].state.loaded&&o.push(e[d]);t&&!t.done&&(t.call(this,o),t.done=!0)}},load_all:function(e,t){if(e=e||E.jstree.root,!(e=this.get_node(e)))return!1;var i,r,s=[],a=this._model.data,n=a[e.id].children_d;for(e.state&&!e.state.loaded&&s.push(e.id),i=0,r=n.length;i<r;i++)a[n[i]]&&a[n[i]].state&&!a[n[i]].state.loaded&&s.push(n[i]);s.length?this._load_nodes(s,function(){this.load_all(e,t)}):(t&&t.call(this,e),this.trigger("load_all",{node:e}))},_load_node:function(s,a){function n(){return 3!==this.nodeType&&8!==this.nodeType}var e,t=this.settings.core.data;return t?E.vakata.is_function(t)?t.call(this,s,function(e){!1===e?a.call(this,!1):this["string"==typeof e?"_append_html_data":"_append_json_data"](s,"string"==typeof e?E(E.parseHTML(e)).filter(n):e,function(e){a.call(this,e)})}.bind(this)):"object"==typeof t?t.url?(t=E.extend(!0,{},t),E.vakata.is_function(t.url)&&(t.url=t.url.call(this,s)),E.vakata.is_function(t.data)&&(t.data=t.data.call(this,s)),E.ajax(t).done(function(e,t,i){var r=i.getResponseHeader("Content-Type");return r&&-1!==r.indexOf("json")||"object"==typeof e?this._append_json_data(s,e,function(e){a.call(this,e)}):r&&-1!==r.indexOf("html")||"string"==typeof e?this._append_html_data(s,E(E.parseHTML(e)).filter(n),function(e){a.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:s.id,xhr:i})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1))}.bind(this)).fail(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:s.id,xhr:e})},a.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)}.bind(this))):(e=E.vakata.is_array(t)?E.extend(!0,[],t):E.isPlainObject(t)?E.extend(!0,{},t):t,s.id===E.jstree.root?this._append_json_data(s,e,function(e){a.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:s.id})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1))):"string"==typeof t?s.id===E.jstree.root?this._append_html_data(s,E(E.parseHTML(t)).filter(n),function(e){a.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:s.id})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1)):a.call(this,!1):s.id===E.jstree.root?this._append_html_data(s,this._data.core.original_container_html.clone(!0),function(e){a.call(this,e)}):a.call(this,!1)},_node_changed:function(e){(e=this.get_node(e))&&-1===E.inArray(e.id,this._model.changed)&&this._model.changed.push(e.id)},_append_html_data:function(e,t,i){(e=this.get_node(e)).children=[],e.children_d=[];var r,s,a,t=t.is("ul")?t.children():t,n=e.id,o=[],d=[],c=this._model.data,l=c[n],e=this._data.core.selected.length;for(t.each(function(e,t){(r=this._parse_model_from_html(E(t),n,l.parents.concat()))&&(o.push(r),d.push(r),c[r].children_d.length)&&(d=d.concat(c[r].children_d))}.bind(this)),l.children=o,l.children_d=d,s=0,a=l.parents.length;s<a;s++)c[l.parents[s]].children_d=c[l.parents[s]].children_d.concat(d);this.trigger("model",{nodes:d,parent:n}),n!==E.jstree.root?(this._node_changed(n),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==e&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(e,t,d,i){if(null!==this.element){(e=this.get_node(e)).children=[],e.children_d=[],t.d&&"string"==typeof(t=t.d)&&(t=JSON.parse(t)),E.vakata.is_array(t)||(t=[t]);var r=null,s={df:this._model.default_state,dat:t,par:e.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},m=this,a=function(e,c){function l(e,t,i){i=i?i.concat():[],t&&i.unshift(t);var r,s,a,n,o=e.id.toString(),d={id:o,text:e.text||"",icon:e.icon===c||e.icon,parent:t,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in g)g.hasOwnProperty(r)&&(d.state[r]=g[r]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==c&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(d.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(d.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(d.li_attr[r]=e.li_attr[r]);if(d.li_attr.id||(d.li_attr.id=o),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(d.a_attr[r]=e.a_attr[r]);for(e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),r=0,s=(p[d.id]=d).children.length;r<s;r++)a=l(p[d.children[r]],d.id,i),n=p[a],d.children_d.push(a),n.children_d.length&&(d.children_d=d.children_d.concat(n.children_d));return delete e.data,delete e.children,p[d.id].original=e,d.state.selected&&_.push(d.id),d.id}function h(e,t,i){i=i?i.concat():[],t&&i.unshift(t);for(var r,s,a,n,o,d=!1;d="j"+u+"_"+ ++f,p[d];);for(r in o={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===c||e.icon,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},g)g.hasOwnProperty(r)&&(o.state[r]=g[r]);if(e&&e.id&&(o.id=e.id.toString()),e&&e.text&&(o.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(o.icon=e.data.jstree.icon),o.icon!==c&&null!==o.icon&&""!==o.icon||(o.icon=!0),e&&e.data&&(o.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(o.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(o.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(o.li_attr[r]=e.li_attr[r]);if(o.li_attr.id&&!o.id&&(o.id=o.li_attr.id.toString()),o.id||(o.id=d),o.li_attr.id||(o.li_attr.id=o.id),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(o.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,s=e.children.length;r<s;r++)a=h(e.children[r],o.id,i),n=p[a],o.children.push(a),n.children_d.length&&(o.children_d=o.children_d.concat(n.children_d));o.children_d=o.children_d.concat(o.children)}return e&&e.children&&!0===e.children&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete e.data,delete e.children,o.original=e,(p[o.id]=o).state.selected&&_.push(o.id),o.id}var t,i,r,s=(e=e.data?e.data:e).dat,a=e.par,n=[],o=[],_=[],g=e.df,u=e.t_id,f=e.t_cnt,p=e.m,d=p[a],e=e.sel;if(s.length&&s[0].id!==c&&s[0].parent!==c){for(i=0,r=s.length;i<r;i++)s[i].children||(s[i].children=[]),s[i].state||(s[i].state={}),p[s[i].id.toString()]=s[i];for(i=0,r=s.length;i<r;i++)p[s[i].parent.toString()]?(p[s[i].parent.toString()].children.push(s[i].id.toString()),d.children_d.push(s[i].id.toString())):void 0!==m&&(m._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:s[i].id.toString(),parent:s[i].parent.toString()})},m.settings.core.error.call(m,m._data.core.last_error));for(i=0,r=d.children.length;i<r;i++)t=l(p[d.children[i]],a,d.parents.concat()),o.push(t),p[t].children_d.length&&(o=o.concat(p[t].children_d));for(i=0,r=d.parents.length;i<r;i++)p[d.parents[i]].children_d=p[d.parents[i]].children_d.concat(o)}else{for(i=0,r=s.length;i<r;i++)(t=h(s[i],a,d.parents.concat()))&&(n.push(t),o.push(t),p[t].children_d.length)&&(o=o.concat(p[t].children_d));for(d.children=n,d.children_d=o,i=0,r=d.parents.length;i<r;i++)p[d.parents[i]].children_d=p[d.parents[i]].children_d.concat(o)}if(e={cnt:f,mod:p,sel:e,par:a,dpc:o,add:_},"undefined"!=typeof window&&void 0!==window.document)return e;postMessage(e)},n=function(e,t){if(null!==this.element){for(var i in this._cnt=e.cnt,o=this._model.data)o.hasOwnProperty(i)&&o[i].state&&o[i].state.loading&&e.mod[i]&&(e.mod[i].state.loading=!0);if(this._model.data=e.mod,t){var r,s=e.add,a=e.sel,n=this._data.core.selected.slice(),o=this._model.data;if(a.length!==n.length||E.vakata.array_unique(a.concat(n)).length!==a.length){for(i=0,r=a.length;i<r;i++)-1===E.inArray(a[i],s)&&-1===E.inArray(a[i],n)&&(o[a[i]].state.selected=!1);for(i=0,r=n.length;i<r;i++)-1===E.inArray(n[i],a)&&(o[n[i]].state.selected=!0)}}e.add.length&&(this._data.core.selected=this._data.core.selected.concat(e.add)),this.trigger("model",{nodes:e.dpc,parent:e.par}),e.par!==E.jstree.root?(this._node_changed(e.par),this.redraw()):this.redraw(!0),e.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),!t&&f?f(function(){d.call(m,!0)}):d.call(m,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+a.toString()],{type:"text/javascript"}))),!this._data.core.working||i?(this._data.core.working=!0,(r=new window.Worker(this._wrk)).onmessage=function(e){n.call(this,e.data,!0);try{r.terminate(),r=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}.bind(this),s.par?r.postMessage(s):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([e,t,d,!0])}catch(e){n.call(this,a(s),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else n.call(this,a(s),!1)}},_parse_model_from_html:function(e,t,i){i=i?[].concat(i):[],t&&i.unshift(t);var r,s,a,n,o=this._model.data,d={id:!1,text:!1,icon:!0,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in this._model.default_state)this._model.default_state.hasOwnProperty(a)&&(d.state[a]=this._model.default_state[a]);if(t=E.vakata.attributes(e,!0),E.each(t,function(e,t){if(!(t=E.vakata.trim(t)).length)return!0;d.li_attr[e]=t,"id"===e&&(d.id=t.toString())}),(t=e.children("a").first()).length&&(t=E.vakata.attributes(t,!0),E.each(t,function(e,t){(t=E.vakata.trim(t)).length&&(d.a_attr[e]=t)})),(t=(e.children("a").first().length?e.children("a").first():e).clone()).children("ins, i, ul").remove(),t=t.html(),t=E("<div></div>").html(t),d.text=this.settings.core.force_text?t.text():t.html(),t=e.data(),d.data=t?E.extend(!0,{},t):null,d.state.opened=e.hasClass("jstree-open"),d.state.selected=e.children("a").hasClass("jstree-clicked"),d.state.disabled=e.children("a").hasClass("jstree-disabled"),d.data&&d.data.jstree)for(a in d.data.jstree)d.data.jstree.hasOwnProperty(a)&&(d.state[a]=d.data.jstree[a]);for((t=e.children("a").children(".jstree-themeicon")).length&&(d.icon=!t.hasClass("jstree-themeicon-hidden")&&t.attr("rel")),d.state.icon!==P&&(d.icon=d.state.icon),d.icon!==P&&null!==d.icon&&""!==d.icon||(d.icon=!0),t=e.children("ul").children("li");o[n="j"+this._id+"_"+ ++this._cnt];);return d.id=d.li_attr.id?d.li_attr.id.toString():n,t.length?(t.each(function(e,t){r=this._parse_model_from_html(E(t),d.id,i),s=this._model.data[r],d.children.push(r),s.children_d.length&&(d.children_d=d.children_d.concat(s.children_d))}.bind(this)),d.children_d=d.children_d.concat(d.children)):e.hasClass("jstree-closed")&&(d.state.loaded=!1),d.li_attr.class&&(d.li_attr.class=d.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),d.a_attr.class&&(d.a_attr.class=d.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),(o[d.id]=d).state.selected&&this._data.core.selected.push(d.id),d.id},_parse_model_from_flat_json:function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);var r,s,a,n,o=e.id.toString(),d=this._model.data,c=this._model.default_state,l={id:o,text:e.text||"",icon:e.icon===P||e.icon,parent:t,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in c)c.hasOwnProperty(r)&&(l.state[r]=c[r]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==P&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(l.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(l.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(l.li_attr[r]=e.li_attr[r]);if(l.li_attr.id||(l.li_attr.id=o),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(l.a_attr[r]=e.a_attr[r]);for(e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),r=0,s=(d[l.id]=l).children.length;r<s;r++)n=d[a=this._parse_model_from_flat_json(d[l.children[r]],l.id,i)],l.children_d.push(a),n.children_d.length&&(l.children_d=l.children_d.concat(n.children_d));return delete e.data,delete e.children,d[l.id].original=e,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_json:function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);for(var r,s,a,n,o,d=!1,c=this._model.data,l=this._model.default_state;c[d="j"+this._id+"_"+ ++this._cnt];);for(r in o={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===P||e.icon,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},l)l.hasOwnProperty(r)&&(o.state[r]=l[r]);if(e&&e.id&&(o.id=e.id.toString()),e&&e.text&&(o.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(o.icon=e.data.jstree.icon),o.icon!==P&&null!==o.icon&&""!==o.icon||(o.icon=!0),e&&e.data&&(o.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(o.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(o.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(o.li_attr[r]=e.li_attr[r]);if(o.li_attr.id&&!o.id&&(o.id=o.li_attr.id.toString()),o.id||(o.id=d),o.li_attr.id||(o.li_attr.id=o.id),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(o.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,s=e.children.length;r<s;r++)n=c[a=this._parse_model_from_json(e.children[r],o.id,i)],o.children.push(a),n.children_d.length&&(o.children_d=o.children_d.concat(n.children_d));o.children_d=o.children.concat(o.children_d)}return e&&e.children&&!0===e.children&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete e.data,delete e.children,o.original=e,(c[o.id]=o).state.selected&&this._data.core.selected.push(o.id),o.id},_redraw:function(){for(var e,t=(this._model.force_full_redraw?this._model.data[E.jstree.root].children:this._model.changed).concat([]),i=v.createElement("UL"),r=this._data.core.focused,s=0,a=t.length;s<a;s++)(e=this.redraw_node(t[s],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&i.appendChild(e);this._model.force_full_redraw&&(i.className=this.get_container_ul()[0].className,i.setAttribute("role","group"),this.element.empty().append(i)),null!==r&&this.settings.core.restore_focus&&((e=this.get_node(r,!0))&&e.length&&e.children(".jstree-anchor")[0]!==v.activeElement?e.children(".jstree-anchor").trigger("focus"):this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:t})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(e){var t,i=this.get_node(e),r=!1,s=!1,a=v;if(!i)return!1;if(i.id===E.jstree.root)return this.redraw(!0);if(!(e=this.get_node(e,!0))||!e.length)return!1;if(e.children(".jstree-children").remove(),e=e[0],i.children.length&&i.state.loaded){for((s=a.createElement("UL")).setAttribute("role","group"),s.className="jstree-children",r=0,t=i.children.length;r<t;r++)s.appendChild(this.redraw_node(i.children[r],!0,!0));e.appendChild(s)}},redraw_node:function(e,t,i,r){var s=this.get_node(e),a=!1,n=!1,o=!1,d=!1,c=!1,l=!1,h="",_=v,g=this._model.data,u=!1,f=null,p=!1,m=!1;if(!s)return!1;if(s.id===E.jstree.root)return this.redraw(!0);if(t=t||0===s.children.length,e=v.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(s.id[0])?"\\3"+s.id[0]+" "+s.id.substr(1).replace(E.jstree.idregex,"\\$&"):s.id.replace(E.jstree.idregex,"\\$&"))):v.getElementById(s.id))e=E(e),i||((a=e.parent().parent()[0])===this.element[0]&&(a=null),n=e.index()),(t=t||!s.children.length||e.children(".jstree-children").length?t:!0)||(o=e.children(".jstree-children")[0]),u=e.children(".jstree-anchor")[0]===v.activeElement,e.remove();else if(t=!0,!i){if(!(null===(a=s.parent!==E.jstree.root?E("#"+s.parent.replace(E.jstree.idregex,"\\$&"),this.element)[0]:null)||a&&g[s.parent].state.opened))return!1;n=E.inArray(s.id,(null===a?g[E.jstree.root]:g[s.parent]).children)}for(d in e=this._data.core.node.cloneNode(!0),h="jstree-node ",s.li_attr)s.li_attr.hasOwnProperty(d)&&"id"!==d&&("class"!==d?e.setAttribute(d,s.li_attr[d]):h+=s.li_attr[d]);for(s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),e.childNodes[1].setAttribute("aria-selected",!!s.state.selected),e.childNodes[1].setAttribute("aria-level",s.parents.length),this.settings.core.compute_elements_positions&&(e.childNodes[1].setAttribute("aria-setsize",g[s.parent].children.length),e.childNodes[1].setAttribute("aria-posinset",g[s.parent].children.indexOf(s.id)+1)),s.state.disabled&&e.childNodes[1].setAttribute("aria-disabled",!0),d=0,c=s.children.length;d<c;d++)if(!g[s.children[d]].state.hidden){p=!0;break}if(null!==s.parent&&g[s.parent]&&!s.state.hidden&&(d=E.inArray(s.id,g[s.parent].children),m=s.id,-1!==d))for(d++,c=g[s.parent].children.length;d<c&&(m=g[g[s.parent].children[d]].state.hidden?m:g[s.parent].children[d])===s.id;d++);for(c in s.state.hidden&&(h+=" jstree-hidden"),s.state.loading&&(h+=" jstree-loading"),s.state.loaded&&!p?h+=" jstree-leaf":(h+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",e.childNodes[1].setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),m===s.id&&(h+=" jstree-last"),e.id=s.id,e.className=h,h=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":""),s.a_attr)!s.a_attr.hasOwnProperty(c)||"href"===c&&"#"===s.a_attr[c]||("class"!==c?e.childNodes[1].setAttribute(c,s.a_attr[c]):h+=" "+s.a_attr[c]);if(h.length&&(e.childNodes[1].className="jstree-anchor "+h),(s.icon&&!0!==s.icon||!1===s.icon)&&(!1===s.icon?e.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===s.icon.indexOf("/")&&-1===s.icon.indexOf(".")?e.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(e.childNodes[1].childNodes[0].style.backgroundImage='url("'+s.icon+'")',e.childNodes[1].childNodes[0].style.backgroundPosition="center center",e.childNodes[1].childNodes[0].style.backgroundSize="auto",e.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?e.childNodes[1].appendChild(_.createTextNode(s.text)):e.childNodes[1].innerHTML+=s.text,t&&s.children.length&&(s.state.opened||r)&&s.state.loaded){for((l=_.createElement("UL")).setAttribute("role","group"),l.className="jstree-children",d=0,c=s.children.length;d<c;d++)l.appendChild(this.redraw_node(s.children[d],t,!0));e.appendChild(l)}if(o&&e.appendChild(o),!i){for(d=0,c=(a=a||this.element[0]).childNodes.length;d<c;d++)if(a.childNodes[d]&&a.childNodes[d].className&&-1!==a.childNodes[d].className.indexOf("jstree-children")){f=a.childNodes[d];break}f||((f=_.createElement("UL")).setAttribute("role","group"),f.className="jstree-children",a.appendChild(f)),n<(a=f).childNodes.length?a.insertBefore(e,a.childNodes[n]):a.appendChild(e),u&&(r=this.element[0].scrollTop,o=this.element[0].scrollLeft,e.childNodes[1].focus(),this.element[0].scrollTop=r,this.element[0].scrollLeft=o)}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(function(){this.open_node(s.id,!1,0)}.bind(this),0)),e},open_node:function(e,i,r){var t,s,a,n;if(E.vakata.is_array(e)){for(t=0,s=(e=e.slice()).length;t<s;t++)this.open_node(e[t],i,r);return!0}return!(!(e=this.get_node(e))||e.id===E.jstree.root)&&(r=r===P?this.settings.core.animation:r,this.is_closed(e)?this.is_loaded(e)?(a=this.get_node(e,!0),n=this,a.length&&(r&&a.children(".jstree-children").length&&a.children(".jstree-children").stop(!0,!0),e.children.length&&!this._firstChild(a.children(".jstree-children")[0])&&this.draw_children(e),r?(this.trigger("before_open",{node:e}),a.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children(".jstree-anchor").attr("aria-expanded",!0).end().children(".jstree-children").stop(!0,!0).slideDown(r,function(){this.style.display="",n.element&&n.trigger("after_open",{node:e})})):(this.trigger("before_open",{node:e}),a[0].className=a[0].className.replace("jstree-closed","jstree-open"),a[0].childNodes[1].setAttribute("aria-expanded",!0))),e.state.opened=!0,i&&i.call(this,e,!0),a.length||this.trigger("before_open",{node:e}),this.trigger("open_node",{node:e}),r&&a.length||this.trigger("after_open",{node:e}),!0):this.is_loading(e)?setTimeout(function(){this.open_node(e,i,r)}.bind(this),500):void this.load_node(e,function(e,t){return t?this.open_node(e,i,r):!!i&&i.call(this,e,!1)}):(i&&i.call(this,e,!1),!1))},_open_to:function(e){if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;for(var t=e.parents,i=0,r=t.length;i<r;i+=1)i!==E.jstree.root&&this.open_node(t[i],!1,0);return E("#"+e.id.replace(E.jstree.idregex,"\\$&"),this.element)},close_node:function(e,t){var i,r,s,a;if(E.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.close_node(e[i],t);return!0}return!(!(e=this.get_node(e))||e.id===E.jstree.root||this.is_closed(e))&&(t=t===P?this.settings.core.animation:t,a=(s=this).get_node(e,!0),e.state.opened=!1,this.trigger("close_node",{node:e}),void(a.length?t?a.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children(".jstree-anchor").attr("aria-expanded",!1).end().children(".jstree-children").stop(!0,!0).slideUp(t,function(){this.style.display="",a.children(".jstree-children").remove(),s.element&&s.trigger("after_close",{node:e})}):(a[0].className=a[0].className.replace("jstree-open","jstree-closed"),a.children(".jstree-anchor").attr("aria-expanded",!1),a.children(".jstree-children").remove(),this.trigger("after_close",{node:e})):this.trigger("after_close",{node:e})))},toggle_node:function(e){var t,i;if(E.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.toggle_node(e[t]);return!0}return this.is_closed(e)?this.open_node(e):this.is_open(e)?this.close_node(e):void 0},open_all:function(e,i,r){if(e=e||E.jstree.root,!(e=this.get_node(e)))return!1;var t,s,a,n=e.id===E.jstree.root?this.get_container_ul():this.get_node(e,!0);if(!n.length){for(t=0,s=e.children_d.length;t<s;t++)this.is_closed(this._model.data[e.children_d[t]])&&(this._model.data[e.children_d[t]].state.opened=!0);return this.trigger("open_all",{node:e})}r=r||n,(n=(a=this).is_closed(e)?n.find(".jstree-closed").addBack():n.find(".jstree-closed")).each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,i,r)},i||0)}),0===r.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(r)})},close_all:function(e,t){if(e=e||E.jstree.root,!(e=this.get_node(e)))return!1;var i,r,s=e.id===E.jstree.root?this.get_container_ul():this.get_node(e,!0),a=this;for(s.length&&(s=this.is_open(e)?s.find(".jstree-open").addBack():s.find(".jstree-open"),E(s.get().reverse()).each(function(){a.close_node(this,t||0)})),i=0,r=e.children_d.length;i<r;i++)this._model.data[e.children_d[i]].state.opened=!1;this.trigger("close_all",{node:e})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(e){var t,i;if(E.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.enable_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;e.state.disabled=!1,this.get_node(e,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:e})},disable_node:function(e){var t,i;if(E.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.disable_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;e.state.disabled=!0,this.get_node(e,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:e})},is_hidden:function(e){return!0===(e=this.get_node(e)).state.hidden},hide_node:function(e,t){var i,r;if(E.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.hide_node(e[i],!0);return t||this.redraw(),!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;e.state.hidden||(e.state.hidden=!0,this._node_changed(e.parent),t||this.redraw(),this.trigger("hide_node",{node:e}))},show_node:function(e,t){var i,r;if(E.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.show_node(e[i],!0);return t||this.redraw(),!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;e.state.hidden&&(e.state.hidden=!1,this._node_changed(e.parent),t||this.redraw(),this.trigger("show_node",{node:e}))},hide_all:function(e){var t,i=this._model.data,r=[];for(t in i)i.hasOwnProperty(t)&&t!==E.jstree.root&&!i[t].state.hidden&&(i[t].state.hidden=!0,r.push(t));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("hide_all",{nodes:r}),r},show_all:function(e){var t,i=this._model.data,r=[];for(t in i)i.hasOwnProperty(t)&&t!==E.jstree.root&&i[t].state.hidden&&(i[t].state.hidden=!1,r.push(t));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("show_all",{nodes:r}),r},activate_node:function(e,t){if(this.is_disabled(e))return!1;if(t&&"object"==typeof t||(t={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==P?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&(!t.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(t.shiftKey){for(var i=this.get_node(e).id,r=this._data.core.last_clicked.id,s=this.get_node(this._data.core.last_clicked.parent).children,a=!1,n=0,o=s.length;n<o;n+=1)s[n]===i&&(a=!a),s[n]===r&&(a=!a),this.is_disabled(s[n])||!a&&s[n]!==i&&s[n]!==r?this.deselect_node(s[n],!0,t):this.is_hidden(s[n])||this.select_node(s[n],!0,!1,t);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:t})}else this.is_selected(e)?this.deselect_node(e,!1,t):this.select_node(e,!1,!1,t);else!this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,t):(this.deselect_all(!0),this.select_node(e,!1,!1,t),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:t})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(e,t,i,r){var s,a,n;if(E.vakata.is_array(e)){for(a=0,n=(e=e.slice()).length;a<n;a++)this.select_node(e[a],t,i,r);return!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;s=this.get_node(e,!0),e.state.selected||(e.state.selected=!0,this._data.core.selected.push(e.id),(s=i?s:this._open_to(e))&&s.length&&s.children(".jstree-anchor").addClass("jstree-clicked").attr("aria-selected",!0),this.trigger("select_node",{node:e,selected:this._data.core.selected,event:r}),t)||this.trigger("changed",{action:"select_node",node:e,selected:this._data.core.selected,event:r})},deselect_node:function(e,t,i){var r,s,a;if(E.vakata.is_array(e)){for(r=0,s=(e=e.slice()).length;r<s;r++)this.deselect_node(e[r],t,i);return!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;a=this.get_node(e,!0),e.state.selected&&(e.state.selected=!1,this._data.core.selected=E.vakata.array_remove_item(this._data.core.selected,e.id),a.length&&a.children(".jstree-anchor").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_node",{node:e,selected:this._data.core.selected,event:i}),t||this.trigger("changed",{action:"deselect_node",node:e,selected:this._data.core.selected,event:i}))},select_all:function(e){var t,i,r=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[E.jstree.root].children_d.concat(),t=0,i=this._data.core.selected.length;t<i;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:r})},deselect_all:function(e){for(var t=this._data.core.selected.concat([]),i=0,r=this._data.core.selected.length;i<r;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:t}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:t})},is_selected:function(e){return!(!(e=this.get_node(e))||e.id===E.jstree.root)&&e.state.selected},get_selected:function(e){return e?E.map(this._data.core.selected,function(e){return this.get_node(e)}.bind(this)):this._data.core.selected.slice()},get_top_selected:function(e){for(var t,i,r=this.get_selected(!0),s={},a=0,n=r.length;a<n;a++)s[r[a].id]=r[a];for(a=0,n=r.length;a<n;a++)for(t=0,i=r[a].children_d.length;t<i;t++)s[r[a].children_d[t]]&&delete s[r[a].children_d[t]];for(a in r=[],s)s.hasOwnProperty(a)&&r.push(a);return e?E.map(r,function(e){return this.get_node(e)}.bind(this)):r},get_bottom_selected:function(e){for(var t=this.get_selected(!0),i=[],r=0,s=t.length;r<s;r++)t[r].children.length||i.push(t[r].id);return e?E.map(i,function(e){return this.get_node(e)}.bind(this)):i},get_state:function(){var e,t={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(e in this._model.data)this._model.data.hasOwnProperty(e)&&e!==E.jstree.root&&(this._model.data[e].state.loaded&&this.settings.core.loaded_state&&t.core.loaded.push(e),this._model.data[e].state.opened&&t.core.open.push(e),this._model.data[e].state.selected)&&t.core.selected.push(e);return t},set_state:function(t,i){if(t){if(t.core&&t.core.selected&&t.core.initial_selection===P&&(t.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),t.core){var r,e;if(t.core.loaded)return this.settings.core.loaded_state&&E.vakata.is_array(t.core.loaded)&&t.core.loaded.length?this._load_nodes(t.core.loaded,function(e){delete t.core.loaded,this.set_state(t,i)}):(delete t.core.loaded,this.set_state(t,i)),!1;if(t.core.open)return E.vakata.is_array(t.core.open)&&t.core.open.length?this._load_nodes(t.core.open,function(e){this.open_node(e,!1,0),delete t.core.open,this.set_state(t,i)}):(delete t.core.open,this.set_state(t,i)),!1;if(t.core.scroll)return t.core.scroll&&t.core.scroll.left!==P&&this.element.scrollLeft(t.core.scroll.left),t.core.scroll&&t.core.scroll.top!==P&&this.element.scrollTop(t.core.scroll.top),delete t.core.scroll,this.set_state(t,i),!1;if(t.core.selected)return r=this,t.core.initial_selection!==P&&t.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),E.each(t.core.selected,function(e,t){r.select_node(t,!1,!0)})),delete t.core.initial_selection,delete t.core.selected,this.set_state(t,i),!1;for(e in t)t.hasOwnProperty(e)&&"core"!==e&&-1===E.inArray(e,this.settings.plugins)&&delete t[e];if(E.isEmptyObject(t.core))return delete t.core,this.set_state(t,i),!1}return E.isEmptyObject(t)?(t=null,i&&i.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(e,t){this._data.core.state=!0===t?{}:this.get_state(),t&&E.vakata.is_function(t)&&(this._data.core.state=t.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[E.jstree.root]={id:E.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var i=this.get_container_ul()[0].className;e||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(E.jstree.root,function(e,t){t&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(E.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===E.jstree.root)return!1;var i=[],e=[],r=this._data.core.selected.concat([]);e.push(t.id),!0===t.state.opened&&i.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){e.push(this.id),i.push(this.id)}),this._load_nodes(e,function(e){this.open_node(i,!1,0),this.select_node(r),this.trigger("refresh_node",{node:t,nodes:e})}.bind(this),!1,!0)},set_id:function(e,t){if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;var i,r,s=this._model.data,a=e.id;for(t=t.toString(),s[e.parent].children[E.inArray(e.id,s[e.parent].children)]=t,i=0,r=e.parents.length;i<r;i++)s[e.parents[i]].children_d[E.inArray(e.id,s[e.parents[i]].children_d)]=t;for(i=0,r=e.children.length;i<r;i++)s[e.children[i]].parent=t;for(i=0,r=e.children_d.length;i<r;i++)s[e.children_d[i]].parents[E.inArray(e.id,s[e.children_d[i]].parents)]=t;return-1!==(i=E.inArray(e.id,this._data.core.selected))&&(this._data.core.selected[i]=t),(i=this.get_node(e.id,!0))&&(i.attr("id",t),this.element.attr("aria-activedescendant")===e.id)&&this.element.attr("aria-activedescendant",t),delete s[e.id],e.id=t,s[e.li_attr.id=t]=e,this.trigger("set_id",{node:e,new:e.id,old:a}),!0},get_text:function(e){return!(!(e=this.get_node(e))||e.id===E.jstree.root)&&e.text},set_text:function(e,t){var i,r;if(E.vakata.is_array(e))for(i=0,r=(e=e.slice()).length;i<r;i++)this.set_text(e[i],t);else{if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;e.text=t,this.get_node(e,!0).length&&this.redraw_node(e.id),this.trigger("set_text",{obj:e,text:t})}return!0},get_json:function(e,t,i){if(!(e=this.get_node(e||E.jstree.root)))return!1;t&&t.flat&&!i&&(i=[]);var r,s,a={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:E.extend(!0,{},e.li_attr),a_attr:E.extend(!0,{},e.a_attr),state:{},data:(!t||!t.no_data)&&E.extend(!0,E.vakata.is_array(e.data)?[]:{},e.data)};if(t&&t.flat?a.parent=e.parent:a.children=[],t&&t.no_state)delete a.state;else for(r in e.state)e.state.hasOwnProperty(r)&&(a.state[r]=e.state[r]);if(t&&t.no_li_attr&&delete a.li_attr,t&&t.no_a_attr&&delete a.a_attr,t&&t.no_id&&(delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr)&&a.a_attr.id&&delete a.a_attr.id,t&&t.flat&&e.id!==E.jstree.root&&i.push(a),!t||!t.no_children)for(r=0,s=e.children.length;r<s;r++)t&&t.flat?this.get_json(e.children[r],t,i):a.children.push(this.get_json(e.children[r],t));return t&&t.flat?i:e.id===E.jstree.root?a.children:a},create_node:function(e,t,i,r,s){if(null===e&&(e=E.jstree.root),!(e=this.get_node(e)))return!1;if(!(i=i===P?"last":i).toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(e))return this.load_node(e,function(){this.create_node(e,t,i,r,!0)});var a,n,o,d;switch((t="string"==typeof(t=t||{text:this.get_string("New node")})?{text:t}:E.extend(!0,{},t)).text===P&&(t.text=this.get_string("New node")),i=e.id===E.jstree.root&&"after"===(i="before"===i?"first":i)?"last":i){case"before":a=this.get_node(e.parent),i=E.inArray(e.id,a.children),e=a;break;case"after":a=this.get_node(e.parent),i=E.inArray(e.id,a.children)+1,e=a;break;case"inside":case"first":i=0;break;case"last":i=e.children.length;break;default:i=i||0}if(i>e.children.length&&(i=e.children.length),t.id||(t.id=!0),!this.check("create_node",t,e,i))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===t.id&&delete t.id,!(t=this._parse_model_from_json(t,e.id,e.parents.concat())))return!1;for(a=this.get_node(t),(n=[]).push(t),n=n.concat(a.children_d),this.trigger("model",{nodes:n,parent:e.id}),e.children_d=e.children_d.concat(n),o=0,d=e.parents.length;o<d;o++)this._model.data[e.parents[o]].children_d=this._model.data[e.parents[o]].children_d.concat(n);for(t=a,a=[],o=0,d=e.children.length;o<d;o++)a[i<=o?o+1:o]=e.children[o];return a[i]=t.id,e.children=a,this.redraw_node(e,!0),this.trigger("create_node",{node:this.get_node(t),parent:e.id,position:i}),r&&r.call(this,this.get_node(t)),t.id},rename_node:function(e,t){var i,r,s;if(E.vakata.is_array(e))for(i=0,r=(e=e.slice()).length;i<r;i++)this.rename_node(e[i],t);else{if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;if(s=e.text,!this.check("rename_node",e,this.get_parent(e),t))return this.settings.core.error.call(this,this._data.core.last_error),!1;this.set_text(e,t),this.trigger("rename_node",{node:e,text:t,old:s})}return!0},delete_node:function(e){var t,i,r,s,a,n,o,d,c,l,h;if(E.vakata.is_array(e))for(t=0,i=(e=e.slice()).length;t<i;t++)this.delete_node(e[t]);else{if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;if(r=this.get_node(e.parent),l=E.inArray(e.id,r.children),c=!1,!this.check("delete_node",e,r,l))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==l&&(r.children=E.vakata.array_remove(r.children,l)),(s=e.children_d.concat([])).push(e.id),a=0,n=e.parents.length;a<n;a++)this._model.data[e.parents[a]].children_d=E.vakata.array_filter(this._model.data[e.parents[a]].children_d,function(e){return-1===E.inArray(e,s)});for(o=0,d=s.length;o<d;o++)if(this._model.data[s[o]].state.selected){c=!0;break}for(c&&(this._data.core.selected=E.vakata.array_filter(this._data.core.selected,function(e){return-1===E.inArray(e,s)})),this.trigger("delete_node",{node:e,parent:r.id}),c&&this.trigger("changed",{action:"delete_node",node:e,selected:this._data.core.selected,parent:r.id}),o=0,d=s.length;o<d;o++)delete this._model.data[s[o]];-1!==E.inArray(this._data.core.focused,s)&&(this._data.core.focused=null,l=this.element[0].scrollTop,h=this.element[0].scrollLeft,r.id===E.jstree.root?this._model.data[E.jstree.root].children[0]&&this.get_node(this._model.data[E.jstree.root].children[0],!0).children(".jstree-anchor").triger("focus"):this.get_node(r,!0).children(".jstree-anchor").trigger("focus"),this.element[0].scrollTop=l,this.element[0].scrollLeft=h),this.redraw_node(r,!0)}return!0},check:function(e,t,i,r,s){t=t&&t.id?t:this.get_node(t),i=i&&i.id?i:this.get_node(i);var a=e.match(/^move_node|copy_node|create_node$/i)?i:t,n=this.settings.core.check_callback;if("move_node"===e||"copy_node"===e){if(!(s&&s.is_multi||"move_node"!==e||E.inArray(t.id,i.children)!==r))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})});if(!(s&&s.is_multi||t.id!==i.id&&("move_node"!==e||E.inArray(t.id,i.children)!==r)&&-1===E.inArray(i.id,t.children_d)))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})})}return(a=a&&a.data?a.data:a)&&a.functions&&(!1===a.functions[e]||!0===a.functions[e])?(!1===a.functions[e]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),a.functions[e]):!(!1===n||E.vakata.is_function(n)&&!1===n.call(this,e,t,i,r,s)||n&&!1===n[e])||!(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})})},last_error:function(){return this._data.core.last_error},move_node:function(e,t,i,r,s,a,n){var o,d,c,l,h,_,g,u,f,p,m,v,j,k;if(t=this.get_node(t),i=i===P?0:i,!t)return!1;if(!i.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(t))return this.load_node(t,function(){this.move_node(e,t,i,r,!0,!1,n)});if(E.vakata.is_array(e)){if(1!==e.length){for(o=0,d=e.length;o<d;o++)(f=this.move_node(e[o],t,i,r,s,!1,n))&&(t=f,i="after");return this.redraw(),!0}e=e[0]}if(!(e=e&&e.id?e:this.get_node(e))||e.id===E.jstree.root)return!1;if(c=(e.parent||E.jstree.root).toString(),h=i.toString().match(/^(before|after)$/)&&t.id!==E.jstree.root?this.get_node(t.parent):t,g=!(_=n||(this._model.data[e.id]?this:E.jstree.reference(e.id)))||!_._id||this._id!==_._id,l=_&&_._id&&c&&_._model.data[c]&&_._model.data[c].children?E.inArray(e.id,_._model.data[c].children):-1,_&&_._id&&(e=_._model.data[e.id]),g)return!!(f=this.copy_node(e,t,i,r,s,!1,n))&&(_&&_.delete_node(e),f);switch(i=t.id===E.jstree.root&&"after"===(i="before"===i?"first":i)?"last":i){case"before":i=E.inArray(t.id,h.children);break;case"after":i=E.inArray(t.id,h.children)+1;break;case"inside":case"first":i=0;break;case"last":i=h.children.length;break;default:i=i||0}if(i>h.children.length&&(i=h.children.length),!this.check("move_node",e,h,i,{core:!0,origin:n,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(e.parent===h.id){for(u=h.children.concat(),-1!==(f=E.inArray(e.id,u))&&(u=E.vakata.array_remove(u,f),f<i)&&i--,f=[],p=0,m=u.length;p<m;p++)f[i<=p?p+1:p]=u[p];f[i]=e.id,h.children=f,this._node_changed(h.id),this.redraw(h.id===E.jstree.root)}else{for((f=e.children_d.concat()).push(e.id),p=0,m=e.parents.length;p<m;p++){for(u=[],v=0,j=(k=_._model.data[e.parents[p]].children_d).length;v<j;v++)-1===E.inArray(k[v],f)&&u.push(k[v]);_._model.data[e.parents[p]].children_d=u}for(_._model.data[c].children=E.vakata.array_remove_item(_._model.data[c].children,e.id),p=0,m=h.parents.length;p<m;p++)this._model.data[h.parents[p]].children_d=this._model.data[h.parents[p]].children_d.concat(f);for(u=[],p=0,m=h.children.length;p<m;p++)u[i<=p?p+1:p]=h.children[p];for(u[i]=e.id,h.children=u,h.children_d.push(e.id),h.children_d=h.children_d.concat(e.children_d),e.parent=h.id,(f=h.parents.concat()).unshift(h.id),k=e.parents.length,f=(e.parents=f).concat(),p=0,m=e.children_d.length;p<m;p++)this._model.data[e.children_d[p]].parents=this._model.data[e.children_d[p]].parents.slice(0,-1*k),Array.prototype.push.apply(this._model.data[e.children_d[p]].parents,f);c!==E.jstree.root&&h.id!==E.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(c),this._node_changed(h.id)),a||this.redraw()}return r&&r.call(this,e,h,i),this.trigger("move_node",{node:e,parent:h.id,position:i,old_parent:c,old_position:l,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id,old_instance:_,new_instance:this}),e.id},copy_node:function(e,t,i,r,s,a,n){var o,d,c,l,h,_,g,u,f,p;if(t=this.get_node(t),i=i===P?0:i,!t)return!1;if(!i.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(t))return this.load_node(t,function(){this.copy_node(e,t,i,r,!0,!1,n)});if(E.vakata.is_array(e)){if(1!==e.length){for(o=0,d=e.length;o<d;o++)(l=this.copy_node(e[o],t,i,r,s,!0,n))&&(t=l,i="after");return this.redraw(),!0}e=e[0]}if(!(e=e&&e.id?e:this.get_node(e))||e.id===E.jstree.root)return!1;switch(u=(e.parent||E.jstree.root).toString(),f=i.toString().match(/^(before|after)$/)&&t.id!==E.jstree.root?this.get_node(t.parent):t,(p=n||(this._model.data[e.id]?this:E.jstree.reference(e.id)))&&p._id&&(this._id,p._id),p&&p._id&&(e=p._model.data[e.id]),i=t.id===E.jstree.root&&"after"===(i="before"===i?"first":i)?"last":i){case"before":i=E.inArray(t.id,f.children);break;case"after":i=E.inArray(t.id,f.children)+1;break;case"inside":case"first":i=0;break;case"last":i=f.children.length;break;default:i=i||0}if(i>f.children.length&&(i=f.children.length),!this.check("copy_node",e,f,i,{core:!0,origin:n,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(g=p?p.get_json(e,{no_id:!0,no_data:!0,no_state:!0}):e))return!1;if(!0===g.id&&delete g.id,!(g=this._parse_model_from_json(g,f.id,f.parents.concat())))return!1;for(l=this.get_node(g),e&&e.state&&!1===e.state.loaded&&(l.state.loaded=!1),(c=[]).push(g),c=c.concat(l.children_d),this.trigger("model",{nodes:c,parent:f.id}),h=0,_=f.parents.length;h<_;h++)this._model.data[f.parents[h]].children_d=this._model.data[f.parents[h]].children_d.concat(c);for(c=[],h=0,_=f.children.length;h<_;h++)c[i<=h?h+1:h]=f.children[h];return c[i]=l.id,f.children=c,f.children_d.push(l.id),f.children_d=f.children_d.concat(l.children_d),f.id===E.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(f.id),a||this.redraw(f.id===E.jstree.root),r&&r.call(this,l,f,i),this.trigger("copy_node",{node:l,original:e,parent:f.id,position:i,old_parent:u,old_position:p&&p._id&&u&&p._model.data[u]&&p._model.data[u].children?E.inArray(e.id,p._model.data[u].children):-1,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id,old_instance:p,new_instance:this}),l.id},cut:function(e){if(e=e||this._data.core.selected.concat(),!(e=E.vakata.is_array(e)?e:[e]).length)return!1;for(var t,i=[],r=0,s=e.length;r<s;r++)(t=this.get_node(e[r]))&&t.id&&t.id!==E.jstree.root&&i.push(t);if(!i.length)return!1;o=i,d="move_node",(c=this).trigger("cut",{node:e})},copy:function(e){if(e=e||this._data.core.selected.concat(),!(e=E.vakata.is_array(e)?e:[e]).length)return!1;for(var t,i=[],r=0,s=e.length;r<s;r++)(t=this.get_node(e[r]))&&t.id&&t.id!==E.jstree.root&&i.push(t);if(!i.length)return!1;o=i,d="copy_node",(c=this).trigger("copy",{node:e})},get_buffer:function(){return{mode:d,node:o,inst:c}},can_paste:function(){return!1!==d&&!1!==o},paste:function(e,t){if(!((e=this.get_node(e))&&d&&d.match(/^(copy_node|move_node)$/)&&o))return!1;this[d](o,e,t,!1,!1,!1,c)&&this.trigger("paste",{parent:e.id,node:o,mode:d}),c=d=o=!1},clear_buffer:function(){c=d=o=!1,this.trigger("clear_buffer")},edit:function(i,e,r){var t,s,a,n,o,d,c,l,h=!1;return!!(i=this.get_node(i))&&(this.check("edit",i,this.get_parent(i))?(l=i,e="string"==typeof e?e:i.text,this.set_text(i,""),i=this._open_to(i),l.text=e,t=this._data.core.rtl,s=this.element.width(),this._data.core.focused=l.id,a=i.children(".jstree-anchor").trigger("focus"),n=E("<span></span>"),o=e,d=E("<div></div>",{css:{position:"absolute",top:"-200px",left:t?"0px":"-1000px",visibility:"hidden"}}).appendTo(v.body),c=E("<input />",{value:o,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:function(e){e.stopImmediatePropagation(),e.preventDefault();var e=n.children(".jstree-rename-input").val(),t=this.settings.core.force_text;""===e&&(e=o),d.remove(),n.replaceWith(a),n.remove(),o=t?o:E("<div></div>").append(E.parseHTML(o)).html(),i=this.get_node(i),this.set_text(i,o),(t=!!this.rename_node(i,t?E("<div></div>").text(e).text():E("<div></div>").append(E.parseHTML(e)).html()))||this.set_text(i,o),this._data.core.focused=l.id,setTimeout(function(){var e=this.get_node(l.id,!0);e.length&&(this._data.core.focused=l.id,e.children(".jstree-anchor").trigger("focus"))}.bind(this),0),r&&r.call(this,l,t,h,e),c=null}.bind(this),keydown:function(e){var t=e.which;27===t&&(h=!0,this.value=o),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){c.width(Math.min(d.text("pW"+this.value).width(),s))},keypress:function(e){if(13===e.which)return!1}}),e={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},n.attr("class",a.attr("class")).append(a.contents().clone()).append(c),a.replaceWith(n),d.css(e),c.css(e).width(Math.min(d.text("pW"+c[0].value).width(),s))[0].select(),void E(v).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(e){c&&e.target!==c&&E(c).trigger("blur")})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(e,t){if(!e)return!1;(t=!0===t?(this.settings.core.themes.dir||E.jstree.path+"/themes")+"/"+e+"/style.css":t)&&-1===E.inArray(t,i)&&(E("head").append('<link rel="stylesheet" href="'+t+'" type="text/css" />'),i.push(t)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=e,this.element.addClass("jstree-"+e),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+e+"-responsive"),this.trigger("set_theme",{theme:e})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),(this._data.core.themes.variant=e)&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(e,t){var i,r,s,a;if(E.vakata.is_array(e))for(i=0,r=(e=e.slice()).length;i<r;i++)this.set_icon(e[i],t);else{if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;a=e.icon,e.icon=!0===t||null===t||t===P||""===t||t,s=this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===t?(s.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"),this.hide_icon(e)):(!0===t||null===t||t===P||""===t?s.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"):(-1===t.indexOf("/")&&-1===t.indexOf(".")?(s.removeClass(a).css("background",""),s.addClass(t+" jstree-themeicon-custom")):(s.removeClass(a).css("background",""),s.addClass("jstree-themeicon-custom").css("background","url('"+t+"') center center no-repeat"))).attr("rel",t),!1===a&&this.show_icon(e))}return!0},get_icon:function(e){return!(!(e=this.get_node(e))||e.id===E.jstree.root)&&e.icon},hide_icon:function(e){var t,i;if(E.vakata.is_array(e))for(t=0,i=(e=e.slice()).length;t<i;t++)this.hide_icon(e[t]);else{if(!(e=this.get_node(e))||e===E.jstree.root)return!1;e.icon=!1,this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden")}return!0},show_icon:function(e){var t,i,r;if(E.vakata.is_array(e))for(t=0,i=(e=e.slice()).length;t<i;t++)this.show_icon(e[t]);else{if(!(e=this.get_node(e))||e===E.jstree.root)return!1;r=this.get_node(e,!0),e.icon=!r.length||r.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),e.icon||(e.icon=!0),r.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden")}return!0}},E.vakata={},E.vakata.attributes=function(e,i){e=E(e)[0];var r=i?{}:[];return e&&e.attributes&&E.each(e.attributes,function(e,t){-1===E.inArray(t.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==t.value&&""!==E.vakata.trim(t.value)&&(i?r[t.name]=t.value:r.push(t.name))}),r},E.vakata.array_unique=function(e){for(var t=[],i={},r=0,s=e.length;r<s;r++)i[e[r]]===P&&(t.push(e[r]),i[e[r]]=!0);return t},E.vakata.array_remove=function(e,t){return e.splice(t,1),e},E.vakata.array_remove_item=function(e,t){t=E.inArray(t,e);return-1!==t?E.vakata.array_remove(e,t):e},E.vakata.array_filter=function(e,t,i,r,s){if(e.filter)return e.filter(t,i);for(s in r=[],e)~~s+""==s+""&&0<=s&&t.call(i,e[s],+s,e)&&r.push(e[s]);return r},E.vakata.trim=function(e){return String.prototype.trim?String.prototype.trim.call(e.toString()):e.toString().replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},E.vakata.is_function=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},E.vakata.is_array=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Function.prototype.bind||(Function.prototype.bind=function(){var t=this,i=arguments[0],r=Array.prototype.slice.call(arguments,1);if("function"!=typeof t)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");return function(){var e=r.concat(Array.prototype.slice.call(arguments));return t.apply(i,e)}}),E.jstree.plugins.changed=function(e,a){var n=[];this.trigger=function(e,t){if(t=t||{},"changed"===e.replace(".jstree","")){t.changed={selected:[],deselected:[]};for(var i={},r=0,s=n.length;r<s;r++)i[n[r]]=1;for(r=0,s=t.selected.length;r<s;r++)i[t.selected[r]]?i[t.selected[r]]=2:t.changed.selected.push(t.selected[r]);for(r=0,s=n.length;r<s;r++)1===i[n[r]]&&t.changed.deselected.push(n[r]);n=t.selected.slice()}a.trigger.call(this,e,t)},this.refresh=function(e,t){return n=[],a.refresh.apply(this,arguments)}},v.createElement("I")),j=(m.className="jstree-icon jstree-checkbox",m.setAttribute("role","presentation"),E.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},E.jstree.plugins.checkbox=function(e,d){this.bind=function(){d.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")}.bind(this)).on("loading.jstree",function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()}.bind(this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)}.bind(this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",function(e,t){for(var i=this._model.data,r=(i[t.parent],t.nodes),s=0,a=r.length;s<a;s++)i[r[s]].state.checked=i[r[s]].state.checked||i[r[s]].original&&i[r[s]].original.state&&i[r[s]].original.state.checked,i[r[s]].state.checked&&this._data.checkbox.selected.push(r[s])}.bind(this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",function(e,t){var i,r,s,a,n,o,d=this._model.data,c=d[t.parent],l=t.nodes,h=[],t=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection;if(-1!==t.indexOf("down"))if(c.state[_?"selected":"checked"]){for(r=0,s=l.length;r<s;r++)d[l[r]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(l)}else for(r=0,s=l.length;r<s;r++)if(d[l[r]].state[_?"selected":"checked"]){for(a=0,n=d[l[r]].children_d.length;a<n;a++)d[d[l[r]].children_d[a]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(d[l[r]].children_d)}if(-1!==t.indexOf("up")){for(r=0,s=c.children_d.length;r<s;r++)d[c.children_d[r]].children.length||h.push(d[c.children_d[r]].parent);for(a=0,n=(h=E.vakata.array_unique(h)).length;a<n;a++)for(c=d[h[a]];c&&c.id!==E.jstree.root;){for(r=i=0,s=c.children.length;r<s;r++)i+=d[c.children[r]].state[_?"selected":"checked"];if(i!==s)break;c.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(c.id),(o=this.get_node(c,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[_?"core":"checkbox"].selected=E.vakata.array_unique(this._data[_?"core":"checkbox"].selected)}.bind(this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",function(e,t){var i,r,t=t.node,s=this._model.data,a=this.get_node(t.parent),n=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection,d={},c=this._data[o?"core":"checkbox"].selected;for(_=0,g=c.length;_<g;_++)d[c[_]]=!0;if(-1!==n.indexOf("down"))for(var l=this._cascade_new_checked_state(t.id,!0),h=t.children_d.concat(t.id),_=0,g=h.length;_<g;_++)-1<l.indexOf(h[_])?d[h[_]]=!0:delete d[h[_]];if(-1!==n.indexOf("up"))for(;a&&a.id!==E.jstree.root;){for(_=i=0,g=a.children.length;_<g;_++)i+=s[a.children[_]].state[o?"selected":"checked"];if(i!==g)break;a.state[o?"selected":"checked"]=!0,d[a.id]=!0,(r=this.get_node(a,!0))&&r.length&&r.attr("aria-selected",!0).children(".jstree-anchor").addClass(o?"jstree-clicked":"jstree-checked"),a=this.get_node(a.parent)}for(_ in c=[],d)d.hasOwnProperty(_)&&c.push(_);this._data[o?"core":"checkbox"].selected=c}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",function(e,t){for(var i,r=this.get_node(E.jstree.root),s=this._model.data,a=0,n=r.children_d.length;a<n;a++)(i=s[r.children_d[a]])&&i.original&&i.original.state&&i.original.state.undetermined&&(i.original.state.undetermined=!1)}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",function(e,t){var i,r,s,a,n=t.node,t=(this.get_node(n,!0),this.settings.checkbox.cascade),o=this.settings.checkbox.tie_selection,d=this._data[o?"core":"checkbox"].selected,c=n.children_d.concat(n.id);if(-1!==t.indexOf("down")&&(a=this._cascade_new_checked_state(n.id,!1),d=E.vakata.array_filter(d,function(e){return-1===c.indexOf(e)||-1<a.indexOf(e)})),-1!==t.indexOf("up")&&-1===d.indexOf(n.id)){for(i=0,r=n.parents.length;i<r;i++)(s=this._model.data[n.parents[i]]).state[o?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),(s=this.get_node(n.parents[i],!0))&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(o?"jstree-clicked":"jstree-checked");d=E.vakata.array_filter(d,function(e){return-1===n.parents.indexOf(e)})}this._data[o?"core":"checkbox"].selected=d}.bind(this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",function(e,t){for(var i,r,s,a,n=this.get_node(t.parent),o=this._model.data,d=this.settings.checkbox.tie_selection;n&&n.id!==E.jstree.root&&!n.state[d?"selected":"checked"];){for(i=s=0,r=n.children.length;i<r;i++)s+=o[n.children[i]].state[d?"selected":"checked"];if(!(0<r&&s===r))break;n.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(n.id),(a=this.get_node(n,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}}.bind(this)).on("move_node.jstree",function(e,t){var i,r,s,a,n,o=t.is_multi,d=t.old_parent,t=this.get_node(t.parent),c=this._model.data,l=this.settings.checkbox.tie_selection;if(!o)for(i=this.get_node(d);i&&i.id!==E.jstree.root&&!i.state[l?"selected":"checked"];){for(s=r=0,a=i.children.length;s<a;s++)r+=c[i.children[s]].state[l?"selected":"checked"];if(!(0<a&&r===a))break;i.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(i.id),(n=this.get_node(i,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=t;i&&i.id!==E.jstree.root;){for(s=r=0,a=i.children.length;s<a;s++)r+=c[i.children[s]].state[l?"selected":"checked"];if(r===a)i.state[l?"selected":"checked"]||(i.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(i.id),(n=this.get_node(i,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"));else{if(!i.state[l?"selected":"checked"])break;i.state[l?"selected":"checked"]=!1,this._data[l?"core":"checkbox"].selected=E.vakata.array_remove_item(this._data[l?"core":"checkbox"].selected,i.id),(n=this.get_node(i,!0))&&n.length&&n.attr("aria-selected",!1).children(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}}.bind(this))},this.get_undetermined=function(e){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];for(var i,r,s={},a=this._model.data,t=this.settings.checkbox.tie_selection,n=this._data[t?"core":"checkbox"].selected,o=[],d=this,c=[],l=0,h=n.length;l<h;l++)if(a[n[l]]&&a[n[l]].parents)for(i=0,r=a[n[l]].parents.length;i<r&&s[a[n[l]].parents[i]]===P;i++)a[n[l]].parents[i]!==E.jstree.root&&(s[a[n[l]].parents[i]]=!0,o.push(a[n[l]].parents[i]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e,t=d.get_node(this);if(t)if(t.state.loaded){for(l=0,h=t.children_d.length;l<h;l++)if(!(e=a[t.children_d[l]]).state.loaded&&e.original&&e.original.state&&e.original.state.undetermined&&!0===e.original.state.undetermined)for(s[e.id]===P&&e.id!==E.jstree.root&&(s[e.id]=!0,o.push(e.id)),i=0,r=e.parents.length;i<r;i++)s[e.parents[i]]===P&&e.parents[i]!==E.jstree.root&&(s[e.parents[i]]=!0,o.push(e.parents[i]))}else if(t.original&&t.original.state&&t.original.state.undetermined&&!0===t.original.state.undetermined)for(s[t.id]===P&&t.id!==E.jstree.root&&(s[t.id]=!0,o.push(t.id)),i=0,r=t.parents.length;i<r;i++)s[t.parents[i]]===P&&t.parents[i]!==E.jstree.root&&(s[t.parents[i]]=!0,o.push(t.parents[i]))}),l=0,h=o.length;l<h;l++)a[o[l]].state[t?"selected":"checked"]||c.push(e?a[o[l]]:o[l]);return c},this._undetermined=function(){if(null!==this.element){var e,t,i,r=this.get_undetermined(!1);for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),e=0,t=r.length;e<t;e++)(i=this.get_node(r[e],!0))&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(e,t,i,r){if(e=d.redraw_node.apply(this,arguments)){for(var s=null,a=null,n=0,o=e.childNodes.length;n<o;n++)if(e.childNodes[n]&&e.childNodes[n].className&&-1!==e.childNodes[n].className.indexOf("jstree-anchor")){s=e.childNodes[n];break}s&&(!this.settings.checkbox.tie_selection&&this._model.data[e.id].state.checked&&(s.className+=" jstree-checked"),a=m.cloneNode(!1),this._model.data[e.id].state.checkbox_disabled&&(a.className+=" jstree-checkbox-disabled"),s.insertBefore(a,s.childNodes[0]))}return i||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)),e},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(e){e=this.get_node(e);var t,i,r=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,a=this._data[s?"core":"checkbox"].selected,n=this._model.data;if(e&&!0!==e.state[s?"selected":"checked"]&&-1!==r.indexOf("undetermined")&&(-1!==r.indexOf("down")||-1!==r.indexOf("up"))){if(!e.state.loaded&&!0===e.original.state.undetermined)return!0;for(t=0,i=e.children_d.length;t<i;t++)if(-1!==E.inArray(e.children_d[t],a)||!n[e.children_d[t]].state.loaded&&n[e.children_d[t]].original.state.undetermined)return!0}return!1},this.disable_checkbox=function(e){var t,i,r;if(E.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.disable_checkbox(e[t]);return!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;r=this.get_node(e,!0),e.state.checkbox_disabled||(e.state.checkbox_disabled=!0,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:e}))},this.enable_checkbox=function(e){var t,i,r;if(E.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.enable_checkbox(e[t]);return!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;r=this.get_node(e,!0),e.state.checkbox_disabled&&(e.state.checkbox_disabled=!1,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:e}))},this.activate_node=function(e,t){return!E(t.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||E(t.target).hasClass("jstree-checkbox"))&&(t.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!E(t.target).hasClass("jstree-checkbox")?d.activate_node.call(this,e,t):!this.is_disabled(e)&&(this.is_checked(e)?this.uncheck_node(e,t):this.check_node(e,t),void this.trigger("activate_node",{node:this.get_node(e)})))},this._cascade_new_checked_state=function(e,t){var i,r,s=this.settings.checkbox.tie_selection,a=this._model.data[e],n=[],o=[];if(!this.settings.checkbox.cascade_to_disabled&&a.state.disabled||!this.settings.checkbox.cascade_to_hidden&&a.state.hidden)c=this.get_checked_descendants(e),a.state[s?"selected":"checked"]&&c.push(a.id),n=n.concat(c);else{if(a.children)for(i=0,r=a.children.length;i<r;i++){var d=a.children[i],c=this._cascade_new_checked_state(d,t),n=n.concat(c);-1<c.indexOf(d)&&o.push(d)}var e=this.get_node(a,!0),l=0<o.length&&o.length<a.children.length;a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=l),!l&&t&&o.length===a.children.length?(a.state[s?"selected":"checked"]=t,n.push(a.id),e.attr("aria-selected",!0).children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")):(a.state[s?"selected":"checked"]=!1,e.attr("aria-selected",!1).children(".jstree-anchor").removeClass(s?"jstree-clicked":"jstree-checked"))}return n},this.get_checked_descendants=function(e){var t=this,i=t.settings.checkbox.tie_selection,e=t._model.data[e];return E.vakata.array_filter(e.children_d,function(e){return t._model.data[e].state[i?"selected":"checked"]})},this.check_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.select_node(e,!1,!0,t);var i,r,s;if(E.vakata.is_array(e)){for(r=0,s=(e=e.slice()).length;r<s;r++)this.check_node(e[r],t);return!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;i=this.get_node(e,!0),e.state.checked||(e.state.checked=!0,this._data.checkbox.selected.push(e.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:e,selected:this._data.checkbox.selected,event:t}))},this.uncheck_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.deselect_node(e,!1,t);var i,r,s;if(E.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.uncheck_node(e[i],t);return!0}if(!(e=this.get_node(e))||e.id===E.jstree.root)return!1;s=this.get_node(e,!0),e.state.checked&&(e.state.checked=!1,this._data.checkbox.selected=E.vakata.array_remove_item(this._data.checkbox.selected,e.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:e,selected:this._data.checkbox.selected,event:t}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var e,t;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[E.jstree.root].children_d.concat(),e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var e=this._data.checkbox.selected.concat([]),t=0,i=this._data.checkbox.selected.length;t<i;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:e})},this.is_checked=function(e){return this.settings.checkbox.tie_selection?this.is_selected(e):!(!(e=this.get_node(e))||e.id===E.jstree.root)&&e.state.checked},this.get_checked=function(e){return this.settings.checkbox.tie_selection?this.get_selected(e):e?E.map(this._data.checkbox.selected,function(e){return this.get_node(e)}.bind(this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_top_selected(e);for(var t,i,r=this.get_checked(!0),s={},a=0,n=r.length;a<n;a++)s[r[a].id]=r[a];for(a=0,n=r.length;a<n;a++)for(t=0,i=r[a].children_d.length;t<i;t++)s[r[a].children_d[t]]&&delete s[r[a].children_d[t]];for(a in r=[],s)s.hasOwnProperty(a)&&r.push(a);return e?E.map(r,function(e){return this.get_node(e)}.bind(this)):r},this.get_bottom_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(e);for(var t=this.get_checked(!0),i=[],r=0,s=t.length;r<s;r++)t[r].children.length||i.push(t[r].id);return e?E.map(i,function(e){return this.get_node(e)}.bind(this)):i},this.load_node=function(e,t){var i,r,s;if(!E.vakata.is_array(e)&&!this.settings.checkbox.tie_selection&&(s=this.get_node(e))&&s.state.loaded)for(i=0,r=s.children_d.length;i<r;i++)this._model.data[s.children_d[i]].state.checked&&(this._data.checkbox.selected=E.vakata.array_remove_item(this._data.checkbox.selected,s.children_d[i]));return d.load_node.apply(this,arguments)},this.get_state=function(){var e=d.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection||(e.checkbox=this._data.checkbox.selected.slice()),e},this.set_state=function(e,t){var i,r=d.set_state.apply(this,arguments);return r&&e.checkbox?(this.settings.checkbox.tie_selection||(this.uncheck_all(),i=this,E.each(e.checkbox,function(e,t){i.check_node(t)})),delete e.checkbox,this.set_state(e,t),!1):r},this.refresh=function(e,t){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),d.refresh.apply(this,arguments)}},E.jstree.defaults.conditionalselect=function(){return!0},E.jstree.plugins.conditionalselect=function(e,i){this.activate_node=function(e,t){if(this.settings.conditionalselect.call(this,this.get_node(e),t))return i.activate_node.call(this,e,t)}},E.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(e,t){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(e){var i=E.jstree.reference(e.reference),e=i.get_node(e.reference);i.create_node(e,{},"last",function(t){try{i.edit(t)}catch(e){setTimeout(function(){i.edit(t)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(e){var t=E.jstree.reference(e.reference),e=t.get_node(e.reference);t.edit(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(e){var t=E.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.delete_node(t.get_selected()):t.delete_node(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){var t=E.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.cut(t.get_top_selected()):t.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){var t=E.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.copy(t.get_top_selected()):t.copy(e)}},paste:{separator_before:!1,icon:!1,_disabled:function(e){return!E.jstree.reference(e.reference).can_paste()},separator_after:!1,label:"Paste",action:function(e){var t=E.jstree.reference(e.reference),e=t.get_node(e.reference);t.paste(e)}}}}}}},E.jstree.plugins.contextmenu=function(e,a){this.bind=function(){a.bind.call(this);var t,i,r=0,s=null;this.element.on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-contextmenu")}.bind(this)).on("contextmenu.jstree",".jstree-anchor",function(e,t){"input"===e.target.tagName.toLowerCase()||(e.preventDefault(),r=e.ctrlKey?+new Date:0,(t||s)&&(r=+new Date+1e4),s&&clearTimeout(s),this.is_loading(e.currentTarget))||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)}.bind(this)).on("click.jstree",".jstree-anchor",function(e){this._data.contextmenu.visible&&(!r||250<+new Date-r)&&E.vakata.context.hide(),r=0}.bind(this)).on("touchstart.jstree",".jstree-anchor",function(e){e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(t=e.originalEvent.changedTouches[0].clientX,i=e.originalEvent.changedTouches[0].clientY,s=setTimeout(function(){E(e.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){s&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(10<Math.abs(t-e.originalEvent.changedTouches[0].clientX)||10<Math.abs(i-e.originalEvent.changedTouches[0].clientY))&&(clearTimeout(s),E.vakata.context.hide())}).on("touchend.vakata.jstree",function(e){s&&clearTimeout(s)}),E(v).on("context_hide.vakata.jstree",function(e,t){this._data.contextmenu.visible=!1,E(t.reference).removeClass("jstree-context")}.bind(this))},this.teardown=function(){this._data.contextmenu.visible&&E.vakata.context.hide(),E(v).off("context_hide.vakata.jstree"),a.teardown.call(this)},this.show_contextmenu=function(t,i,r,e){if(!(t=this.get_node(t))||t.id===E.jstree.root)return!1;var s=this.settings.contextmenu,a=this.get_node(t,!0).children(".jstree-anchor"),n=!1;!s.show_at_node&&i!==P&&r!==P||(a=a.offset(),i=a.left,r=a.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(t)&&this.activate_node(t,e),n=s.items,E.vakata.is_function(n)&&(n=n.call(this,t,function(e){this._show_contextmenu(t,i,r,e)}.bind(this))),E.isPlainObject(n)&&this._show_contextmenu(t,i,r,n)},this._show_contextmenu=function(e,t,i,r){var s=this.get_node(e,!0).children(".jstree-anchor");E(v).one("context_show.vakata.jstree",function(e,t){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";E(t.element).addClass(i),s.addClass("jstree-context")}.bind(this)),this._data.contextmenu.visible=!0,E.vakata.context.show(s,{x:t,y:i},r),this.trigger("show_contextmenu",{node:e,x:t,y:i})}},_={element:h=!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1},(l=E).vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(e){l(v).triggerHandler("context_"+e+".vakata",{reference:_.reference,element:_.element,position:{x:_.position_x,y:_.position_y}})},_execute:function(e){return!(!(e=_.items[e])||e._disabled&&(!l.vakata.is_function(e._disabled)||e._disabled({item:e,reference:_.reference,element:_.element}))||!e.action)&&e.action.call(null,{item:e,reference:_.reference,element:_.element,position:{x:_.position_x,y:_.position_y}})},_parse:function(e,t){if(!e)return!1;t||(_.html="",_.items=[]);var i,r="",s=!1;return t&&(r+="<ul>"),l.each(e,function(e,t){if(!t)return!0;_.items.push(t),!s&&t.separator_before&&(r+="<li class='vakata-context-separator'><a href='#' "+(l.vakata.context.settings.icons?"":'class="vakata-context-no-icons"')+">&#160;</a></li>"),s=!1,r=(r+="<li class='"+(t._class||"")+(!0===t._disabled||l.vakata.is_function(t._disabled)&&t._disabled({item:t,reference:_.reference,element:_.element})?" vakata-contextmenu-disabled ":"")+"' "+(t.shortcut?" data-shortcut='"+t.shortcut+"' ":"")+">")+"<a href='#' rel='"+(_.items.length-1)+"' "+(t.title?"title='"+t.title+"'":"")+">",l.vakata.context.settings.icons&&(r+="<i ",t.icon&&(-1!==t.icon.indexOf("/")||-1!==t.icon.indexOf(".")?r+=" style='background:url(\""+t.icon+"\") center center no-repeat' ":r+=" class='"+t.icon+"' "),r+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),r+=(l.vakata.is_function(t.label)?t.label({item:e,reference:_.reference,element:_.element}):t.label)+(t.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+t.shortcut+'">'+(t.shortcut_label||"")+"</span>":"")+"</a>",t.submenu&&(i=l.vakata.context._parse(t.submenu,!0))&&(r+=i),r+="</li>",t.separator_after&&(r+="<li class='vakata-context-separator'><a href='#' "+(l.vakata.context.settings.icons?"":'class="vakata-context-no-icons"')+">&#160;</a></li>",s=!0)}),r=r.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),t&&(r+="</ul>"),t||(_.html=r,l.vakata.context._trigger("parse")),10<r.length&&r},_show_submenu:function(e){var t,i,r,s,a,n,o,d;(e=l(e)).length&&e.children("ul").length&&(t=e.children("ul"),r=(i=e.offset().left)+e.outerWidth(),s=e.offset().top,a=t.width(),n=t.height(),o=l(window).width()+l(window).scrollLeft(),d=l(window).height()+l(window).scrollTop(),h?e[r-(a+10+e.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):e[o<r+a&&o-r<i?"addClass":"removeClass"]("vakata-context-right"),d<s+n+10&&t.css("bottom","-1px"),e.hasClass("vakata-context-right")?i<a&&t.css("margin-right",i-a):o-r<a&&t.css("margin-left",o-r-a),t.show())},show:function(e,t,i){var r,s,a,n,o,d,c;switch(_.element&&_.element.length&&_.element.width(""),!0){case!t&&!e:return!1;case!!t&&!!e:_.reference=e,_.position_x=t.x,_.position_y=t.y;break;case!t&&!!e:r=(_.reference=e).offset(),_.position_x=r.left+e.outerHeight(),_.position_y=r.top;break;case!!t&&!e:_.position_x=t.x,_.position_y=t.y}e&&!i&&l(e).data("vakata_contextmenu")&&(i=l(e).data("vakata_contextmenu")),l.vakata.context._parse(i)&&_.element.html(_.html),_.items.length&&(_.element.appendTo(v.body),i=_.element,s=_.position_x,a=_.position_y,n=i.width(),o=i.height(),d=l(window).width()+l(window).scrollLeft(),c=l(window).height()+l(window).scrollTop(),h&&(s-=i.outerWidth()-l(e).outerWidth())<l(window).scrollLeft()+20&&(s=l(window).scrollLeft()+20),_.element.css({left:s=d<s+n+20?d-(n+20):s,top:a=c<a+o+20?c-(o+20):a}).show().find("a").first().trigger("focus").parent().addClass("vakata-context-hover"),_.is_visible=!0,l.vakata.context._trigger("show"))},hide:function(){_.is_visible&&(_.element.hide().find("ul").hide().end().find(":focus").trigger("blur").end().detach(),_.is_visible=!1,l.vakata.context._trigger("hide"))}},l(function(){h="rtl"===l(v.body).css("direction");var t=!1;_.element=l("<ul class='vakata-context'></ul>"),_.element.on("mouseenter","li",function(e){e.stopImmediatePropagation(),l.contains(this,e.relatedTarget)||(t&&clearTimeout(t),_.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),l(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),l.vakata.context._show_submenu(this))}).on("mouseleave","li",function(e){l.contains(this,e.relatedTarget)||l(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(e){l(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),l.vakata.context.settings.hide_onmouseleave&&(t=setTimeout(function(){l.vakata.context.hide()},l.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(e){e.preventDefault(),l(this).trigger("blur").parent().hasClass("vakata-context-disabled")||!1===l.vakata.context._execute(l(this).attr("rel"))||l.vakata.context.hide()}).on("keydown","a",function(e){var t=null;switch(e.which){case 13:case 32:e.type="click",e.preventDefault(),l(e.currentTarget).trigger(e);break;case 37:_.is_visible&&(_.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").trigger("focus"),e.stopImmediatePropagation(),e.preventDefault());break;case 38:_.is_visible&&((t=(t=_.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first()).length?t:_.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()).addClass("vakata-context-hover").children("a").trigger("focus"),e.stopImmediatePropagation(),e.preventDefault());break;case 39:_.is_visible&&(_.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").trigger("focus"),e.stopImmediatePropagation(),e.preventDefault());break;case 40:_.is_visible&&((t=(t=_.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first()).length?t:_.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()).addClass("vakata-context-hover").children("a").trigger("focus"),e.stopImmediatePropagation(),e.preventDefault());break;case 27:l.vakata.context.hide(),e.preventDefault()}}).on("keydown",function(e){e.preventDefault();e=_.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();e.parent().not(".vakata-context-disabled")&&e.trigger("click")}),l(v).on("mousedown.vakata.jstree",function(e){_.is_visible&&_.element[0]!==e.target&&!l.contains(_.element[0],e.target)&&l.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,t){_.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),h&&_.element.addClass("vakata-context-rtl").css("direction","rtl"),_.element.find("ul").hide().end()})}),E.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1},E.jstree.plugins.dnd=function(e,o){this.init=function(e,t){o.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in v.createElement("span")},this.bind=function(){o.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",function(e){if(this.settings.dnd.large_drag_target&&E(e.target).closest(".jstree-node")[0]!==e.currentTarget)return!0;if("touchstart"===e.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!E(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var t=this.get_node(e.target),i=this.is_selected(t)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,r=1<i?i+" "+this.get_string("nodes"):this.get_text(e.currentTarget);if(this.settings.core.force_text&&(r=E.vakata.html.escape(r)),t&&t.id&&t.id!==E.jstree.root&&(1===e.which||"touchstart"===e.type||"dragstart"===e.type)&&(!0===this.settings.dnd.is_draggable||E.vakata.is_function(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,1<i?this.get_top_selected(!0):[t],e))){if(s={jstree:!0,origin:this,obj:this.get_node(t,!0),nodes:1<i?this.get_top_selected():[t.id]},a=e.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),E.vakata.dnd.start(e,s,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+r+'<ins class="jstree-copy">+</ins></div>');E.vakata.dnd._trigger("start",e,{helper:E(),element:a,data:s})}}.bind(this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(e){return e.preventDefault(),E.vakata.dnd._trigger("move",e,{helper:E(),element:a,data:s}),!1}).on("drop.jstree",function(e){return e.preventDefault(),E.vakata.dnd._trigger("stop",e,{helper:E(),element:a,data:s}),!1}.bind(this))},this.redraw_node=function(e,t,i,r){if((e=o.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{for(var s=null,a=0,n=e.childNodes.length;a<n;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){s=e.childNodes[a];break}s&&s.setAttribute("draggable",!0)}return e}},E(function(){var N=!1,T=!1,O=!1,A=!1,S=E('<div id="jstree-marker">&#160;</div>').hide();E(v).on("dragover.vakata.jstree",function(e){a&&E.vakata.dnd._trigger("move",e,{helper:E(),element:a,data:s})}).on("drop.vakata.jstree",function(e){a&&(E.vakata.dnd._trigger("stop",e,{helper:E(),element:a,data:s}),s=a=null)}).on("dnd_start.vakata.jstree",function(e,t){O=N=!1,t&&t.data&&t.data.jstree&&S.appendTo(v.body)}).on("dnd_move.vakata.jstree",function(e,s){var a=s.event.target!==O.target;if(!A||s.event&&"dragover"===s.event.type&&!a||clearTimeout(A),s&&s.data&&s.data.jstree&&(!s.event.target.id||"jstree-marker"!==s.event.target.id)){O=s.event;var n,t,o,d,c,l,h,_,g,u,f,p,m,v,j,k,b,y,x,w=E.jstree.reference(s.event.target),C=!1;if(w&&w._data&&w._data.dnd)if(S.attr("class","jstree-"+w.get_theme()+(w.settings.core.themes.responsive?" jstree-dnd-responsive":"")),b=s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey)),s.helper.children().attr("class","jstree-"+w.get_theme()+" jstree-"+w.get_theme()+"-"+w.get_theme_variant()+" "+(w.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[b?"show":"hide"](),s.event.target!==w.element[0]&&s.event.target!==w.get_container_ul()[0]||0!==w.get_container_ul().children().length){if((C=w.settings.dnd.large_drop_target?E(s.event.target).closest(".jstree-node").children(".jstree-anchor"):E(s.event.target).closest(".jstree-anchor"))&&C.length&&C.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(n=C.offset(),t=(s.event.pageY!==P?s.event:s.event.originalEvent).pageY-n.top,c=C.outerHeight(),_=t<c/3?["b","i","a"]:c-c/3<t?["a","i","b"]:c/2<t?["i","a","b"]:["i","b","a"],E.each(_,function(e,t){switch(t){case"b":o=n.left-6,d=n.top,l=w.get_parent(C),h=C.parent().index(),x="jstree-below";break;case"i":j=w.settings.dnd.inside_pos,k=w.get_node(C.parent()),o=n.left-2,d=n.top+c/2+1,l=k.id,h="first"===j?0:"last"===j?k.children.length:Math.min(j,k.children.length),x="jstree-inside";break;case"a":o=n.left-6,d=n.top+c,l=w.get_parent(C),h=C.parent().index()+1,x="jstree-above"}for(g=!0,u=0,f=s.data.nodes.length;u<f;u++)if(p=s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node",m=h,"move_node"==p&&"a"===t&&s.data.origin&&s.data.origin===w&&l===w.get_parent(s.data.nodes[u])&&(v=w.get_node(l),m>E.inArray(s.data.nodes[u],v.children))&&--m,!(g=g&&(w&&w.settings&&w.settings.dnd&&!1===w.settings.dnd.check_while_dragging||w.check(p,s.data.origin&&s.data.origin!==w?s.data.origin.get_node(s.data.nodes[u]):s.data.nodes[u],l,m,{dnd:!0,ref:w.get_node(C.parent()),pos:t,origin:s.data.origin,is_multi:s.data.origin&&s.data.origin!==w,is_foreign:!s.data.origin})))){w&&w.last_error&&(T=w.last_error());break}var i,r;if("i"===t&&C.parent().is(".jstree-closed")&&w.settings.dnd.open_timeout&&(s.event&&"dragover"===s.event.type&&!a||(A&&clearTimeout(A),A=setTimeout((r=C,function(){i.open_node(r)}),(i=w).settings.dnd.open_timeout))),g)return(y=w.get_node(l,!0)).hasClass(".jstree-dnd-parent")||(E(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),y.addClass("jstree-dnd-parent")),N={ins:w,par:l,pos:"i"!==t||"last"!==j||0!==h||w.is_loaded(k)?h:"last"},S.css({left:o+"px",top:d+"px"}).show(),S.removeClass("jstree-above jstree-inside jstree-below").addClass(x),s.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),s.event.originalEvent&&s.event.originalEvent.dataTransfer&&(s.event.originalEvent.dataTransfer.dropEffect=b?"copy":"move"),T={},!(_=!0)}),!0===_))return}else{for(g=!0,u=0,f=s.data.nodes.length;u<f&&(g=g&&w.check(s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node",s.data.origin&&s.data.origin!==w?s.data.origin.get_node(s.data.nodes[u]):s.data.nodes[u],E.jstree.root,"last",{dnd:!0,ref:w.get_node(E.jstree.root),pos:"i",origin:s.data.origin,is_multi:s.data.origin&&s.data.origin!==w,is_foreign:!s.data.origin}));u++);if(g)return N={ins:w,par:E.jstree.root,pos:"last"},S.hide(),s.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(s.event.originalEvent&&s.event.originalEvent.dataTransfer&&(s.event.originalEvent.dataTransfer.dropEffect=b?"copy":"move"))}E(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),N=!1,s.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),s.event.originalEvent&&s.event.originalEvent.dataTransfer,S.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(S.hide(),O=N=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(e,t){if(E(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),A&&clearTimeout(A),t&&t.data&&t.data.jstree){S.hide().detach();var i,r,s=[];if(N){for(i=0,r=t.data.nodes.length;i<r;i++)s[i]=t.data.origin?t.data.origin.get_node(t.data.nodes[i]):t.data.nodes[i];N.ins[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(t.event.metaKey||t.event.ctrlKey))?"copy_node":"move_node"](s,N.par,N.pos,!1,!1,!1,t.data.origin)}else(i=E(t.event.target).closest(".jstree")).length&&T&&T.error&&"check"===T.error&&(i=i.jstree(!0))&&i.settings.core.error.call(this,T);N=O=!1}}).on("keyup.jstree keydown.jstree",function(e,t){(t=E.vakata.dnd._get())&&t.data&&t.data.jstree&&("keyup"===e.type&&27===e.which?(A&&clearTimeout(A),A=O=T=N=!1,S.hide().detach(),E.vakata.dnd._clean()):(t.helper.find(".jstree-copy").first()[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(e.metaKey||e.ctrlKey))?"show":"hide"](),O&&(O.metaKey=e.metaKey,O.ctrlKey=e.ctrlKey,E.vakata.dnd._trigger("move",O))))})}),u={element:!((g=E).vakata.html={div:g("<div></div>"),escape:function(e){return g.vakata.html.div.text(e).html()},strip:function(e){return g.vakata.html.div.empty().append(g.parseHTML(e)).text()}}),target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},g.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(e,t,i){(i=i===P?g.vakata.dnd._get():i).event=t,g(v).triggerHandler("dnd_"+e+".vakata",i)},_get:function(){return{data:u.data,element:u.element,helper:u.helper}},_clean:function(){u.helper&&u.helper.remove(),u.scroll_i&&(clearInterval(u.scroll_i),u.scroll_i=!1),u={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},a=null,g(v).off("mousemove.vakata.jstree touchmove.vakata.jstree",g.vakata.dnd.drag),g(v).off("mouseup.vakata.jstree touchend.vakata.jstree",g.vakata.dnd.stop)},_scroll:function(e){var t;return u.scroll_e&&(u.scroll_l||u.scroll_t)?u.scroll_i?!0!==e&&(e=u.scroll_e.scrollTop(),t=u.scroll_e.scrollLeft(),u.scroll_e.scrollTop(e+u.scroll_t*g.vakata.dnd.settings.scroll_speed),u.scroll_e.scrollLeft(t+u.scroll_l*g.vakata.dnd.settings.scroll_speed),void(e===u.scroll_e.scrollTop()&&t===u.scroll_e.scrollLeft()||g.vakata.dnd._trigger("scroll",u.scroll_e))):(u.scroll_i=setInterval(g.vakata.dnd._scroll,100),!1):(u.scroll_i&&(clearInterval(u.scroll_i),u.scroll_i=!1),!1)},start:function(e,t,i){"touchstart"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=v.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),u.is_drag&&g.vakata.dnd.stop({});try{e.currentTarget.unselectable="on",e.currentTarget.onselectstart=function(){return!1},e.currentTarget.style&&(e.currentTarget.style.touchAction="none",e.currentTarget.style.msTouchAction="none",e.currentTarget.style.MozUserSelect="none")}catch(e){}return u.init_x=e.pageX,u.init_y=e.pageY,u.data=t,u.is_down=!0,u.element=e.currentTarget,u.target=e.target,u.is_touch="touchstart"===e.type,!1!==i&&(u.helper=g("<div id='vakata-dnd'></div>").html(i).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),g(v).on("mousemove.vakata.jstree touchmove.vakata.jstree",g.vakata.dnd.drag),g(v).on("mouseup.vakata.jstree touchend.vakata.jstree",g.vakata.dnd.stop),!1},drag:function(i){if("touchmove"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=v.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),u.is_down){if(!u.is_drag){if(!(Math.abs(i.pageX-u.init_x)>(u.is_touch?g.vakata.dnd.settings.threshold_touch:g.vakata.dnd.settings.threshold)||Math.abs(i.pageY-u.init_y)>(u.is_touch?g.vakata.dnd.settings.threshold_touch:g.vakata.dnd.settings.threshold)))return;u.helper&&(u.helper.appendTo(v.body),u.helper_w=u.helper.outerWidth()),u.is_drag=!0,g(u.target).one("click.vakata",!1),g.vakata.dnd._trigger("start",i)}var e,t,r,s=!1,a=!1,n=!1,o=!1,d=!1,c=!1;return u.scroll_t=0,u.scroll_l=0,u.scroll_e=!1,g(g(i.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(g(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var e=g(this),t=e.offset();if(this.scrollHeight>this.offsetHeight&&(t.top+e.height()-i.pageY<g.vakata.dnd.settings.scroll_proximity&&(u.scroll_t=1),i.pageY-t.top<g.vakata.dnd.settings.scroll_proximity)&&(u.scroll_t=-1),this.scrollWidth>this.offsetWidth&&(t.left+e.width()-i.pageX<g.vakata.dnd.settings.scroll_proximity&&(u.scroll_l=1),i.pageX-t.left<g.vakata.dnd.settings.scroll_proximity)&&(u.scroll_l=-1),u.scroll_t||u.scroll_l)return u.scroll_e=g(this),!1}),!u.scroll_e&&(s=g(v),a=g(window),n=s.height(),e=a.height(),o=s.width(),a=a.width(),t=s.scrollTop(),r=s.scrollLeft(),e<n&&i.pageY-t<g.vakata.dnd.settings.scroll_proximity&&(u.scroll_t=-1),e<n&&e-(i.pageY-t)<g.vakata.dnd.settings.scroll_proximity&&(u.scroll_t=1),a<o&&i.pageX-r<g.vakata.dnd.settings.scroll_proximity&&(u.scroll_l=-1),a<o&&a-(i.pageX-r)<g.vakata.dnd.settings.scroll_proximity&&(u.scroll_l=1),u.scroll_t||u.scroll_l)&&(u.scroll_e=s),u.scroll_e&&g.vakata.dnd._scroll(!0),u.helper&&(d=parseInt(i.pageY+g.vakata.dnd.settings.helper_top,10),c=parseInt(i.pageX+g.vakata.dnd.settings.helper_left,10),o&&c+u.helper_w>o&&(c=o-(u.helper_w+2)),u.helper.css({left:c+"px",top:(d=n&&n<d+25?n-50:d)+"px"})),g.vakata.dnd._trigger("move",i),!1}},stop:function(e){var t;return"touchend"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=v.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),u.is_drag?(e.target!==u.target&&g(u.target).off("click.vakata"),g.vakata.dnd._trigger("stop",e)):"touchend"===e.type&&e.target===u.target&&(t=setTimeout(function(){g(e.target).trigger("click")},100),g(e.target).one("click",function(){t&&clearTimeout(t)})),g.vakata.dnd._clean(),!1}},E.jstree.defaults.massload=null,E.jstree.plugins.massload=function(e,l){this.init=function(e,t){this._data.massload={},l.init.call(this,e,t)},this._load_nodes=function(a,n,o,d){var e,t,c,i=this.settings.massload,r=[],s=this._model.data;if(!o){for(e=0,t=a.length;e<t;e++)s[a[e]]&&(s[a[e]].state.loaded||s[a[e]].state.failed)&&!d||(r.push(a[e]),(c=this.get_node(a[e],!0))&&c.length&&c.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},r.length){if(E.vakata.is_function(i))return i.call(this,r,function(e){var t,i;if(e)for(t in e)e.hasOwnProperty(t)&&(this._data.massload[t]=e[t]);for(t=0,i=a.length;t<i;t++)(c=this.get_node(a[t],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);l._load_nodes.call(this,a,n,o,d)}.bind(this));if("object"==typeof i&&i&&i.url)return i=E.extend(!0,{},i),E.vakata.is_function(i.url)&&(i.url=i.url.call(this,r)),E.vakata.is_function(i.data)&&(i.data=i.data.call(this,r)),E.ajax(i).done(function(e,t,i){var r,s;if(e)for(r in e)e.hasOwnProperty(r)&&(this._data.massload[r]=e[r]);for(r=0,s=a.length;r<s;r++)(c=this.get_node(a[r],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);l._load_nodes.call(this,a,n,o,d)}.bind(this)).fail(function(e){l._load_nodes.call(this,a,n,o,d)}.bind(this))}}return l._load_nodes.call(this,a,n,o,d)},this._load_node=function(e,t){var i,r=this._data.massload[e.id];return r?(r=this["string"==typeof r?"_append_html_data":"_append_json_data"](e,"string"==typeof r?E(E.parseHTML(r)).filter(function(){return 3!==this.nodeType}):r,function(e){t.call(this,e)}),(i=this.get_node(e.id,!0))&&i.length&&i.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[e.id],r):l._load_node.call(this,e,t)}},E.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},E.jstree.plugins.search=function(e,o){this.bind=function(){o.bind.call(this),this._data.search.str="",this._data.search.dom=E(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",function(e,t){if(this._data.search.som&&t.res.length){for(var i,r,s=this._model.data,a=[],n=0,o=t.res.length;n<o;n++)if(s[t.res[n]]&&!s[t.res[n]].state.hidden&&(a.push(t.res[n]),a=a.concat(s[t.res[n]].parents),this._data.search.smc))for(i=0,r=s[t.res[n]].children_d.length;i<r;i++)s[s[t.res[n]].children_d[i]]&&!s[s[t.res[n]].children_d[i]].state.hidden&&a.push(s[t.res[n]].children_d[i]);a=E.vakata.array_remove_item(E.vakata.array_unique(a),E.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(a,!0),this.redraw(!0)}}.bind(this)).on("clear_search.jstree",function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))}.bind(this))},this.search=function(r,e,t,i,s,a){if(!1===r||""===E.vakata.trim(r.toString()))return this.clear_search();i=(i=this.get_node(i))&&i.id?i.id:null,r=r.toString();var n,o,d=this.settings.search,c=d.ajax||!1,l=this._model.data,h=null,_=[],g=[];if(this._data.search.res.length&&!s&&this.clear_search(),t===P&&(t=d.show_only_matches),a===P&&(a=d.show_only_matches_children),!e&&!1!==c)return E.vakata.is_function(c)?c.call(this,r,function(e){e&&e.d&&(e=e.d),this._load_nodes(E.vakata.is_array(e)?E.vakata.array_unique(e):[],function(){this.search(r,!0,t,i,s,a)})}.bind(this),i):((c=E.extend({},c)).data||(c.data={}),c.data.str=r,i&&(c.data.inside=i),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=E.ajax(c).fail(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(c)},this.settings.core.error.call(this,this._data.core.last_error)}.bind(this)).done(function(e){e&&e.d&&(e=e.d),this._load_nodes(E.vakata.is_array(e)?E.vakata.array_unique(e):[],function(){this.search(r,!0,t,i,s,a)})}.bind(this)),this._data.search.lastRequest);if(s||(this._data.search.str=r,this._data.search.dom=E(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=t,this._data.search.smc=a),h=new E.vakata.search(r,!0,{caseSensitive:d.case_sensitive,fuzzy:d.fuzzy}),E.each(l[i||E.jstree.root].children_d,function(e,t){var i=l[t];i.text&&!i.state.hidden&&(!d.search_leaves_only||i.state.loaded&&0===i.children.length)&&(d.search_callback&&d.search_callback.call(this,r,i)||!d.search_callback&&h.search(i.text).isMatch)&&(_.push(t),g=g.concat(i.parents))}),_.length){for(n=0,o=(g=E.vakata.array_unique(g)).length;n<o;n++)g[n]!==E.jstree.root&&l[g[n]]&&!0===this.open_node(g[n],null,0)&&this._data.search.opn.push(g[n]);s?(this._data.search.dom=this._data.search.dom.add(E(this.element[0].querySelectorAll("#"+E.map(_,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(E.jstree.idregex,"\\$&"):e.replace(E.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=E.vakata.array_unique(this._data.search.res.concat(_))):(this._data.search.dom=E(this.element[0].querySelectorAll("#"+E.map(_,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(E.jstree.idregex,"\\$&"):e.replace(E.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=_),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:r,res:this._data.search.res,show_only_matches:t})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=E(this.element[0].querySelectorAll("#"+E.map(this._data.search.res,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(E.jstree.idregex,"\\$&"):e.replace(E.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=E()},this.redraw_node=function(e,t,i,r){if((e=o.redraw_node.apply(this,arguments))&&-1!==E.inArray(e.id,this._data.search.res)){for(var s=null,a=0,n=e.childNodes.length;a<n;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){s=e.childNodes[a];break}s&&(s.className+=" jstree-search")}return e}},(r=E).vakata.search=function(p,e,m){m=m||{},!1!==(m=r.extend({},r.vakata.search.defaults,m)).fuzzy&&(m.fuzzy=!0),p=m.caseSensitive?p:p.toLowerCase();var v,j,k,t,b=m.location,i=m.distance,y=m.threshold,x=p.length;return 32<x&&(m.fuzzy=!1),m.fuzzy&&(v=1<<x-1,j=function(){for(var e={},t=0,t=0;t<x;t++)e[p.charAt(t)]=0;for(t=0;t<x;t++)e[p.charAt(t)]|=1<<x-t-1;return e}(),k=function(e,t){e/=x,t=Math.abs(b-t);return i?e+t/i:t?1:e}),t=function(e){if(e=m.caseSensitive?e:e.toLowerCase(),p===e||-1!==e.indexOf(p))return{isMatch:!0,score:0};if(!m.fuzzy)return{isMatch:!1,score:1};var t,i,r,s,a,n,o,d,c,l=e.length,h=y,_=e.indexOf(p,b),g=x+l,u=1,f=[];for(-1!==_&&(h=Math.min(k(0,_),h),-1!==(_=e.lastIndexOf(p,b+x)))&&(h=Math.min(k(0,_),h)),_=-1,t=0;t<x;t++){for(r=0,s=g;r<s;)k(t,b+s)<=h?r=s:g=s,s=Math.floor((g-r)/2+r);for(g=s,n=Math.max(1,b-s+1),o=Math.min(b+s,l)+x,(d=new Array(o+2))[o+1]=(1<<t)-1,i=o;n<=i;i--)if(c=j[e.charAt(i-1)],d[i]=0===t?(d[i+1]<<1|1)&c:(d[i+1]<<1|1)&c|(a[i+1]|a[i])<<1|1|a[i+1],d[i]&v&&(u=k(t,i-1))<=h){if(h=u,f.push(_=i-1),!(b<_))break;n=Math.max(1,2*b-_)}if(k(t+1,b)>h)break;a=d}return{isMatch:0<=_,score:u}},!0===e?{search:t}:t(e)},r.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1},E.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},!(E.jstree.plugins.sort=function(e,t){this.bind=function(){t.bind.call(this),this.element.on("model.jstree",function(e,t){this.sort(t.parent,!0)}.bind(this)).on("rename_node.jstree create_node.jstree",function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)}.bind(this)).on("move_node.jstree copy_node.jstree",function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)}.bind(this))},this.sort=function(e,t){var i,r;if((e=this.get_node(e))&&e.children&&e.children.length&&(e.children.sort(this.settings.sort.bind(this)),t))for(i=0,r=e.children_d.length;i<r;i++)this.sort(e.children_d[i],!1)}})),k=(E.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},E.jstree.plugins.state=function(e,t){this.bind=function(){t.bind.call(this);var i=function(){this.element.on(this.settings.state.events,function(){j&&clearTimeout(j),j=setTimeout(function(){this.save_state()}.bind(this),100)}.bind(this)),this.trigger("state_ready")}.bind(this);this.element.on("ready.jstree",function(e,t){this.element.one("restore_state.jstree",i),this.restore_state()||i()}.bind(this))},this.save_state=function(){var e=this.get_state(),e=(this.settings.state.preserve_loaded||delete e.core.loaded,{state:e,ttl:this.settings.state.ttl,sec:+new Date});E.vakata.storage.set(this.settings.state.key,JSON.stringify(e))},this.restore_state=function(){var i=E.vakata.storage.get(this.settings.state.key);if(i)try{i=JSON.parse(i)}catch(e){return!1}return!(i&&i.ttl&&i.sec&&+new Date-i.sec>i.ttl||!(i=(i=i&&i.state?i.state:i)&&E.vakata.is_function(this.settings.state.filter)?this.settings.state.filter.call(this,i):i)||(this.settings.state.preserve_loaded||delete i.core.loaded,this.element.one("set_state.jstree",function(e,t){t.instance.trigger("restore_state",{state:E.extend(!0,{},i)})}),this.set_state(i),0))},this.clear_state=function(){return E.vakata.storage.del(this.settings.state.key)}},E.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}},E.jstree.defaults.types={default:{}},E.jstree.defaults.types[E.jstree.root]={},E.jstree.plugins.types=function(e,l){this.init=function(e,t){var i,r;if(t&&t.types&&t.types.default)for(i in t.types)if("default"!==i&&i!==E.jstree.root&&t.types.hasOwnProperty(i))for(r in t.types.default)t.types.default.hasOwnProperty(r)&&t.types[i][r]===P&&(t.types[i][r]=t.types.default[r]);l.init.call(this,e,t),this._model.data[E.jstree.root].type=E.jstree.root},this.refresh=function(e,t){l.refresh.call(this,e,t),this._model.data[E.jstree.root].type=E.jstree.root},this.bind=function(){this.element.on("model.jstree",function(e,t){for(var i,r=this._model.data,s=t.nodes,a=this.settings.types,n="default",o=0,d=s.length;o<d;o++){if(n="default",r[s[o]].original&&r[s[o]].original.type&&a[r[s[o]].original.type]&&(n=r[s[o]].original.type),r[s[o]].data&&r[s[o]].data.jstree&&r[s[o]].data.jstree.type&&a[r[s[o]].data.jstree.type]&&(n=r[s[o]].data.jstree.type),r[s[o]].type=n,!0===r[s[o]].icon&&a[n].icon!==P&&(r[s[o]].icon=a[n].icon),a[n].li_attr!==P&&"object"==typeof a[n].li_attr)for(i in a[n].li_attr)a[n].li_attr.hasOwnProperty(i)&&"id"!==i&&(r[s[o]].li_attr[i]===P?r[s[o]].li_attr[i]=a[n].li_attr[i]:"class"===i&&(r[s[o]].li_attr.class=a[n].li_attr.class+" "+r[s[o]].li_attr.class));if(a[n].a_attr!==P&&"object"==typeof a[n].a_attr)for(i in a[n].a_attr)a[n].a_attr.hasOwnProperty(i)&&"id"!==i&&(r[s[o]].a_attr[i]===P?r[s[o]].a_attr[i]=a[n].a_attr[i]:"href"===i&&"#"===r[s[o]].a_attr[i]?r[s[o]].a_attr.href=a[n].a_attr.href:"class"===i&&(r[s[o]].a_attr.class=a[n].a_attr.class+" "+r[s[o]].a_attr.class))}r[E.jstree.root].type=E.jstree.root}.bind(this)),l.bind.call(this)},this.get_json=function(e,t,i){var r,s,a=this._model.data,n=t?E.extend(!0,{},t,{no_id:!1}):{},o=l.get_json.call(this,e,n,i);if(!1===o)return!1;if(E.vakata.is_array(o))for(r=0,s=o.length;r<s;r++)o[r].type=o[r].id&&a[o[r].id]&&a[o[r].id].type?a[o[r].id].type:"default",t&&t.no_id&&(delete o[r].id,o[r].li_attr&&o[r].li_attr.id&&delete o[r].li_attr.id,o[r].a_attr)&&o[r].a_attr.id&&delete o[r].a_attr.id;else o.type=o.id&&a[o.id]&&a[o.id].type?a[o.id].type:"default",t&&t.no_id&&(o=this._delete_ids(o));return o},this._delete_ids=function(e){if(E.vakata.is_array(e))for(var t=0,i=e.length;t<i;t++)e[t]=this._delete_ids(e[t]);else delete e.id,e.li_attr&&e.li_attr.id&&delete e.li_attr.id,e.a_attr&&e.a_attr.id&&delete e.a_attr.id,e.children&&E.vakata.is_array(e.children)&&(e.children=this._delete_ids(e.children));return e},this.check=function(e,t,i,r,s){if(!1===l.check.call(this,e,t,i,r,s))return!1;t=t&&t.id?t:this.get_node(t),i=i&&i.id?i:this.get_node(i);var a,n,o,d,c=(c=t&&t.id?s&&s.origin?s.origin:E.jstree.reference(t.id):null)&&c._model&&c._model.data?c._model.data:null;switch(e){case"create_node":case"move_node":case"copy_node":if("move_node"!==e||-1===E.inArray(t.id,i.children)){if((a=this.get_rules(i)).max_children!==P&&-1!==a.max_children&&a.max_children===i.children.length)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})});if(a.valid_children!==P&&-1!==a.valid_children&&-1===E.inArray(t.type||"default",a.valid_children))return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})});if(c&&t.children_d&&t.parents){for(o=n=0,d=t.children_d.length;o<d;o++)n=Math.max(n,c[t.children_d[o]].parents.length);n=n-t.parents.length+1}(n<=0||n===P)&&(n=1);do{if(a.max_depth!==P&&-1!==a.max_depth&&a.max_depth<n)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})})}while(i=this.get_node(i.parent),a=this.get_rules(i),n++,i)}}return!0},this.get_rules=function(e){return!!(e=this.get_node(e))&&((e=this.get_type(e,!0)).max_depth===P&&(e.max_depth=-1),e.max_children===P&&(e.max_children=-1),e.valid_children===P&&(e.valid_children=-1),e)},this.get_type=function(e,t){return!!(e=this.get_node(e))&&(t?E.extend({type:e.type},this.settings.types[e.type]):e.type)},this.set_type=function(e,t){var i,r,s,a,n,o,d,c,l=this._model.data;if(E.vakata.is_array(e))for(r=0,s=(e=e.slice()).length;r<s;r++)this.set_type(e[r],t);else{if(i=this.settings.types,e=this.get_node(e),!i[t]||!e)return!1;if((d=this.get_node(e,!0))&&d.length&&(c=d.children(".jstree-anchor")),a=e.type,n=this.get_icon(e),e.type=t,!0!==n&&i[a]&&(i[a].icon===P||n!==i[a].icon)||this.set_icon(e,i[t].icon===P||i[t].icon),i[a]&&i[a].li_attr!==P&&"object"==typeof i[a].li_attr)for(o in i[a].li_attr)i[a].li_attr.hasOwnProperty(o)&&"id"!==o&&("class"===o?(l[e.id].li_attr.class=(l[e.id].li_attr.class||"").replace(i[a].li_attr[o],""),d&&d.removeClass(i[a].li_attr[o])):l[e.id].li_attr[o]===i[a].li_attr[o]&&(l[e.id].li_attr[o]=null,d)&&d.removeAttr(o));if(i[a]&&i[a].a_attr!==P&&"object"==typeof i[a].a_attr)for(o in i[a].a_attr)i[a].a_attr.hasOwnProperty(o)&&"id"!==o&&("class"===o?(l[e.id].a_attr.class=(l[e.id].a_attr.class||"").replace(i[a].a_attr[o],""),c&&c.removeClass(i[a].a_attr[o])):l[e.id].a_attr[o]===i[a].a_attr[o]&&("href"===o?(l[e.id].a_attr[o]="#",c&&c.attr("href","#")):(delete l[e.id].a_attr[o],c&&c.removeAttr(o))));if(i[t].li_attr!==P&&"object"==typeof i[t].li_attr)for(o in i[t].li_attr)i[t].li_attr.hasOwnProperty(o)&&"id"!==o&&(l[e.id].li_attr[o]===P?(l[e.id].li_attr[o]=i[t].li_attr[o],d&&("class"===o?d.addClass(i[t].li_attr[o]):d.attr(o,i[t].li_attr[o]))):"class"===o&&(l[e.id].li_attr.class=i[t].li_attr[o]+" "+l[e.id].li_attr.class,d)&&d.addClass(i[t].li_attr[o]));if(i[t].a_attr!==P&&"object"==typeof i[t].a_attr)for(o in i[t].a_attr)i[t].a_attr.hasOwnProperty(o)&&"id"!==o&&(l[e.id].a_attr[o]===P?(l[e.id].a_attr[o]=i[t].a_attr[o],c&&("class"===o?c.addClass(i[t].a_attr[o]):c.attr(o,i[t].a_attr[o]))):"href"===o&&"#"===l[e.id].a_attr[o]?(l[e.id].a_attr.href=i[t].a_attr.href,c&&c.attr("href",i[t].a_attr.href)):"class"===o&&(l[e.id].a_attr.class=i[t].a_attr.class+" "+l[e.id].a_attr.class,c)&&c.addClass(i[t].a_attr[o]))}return!0}},E.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(e,t){return e+" ("+t+")"}},E.jstree.plugins.unique=function(e,f){this.check=function(e,t,i,r,s){if(!1===f.check.call(this,e,t,i,r,s))return!1;if(t=t&&t.id?t:this.get_node(t),(i=i&&i.id?i:this.get_node(i))&&i.children){for(var a,n="rename_node"===e?r:t.text,o=[],d=this.settings.unique.case_sensitive,c=this.settings.unique.trim_whitespace,l=this._model.data,h=0,_=i.children.length;h<_;h++)a=l[i.children[h]].text,d||(a=a.toLowerCase()),c&&(a=a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),o.push(a);switch(d||(n=n.toLowerCase()),c&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),e){case"delete_node":return!0;case"rename_node":return a=t.text||"",d||(a=a.toLowerCase()),c&&(a=a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),(h=-1===E.inArray(n,o)||t.text&&a===n)||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),h;case"create_node":return(h=-1===E.inArray(n,o))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),h;case"copy_node":return(h=-1===E.inArray(n,o))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),h;case"move_node":return(h=t.parent===i.id&&(!s||!s.is_multi)||-1===E.inArray(n,o))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),h}}return!0},this.create_node=function(e,t,i,r,s){if(!t||t.text===P){if(null===e&&(e=E.jstree.root),!(e=this.get_node(e)))return f.create_node.call(this,e,t,i,r,s);if(!(i=i===P?"last":i).toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(e))return f.create_node.call(this,e,t,i,r,s);t=t||{};for(var a,n,o=this._model.data,d=this.settings.unique.case_sensitive,c=this.settings.unique.trim_whitespace,l=this.settings.unique.duplicate,h=a=this.get_string("New node"),_=[],g=0,u=e.children.length;g<u;g++)n=o[e.children[g]].text,d||(n=n.toLowerCase()),c&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),_.push(n);for(g=1,n=h,d||(n=n.toLowerCase()),c&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==E.inArray(n,_);)n=h=l.call(this,a,++g).toString(),d||(n=n.toLowerCase()),c&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));t.text=h}return f.create_node.call(this,e,t,i,r,s)}},v.createElement("DIV"));if(k.setAttribute("unselectable","on"),k.setAttribute("role","presentation"),k.className="jstree-wholerow",k.innerHTML="&#160;",E.jstree.plugins.wholerow=function(e,a){this.bind=function(){a.bind.call(this),this.element.on("ready.jstree set_state.jstree",function(){this.hide_dots()}.bind(this)).on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-wholerow-ul")}.bind(this)).on("deselect_all.jstree",function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")}.bind(this)).on("changed.jstree",function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var i=!1,r=0,s=t.selected.length;r<s;r++)(i=this.get_node(t.selected[r],!0))&&i.length&&i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("open_node.jstree",function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("hover_node.jstree dehover_node.jstree",function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")}.bind(this)).on("contextmenu.jstree",".jstree-wholerow",function(e){var t;this._data.contextmenu&&(e.preventDefault(),t=E.Event("contextmenu",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,pageX:e.pageX,pageY:e.pageY}),E(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t))}.bind(this)).on("click.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var t=E.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});E(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).trigger("focus")}).on("dblclick.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var t=E.Event("dblclick",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});E(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).trigger("focus")}).on("click.jstree",".jstree-leaf > .jstree-ocl",function(e){e.stopImmediatePropagation();var t=E.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});E(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).trigger("focus")}.bind(this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1}.bind(this)).on("mouseleave.jstree",".jstree-node",function(e){this.dehover_node(e.currentTarget)}.bind(this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),a.teardown.call(this)},this.redraw_node=function(e,t,i,r){var s;return(e=a.redraw_node.apply(this,arguments))&&(s=k.cloneNode(!0),-1!==E.inArray(e.id,this._data.core.selected)&&(s.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===e.id&&(s.className+=" jstree-wholerow-hovered"),e.insertBefore(s,e.childNodes[0])),e}},window.customElements&&Object&&Object.create){e=Object.create(HTMLElement.prototype);e.createdCallback=function(){var e,t={core:{},plugins:[]};for(e in E.jstree.plugins)E.jstree.plugins.hasOwnProperty(e)&&this.attributes[e]&&(t.plugins.push(e),this.getAttribute(e))&&JSON.parse(this.getAttribute(e))&&(t[e]=JSON.parse(this.getAttribute(e)));for(e in E.jstree.defaults.core)E.jstree.defaults.core.hasOwnProperty(e)&&this.attributes[e]&&(t.core[e]=JSON.parse(this.getAttribute(e))||this.getAttribute(e));E(this).jstree(t)};try{window.customElements.define("vakata-jstree",function(){},{prototype:e})}catch(e){}}}});
var leafletControlGeocoder=function(t){function e(o){var n;return o&&o.__esModule?o:(n=Object.create(null),o&&Object.keys(o).forEach(function(t){var e;"default"!==t&&(e=Object.getOwnPropertyDescriptor(o,t),Object.defineProperty(n,t,e.get?e:{enumerable:!0,get:function(){return o[t]}}))}),n.default=o,n)}var c=e(L);function n(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function u(t,e){return c.Util.extend(e,t.geocodingQueryParams)}function p(t,e){return c.Util.extend(e,t.reverseQueryParams)}var r=0,s=/[&<>"'`]/g,i=/[&<>"'`]/,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};function a(t){return o[t]}function l(t,e,o,n,s){var i="_l_geocoder_"+r++,s=(e[s||"callback"]=i,window[i]=c.Util.bind(o,n),document.createElement("script"));s.type="text/javascript",s.src=t+h(e),s.id=i,document.getElementsByTagName("head")[0].appendChild(s)}function d(t,e,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){var e;if(200!==n.status&&304!==n.status)e="";else if("string"==typeof n.response)try{e=JSON.parse(n.response)}catch(t){e=n.response}else e=n.response;o(e)}},n.open("GET",t+h(e),!0),n.responseType="json",n.setRequestHeader("Accept","application/json"),n.send(null)}function M(t,o){return t.replace(/\{ *([\w_]+) *\}/g,function(t,e){var e=o[e];return void 0===e?e="":"function"==typeof e&&(e=e(o)),null==(e=e)?"":e?i.test(e=""+e)?e.replace(s,a):e:e+""})}function h(t,e,o){var n,s=[];for(n in t){var i=encodeURIComponent(o?n.toUpperCase():n),r=t[n];if(Array.isArray(r))for(var a=0;a<r.length;a++)s.push(i+"="+encodeURIComponent(r[a]));else s.push(i+"="+encodeURIComponent(String(r)))}return(e&&-1!==e.indexOf("?")?"&":"?")+s.join("&")}var g=function(){function t(t){this.options={serviceUrl:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",apiKey:""},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,r,a){t=u(this.options,{token:this.options.apiKey,SingleLine:t,outFields:"Addr_Type",forStorage:!1,maxLocations:10,f:"json"});d(this.options.serviceUrl+"/findAddressCandidates",t,function(t){var e=[];if(t.candidates&&t.candidates.length)for(var o=0;o<=t.candidates.length-1;o++){var n=t.candidates[o],s=c.latLng(n.location.y,n.location.x),i=c.latLngBounds(c.latLng(n.extent.ymax,n.extent.xmax),c.latLng(n.extent.ymin,n.extent.xmin));e[o]={name:n.address,bbox:i,center:s}}r.call(a,e)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,s,i){t=p(this.options,{location:t.lng+","+t.lat,distance:100,f:"json"});d(this.options.serviceUrl+"/reverseGeocode",t,function(t){var e,o,n=[];t&&!t.error&&(e=c.latLng(t.location.y,t.location.x),o=c.latLngBounds(e,e),n.push({name:t.address.Match_addr,center:e,bbox:o})),s.call(i,n)})},t}();var f=function(){function t(t){this.options={serviceUrl:"https://dev.virtualearth.net/REST/v1/Locations"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,i,r){t=u(this.options,{query:t,key:this.options.apiKey});l(this.options.apiKey,t,function(t){var e=[];if(0<t.resourceSets.length)for(var o=t.resourceSets[0].resources.length-1;0<=o;o--){var n=t.resourceSets[0].resources[o],s=n.bbox;e[o]={name:n.name,bbox:c.latLngBounds([s[0],s[1]],[s[2],s[3]]),center:c.latLng(n.point.coordinates)}}i.call(r,e)},this,"jsonp")},e.reverse=function(t,e,i,r){var o=p(this.options,{key:this.options.apiKey});l(this.options.serviceUrl+t.lat+","+t.lng,o,function(t){for(var e=[],o=t.resourceSets[0].resources.length-1;0<=o;o--){var n=t.resourceSets[0].resources[o],s=n.bbox;e[o]={name:n.name,bbox:c.latLngBounds([s[0],s[1]],[s[2],s[3]]),center:c.latLng(n.point.coordinates)}}i.call(r,e)},this,"jsonp")},t}();var m=function(){function t(t){this.options={serviceUrl:"https://maps.googleapis.com/maps/api/geocode/json"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,r,a){t=u(this.options,{key:this.options.apiKey,address:t});d(this.options.serviceUrl,t,function(t){var e=[];if(t.results&&t.results.length)for(var o=0;o<=t.results.length-1;o++){var n=t.results[o],s=c.latLng(n.geometry.location),i=c.latLngBounds(c.latLng(n.geometry.viewport.northeast),c.latLng(n.geometry.viewport.southwest));e[o]={name:n.formatted_address,bbox:i,center:s,properties:n.address_components}}r.call(a,e)})},e.reverse=function(t,e,r,a){t=p(this.options,{key:this.options.apiKey,latlng:t.lat+","+t.lng});d(this.options.serviceUrl,t,function(t){var e=[];if(t.results&&t.results.length)for(var o=0;o<=t.results.length-1;o++){var n=t.results[o],s=c.latLng(n.geometry.location),i=c.latLngBounds(c.latLng(n.geometry.viewport.northeast),c.latLng(n.geometry.viewport.southwest));e[o]={name:n.formatted_address,bbox:i,center:s,properties:n.address_components}}r.call(a,e)})},t}();var v=function(){function t(t){if(this.options={serviceUrl:"https://geocoder.api.here.com/6.2/",app_id:"",app_code:"",apiKey:"",maxResults:5},c.Util.setOptions(this,t),t.apiKey)throw Error("apiKey is not supported, use app_id/app_code instead!")}var e=t.prototype;return e.geocode=function(t,e,o){t=u(this.options,{searchtext:t,gen:9,app_id:this.options.app_id,app_code:this.options.app_code,jsonattributes:1,maxresults:this.options.maxResults});this.getJSON(this.options.serviceUrl+"geocode.json",t,e,o)},e.reverse=function(t,e,o,n){t=t.lat+","+t.lng,this.options.reverseGeocodeProxRadius&&(t+=","+this.options.reverseGeocodeProxRadius),t=p(this.options,{prox:t,mode:"retrieveAddresses",app_id:this.options.app_id,app_code:this.options.app_code,gen:9,jsonattributes:1,maxresults:this.options.maxResults});this.getJSON(this.options.serviceUrl+"reversegeocode.json",t,o,n)},e.getJSON=function(t,e,r,a){d(t,e,function(t){var e=[];if(t.response.view&&t.response.view.length)for(var o=0;o<=t.response.view[0].result.length-1;o++){var n=t.response.view[0].result[o].location,s=c.latLng(n.displayPosition.latitude,n.displayPosition.longitude),i=c.latLngBounds(c.latLng(n.mapView.topLeft.latitude,n.mapView.topLeft.longitude),c.latLng(n.mapView.bottomRight.latitude,n.mapView.bottomRight.longitude));e[o]={name:n.address.label,properties:n.address,bbox:i,center:s}}r.call(a,e)})},t}(),_=function(){function t(t){this.options={serviceUrl:"https://geocode.search.hereapi.com/v1",apiKey:"",app_id:"",app_code:"",maxResults:10},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){t=u(this.options,{q:t,apiKey:this.options.apiKey,limit:this.options.maxResults});if(!t.at&&!t.in)throw Error("at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.");this.getJSON(this.options.serviceUrl+"/discover",t,e,o)},e.reverse=function(t,e,o,n){t=p(this.options,{at:t.lat+","+t.lng,limit:this.options.reverseGeocodeProxRadius,apiKey:this.options.apiKey});this.getJSON(this.options.serviceUrl+"/revgeocode",t,o,n)},e.getJSON=function(t,e,r,a){d(t,e,function(t){var e=[];if(t.items&&t.items.length)for(var o=0;o<=t.items.length-1;o++){var n=t.items[o],s=c.latLng(n.position.lat,n.position.lng),i=void 0,i=n.mapView?c.latLngBounds(c.latLng(n.mapView.south,n.mapView.west),c.latLng(n.mapView.north,n.mapView.east)):c.latLngBounds(c.latLng(n.position.lat,n.position.lng),c.latLng(n.position.lat,n.position.lng));e[o]={name:n.address.label,properties:n.address,bbox:i,center:s}}r.call(a,e)})},t}();function b(t){var e;return(e=t.match(/^([NS])\s*(\d{1,3}(?:\.\d*)?)\W*([EW])\s*(\d{1,3}(?:\.\d*)?)$/))?c.latLng((/N/i.test(e[1])?1:-1)*+e[2],(/E/i.test(e[3])?1:-1)*+e[4]):(e=t.match(/^(\d{1,3}(?:\.\d*)?)\s*([NS])\W*(\d{1,3}(?:\.\d*)?)\s*([EW])$/))?c.latLng((/N/i.test(e[2])?1:-1)*+e[1],(/E/i.test(e[4])?1:-1)*+e[3]):(e=t.match(/^([NS])\s*(\d{1,3})Â°?\s*(\d{1,3}(?:\.\d*)?)?['â²]?\W*([EW])\s*(\d{1,3})Â°?\s*(\d{1,3}(?:\.\d*)?)?['â²]?$/))?c.latLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60),(/E/i.test(e[4])?1:-1)*(+e[5]+ +e[6]/60)):(e=t.match(/^(\d{1,3})Â°?\s*(\d{1,3}(?:\.\d*)?)?['â²]?\s*([NS])\W*(\d{1,3})Â°?\s*(\d{1,3}(?:\.\d*)?)?['â²]?\s*([EW])$/))?c.latLng((/N/i.test(e[3])?1:-1)*(+e[1]+ +e[2]/60),(/E/i.test(e[6])?1:-1)*(+e[4]+ +e[5]/60)):(e=t.match(/^([NS])\s*(\d{1,3})Â°?\s*(\d{1,2})['â²]?\s*(\d{1,3}(?:\.\d*)?)?["â³]?\W*([EW])\s*(\d{1,3})Â°?\s*(\d{1,2})['â²]?\s*(\d{1,3}(?:\.\d*)?)?["â³]?$/))?c.latLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60+ +e[4]/3600),(/E/i.test(e[5])?1:-1)*(+e[6]+ +e[7]/60+ +e[8]/3600)):(e=t.match(/^(\d{1,3})Â°?\s*(\d{1,2})['â²]?\s*(\d{1,3}(?:\.\d*)?)?["â³]\s*([NS])\W*(\d{1,3})Â°?\s*(\d{1,2})['â²]?\s*(\d{1,3}(?:\.\d*)?)?["â³]?\s*([EW])$/))?c.latLng((/N/i.test(e[4])?1:-1)*(+e[1]+ +e[2]/60+ +e[3]/3600),(/E/i.test(e[8])?1:-1)*(+e[5]+ +e[6]/60+ +e[7]/3600)):(e=t.match(/^\s*([+-]?\d+(?:\.\d*)?)\s*[\s,]\s*([+-]?\d+(?:\.\d*)?)\s*$/))?c.latLng(+e[1],+e[2]):void 0}var y=function(){function t(t){this.options={next:void 0,sizeInMeters:1e4},c.Util.setOptions(this,t)}return t.prototype.geocode=function(t,e,o){var n=b(t);n?(n=[{name:t,center:n,bbox:n.toBounds(this.options.sizeInMeters)}],e.call(o,n)):this.options.next&&this.options.next.geocode(t,e,o)},t}();var x=function(){function t(t){this.options={serviceUrl:"https://api.mapbox.com/geocoding/v5/mapbox.places/"},c.Util.setOptions(this,t)}var e=t.prototype;return e._getProperties=function(t){for(var e={text:t.text,address:t.address},o=0;o<(t.context||[]).length;o++)e[t.context[o].id.split(".")[0]]=t.context[o].text,t.context[o].short_code&&(e.countryShortCode=t.context[o].short_code);return e},e.geocode=function(t,r,a){var l=this,e=u(this.options,{access_token:this.options.apiKey});void 0!==e.proximity&&void 0!==e.proximity.lat&&void 0!==e.proximity.lng&&(e.proximity=e.proximity.lng+","+e.proximity.lat),d(this.options.serviceUrl+encodeURIComponent(t)+".json",e,function(t){var e=[];if(t.features&&t.features.length)for(var o=0;o<=t.features.length-1;o++){var n=t.features[o],s=c.latLng(n.center.reverse()),i=void 0,i=n.bbox?c.latLngBounds(c.latLng(n.bbox.slice(0,2).reverse()),c.latLng(n.bbox.slice(2,4).reverse())):c.latLngBounds(s,s);e[o]={name:n.place_name,bbox:i,center:s,properties:l._getProperties(n)}}r.call(a,e)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,r,a){var l=this;d(this.options.serviceUrl+t.lng+","+t.lat+".json",p(this.options,{access_token:this.options.apiKey}),function(t){var e=[];if(t.features&&t.features.length)for(var o=0;o<=t.features.length-1;o++){var n=t.features[o],s=c.latLng(n.center.reverse()),i=void 0,i=n.bbox?c.latLngBounds(c.latLng(n.bbox.slice(0,2).reverse()),c.latLng(n.bbox.slice(2,4).reverse())):c.latLngBounds(s,s);e[o]={name:n.place_name,bbox:i,center:s,properties:l._getProperties(n)}}r.call(a,e)})},t}();var U=function(){function t(t){this.options={serviceUrl:"https://www.mapquestapi.com/geocoding/v1"},c.Util.setOptions(this,t),this.options.apiKey=decodeURIComponent(this.options.apiKey)}var e=t.prototype;return e._formatName=function(){return[].slice.call(arguments).filter(function(t){return!!t}).join(", ")},e.geocode=function(t,i,r){t=u(this.options,{key:this.options.apiKey,location:t,limit:5,outFormat:"json"});d(this.options.serviceUrl+"/address",t,c.Util.bind(function(t){var e=[];if(t.results&&t.results[0].locations)for(var o=t.results[0].locations.length-1;0<=o;o--){var n=t.results[0].locations[o],s=c.latLng(n.latLng);e[o]={name:this._formatName(n.street,n.adminArea4,n.adminArea3,n.adminArea1),bbox:c.latLngBounds(s,s),center:s}}i.call(r,e)},this))},e.reverse=function(t,e,i,r){t=p(this.options,{key:this.options.apiKey,location:t.lat+","+t.lng,outputFormat:"json"});d(this.options.serviceUrl+"/reverse",t,c.Util.bind(function(t){var e=[];if(t.results&&t.results[0].locations)for(var o=t.results[0].locations.length-1;0<=o;o--){var n=t.results[0].locations[o],s=c.latLng(n.latLng);e[o]={name:this._formatName(n.street,n.adminArea4,n.adminArea3,n.adminArea1),bbox:c.latLngBounds(s,s),center:s}}i.call(r,e)},this))},t}();var w=function(){function t(t){this.options={userId:void 0,apiKey:void 0,serviceUrl:"https://neutrinoapi.com/"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,s,i){t=u(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,address:t.split(/\s+/).join(".")});d(this.options.serviceUrl+"geocode-address",t,function(t){var e,o,n=[];t.locations&&(t.geometry=t.locations[0],e=c.latLng(t.geometry.latitude,t.geometry.longitude),o=c.latLngBounds(e,e),n[0]={name:t.geometry.address,bbox:o,center:e}),s.call(i,n)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(s,t,i,r){var e=p(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,latitude:s.lat,longitude:s.lng});d(this.options.serviceUrl+"geocode-reverse",e,function(t){var e,o,n=[];200==t.status.status&&t.found&&(e=c.latLng(s.lat,s.lng),o=c.latLngBounds(e,e),n[0]={name:t.address,bbox:o,center:e}),i.call(r,n)})},t}();var C=function(){function t(t){this.options={serviceUrl:"https://nominatim.openstreetmap.org/",htmlTemplate:function(t){var t=t.address,e=[];return(t.road||t.building)&&e.push("{building} {road} {house_number}"),(t.city||t.town||t.village||t.hamlet)&&e.push('<span class="'+(0<e.length?"leaflet-control-geocoder-address-detail":"")+'">{postcode} {city} {town} {village} {hamlet}</span>'),(t.state||t.country)&&e.push('<span class="'+(0<e.length?"leaflet-control-geocoder-address-context":"")+'">{state} {country}</span>'),M(e.join("<br/>"),t)}},c.Util.setOptions(this,t||{})}var e=t.prototype;return e.geocode=function(t,i,r){var a=this,t=u(this.options,{q:t,limit:5,format:"json",addressdetails:1});d(this.options.serviceUrl+"search",t,function(t){for(var e=[],o=t.length-1;0<=o;o--){for(var n=t[o].boundingbox,s=0;s<4;s++)n[s]=+n[s];e[o]={icon:t[o].icon,name:t[o].display_name,html:a.options.htmlTemplate?a.options.htmlTemplate(t[o]):void 0,bbox:c.latLngBounds([n[0],n[2]],[n[1],n[3]]),center:c.latLng(t[o].lat,t[o].lon),properties:t[o]}}i.call(r,e)})},e.reverse=function(t,e,s,i){var r=this,t=p(this.options,{lat:t.lat,lon:t.lng,zoom:Math.round(Math.log(e/256)/Math.log(2)),addressdetails:1,format:"json"});d(this.options.serviceUrl+"reverse",t,function(t){var e,o,n=[];t&&t.lat&&t.lon&&(e=c.latLng(t.lat,t.lon),o=c.latLngBounds(e,e),n.push({name:t.display_name,html:r.options.htmlTemplate?r.options.htmlTemplate(t):void 0,center:e,bbox:o,properties:t})),s.call(i,n)})},t}();var E=function(){function t(t){c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){try{var n=this.options.OpenLocationCode.decode(t),s={name:t,center:c.latLng(n.latitudeCenter,n.longitudeCenter),bbox:c.latLngBounds(c.latLng(n.latitudeLo,n.longitudeLo),c.latLng(n.latitudeHi,n.longitudeHi))};e.call(o,[s])}catch(t){console.warn(t),e.call(o,[])}},e.reverse=function(t,e,o,n){try{var s={name:this.options.OpenLocationCode.encode(t.lat,t.lng,this.options.codeLength),center:c.latLng(t.lat,t.lng),bbox:c.latLngBounds(c.latLng(t.lat,t.lng),c.latLng(t.lat,t.lng))};o.call(n,[s])}catch(t){console.warn(t),o.call(n,[])}},t}();var D=function(){function t(t){this.options={serviceUrl:"https://api.opencagedata.com/geocode/v1/json"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,r,a){t=u(this.options,{key:this.options.apiKey,q:t});d(this.options.serviceUrl,t,function(t){var e=[];if(t.results&&t.results.length)for(var o=0;o<t.results.length;o++){var n=t.results[o],s=c.latLng(n.geometry),i=void 0,i=n.annotations&&n.annotations.bounds?c.latLngBounds(c.latLng(n.annotations.bounds.northeast),c.latLng(n.annotations.bounds.southwest)):c.latLngBounds(s,s);e.push({name:n.formatted,bbox:i,center:s})}r.call(a,e)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,r,a){t=p(this.options,{key:this.options.apiKey,q:[t.lat,t.lng].join(",")});d(this.options.serviceUrl,t,function(t){var e=[];if(t.results&&t.results.length)for(var o=0;o<t.results.length;o++){var n=t.results[o],s=c.latLng(n.geometry),i=void 0,i=n.annotations&&n.annotations.bounds?c.latLngBounds(c.latLng(n.annotations.bounds.northeast),c.latLng(n.annotations.bounds.southwest)):c.latLngBounds(s,s);e.push({name:n.formatted,bbox:i,center:s})}r.call(a,e)})},t}();var k=function(){function t(t){this.options={serviceUrl:"https://api.geocode.earth/v1"},this._lastSuggest=0,c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var n=this,t=u(this.options,{api_key:this.options.apiKey,text:t});d(this.options.serviceUrl+"/search",t,function(t){e.call(o,n._parseResults(t,"bbox"))})},e.suggest=function(t,e,o){var n=this,t=u(this.options,{api_key:this.options.apiKey,text:t});d(this.options.serviceUrl+"/autocomplete",t,function(t){t.geocoding.timestamp>n._lastSuggest&&(n._lastSuggest=t.geocoding.timestamp,e.call(o,n._parseResults(t,"bbox")))})},e.reverse=function(t,e,o,n){var s=this,t=p(this.options,{api_key:this.options.apiKey,"point.lat":t.lat,"point.lon":t.lng});d(this.options.serviceUrl+"/reverse",t,function(t){o.call(n,s._parseResults(t,"bounds"))})},e._parseResults=function(t,i){var r=[];return c.geoJSON(t,{pointToLayer:function(t,e){return c.circleMarker(e)},onEachFeature:function(t,e){var o,n,s={};e.getBounds?n=(o=e.getBounds()).getCenter():o=e.feature.bbox?(n=e.getLatLng(),c.latLngBounds(c.GeoJSON.coordsToLatLng(e.feature.bbox.slice(0,2)),c.GeoJSON.coordsToLatLng(e.feature.bbox.slice(2,4)))):(n=e.getLatLng(),c.latLngBounds(n,n)),s.name=e.feature.properties.label,s.center=n,s[i]=o,s.properties=e.feature.properties,r.push(s)}}),r},t}();function B(t){return new k(t)}var R=k,P=B,G=k,q=B,S=function(e){function t(t){return e.call(this,c.Util.extend({serviceUrl:"https://api.openrouteservice.org/geocode"},t))||this}return n(t,e),t}(k);var O=function(){function t(t){this.options={serviceUrl:"https://photon.komoot.io/api/",reverseUrl:"https://photon.komoot.io/reverse/",nameProperties:["name","street","suburb","hamlet","town","city","state","country"]},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){t=u(this.options,{q:t});d(this.options.serviceUrl,t,c.Util.bind(function(t){e.call(o,this._decodeFeatures(t))},this))},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,o,n){t=p(this.options,{lat:t.lat,lon:t.lng});d(this.options.reverseUrl,t,c.Util.bind(function(t){o.call(n,this._decodeFeatures(t))},this))},e._decodeFeatures=function(t){var e=[];if(t&&t.features)for(var o=0;o<t.features.length;o++){var n=t.features[o],s=n.geometry.coordinates,s=c.latLng(s[1],s[0]),i=n.properties.extent,i=i?c.latLngBounds([i[1],i[0]],[i[3],i[2]]):c.latLngBounds(s,s);e.push({name:this._decodeFeatureName(n),html:this.options.htmlTemplate?this.options.htmlTemplate(n):void 0,center:s,bbox:i,properties:n.properties})}return e},e._decodeFeatureName=function(e){return(this.options.nameProperties||[]).map(function(t){return e.properties[t]}).filter(function(t){return!!t}).join(", ")},t}();var K=function(){function t(t){this.options={serviceUrl:"https://api.what3words.com/v2/"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,s,i){d(this.options.serviceUrl+"forward",u(this.options,{key:this.options.apiKey,addr:t.split(/\s+/).join(".")}),function(t){var e,o,n=[];t.geometry&&(e=c.latLng(t.geometry.lat,t.geometry.lng),o=c.latLngBounds(e,e),n[0]={name:t.words,bbox:o,center:e}),s.call(i,n)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,s,i){d(this.options.serviceUrl+"reverse",p(this.options,{key:this.options.apiKey,coords:[t.lat,t.lng].join(",")}),function(t){var e,o,n=[];200==t.status.status&&(e=c.latLng(t.geometry.lat,t.geometry.lng),o=c.latLngBounds(e,e),n[0]={name:t.words,bbox:o,center:e}),s.call(i,n)})},t}();function T(){}var R={__proto__:null,geocodingParams:u,reverseParams:p,ArcGis:g,arcgis:function(t){return new g(t)},Bing:f,bing:function(t){return new f(t)},Google:m,google:function(t){return new m(t)},HERE:v,HEREv2:_,here:function(t){return new(t.apiKey?_:v)(t)},parseLatLng:b,LatLng:y,latLng:function(t){return new y(t)},Mapbox:x,mapbox:function(t){return new x(t)},MapQuest:U,mapQuest:function(t){return new U(t)},Neutrino:w,neutrino:function(t){return new w(t)},Nominatim:C,nominatim:function(t){return new C(t)},OpenLocationCode:E,openLocationCode:function(t){return new E(t)},OpenCage:D,opencage:function(t){return new D(t)},Pelias:k,pelias:B,GeocodeEarth:R,geocodeEarth:P,Mapzen:G,mapzen:q,Openrouteservice:S,openrouteservice:function(t){return new S(t)},Photon:O,photon:function(t){return new O(t)},What3Words:K,what3words:function(t){return new K(t)}},j=(c.Util.extend(T.prototype,c.Control.prototype),c.Util.extend(T.prototype,c.Evented.prototype),function(o){function t(t){var e=o.call(this,t)||this;return e.options={showUniqueResult:!0,showResultIcons:!1,collapsed:!0,expand:"touch",position:"topright",placeholder:"Search...",errorMessage:"Nothing found.",iconLabel:"Initiate a new search",query:"",queryMinLength:1,suggestMinLength:3,suggestTimeout:250,defaultMarkGeocode:!0},e._requestCount=0,c.Util.setOptions(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e),t),e.options.geocoder||(e.options.geocoder=new C),e}n(t,o);var e=t.prototype;return e.addThrobberClass=function(){c.DomUtil.addClass(this._container,"leaflet-control-geocoder-throbber")},e.removeThrobberClass=function(){c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-throbber")},e.onAdd=function(t){var e=this,o="leaflet-control-geocoder",n=c.DomUtil.create("div",o+" leaflet-bar"),s=c.DomUtil.create("button",o+"-icon",n),i=this._form=c.DomUtil.create("div",o+"-form",n),t=(this._map=t,this._container=n,s.innerHTML="&nbsp;",s.type="button",s.setAttribute("aria-label",this.options.iconLabel),this._input=c.DomUtil.create("input","",i));return t.type="text",t.value=this.options.query,t.placeholder=this.options.placeholder,c.DomEvent.disableClickPropagation(t),this._errorElement=c.DomUtil.create("div",o+"-form-no-error",n),this._errorElement.innerHTML=this.options.errorMessage,this._alts=c.DomUtil.create("ul",o+"-alternatives leaflet-control-geocoder-alternatives-minimized",n),c.DomEvent.disableClickPropagation(this._alts),c.DomEvent.addListener(t,"keydown",this._keydown,this),this.options.geocoder.suggest&&c.DomEvent.addListener(t,"input",this._change,this),c.DomEvent.addListener(t,"blur",function(){e.options.collapsed&&!e._preventBlurCollapse&&e._collapse(),e._preventBlurCollapse=!1}),this.options.collapsed?"click"===this.options.expand?c.DomEvent.addListener(n,"click",function(t){0===t.button&&2!==t.detail&&e._toggle()}):"touch"===this.options.expand?c.DomEvent.addListener(n,c.Browser.touch?"touchstart mousedown":"mousedown",function(t){e._toggle(),t.preventDefault(),t.stopPropagation()},this):(c.DomEvent.addListener(n,"mouseover",this._expand,this),c.DomEvent.addListener(n,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):(this._expand(),c.Browser.touch?c.DomEvent.addListener(n,"touchstart",function(){return e._geocode()}):c.DomEvent.addListener(n,"click",function(){return e._geocode()})),this.options.defaultMarkGeocode&&this.on("markgeocode",this.markGeocode,this),this.on("startgeocode",this.addThrobberClass,this),this.on("finishgeocode",this.removeThrobberClass,this),this.on("startsuggest",this.addThrobberClass,this),this.on("finishsuggest",this.removeThrobberClass,this),c.DomEvent.disableClickPropagation(n),n},e.setQuery=function(t){return this._input.value=t,this},e._geocodeResult=function(t,e){if(!e&&this.options.showUniqueResult&&1===t.length)this._geocodeResultSelected(t[0]);else if(0<t.length){this._alts.innerHTML="",this._results=t,c.DomUtil.removeClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),c.DomUtil.addClass(this._container,"leaflet-control-geocoder-options-open");for(var o=0;o<t.length;o++)this._alts.appendChild(this._createAlt(t[o],o))}else c.DomUtil.addClass(this._container,"leaflet-control-geocoder-options-error"),c.DomUtil.addClass(this._errorElement,"leaflet-control-geocoder-error")},e.markGeocode=function(t){t=t.geocode;return this._map.fitBounds(t.bbox),this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker),this._geocodeMarker=new c.Marker(t.center).bindPopup(t.html||t.name).addTo(this._map).openPopup(),this},e._geocode=function(e){var o,t,n=this,s=this._input.value;!e&&s.length<this.options.queryMinLength||(o=++this._requestCount,t=function(t){o===n._requestCount&&(n.fire(e?"finishsuggest":"finishgeocode",{input:s,results:t}),n._geocodeResult(t,e))},this._lastGeocode=s,e||this._clearResults(),this.fire(e?"startsuggest":"startgeocode",{input:s}),e?this.options.geocoder.suggest(s,t):this.options.geocoder.geocode(s,t))},e._geocodeResultSelected=function(t){this.fire("markgeocode",{geocode:t})},e._toggle=function(){c.DomUtil.hasClass(this._container,"leaflet-control-geocoder-expanded")?this._collapse():this._expand()},e._expand=function(){c.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded"),this._input.select(),this.fire("expand")},e._collapse=function(){c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-expanded"),c.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),c.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error"),c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-open"),c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-error"),this._input.blur(),this.fire("collapse")},e._clearResults=function(){c.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),this._selection=null,c.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error"),c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-open"),c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-error")},e._createAlt=function(e,t){var o=this,n=c.DomUtil.create("li",""),s=c.DomUtil.create("a","",n),i=this.options.showResultIcons&&e.icon?c.DomUtil.create("img","",s):null,r=e.html?void 0:document.createTextNode(e.name);return i&&(i.src=e.icon),n.setAttribute("data-result-index",String(t)),e.html?s.innerHTML=s.innerHTML+e.html:r&&s.appendChild(r),c.DomEvent.addListener(n,"mousedown touchstart",function(t){o._preventBlurCollapse=!0,c.DomEvent.stop(t),o._geocodeResultSelected(e),c.DomEvent.on(n,"click touchend",function(){o.options.collapsed?o._collapse():o._clearResults()})},this),n},e._keydown=function(t){function e(t){n._selection&&(c.DomUtil.removeClass(n._selection,"leaflet-control-geocoder-selected"),n._selection=n._selection[0<t?"nextSibling":"previousSibling"]),n._selection||(n._selection=n._alts[0<t?"firstChild":"lastChild"]),n._selection&&c.DomUtil.addClass(n._selection,"leaflet-control-geocoder-selected")}var o,n=this;switch(t.keyCode){case 27:this.options.collapsed?this._collapse():this._clearResults();break;case 38:e(-1);break;case 40:e(1);break;case 13:this._selection?(o=parseInt(this._selection.getAttribute("data-result-index"),10),this._geocodeResultSelected(this._results[o]),this._clearResults()):this._geocode();break;default:return}c.DomEvent.preventDefault(t)},e._change=function(){var t=this,e=this._input.value;e!==this._lastGeocode&&(clearTimeout(this._suggestTimeout),e.length>=this.options.suggestMinLength?this._suggestTimeout=setTimeout(function(){return t._geocode(!0)},this.options.suggestTimeout):this._clearResults())},t}(T));function N(t){return new j(t)}return c.Util.extend(j,R),c.Util.extend(c.Control,{Geocoder:j,geocoder:N}),t.Geocoder=j,t.default=j,t.geocoder=N,t.geocoders=R,t}({});
!function(){function o(t,i){this.title=t.title,this.stateName=t.stateName||"unnamed-state",this.icon=L.DomUtil.create("span",""),L.DomUtil.addClass(this.icon,"button-state state-"+this.stateName.replace(/(^\s*|\s*$)/g,"")),this.icon.innerHTML=function(t){var i;i=t.match(/[&;=<>"']/)?t:(t=t.replace(/(^\s*|\s*$)/g,""),i=L.DomUtil.create("span",""),0===t.indexOf("fa-")?L.DomUtil.addClass(i,"fa "+t):0===t.indexOf("glyphicon-")?L.DomUtil.addClass(i,"glyphicon "+t):L.DomUtil.addClass(i,t),i.outerHTML);return i}(t.icon),this.onClick=L.Util.bind(t.onClick||function(){},i)}L.Control.EasyBar=L.Control.extend({options:{position:"topleft",id:null,leafletClasses:!0},initialize:function(t,i){i&&L.Util.setOptions(this,i),this._buildContainer(),this._buttons=[];for(var e=0;e<t.length;e++)t[e]._bar=this,t[e]._container=t[e].button,this._buttons.push(t[e]),this.container.appendChild(t[e].button)},_buildContainer:function(){this._container=this.container=L.DomUtil.create("div",""),this.options.leafletClasses&&L.DomUtil.addClass(this.container,"leaflet-bar easy-button-container leaflet-control"),this.options.id&&(this.container.id=this.options.id)},enable:function(){return L.DomUtil.addClass(this.container,"enabled"),L.DomUtil.removeClass(this.container,"disabled"),this.container.setAttribute("aria-hidden","false"),this},disable:function(){return L.DomUtil.addClass(this.container,"disabled"),L.DomUtil.removeClass(this.container,"enabled"),this.container.setAttribute("aria-hidden","true"),this},onAdd:function(){return this.container},addTo:function(t){this._map=t;for(var i=0;i<this._buttons.length;i++)this._buttons[i]._map=t;var e=this._container=this.onAdd(t),s=this.getPosition(),n=t._controlCorners[s];return L.DomUtil.addClass(e,"leaflet-control"),-1!==s.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this}}),L.easyBar=function(){for(var t=[L.Control.EasyBar],i=0;i<arguments.length;i++)t.push(arguments[i]);return new(Function.prototype.bind.apply(L.Control.EasyBar,t))},L.Control.EasyButton=L.Control.extend({options:{position:"topleft",id:null,type:"replace",states:[],leafletClasses:!0,tagName:"button"},initialize:function(t,i,e,s){this.options.states=[],null!=s&&(this.options.id=s),this.storage={},"object"==typeof arguments[arguments.length-1]&&L.Util.setOptions(this,arguments[arguments.length-1]),0===this.options.states.length&&"string"==typeof t&&"function"==typeof i&&this.options.states.push({icon:t,onClick:i,title:"string"==typeof e?e:""}),this._states=[];for(var n=0;n<this.options.states.length;n++)this._states.push(new o(this.options.states[n],this));this._buildButton(),this._activateState(this._states[0])},_buildButton:function(){if(this.button=L.DomUtil.create(this.options.tagName,""),"button"===this.options.tagName&&this.button.setAttribute("type","button"),this.options.id&&(this.button.id=this.options.id),this.options.leafletClasses&&L.DomUtil.addClass(this.button,"easy-button-button leaflet-bar-part leaflet-interactive"),L.DomEvent.addListener(this.button,"dblclick",L.DomEvent.stop),L.DomEvent.addListener(this.button,"mousedown",L.DomEvent.stop),L.DomEvent.addListener(this.button,"mouseup",L.DomEvent.stop),L.DomEvent.addListener(this.button,"click",function(t){L.DomEvent.stop(t),this._currentState.onClick(this,this._map||null),this._map&&this._map.getContainer().focus()},this),"replace"==this.options.type)this.button.appendChild(this._currentState.icon);else for(var t=0;t<this._states.length;t++)this.button.appendChild(this._states[t].icon)},_currentState:{stateName:"unnamed",icon:document.createElement("span")},_states:null,state:function(t){return 0===arguments.length?this._currentState.stateName:("string"==typeof t?this._activateStateNamed(t):"number"==typeof t&&this._activateState(this._states[t]),this)},_activateStateNamed:function(t){for(var i=0;i<this._states.length;i++)this._states[i].stateName==t&&this._activateState(this._states[i])},_activateState:function(t){if(t!==this._currentState){"replace"==this.options.type&&(this.button.appendChild(t.icon),this.button.removeChild(this._currentState.icon)),t.title?this.button.title=t.title:this.button.removeAttribute("title");for(var i=0;i<this._states.length;i++)L.DomUtil.removeClass(this._states[i].icon,this._currentState.stateName+"-active"),L.DomUtil.addClass(this._states[i].icon,t.stateName+"-active");L.DomUtil.removeClass(this.button,this._currentState.stateName+"-active"),L.DomUtil.addClass(this.button,t.stateName+"-active"),this._currentState=t}},enable:function(){return L.DomUtil.addClass(this.button,"enabled"),L.DomUtil.removeClass(this.button,"disabled"),this.button.setAttribute("aria-hidden","false"),this},disable:function(){return L.DomUtil.addClass(this.button,"disabled"),L.DomUtil.removeClass(this.button,"enabled"),this.button.setAttribute("aria-hidden","true"),this},onAdd:function(t){var i=L.easyBar([this],{position:this.options.position,leafletClasses:this.options.leafletClasses});return this._anonymousBar=i,this._container=i.container,this._anonymousBar.container},removeFrom:function(t){return this._map===t&&this.remove(),this}}),L.easyButton=function(){var t=Array.prototype.concat.apply([L.Control.EasyButton],arguments);return new(Function.prototype.bind.apply(L.Control.EasyButton,t))}}();
"use strict";!function(t,e){"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports&&(module.exports=t(require("leaflet"))),void 0!==e&&e.L&&t(e.L)}(function(d){d.Editable=d.Evented.extend({statics:{FORWARD:1,BACKWARD:-1},options:{zIndex:1e3,polygonClass:d.Polygon,polylineClass:d.Polyline,markerClass:d.Marker,rectangleClass:d.Rectangle,circleClass:d.Circle,drawingCSSClass:"leaflet-editable-drawing",drawingCursor:"crosshair",editLayer:void 0,featuresLayer:void 0,polylineEditorClass:void 0,polygonEditorClass:void 0,markerEditorClass:void 0,rectangleEditorClass:void 0,circleEditorClass:void 0,lineGuideOptions:{},skipMiddleMarkers:!1},initialize:function(t,e){d.setOptions(this,e),this._lastZIndex=this.options.zIndex,this.map=t,this.editLayer=this.createEditLayer(),this.featuresLayer=this.createFeaturesLayer(),this.forwardLineGuide=this.createLineGuide(),this.backwardLineGuide=this.createLineGuide()},fireAndForward:function(t,e){((e=e||{}).editTools=this).fire(t,e),this.map.fire(t,e)},createLineGuide:function(){var t=d.extend({dashArray:"5,10",weight:1,interactive:!1},this.options.lineGuideOptions);return d.polyline([],t)},createVertexIcon:function(t){return new(d.Browser.mobile&&d.Browser.touch?d.Editable.TouchVertexIcon:d.Editable.VertexIcon)(t)},createEditLayer:function(){return this.options.editLayer||(new d.LayerGroup).addTo(this.map)},createFeaturesLayer:function(){return this.options.featuresLayer||(new d.LayerGroup).addTo(this.map)},moveForwardLineGuide:function(t){this.forwardLineGuide._latlngs.length&&(this.forwardLineGuide._latlngs[1]=t,this.forwardLineGuide._bounds.extend(t),this.forwardLineGuide.redraw())},moveBackwardLineGuide:function(t){this.backwardLineGuide._latlngs.length&&(this.backwardLineGuide._latlngs[1]=t,this.backwardLineGuide._bounds.extend(t),this.backwardLineGuide.redraw())},anchorForwardLineGuide:function(t){this.forwardLineGuide._latlngs[0]=t,this.forwardLineGuide._bounds.extend(t),this.forwardLineGuide.redraw()},anchorBackwardLineGuide:function(t){this.backwardLineGuide._latlngs[0]=t,this.backwardLineGuide._bounds.extend(t),this.backwardLineGuide.redraw()},attachForwardLineGuide:function(){this.editLayer.addLayer(this.forwardLineGuide)},attachBackwardLineGuide:function(){this.editLayer.addLayer(this.backwardLineGuide)},detachForwardLineGuide:function(){this.forwardLineGuide.setLatLngs([]),this.editLayer.removeLayer(this.forwardLineGuide)},detachBackwardLineGuide:function(){this.backwardLineGuide.setLatLngs([]),this.editLayer.removeLayer(this.backwardLineGuide)},blockEvents:function(){this._oldTargets||(this._oldTargets=this.map._targets,this.map._targets={})},unblockEvents:function(){this._oldTargets&&(this.map._targets=d.extend(this.map._targets,this._oldTargets),delete this._oldTargets)},registerForDrawing:function(t){this._drawingEditor&&this.unregisterForDrawing(this._drawingEditor),this.blockEvents(),t.reset(),this._drawingEditor=t,this.map.on("mousemove touchmove",t.onDrawingMouseMove,t),this.map.on("mousedown",this.onMousedown,this),this.map.on("mouseup",this.onMouseup,this),d.DomUtil.addClass(this.map._container,this.options.drawingCSSClass),this.defaultMapCursor=this.map._container.style.cursor,this.map._container.style.cursor=this.options.drawingCursor},unregisterForDrawing:function(t){this.unblockEvents(),d.DomUtil.removeClass(this.map._container,this.options.drawingCSSClass),this.map._container.style.cursor=this.defaultMapCursor,(t=t||this._drawingEditor)&&(this.map.off("mousemove touchmove",t.onDrawingMouseMove,t),this.map.off("mousedown",this.onMousedown,this),this.map.off("mouseup",this.onMouseup,this),t===this._drawingEditor)&&(delete this._drawingEditor,t._drawing)&&t.cancelDrawing()},onMousedown:function(t){1==t.originalEvent.which&&(this._mouseDown=t,this._drawingEditor.onDrawingMouseDown(t))},onMouseup:function(t){var e,i;this._mouseDown&&(e=this._drawingEditor,i=this._mouseDown,this._mouseDown=null,e.onDrawingMouseUp(t),this._drawingEditor===e)&&(e=d.point(i.originalEvent.clientX,i.originalEvent.clientY),i=d.point(t.originalEvent.clientX,t.originalEvent.clientY).distanceTo(e),Math.abs(i)<9*(window.devicePixelRatio||1))&&this._drawingEditor.onDrawingClick(t)},drawing:function(){return this._drawingEditor&&this._drawingEditor.drawing()},stopDrawing:function(){this.unregisterForDrawing()},commitDrawing:function(t){this._drawingEditor&&this._drawingEditor.commitDrawing(t)},connectCreatedToMap:function(t){return this.featuresLayer.addLayer(t)},startPolyline:function(t,e){e=this.createPolyline([],e);return e.enableEdit(this.map).newShape(t),e},startPolygon:function(t,e){e=this.createPolygon([],e);return e.enableEdit(this.map).newShape(t),e},startMarker:function(t,e){t=t||this.map.getCenter().clone();t=this.createMarker(t,e);return t.enableEdit(this.map).startDrawing(),t},startRectangle:function(t,e){t=t||d.latLng([0,0]),t=new d.LatLngBounds(t,t),t=this.createRectangle(t,e);return t.enableEdit(this.map).startDrawing(),t},startCircle:function(t,e){t=t||this.map.getCenter().clone();t=this.createCircle(t,e);return t.enableEdit(this.map).startDrawing(),t},startHole:function(t,e){t.newHole(e)},createLayer:function(t,e,i){t=new t(e,i=d.Util.extend({editOptions:{editTools:this}},i));return this.fireAndForward("editable:created",{layer:t}),t},createPolyline:function(t,e){return this.createLayer(e&&e.polylineClass||this.options.polylineClass,t,e)},createPolygon:function(t,e){return this.createLayer(e&&e.polygonClass||this.options.polygonClass,t,e)},createMarker:function(t,e){return this.createLayer(e&&e.markerClass||this.options.markerClass,t,e)},createRectangle:function(t,e){return this.createLayer(e&&e.rectangleClass||this.options.rectangleClass,t,e)},createCircle:function(t,e){return this.createLayer(e&&e.circleClass||this.options.circleClass,t,e)}}),d.extend(d.Editable,{makeCancellable:function(t){t.cancel=function(){t._cancelled=!0}}}),d.Map.mergeOptions({editToolsClass:d.Editable,editable:!1,editOptions:{}}),d.Map.addInitHook(function(){this.whenReady(function(){this.options.editable&&(this.editTools=new this.options.editToolsClass(this,this.options.editOptions))})}),d.Editable.VertexIcon=d.DivIcon.extend({options:{iconSize:new d.Point(8,8)}}),d.Editable.TouchVertexIcon=d.Editable.VertexIcon.extend({options:{iconSize:new d.Point(20,20)}}),d.Editable.VertexMarker=d.Marker.extend({options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon"},initialize:function(t,e,i,n){this.latlng=t,this.latlngs=e,this.editor=i,d.Marker.prototype.initialize.call(this,t,n),this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),(this.latlng.__vertex=this).editor.editLayer.addLayer(this),this.setZIndexOffset(i.tools._lastZIndex+1)},onAdd:function(t){d.Marker.prototype.onAdd.call(this,t),this.on("drag",this.onDrag),this.on("dragstart",this.onDragStart),this.on("dragend",this.onDragEnd),this.on("mouseup",this.onMouseup),this.on("click",this.onClick),this.on("contextmenu",this.onContextMenu),this.on("mousedown touchstart",this.onMouseDown),this.on("mouseover",this.onMouseOver),this.on("mouseout",this.onMouseOut),this.addMiddleMarkers()},onRemove:function(t){this.middleMarker&&this.middleMarker.delete(),delete this.latlng.__vertex,this.off("drag",this.onDrag),this.off("dragstart",this.onDragStart),this.off("dragend",this.onDragEnd),this.off("mouseup",this.onMouseup),this.off("click",this.onClick),this.off("contextmenu",this.onContextMenu),this.off("mousedown touchstart",this.onMouseDown),this.off("mouseover",this.onMouseOver),this.off("mouseout",this.onMouseOut),d.Marker.prototype.onRemove.call(this,t)},onDrag:function(t){(t.vertex=this).editor.onVertexMarkerDrag(t);t=d.DomUtil.getPosition(this._icon),t=this._map.layerPointToLatLng(t),this.latlng.update(t),this._latlng=this.latlng,this.editor.refresh(),this.middleMarker&&this.middleMarker.updateLatLng(),t=this.getNext();t&&t.middleMarker&&t.middleMarker.updateLatLng()},onDragStart:function(t){(t.vertex=this).editor.onVertexMarkerDragStart(t)},onDragEnd:function(t){(t.vertex=this).editor.onVertexMarkerDragEnd(t)},onClick:function(t){(t.vertex=this).editor.onVertexMarkerClick(t)},onMouseup:function(t){d.DomEvent.stop(t),(t.vertex=this).editor.map.fire("mouseup",t)},onContextMenu:function(t){(t.vertex=this).editor.onVertexMarkerContextMenu(t)},onMouseDown:function(t){(t.vertex=this).editor.onVertexMarkerMouseDown(t)},onMouseOver:function(t){(t.vertex=this).editor.onVertexMarkerMouseOver(t)},onMouseOut:function(t){(t.vertex=this).editor.onVertexMarkerMouseOut(t)},delete:function(){var t=this.getNext();this.latlngs.splice(this.getIndex(),1),this.editor.editLayer.removeLayer(this),this.editor.onVertexDeleted({latlng:this.latlng,vertex:this}),this.latlngs.length||this.editor.deleteShape(this.latlngs),t&&t.resetMiddleMarker(),this.editor.refresh()},getIndex:function(){return this.latlngs.indexOf(this.latlng)},getLastIndex:function(){return this.latlngs.length-1},getPrevious:function(){var t,e;if(!(this.latlngs.length<2))return t=(e=this.getIndex())-1,0===e&&this.editor.CLOSED&&(t=this.getLastIndex()),(e=this.latlngs[t])?e.__vertex:void 0},getNext:function(){var t,e;if(!(this.latlngs.length<2))return t=(e=this.getIndex())+1,e===this.getLastIndex()&&this.editor.CLOSED&&(t=0),(e=this.latlngs[t])?e.__vertex:void 0},addMiddleMarker:function(t){this.editor.hasMiddleMarkers()&&(t=t||this.getPrevious())&&!this.middleMarker&&(this.middleMarker=this.editor.addMiddleMarker(t,this,this.latlngs,this.editor))},addMiddleMarkers:function(){var t;this.editor.hasMiddleMarkers()&&((t=this.getPrevious())&&this.addMiddleMarker(t),t=this.getNext())&&t.resetMiddleMarker()},resetMiddleMarker:function(){this.middleMarker&&this.middleMarker.delete(),this.addMiddleMarker()},split:function(){this.editor.splitShape&&this.editor.splitShape(this.latlngs,this.getIndex())},continue:function(){var t;this.editor.continueBackward&&(0===(t=this.getIndex())?this.editor.continueBackward(this.latlngs):t===this.getLastIndex()&&this.editor.continueForward(this.latlngs))}}),d.Editable.mergeOptions({vertexMarkerClass:d.Editable.VertexMarker}),d.Editable.MiddleMarker=d.Marker.extend({options:{opacity:.5,className:"leaflet-div-icon leaflet-middle-icon",draggable:!0},initialize:function(t,e,i,n,r){this.left=t,this.right=e,this.editor=n,this.latlngs=i,d.Marker.prototype.initialize.call(this,this.computeLatLng(),r),this._opacity=this.options.opacity,this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.editor.editLayer.addLayer(this),this.setVisibility()},setVisibility:function(){var t=this._map.latLngToContainerPoint(this.left.latlng),e=this._map.latLngToContainerPoint(this.right.latlng),i=d.point(this.options.icon.options.iconSize);t.distanceTo(e)<3*i.x?this.hide():this.show()},show:function(){this.setOpacity(this._opacity)},hide:function(){this.setOpacity(0)},updateLatLng:function(){this.setLatLng(this.computeLatLng()),this.setVisibility()},computeLatLng:function(){var t=this.editor.map.latLngToContainerPoint(this.left.latlng),e=this.editor.map.latLngToContainerPoint(this.right.latlng),i=(t.y+e.y)/2,t=(t.x+e.x)/2;return this.editor.map.containerPointToLatLng([t,i])},onAdd:function(t){d.Marker.prototype.onAdd.call(this,t),d.DomEvent.on(this._icon,"mousedown touchstart",this.onMouseDown,this),t.on("zoomend",this.setVisibility,this)},onRemove:function(t){delete this.right.middleMarker,d.DomEvent.off(this._icon,"mousedown touchstart",this.onMouseDown,this),t.off("zoomend",this.setVisibility,this),d.Marker.prototype.onRemove.call(this,t)},onMouseDown:function(t){var e,i,n=d.DomUtil.getPosition(this._icon);t={originalEvent:t,latlng:this.editor.map.layerPointToLatLng(n)},0===this.options.opacity||(d.Editable.makeCancellable(t),this.editor.onMiddleMarkerMouseDown(t),t._cancelled)||(this.latlngs.splice(this.index(),0,t.latlng),this.editor.refresh(),n=this._icon,e=this.editor.addVertexMarker(t.latlng,this.latlngs),this.editor.onNewVertex(e),(i=e._icon.parentNode).removeChild(e._icon),e._icon=n,i.appendChild(e._icon),e._initIcon(),e._initInteraction(),e.setOpacity(1),d.Draggable._dragging=!1,e.dragging._draggable._onDown(t.originalEvent),this.delete())},delete:function(){this.editor.editLayer.removeLayer(this)},index:function(){return this.latlngs.indexOf(this.right.latlng)}}),d.Editable.mergeOptions({middleMarkerClass:d.Editable.MiddleMarker}),d.Editable.BaseEditor=d.Handler.extend({initialize:function(t,e,i){d.setOptions(this,i),this.map=t,this.feature=e,(this.feature.editor=this).editLayer=new d.LayerGroup,this.tools=this.options.editTools||t.editTools},addHooks:function(){this.isConnected()?this.onFeatureAdd():this.feature.once("add",this.onFeatureAdd,this),this.onEnable(),this.feature.on(this._getEvents(),this)},removeHooks:function(){this.feature.off(this._getEvents(),this),this.feature.dragging&&this.feature.dragging.disable(),this.editLayer.clearLayers(),this.tools.editLayer.removeLayer(this.editLayer),this.onDisable(),this._drawing&&this.cancelDrawing()},drawing:function(){return!!this._drawing},reset:function(){},onFeatureAdd:function(){this.tools.editLayer.addLayer(this.editLayer),this.feature.dragging&&this.feature.dragging.enable()},hasMiddleMarkers:function(){return!this.options.skipMiddleMarkers&&!this.tools.options.skipMiddleMarkers},fireAndForward:function(t,e){(e=e||{}).layer=this.feature,this.feature.fire(t,e),this.tools.fireAndForward(t,e)},onEnable:function(){this.fireAndForward("editable:enable")},onDisable:function(){this.fireAndForward("editable:disable")},onEditing:function(){this.fireAndForward("editable:editing")},onStartDrawing:function(){this.fireAndForward("editable:drawing:start")},onEndDrawing:function(){this.fireAndForward("editable:drawing:end")},onCancelDrawing:function(){this.fireAndForward("editable:drawing:cancel")},onCommitDrawing:function(t){this.fireAndForward("editable:drawing:commit",t)},onDrawingMouseDown:function(t){this.fireAndForward("editable:drawing:mousedown",t)},onDrawingMouseUp:function(t){this.fireAndForward("editable:drawing:mouseup",t)},startDrawing:function(){this._drawing||(this._drawing=d.Editable.FORWARD),this.tools.registerForDrawing(this),this.onStartDrawing()},commitDrawing:function(t){this.onCommitDrawing(t),this.endDrawing()},cancelDrawing:function(){d.Draggable._dragging=!1,this.onCancelDrawing(),this.endDrawing()},endDrawing:function(){this._drawing=!1,this.tools.unregisterForDrawing(this),this.onEndDrawing()},onDrawingClick:function(t){this.drawing()&&(d.Editable.makeCancellable(t),this.fireAndForward("editable:drawing:click",t),t._cancelled||(this.isConnected()||this.connect(t),this.processDrawingClick(t)))},isConnected:function(){return this.map.hasLayer(this.feature)},connect:function(){this.tools.connectCreatedToMap(this.feature),this.tools.editLayer.addLayer(this.editLayer)},onMove:function(t){this.fireAndForward("editable:drawing:move",t)},onDrawingMouseMove:function(t){this.onMove(t)},_getEvents:function(){return{dragstart:this.onDragStart,drag:this.onDrag,dragend:this.onDragEnd,remove:this.disable}},onDragStart:function(t){this.onEditing(),this.fireAndForward("editable:dragstart",t)},onDrag:function(t){this.onMove(t),this.fireAndForward("editable:drag",t)},onDragEnd:function(t){this.fireAndForward("editable:dragend",t)}}),d.Editable.MarkerEditor=d.Editable.BaseEditor.extend({onDrawingMouseMove:function(t){d.Editable.BaseEditor.prototype.onDrawingMouseMove.call(this,t),this._drawing&&this.feature.setLatLng(t.latlng)},processDrawingClick:function(t){this.fireAndForward("editable:drawing:clicked",t),this.commitDrawing(t)},connect:function(t){t&&(this.feature._latlng=t.latlng),d.Editable.BaseEditor.prototype.connect.call(this,t)}}),d.Editable.PathEditor=d.Editable.BaseEditor.extend({CLOSED:!1,MIN_VERTEX:2,addHooks:function(){return d.Editable.BaseEditor.prototype.addHooks.call(this),this.feature&&this.initVertexMarkers(),this},initVertexMarkers:function(t){if(this.enabled())if(t=t||this.getLatLngs(),o(t))this.addVertexMarkers(t);else for(var e=0;e<t.length;e++)this.initVertexMarkers(t[e])},getLatLngs:function(){return this.feature.getLatLngs()},reset:function(){this.editLayer.clearLayers(),this.initVertexMarkers()},addVertexMarker:function(t,e){return new this.tools.options.vertexMarkerClass(t,e,this)},onNewVertex:function(t){this.fireAndForward("editable:vertex:new",{latlng:t.latlng,vertex:t})},addVertexMarkers:function(t){for(var e=0;e<t.length;e++)this.addVertexMarker(t[e],t)},refreshVertexMarkers:function(t){t=t||this.getDefaultLatLngs();for(var e=0;e<t.length;e++)t[e].__vertex.update()},addMiddleMarker:function(t,e,i){return new this.tools.options.middleMarkerClass(t,e,i,this)},onVertexMarkerClick:function(t){var e,i;d.Editable.makeCancellable(t),this.fireAndForward("editable:vertex:click",t),t._cancelled||this.tools.drawing()&&this.tools._drawingEditor!==this||(e=t.vertex.getIndex(),t.originalEvent.ctrlKey?this.onVertexMarkerCtrlClick(t):t.originalEvent.altKey?this.onVertexMarkerAltClick(t):t.originalEvent.shiftKey?this.onVertexMarkerShiftClick(t):t.originalEvent.metaKey?this.onVertexMarkerMetaKeyClick(t):e===t.vertex.getLastIndex()&&this._drawing===d.Editable.FORWARD?e>=this.MIN_VERTEX-1&&(i=!0):0===e&&this._drawing===d.Editable.BACKWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX||0===e&&this._drawing===d.Editable.FORWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX&&this.CLOSED?i=!0:this.onVertexRawMarkerClick(t),this.fireAndForward("editable:vertex:clicked",t),i&&this.commitDrawing(t))},onVertexRawMarkerClick:function(t){this.fireAndForward("editable:vertex:rawclick",t),t._cancelled||this.vertexCanBeDeleted(t.vertex)&&t.vertex.delete()},vertexCanBeDeleted:function(t){return t.latlngs.length>this.MIN_VERTEX},onVertexDeleted:function(t){this.fireAndForward("editable:vertex:deleted",t)},onVertexMarkerCtrlClick:function(t){this.fireAndForward("editable:vertex:ctrlclick",t)},onVertexMarkerShiftClick:function(t){this.fireAndForward("editable:vertex:shiftclick",t)},onVertexMarkerMetaKeyClick:function(t){this.fireAndForward("editable:vertex:metakeyclick",t)},onVertexMarkerAltClick:function(t){this.fireAndForward("editable:vertex:altclick",t)},onVertexMarkerContextMenu:function(t){this.fireAndForward("editable:vertex:contextmenu",t)},onVertexMarkerMouseDown:function(t){this.fireAndForward("editable:vertex:mousedown",t)},onVertexMarkerMouseOver:function(t){this.fireAndForward("editable:vertex:mouseover",t)},onVertexMarkerMouseOut:function(t){this.fireAndForward("editable:vertex:mouseout",t)},onMiddleMarkerMouseDown:function(t){this.fireAndForward("editable:middlemarker:mousedown",t)},onVertexMarkerDrag:function(t){this.onMove(t),this.feature._bounds&&this.extendBounds(t),this.fireAndForward("editable:vertex:drag",t)},onVertexMarkerDragStart:function(t){this.fireAndForward("editable:vertex:dragstart",t)},onVertexMarkerDragEnd:function(t){this.fireAndForward("editable:vertex:dragend",t)},setDrawnLatLngs:function(t){this._drawnLatLngs=t||this.getDefaultLatLngs()},startDrawing:function(){this._drawnLatLngs||this.setDrawnLatLngs(),d.Editable.BaseEditor.prototype.startDrawing.call(this)},startDrawingForward:function(){this.startDrawing()},endDrawing:function(){this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),this._drawnLatLngs&&this._drawnLatLngs.length<this.MIN_VERTEX&&this.deleteShape(this._drawnLatLngs),d.Editable.BaseEditor.prototype.endDrawing.call(this),delete this._drawnLatLngs},addLatLng:function(t){this._drawing===d.Editable.FORWARD?this._drawnLatLngs.push(t):this._drawnLatLngs.unshift(t),this.feature._bounds.extend(t);t=this.addVertexMarker(t,this._drawnLatLngs);this.onNewVertex(t),this.refresh()},newPointForward:function(t){this.addLatLng(t),this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(t)},newPointBackward:function(t){this.addLatLng(t),this.tools.anchorBackwardLineGuide(t)},push:function(t){if(!t)return console.error("L.Editable.PathEditor.push expect a valid latlng as parameter");this._drawing===d.Editable.FORWARD?this.newPointForward(t):this.newPointBackward(t)},removeLatLng:function(t){t.__vertex.delete(),this.refresh()},pop:function(){var t;if(!(this._drawnLatLngs.length<=1))return t=this._drawing===d.Editable.FORWARD?this._drawnLatLngs[this._drawnLatLngs.length-1]:this._drawnLatLngs[0],this.removeLatLng(t),this._drawing===d.Editable.FORWARD?this.tools.anchorForwardLineGuide(this._drawnLatLngs[this._drawnLatLngs.length-1]):this.tools.anchorForwardLineGuide(this._drawnLatLngs[0]),t},processDrawingClick:function(t){t.vertex&&t.vertex.editor===this||(this._drawing===d.Editable.FORWARD?this.newPointForward(t.latlng):this.newPointBackward(t.latlng),this.fireAndForward("editable:drawing:clicked",t))},onDrawingMouseMove:function(t){d.Editable.BaseEditor.prototype.onDrawingMouseMove.call(this,t),this._drawing&&(this.tools.moveForwardLineGuide(t.latlng),this.tools.moveBackwardLineGuide(t.latlng))},refresh:function(){this.feature.redraw(),this.onEditing()},newShape:function(t){var e=this.addNewEmptyShape();e&&(this.setDrawnLatLngs(e[0]||e),this.startDrawingForward(),this.fireAndForward("editable:shape:new",{shape:e}),t)&&this.newPointForward(t)},deleteShape:function(t,e){var i={shape:t};if(d.Editable.makeCancellable(i),this.fireAndForward("editable:shape:delete",i),!i._cancelled)return t=this._deleteShape(t,e),this.ensureNotFlat&&this.ensureNotFlat(),this.feature.setLatLngs(this.getLatLngs()),this.refresh(),this.reset(),this.fireAndForward("editable:shape:deleted",{shape:t}),t},_deleteShape:function(t,e){if((e=e||this.getLatLngs()).length){var i=this,n=function(t,e){return t.splice(t.indexOf(e),1),t.length||i._deleteShape(t),e};if(e===t)return e.splice(0,Number.MAX_VALUE);for(var r=0;r<e.length;r++){if(e[r]===t)return n(e,t);if(-1!==e[r].indexOf(t))return n(e[r],t)}}},deleteShapeAt:function(t){t=this.feature.shapeAt(t);if(t)return this.deleteShape(t)},appendShape:function(t){this.insertShape(t)},prependShape:function(t){this.insertShape(t,0)},insertShape:function(t,e){this.ensureMulti(),t=this.formatShape(t),void 0===e&&(e=this.feature._latlngs.length),this.feature._latlngs.splice(e,0,t),this.feature.redraw(),this._enabled&&this.reset()},extendBounds:function(t){this.feature._bounds.extend(t.vertex.latlng)},onDragStart:function(t){this.editLayer.clearLayers(),d.Editable.BaseEditor.prototype.onDragStart.call(this,t)},onDragEnd:function(t){this.initVertexMarkers(),d.Editable.BaseEditor.prototype.onDragEnd.call(this,t)}}),d.Editable.PolylineEditor=d.Editable.PathEditor.extend({startDrawingBackward:function(){this._drawing=d.Editable.BACKWARD,this.startDrawing()},continueBackward:function(t){this.drawing()||(t=t||this.getDefaultLatLngs(),this.setDrawnLatLngs(t),0<t.length&&(this.tools.attachBackwardLineGuide(),this.tools.anchorBackwardLineGuide(t[0])),this.startDrawingBackward())},continueForward:function(t){this.drawing()||(t=t||this.getDefaultLatLngs(),this.setDrawnLatLngs(t),0<t.length&&(this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(t[t.length-1])),this.startDrawingForward())},getDefaultLatLngs:function(t){return!(t=t||this.feature._latlngs).length||t[0]instanceof d.LatLng?t:this.getDefaultLatLngs(t[0])},ensureMulti:function(){this.feature._latlngs.length&&o(this.feature._latlngs)&&(this.feature._latlngs=[this.feature._latlngs])},addNewEmptyShape:function(){var t;return this.feature._latlngs.length?(this.appendShape(t=[]),t):this.feature._latlngs},formatShape:function(t){return o(t)?t:t[0]?this.formatShape(t[0]):void 0},splitShape:function(t,e){var i,n;!e||e>=t.length-1||(this.ensureMulti(),-1!==(i=this.feature._latlngs.indexOf(t))&&(n=t.slice(0,e+1),(t=t.slice(e))[0]=d.latLng(t[0].lat,t[0].lng,t[0].alt),this.feature._latlngs.splice(i,1,n,t),this.refresh(),this.reset()))}}),d.Editable.PolygonEditor=d.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:3,newPointForward:function(t){d.Editable.PathEditor.prototype.newPointForward.call(this,t),this.tools.backwardLineGuide._latlngs.length||this.tools.anchorBackwardLineGuide(t),2===this._drawnLatLngs.length&&this.tools.attachBackwardLineGuide()},addNewEmptyHole:function(t){this.ensureNotFlat();var t=this.feature.shapeAt(t);if(t)return t.push(t=[]),t},newHole:function(t){var e=this.addNewEmptyHole(t);e&&(this.setDrawnLatLngs(e),this.startDrawingForward(),t)&&this.newPointForward(t)},addNewEmptyShape:function(){var t;return this.feature._latlngs.length&&this.feature._latlngs[0].length?(this.appendShape(t=[]),t):this.feature._latlngs},ensureMulti:function(){this.feature._latlngs.length&&o(this.feature._latlngs[0])&&(this.feature._latlngs=[this.feature._latlngs])},ensureNotFlat:function(){this.feature._latlngs.length&&!o(this.feature._latlngs)||(this.feature._latlngs=[this.feature._latlngs])},vertexCanBeDeleted:function(t){var e=this.feature.parentShape(t.latlngs);return 0<d.Util.indexOf(e,t.latlngs)||d.Editable.PathEditor.prototype.vertexCanBeDeleted.call(this,t)},getDefaultLatLngs:function(){return this.feature._latlngs.length||this.feature._latlngs.push([]),this.feature._latlngs[0]},formatShape:function(t){return!o(t)||t[0]&&0===t[0].length?t:[t]}}),d.Editable.RectangleEditor=d.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:4,options:{skipMiddleMarkers:!0},extendBounds:function(t){var e=t.vertex.getIndex(),i=t.vertex.getNext(),n=t.vertex.getPrevious(),e=t.vertex.latlngs[(e+2)%4],r=new d.LatLngBounds(t.latlng,e);n.latlng.update([t.latlng.lat,e.lng]),i.latlng.update([e.lat,t.latlng.lng]),this.updateBounds(r),this.refreshVertexMarkers()},onDrawingMouseDown:function(t){d.Editable.PathEditor.prototype.onDrawingMouseDown.call(this,t),this.connect();var e=this.getDefaultLatLngs(),i=(3===e.length&&e.push(t.latlng),new d.LatLngBounds(t.latlng,t.latlng));this.updateBounds(i),this.updateLatLngs(i),this.refresh(),this.reset(),t.originalEvent._simulated=!1,this.map.dragging._draggable._onUp(t.originalEvent),e[3].__vertex.dragging._draggable._onDown(t.originalEvent)},onDrawingMouseUp:function(t){this.commitDrawing(t),t.originalEvent._simulated=!1,d.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,t)},onDrawingMouseMove:function(t){t.originalEvent._simulated=!1,d.Editable.PathEditor.prototype.onDrawingMouseMove.call(this,t)},getDefaultLatLngs:function(t){return t||this.feature._latlngs[0]},updateBounds:function(t){this.feature._bounds=t},updateLatLngs:function(t){for(var e=this.getDefaultLatLngs(),i=this.feature._boundsToLatLngs(t),n=0;n<e.length;n++)e[n].update(i[n])}}),d.Editable.CircleEditor=d.Editable.PathEditor.extend({MIN_VERTEX:2,options:{skipMiddleMarkers:!0},initialize:function(t,e,i){d.Editable.PathEditor.prototype.initialize.call(this,t,e,i),this._resizeLatLng=this.computeResizeLatLng()},computeResizeLatLng:function(){var t=(this.feature._radius||this.feature._mRadius)*Math.cos(Math.PI/4),e=this.map.project(this.feature._latlng);return this.map.unproject([e.x+t,e.y-t])},updateResizeLatLng:function(){this._resizeLatLng.update(this.computeResizeLatLng()),this._resizeLatLng.__vertex.update()},getLatLngs:function(){return[this.feature._latlng,this._resizeLatLng]},getDefaultLatLngs:function(){return this.getLatLngs()},onVertexMarkerDrag:function(t){1===t.vertex.getIndex()?this.resize(t):this.updateResizeLatLng(t),d.Editable.PathEditor.prototype.onVertexMarkerDrag.call(this,t)},resize:function(t){t=this.feature._latlng.distanceTo(t.latlng);this.feature.setRadius(t)},onDrawingMouseDown:function(t){d.Editable.PathEditor.prototype.onDrawingMouseDown.call(this,t),this._resizeLatLng.update(t.latlng),this.feature._latlng.update(t.latlng),this.connect(),t.originalEvent._simulated=!1,this.map.dragging._draggable._onUp(t.originalEvent),this._resizeLatLng.__vertex.dragging._draggable._onDown(t.originalEvent)},onDrawingMouseUp:function(t){this.commitDrawing(t),t.originalEvent._simulated=!1,d.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,t)},onDrawingMouseMove:function(t){t.originalEvent._simulated=!1,d.Editable.PathEditor.prototype.onDrawingMouseMove.call(this,t)},onDrag:function(t){d.Editable.PathEditor.prototype.onDrag.call(this,t),this.feature.dragging.updateLatLng(this._resizeLatLng)}});function t(){this.on("add",this._onEditableAdd)}var e={createEditor:function(t){t=t||this._map;var e=(this.options.editOptions||{}).editTools||t.editTools;if(e)return new(this.options.editorClass||this.getEditorClass(e))(t,this,this.options.editOptions);throw Error("Unable to detect Editable instance.")},enableEdit:function(t){return this.editor||this.createEditor(t),this.editor.enable(),this.editor},editEnabled:function(){return this.editor&&this.editor.enabled()},disableEdit:function(){this.editor&&(this.editor.disable(),delete this.editor)},toggleEdit:function(){this.editEnabled()?this.disableEdit():this.enableEdit()},_onEditableAdd:function(){this.editor&&this.enableEdit()}},i={getEditorClass:function(t){return t&&t.options.polylineEditorClass?t.options.polylineEditorClass:d.Editable.PolylineEditor},shapeAt:function(t,e){var i=null;if((e=e||this._latlngs).length)if(o(e)&&this.isInLatLngs(t,e))i=e;else for(var n=0;n<e.length;n++)if(this.isInLatLngs(t,e[n]))return e[n];return i},isInLatLngs:function(t,e){if(e){var i,n,r,a,s=[],o=this._clickTolerance();if(this._projectLatlngs(e,s,this._pxBounds),s=s[0],a=this._map.latLngToLayerPoint(t),this._pxBounds.contains(a))for(i=1,r=s.length,n=0;i<r;n=i++)if(d.LineUtil.pointToSegmentDistance(a,s[n],s[i])<=o)return!0}return!1}},n={getEditorClass:function(t){return t&&t.options.polygonEditorClass?t.options.polygonEditorClass:d.Editable.PolygonEditor},shapeAt:function(t,e){var i=null;if((e=e||this._latlngs).length)if(o(e)&&this.isInLatLngs(t,e))i=e;else if(o(e[0])&&this.isInLatLngs(t,e[0]))i=e;else for(var n=0;n<e.length;n++)if(this.isInLatLngs(t,e[n][0]))return e[n];return i},isInLatLngs:function(t,e){for(var i,n,r=!1,a=0,s=e.length,o=s-1;a<s;o=a++)i=e[a],n=e[o],i.lat>t.lat!=n.lat>t.lat&&t.lng<(n.lng-i.lng)*(t.lat-i.lat)/(n.lat-i.lat)+i.lng&&(r=!r);return r},parentShape:function(t,e){if(e=e||this._latlngs){if(-1!==d.Util.indexOf(e,t))return e;for(var i=0;i<e.length;i++)if(-1!==d.Util.indexOf(e[i],t))return e[i]}}},r={getEditorClass:function(t){return t&&t.options.markerEditorClass?t.options.markerEditorClass:d.Editable.MarkerEditor}},a={getEditorClass:function(t){return t&&t.options.rectangleEditorClass?t.options.rectangleEditorClass:d.Editable.RectangleEditor}},s={getEditorClass:function(t){return t&&t.options.circleEditorClass?t.options.circleEditorClass:d.Editable.CircleEditor}},o=d.LineUtil.isFlat||d.LineUtil._flat||d.Polyline._flat;d.Polyline&&(d.Polyline.include(e),d.Polyline.include(i),d.Polyline.addInitHook(t)),d.Polygon&&(d.Polygon.include(e),d.Polygon.include(n)),d.Marker&&(d.Marker.include(e),d.Marker.include(r),d.Marker.addInitHook(t)),d.Rectangle&&(d.Rectangle.include(e),d.Rectangle.include(a)),d.Circle&&(d.Circle.include(e),d.Circle.include(s)),d.LatLng.prototype.update=function(t){t=d.latLng(t),this.lat=t.lat,this.lng=t.lng}},window);
!function(o,r){"function"==typeof define&&define.amd&&r.toGeoJSON?define(["leaflet"],function(e){o(e,r.toGeoJSON)}):"object"==typeof module&&module.exports?module.exports=function(e,t,i){return void 0===t&&(t=void 0!==r?require("leaflet"):require("leaflet")(e)),void 0===i&&(i=void 0!==r?require("togeojson"):require("togeojson")(e)),o(t,i),t}:void 0!==r&&r.L&&r.toGeoJSON&&o(r.L,r.toGeoJSON)}(function(r,i){var e=r.Layer.extend({options:{layer:r.geoJson,layerOptions:{},fileSizeLimit:1024},initialize:function(e,t){this._map=e,r.Util.setOptions(this,t),this._parsers={geojson:this._loadGeoJSON,json:this._loadGeoJSON,gpx:this._convertToGeoJSON,kml:this._convertToGeoJSON}},load:function(i,e){var o;return!this._isParameterMissing(i,"file")&&!!this._isFileSizeOk(i.size)&&!!(o=this._getParser(i.name,e))&&((e=new FileReader).onload=r.Util.bind(function(e){var t;try{this.fire("data:loading",{filename:i.name,format:o.ext}),t=o.processor.call(this,e.target.result,o.ext),this.fire("data:loaded",{layer:t,filename:i.name,format:o.ext})}catch(e){this.fire("data:error",{error:e})}},this),i.testing||e.readAsText(i),e)},loadMultiple:function(e,t){var i=[];if(e[0])for(e=Array.prototype.slice.apply(e);0<e.length;)i.push(this.load(e.shift(),t));return i},loadData:function(e,t,i){var o,r;if(!this._isParameterMissing(e,"data")&&!this._isParameterMissing(t,"name")&&this._isFileSizeOk(e.length)&&(o=this._getParser(t,i)))try{this.fire("data:loading",{filename:t,format:o.ext}),r=o.processor.call(this,e,o.ext),this.fire("data:loaded",{layer:r,filename:t,format:o.ext})}catch(e){this.fire("data:error",{error:e})}},_isParameterMissing:function(e,t){return void 0===e&&(this.fire("data:error",{error:new Error("Missing parameter: "+t)}),!0)},_getParser:function(e,t){if(t=t||e.split(".").pop(),e=this._parsers[t])return{processor:e,ext:t};this.fire("data:error",{error:new Error("Unsupported file type ("+t+")")})},_isFileSizeOk:function(e){e=(e/1024).toFixed(4);return!(e>this.options.fileSizeLimit&&(this.fire("data:error",{error:new Error("File size exceeds limit ("+e+" > "+this.options.fileSizeLimit+"kb)")}),1))},_loadGeoJSON:function(e){if("string"==typeof e&&(e=JSON.parse(e)),0===(e=this.options.layer(e,this.options.layerOptions)).getLayers().length)throw new Error("GeoJSON has no valid layers.");return this.options.addToMap&&e.addTo(this._map),e},_convertToGeoJSON:function(e,t){return"string"==typeof e&&(e=(new window.DOMParser).parseFromString(e,"text/xml")),t=i[t](e),this._loadGeoJSON(t)}}),t=r.Control.extend({statics:{TITLE:"Load local file (GPX, KML, GeoJSON)",LABEL:"&#8965;"},options:{position:"topleft",fitBounds:!0,layerOptions:{},addToMap:!0,fileSizeLimit:1024},initialize:function(e){r.Util.setOptions(this,e),this.loader=null},onAdd:function(t){return this.loader=r.FileLayer.fileLoader(t,this.options),this.loader.on("data:loaded",function(e){this.options.fitBounds&&window.setTimeout(function(){t.fitBounds(e.layer.getBounds())},500)},this),this._initDragAndDrop(t),this._initContainer()},_initDragAndDrop:function(t){var e,i=this.loader,o=t._container,r={dragenter:function(){t.scrollWheelZoom.disable()},dragleave:function(){t.scrollWheelZoom.enable()},dragover:function(e){e.stopPropagation(),e.preventDefault()},drop:function(e){e.stopPropagation(),e.preventDefault(),i.loadMultiple(e.dataTransfer.files),t.scrollWheelZoom.enable()}};for(e in r)r.hasOwnProperty(e)&&o.addEventListener(e,r[e],!1)},_initContainer:function(){var t,e=this.loader,i="leaflet-control-filelayer leaflet-control-zoom",o="leaflet-bar",o=r.DomUtil.create("div",i+" "+o),i=r.DomUtil.create("a",i+"-in leaflet-bar-part",o);return i.innerHTML=r.Control.FileLayerLoad.LABEL,i.href="#",i.title=r.Control.FileLayerLoad.TITLE,(t=r.DomUtil.create("input","hidden",o)).type="file",t.multiple="multiple",this.options.formats?t.accept=this.options.formats.join(","):t.accept=".gpx,.kml,.json,.geojson",t.style.display="none",t.addEventListener("change",function(){e.loadMultiple(this.files),this.value=""},!1),r.DomEvent.disableClickPropagation(i),r.DomEvent.on(i,"click",function(e){t.click(),e.preventDefault()}),o}});r.FileLayer={},r.FileLayer.FileLoader=e,r.FileLayer.fileLoader=function(e,t){return new r.FileLayer.FileLoader(e,t)},r.Control.FileLayerLoad=t,r.Control.fileLayerLoad=function(e){return new r.Control.FileLayerLoad(e)}},window);
!function(t){var e;if("function"==typeof define&&define.amd)define(["leaflet"],t);else if("undefined"!=typeof module)e=require("leaflet"),module.exports=t(e);else{if(void 0===window.L)throw"Leaflet must be loaded first";t(window.L)}}(function(h){"use strict";return h.Polyline._flat=h.LineUtil.isFlat||h.Polyline._flat||function(t){return!h.Util.isArray(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]},h.GeometryUtil=h.extend(h.GeometryUtil||{},{distance:function(t,e,n){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(n))},distanceSegment:function(t,e,n,r){e=t.latLngToLayerPoint(e),n=t.latLngToLayerPoint(n),t=t.latLngToLayerPoint(r);return h.LineUtil.pointToSegmentDistance(e,n,t)},readableDistance:function(t,e){e="imperial"!==e?1e3<t?(t/1e3).toFixed(2)+" km":t.toFixed(1)+" m":1760<(t*=1.09361)?(t/1760).toFixed(2)+" miles":t.toFixed(1)+" yd";return e},belongsSegment:function(t,e,n,r){r=void 0===r?.2:r;var o=e.distanceTo(n);return(e.distanceTo(t)+t.distanceTo(n)-o)/o<r},length:function(t){t=h.GeometryUtil.accumulatedLengths(t);return 0<t.length?t[t.length-1]:0},accumulatedLengths:function(t){if(0===(t="function"==typeof t.getLatLngs?t.getLatLngs():t).length)return[];for(var e=0,n=[0],r=0,o=t.length-1;r<o;r++)e+=t[r].distanceTo(t[r+1]),n.push(e);return n},closestOnSegment:function(t,e,n,r){var o=t.getMaxZoom(),e=(o===1/0&&(o=t.getZoom()),t.project(e,o)),n=t.project(n,o),r=t.project(r,o),e=h.LineUtil.closestPointOnSegment(e,n,r);return t.unproject(e,o)},closest:function(t,e,n,r){var o,a,i,l=1/0,s=null;if(e instanceof Array){if(e[0]instanceof Array&&"number"!=typeof e[0][0]){for(o=0;o<e.length;o++)(i=h.GeometryUtil.closest(t,e[o],n,r))&&i.distance<l&&(l=i.distance,s=i);return s}if(!(e[0]instanceof h.LatLng||"number"==typeof e[0][0]||"number"==typeof e[0].lat))return s;e=h.polyline(e)}if(e instanceof h.Polyline){var c,u=JSON.parse(JSON.stringify(e.getLatLngs().slice(0)));if(e instanceof h.Polygon&&(c=function(t){if(h.Polyline._flat(t))t.push(t[0]);else for(var e=0;e<t.length;e++)c(t[e])})(u),h.Polyline._flat(u))if(r)for(o=0,a=u.length;o<a;o++){var g,f=u[o];(g=h.GeometryUtil.distance(t,n,f))<l&&(l=g,(s=f).distance=g)}else for(o=0,a=u.length;o<a-1;o++){var y=u[o],L=u[o+1];(g=h.GeometryUtil.distanceSegment(t,n,y,L))<=l&&(l=g,(s=h.GeometryUtil.closestOnSegment(t,n,y,L)).distance=g)}else for(o=0;o<u.length;o++)(i=h.GeometryUtil.closest(t,u[o],n,r)).distance<l&&(l=i.distance,s=i)}return s},closestLayer:function(t,e,n){for(var r=1/0,o=null,a=null,i=1/0,l=0,s=e.length;l<s;l++){var c,u=e[l];u instanceof h.LayerGroup?(c=h.GeometryUtil.closestLayer(t,u.getLayers(),n)).distance<r&&(r=c.distance,o=c):("function"==typeof u.getLatLng?(a=u.getLatLng(),i=h.GeometryUtil.distance(t,n,a)):(a=h.GeometryUtil.closest(t,u,n))&&(i=a.distance),i<r&&(o={layer:u,latlng:a,distance:r=i}))}return o},nClosestLayers:function(t,e,n,r){if((r="number"==typeof r?r:e.length)<1||e.length<1)return null;for(var o,a,i=[],l=0,s=e.length;l<s;l++){var c,u=e[l];u instanceof h.LayerGroup?(c=h.GeometryUtil.closestLayer(t,u.getLayers(),n),i.push(c)):("function"==typeof u.getLatLng?(a=u.getLatLng(),o=h.GeometryUtil.distance(t,n,a)):(a=h.GeometryUtil.closest(t,u,n))&&(o=a.distance),i.push({layer:u,latlng:a,distance:o}))}return i.sort(function(t,e){return t.distance-e.distance}),r<i.length?i.slice(0,r):i},layersWithin:function(t,e,n,r){r="number"==typeof r?r:1/0;for(var o=[],a=null,i=0,l=0,s=e.length;l<s;l++){var c=e[l];"function"==typeof c.getLatLng?(a=c.getLatLng(),i=h.GeometryUtil.distance(t,n,a)):(a=h.GeometryUtil.closest(t,c,n))&&(i=a.distance),a&&i<r&&o.push({layer:c,latlng:a,distance:i})}return o.sort(function(t,e){return t.distance-e.distance})},closestLayerSnap:function(t,e,n,r,o){r="number"==typeof r?r:1/0,o="boolean"!=typeof o||o;e=h.GeometryUtil.closestLayer(t,e,n);return!e||e.distance>r?null:(o&&"function"==typeof e.layer.getLatLngs&&(o=h.GeometryUtil.closest(t,e.layer,e.latlng,!0)).distance<r&&(e.latlng=o,e.distance=h.GeometryUtil.distance(t,o,n)),e)},interpolateOnPointSegment:function(t,e,n){return h.point(t.x*(1-n)+n*e.x,t.y*(1-n)+n*e.y)},interpolateOnLine:function(t,e,n){var r=(e=e instanceof h.Polyline?e.getLatLngs():e).length;if(r<2)return null;if(0===(n=Math.max(Math.min(n,1),0)))return{latLng:e[0]instanceof h.LatLng?e[0]:h.latLng(e[0]),predecessor:-1};if(1==n)return{latLng:e[e.length-1]instanceof h.LatLng?e[e.length-1]:h.latLng(e[e.length-1]),predecessor:e.length-2};for(var o=t.getMaxZoom(),a=(o===1/0&&(o=t.getZoom()),[]),i=0,l=0;l<r;l++)a[l]=t.project(e[l],o),0<l&&(i+=a[l-1].distanceTo(a[l]));for(var s=i*n,c=0,u=0,l=0;u<s;l++){var g=a[l],f=a[l+1],c=u;u+=g.distanceTo(f)}null==g&&null==f&&(g=a[0],f=a[1],l=1);n=h.GeometryUtil.interpolateOnPointSegment(g,f,u-c!=0?(s-c)/(u-c):0);return{latLng:t.unproject(n,o),predecessor:l-1}},locateOnLine:function(t,e,n){var r=e.getLatLngs();if(n.equals(r[0]))return 0;if(n.equals(r[r.length-1]))return 1;for(var o=h.GeometryUtil.closest(t,e,n,!1),a=h.GeometryUtil.accumulatedLengths(r),t=a[a.length-1],i=0,l=!1,s=0,c=r.length-1;s<c;s++){var u=r[s],g=r[s+1],i=a[s];if(h.GeometryUtil.belongsSegment(o,u,g,.001)){i+=u.distanceTo(o),l=!0;break}}if(l)return i/t;throw"Could not interpolate "+n.toString()+" within "+e.toString()},reverse:function(t){return h.polyline(t.getLatLngs().slice(0).reverse())},extract:function(t,e,n,r){if(r<n)return h.GeometryUtil.extract(t,h.GeometryUtil.reverse(e),1-n,1-r);n=Math.max(Math.min(n,1),0),r=Math.max(Math.min(r,1),0);var o=e.getLatLngs(),a=h.GeometryUtil.interpolateOnLine(t,e,n),i=h.GeometryUtil.interpolateOnLine(t,e,r);if(n==r)return[h.GeometryUtil.interpolateOnLine(t,e,r).latLng];-1==a.predecessor&&(a.predecessor=0),-1==i.predecessor&&(i.predecessor=0);n=o.slice(a.predecessor+1,i.predecessor+1);return n.unshift(a.latLng),n.push(i.latLng),n},isBefore:function(t,e){return!!e&&(t=t.getLatLngs(),e=e.getLatLngs(),t[t.length-1].equals(e[0]))},isAfter:function(t,e){return!!e&&(t=t.getLatLngs(),e=e.getLatLngs(),t[0].equals(e[e.length-1]))},startsAtExtremity:function(t,e){return!!e&&(t=t.getLatLngs(),e=e.getLatLngs(),(t=t[0]).equals(e[0])||t.equals(e[e.length-1]))},computeAngle:function(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI},computeSlope:function(t,e){e=(e.y-t.y)/(e.x-t.x);return{a:e,b:t.y-e*t.x}},rotatePoint:function(t,e,n,r){var o=t.getMaxZoom(),n=(o===1/0&&(o=t.getZoom()),n*Math.PI/180),e=t.project(e,o),r=t.project(r,o),a=Math.cos(n)*(e.x-r.x)-Math.sin(n)*(e.y-r.y)+r.x,n=Math.sin(n)*(e.x-r.x)+Math.cos(n)*(e.y-r.y)+r.y;return t.unproject(new h.Point(a,n),o)},bearing:function(t,e){var n=Math.PI/180,r=t.lat*n,o=e.lat*n,t=t.lng*n,e=e.lng*n,n=Math.sin(e-t)*Math.cos(o),r=Math.cos(r)*Math.sin(o)-Math.sin(r)*Math.cos(o)*Math.cos(e-t),o=(180*Math.atan2(n,r)/Math.PI+360)%360;return 180<=o?o-360:o},destination:function(t,e,n){e=(e+360)%360;var r=Math.PI/180,o=180/Math.PI,a=h.CRS.Earth.R,i=t.lng*r,t=t.lat*r,e=e*r,r=Math.sin(t),t=Math.cos(t),l=Math.cos(n/a),n=Math.sin(n/a),a=Math.asin(r*l+t*n*Math.cos(e)),i=i+Math.atan2(Math.sin(e)*n*t,l-r*Math.sin(a));return h.latLng([a*o,i=180<(i*=o)?i-360:i<-180?360+i:i])},angle:function(t,e,n){e=t.latLngToContainerPoint(e),t=t.latLngToContainerPoint(n),n=180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI+90;return n+=n<0?360:0},destinationOnSegment:function(t,e,n,r){var o=h.GeometryUtil.angle(t,e,n),o=h.GeometryUtil.destination(e,o,r);return h.GeometryUtil.closestOnSegment(t,o,e,n)}}),h.GeometryUtil});
!function(t,i){"function"==typeof define&&define.amd?define(["leaflet"],i):"object"==typeof exports?module.exports=i:i(t.L)}(this,function(u){var i,e,t,a;return u.Hotline||((i=function(t){if(!(this instanceof i))return new i(t);this._canvas=t="string"==typeof t?document.getElementById(t):t,this._ctx=t.getContext("2d"),this._width=t.width,this._height=t.height,this._weight=5,this._outlineWidth=1,this._outlineColor="black",this._discreteStrokes=!1,this._min=0,this._max=1,this._data=[],this.palette({0:"green",.5:"yellow",1:"red"})}).prototype={width:function(t){return this._width=t,this},height:function(t){return this._height=t,this},weight:function(t){return this._weight=t,this},outlineWidth:function(t){return this._outlineWidth=t,this},outlineColor:function(t){return this._outlineColor=t,this},discreteStrokes:function(t){return this._discreteStrokes=t,this},palette:function(t){var i,e=document.createElement("canvas"),n=e.getContext("2d"),o=n.createLinearGradient(0,0,0,256);for(i in e.width=1,e.height=256,t)o.addColorStop(i,t[i]);return n.fillStyle=o,n.fillRect(0,0,1,256),this._palette=n.getImageData(0,0,1,256).data,this},min:function(t){return this._min=t,this},max:function(t){return this._max=t,this},data:function(t){return this._data=t,this},add:function(t){return this._data.push(t),this},draw:function(){var t=this._ctx;return t.globalCompositeOperation="source-over",t.lineCap="round",this._drawOutline(t),this._drawHotline(t),this},getRGBForValue:function(t){t=Math.min(Math.max((t-this._min)/(this._max-this._min),0),.999),t=4*Math.floor(256*t);return[this._palette[t],this._palette[1+t],this._palette[2+t]]},_drawOutline:function(t){var i,e,n,o,s,h,r;if(this._outlineWidth)for(i=0,n=this._data.length;i<n;i++)for(o=this._data[i],t.lineWidth=this._weight+2*this._outlineWidth,e=1,s=o.length;e<s;e++)h=o[e-1],r=o[e],t.strokeStyle=this._outlineColor,t.beginPath(),t.moveTo(h.x,h.y),t.lineTo(r.x,r.y),t.stroke()},_drawHotline:function(t){var i,e,n,o,s,h,r,l,a,u;for(t.lineWidth=this._weight,i=0,n=this._data.length;i<n;i++)for(e=1,s=(o=this._data[i]).length;e<s;e++)h=o[e-1],r=o[e],u=this.getRGBForValue(r.z),this._discreteStrokes?t.strokeStyle="rgb("+u.join(",")+")":(a=this.getRGBForValue(h.z),(l=t.createLinearGradient(h.x,h.y,r.x,r.y)).addColorStop(0,"rgb("+a.join(",")+")"),l.addColorStop(1,"rgb("+u.join(",")+")"),t.strokeStyle=l),t.beginPath(),t.moveTo(h.x,h.y),t.lineTo(r.x,r.y),t.stroke()}},e=u.Canvas.extend({_initContainer:function(){u.Canvas.prototype._initContainer.call(this),this._hotline=new i(this._container)},_update:function(){u.Canvas.prototype._update.call(this),this._hotline.width(this._container.width),this._hotline.height(this._container.height)},_updatePoly:function(t){var i;this._drawing&&(i=t._parts).length&&(this._updateOptions(t),this._hotline.data(i).draw())},_updateOptions:function(t){null!=t.options.min&&this._hotline.min(t.options.min),null!=t.options.max&&this._hotline.max(t.options.max),null!=t.options.weight&&this._hotline.weight(t.options.weight),null!=t.options.outlineWidth&&this._hotline.outlineWidth(t.options.outlineWidth),null!=t.options.outlineColor&&this._hotline.outlineColor(t.options.outlineColor),null!=t.options.discreteStrokes&&this._hotline.discreteStrokes(t.options.discreteStrokes),t.options.palette&&this._hotline.palette(t.options.palette)}}),a={clipSegment:function(t,i,e,n,o){var s,h,r,l=n?this._lastCode:u.LineUtil._getBitCode(t,e),a=u.LineUtil._getBitCode(i,e);for(this._lastCode=a;;){if(!(l|a))return[t,i];if(l&a)return!1;h=u.LineUtil._getEdgeIntersection(t,i,s=l||a,e,o),r=u.LineUtil._getBitCode(h,e),s===l?(h.z=t.z,t=h,l=r):(h.z=i.z,i=h,a=r)}}},u.Hotline=u.Polyline.extend({statics:{Renderer:e,renderer:t=function(t){return u.Browser.canvas?new e(t):null}},options:{renderer:t(),min:0,max:1,palette:{0:"green",.5:"yellow",1:"red"},weight:5,outlineColor:"black",outlineWidth:1,discreteStrokes:!1},getRGBForValue:function(t){return this._renderer._hotline.getRGBForValue(t)},_projectLatlngs:function(t,i,e){var n,o,s=t[0]instanceof u.LatLng,h=t.length;if(s){for(o=[],n=0;n<h;n++)o[n]=this._map.latLngToLayerPoint(t[n]),o[n].z=t[n].alt,e.extend(o[n]);i.push(o)}else for(n=0;n<h;n++)this._projectLatlngs(t[n],i,e)},_clipPoints:function(){if(this.options.noClip)this._parts=this._rings;else{this._parts=[];for(var t,i,e,n,o=this._parts,s=this._renderer._bounds,h=0,r=0,l=this._rings.length;h<l;h++)for(t=0,i=(n=this._rings[h]).length;t<i-1;t++)(e=a.clipSegment(n[t],n[t+1],s,t,!0))&&(o[r]=o[r]||[],o[r].push(e[0]),e[1]===n[t+1]&&t!==i-2||(o[r].push(e[1]),r++))}},_clickTolerance:function(){return this.options.weight/2+this.options.outlineWidth+(u.Browser.touch?10:0)}}),u.hotline=function(t,i){return new u.Hotline(t,i)}),u});
!function(e){"function"==typeof bootstrap?bootstrap("leafletosmnotes",e):"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof ses?ses.ok()&&(ses.makeLeafletOsmNotes=e):"undefined"!=typeof window?window.leafletOsmNotes=e():global.leafletOsmNotes=e()}(function(){var define,ses,bootstrap,module,exports;return function(r,s,e){function a(n,e){if(!s[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(i)return i(n,!0);throw new Error("Cannot find module '"+n+"'")}e=s[n]={exports:{}};r[n][0].call(e.exports,function(e){var t=r[n][1][e];return a(t||e)},e,e.exports)}return s[n].exports}for(var i="function"==typeof require&&require,t=0;t<e.length;t++)a(e[t]);return a}({1:[function(e,t,n){var r=e("reqwest"),s=e("moment");t.exports=window.L.LayerGroup.extend({API:"https://api.openstreetmap.org/api/0.6/notes.json",_loadedIds:{},onAdd:function(e){this._map=e,this._loadSuccess=L.bind(function(e){for(var t=0;t<e.features.length;t++)this._loadedIds[e.features[t].properties.id]||(e.features[t].properties=this._template(e.features[t].properties),this._loadedIds[e.features[t].properties.id]=!0,this.notesLayer.addData(e.features[t]))},this),this._pointToLayer=L.bind(function(e){return L.marker([e.geometry.coordinates[1],e.geometry.coordinates[0]],{icon:this._icon(e.properties)}).bindPopup("<h1>"+e.properties.title+"</h1><div>"+e.properties.description+"</div>")},this),this.notesLayer=L.geoJson({type:"FeatureCollection",features:[]},{pointToLayer:this._pointToLayer}).addTo(this),e.on("viewreset",this._load,this).on("moveend",this._load,this),this._load()},_icon:function(e){var t={small:[20,50],medium:[30,70],large:[35,90]},n=(e=e||{})["marker-size"]||"medium",r=e["marker-symbol"]?"-"+e["marker-symbol"]:"",e=(e["marker-color"]||"7e7e7e").replace("#","");return L.icon({iconUrl:"https://a.tiles.mapbox.com/v3/marker/pin-"+n.charAt(0)+r+"+"+e+(L.Browser.retina?"@2x":"")+".png",iconSize:t[n],iconAnchor:[t[n][0]/2,t[n][1]/2],popupAnchor:[0,-t[n][1]/2]})},_template:function(e){e.title='<a href="https://www.openstreetmap.org/browse/note/'+e.id+'">Note #'+e.id+"</a>",e.description="",e["marker-color"]={closed:"11f",open:"f11"}[e.status],e["marker-symbol"]={closed:"circle-stroked",open:"circle"}[e.status];for(var t=0;t<e.comments.length;t++){var n=e.comments[t].user?'<a target="_blank" href="'+e.comments[t].user_url+'">'+e.comments[t].user+"</a>":"Anonymous";e.description+='<div class="comment-meta">'+n+" - "+s(e.comments[t].date).calendar()+' </div> <div class="comment-text">'+e.comments[t].html+"</div>"}return e},_load:function(e){var t,n;r({url:this.API+"?bbox="+(t=this._map,n=t.getBounds().getSouthWest(),t=t.getBounds().getNorthEast(),[n.lng,n.lat,t.lng,t.lat]),type:"json",success:this._loadSuccess,error:function(){}})}})},{reqwest:2,moment:3}],2:[function(require,module,exports){!function(){!function(e,t){void 0!==module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.reqwest=t()}(this,function(){var win=window,doc=document,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=win[xmlHttpRequest]?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};function handleReadyState(e,t,n){return function(){if(e._aborted)return n(e.request);e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,(twoHundo.test(e.request.status)?t:n)(e.request))}}function setHeaders(e,t){var n,r=t.headers||{};for(n in r.Accept=r.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"],t.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||(r[contentType]=t.contentType||defaultHeaders.contentType),r)r.hasOwnProperty(n)&&e.setRequestHeader(n,r[n])}function setCredentials(e,t){void 0!==t.withCredentials&&void 0!==e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var s=uniqid++,a=e.jsonpCallback||"callback",i=e.jsonpCallbackName||reqwest.getcallbackPrefix(s),o=new RegExp("((^|\\?|&)"+a+")=([^&]+)"),u=r.match(o),l=doc.createElement("script"),c=0,d=-1!==navigator.userAgent.indexOf("MSIE 10.0");return u?"?"===u[3]?r=r.replace(o,"$1="+i):i=u[3]:r=urlappend(r,a+"="+i),win[i]=generalCallback,l.type="text/javascript",l.src=r,l.async=!0,void 0===l.onreadystatechange||d||(l.event="onclick",l.htmlFor=l.id="_reqwest_"+s),l.onload=l.onreadystatechange=function(){if(l[readyState]&&"complete"!==l[readyState]&&"loaded"!==l[readyState]||c)return!1;l.onload=l.onreadystatechange=null,l.onclick&&l.onclick(),e.success&&e.success(lastValue),lastValue=void 0,head.removeChild(l),c=1},head.appendChild(l),{abort:function(){l.onload=l.onreadystatechange=null,e.error&&e.error({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(l),c=1}}}function getRequest(e,t){var n,r=this.o,s=(r.method||"GET").toUpperCase(),a="string"==typeof r?r:r.url,i=!1!==r.processData&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null;return"jsonp"!=r.type&&"GET"!=s||!i||(a=urlappend(a,i),i=null),"jsonp"==r.type?handleJsonp(r,e,t,a):((n=xhr()).open(s,a,!0),setHeaders(n,r),setCredentials(n,r),n.onreadystatechange=handleReadyState(this,e,t),r.before&&r.before(n),n.send(i),n)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){e=e.match(/\.(json|jsonp|html|xml)(\?|$)/);return e?e[1]:"js"}function init(o,fn){this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this,type=o.type||setType(this.url);function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;0<self._completeHandlers.length;)self._completeHandlers.shift()(e)}function success(resp){var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=resp.responseText=filteredResponse;if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp);0<self._fulfillmentHandlers.length;)self._fulfillmentHandlers.shift()(resp);complete(resp)}function error(e,t,n){for(self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;0<self._errorHandlers.length;)self._errorHandlers.shift()(e,t,n);complete(e)}fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),o.success&&this._fulfillmentHandlers.push(function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){function n(e){e&&!e.disabled&&t(o,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))}var r,s,a,i,o=e.name,u=e.tagName.toLowerCase();if(!e.disabled&&o)switch(u){case"input":!/reset|button|image|file/i.test(e.type)&&(r=/checkbox/i.test(e.type),s=/radio/i.test(e.type),a=e.value,!r&&!s||e.checked)&&t(o,normalize(r&&""===a?"on":a));break;case"textarea":t(o,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())n(0<=e.selectedIndex?e.options[e.selectedIndex]:null);else for(i=0;e.length&&i<e.length;i++)e.options[i].selected&&n(e.options[i])}}function eachFormElement(){for(var e,t=this,n=0;n<arguments.length;n++){/input|select|textarea/i.test((e=arguments[n]).tagName)&&serial(e,t),s=r=o=void 0;for(var r,s,a=e,i=["input","select","textarea"],o=0;o<i.length;o++)for(s=a[byTag](i[o]),r=0;r<s.length;r++)serial(s[r],t)}}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var n={};return eachFormElement.apply(function(e,t){e in n?(n[e]&&!isArray(n[e])&&(n[e]=[n[e]]),n[e].push(t)):n[e]=t},arguments),n}return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return this._fulfilled?e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this}},reqwest.serializeArray=function(){var n=[];return eachFormElement.apply(function(e,t){n.push({name:e,value:t})},arguments),n},reqwest.serialize=function(){var e,t;return 0===arguments.length?"":("map"==(t=(t=(t=(e=Array.prototype.slice.call(arguments,0)).pop())&&t.nodeType&&e.push(t)?null:t)&&t.type)?serializeHash:"array"==t?reqwest.serializeArray:serializeQueryString).apply(null,e)},reqwest.toQueryString=function(e){function t(e,t){a+=i(e)+"="+i(t)+"&"}var n,r,s,a="",i=encodeURIComponent;if(isArray(e))for(n=0;e&&n<e.length;n++)t(e[n].name,e[n].value);else for(r in e)if(Object.hasOwnProperty.call(e,r))if(s=e[r],isArray(s))for(n=0;n<s.length;n++)t(r,s[n]);else t(r,e[r]);return a.replace(/&$/,"").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp)&&(e.jsonpCallback=e.jsonp),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){for(var t in e=e||{})globalSetupOptions[t]=e[t]},reqwest})}()},{}],3:[function(J,V,e){!function(){!function(i){var u,e,l=Math.round,r={},t=void 0!==V&&V.exports,o=/^\/?Date\((\-?\d+)/i,c=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,s=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,d=/\d\d?/,h=/\d{1,3}/,z=/\d{3}/,j=/\d{1,4}/,P=/[+\-]?\d{1,6}/,W=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,f=/Z|[\+\-]\d\d:?\d\d/i,R=/T/i,U=/[\+\-]?\d+(\.\d{1,3})?/,E=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,p=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],N=/([\+\-]|\d\d)/gi,n="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),a={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},m={},_="DDD w W M D d".split(" "),y="M D H h m s w W".split(" "),g={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return Y(this.year()%100,2)},YYYY:function(){return Y(this.year(),4)},YYYYY:function(){return Y(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return Y(~~(this.milliseconds()/10),2)},SSS:function(){return Y(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+Y(~~(e/60),2)+":"+Y(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+Y(~~(10*e/6),4)},X:function(){return this.unix()}};function w(t,n){return function(e){return Y(t.call(this,e),n)}}for(;_.length;)e=_.pop(),g[e+"o"]=function(t){return function(e){return this.lang().ordinal(t.call(this,e))}}(g[e]);for(;y.length;)e=y.pop(),g[e+e]=w(g[e],2);function M(){}function v(e){b(this,e)}function D(e){var t=this._data={},n=e.years||e.year||e.y||0,r=e.months||e.month||e.M||0,s=e.weeks||e.week||e.w||0,a=e.days||e.day||e.d||0,i=e.hours||e.hour||e.h||0,o=e.minutes||e.minute||e.m||0,u=e.seconds||e.second||e.s||0,e=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=e+1e3*u+6e4*o+36e5*i,this._days=a+7*s,this._months=r+12*n,t.milliseconds=e%1e3,u+=k(e/1e3),t.seconds=u%60,o+=k(u/60),t.minutes=o%60,i+=k(o/60),t.hours=i%24,a+=k(i/24),t.days=(a+=7*s)%30,r+=k(a/30),t.months=r%12,n+=k(r/12),t.years=n}function b(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function k(e){return e<0?Math.ceil(e):Math.floor(e)}function Y(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function T(e,t,n){var r=t._milliseconds,s=t._days,t=t._months;r&&e._d.setTime(+e+r*n),s&&e.date(e.date()+s*n),t&&(r=e.date(),e.date(1).month(e.month()+t*n).date(Math.min(r,e.daysInMonth())))}function S(e){return"[object Array]"===Object.prototype.toString.call(e)}function x(e,t){for(var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),s=0,a=0;a<n;a++)~~e[a]!=~~t[a]&&s++;return s+r}function H(e){return e?(!r[e]&&t&&J("./lang/"+e),r[e]):u.fn._lang}function Z(t,e){var n=5;function r(e){return t.lang().longDateFormat(e)||e}for(;n--&&s.test(e);)e=e.replace(s,r);return m[e]||(m[e]=function(n){for(var e,r=n.match(c),s=0,a=r.length;s<a;s++)g[r[s]]?r[s]=g[r[s]]:r[s]=(e=r[s]).match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){var t="";for(s=0;s<a;s++)t+="function"==typeof r[s].call?r[s].call(e,n):r[s];return t}}(e)),m[e](t)}function A(e){var t,n,r=[];if(!e._d){for(t=0;t<7;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];r[3]+=e._tzh||0,r[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(r[0],r[1],r[2]),n.setUTCHours(r[3],r[4],r[5],r[6])):(n.setFullYear(r[0],r[1],r[2]),n.setHours(r[3],r[4],r[5],r[6])),e._d=n}}function q(e){var t,n,r=e._f.match(c),s=e._i;for(e._a=[],t=0;t<r.length;t++)if((n=(function(e){switch(e){case"DDDD":return z;case"YYYY":return j;case"YYYYY":return P;case"S":case"SS":case"SSS":case"DDD":return h;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return W;case"X":return U;case"Z":case"ZZ":return f;case"T":return R;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return d;default:return new RegExp(e.replace("\\",""))}}(r[t]).exec(s)||[])[0])&&(s=s.slice(s.indexOf(n)+n.length)),g[r[t]]){l=a=u=o=i=void 0;var a,i=r[t],o=n,u=e,l=u._a;switch(i){case"M":case"MM":l[1]=null==o?0:~~o-1;break;case"MMM":case"MMMM":null!=(a=H(u._l).monthsParse(o))?l[1]=a:u._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=o&&(l[2]=~~o);break;case"YY":l[0]=~~o+(68<~~o?1900:2e3);break;case"YYYY":case"YYYYY":l[0]=~~o;break;case"a":case"A":u._isPm="pm"===(o+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":l[3]=~~o;break;case"m":case"mm":l[4]=~~o;break;case"s":case"ss":l[5]=~~o;break;case"S":case"SS":case"SSS":l[6]=~~(1e3*("0."+o));break;case"X":u._d=new Date(1e3*parseFloat(o));break;case"Z":case"ZZ":u._useUTC=!0,(a=(o+"").match(N))&&a[1]&&(u._tzh=~~a[1]),a&&a[2]&&(u._tzm=~~a[2]),a&&"+"===a[0]&&(u._tzh=-u._tzh,u._tzm=-u._tzm)}null==o&&(u._isValid=!1)}e._isPm&&e._a[3]<12&&(e._a[3]+=12),!1===e._isPm&&12===e._a[3]&&(e._a[3]=0),A(e)}function X(e){var t=e._i,n=o.exec(t);if(t===i)e._d=new Date;else if(n)e._d=new Date(+n[1]);else if("string"==typeof t){var r,s=e,a=s._i;if(E.exec(a)){for(s._f="YYYY-MM-DDT",r=0;r<4;r++)if(p[r][1].exec(a)){s._f+=p[r][0];break}f.exec(a)&&(s._f+=" Z"),q(s)}else s._d=new Date(a)}else S(t)?(e._a=t.slice(0),A(e)):e._d=t instanceof Date?new Date(+t):new Date(t)}function I(e,t,n){var r=l(Math.abs(e)/1e3),s=l(r/60),a=l(s/60),i=l(a/24),o=l(i/365),r=(r<45?["s",r]:1===s&&["m"])||(s<45?["mm",s]:1===a&&["h"])||(a<22?["hh",a]:1===i&&["d"])||(i<=25?["dd",i]:i<=45&&["M"])||(i<345?["MM",l(i/30)]:1===o&&["y"])||["yy",o];return r[2]=t,r[3]=0<e,r[4]=n,function(e,t,n,r,s){return s.relativeTime(t||1,!!n,e,r)}.apply({},r)}function L(e,t,n){t=n-t,n-=e.day();return t<n&&(n-=7),n<t-7&&(n+=7),Math.ceil(u(e).add("d",n).dayOfYear()/7)}function C(e){var t=e._i,n=e._f;if(null===t||""===t)return null;if("string"==typeof t&&(e._i=t=H().preparse(t)),u.isMoment(t))(e=b({},t))._d=new Date(+t._d);else if(n)if(S(n)){for(var r,s,a,i=e,o=99;i._f.length;){if((a=b({},i))._f=i._f.pop(),q(a),(r=new v(a)).isValid()){s=r;break}(a=x(a._a,r.toArray()))<o&&(o=a,s=r)}b(i,s)}else q(e);else X(e);return new v(e)}function F(e,n){u.fn[e]=u.fn[e+"s"]=function(e){var t=this._isUTC?"UTC":"";return null!=e?(this._d["set"+t+n](e),this):this._d["get"+t+n]()}}for(g.DDDD=w(g.DDD,3),M.prototype={set:function(e){var t,n;for(n in e)"function"==typeof(t=e[n])?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(n=u([2e3,t]),n="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){e=this._calendar[e];return"function"==typeof e?e.apply(t):e},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var s=this._relativeTime[n];return"function"==typeof s?s(e,t,n,r):s.replace(/%d/i,e)},pastFuture:function(e,t){e=this._relativeTime[0<e?"future":"past"];return"function"==typeof e?e(t):e.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return L(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},(u=function(e,t,n){return C({_i:e,_f:t,_l:n,_isUTC:!1})}).utc=function(e,t,n){return C({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},u.unix=function(e){return u(1e3*e)},u.duration=function(e,t){var n=u.isDuration(e),r="number"==typeof e,s=n?e._data:r?{}:e;return r&&(t?s[t]=e:s.milliseconds=e),r=new D(s),n&&e.hasOwnProperty("_lang")&&(r._lang=e._lang),r},u.version="2.0.0",u.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",u.lang=function(e,t){var n;if(!e)return u.fn._lang._abbr;t?(n=e,(t=t).abbr=n,r[n]||(r[n]=new M),r[n].set(t),r[n]):r[e]||H(e),u.duration.fn._lang=u.fn._lang=H(e)},u.langData=function(e){return H(e=e&&e._lang&&e._lang._abbr?e._lang._abbr:e)},u.isMoment=function(e){return e instanceof v},u.isDuration=function(e){return e instanceof D},u.fn=v.prototype={clone:function(){return u(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return u.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._a?this._isValid=!x(this._a,(this._isUTC?u.utc(this._a):u(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){e=Z(this,e||u.defaultFormat);return this.lang().postformat(e)},add:function(e,t){e="string"==typeof e?u.duration(+t,e):u.duration(e,t);return T(this,e,1),this},subtract:function(e,t){e="string"==typeof e?u.duration(+t,e):u.duration(e,t);return T(this,e,-1),this},diff:function(e,t,n){var r,s,e=this._isUTC?u(e).utc():u(e).local(),a=6e4*(this.zone()-e.zone());return"year"===(t=t&&t.replace(/s$/,""))||"month"===t?(r=432e5*(this.daysInMonth()+e.daysInMonth()),s=12*(this.year()-e.year())+(this.month()-e.month()),s+=(this-u(this).startOf("month")-(e-u(e).startOf("month")))/r,"year"===t&&(s/=12)):(r=this-e-a,s="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?r/864e5:"week"===t?r/6048e5:r),n?s:k(s)},from:function(e,t){return u.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(u(),e)},calendar:function(){var e=this.diff(u().startOf("day"),"days",!0),e=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(e,this))},isLeapYear:function(){var e=this.year();return e%4==0&&e%100!=0||e%400==0},isDST:function(){return this.zone()<u([this.year()]).zone()||this.zone()<u([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==e?t:this.add({d:e-t})},startOf:function(e){switch(e=e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)>+u(e).startOf(t)},isBefore:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)<+u(e).startOf(t)},isSame:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)==+u(e).startOf(t)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return u.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=l((u(this).startOf("day")-u(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},isoWeek:function(e){var t=L(this,1,4);return null==e?t:this.add("d",7*(e-t))},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},lang:function(e){return e===i?this._lang:(this._lang=H(e),this)}},e=0;e<n.length;e++)F(n[e].toLowerCase().replace(/s$/,""),n[e]);function O(e,t){u.duration.fn["as"+e]=function(){return+this/t}}for(e in F("year","FullYear"),u.fn.days=u.fn.day,u.fn.weeks=u.fn.week,u.fn.isoWeeks=u.fn.isoWeek,u.duration.fn=D.prototype={weeks:function(){return k(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(e){var t=+this,n=I(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:u.fn.lang},a)a.hasOwnProperty(e)&&(O(e,a[e]),function(e){u.duration.fn[e]=function(){return this._data[e]}}(e.toLowerCase()));O("Weeks",6048e5),u.lang("en",{ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),t&&(V.exports=u),"undefined"==typeof ender&&(this.moment=u),"function"==typeof define&&define.amd&&define("moment",[],function(){return u})}.call(this)}()},{}]},{},[1])(1)});
L.BingLayer=L.TileLayer.extend({options:{imagerySet:"Aerial",culture:"",style:"",retinaDpi:"d2",attribution:"Bing",minZoom:1,maxZoom:21},initialize:function(t,e){"object"==typeof t&&(e=t,t=!1),L.TileLayer.prototype.initialize.call(this,null,e),(e=this.options).key=e.key||e.bingMapsKey,e.imagerySet=e.imagerySet||e.type,t&&(e.key=t)},tile2quad:function(t,e,i){for(var r="",o=i;0<o;o--){var a=0,n=1<<o-1;0!=(t&n)&&(a+=1),0!=(e&n)&&(a+=2),r+=a}return r},getTileUrl:function(t){t={subdomain:this._getSubdomain(t),quadkey:this.tile2quad(t.x,t.y,this._getZoomForUrl()),culture:this.options.culture};return L.Util.template(this._url,t)},callRestService:function(t,e,i){i=i||this;for(var r="_bing_metadata_"+L.Util.stamp(this);window[r];)r+="_";t+="&jsonp="+r;var o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",t),window[r]=function(t){if(delete window[r],o.remove(),t.errorDetails)throw new Error(t.errorDetails);e.call(i,t)},document.body.appendChild(o)},_makeApiUrl:function(t,e,i){t={version:"v1",restApi:t,resourcePath:e};i=L.extend({key:this.options.key},i);return L.Util.template("https://dev.virtualearth.net/REST/{version}/{restApi}/{resourcePath}",t)+L.Util.getParamString(i)},loadMetadata:function(){var i,t;this.metaRequested||(this.metaRequested=!0,i=this.options,t=this._makeApiUrl("Imagery/Metadata",i.imagerySet,{UriScheme:"https",include:"ImageryProviders",culture:i.culture,style:i.style}),this.callRestService(t,function(t){var e=t.resourceSets[0].resources[0];if(!e.imageUrl)throw new Error("imageUrl not found in response");e.imageUrlSubdomains&&(i.subdomains=e.imageUrlSubdomains),this._providers=e.imageryProviders?this._prepAttrBounds(e.imageryProviders):[],this._attributions=[],this._url=e.imageUrl,i.retinaDpi&&i.detectRetina&&i.zoomOffset&&(this._url+="&dpi="+i.retinaDpi),this.fire("load",{meta:t}),this._map&&this._update()}))},_prepAttrBounds:function(t){return t.forEach(function(t){t.coverageAreas.forEach(function(t){t.bounds=L.latLngBounds([t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]])})}),t},_update:function(t){this._url&&(L.GridLayer.prototype._update.call(this,t),this._update_attribution())},_update_attribution:function(e){var i,r,t,o=this._map.attributionControl;o?(i=this._map.getBounds(),i=L.latLngBounds(i.getSouthWest().wrap(),i.getNorthEast().wrap()),r=this._getZoomForUrl(),(t=this._providers.map(function(t){return!e&&t.coverageAreas.some(function(t){return r<=t.zoomMax&&r>=t.zoomMin&&i.intersects(t.bounds)})})).forEach(function(t,e){t!=this._attributions[e]&&(t?o.addAttribution(this._providers[e].attribution):o.removeAttribution(this._providers[e].attribution))},this),this._attributions=t):this._attributions={}},onAdd:function(t){this.loadMetadata(),L.GridLayer.prototype.onAdd.call(this,t)},onRemove:function(t){this._providers&&this._update_attribution(!0),L.GridLayer.prototype.onRemove.call(this,t)}}),L.bingLayer=function(t,e){return new L.BingLayer(t,e)};
!function(a){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof modules&&module.exports?module.exports=a(require("leaflet")):a(L)}(function(n){"use strict";return n.TileLayer.Provider=n.TileLayer.extend({initialize:function(a,t){var e=n.TileLayer.Provider.providers,a=a.split("."),r=a[0],a=a[1];if(!e[r])throw"No such provider ("+r+")";var o={url:e[r].url,options:e[r].options};if(a&&"variants"in e[r]){if(!(a in e[r].variants))throw"No such variant of "+r+" ("+a+")";r=e[r].variants[a],a="string"==typeof r?{variant:r}:r.options,o={url:r.url||o.url,options:n.Util.extend({},o.options,a)}}var i=function(a){return-1===a.indexOf("{attribution.")?a:a.replace(/\{attribution.(\w*)\}/g,function(a,t){return i(e[t].options.attribution)})},r=(o.options.attribution=i(o.options.attribution),n.Util.extend({},o.options,t));n.TileLayer.prototype.initialize.call(this,o.url,r)}}),n.TileLayer.Provider.providers={OpenStreetMap:{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},variants:{Mapnik:{},DE:{url:"https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png",options:{maxZoom:18}},CH:{url:"https://tile.osm.ch/switzerland/{z}/{x}/{y}.png",options:{maxZoom:18,bounds:[[45,5],[48,11]]}},France:{url:"https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",options:{maxZoom:20,attribution:"&copy; OpenStreetMap France | {attribution.OpenStreetMap}"}},HOT:{url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",options:{attribution:'{attribution.OpenStreetMap}, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>'}},BZH:{url:"https://tile.openstreetmap.bzh/br/{z}/{x}/{y}.png",options:{attribution:'{attribution.OpenStreetMap}, Tiles courtesy of <a href="http://www.openstreetmap.bzh/" target="_blank">Breton OpenStreetMap Team</a>',bounds:[[46.2,-5.5],[50,.7]]}}}},OpenSeaMap:{url:"https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",options:{attribution:'Map data: &copy; <a href="http://www.openseamap.org">OpenSeaMap</a> contributors'}},OPNVKarte:{url:"https://tileserver.memomaps.de/tilegen/{z}/{x}/{y}.png",options:{maxZoom:18,attribution:'Map <a href="https://memomaps.de/">memomaps.de</a> <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, map data {attribution.OpenStreetMap}'}},OpenTopoMap:{url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",options:{maxZoom:17,attribution:'Map data: {attribution.OpenStreetMap}, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},OpenRailwayMap:{url:"https://{s}.tiles.openrailwaymap.org/standard/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="https://www.OpenRailwayMap.org">OpenRailwayMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},OpenFireMap:{url:"http://openfiremap.org/hytiles/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="http://www.openfiremap.org">OpenFireMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},SafeCast:{url:"https://s3.amazonaws.com/te512.safecast.org/{z}/{x}/{y}.png",options:{maxZoom:16,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="https://blog.safecast.org/about/">SafeCast</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},Stadia:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png",options:{maxZoom:20,attribution:'&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'},variants:{AlidadeSmooth:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"},AlidadeSmoothDark:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"},OSMBright:{url:"https://tiles.stadiamaps.com/tiles/osm_bright/{z}/{x}/{y}{r}.png"},Outdoors:{url:"https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png"}}},Thunderforest:{url:"https://{s}.tile.thunderforest.com/{variant}/{z}/{x}/{y}.png?apikey={apikey}",options:{attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, {attribution.OpenStreetMap}',variant:"cycle",apikey:"<insert your api key here>",maxZoom:22},variants:{OpenCycleMap:"cycle",Transport:{options:{variant:"transport"}},TransportDark:{options:{variant:"transport-dark"}},SpinalMap:{options:{variant:"spinal-map"}},Landscape:"landscape",Outdoors:"outdoors",Pioneer:"pioneer",MobileAtlas:"mobile-atlas",Neighbourhood:"neighbourhood"}},CyclOSM:{url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png",options:{maxZoom:20,attribution:'<a href="https://github.com/cyclosm/cyclosm-cartocss-style/releases" title="CyclOSM - Open Bicycle render">CyclOSM</a> | Map data: {attribution.OpenStreetMap}'}},Hydda:{url:"https://{s}.tile.openstreetmap.se/hydda/{variant}/{z}/{x}/{y}.png",options:{maxZoom:20,variant:"full",attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data {attribution.OpenStreetMap}'},variants:{Full:"full",Base:"base",RoadsAndLabels:"roads_and_labels"}},Jawg:{url:"https://{s}.tile.jawg.io/{variant}/{z}/{x}/{y}{r}.png?access-token={accessToken}",options:{attribution:'<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> {attribution.OpenStreetMap}',minZoom:0,maxZoom:22,subdomains:"abcd",variant:"jawg-terrain",accessToken:"<insert your access token here>"},variants:{Streets:"jawg-streets",Terrain:"jawg-terrain",Sunny:"jawg-sunny",Dark:"jawg-dark",Light:"jawg-light",Matrix:"jawg-matrix"}},MapBox:{url:"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}{r}?access_token={accessToken}",options:{attribution:'&copy; <a href="https://www.mapbox.com/about/maps/" target="_blank">Mapbox</a> {attribution.OpenStreetMap} <a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a>',tileSize:512,maxZoom:18,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"<insert your access token here>"}},MapTiler:{url:"https://api.maptiler.com/maps/{variant}/{z}/{x}/{y}{r}.{ext}?key={key}",options:{attribution:'<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',variant:"streets",ext:"png",key:"<insert your MapTiler Cloud API key here>",tileSize:512,zoomOffset:-1,minZoom:0,maxZoom:21},variants:{Streets:"streets",Basic:"basic",Bright:"bright",Pastel:"pastel",Positron:"positron",Hybrid:{options:{variant:"hybrid",ext:"jpg"}},Toner:"toner",Topo:"topo",Voyager:"voyager"}},Stamen:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}{r}.{ext}",options:{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data {attribution.OpenStreetMap}',subdomains:"abcd",minZoom:0,maxZoom:20,variant:"toner",ext:"png"},variants:{Toner:"toner",TonerBackground:"toner-background",TonerHybrid:"toner-hybrid",TonerLines:"toner-lines",TonerLabels:"toner-labels",TonerLite:"toner-lite",Watercolor:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}.{ext}",options:{variant:"watercolor",ext:"jpg",minZoom:1,maxZoom:16}},Terrain:{options:{variant:"terrain",minZoom:0,maxZoom:18}},TerrainBackground:{options:{variant:"terrain-background",minZoom:0,maxZoom:18}},TerrainLabels:{options:{variant:"terrain-labels",minZoom:0,maxZoom:18}},TopOSMRelief:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}.{ext}",options:{variant:"toposm-color-relief",ext:"jpg",bounds:[[22,-132],[51,-56]]}},TopOSMFeatures:{options:{variant:"toposm-features",bounds:[[22,-132],[51,-56]],opacity:.9}}}},TomTom:{url:"https://{s}.api.tomtom.com/map/1/tile/{variant}/{style}/{z}/{x}/{y}.{ext}?key={apikey}",options:{variant:"basic",maxZoom:22,attribution:'<a href="https://tomtom.com" target="_blank">&copy;  1992 - '+(new Date).getFullYear()+" TomTom.</a> ",subdomains:"abcd",style:"main",ext:"png",apikey:"<insert your API key here>"},variants:{Basic:"basic",Hybrid:"hybrid",Labels:"labels"}},Esri:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/{variant}/MapServer/tile/{z}/{y}/{x}",options:{variant:"World_Street_Map",attribution:"Tiles &copy; Esri"},variants:{WorldStreetMap:{options:{attribution:"{attribution.Esri} &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012"}},DeLorme:{options:{variant:"Specialty/DeLorme_World_Base_Map",minZoom:1,maxZoom:11,attribution:"{attribution.Esri} &mdash; Copyright: &copy;2012 DeLorme"}},WorldTopoMap:{options:{variant:"World_Topo_Map",attribution:"{attribution.Esri} &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community"}},WorldImagery:{options:{variant:"World_Imagery",attribution:"{attribution.Esri} &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}},WorldTerrain:{options:{variant:"World_Terrain_Base",maxZoom:13,attribution:"{attribution.Esri} &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS"}},WorldShadedRelief:{options:{variant:"World_Shaded_Relief",maxZoom:13,attribution:"{attribution.Esri} &mdash; Source: Esri"}},WorldPhysical:{options:{variant:"World_Physical_Map",maxZoom:8,attribution:"{attribution.Esri} &mdash; Source: US National Park Service"}},OceanBasemap:{options:{variant:"Ocean_Basemap",maxZoom:13,attribution:"{attribution.Esri} &mdash; Sources: GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri"}},NatGeoWorldMap:{options:{variant:"NatGeo_World_Map",maxZoom:16,attribution:"{attribution.Esri} &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC"}},WorldGrayCanvas:{options:{variant:"Canvas/World_Light_Gray_Base",maxZoom:16,attribution:"{attribution.Esri} &mdash; Esri, DeLorme, NAVTEQ"}}}},OpenWeatherMap:{url:"http://{s}.tile.openweathermap.org/map/{variant}/{z}/{x}/{y}.png?appid={apiKey}",options:{maxZoom:19,attribution:'Map data &copy; <a href="http://openweathermap.org">OpenWeatherMap</a>',apiKey:"<insert your api key here>",opacity:.5},variants:{Clouds:"clouds",CloudsClassic:"clouds_cls",Precipitation:"precipitation",PrecipitationClassic:"precipitation_cls",Rain:"rain",RainClassic:"rain_cls",Pressure:"pressure",PressureContour:"pressure_cntr",Wind:"wind",Temperature:"temp",Snow:"snow"}},HERE:{url:"https://{s}.{base}.maps.api.here.com/maptile/2.1/{type}/{mapID}/{variant}/{z}/{x}/{y}/{size}/{format}?app_id={app_id}&app_code={app_code}&lg={language}",options:{attribution:"Map &copy; 1987-"+(new Date).getFullYear()+' <a href="http://developer.here.com">HERE</a>',subdomains:"1234",mapID:"newest",app_id:"<insert your app_id here>",app_code:"<insert your app_code here>",base:"base",variant:"normal.day",maxZoom:20,type:"maptile",language:"eng",format:"png8",size:"256"},variants:{normalDay:"normal.day",normalDayCustom:"normal.day.custom",normalDayGrey:"normal.day.grey",normalDayMobile:"normal.day.mobile",normalDayGreyMobile:"normal.day.grey.mobile",normalDayTransit:"normal.day.transit",normalDayTransitMobile:"normal.day.transit.mobile",normalDayTraffic:{options:{variant:"normal.traffic.day",base:"traffic",type:"traffictile"}},normalNight:"normal.night",normalNightMobile:"normal.night.mobile",normalNightGrey:"normal.night.grey",normalNightGreyMobile:"normal.night.grey.mobile",normalNightTransit:"normal.night.transit",normalNightTransitMobile:"normal.night.transit.mobile",reducedDay:"reduced.day",reducedNight:"reduced.night",basicMap:{options:{type:"basetile"}},mapLabels:{options:{type:"labeltile",format:"png"}},trafficFlow:{options:{base:"traffic",type:"flowtile"}},carnavDayGrey:"carnav.day.grey",hybridDay:{options:{base:"aerial",variant:"hybrid.day"}},hybridDayMobile:{options:{base:"aerial",variant:"hybrid.day.mobile"}},hybridDayTransit:{options:{base:"aerial",variant:"hybrid.day.transit"}},hybridDayGrey:{options:{base:"aerial",variant:"hybrid.grey.day"}},hybridDayTraffic:{options:{variant:"hybrid.traffic.day",base:"traffic",type:"traffictile"}},pedestrianDay:"pedestrian.day",pedestrianNight:"pedestrian.night",satelliteDay:{options:{base:"aerial",variant:"satellite.day"}},terrainDay:{options:{base:"aerial",variant:"terrain.day"}},terrainDayMobile:{options:{base:"aerial",variant:"terrain.day.mobile"}}}},HEREv3:{url:"https://{s}.{base}.maps.ls.hereapi.com/maptile/2.1/{type}/{mapID}/{variant}/{z}/{x}/{y}/{size}/{format}?apiKey={apiKey}&lg={language}",options:{attribution:"Map &copy; 1987-"+(new Date).getFullYear()+' <a href="http://developer.here.com">HERE</a>',subdomains:"1234",mapID:"newest",apiKey:"<insert your apiKey here>",base:"base",variant:"normal.day",maxZoom:20,type:"maptile",language:"eng",format:"png8",size:"256"},variants:{normalDay:"normal.day",normalDayCustom:"normal.day.custom",normalDayGrey:"normal.day.grey",normalDayMobile:"normal.day.mobile",normalDayGreyMobile:"normal.day.grey.mobile",normalDayTransit:"normal.day.transit",normalDayTransitMobile:"normal.day.transit.mobile",normalNight:"normal.night",normalNightMobile:"normal.night.mobile",normalNightGrey:"normal.night.grey",normalNightGreyMobile:"normal.night.grey.mobile",normalNightTransit:"normal.night.transit",normalNightTransitMobile:"normal.night.transit.mobile",reducedDay:"reduced.day",reducedNight:"reduced.night",basicMap:{options:{type:"basetile"}},mapLabels:{options:{type:"labeltile",format:"png"}},trafficFlow:{options:{base:"traffic",type:"flowtile"}},carnavDayGrey:"carnav.day.grey",hybridDay:{options:{base:"aerial",variant:"hybrid.day"}},hybridDayMobile:{options:{base:"aerial",variant:"hybrid.day.mobile"}},hybridDayTransit:{options:{base:"aerial",variant:"hybrid.day.transit"}},hybridDayGrey:{options:{base:"aerial",variant:"hybrid.grey.day"}},pedestrianDay:"pedestrian.day",pedestrianNight:"pedestrian.night",satelliteDay:{options:{base:"aerial",variant:"satellite.day"}},terrainDay:{options:{base:"aerial",variant:"terrain.day"}},terrainDayMobile:{options:{base:"aerial",variant:"terrain.day.mobile"}}}},FreeMapSK:{url:"https://{s}.freemap.sk/T/{z}/{x}/{y}.jpeg",options:{minZoom:8,maxZoom:16,subdomains:"abcd",bounds:[[47.204642,15.996093],[49.830896,22.576904]],attribution:'{attribution.OpenStreetMap}, vizualization CC-By-SA 2.0 <a href="http://freemap.sk">Freemap.sk</a>'}},MtbMap:{url:"http://tile.mtbmap.cz/mtbmap_tiles/{z}/{x}/{y}.png",options:{attribution:"{attribution.OpenStreetMap} &amp; USGS"}},CartoDB:{url:"https://{s}.basemaps.cartocdn.com/{variant}/{z}/{x}/{y}{r}.png",options:{attribution:'{attribution.OpenStreetMap} &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20,variant:"light_all"},variants:{Positron:"light_all",PositronNoLabels:"light_nolabels",PositronOnlyLabels:"light_only_labels",DarkMatter:"dark_all",DarkMatterNoLabels:"dark_nolabels",DarkMatterOnlyLabels:"dark_only_labels",Voyager:"rastertiles/voyager",VoyagerNoLabels:"rastertiles/voyager_nolabels",VoyagerOnlyLabels:"rastertiles/voyager_only_labels",VoyagerLabelsUnder:"rastertiles/voyager_labels_under"}},HikeBike:{url:"https://tiles.wmflabs.org/{variant}/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:"{attribution.OpenStreetMap}",variant:"hikebike"},variants:{HikeBike:{},HillShading:{options:{maxZoom:15,variant:"hillshading"}}}},BasemapAT:{url:"https://maps{s}.wien.gv.at/basemap/{variant}/{type}/google3857/{z}/{y}/{x}.{format}",options:{maxZoom:19,attribution:'Datenquelle: <a href="https://www.basemap.at">basemap.at</a>',subdomains:["","1","2","3","4"],type:"normal",format:"png",bounds:[[46.35877,8.782379],[49.037872,17.189532]],variant:"geolandbasemap"},variants:{basemap:{options:{maxZoom:20,variant:"geolandbasemap"}},grau:"bmapgrau",overlay:"bmapoverlay",terrain:{options:{variant:"bmapgelaende",type:"grau",format:"jpeg"}},surface:{options:{variant:"bmapoberflaeche",type:"grau",format:"jpeg"}},highdpi:{options:{variant:"bmaphidpi",format:"jpeg"}},orthofoto:{options:{maxZoom:20,variant:"bmaporthofoto30cm",format:"jpeg"}}}},nlmaps:{url:"https://geodata.nationaalgeoregister.nl/tiles/service/wmts/{variant}/EPSG:3857/{z}/{x}/{y}.png",options:{minZoom:6,maxZoom:19,bounds:[[50.5,3.25],[54,7.6]],attribution:'Kaartgegevens &copy; <a href="https://www.kadaster.nl">Kadaster</a>'},variants:{standaard:"brtachtergrondkaart",pastel:"brtachtergrondkaartpastel",grijs:"brtachtergrondkaartgrijs",luchtfoto:{url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_ortho25/EPSG:3857/{z}/{x}/{y}.jpeg"}}},NASAGIBS:{url:"https://map1.vis.earthdata.nasa.gov/wmts-webmerc/{variant}/default/{time}/{tilematrixset}{maxZoom}/{z}/{y}/{x}.{format}",options:{attribution:'Imagery provided by services from the Global Imagery Browse Services (GIBS), operated by the NASA/GSFC/Earth Science Data and Information System (<a href="https://earthdata.nasa.gov">ESDIS</a>) with funding provided by NASA/HQ.',bounds:[[-85.0511287776,-179.999999975],[85.0511287776,179.999999975]],minZoom:1,maxZoom:9,format:"jpg",time:"",tilematrixset:"GoogleMapsCompatible_Level"},variants:{ModisTerraTrueColorCR:"MODIS_Terra_CorrectedReflectance_TrueColor",ModisTerraBands367CR:"MODIS_Terra_CorrectedReflectance_Bands367",ViirsEarthAtNight2012:{options:{variant:"VIIRS_CityLights_2012",maxZoom:8}},ModisTerraLSTDay:{options:{variant:"MODIS_Terra_Land_Surface_Temp_Day",format:"png",maxZoom:7,opacity:.75}},ModisTerraSnowCover:{options:{variant:"MODIS_Terra_NDSI_Snow_Cover",format:"png",maxZoom:8,opacity:.75}},ModisTerraAOD:{options:{variant:"MODIS_Terra_Aerosol",format:"png",maxZoom:6,opacity:.75}},ModisTerraChlorophyll:{options:{variant:"MODIS_Terra_Chlorophyll_A",format:"png",maxZoom:7,opacity:.75}}}},NLS:{url:"https://nls-{s}.tileserver.com/nls/{z}/{x}/{y}.jpg",options:{attribution:'<a href="http://geo.nls.uk/maps/">National Library of Scotland Historic Maps</a>',bounds:[[49.6,-12],[61.7,3]],minZoom:1,maxZoom:18,subdomains:"0123"}},JusticeMap:{url:"https://www.justicemap.org/tile/{size}/{variant}/{z}/{x}/{y}.png",options:{attribution:'<a href="http://www.justicemap.org/terms.php">Justice Map</a>',size:"county",bounds:[[14,-180],[72,-56]]},variants:{income:"income",americanIndian:"indian",asian:"asian",black:"black",hispanic:"hispanic",multi:"multi",nonWhite:"nonwhite",white:"white",plurality:"plural"}},GeoportailFrance:{url:"https://wxs.ign.fr/{apikey}/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE={style}&TILEMATRIXSET=PM&FORMAT={format}&LAYER={variant}&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",options:{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',bounds:[[-75,-180],[81,180]],minZoom:2,maxZoom:18,apikey:"choisirgeoportail",format:"image/png",style:"normal",variant:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2"},variants:{plan:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",parcels:{options:{variant:"CADASTRALPARCELS.PARCELLAIRE_EXPRESS",style:"PCI vecteur",maxZoom:20}},orthos:{options:{maxZoom:19,format:"image/jpeg",variant:"ORTHOIMAGERY.ORTHOPHOTOS"}}}},OneMapSG:{url:"https://maps-{s}.onemap.sg/v3/{variant}/{z}/{x}/{y}.png",options:{variant:"Default",minZoom:11,maxZoom:18,bounds:[[1.56073,104.11475],[1.16,103.502]],attribution:'<img src="https://docs.onemap.sg/maps/images/oneMap64-01.png" style="height:20px;width:20px;"/> New OneMap | Map data &copy; contributors, <a href="http://SLA.gov.sg">Singapore Land Authority</a>'},variants:{Default:"Default",Night:"Night",Original:"Original",Grey:"Grey",LandLot:"LandLot"}},USGS:{url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer/tile/{z}/{y}/{x}",options:{maxZoom:20,attribution:'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'},variants:{USTopo:{},USImagery:{url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/tile/{z}/{y}/{x}"},USImageryTopo:{url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}"}}},WaymarkedTrails:{url:"https://tile.waymarkedtrails.org/{variant}/{z}/{x}/{y}.png",options:{maxZoom:18,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="https://waymarkedtrails.org">waymarkedtrails.org</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'},variants:{hiking:"hiking",cycling:"cycling",mtb:"mtb",slopes:"slopes",riding:"riding",skating:"skating"}},OpenAIP:{url:"https://{s}.tile.maps.openaip.net/geowebcache/service/tms/1.0.0/openaip_basemap@EPSG%3A900913@png/{z}/{x}/{y}.{ext}",options:{attribution:'<a href="https://www.openaip.net/">openAIP Data</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-NC-SA</a>)',ext:"png",minZoom:4,maxZoom:14,tms:!0,detectRetina:!0,subdomains:"12"}},OpenSnowMap:{url:"https://tiles.opensnowmap.org/{variant}/{z}/{x}/{y}.png",options:{minZoom:9,maxZoom:18,attribution:'Map data: {attribution.OpenStreetMap} & ODbL, &copy; <a href="https://www.opensnowmap.org/iframes/data.html">www.opensnowmap.org</a> <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'},variants:{pistes:"pistes"}},AzureMaps:{url:"https://atlas.microsoft.com/map/tile?api-version={apiVersion}&tilesetId={variant}&x={x}&y={y}&zoom={z}&language={language}&subscription-key={subscriptionKey}",options:{attribution:"See https://docs.microsoft.com/en-US/rest/api/maps/renderv2/getmaptilepreview for details.",apiVersion:"2.0",variant:"microsoft.imagery",subscriptionKey:"<insert your subscription key here>",language:"en-US"},variants:{MicrosoftImagery:"microsoft.imagery",MicrosoftBaseDarkGrey:"microsoft.base.darkgrey",MicrosoftBaseRoad:"microsoft.base.road",MicrosoftBaseHybridRoad:"microsoft.base.hybrid.road",MicrosoftTerraMain:"microsoft.terra.main",MicrosoftWeatherInfraredMain:{url:"https://atlas.microsoft.com/map/tile?api-version={apiVersion}&tilesetId={variant}&x={x}&y={y}&zoom={z}&timeStamp={timeStamp}&language={language}&subscription-key={subscriptionKey}",options:{timeStamp:"2021-05-08T09:03:00Z",attribution:"See https://docs.microsoft.com/en-US/rest/api/maps/renderv2/getmaptilepreview#uri-parameters for details.",variant:"microsoft.weather.infrared.main"}},MicrosoftWeatherRadarMain:{url:"https://atlas.microsoft.com/map/tile?api-version={apiVersion}&tilesetId={variant}&x={x}&y={y}&zoom={z}&timeStamp={timeStamp}&language={language}&subscription-key={subscriptionKey}",options:{timeStamp:"2021-05-08T09:03:00Z",attribution:"See https://docs.microsoft.com/en-US/rest/api/maps/renderv2/getmaptilepreview#uri-parameters for details.",variant:"microsoft.weather.radar.main"}}}}},n.tileLayer.provider=function(a,t){return new n.TileLayer.Provider(a,t)},n});
L.Util.extend(L.LineUtil,{snapToLayers:function(n,t,i){var s,e,o,l,a,r,y=i.sensitivity||10,g=i.vertexonly||!1,m=(i.layers,1/0),u=n;if(u._feature=null,i&&i.layers&&i.layers.length)for(l=i.layers[0]._map,s=0;s<i.layers.length;s++)for(o=Object.keys(i.layers[s]._layers),e=0;e<o.length;e++)t!==(r=i.layers[s]._layers[o[e]])._leaflet_id&&(a=r._layers?(a=this.snapToLayers(n,t,{sensitivity:y,vertexonly:g,layers:[r]}),{minDist:n.distanceTo(a),minPoint:a}):r instanceof L.Marker?this._snapToLatlngs(n,[r.getLatLng()],l,y,g,m):r instanceof L.Polyline?this._snapToLatlngs(n,r.getLatLngs(),l,y,g,m):r instanceof L.MultiPolyline?(console.error("Snapping to MultiPolyline is currently unsupported",r),{minDist:m,minPoint:u}):r instanceof L.Polygon?this._snapToPolygon(n,r,l,y,g,m):r instanceof L.MultiPolygon?this._snapToMultiPolygon(n,r,l,y,g,m):(console.error("Unsupported snapping feature",r),{minDist:m,minPoint:u})).minDist<m&&(m=a.minDist,(u=a.minPoint)._feature=r);return u},_snapToPolygon:function(n,t,i,s,e,o){var l,a,r,y=null,g=t.getLatLngs();for(g.push(g[0]),(l=this._snapToLatlngs(n,t.getLatLngs(),i,s,e,o)).minDist<o&&(o=l.minDist,y=l.minPoint),a=Object.keys(t._holes),r=0;r<a.length;r++)(g=t._holes[a[r]]).push(g[0]),(l=this._snapToLatlngs(n,t._holes[a[r]],i,s,e,o)).minDist<o&&(o=l.minDist,y=l.minPoint);return{minDist:o,minPoint:y}},_snapToMultiPolygon:function(n,t,i,s,e,o){for(var l,a=null,r=Object.keys(t._layers),y=0;y<r.length;y++)(l=this._snapToPolygon(n,t._layers[r[y]],i,s,e,o)).minDist<o&&(o=l.minDist,a=l.minPoint);return{minDist:o,minPoint:a}},_snapToLatlngs:function(n,t,i,s,e,o){for(var l,a,r,y=i.latLngToLayerPoint(n),g=l=null,m=0;m<t.length;m++)a=i.latLngToLayerPoint(t[m]),e||null===g?(r=y.distanceTo(a))&&r<=s&&r<o&&(o=r,l=t[m]):(r=L.LineUtil.pointToSegmentDistance(y,g,a))<o&&r<=s&&(o=r,l=i.layerPointToLatLng(L.LineUtil.closestPointOnSegment(y,g,a))),g=a;return{minDist:o,minPoint:l}}});
L.Marker.include({snapTo:function(n){return L.LineUtil.snapToLayers(n,this._leaflet_id,this.options.snapping)}});
L.Routing=L.Control.extend({includes:[L.Evented.prototype],statics:{VERSION:"0.1.1-dev"},options:{position:"topleft",tooltips:{waypoint:"Waypoint. Drag to move; Click to remove.",segment:"Drag to create a new waypoint. Click to toggle straight line."},icons:{start:new L.Icon.Default,end:new L.Icon.Default,normal:new L.Icon.Default,draw:new L.Icon.Default},styles:{trailer:{},track:{},nodata:{},beeline:{},beelineTrailer:{}},tolerance:5,toleranceTouch:10,snapSensitivity:10,zIndexOffset:2e3,routing:{router:null},snapping:{layers:[],sensitivity:10,vertexonly:!1},shortcut:{draw:{enable:68,disable:81,beelineMode:66,beelineModifier:16,beelineModifierName:"shiftKey"}}},initialize:function(t){this._editing=!1,this._drawing=!1,this.touch=!window.L_NO_TOUCH&&("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),L.Util.setOptions(this,t)},onAdd:function(t){return this._map=t,this._container=this._map._container,this._overlayPane=this._map._panes.overlayPane,this._popupPane=this._map._panes.popupPane,this._router=this.options.routing.router,this._segments=(new L.FeatureGroup).addTo(t),this._segmentsTolerance=this.touch?this.options.toleranceTouch:this.options.tolerance,this._segmentsRenderer=L.canvas({tolerance:this._segmentsTolerance}),this._waypoints=(new L.FeatureGroup).addTo(t),this._waypoints._first=null,this._waypoints._last=null,this.options.shortcut&&(L.DomEvent.addListener(this._container,"keydown",this._keydownListener,this),L.DomEvent.addListener(this._container,"keyup",this._keyupListener,this)),this._draw=new L.Routing.Draw(this,this.options),this._edit=new L.Routing.Edit(this,this.options),this._edit.enable(),this.on("waypoint:click",this._waypointClickHandler,this),this.touch?this._segments.on("layeradd",this._fireSegmentEvent,this):this._segments.on("mouseover",this._fireSegmentEvent,this),this._edit.on("segment:mouseout",this._fireSegmentEvent,this),this._edit.on("segment:dragstart",this._fireSegmentEvent,this),this._edit.on("segment:dragend",this._fireSegmentEvent,this),L.DomUtil.create("div","leaflet-routing")},onRemove:function(t){this.off("waypoint:click",this._waypointClickHandler,this),this.touch?this._segments.off("layeradd",this._fireSegmentEvent,this):this._segments.off("mouseover",this._fireSegmentEvent,this),this._edit.off("segment:mouseout",this._fireSegmentEvent,this),this._edit.off("segment:dragstart",this._fireSegmentEvent,this),this._edit.off("segment:dragend",this._fireSegmentEvent,this),this._edit.disable(),this._draw.disable(),L.DomUtil.enableTextSelection(),L.DomEvent.removeListener(this._container,"keydown",this._keydownListener,this),L.DomEvent.removeListener(this._container,"keyup",this._keyupListener,this),delete this._draw,delete this._edit,delete this._map,delete this._router,delete this._segments,delete this._waypoints,delete this.options},_waypointClickHandler:function(t){this.removeWaypoint(t.marker,function(){})},addWaypoint:function(t,e,n,i,o){(t=t instanceof L.LatLng?new L.Marker(t,{title:this.options.tooltips.waypoint,draggable:!0}):t)._routing={prevMarker:n,nextMarker:i,prevLine:null,nextLine:null,timeoutID:null,beeline:e||!1};var e=this.options.icons,r=(n?i?t.setIcon(e.normal):t.setIcon(e.end):t.setIcon(e.start),i&&this.getFirst()&&i._leaflet_id===this.getFirst()._leaflet_id),s=n&&this.getFirst()&&n._leaflet_id===this.getFirst()._leaflet_id,a=n&&this.getLast()&&n._leaflet_id===this.getLast()._leaflet_id;r&&i.setIcon(e.normal),a&&!s&&n.setIcon(e.normal),null===this.getFirst()&&null===this.getLast()?(this._waypoints._first=t,this._waypoints._last=t):null===i?this._waypoints._last=t:null===n&&(this._waypoints._first=t),null!==t._routing.prevMarker&&((t._routing.prevMarker._routing.nextMarker=t)._routing.prevLine=t._routing.prevMarker._routing.nextLine,null!==t._routing.prevLine)&&(t._routing.prevLine._routing.nextMarker=t),null!==t._routing.nextMarker&&((t._routing.nextMarker._routing.prevMarker=t).nextLine=t._routing.nextMarker._routing.prevLine,null!==t._routing.nextLine)&&(t._routing.nextLine._routing.prevMarker=t),t.on("mouseover",this._fireWaypointEvent,this),t.on("mouseout",this._fireWaypointEvent,this),t.on("dragstart",this._fireWaypointEvent,this),t.on("dragend",this._fireWaypointEvent,this),t.on("drag",this._fireWaypointEvent,this),t.on("click",this._fireWaypointEvent,this),n&&i&&n._routing.beeline&&(t._routing.beeline=!0),this.routeWaypoint(t,o),this._waypoints.addLayer(t)},removeWaypoint:function(t,e){t.off("mouseover",this._fireWaypointEvent,this),t.off("mouseout",this._fireWaypointEvent,this),t.off("dragstart",this._fireWaypointEvent,this),t.off("dragend",this._fireWaypointEvent,this),t.off("drag",this._fireWaypointEvent,this),t.off("click",this._fireWaypointEvent,this),t._removed=!0;var n=t._routing.prevMarker,i=t._routing.nextMarker,o=this.getFirst()&&t._leaflet_id===this.getFirst()._leaflet_id,r=this.getLast()&&t._leaflet_id===this.getLast()._leaflet_id;o&&(this._waypoints._first=i)&&i.setIcon(this.options.icons.start),r&&(this._waypoints._last=n)&&(n._leaflet_id!==this.getFirst()._leaflet_id&&n.setIcon(this.options.icons.end),n._routing.beeline=!1),null!==n&&(n._routing.nextMarker=i,n._routing.nextLine=null),null!==i&&(i._routing.prevMarker=n,i._routing.prevLine=null),null!==t._routing.nextLine&&this._segments.removeLayer(t._routing.nextLine),null!==t._routing.prevLine&&this._segments.removeLayer(t._routing.prevLine),this._waypoints.removeLayer(t),null!==n?this.routeWaypoint(n,e):null!==i?this.routeWaypoint(i,e):(this._draw.enable(),e(null,null))},routeWaypoint:function(n,i){function t(t,e){o=o||t,2===++r&&(s._updateBeelines(),s.fire("routing:routeWaypointEnd",{err:o}),i(o,n))}var o,r=0,s=this;this.fire("routing:routeWaypointStart"),this._routeSegment(n._routing.prevMarker,n,t),this._routeSegment(n,n._routing.nextMarker,t)},rerouteAllSegments:function(n){function i(t,e){o=o||t,r<=++s&&(a._updateBeelines(),a.fire("routing:rerouteAllSegmentsEnd",{err:o}),n)&&n(o)}var o,r=this.getWaypoints().length-1,s=0,a=this;if(a.fire("routing:rerouteAllSegmentsStart"),r<1)return i(null);this._eachSegment(function(t,e){this._routeSegment(t,e,i)})},_routeSegment:function(n,i,o){var r=this;return null===n||null===i?o(null,!0):n._routing.beeline?o():void this._router(n.getLatLng(),i.getLatLng(),function(t,e){return void 0===e?e=new L.Polyline([n.getLatLng(),i.getLatLng()],r.options.styles.nodata):e.setStyle(r.options.styles.track),r._updateLayer(n,i,e),o(t,e)})},_updateBeelines:function(){this._eachSegment(function(t,e,n){var i,o;t._routing.beeline&&(o=(o=t._routing.prevLine?t._routing.prevLine.getLatLngs():null)?o[o.length-1]:t.getLatLng(),i=(i=e._routing.nextLine?e._routing.nextLine.getLatLngs():null)&&!e._routing.beeline?i[0]:e.getLatLng(),o=this.createBeeline(o.clone(),i.clone()),this._updateLayer(t,e,o))})},createBeeline:function(t,e){var n=this.options.styles.beeline;return new L.Polyline([t,e],n)},_updateLayer:function(t,e,n){t._removed||e._removed||(n._routing={prevMarker:t,nextMarker:e,beeline:t._routing.beeline},n.options.renderer=this._segmentsRenderer,null!==t._routing.nextLine&&this._segments.removeLayer(t._routing.nextLine),this._segments.addLayer(n),t._routing.nextLine=n,e._routing.prevLine=n)},_eachSegment:function(t,e){var n=e||this,i=this.getFirst();if(null!==i)for(;null!==i._routing.nextMarker;){var o=i,r=i._routing.nextMarker,s=i._routing.nextLine;t.call(n,o,r,s),i=i._routing.nextMarker}},_fireWaypointEvent:function(t){this.fire("waypoint:"+t.type,{marker:t.target})},_fireSegmentEvent:function(t){var e={};t.layer&&(e.layer=t.layer),2===t.type.split(":").length?this.fire(t.type,e):this.fire("segment:"+t.type,e)},getFirst:function(){return this._waypoints._first},getLast:function(){return this._waypoints._last},getWaypoints:function(){var e=[];return this._eachSegment(function(t){e.push(t.getLatLng())}),this.getLast()&&e.push(this.getLast().getLatLng()),e},getBeelineFlags:function(){var e=[];return this._eachSegment(function(t){e.push(t._routing.beeline)}),e},toPolyline:function(){var i=[];return this._eachSegment(function(t,e,n){i=i.concat(n.getLatLngs())}),L.polyline(i)},toGeoJSON:function(t){var e={type:"LineString",properties:{waypoints:[]},coordinates:[]},n=this._waypoints._first;if(null!==n)for(e.properties.waypoints.push({coordinates:[n.getLatLng().lng,n.getLatLng().lat],_index:0});n._routing.nextMarker;){for(var i=n._routing.nextMarker,o=n._routing.nextLine.getLatLngs(),r=0;r<o.length;r++)!o[r].alt||void 0!==t&&!1!==t?e.coordinates.push([o[r].lng,o[r].lat]):e.coordinates.push([o[r].lng,o[r].lat,o[r].alt]);e.properties.waypoints.push({coordinates:[i.getLatLng().lng,i.getLatLng().lat],_index:e.coordinates.length-1}),n=n._routing.nextMarker}return e},loadGeoJSON:function(r,t,e){var n,s,a,i=this;if("function"!=typeof t&&void 0!==t||(e=t,t={}),t.waypointDistance=t.waypointDistance||50,t.fitBounds=t.fitBounds||!0,!r.properties||!r.properties.waypoints){r.properties||(r.properties={}),r.properties.waypoints=[];for(var o=0;o<r.coordinates.length;o+=t.waypointDistance)r.properties.waypoints.push({_index:o,coordinates:r.coordinates[o].slice(0,2)});o>r.coordinates.length-1&&r.properties.waypoints.push({_index:r.coordinates.length-1,coordinates:r.coordinates[r.coordinates.length-1].slice(0,2)})}s=0,n=i._router,a=r.properties.waypoints,i._router=function(t,e,n){var i=a[s-1]._index,o=a[s]._index+1;return n(null,L.GeoJSON.geometryToLayer({type:"LineString",coordinates:r.coordinates.slice(i,o)}))},end=function(){i._router=n,setTimeout(function(){t.fitBounds&&i._map.fitBounds(L.polyline(L.GeoJSON.coordsToLatLngs(r.coordinates)).getBounds()),"function"==typeof e&&e(null)},0)},(add=function(){if(!a[s])return end();var t=a[s].coordinates,e=i._waypoints._last;i.addWaypoint(L.latLng(t[1],t[0]),null,e,null,function(t,e){add(++s)})})()},draw:function(t){(t=void 0===t?!0:t)?this._draw.enable():this._draw.disable()},toggleBeelineDrawing:function(){return this._draw.toggleBeelineMode()},routing:function(t){throw new Error("Not implemented")},snapping:function(t){throw new Error("Not implemented")},_keyupListener:function(t){t.keyCode===this.options.shortcut.draw.disable?this._draw.disable():t.keyCode===this.options.shortcut.draw.enable?this._draw.enable():t.keyCode===this.options.shortcut.draw.beelineMode?this.toggleBeelineDrawing():t.keyCode===this.options.shortcut.draw.beelineModifier&&this._draw._setTrailerStyle(!1)},_keydownListener:function(t){t.keyCode===this.options.shortcut.draw.beelineModifier&&this._draw._setTrailerStyle(!0)}});
L.Routing.Draw=L.Handler.extend({includes:[L.Evented.prototype],options:{},initialize:function(t,i){this._parent=t,this._map=t._map,this._enabled=!1,this._beelineMode=!1,L.Util.setOptions(this,i)},enable:function(){this._enabled||(this._enabled=!0,this._hidden=!1,this._dragging=!1,this._addHooks(),this.fire("enabled"),this._map.fire("routing:draw-start"),0===this._parent._segments._layers.length?this._map.fire("routing:draw-new"):this._map.fire("routing:draw-continue"))},disable:function(){this._enabled&&(this._enabled=!1,this._removeHooks(),this.fire("disabled"),this._map.fire("routing:draw-end"))},_addHooks:function(){var t,i;this._map&&(this._marker||(this._marker=new L.Marker(this._map.getCenter(),{icon:this.options.icons.draw||new L.Icon.Default,opacity:this.options.icons.draw?1:0,zIndexOffset:this.options.zIndexOffset,interactive:!1})),this._trailer||(t=this._map.getCenter(),i=this._beelineMode?this.options.styles.beelineTrailer:this.options.styles.trailer,this._trailerOpacity=this.options.styles.trailer.opacity||.2,i=L.extend({},i,{opacity:0,interactive:!1}),this._trailer=new L.Polyline([t,t],i)),this._parent.on("waypoint:mouseover",this._catchWaypointEvent,this),this._parent.on("waypoint:mouseout",this._catchWaypointEvent,this),this._parent.on("waypoint:dragstart",this._catchWaypointEvent,this),this._parent.on("waypoint:dragend",this._catchWaypointEvent,this),this._parent.on("segment:mouseover",this._catchWaypointEvent,this),this._parent.on("segment:mouseout",this._catchWaypointEvent,this),this._parent.on("segment:dragstart",this._catchWaypointEvent,this),this._parent.on("segment:dragend",this._catchWaypointEvent,this),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onMouseClick,this),L.DomEvent.addListener(window,"blur",this._onblur,this),this._marker.addTo(this._map),this._trailer.addTo(this._map))},_removeHooks:function(){this._map&&(this._parent.off("waypoint:mouseover",this._catchWaypointEvent,this),this._parent.off("waypoint:mouseout",this._catchWaypointEvent,this),this._parent.off("waypoint:dragstart",this._catchWaypointEvent,this),this._parent.off("waypoint:dragend",this._catchWaypointEvent,this),this._parent.off("segment:mouseover",this._catchWaypointEvent,this),this._parent.off("segment:mouseout",this._catchWaypointEvent,this),this._parent.off("segment:dragstart",this._catchWaypointEvent,this),this._parent.off("segment:dragend",this._catchWaypointEvent,this),this._map.off("click",this._onMouseClick,this),this._map.off("mousemove",this._onMouseMove,this),L.DomEvent.removeListener(window,"blur",this._onblur,this),this._map.removeLayer(this._marker),this._map.removeLayer(this._trailer),delete this._marker,delete this._trailer)},_catchWaypointEvent:function(t){t=t.type.split(":")[1];this._hidden?this._dragging?"dragend"===t&&(this._dragging=!1):"mouseout"===t?this._show():"dragstart"===t&&(this._dragging=!0):"mouseover"===t&&this._hide()},_hide:function(){this._hidden=!0,this._marker.setOpacity(0),this._trailer.setStyle({opacity:0})},_show:function(){this._hidden=!1,this._marker.setOpacity(this.options.icons.draw?1:0),this._showTrailer()},_showTrailer:function(){0!==this._trailer.options.opacity||this._parent.touch||this._trailer.setStyle({opacity:this._trailerOpacity})},_setTrailer:function(t,i){this._trailer.setLatLngs([t,i]),this._showTrailer()},_onMouseMove:function(t){var i;this._hidden||(t=t.latlng,i=this._parent.getLast(),this.options.snapping&&(t=L.LineUtil.snapToLayers(t,null,this.options.snapping)),this._marker.setLatLng(t),null!==i&&this._setTrailer(i.getLatLng(),t))},_onMouseClick:function(t){var i,e,s;this._hidden||(s=t.latlng,this.options.snapping&&(s=L.LineUtil.snapToLayers(s,null,this.options.snapping)),(i=this._parent.getLast())&&(t=(e=this.options.shortcut.draw.beelineModifierName)&&t.originalEvent[e],i._routing.beeline=this._isBeelineDrawing(t)),this._setTrailer(s,s),this._parent.addWaypoint(s,null,i,null,function(t,i){}))},toggleBeelineMode:function(){return this._enabled&&(this._beelineMode=!this._beelineMode,this._setTrailerStyle(),this._map.fire(this._beelineMode?"routing:beeline-start":"routing:beeline-end")),this._beelineMode},_setTrailerStyle:function(t){var i;this._enabled&&(t=this._isBeelineDrawing(t)?this.options.styles.beelineTrailer:this.options.styles.trailer,i=this._trailer.options.opacity,this._trailer.setStyle(L.extend({},t,{opacity:i})))},_isBeelineDrawing:function(t){return t?!this._beelineMode:this._beelineMode},_onblur:function(t){this._enabled&&this._setTrailerStyle()}});
L.Routing.Edit=L.Handler.extend({includes:[L.Evented.prototype],options:{},initialize:function(t,e){this._parent=t,this._map=t._map,this._enabled=!1,L.Util.setOptions(this,e)},enable:function(){this._enabled||(this._enabled=!0,this._addHooks(),this.fire("enabled"),this._map.fire("routing:edit-start"))},disable:function(){this._enabled&&(this._enabled=!1,this._removeHooks(),this.fire("disabled"),this._map.fire("routing:edit-end"))},_addHooks:function(){var t,e;this._map&&(this._mouseMarker||(this._mouseMarker=new L.Marker(this._map.getCenter(),{icon:L.divIcon({className:"line-mouse-marker",iconAnchor:[5,5],iconSize:[10,10]}),interactive:!0,draggable:!0,zIndexOffset:this.options.zIndexOffset,title:this.options.tooltips.segment})),this._trailer1||(e=this._map.getCenter(),this._trailerOpacity=this.options.styles.trailer.opacity||.2,t=L.extend({},this.options.styles.trailer,{opacity:0,interactive:!1}),this._trailer1=new L.Polyline([e,e],t),this._trailer2=new L.Polyline([e,e],t)),this._trailer1.addTo(this._map),this._trailer2.addTo(this._map),this._parent.touch?((e=this._parent._segmentsRenderer)instanceof L.Canvas&&(this._map.hasLayer(e)||this._map.addLayer(e),L.DomEvent.on(e._container,"touchstart touchend",e._onTouch,e)),this._parent.on("segment:layeradd",this._segmentOnAdd,this),this.on("segment:dragend",this._hideMouseMarker,this),L.DomEvent.on(this._mouseMarker,"contextmenu",this._segmentOnContextmenu,this),this._parent._segments.on("contextmenu",this._hideMouseMarker,this)):this._parent.on("segment:mouseover",this._segmentOnMouseover,this),this._mouseMarker.on("dragstart",this._segmentOnDragstart,this),this._mouseMarker.on("drag",this._segmentOnDrag,this),this._mouseMarker.on("dragend",this._segmentOnDragend,this),this._mouseMarker.on("click",this._segmentOnClick,this),this._mouseMarker.on("dblclick",L.DomEvent.stop,this),this._parent.on("waypoint:dragstart",this._waypointOnDragstart,this),this._parent.on("waypoint:drag",this._waypointOnDrag,this),this._parent.on("waypoint:dragend",this._waypointOnDragend,this))},_removeHooks:function(){var t;this._map&&(this._parent.touch?((t=this._parent._segmentsRenderer)instanceof L.Canvas&&L.DomEvent.off(t._container,"touchstart touchend",t._onTouch,t),this._parent.off("segment:layeradd",this._segmentOnAdd,this),this.off("segment:dragend",this._hideMouseMarker,this),L.DomEvent.off(this._mouseMarker,"contextmenu",this._segmentOnContextmenu,this),this._parent._segments.off("contextmenu",this._hideMouseMarker,this)):this._parent.off("segment:mouseover",this._segmentOnMouseover,this),this._mouseMarker.off("dragstart",this._segmentOnDragstart,this),this._mouseMarker.off("drag",this._segmentOnDrag,this),this._mouseMarker.off("dragend",this._segmentOnDragend,this),this._mouseMarker.off("click",this._segmentOnClick,this),this._mouseMarker.off("dblclick",L.DomEvent.stop,this),this._parent.off("waypoint:dragstart",this._waypointOnDragstart,this),this._parent.off("waypoint:drag",this._waypointOnDrag,this),this._parent.off("waypoint:dragend",this._waypointOnDragend,this))},_segmentOnMouseover:function(t){this._showMouseMarker(),this._map.on("mousemove",this._segmentOnMousemove,this)},_segmentOnMouseout:function(t){this._dragging||(this._hideMouseMarker(),this._map.off("mousemove",this._segmentOnMousemove,this),this.fire("segment:mouseout"))},_segmentOnMousemove:function(t){var e;this._dragging||(null===(e=L.LineUtil.snapToLayers(t.latlng,null,{layers:[this._parent._segments],sensitivity:this.options.snapSensitivity,vertexonly:!1}))._feature?this._segmentOnMouseout(t):(this._mouseMarker._snapping=e._feature._routing,this._mouseMarker.setLatLng(e)))},_segmentOnAdd:function(t){t.layer.on("touchstart pointerdown",this._segmentOnTouchstart,this),this.on("segment:click",this._hideMouseMarker,this)},_segmentOnTouchstart:function(t){var e=t.target,e=(this._mouseMarker.setLatLng(t.latlng),this._showMouseMarker(),this._mouseMarker._snapping=e._routing,t.originalEvent);this._mouseMarker._icon.dispatchEvent(new e.constructor(e.type,e))},_segmentOnDragstart:function(t){var e=t.target.getLatLng(),n=t.target._snapping.nextMarker,t=t.target._snapping.prevMarker;this._setTrailers(e,n,t,!0),this._dragging=!0,this.fire("segment:dragstart")},_segmentOnDrag:function(t){var e=t.target.getLatLng(),n=t.target._snapping.nextMarker,s=t.target._snapping.prevMarker;this.options.snapping&&(e=L.LineUtil.snapToLayers(e,null,this.options.snapping)),t.target.setLatLng(e),this._setTrailers(e,n,s)},_segmentOnDragend:function(t){var e=this._mouseMarker._snapping.nextMarker,n=this._mouseMarker._snapping.prevMarker,s=this._mouseMarker.getLatLng();this._parent.addWaypoint(s,null,n,e,function(t,e){}),this._dragging=!1,this._setTrailers(null,null,null,!1),this.fire("segment:dragend")},_segmentOnClick:function(t){var n=this,e=this._mouseMarker._snapping.nextMarker,s=this._mouseMarker._snapping.prevMarker;L.DomEvent.stop(t),s._routing.beeline=!s._routing.beeline,this.fire("segment:click"),this._parent.fire("routing:rerouteSegmentStart"),this._parent._routeSegment(s,e,function(t,e){n._parent._updateBeelines(),n._parent.fire("routing:rerouteSegmentEnd",{err:t})})},_segmentOnContextmenu:function(t){this._hideMouseMarker(),this._parent._segments.fire("mousemove",t,!0),this._map.once("click",function(t){this._parent._segments.fire("mouseout",t,!0)},this)},_waypointOnDragstart:function(t){var e=t.marker._routing.nextMarker,n=t.marker._routing.prevMarker;this._setTrailers(t.marker.getLatLng(),e,n,!0)},_waypointOnDrag:function(t){var e=t.marker._latlng,n=t.marker._routing.nextMarker,s=t.marker._routing.prevMarker;this.options.snapping&&(e=L.LineUtil.snapToLayers(e,null,this.options.snapping)),t.marker.setLatLng(e),this._setTrailers(e,n,s)},_waypointOnDragend:function(t){this._setTrailers(null,null,null,!1),this._parent.routeWaypoint(t.marker,function(t,e){})},_waypointOnClick:function(t){this._parent.removeWaypoint(t.layer,function(t,e){})},_setTrailers:function(t,e,n,s){if(void 0!==s){if(!1===s)return this._trailer1.setStyle({opacity:0}),void this._trailer2.setStyle({opacity:0});null!==e&&this._trailer1.setStyle({opacity:this._trailerOpacity}),null!==n&&this._trailer2.setStyle({opacity:this._trailerOpacity})}e&&this._trailer1.setLatLngs([t,e.getLatLng()]),n&&this._trailer2.setLatLngs([t,n.getLatLng()])},_hideMouseMarker:function(){this._mouseMarker.remove()},_showMouseMarker:function(){this._mouseMarker.addTo(this._map)}}),L.Canvas.prototype._onTouch=function(t){for(var e,n,s=t.touches&&0<t.touches.length?t.touches:t.changedTouches,i=(s&&!t.clientX&&(t.clientX=s[0].clientX,t.clientY=s[0].clientY),this._map.mouseEventToLayerPoint(t)),r=this._drawFirst;r;r=r.next)(e=r.layer).options.interactive&&e._containsPoint(i)&&(n=e);n&&(L.DomEvent.fakeStop(t),this._fireEvent([n],t))};
L.Control.Sidebar=L.Control.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,options:{autopan:!1,closeButton:!0,container:"",position:"left"},initialize:function(t,e){return"string"==typeof t&&(console.warn("this syntax is deprecated. please use L.control.sidebar({ container }) now"),t={container:t}),"object"==typeof t&&t.id&&(console.warn("this syntax is deprecated. please use L.control.sidebar({ container }) now"),t.container=t.id),this._tabitems=[],this._panes=[],this._closeButtons=[],this._expandButtons=[],L.setOptions(this,Object.assign({},t,e)),this},onAdd:function(t){var e,i,s,n,a,o="string"==typeof this.options.container?L.DomUtil.get(this.options.container):this.options.container;for(o=o||L.DomUtil.create("div","leaflet-sidebar collapsed"),this._paneContainer=o.querySelector("div.leaflet-sidebar-content"),null===this._paneContainer&&(this._paneContainer=L.DomUtil.create("div","leaflet-sidebar-content",o)),this._tabContainer=this.options.tabContainer?L.DomUtil.get(this.options.tabContainer):o,i=this._tabContainer.querySelectorAll("ul.leaflet-sidebar-tabs, div.leaflet-sidebar-tabs > ul"),this._tabContainerTop=i[0]||null,this._tabContainerBottom=i[1]||null,null===this._tabContainerTop&&((s=L.DomUtil.create("div","leaflet-sidebar-tabs",o)).setAttribute("role","tablist"),this._tabContainerTop=L.DomUtil.create("ul","",s)),null===this._tabContainerBottom&&(s=this._tabContainerTop.parentNode,this._tabContainerBottom=L.DomUtil.create("ul","",s)),e=0;e<this._tabContainerTop.children.length;e++)(a=this._tabContainerTop.children[e])._sidebar=this,a._id=a.querySelector("a").hash.slice(1),this._tabitems.push(a);for(e=0;e<this._tabContainerBottom.children.length;e++)(a=this._tabContainerBottom.children[e])._sidebar=this,a._id=a.querySelector("a").hash.slice(1),this._tabitems.push(a);for(e=0;e<this._paneContainer.children.length;e++)"DIV"===(a=this._paneContainer.children[e]).tagName&&L.DomUtil.hasClass(a,"leaflet-sidebar-pane")&&(this._panes.push(a),(n=a.querySelectorAll(".leaflet-sidebar-close")).length&&(this._closeButtons.push(n[n.length-1]),this._closeClick(n[n.length-1],"on")),(n=a.querySelectorAll(".leaflet-sidebar-expand")).length)&&(this._expandButtons.push(n[n.length-1]),this._expandClick(n[n.length-1],"on"));for(e=0;e<this._tabitems.length;e++)this._tabClick(this._tabitems[e],"on");return o},onRemove:function(t){var e;for(this._map=null,this._tabitems=[],this._panes=[],this._closeButtons=[],this._expandButtons=[],e=0;e<this._tabitems.length;e++)this._tabClick(this._tabitems[e],"off");for(e=0;e<this._closeButtons.length;e++)this._closeClick(this._closeButtons[e],"off");for(e=0;e<this._expandButtons.length;e++)this._expandClick(this._expandButtons[e],"off");return this},addTo:function(t){return this.onRemove(),this._map=t,this._container=this.onAdd(t),L.DomUtil.addClass(this._container,"leaflet-sidebar-"+this.getPosition()),L.DomUtil.addClass(this._tabContainer,"leaflet-sidebar-"+this.getPosition()),L.Browser.touch&&(L.DomUtil.addClass(this._container,"leaflet-touch"),L.DomUtil.addClass(this._tabContainer,"leaflet-touch")),L.DomEvent.disableScrollPropagation(this._container),L.DomEvent.disableClickPropagation(this._container),L.DomUtil.hasClass(this._map.getContainer(),"leaflet-sidebar-map")||(L.DomUtil.addClass(this._map.getContainer(),"leaflet-sidebar-map"),this._map.invalidateSize()),this.options.autopan&&this._container.addEventListener("transitionend",L.bind(function(t){this._map.invalidateSize({animate:!1})},this),!0),this},removeFrom:function(t){return console.warn("removeFrom() has been deprecated, please use remove() instead as support for this function will be ending soon."),this._map._container.removeChild(this._container),this.onRemove(t),this},open:function(t){var e,i,s=this._getTab(t);if(!L.DomUtil.hasClass(s,"disabled")){for(e=0;e<this._panes.length;e++)(i=this._panes[e]).id===t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");for(e=0;e<this._tabitems.length;e++)(i=this._tabitems[e]).querySelector("a").hash==="#"+t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");this.fire("content",{id:t}),L.DomUtil.hasClass(this._container,"collapsed")&&(this.fire("opening"),L.DomUtil.removeClass(this._container,"collapsed"),L.DomUtil.removeClass(this._tabContainer,"collapsed")),this._map.invalidateSize()}return this},close:function(){for(var t=0;t<this._tabitems.length;t++){var e=this._tabitems[t];L.DomUtil.hasClass(e,"active")&&L.DomUtil.removeClass(e,"active")}return L.DomUtil.hasClass(this._container,"collapsed")||(this.fire("closing"),L.DomUtil.addClass(this._container,"collapsed"),L.DomUtil.addClass(this._tabContainer,"collapsed"),this._map.invalidateSize()),this},toggleExpand:function(t){var e=L.DomUtil.hasClass(this._map.getContainer(),"sidebar-expanded");if(e)for(L.DomUtil.removeClass(this._map.getContainer(),"sidebar-expanded"),i=0;i<this._expandButtons.length;i++)L.DomUtil.removeClass(this._expandButtons[i],"active");else for(L.DomUtil.addClass(this._map.getContainer(),"sidebar-expanded"),i=0;i<this._expandButtons.length;i++)L.DomUtil.addClass(this._expandButtons[i],"active");return this._map.invalidateSize(),this.fire("toggleExpand",{expanded:!e}),this},addPanel:function(t){var e,i=L.DomUtil.create("li",t.disabled?"disabled":""),s=L.DomUtil.create("a","",i);return s.href="#"+t.id,s.setAttribute("role","tab"),s.innerHTML=t.tab,i._sidebar=this,i._id=t.id,i._button=t.button,t.title&&"<"!==t.title[0]&&(i.title=t.title),("bottom"===t.position?this._tabContainerBottom:this._tabContainerTop).appendChild(i),this._tabitems.push(i),t.pane&&("string"==typeof t.pane?(e=L.DomUtil.create("DIV","leaflet-sidebar-pane",this._paneContainer),s="",t.title&&(s+='<h1 class="leaflet-sidebar-header">'+t.title),this.options.closeButton&&(s+='<span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>'),t.title&&(s+="</h1>"),e.innerHTML=s+t.pane):(e=t.pane,this._paneContainer.appendChild(e)),e.id=t.id,this._panes.push(e),(s=e.querySelectorAll(".leaflet-sidebar-close")).length)&&(this._closeButtons.push(s[s.length-1]),this._closeClick(s[s.length-1],"on")),this._tabClick(i,"on"),this},removePanel:function(t){for(var e,i,s,n,a=0;a<this._tabitems.length;a++)if(this._tabitems[a]._id===t){i=this._tabitems[a],this._tabClick(i,"off"),i.remove(),this._tabitems.slice(a,1);break}for(a=0;a<this._panes.length;a++)if(this._panes[a].id===t){for(n=(s=this._panes[a]).querySelectorAll(".leaflet-sidebar-close"),e=0;a<n.length;e++)this._closeClick(n[e],"off");s.remove(),this._panes.slice(a,1);break}return this},enablePanel:function(t){t=this._getTab(t);return L.DomUtil.removeClass(t,"disabled"),this},disablePanel:function(t){t=this._getTab(t);return L.DomUtil.addClass(t,"disabled"),this},_tabClick:function(t,e){var i=t.querySelector("a");i.hasAttribute("href")&&"#"===i.getAttribute("href")[0]&&(i=function(t){L.DomUtil.hasClass(this,"active")?this._sidebar.close():L.DomUtil.hasClass(this,"disabled")||("string"==typeof this._button?window.location.href=this._button:"function"==typeof this._button?this._button(t):this._sidebar.open(this.querySelector("a").hash.slice(1)))},"on"===e?L.DomEvent.on(t.querySelector("a"),"click",L.DomEvent.preventDefault).on(t.querySelector("a"),"click",i,t):L.DomEvent.off(t.querySelector("a"),"click",i))},onCloseClick:function(){this.close()},_closeClick:function(t,e){"on"===e?L.DomEvent.on(t,"click",this.onCloseClick,this):L.DomEvent.off(t,"click",this.onCloseClick)},onExpandClick:function(t){t=t.target||t.srcElement;this.toggleExpand(t)},_expandClick:function(t,e){"on"===e?L.DomEvent.on(t,"click",this.onExpandClick,this):L.DomEvent.off(t,"click",this.onExpandClick)},_getTab:function(t){for(var e=0;e<this._tabitems.length;e++)if(this._tabitems[e]._id===t)return this._tabitems[e];return null},_panMap:function(t){var e=Number.parseInt(L.DomUtil.getStyle(this._container,"max-width"))/2;("open"===t&&"left"===this.options.position||"close"===t&&"right"===this.options.position)&&(e*=-1),this._map.panBy([e,0],{duration:.25})}}),L.control.sidebar=function(t,e){return new L.Control.Sidebar(t,e)};
L.Canvas.prototype._updateTriangle=function(t){var i,n;if(!this._drawing||t._empty())return null;i=t._point,n=this._ctx,wh=t._width/2,hh=t._height/2,r=0!==t._rotation?t._rotation*(2*Math.PI)/360:0,n.save(),n.translate(i.x,i.y),n.rotate(r),n.beginPath(),n.moveTo(0,-hh),n.lineTo(wh,2*hh),n.lineTo(-wh,2*hh),n.closePath(),n.restore(),this._fillStroke(n,t)},L.TriangleMarker=L.Path.extend({options:{fill:!0,width:12,height:12,rotation:0,renderer:L.canvas()},initialize:function(t,i){L.setOptions(this,i),this._latlng=L.latLng(t),this._width=this.options.width,this._height=this.options.height,this._rotation=this.options.rotation,this._renderer=this.options.renderer},setLatLng:function(t){return this._latlng=L.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setWidth:function(t){return this.options.width=this._width=t,this.redraw()},setHeight:function(t){return this.options.height=this._height=t,this.redraw()},setRotation:function(t){return this.options.rotation=this._rotation=t,this.redraw()},getWidth:function(){return this._width},getHeight:function(){return this._height},getRotation:function(){return this._rotation},setStyle:function(t){var i=t&&t.width||this._width,n=t&&t.height||this._height;return L.Path.prototype.setStyle.call(this,t),this.setWidth(i),this.setHeight(n),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._width/2,i=this._height/2,n=this._clickTolerance(),t=[t+n,i+n];this._pxBounds=new L.Bounds(this._point.subtract(t),this._point.add(t))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateTriangle(this)},_empty:function(){return this._width&&this._height&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return this._pxBounds&&this._pxBounds.contains(t)}}),L.triangleMarker=function(t,i){return new L.TriangleMarker(t,i)};
!function(){"use strict";function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(n,t){var e,i=Object.keys(n);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(n),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),i.push.apply(i,e)),i}function I(i){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach(function(t){var n,e;n=i,e=r[t=t],t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(r,t))})}return i}function j(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}function R(t,n){var e,i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){var e;if(t)return"string"==typeof t?j(t,n):"Map"===(e="Object"===(e=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?j(t,n):void 0}(t))||n&&t&&"number"==typeof t.length)return e&&(t=e),i=0,{s:n=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return o=t.done,t},e:function(t){a=!0,r=t},f:function(){try{o||null==e.return||e.return()}finally{if(a)throw r}}}}var q="http://www.w3.org/1999/xhtml",X={svg:"http://www.w3.org/2000/svg",xhtml:q,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function r(t){var n=t+="",e=n.indexOf(":");return 0<=e&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),X.hasOwnProperty(n)?{space:X[n],local:t}:t}function G(t){t=r(t);return(t.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===q&&t.documentElement.namespaceURI===q?t.createElement(e):t.createElementNS(n,e)}})(t)}function V(){}function Y(t){return null==t?V:function(){return this.querySelector(t)}}function $(){return[]}function U(t){return null==t?$:function(){return this.querySelectorAll(t)}}function W(t){return function(){return this.matches(t)}}function Z(t){return new Array(t.length)}function p(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var K="$";function Q(t,n,e,i,r,o){for(var a,s=0,u=n.length,l=o.length;s<l;++s)(a=n[s])?(a.__data__=o[s],i[s]=a):e[s]=new p(t,o[s]);for(;s<u;++s)(a=n[s])&&(r[s]=a)}function J(t,n,e,i,r,o,a){for(var s,u,l={},h=n.length,c=o.length,f=new Array(h),d=0;d<h;++d)(s=n[d])&&(f[d]=u=K+a.call(s,s.__data__,d,n),u in l?r[d]=s:l[u]=s);for(d=0;d<c;++d)(s=l[u=K+a.call(t,o[d],d,o)])?((i[d]=s).__data__=o[d],l[u]=null):e[d]=new p(t,o[d]);for(d=0;d<h;++d)(s=n[d])&&l[f[d]]===s&&(r[d]=s)}function tt(t,n){return t<n?-1:n<t?1:n<=t?0:NaN}function nt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function C(t,n){return t.style.getPropertyValue(n)||nt(t).getComputedStyle(t,null).getPropertyValue(n)}function et(t){return t.trim().split(/^|\s+/)}function it(t){return t.classList||new rt(t)}function rt(t){this._node=t,this._names=et(t.getAttribute("class")||"")}function ot(t,n){for(var e=it(t),i=-1,r=n.length;++i<r;)e.add(n[i])}function at(t,n){for(var e=it(t),i=-1,r=n.length;++i<r;)e.remove(n[i])}function st(){this.textContent=""}function ut(){this.innerHTML=""}function lt(){this.nextSibling&&this.parentNode.appendChild(this)}function ht(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ct(){return null}function ft(){var t=this.parentNode;t&&t.removeChild(this)}function dt(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function pt(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}rt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){t=this._names.indexOf(t);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return 0<=this._names.indexOf(t)}};var gt={},w=null;function _t(e,t,n){return e=mt(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function mt(e,i,r){return function(t){var n=w;w=t;try{e.call(this,this.__data__,i,r)}finally{w=n}}}function yt(o){return function(){var t=this.__on;if(t){for(var n,e=0,i=-1,r=t.length;e<r;++e)n=t[e],o.type&&n.type!==o.type||n.name!==o.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function vt(u,l,h){var c=gt.hasOwnProperty(u.type)?_t:mt;return function(t,n,e){var i,r=this.__on,o=c(l,n,e);if(r)for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===u.type&&i.name===u.name)return this.removeEventListener(i.type,i.listener,i.capture),this.addEventListener(i.type,i.listener=o,i.capture=h),void(i.value=l);this.addEventListener(u.type,o,h),i={type:u.type,name:u.name,value:l,listener:o,capture:h},r?r.push(i):this.__on=[i]}}function xt(t,n,e,i){var r=w;t.sourceEvent=w,w=t;try{return n.apply(e,i)}finally{w=r}}function wt(t,n,e){var i=nt(t),r=i.CustomEvent;"function"==typeof r?r=new r(n,e):(r=i.document.createEvent("Event"),e?(r.initEvent(n,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(n,!1,!1)),t.dispatchEvent(r)}"undefined"==typeof document||"onmouseenter"in document.documentElement||(gt={mouseenter:"mouseover",mouseleave:"mouseout"});var bt=[null];function b(t,n){this._groups=t,this._parents=n}function t(){return new b([[document.documentElement]],bt)}function M(t){return"string"==typeof t?new b([[document.querySelector(t)]],[document.documentElement]):new b([[t]],bt)}function Mt(){for(var t,n=w;t=n.sourceEvent;)n=t;return n}function kt(t,n){var e=t.ownerSVGElement||t;return e.createSVGPoint?((e=e.createSVGPoint()).x=n.clientX,e.y=n.clientY,[(e=e.matrixTransform(t.getScreenCTM().inverse())).x,e.y]):(e=t.getBoundingClientRect(),[n.clientX-e.left-t.clientLeft,n.clientY-e.top-t.clientTop])}function k(t){var n=Mt();return kt(t,n=n.changedTouches?n.changedTouches[0]:n)}function l(t){return"string"==typeof t?new b([document.querySelectorAll(t)],[document.documentElement]):new b([null==t?[]:t],bt)}function At(t,n,e){arguments.length<3&&(e=n,n=Mt().changedTouches);for(var i,r=0,o=n?n.length:0;r<o;++r)if((i=n[r]).identifier===e)return kt(t,i);return null}b.prototype=t.prototype={constructor:b,select:function(t){"function"!=typeof t&&(t=Y(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o,a,s=n[r],u=s.length,l=i[r]=new Array(u),h=0;h<u;++h)(o=s[h])&&(a=t.call(o,o.__data__,h,s))&&("__data__"in o&&(a.__data__=o.__data__),l[h]=a);return new b(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=U(t));for(var n=this._groups,e=n.length,i=[],r=[],o=0;o<e;++o)for(var a,s=n[o],u=s.length,l=0;l<u;++l)(a=s[l])&&(i.push(t.call(a,a.__data__,l,s)),r.push(a));return new b(i,r)},filter:function(t){"function"!=typeof t&&(t=W(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o,a=n[r],s=a.length,u=i[r]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&u.push(o);return new b(i,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),h=-1,this.each(function(t){p[++h]=t}),p;var e,i=n?J:Q,r=this._parents,o=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var a=o.length,s=new Array(a),u=new Array(a),l=new Array(a),h=0;h<a;++h){var c=r[h],f=o[h],d=f.length,p=t.call(c,c&&c.__data__,h,r),g=p.length,_=u[h]=new Array(g),m=s[h]=new Array(g);i(c,f,_,m,l[h]=new Array(d),p,n);for(var y,v,x=0,w=0;x<g;++x)if(y=_[x]){for(w<=x&&(w=x+1);!(v=m[w])&&++w<g;);y._next=v||null}}return(s=new b(s,r))._enter=u,s._exit=l,s},enter:function(){return new b(this._enter||this._groups.map(Z),this._parents)},exit:function(){return new b(this._exit||this._groups.map(Z),this._parents)},join:function(t,n,e){var i=this.enter(),r=this,o=this.exit(),i="function"==typeof t?t(i):i.append(t+"");return null!=n&&(r=n(r)),null==e?o.remove():e(o),i&&r?i.merge(r).order():r},merge:function(t){for(var n=this._groups,e=t._groups,i=n.length,t=e.length,r=Math.min(i,t),o=new Array(i),a=0;a<r;++a)for(var s,u=n[a],l=e[a],h=u.length,c=o[a]=new Array(h),f=0;f<h;++f)(s=u[f]||l[f])&&(c[f]=s);for(;a<i;++a)o[a]=n[a];return new b(o,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var i,r=t[n],o=r.length-1,a=r[o];0<=--o;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e=e||tt;for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a,s=n[o],u=s.length,l=r[o]=new Array(u),h=0;h<u;++h)(a=s[h])&&(l[h]=a);l.sort(t)}return new b(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each(function(){t[++n]=this}),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,i=n.length;e<i;++e)for(var r,o=n[e],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},attr:function(t,n){var e,t=r(t);return arguments.length<2?(e=this.node(),t.local?e.getAttributeNS(t.space,t.local):e.getAttribute(t)):this.each((null==n?t.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof n?t.local?function(n,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}}:function(n,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttribute(n):this.setAttribute(n,t)}}:t.local?function(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}:function(t,n){return function(){this.setAttribute(t,n)}})(t,n))},style:function(t,n,e){return 1<arguments.length?this.each((null==n?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof n?function(n,e,i){return function(){var t=e.apply(this,arguments);null==t?this.style.removeProperty(n):this.style.setProperty(n,t,i)}}:function(t,n,e){return function(){this.style.setProperty(t,n,e)}})(t,n,null==e?"":e)):C(this.node(),t)},property:function(t,n){return 1<arguments.length?this.each((null==n?function(t){return function(){delete this[t]}}:"function"==typeof n?function(n,e){return function(){var t=e.apply(this,arguments);null==t?delete this[n]:this[n]=t}}:function(t,n){return function(){this[t]=n}})(t,n)):this.node()[t]},classed:function(t,n){var e=et(t+"");if(arguments.length<2){for(var i=it(this.node()),r=-1,o=e.length;++r<o;)if(!i.contains(e[r]))return!1;return!0}return this.each(("function"==typeof n?function(t,n){return function(){(n.apply(this,arguments)?ot:at)(this,t)}}:n?function(t){return function(){ot(this,t)}}:function(t){return function(){at(this,t)}})(e,n))},text:function(t){return arguments.length?this.each(null==t?st:("function"==typeof t?function(n){return function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ut:("function"==typeof t?function(n){return function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(lt)},lower:function(){return this.each(ht)},append:function(t){var n="function"==typeof t?t:G(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function(t,n){var e="function"==typeof t?t:G(t),i=null==n?ct:"function"==typeof n?n:Y(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(ft)},clone:function(t){return this.select(t?pt:dt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var i,r,o=(t+"").trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");return 0<=e&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}),a=o.length;if(!(arguments.length<2)){for(s=n?vt:yt,null==e&&(e=!1),i=0;i<a;++i)this.each(s(o[i],n,e));return this}var s=this.node().__on;if(s)for(var u,l=0,h=s.length;l<h;++l)for(i=0,u=s[l];i<a;++i)if((r=o[i]).type===u.type&&r.name===u.name)return u.value},dispatch:function(t,n){return this.each(("function"==typeof n?function(t,n){return function(){return wt(this,t,n.apply(this,arguments))}}:function(t,n){return function(){return wt(this,t,n)}})(t,n))}};var St={value:function(){}};function Tt(){for(var t,n=0,e=arguments.length,i={};n<e;++n){if(!(t=arguments[n]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Nt(i)}function Nt(t){this._=t}function Ct(t,n,e){for(var i=0,r=t.length;i<r;++i)if(t[i].name===n){t[i]=St,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=e&&t.push({name:n,value:e}),t}Nt.prototype=Tt.prototype={constructor:Nt,on:function(t,n){var e,i,r=this._,o=(i=r,(t+"").trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");if(0<=e&&(n=t.slice(e+1),t=t.slice(0,e)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++a<s;)if(e=(t=o[a]).type)r[e]=Ct(r[e],t.name,n);else if(null==n)for(e in r)r[e]=Ct(r[e],t.name,null);return this}for(;++a<s;)if(e=(e=(t=o[a]).type)&&function(t,n){for(var e,i=0,r=t.length;i<r;++i)if((e=t[i]).name===n)return e.value}(r[e],t.name))return e},copy:function(){var t,n={},e=this._;for(t in e)n[t]=e[t].slice();return new Nt(n)},call:function(t,n){if(0<(e=arguments.length-2))for(var e,i,r=new Array(e),o=0;o<e;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(i=this._[t]).length;o<e;++o)i[o].value.apply(n,r)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(n,e)}};var Et,a,s=0,u=0,n=0,Ht=1e3,Lt=0,h=0,Dt=0,c="object"==typeof performance&&performance.now?performance:Date,Ft="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Pt(){return h||(Ft(Bt),h=c.now()+Dt)}function Bt(){h=0}function Ot(){this._call=this._time=this._next=null}function zt(t,n,e){var i=new Ot;return i.restart(t,n,e),i}function It(){h=(Lt=c.now())+Dt,s=u=0;try{Pt(),++s;for(var t,n=Et;n;)0<=(t=h-n._time)&&n._call.call(null,t),n=n._next;--s}finally{for(var e,i,r=Et,o=1/(s=0);r;)r=r._call?(o>r._time&&(o=r._time),(e=r)._next):(i=r._next,r._next=null,e?e._next=i:Et=i);a=e,Rt(o),h=0}}function jt(){var t=c.now(),n=t-Lt;Ht<n&&(Dt-=n,Lt=t)}function Rt(t){s||(u=u&&clearTimeout(u),24<t-h?(t<1/0&&(u=setTimeout(It,t-c.now()-Dt)),n=n&&clearInterval(n)):(n||(Lt=c.now(),n=setInterval(jt,Ht)),s=1,Ft(It)))}function qt(n,e,t){var i=new Ot;return e=null==e?0:+e,i.restart(function(t){i.stop(),n(t+e)},e,t),i}Ot.prototype=zt.prototype={constructor:Ot,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?Pt():+e)+(null==n?0:+n),this._next||a===this||(a?a._next=this:Et=this,a=this),this._call=t,this._time=e,Rt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Rt())}};var Xt=Tt("start","end","cancel","interrupt"),Gt=[],Vt=0,Yt=1,$t=2,Ut=3,Wt=4,Zt=5,Kt=6;function Qt(t,n,e,i,r,o){var a,s,u,l,h,c=t.__transition;if(c){if(e in c)return}else t.__transition={};function f(t){var n,e,i,r;if(u.state!==Yt)return p();for(n in h)if((r=h[n]).name===u.name){if(r.state===Ut)return qt(f);r.state===Wt?(r.state=Kt,r.timer.stop(),r.on.call("interrupt",a,a.__data__,r.index,r.group),delete h[n]):+n<s&&(r.state=Kt,r.timer.stop(),r.on.call("cancel",a,a.__data__,r.index,r.group),delete h[n])}if(qt(function(){u.state===Ut&&(u.state=Wt,u.timer.restart(d,u.delay,u.time),d(t))}),u.state=$t,u.on.call("start",a,a.__data__,u.index,u.group),u.state===$t){for(u.state=Ut,l=new Array(i=u.tween.length),n=0,e=-1;n<i;++n)(r=u.tween[n].value.call(a,a.__data__,u.index,u.group))&&(l[++e]=r);l.length=e+1}}function d(t){for(var n=t<u.duration?u.ease.call(null,t/u.duration):(u.timer.restart(p),u.state=Zt,1),e=-1,i=l.length;++e<i;)l[e].call(a,n);u.state===Zt&&(u.on.call("end",a,a.__data__,u.index,u.group),p())}function p(){for(var t in u.state=Kt,u.timer.stop(),delete h[s],h)return;delete a.__transition}a=t,s=e,u={name:n,index:i,group:r,on:Xt,tween:Gt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Vt},((h=a.__transition)[s]=u).timer=zt(function(t){u.state=Yt,u.timer.restart(f,u.delay,u.time),u.delay<=t&&f(t-u.delay)},0,u.time)}function Jt(t,n){t=m(t,n);if(t.state>Vt)throw new Error("too late; already scheduled");return t}function E(t,n){t=m(t,n);if(t.state>Ut)throw new Error("too late; already running");return t}function m(t,n){t=t.__transition;if(t=t&&t[n])return t;throw new Error("transition not found")}function tn(t,n,e){(t.prototype=n.prototype=e).constructor=t}function nn(t,n){var e,i=Object.create(t.prototype);for(e in n)i[e]=n[e];return i}function f(){}var e="\\s*([+-]?\\d+)\\s*",i="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",o="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",en=/^#([0-9a-f]{3,8})$/,rn=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),on=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),an=new RegExp("^rgba\\("+[e,e,e,i]+"\\)$"),sn=new RegExp("^rgba\\("+[o,o,o,i]+"\\)$"),un=new RegExp("^hsl\\("+[i,o,o]+"\\)$"),ln=new RegExp("^hsla\\("+[i,o,o,i]+"\\)$"),hn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function cn(){return this.rgb().formatHex()}function fn(){return this.rgb().formatRgb()}function d(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=en.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?dn(n):3===e?new g(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?pn(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?pn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=rn.exec(t))?new g(n[1],n[2],n[3],1):(n=on.exec(t))?new g(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=an.exec(t))?pn(n[1],n[2],n[3],n[4]):(n=sn.exec(t))?pn(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=un.exec(t))?vn(n[1],n[2]/100,n[3]/100,1):(n=ln.exec(t))?vn(n[1],n[2]/100,n[3]/100,n[4]):hn.hasOwnProperty(t)?dn(hn[t]):"transparent"===t?new g(NaN,NaN,NaN,0):null}function dn(t){return new g(t>>16&255,t>>8&255,255&t,1)}function pn(t,n,e,i){return new g(t=i<=0?n=e=NaN:t,n,e,i)}function gn(t,n,e,i){return 1===arguments.length?(r=(r=t)instanceof f?r:d(r))?new g((r=r.rgb()).r,r.g,r.b,r.opacity):new g:new g(t,n,e,null==i?1:i);var r}function g(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}function _n(){return"#"+yn(this.r)+yn(this.g)+yn(this.b)}function mn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function yn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function vn(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||1<=e?t=n=NaN:n<=0&&(t=NaN),new _(t,n,e,i)}function xn(t){var n,e,i,r,o,a,s,u;return t instanceof _?new _(t.h,t.s,t.l,t.opacity):(t=t instanceof f?t:d(t))?t instanceof _?t:(n=(t=t.rgb()).r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),a=NaN,u=((o=Math.max(n,e,i))+r)/2,(s=o-r)?(a=n===o?(e-i)/s+6*(e<i):e===o?(i-n)/s+2:(n-e)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=0<u&&u<1?0:a,new _(a,s,u,t.opacity)):new _}function _(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}function wn(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function bn(t){return function(){return t}}function Mn(o){return 1==(o=+o)?kn:function(t,n){return n-t?(e=t,i=n,r=o,e=Math.pow(e,r),i=Math.pow(i,r)-e,r=1/r,function(t){return Math.pow(e+t*i,r)}):bn(isNaN(t)?n:t);var e,i,r}}function kn(t,n){var e,i,r=n-t;return r?(e=t,i=r,function(t){return e+t*i}):bn(isNaN(t)?n:t)}tn(f,d,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:cn,formatHex:cn,formatHsl:function(){return xn(this).formatHsl()},formatRgb:fn,toString:fn}),tn(g,gn,nn(f,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new g(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new g(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_n,formatHex:_n,formatRgb:mn,toString:mn})),tn(_,function(t,n,e,i){return 1===arguments.length?xn(t):new _(t,n,e,null==i?1:i)},nn(f,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new _(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new _(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*n,e=2*e-n;return new g(wn(240<=t?t-240:120+t,e,n),wn(t,e,n),wn(t<120?240+t:t-120,e,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var An=function t(n){var a=Mn(n);function e(n,t){var e=a((n=gn(n)).r,(t=gn(t)).r),i=a(n.g,t.g),r=a(n.b,t.b),o=kn(n.opacity,t.opacity);return function(t){return n.r=e(t),n.g=i(t),n.b=r(t),n.opacity=o(t),n+""}}return e.gamma=t,e}(1);function y(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}var Sn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Tn=new RegExp(Sn.source,"g");function Nn(t,i){var n,e,r,o,a,s=Sn.lastIndex=Tn.lastIndex=0,u=-1,l=[],h=[];for(t+="",i+="";(n=Sn.exec(t))&&(e=Tn.exec(i));)(r=e.index)>s&&(r=i.slice(s,r),l[u]?l[u]+=r:l[++u]=r),(n=n[0])===(e=e[0])?l[u]?l[u]+=e:l[++u]=e:(l[++u]=null,h.push({i:u,x:y(n,e)})),s=Tn.lastIndex;return s<i.length&&(r=i.slice(s),l[u]?l[u]+=r:l[++u]=r),l.length<2?h[0]?(a=h[0].x,function(t){return a(t)+""}):(o=i,function(){return o}):(i=h.length,function(t){for(var n,e=0;e<i;++e)l[(n=h[e]).i]=n.x(t);return l.join("")})}function Cn(t,n){var e=typeof n;return null==n||"boolean"==e?bn(n):("number"==e?y:"string"==e?(e=d(n))?(n=e,An):Nn:n instanceof d?An:n instanceof Date?function(n,e){var i=new Date;return n=+n,e=+e,function(t){return i.setTime(n*(1-t)+e*t),i}}:(e=n,!ArrayBuffer.isView(e)||e instanceof DataView?Array.isArray(n)?function(t,n){for(var e=n?n.length:0,i=t?Math.min(e,t.length):0,r=new Array(i),o=new Array(e),a=0;a<i;++a)r[a]=Cn(t[a],n[a]);for(;a<e;++a)o[a]=n[a];return function(t){for(a=0;a<i;++a)o[a]=r[a](t);return o}}:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?function(t,n){var e,i={},r={};for(e in null!==t&&"object"==typeof t||(t={}),n=null!==n&&"object"==typeof n?n:{})e in t?i[e]=Cn(t[e],n[e]):r[e]=n[e];return function(t){for(e in i)r[e]=i[e](t);return r}}:y:function(n,e){e=e||[];var i,r=n?Math.min(e.length,n.length):0,o=e.slice();return function(t){for(i=0;i<r;++i)o[i]=n[i]*(1-t)+e[i]*t;return o}}))(t,n)}function En(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}var v,Hn,Ln,Dn,Fn=180/Math.PI,Pn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Bn(t,n,e,i,r,o){var a,s,u;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(u=t*e+n*i)&&(e-=t*u,i-=n*u),(s=Math.sqrt(e*e+i*i))&&(e/=s,i/=s,u/=s),t*i<n*e&&(t=-t,n=-n,u=-u,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(n,t)*Fn,skewX:Math.atan(u)*Fn,scaleX:a,scaleY:s}}function On(f,d,p,g){function _(t){return t.length?t.pop()+" ":""}return function(t,n){var e,i,r,o,a,s,u,l,h=[],c=[];return t=f(t),n=f(n),r=t.translateX,o=t.translateY,u=n.translateX,s=n.translateY,a=h,i=c,r!==u||o!==s?(e=a.push("translate(",null,d,null,p),i.push({i:e-4,x:y(r,u)},{i:e-2,x:y(o,s)})):(u||s)&&a.push("translate("+u+d+s+p),i=t.rotate,r=n.rotate,e=h,o=c,i!==r?(180<i-r?r+=360:180<r-i&&(i+=360),o.push({i:e.push(_(e)+"rotate(",null,g)-2,x:y(i,r)})):r&&e.push(_(e)+"rotate("+r+g),a=t.skewX,u=n.skewX,s=h,o=c,a!==u?o.push({i:s.push(_(s)+"skewX(",null,g)-2,x:y(a,u)}):u&&s.push(_(s)+"skewX("+u+g),i=t.scaleX,r=t.scaleY,o=n.scaleX,a=n.scaleY,s=h,u=c,i!==o||r!==a?(l=s.push(_(s)+"scale(",null,",",null,")"),u.push({i:l-4,x:y(i,o)},{i:l-2,x:y(r,a)})):1===o&&1===a||s.push(_(s)+"scale("+o+","+a+")"),t=n=null,function(t){for(var n,e=-1,i=c.length;++e<i;)h[(n=c[e]).i]=n.x(t);return h.join("")}}}var zn=On(function(t){return"none"===t?Pn:(v||(v=document.createElement("DIV"),Hn=document.documentElement,Ln=document.defaultView),v.style.transform=t,t=Ln.getComputedStyle(Hn.appendChild(v),null).getPropertyValue("transform"),Hn.removeChild(v),Bn(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),In=On(function(t){return null!=t&&((Dn=Dn||document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("transform",t),t=Dn.transform.baseVal.consolidate())?Bn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Pn},", ",")",")");function jn(t,n,e){var i=t._id;return t.each(function(){var t=E(this,i);(t.value||(t.value={}))[n]=e.apply(this,arguments)}),function(t){return m(t,i).value[n]}}function Rn(t,n){var e;return("number"==typeof n?y:n instanceof d?An:(e=d(n))?(n=e,An):Nn)(t,n)}function qn(i,r){var o,a;function t(){var n,e,t=r.apply(this,arguments);return o=t!==a?(a=t)&&(n=i,e=t,function(t){this.setAttributeNS(n.space,n.local,e.call(this,t))}):o}return t._value=r,t}function Xn(i,r){var o,a;function t(){var n,e,t=r.apply(this,arguments);return o=t!==a?(a=t)&&(n=i,e=t,function(t){this.setAttribute(n,e.call(this,t))}):o}return t._value=r,t}var Gn=t.prototype.constructor;function Vn(t){return function(){this.style.removeProperty(t)}}function Yn(r,o,a){var s,u;function t(){var n,e,i,t=o.apply(this,arguments);return s=t!==u?(u=t)&&(n=r,e=t,i=a,function(t){this.style.setProperty(n,e.call(this,t),i)}):s}return t._value=o,t}function $n(e){var i,r;function t(){var n,t=e.apply(this,arguments);return i=t!==r?(r=t)&&(n=t,function(t){this.textContent=n.call(this,t)}):i}return t._value=e,t}var Un=0;function x(t,n,e,i){this._groups=t,this._parents=n,this._name=e,this._id=i}e=t.prototype;x.prototype={constructor:x,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=Y(t));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s,u,l=i[a],h=l.length,c=o[a]=new Array(h),f=0;f<h;++f)(s=l[f])&&(u=t.call(s,s.__data__,f,l))&&("__data__"in s&&(u.__data__=s.__data__),c[f]=u,Qt(c[f],n,e,f,c,m(s,e)));return new x(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=U(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var u,l=i[s],h=l.length,c=0;c<h;++c)if(u=l[c]){for(var f,d=t.call(u,u.__data__,c,l),p=m(u,e),g=0,_=d.length;g<_;++g)(f=d[g])&&Qt(f,n,e,g,d,p);o.push(d),a.push(u)}return new x(o,a,n,e)},filter:function(t){"function"!=typeof t&&(t=W(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o,a=n[r],s=a.length,u=i[r]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&u.push(o);return new x(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,i=n.length,t=e.length,r=Math.min(i,t),o=new Array(i),a=0;a<r;++a)for(var s,u=n[a],l=e[a],h=u.length,c=o[a]=new Array(h),f=0;f<h;++f)(s=u[f]||l[f])&&(c[f]=s);for(;a<i;++a)o[a]=n[a];return new x(o,this._parents,this._name,this._id)},selection:function(){return new Gn(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=++Un,i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],u=s.length,l=0;l<u;++l)(a=s[l])&&Qt(a,t,e,l,s,{time:(a=m(a,n)).time+a.delay+a.duration,delay:0,duration:a.duration,ease:a.ease});return new x(i,this._parents,t,e)},call:e.call,nodes:e.nodes,node:e.node,size:e.size,empty:e.empty,each:e.each,on:function(t,n){var e,i,r,o,a,s,u=this._id;return arguments.length<2?m(this.node(),u).on.on(t):this.each((e=u,r=n,s=((i=t)+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return!(t=0<=n?t.slice(0,n):t)||"start"===t})?Jt:E,function(){var t=s(this,e),n=t.on;n!==o&&(a=(o=n).copy()).on(i,r),t.on=a}))},attr:function(t,n){var e=r(t),i="transform"===e?In:Rn;return this.attrTween(t,"function"==typeof n?(e.local?function(i,r,o){var a,s,u;return function(){var t,n,e=o(this);if(null!=e)return(t=this.getAttributeNS(i.space,i.local))===(n=e+"")?null:t===a&&n===s?u:(s=n,u=r(a=t,e));this.removeAttributeNS(i.space,i.local)}}:function(i,r,o){var a,s,u;return function(){var t,n,e=o(this);if(null!=e)return(t=this.getAttribute(i))===(n=e+"")?null:t===a&&n===s?u:(s=n,u=r(a=t,e));this.removeAttribute(i)}})(e,i,jn(this,"attr."+t,n)):null==n?(e.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(e):(e.local?function(n,e,i){var r,o,a=i+"";return function(){var t=this.getAttributeNS(n.space,n.local);return t===a?null:t===r?o:o=e(r=t,i)}}:function(n,e,i){var r,o,a=i+"";return function(){var t=this.getAttribute(n);return t===a?null:t===r?o:o=e(r=t,i)}})(e,i,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;return t=r(t),this.tween(e,(t.local?qn:Xn)(t,n))},style:function(t,n,e){var i,r,o,a,s,u,l,h,c,f,d,p,g,_,m,y,v,x,w,b,M,k,A,S,T,N="transform"==(t+="")?zn:Rn;return null==n?this.styleTween(t,(M=t,k=N,function(){var t=C(this,M),n=(this.style.removeProperty(M),C(this,M));return t===n?null:t===A&&n===S?T:T=k(A=t,S=n)})).on("end.style."+t,Vn(t)):"function"==typeof n?this.styleTween(t,(y=N,v=jn(this,"style."+(m=t),n),function(){var t=C(this,m),n=v(this),e=n+"";return null==n&&(this.style.removeProperty(m),e=n=C(this,m)),t===e?null:t===x&&e===w?b:(w=e,b=y(x=t,n))})).each((l=this._id,_="end."+(g="style."+(h=t)),function(){var t=E(this,l),n=t.on,e=null==t.value[g]?p=p||Vn(h):void 0;n===c&&d===e||(f=(c=n).copy()).on(_,d=e),t.on=f})):this.styleTween(t,(i=t,r=N,u=(o=n)+"",function(){var t=C(this,i);return t===u?null:t===a?s:s=r(a=t,o)}),e).on("end.style."+t,null)},styleTween:function(t,n,e){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==n)return this.tween(i,null);if("function"!=typeof n)throw new Error;return this.tween(i,Yn(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?(e=jn(this,"text",t),function(){var t=e(this);this.textContent=null==t?"":t}):(n=null==t?"":t+"",function(){this.textContent=n}));var n,e},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,$n(t))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t,n=this.parentNode;for(t in this.__transition)if(+t!==e)return;n&&n.removeChild(this)}));var e},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var i,r=m(this.node(),e).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==n?function(r,o){var a,s;return function(){var t=E(this,r),n=t.tween;if(n!==a)for(var e=0,i=(s=a=n).length;e<i;++e)if(s[e].name===o){(s=s.slice()).splice(e,1);break}t.tween=s}}:function(o,a,s){var u,l;if("function"!=typeof s)throw new Error;return function(){var t=E(this,o),n=t.tween;if(n!==u){l=(u=n).slice();for(var e={name:a,value:s},i=0,r=l.length;i<r;++i)if(l[i].name===a){l[i]=e;break}i===r&&l.push(e)}t.tween=l}})(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){Jt(this,t).delay=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){Jt(this,t).delay=n}})(n,t)):m(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){E(this,t).duration=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){E(this,t).duration=n}})(n,t)):m(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(function(t,n){if("function"!=typeof n)throw new Error;return function(){E(this,t).ease=n}}(n,t)):m(this.node(),n).ease},end:function(){var r,o,a=this,s=a._id,u=a.size();return new Promise(function(t,n){var e={value:n},i={value:function(){0==--u&&t()}};a.each(function(){var t=E(this,s),n=t.on;n!==r&&((o=(r=n).copy())._.cancel.push(e),o._.interrupt.push(e),o._.end.push(i)),t.on=o})})}};var Wn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Zn(t,n){return t<n?-1:n<t?1:n<=t?0:NaN}function Kn(o){var e;return 1===o.length&&(e=o,o=function(t,n){return Zn(e(t),n)}),{left:function(t,n,e,i){for(null==e&&(e=0),null==i&&(i=t.length);e<i;){var r=e+i>>>1;o(t[r],n)<0?e=1+r:i=r}return e},right:function(t,n,e,i){for(null==e&&(e=0),null==i&&(i=t.length);e<i;){var r=e+i>>>1;0<o(t[r],n)?i=r:e=1+r}return e}}}t.prototype.interrupt=function(s){return this.each(function(){var t,n,e,i=this,r=s,o=i.__transition,a=!0;if(o){for(e in r=null==r?null:r+"",o)(t=o[e]).name!==r?a=!1:(n=t.state>$t&&t.state<Zt,t.state=Kt,t.timer.stop(),t.on.call(n?"interrupt":"cancel",i,i.__data__,t.index,t.group),delete o[e]);a&&delete i.__transition}})},t.prototype.transition=function(t){var n,e;t=t instanceof x?(n=t._id,t._name):(n=++Un,(e=Wn).time=Pt(),null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],u=s.length,l=0;l<u;++l)(a=s[l])&&Qt(a,t,n,l,s,e||function(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))return Wn.time=Pt(),Wn;return e}(a,n));return new x(i,this._parents,t,n)},t.prototype.attrs=function(t){return("function"==typeof t?function(t,i){return t.each(function(){var t,n=i.apply(this,arguments),e=M(this);for(t in n)e.attr(t,n[t])})}:function(t,n){for(var e in n)t.attr(e,n[e]);return t})(this,t)},t.prototype.styles=function(t,n){return("function"==typeof t?function(t,i,r){return t.each(function(){var t,n=i.apply(this,arguments),e=M(this);for(t in n)e.style(t,n[t],r)})}:function(t,n,e){for(var i in n)t.style(i,n[i],e);return t})(this,t,null==n?"":n)},t.prototype.properties=function(t){return("function"==typeof t?function(t,i){return t.each(function(){var t,n=i.apply(this,arguments),e=M(this);for(t in n)e.property(t,n[t])})}:function(t,n){for(var e in n)t.property(e,n[e]);return t})(this,t)};var Qn=Kn(Zn).right,Jn=Math.sqrt(50),te=Math.sqrt(10),ne=Math.sqrt(2);function ee(t,n,e){n=(n-t)/Math.max(0,e),t=Math.floor(Math.log(n)/Math.LN10),e=n/Math.pow(10,t);return 0<=t?(Jn<=e?10:te<=e?5:ne<=e?2:1)*Math.pow(10,t):-Math.pow(10,-t)/(Jn<=e?10:te<=e?5:ne<=e?2:1)}function ie(t,n){var e,i,r=t.length,o=-1;if(null==n){for(;++o<r;)if(null!=(e=t[o])&&e<=e)for(i=e;++o<r;)null!=(e=t[o])&&i<e&&(i=e)}else for(;++o<r;)if(null!=(e=n(t[o],o,t))&&e<=e)for(i=e;++o<r;)null!=(e=n(t[o],o,t))&&i<e&&(i=e);return i}function re(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}var A="$";function oe(){}function ae(t,n){var e=new oe;if(t instanceof oe)t.each(function(t,n){e.set(n,t)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(null==n)for(;++r<o;)e.set(r,t[r]);else for(;++r<o;)e.set(n(i=t[r],r,t),i)}else if(t)for(var a in t)e.set(a,t[a]);return e}oe.prototype=ae.prototype={constructor:oe,has:function(t){return A+t in this},get:function(t){return this[A+t]},set:function(t,n){return this[A+t]=n,this},remove:function(t){t=A+t;return t in this&&delete this[t]},clear:function(){for(var t in this)t[0]===A&&delete this[t]},keys:function(){var t,n=[];for(t in this)t[0]===A&&n.push(t.slice(1));return n},values:function(){var t,n=[];for(t in this)t[0]===A&&n.push(this[t]);return n},entries:function(){var t,n=[];for(t in this)t[0]===A&&n.push({key:t.slice(1),value:this[t]});return n},size:function(){var t,n=0;for(t in this)t[0]===A&&++n;return n},empty:function(){for(var t in this)if(t[0]===A)return!1;return!0},each:function(t){for(var n in this)n[0]===A&&t(this[n],n.slice(1),this)}};var o=Array.prototype,se=o.map,ue=o.slice,le={name:"implicit"};function he(t){return+t}var ce=[0,1];function S(t){return t}function fe(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:(t=isNaN(e)?NaN:.5,function(){return t});var t}function de(t){var n=t[0],e=t[t.length-1];return e<n&&(t=n,n=e,e=t),function(t){return Math.max(n,Math.min(e,t))}}function pe(t,n,e){var i=t[0],t=t[1],r=n[0],n=n[1],r=t<i?(i=fe(t,i),e(n,r)):(i=fe(i,t),e(r,n));return function(t){return r(i(t))}}function ge(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),a=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<i;)r[a]=fe(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=Qn(e,t,1,i)-1;return o[n](r[n](t))}}function _e(t,n){var e,i,r,o,a,s,u,l,h,c;return l=u=ce,h=Cn,c=S,d.invert=function(t){return c(i((s=s||o(l,u.map(e),y))(t)))},d.domain=function(t){return arguments.length?(u=se.call(t,he),c!==S&&(c=de(u)),f()):u.slice()},d.range=function(t){return arguments.length?(l=ue.call(t),f()):l.slice()},d.rangeRound=function(t){return l=ue.call(t),h=En,f()},d.clamp=function(t){return arguments.length?(c=t?de(u):S,d):c!==S},d.interpolate=function(t){return arguments.length?(h=t,f()):h},d.unknown=function(t){return arguments.length?(r=t,d):r},e=t,i=n,f();function f(){return o=2<Math.min(u.length,l.length)?ge:pe,a=s=null,d}function d(t){return isNaN(t=+t)?r:(a=a||o(u.map(e),l,h))(e(c(t)))}}function me(t,n){var e;return(n=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0?null:[1<(e=t.slice(0,n)).length?e[0]+e.slice(2):e,+t.slice(n+1)]}function T(t){return(t=me(Math.abs(t)))?t[1]:NaN}var ye,ve=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xe(t){var n;if(n=ve.exec(t))return new we({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]});throw new Error("invalid format: "+t)}function we(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function be(t,n){var e,n=me(t,n);return n?(e=n[0],(n=n[1])<0?"0."+new Array(-n).join("0")+e:e.length>n+1?e.slice(0,n+1)+"."+e.slice(n+1):e+new Array(n-e.length+2).join("0")):t+""}xe.prototype=we.prototype,we.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Me={"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return be(100*t,n)},r:be,s:function(t,n){var e,i,r=me(t,n);return r?(e=r[0],(r=(r=r[1])-(ye=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1)===(i=e.length)?e:i<r?e+new Array(r-i+1).join("0"):0<r?e.slice(0,r)+"."+e.slice(r):"0."+new Array(1-r).join("0")+me(t,Math.max(0,n+r-1))[0]):t+""},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function ke(t){return t}var N,Ae,Se=Array.prototype.map,Te=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function Ne(t){var n,s,u,b=void 0===t.grouping||void 0===t.thousands?ke:(s=Se.call(t.grouping,Number),u=t.thousands+"",function(t,n){for(var e=t.length,i=[],r=0,o=s[0],a=0;0<e&&0<o&&(n<a+o+1&&(o=Math.max(1,n-a)),i.push(t.substring(e-=o,e+o)),!((a+=o+1)>n));)o=s[r=(r+1)%s.length];return i.reverse().join(u)}),i=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",M=void 0===t.decimal?".":t.decimal+"",k=void 0===t.numerals?ke:(n=Se.call(t.numerals,String),function(t){return t.replace(/[0-9]/g,function(t){return n[+t]})}),o=void 0===t.percent?"%":t.percent+"",A=void 0===t.minus?"-":t.minus+"",S=void 0===t.nan?"NaN":t.nan+"";function a(t){var l=(t=xe(t)).fill,h=t.align,c=t.sign,n=t.symbol,f=t.zero,d=t.width,p=t.comma,g=t.precision,_=t.trim,m=t.type,y=("n"===m?(p=!0,m="g"):Me[m]||(void 0===g&&(g=12),_=!0,m="g"),(f||"0"===l&&"="===h)&&(f=!0,l="0",h="="),"$"===n?i:"#"===n&&/[boxX]/.test(m)?"0"+m.toLowerCase():""),v="$"===n?r:/[%p]/.test(m)?o:"",x=Me[m],w=/[defgprs%]/.test(m);function e(t){var n,e,i,r=y,o=v;if("c"===m)o=x(t)+o,t="";else{var a=(t=+t)<0||1/t<0;if(t=isNaN(t)?S:x(Math.abs(t),g),_&&(t=function(t){t:for(var n,e=t.length,i=1,r=-1;i<e;++i)switch(t[i]){case".":r=n=i;break;case"0":0===r&&(r=i),n=i;break;default:if(!+t[i])break t;0<r&&(r=0)}return 0<r?t.slice(0,r)+t.slice(n+1):t}(t)),r=((a=a&&0==+t&&"+"!==c?!1:a)?"("===c?c:A:"-"===c||"("===c?"":c)+r,o=("s"===m?Te[8+ye/3]:"")+o+(a&&"("===c?")":""),w)for(n=-1,e=t.length;++n<e;)if((i=t.charCodeAt(n))<48||57<i){o=(46===i?M+t.slice(n+1):t.slice(n))+o,t=t.slice(0,n);break}}p&&!f&&(t=b(t,1/0));var s=r.length+t.length+o.length,u=s<d?new Array(d-s+1).join(l):"";switch(p&&f&&(t=b(u+t,u.length?d-o.length:1/0),u=""),h){case"<":t=r+t+o+u;break;case"=":t=r+u+t+o;break;case"^":t=u.slice(0,s=u.length>>1)+r+t+o+u.slice(s);break;default:t=u+r+t+o}return k(t)}return g=void 0===g?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),e.toString=function(){return t+""},e}return{format:a,formatPrefix:function(t,n){var e=a(((t=xe(t)).type="f",t)),t=3*Math.max(-8,Math.min(8,Math.floor(T(n)/3))),i=Math.pow(10,-t),r=Te[8+t/3];return function(t){return e(i*t)+r}}}}function Ce(t,n,e,i){r=t,o=n,e=e,e=Math.abs(o-r)/Math.max(0,e),a=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),Jn<=(e=e/a)?a*=10:te<=e?a*=5:ne<=e&&(a*=2);var r,o,a,s,u,l=o<r?-a:a;switch((i=xe(null==i?",f":i)).type){case"s":var h=Math.max(Math.abs(t),Math.abs(n));return null!=i.precision||isNaN((u=l,u=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(T(h)/3)))-T(Math.abs(u)))))||(i.precision=u),Ae(i,h);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN((h=l,s=Math.max(Math.abs(t),Math.abs(n)),h=Math.abs(h),s=Math.abs(s)-h,u=Math.max(0,T(s)-T(h))+1))||(i.precision=u-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(u=Math.max(0,-T(Math.abs(l))))||(i.precision=u-2*("%"===i.type))}return N(i)}function Ee(s){var u=s.domain;return s.ticks=function(t){var n,e,i,r,o=u(),a=o[0],o=o[o.length-1],t=null==t?10:t,s=-1;if(t=+t,(a=+a)===(o=+o)&&0<t)return[a];if((n=o<a)&&(e=a,a=o,o=e),0===(r=ee(a,o,t))||!isFinite(r))return[];if(0<r)for(a=Math.ceil(a/r),o=Math.floor(o/r),i=new Array(e=Math.ceil(o-a+1));++s<e;)i[s]=(a+s)*r;else for(a=Math.floor(a*r),o=Math.ceil(o*r),i=new Array(e=Math.ceil(a-o+1));++s<e;)i[s]=(a-s)/r;return n&&i.reverse(),i},s.tickFormat=function(t,n){var e=u();return Ce(e[0],e[e.length-1],null==t?10:t,n)},s.nice=function(t){null==t&&(t=10);var n,e=u(),i=0,r=e.length-1,o=e[i],a=e[r];return a<o&&(n=o,o=a,a=n,n=i,i=r,r=n),0<(n=ee(o,a,t))?n=ee(o=Math.floor(o/n)*n,a=Math.ceil(a/n)*n,t):n<0&&(n=ee(o=Math.ceil(o*n)/n,a=Math.floor(a*n)/n,t)),0<n?(e[i]=Math.floor(o/n)*n,e[r]=Math.ceil(a/n)*n,u(e)):n<0&&(e[i]=Math.ceil(o*n)/n,e[r]=Math.floor(a*n)/n,u(e)),s},s}function He(){var n=_e(S,S);return n.copy=function(){return t=n,He().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},re.apply(n,arguments),Ee(n)}function Le(){w.stopImmediatePropagation()}function H(){w.preventDefault(),w.stopImmediatePropagation()}function De(t){return function(){return t}}function Fe(t,n,e,i,r,o,a,s,u,l){this.target=t,this.type=n,this.subject=e,this.identifier=i,this.active=r,this.x=o,this.y=a,this.dx=s,this.dy=u,this._=l}function Pe(){return!w.ctrlKey&&!w.button}function Be(){return this.parentNode}function Oe(t){return null==t?{x:w.x,y:w.y}:t}function ze(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ie(){var i,r,o,a,s=Pe,u=Be,n=Oe,e=ze,p={},g=Tt("start","drag","end"),_=0,l=0;function m(t){t.on("mousedown.drag",h).filter(e).on("touchstart.drag",d).on("touchmove.drag",y).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(){var t,n,e;!a&&s.apply(this,arguments)&&(t=x("mouse",u.apply(this,arguments),k,this,arguments))&&(M(w.view).on("mousemove.drag",c,!0).on("mouseup.drag",f,!0),n=w.view,e=n.document.documentElement,n=M(n).on("dragstart.drag",H,!0),"onselectstart"in e?n.on("selectstart.drag",H,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none"),Le(),o=!1,i=w.clientX,r=w.clientY,t("start"))}function c(){var t,n;H(),o||(t=w.clientX-i,n=w.clientY-r,o=l<t*t+n*n),p.mouse("drag")}function f(){var t,n,e,i;M(w.view).on("mousemove.drag mouseup.drag",null),t=w.view,n=o,e=t.document.documentElement,i=M(t).on("dragstart.drag",null),n&&(i.on("click.drag",H,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in e?i.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect),H(),p.mouse("end")}function d(){if(s.apply(this,arguments))for(var t,n=w.changedTouches,e=u.apply(this,arguments),i=n.length,r=0;r<i;++r)(t=x(n[r].identifier,e,At,this,arguments))&&(Le(),t("start"))}function y(){for(var t,n=w.changedTouches,e=n.length,i=0;i<e;++i)(t=p[n[i].identifier])&&(H(),t("drag"))}function v(){var t,n,e=w.changedTouches,i=e.length;for(a&&clearTimeout(a),a=setTimeout(function(){a=null},500),t=0;t<i;++t)(n=p[e[t].identifier])&&(Le(),n("end"))}function x(r,o,a,s,u){var l,h,c,f=a(o,r),d=g.copy();if(xt(new Fe(m,"beforestart",l,r,_,f[0],f[1],0,0,d),function(){return null!=(w.subject=l=n.apply(s,u))&&(h=l.x-f[0]||0,c=l.y-f[1]||0,!0)}))return function t(n){var e,i=f;switch(n){case"start":p[r]=t,e=_++;break;case"end":delete p[r],--_;case"drag":f=a(o,r),e=_}xt(new Fe(m,n,l,r,e,f[0]+h,f[1]+c,f[0]-i[0],f[1]-i[1],d),d.apply,d,[n,s,u])}}return m.filter=function(t){return arguments.length?(s="function"==typeof t?t:De(!!t),m):s},m.container=function(t){return arguments.length?(u="function"==typeof t?t:De(t),m):u},m.subject=function(t){return arguments.length?(n="function"==typeof t?t:De(t),m):n},m.touchable=function(t){return arguments.length?(e="function"==typeof t?t:De(!!t),m):e},m.on=function(){var t=g.on.apply(g,arguments);return t===g?m:t},m.clickDistance=function(t){return arguments.length?(l=(t=+t)*t,m):Math.sqrt(l)},m}i=Ne({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),N=i.format,Ae=i.formatPrefix,Fe.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var je=Array.prototype.slice;function Re(t){return t}var qe=1,Xe=2,Ge=3,D=4,Ve=1e-6;function Ye(t){return"translate("+(t+.5)+",0)"}function $e(t){return"translate(0,"+(t+.5)+")"}function Ue(n){return function(t){return+n(t)}}function We(n){var e=Math.max(0,n.bandwidth()-1)/2;return n.round()&&(e=Math.round(e)),function(t){return+n(t)+e}}function Ze(){return!this.__axis}function Ke(d,p){var g=[],_=null,m=null,y=6,v=6,x=3,w=d===qe||d===D?-1:1,b=d===D||d===Xe?"x":"y",M=d===qe||d===Ge?Ye:$e;function n(t){var n=null==_?p.ticks?p.ticks.apply(p,g):p.domain():_,e=null==m?p.tickFormat?p.tickFormat.apply(p,g):Re:m,i=Math.max(y,0)+x,r=p.range(),o=+r[0]+.5,r=+r[r.length-1]+.5,a=(p.bandwidth?We:Ue)(p.copy()),s=t.selection?t.selection():t,u=s.selectAll(".domain").data([null]),l=(n=s.selectAll(".tick").data(n,p).order()).exit(),h=n.enter().append("g").attr("class","tick"),c=n.select("line"),f=n.select("text"),u=u.merge(u.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),n=n.merge(h),c=c.merge(h.append("line").attr("stroke","currentColor").attr(b+"2",w*y)),f=f.merge(h.append("text").attr("fill","currentColor").attr(b,w*i).attr("dy",d===qe?"0em":d===Ge?"0.71em":"0.32em"));t!==s&&(u=u.transition(t),n=n.transition(t),c=c.transition(t),f=f.transition(t),l=l.transition(t).attr("opacity",Ve).attr("transform",function(t){return isFinite(t=a(t))?M(t):this.getAttribute("transform")}),h.attr("opacity",Ve).attr("transform",function(t){var n=this.parentNode.__axis;return M(n&&isFinite(n=n(t))?n:a(t))})),l.remove(),u.attr("d",d===D||d==Xe?v?"M"+w*v+","+o+"H0.5V"+r+"H"+w*v:"M0.5,"+o+"V"+r:v?"M"+o+","+w*v+"V0.5H"+r+"V"+w*v:"M"+o+",0.5H"+r),n.attr("opacity",1).attr("transform",function(t){return M(a(t))}),c.attr(b+"2",w*y),f.attr(b,w*i).text(e),s.filter(Ze).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",d===Xe?"start":d===D?"end":"middle"),s.each(function(){this.__axis=a})}return n.scale=function(t){return arguments.length?(p=t,n):p},n.ticks=function(){return g=je.call(arguments),n},n.tickArguments=function(t){return arguments.length?(g=null==t?[]:je.call(t),n):g.slice()},n.tickValues=function(t){return arguments.length?(_=null==t?null:je.call(t),n):_&&_.slice()},n.tickFormat=function(t){return arguments.length?(m=t,n):m},n.tickSize=function(t){return arguments.length?(y=v=+t,n):y},n.tickSizeInner=function(t){return arguments.length?(y=+t,n):y},n.tickSizeOuter=function(t){return arguments.length?(v=+t,n):v},n.tickPadding=function(t){return arguments.length?(x=+t,n):x},n}function Qe(t){return Ke(Ge,t)}function Je(t){return Ke(D,t)}var ti=Math.PI,ni=2*ti,F=1e-6,ei=ni-F;function ii(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ri(){return new ii}function P(t){return function(){return t}}ii.prototype=ri.prototype={constructor:ii,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,i){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+i)},bezierCurveTo:function(t,n,e,i,r,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,n,e,i,r){var o,a,s=this._x1,u=this._y1,l=(e=+e)-(t=+t),h=(i=+i)-(n=+n),c=s-t,f=u-n,d=c*c+f*f;if((r=+r)<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+(this._x1=t)+","+(this._y1=n):F<d&&(Math.abs(f*l-h*c)>F&&r?(a=l*l+h*h,i=(e=e-s)*e+(s=i-u)*s,u=Math.sqrt(a),o=Math.sqrt(d),d=(a=r*Math.tan((ti-Math.acos((a+d-i)/(2*u*o)))/2))/o,i=a/u,Math.abs(d-1)>F&&(this._+="L"+(t+d*c)+","+(n+d*f)),this._+="A"+r+","+r+",0,0,"+ +(c*s<f*e)+","+(this._x1=t+i*l)+","+(this._y1=n+i*h)):this._+="L"+(this._x1=t)+","+(this._y1=n))},arc:function(t,n,e,i,r,o){t=+t,n=+n,o=!!o;var a=(e=+e)*Math.cos(i),s=e*Math.sin(i),u=t+a,l=n+s,h=1^o,o=o?i-r:r-i;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>F||Math.abs(this._y1-l)>F)&&(this._+="L"+u+","+l),e&&(ei<(o=o<0?o%ni+ni:o)?this._+="A"+e+","+e+",0,1,"+h+","+(t-a)+","+(n-s)+"A"+e+","+e+",0,1,"+h+","+(this._x1=u)+","+(this._y1=l):F<o&&(this._+="A"+e+","+e+",0,"+ +(ti<=o)+","+h+","+(this._x1=t+e*Math.cos(r))+","+(this._y1=n+e*Math.sin(r))))},rect:function(t,n,e,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +i+"h"+-e+"Z"},toString:function(){return this._}};var oi=Math.PI,ai=2*oi;function si(t){this._context=t}function ui(t){return new si(t)}function li(t){return t[0]}function hi(t){return t[1]}function ci(){var a=li,s=hi,u=P(!0),l=null,h=ui,c=null;function n(t){var n,e,i,r=t.length,o=!1;for(null==l&&(c=h(i=ri())),n=0;n<=r;++n)!(n<r&&u(e=t[n],n,t))===o&&((o=!o)?c.lineStart():c.lineEnd()),o&&c.point(+a(e,n,t),+s(e,n,t));if(i)return c=null,i+""||null}return n.x=function(t){return arguments.length?(a="function"==typeof t?t:P(+t),n):a},n.y=function(t){return arguments.length?(s="function"==typeof t?t:P(+t),n):s},n.defined=function(t){return arguments.length?(u="function"==typeof t?t:P(!!t),n):u},n.curve=function(t){return arguments.length?(h=t,null!=l&&(c=h(l)),n):h},n.context=function(t){return arguments.length?(null==t?l=c=null:c=h(l=t),n):l},n}si.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}};var fi={draw:function(t,n){n=Math.sqrt(n/oi);t.moveTo(n,0),t.arc(0,0,n,0,ai)}},di=Math.sqrt(3),pi={draw:function(t,n){n=-Math.sqrt(n/(3*di));t.moveTo(0,2*n),t.lineTo(-di*n,-n),t.lineTo(di*n,-n),t.closePath()}};function gi(){var n=P(fi),e=P(64),i=null;function r(){var t;if(i=i||(t=ri()),n.apply(this,arguments).draw(i,+e.apply(this,arguments)),t)return i=null,t+""||null}return r.type=function(t){return arguments.length?(n="function"==typeof t?t:P(t),r):n},r.size=function(t){return arguments.length?(e="function"==typeof t?t:P(+t),r):e},r.context=function(t){return arguments.length?(i=null==t?null:t,r):i},r}function _i(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function mi(t){this._context=t}function yi(t){return new mi(t)}function B(t){for(var n=t.length/6|0,e=new Array(n),i=0;i<n;)e[i]="#"+t.slice(6*i,6*++i);return e}mi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:_i(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_i(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};var vi=B("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),xi=B("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),wi=B("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),bi=B("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Mi=B("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),ki=B("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");e=function(x){return x.Control.Heightgraph=x.Control.extend({options:{position:"bottomright",width:800,height:280,margins:{top:10,right:30,bottom:55,left:50},mappings:void 0,expand:!0,expandControls:!0,translation:{},expandCallback:void 0,chooseSelectionCallback:void 0,selectedAttributeIdx:0,xTicks:void 0,yTicks:void 0,highlightStyle:void 0,graphStyle:void 0},_defaultTranslation:{distance:"Distance",elevation:"Elevation",segment_length:"Segment length",type:"Type",legend:"Legend"},_init_options:function(){this._margin=this.options.margins,this._width=this.options.width,this._height=this.options.height,this._mappings=this.options.mappings,this._svgWidth=this._width-this._margin.left-this._margin.right,this._svgHeight=this._height-this._margin.top-this._margin.bottom,this._highlightStyle=this.options.highlightStyle||{color:"red"},this._graphStyle=this.options.graphStyle||{},this._dragCache={}},onAdd:function(t){var n,e=this._container=x.DomUtil.create("div","heightgraph");return x.DomEvent.disableClickPropagation(e),this.options.expandControls&&(n=this._button=x.DomUtil.create("div","heightgraph-toggle",e),x.DomUtil.create("a","heightgraph-toggle-icon",n),this._closeButton=x.DomUtil.create("a","heightgraph-close-icon",e)),this._showState=!1,this._initToggle(),this._init_options(),this._svg=M(this._container).append("svg").attr("class","heightgraph-container").attr("width",this._width).attr("height",this._height).append("g").attr("transform","translate("+this._margin.left+","+this._margin.top+")"),this.options.expand&&this._expand(),e},onRemove:function(t){this._removeMarkedSegmentsOnMap(),this._container=null,this._svg=void 0},addData:function(t){this._addData(t)},_addData:function(t){void 0!==this._svg&&this._svg.selectAll("*").remove(),(!t||this.options.selectedAttributeIdx>=t.length)&&(this.options.selectedAttributeIdx=0),this._removeMarkedSegmentsOnMap(),this._resetDrag(!0),this._data=t,this._init_options(),this._prepareData(),this._calculateElevationBounds(),this._appendScales(),this._appendGrid(),0!==Object.keys(t).length&&this._createChart(this.options.selectedAttributeIdx),this._createSelectionBox()},resize:function(t){t.width&&(this.options.width=t.width),t.height&&(this.options.height=t.height),M(this._container).selectAll("svg").attr("width",this.options.width).attr("height",this.options.height),this._addData(this._data)},_initToggle:function(){x.Browser.touch?x.DomEvent.on(this._container,"click",x.DomEvent.stopPropagation):x.DomEvent.disableClickPropagation(this._container),this.options.expandControls&&(x.DomEvent.on(this._button,"click",this._expand,this),x.DomEvent.on(this._closeButton,"click",this._expand,this))},_dragHandler:function(){"undefined"!=typeof event&&(event.preventDefault(),event.stopPropagation()),this._gotDragged=!0,this._drawDragRectangle()},_drawDragRectangle:function(){var t,n,e;this._dragStartCoords&&(n=this._dragCurrentCoords=this._dragCache.end=k(this._background.node()),t=Math.min(this._dragStartCoords[0],n[0]),n=Math.max(this._dragStartCoords[0],n[0]),this._dragRectangle||this._dragRectangleG?this._dragRectangle.attr("width",n-t).attr("x",t):(e=M(this._container).select("svg").select("g"),this._dragRectangleG=e.append("g"),this._dragRectangle=this._dragRectangleG.append("rect").attr("width",n-t).attr("height",this._svgHeight).attr("x",t).attr("class","mouse-drag").style("fill","grey").style("opacity",.5).style("pointer-events","none")))},_resetDrag:function(t){this._dragRectangleG&&(this._dragRectangleG.remove(),this._dragRectangleG=null,!(this._dragRectangle=null)!==t)&&(t=this._calculateFullExtent(this._areasFlattended))&&this._map.fitBounds(t)},_dragEndHandler:function(){var t,n;this._dragStartCoords&&this._gotDragged?(t=this._findItemForX(this._dragStartCoords[0]),n=this._findItemForX(this._dragCurrentCoords[0]),this._fitSection(t,n),this._dragStartCoords=null,this._gotDragged=!1):(this._dragStartCoords=null,this._gotDragged=!1,this._resetDrag())},_dragStartHandler:function(){event.preventDefault(),event.stopPropagation(),this._gotDragged=!1,this._dragStartCoords=this._dragCache.start=k(this._background.node())},_calculateFullExtent:function(t){var n;return!t||t.length<1?null:(n=new x.latLngBounds(t[0].latlng,t[0].latlng),t.forEach(function(t){n.contains(t.latlng)||n.extend(t.latlng)}),n)},_fitSection:function(t,n){var e,i=Math.min(t,n),t=Math.max(t,n);i!==t?e=this._calculateFullExtent(this._areasFlattended.slice(i,t+1)):0<this._areasFlattended.length&&(e=[this._areasFlattended[i].latlng,this._areasFlattended[t].latlng]),e&&this._map.fitBounds(e)},_expand:function(){!0!==this.options.expandControls&&(this._showState=!1),this._showState?(M(this._button).style("display","block"),M(this._container).selectAll("svg").style("display","none"),M(this._closeButton).style("display","none")):(M(this._button).style("display","none"),M(this._container).selectAll("svg").style("display","block"),M(this._closeButton).style("display","block")),this._showState=!this._showState,"function"==typeof this.options.expandCallback&&this.options.expandCallback(this._showState)},_removeChart:function(){void 0!==this._svg&&(this._svg.selectAll("path.area").remove(),this._svg.selectAll("path.border-top").remove(),this._svg.selectAll(".legend").remove(),this._svg.selectAll(".lineSelection").remove(),this._svg.selectAll(".horizontalLine").remove(),this._svg.selectAll(".horizontalLineText").remove())},_randomNumber:function(t){return Math.round(Math.random()*+t)},_d3ColorCategorical:[xi,wi,Mi,vi,ki,bi],_prepareData:function(){this._coordinates=[],this._elevations=[],this._cumulatedDistances=[],this._cumulatedDistances.push(0),this._categories=[];var t,n,e=this._data;void 0===this._mappings&&(t=this._randomNumber(this._d3ColorCategorical.length-1),n=function t(){var o=ae(),a=[],i=[],r=le;function s(t){var n=t+"",e=o.get(n);if(!e){if(r!==le)return r;o.set(n,e=a.push(t))}return i[(e-1)%i.length]}return s.domain=function(t){if(!arguments.length)return a.slice();a=[],o=ae();for(var n,e,i=-1,r=t.length;++i<r;)o.has(e=(n=t[i])+"")||o.set(e,a.push(n));return s},s.range=function(t){return arguments.length?(i=ue.call(t),s):i.slice()},s.unknown=function(t){return arguments.length?(r=t,s):r},s.copy=function(){return t(a,i).unknown(r)},re.apply(s,arguments),s}(this._d3ColorCategorical[t]));for(var i=0;i<e.length;i++){for(var r=0,o=(this._categories[i]={info:{id:i,text:e[i].properties.label||e[i].properties.summary},distances:[],attributes:[],geometries:[],legend:{}},void 0),a=0,s={},u=void 0!==this._mappings&&"function"==typeof this._mappings[e[i].properties.summary],o=0;o<e[i].features.length;o++){var l,h=void 0,c=void 0,f=[],d=e[i].features[o].geometry.coordinates.length,p=e[i].features[o].properties.attributeType,g=void 0,_=void 0,m=(void 0===this._mappings?p in s?_=s[g=p]:(g=p,_=n(o),s[p]=_):_=(u?(g=(m=this._mappings[e[i].properties.summary](p)).text,m):(g=this._mappings[e[i].properties.summary][p].text,this._mappings[e[i].properties.summary][p])).color,{type:p,text:g,color:_});this._categories[i].attributes.push(m),p in this._categories[i].legend||(this._categories[i].legend[p]=m);for(var y=0;y<d;y++){h=new x.LatLng(e[i].features[o].geometry.coordinates[y][1],e[i].features[o].geometry.coordinates[y][0]),l=e[i].features[o].geometry.coordinates[y][2],y<d-1?(c=new x.LatLng(e[i].features[o].geometry.coordinates[y+1][1],e[i].features[o].geometry.coordinates[y+1][0]),r+=h.distanceTo(c)/1e3,0===i&&(this._elevations.push(l),this._coordinates.push(h),this._cumulatedDistances.push(r)),a+=1):y===d-1&&o===e[i].features.length-1&&(0===i&&(this._elevations.push(l),this._coordinates.push(c)),a+=1);var v=void 0,v=y===d-1&&o<e[i].features.length-1?this._cumulatedDistances[a]:this._cumulatedDistances[a-1];f.push({altitude:l,position:v,x:h.lng,y:h.lat,latlng:h,type:g,areaIdx:o})}this._categories[i].distances.push(r),this._categories[i].geometries.push(f)}i===e.length-1&&(this._totalDistance=r)}},_calculateElevationBounds:function(){var t=ie(this._elevations)||10,n=function(t,n){var e,i,r=t.length,o=-1;if(null==n){for(;++o<r;)if(null!=(e=t[o])&&e<=e)for(i=e;++o<r;)null!=(e=t[o])&&e<i&&(i=e)}else for(;++o<r;)if(null!=(e=n(t[o],o,t))&&e<=e)for(i=e;++o<r;)null!=(e=n(t[o],o,t))&&e<i&&(i=e);return i}(this._elevations)||0,e=t-n;this._elevationBounds={min:e<10?n-10:n-.1*e,max:e<10?t+10:t+.1*e}},_showMapMarker:function(t,n,e){var t=this._map.latLngToLayerPoint(t),i=t.y-75,r=(this._mouseHeightFocus||(r=M(".leaflet-overlay-pane svg").append("g"),this._mouseHeightFocus=r.append("svg:line").attr("class","height-focus line").attr("x2","0").attr("y2","0").attr("x1","0").attr("y1","0"),this._mouseHeightFocusLabel=r.append("g").attr("class","height-focus label"),this._mouseHeightFocusLabelRect=this._mouseHeightFocusLabel.append("rect").attr("class","bBox"),this._mouseHeightFocusLabelTextElev=this._mouseHeightFocusLabel.append("text").attr("class","tspan"),this._mouseHeightFocusLabelTextType=this._mouseHeightFocusLabel.append("text").attr("class","tspan"),(this._pointG=r.append("g").attr("class","height-focus circle")).append("svg:circle").attr("r",5).attr("cx",0).attr("cy",0).attr("class","height-focus circle-lower")),this._mouseHeightFocusLabel.style("display","block"),this._mouseHeightFocus.attr("x1",t.x).attr("x2",t.x).attr("y1",t.y).attr("y2",i).style("display","block"),this._pointG.attr("transform","translate("+t.x+","+t.y+")").style("display","block"),this._mouseHeightFocusLabelRect.attr("x",t.x+3).attr("y",i).attr("class","bBox"),this._mouseHeightFocusLabelTextElev.attr("x",t.x+5).attr("y",12+i).text(n+" m").attr("class","tspan mouse-height-box-text"),this._mouseHeightFocusLabelTextType.attr("x",t.x+5).attr("y",24+i).text(e).attr("class","tspan mouse-height-box-text"),this._dynamicBoxSize("text.tspan")[1]),n=""===e?18:30;l(".bBox").attr("width",r+10).attr("height",n)},_createChart:function(t){var n=0===this._categories.length?[]:this._categories[t].geometries;this._areasFlattended=[].concat.apply([],n);for(var e=0;e<n.length;e++)this._appendAreas(n[e],t,e);this._createFocus(),this._appendBackground(),this._createBorderTopLine(),this._createLegend(),this._createHorizontalLine()},_createFocus:function(){var t=this._elevationBounds.min,t=(this._focus&&(this._focus.remove(),this._focusLineGroup.remove()),this._focus=this._svg.append("g").attr("class","focusbox"),this._focusRect=this._focus.append("rect").attr("x",3).attr("y",-this._y(t)).attr("display","none"),this._focusDistance=this._focus.append("text").attr("x",7).attr("y",15-this._y(t)).attr("id","heightgraph.distance").text(this._getTranslation("distance")+":"),this._focusHeight=this._focus.append("text").attr("x",7).attr("y",30-this._y(t)).attr("id","heightgraph.height").text(this._getTranslation("elevation")+":"),this._focusBlockDistance=this._focus.append("text").attr("x",7).attr("y",45-this._y(t)).attr("id","heightgraph.blockdistance").text(this._getTranslation("segment_length")+":"),this._focusType=this._focus.append("text").attr("x",7).attr("y",60-this._y(t)).attr("id","heightgraph.type").text(this._getTranslation("type")+":"),this._areaTspan=this._focusBlockDistance.append("tspan").attr("class","tspan"),this._typeTspan=this._focusType.append("tspan").attr("class","tspan"),this._dynamicBoxSize(".focusbox text")[0]);l(".focusbox rect").attr("height",15*t+7.5).attr("display","block"),this._focusLineGroup=this._svg.append("g").attr("class","focusLine"),this._focusLine=this._focusLineGroup.append("line").attr("y1",0).attr("y2",this._y(this._elevationBounds.min)),this._distTspan=this._focusDistance.append("tspan").attr("class","tspan"),this._altTspan=this._focusHeight.append("tspan").attr("class","tspan")},_createHorizontalLine:function(){var i=this,t=(this._horizontalLine=this._svg.append("line").attr("class","horizontalLine").attr("x1",0).attr("x2",this._width-this._margin.left-this._margin.right).attr("y1",this._y(this._elevationBounds.min)).attr("y2",this._y(this._elevationBounds.min)).style("stroke","black"),this._elevationValueText=this._svg.append("text").attr("class","horizontalLineText").attr("x",this._width-this._margin.left-this._margin.right-20).attr("y",this._y(this._elevationBounds.min)-10).attr("fill","black"),[{x:this._width-this._margin.left-this._margin.right+7,y:this._y(this._elevationBounds.min),color:"black",type:pi,angle:-90,size:100}]);this._svg.selectAll(".horizontal-symbol").data(t).enter().append("path").attr("class","lineSelection").attr("d",gi().type(function(t){return t.type}).size(function(t){return t.size})).attr("transform",function(t){return"translate("+t.x+","+t.y+") rotate("+t.angle+")"}).attr("id",function(t){return t.id}).style("fill",function(t){return t.color}).call(Ie().on("start",function(t){M(this).raise().classed("active",!0),M(".horizontalLine").raise().classed("active",!0)}).on("drag",function(t){var n=i._svgHeight,e=k(i._container)[1]-10;M(this).attr("transform",function(t){return"translate("+t.x+","+(e<0?0:n<e?n:e)+") rotate("+t.angle+")"}),M(".horizontalLine").attr("y1",e<0?0:n<e?n:e).attr("y2",e<0?0:n<e?n:e),i._highlightedCoords=n<=e?[]:i._findCoordsForY(e),M(".horizontalLineText").attr("y",e<=10?0:n<e?n-10:e-10).text(N(".0f")(i._y.invert(e<0?0:n<e?n:e))+" m"),i._removeMarkedSegmentsOnMap(),i._markSegmentsOnMap(i._highlightedCoords)}).on("end",function(t){M(this).classed("active",!1),M(".horizontalLine").classed("active",!1),i._removeMarkedSegmentsOnMap(),i._markSegmentsOnMap(i._highlightedCoords)}))},_markSegmentsOnMap:function(t){if(t)if(1<t.length){this._markedSegments=x.featureGroup();var n,e=R(t);try{for(e.s();!(n=e.n()).done;){var i=n.value;x.polyline(i,I(I({},this._highlightStyle),{interactive:!1})).addTo(this._markedSegments)}}catch(t){e.e(t)}finally{e.f()}this._markedSegments.addTo(this._map).bringToFront()}else this._markedSegments=x.polyline(t,this._highlightStyle).addTo(this._map)},_removeMarkedSegmentsOnMap:function(){void 0!==this._markedSegments&&this._map.removeLayer(this._markedSegments)},_appendScales:function(){var t=Boolean(this._totalDistance<=10);this._x=He().range([0,this._svgWidth]),this._y=He().range([this._svgHeight,0]),this._x.domain([0,this._totalDistance]),this._y.domain([this._elevationBounds.min,this._elevationBounds.max]),this._xAxis=Qe().scale(this._x),!0===t?this._xAxis.tickFormat(function(t){return N(".2f")(t)+" km"}):this._xAxis.tickFormat(function(t){return N(".0f")(t)+" km"}),this._xAxis.ticks(this.options.xTicks?Math.pow(2,this.options.xTicks):Math.round(this._svgWidth/75),"s"),this._yAxis=Je().scale(this._y).tickFormat(function(t){return t+" m"}),this._yAxis.ticks(this.options.yTicks?Math.pow(2,this.options.yTicks):Math.round(this._svgHeight/30),"s")},_appendBackground:function(){var t=this._background=M(this._container).select("svg").select("g").append("rect").attr("width",this._svgWidth).attr("height",this._svgHeight).style("fill","none").style("stroke","none").style("pointer-events","all").on("mousemove.focusbox",this._mousemoveHandler.bind(this)).on("mouseout.focusbox",this._mouseoutHandler.bind(this));x.Browser.android?(t.on("touchstart.drag",this._dragHandler.bind(this)).on("touchstart.drag",this._dragStartHandler.bind(this)).on("touchstart.focusbox",this._mousemoveHandler.bind(this)),x.DomEvent.on(this._container,"touchend",this._dragEndHandler,this)):(t.on("mousemove.focusbox",this._mousemoveHandler.bind(this)).on("mouseout.focusbox",this._mouseoutHandler.bind(this)).on("mousedown.drag",this._dragStartHandler.bind(this)).on("mousemove.drag",this._dragHandler.bind(this)),x.DomEvent.on(this._container,"mouseup",this._dragEndHandler,this))},_appendGrid:function(){this._svg.append("g").attr("class","grid").attr("transform","translate(0,"+this._svgHeight+")").call(this._make_x_axis().tickSize(-this._svgHeight,0,0).ticks(Math.round(this._svgWidth/75)).tickFormat("")),this._svg.append("g").attr("class","grid").call(this._make_y_axis().tickSize(-this._svgWidth,0,0).ticks(Math.round(this._svgHeight/30)).tickFormat("")),this._svg.append("g").attr("transform","translate(0,"+this._svgHeight+")").attr("class","x axis").call(this._xAxis),this._svg.append("g").attr("transform","translate(-2,0)").attr("class","y axis").call(this._yAxis)},_defined:function(t){return t&&void 0!==t.altitude&&null!==t.altitude},_appendAreas:function(t,n,e){var h,c,f,d,p,g,_,m,n=this._categories[n].attributes[e].color,i=this;this._area=(h=li,f=P(0),d=hi,p=P(!(c=null)),_=ui,m=g=null,r.x=function(t){return arguments.length?(h="function"==typeof t?t:P(+t),c=null,r):h},r.x0=function(t){return arguments.length?(h="function"==typeof t?t:P(+t),r):h},r.x1=function(t){return arguments.length?(c=null==t?null:"function"==typeof t?t:P(+t),r):c},r.y=function(t){return arguments.length?(f="function"==typeof t?t:P(+t),d=null,r):f},r.y0=function(t){return arguments.length?(f="function"==typeof t?t:P(+t),r):f},r.y1=function(t){return arguments.length?(d=null==t?null:"function"==typeof t?t:P(+t),r):d},r.lineX0=r.lineY0=function(){return o().x(h).y(f)},r.lineY1=function(){return o().x(h).y(d)},r.lineX1=function(){return o().x(c).y(f)},r.defined=function(t){return arguments.length?(p="function"==typeof t?t:P(!!t),r):p},r.curve=function(t){return arguments.length?(_=t,null!=g&&(m=_(g)),r):_},r.context=function(t){return arguments.length?(null==t?g=m=null:m=_(g=t),r):g},r.x(function(t){var n=i._x(t.position);return t.xDiagonalCoordinate=n}).y0(this._svgHeight).y1(function(t){return i._y(t.altitude)}).curve(ui).defined(this._defined));function r(t){var n,e,i,r,o,a=t.length,s=!1,u=new Array(a),l=new Array(a);for(null==g&&(m=_(o=ri())),n=0;n<=a;++n){if(!(n<a&&p(r=t[n],n,t))===s)if(s=!s)e=n,m.areaStart(),m.lineStart();else{for(m.lineEnd(),m.lineStart(),i=n-1;e<=i;--i)m.point(u[i],l[i]);m.lineEnd(),m.areaEnd()}s&&(u[n]=+h(r,n,t),l[n]=+f(r,n,t),m.point(c?+c(r,n,t):u[n],d?+d(r,n,t):l[n]))}if(o)return m=null,o+""||null}function o(){return ci().defined(p).curve(_).context(g)}this._areapath=this._svg.append("path").attr("class","area"),this._areapath.datum(t).attr("d",this._area).attr("stroke",n).styles(this._graphStyle).style("fill",n).style("pointer-events","none")},_make_x_axis:function(){return Qe().scale(this._x)},_make_y_axis:function(){return Je().scale(this._y)},_createSelectionBox:function(){var e=this,i=M(this._container).select("svg"),r=this._width-this._margin.right,o=this._height-this._margin.bottom+this._margin.bottom/2+6,t=[{x:r-25,y:o+3,color:"#000",type:pi,id:"leftArrowSelection",angle:0},{x:r-10,y:o,color:"#000",type:pi,id:"rightArrowSelection",angle:180}],n=i.selectAll(".select-symbol").data(t),a=(n.remove(),n=i.selectAll(".select-symbol").data(t),1<e._data.length&&n.enter().append("path").merge(n).attr("class","select-symbol").attr("d",gi().type(function(t){return t.type})).attr("transform",function(t){return"translate("+t.x+","+t.y+") rotate("+t.angle+")"}).attr("id",function(t){return t.id}).style("fill",function(t){return t.color}).on("mousedown",function(t){"rightArrowSelection"===t.id&&s(),"leftArrowSelection"===t.id&&u(),e._gotDragged=!0,e._dragStartCoords=e._dragCache.start,e._dragCurrentCoords=e._dragCache.end}),function(t){var n;e._selectionText&&e._selectionText.remove(),0!==e._categories.length&&(n=e._categories[t].info,"function"==typeof e.options.chooseSelectionCallback&&e.options.chooseSelectionCallback(t,n),t=[{selection:n.text}],e._selectionText=i.selectAll("selection_text").data(t).enter().append("text").attr("x",r-35).attr("y",o+4).text(function(t){return t.selection}).attr("class","select-info").attr("id","selectionText").attr("text-anchor","end"))}),s=(a(this.options.selectedAttributeIdx),function(){var t=e.options.selectedAttributeIdx+=1;t===e._categories.length&&(e.options.selectedAttributeIdx=t=0),a(t),e._removeChart(),e._removeMarkedSegmentsOnMap(),e._createChart(t)}),u=function(){var t=--e.options.selectedAttributeIdx;-1===t&&(e.options.selectedAttributeIdx=t=e._categories.length-1),a(t),e._removeChart(),e._removeMarkedSegmentsOnMap(),e._createChart(t)}},_createLegend:function(){var t=this,e=this,n=[];if(0<this._categories.length)for(var i in this._categories[this.options.selectedAttributeIdx].legend)n.push(this._categories[this.options.selectedAttributeIdx].legend[i]);var r=this._height-this._margin.bottom,o=r+this._margin.bottom/2,a=[{text:this._getTranslation("legend")}],s=this._svg.selectAll(".hlegend-hover").data(n).enter().append("g").attr("class","legend").style("display","none").attr("transform",function(t,n){return"translate(-8,"+(14*n-28)+")"}),u=s.append("rect").attr("class","legend-rect").attr("x",15).attr("y",36).attr("width",6).attr("height",6),u=(0!==Object.keys(this._graphStyle).length?u.styles(this._graphStyle).style("stroke",function(t,n){return t.color}).style("fill",function(t,n){return t.color}):u.style("stroke","black").style("fill",function(t,n){return t.color}),s.append("text").attr("class","legend-text").attr("x",30).attr("y",42).text(function(t,n){t=t.text;return e._boxBoundY=(r-2*r/3+7)*n,t}),this._svg.selectAll(".legend-hover").data(a).enter().append("g").attr("class","legend-hover"));this._showLegend=!1,u.append("text").attr("x",15).attr("y",o).attr("text-anchor","start").text(function(t,n){return t.text}).on("mouseover",function(){l(".legend").style("display","block")}).on("mouseleave",function(){t._showLegend||l(".legend").style("display","none")}).on("click",function(){t._showLegend=!t._showLegend})},_dynamicBoxSize:function(t){for(var n=l(t).nodes().length,e=[],i=0;i<n;i++)e.push(l(t).nodes()[i].getBoundingClientRect().width);return[n,ie(e)]},_createBorderTopLine:function(){var n=this,t=this._areasFlattended,e=ci().x(function(t){return(0,n._x)(t.position)}).y(function(t){return(0,n._y)(t.altitude)}).curve(yi).defined(this._defined);this._svg.append("svg:path").attr("d",e(t)).attr("class","border-top")},_mouseoutHandler:function(){for(var t=0,n=["_focusLine","_focus","_pointG","_mouseHeightFocus","_mouseHeightFocusLabel"];t<n.length;t++){var e=n[t];this[e]&&this[e].style("display","none")}},mapMouseoutHandler:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;this.mouseoutDelay&&window.clearTimeout(this.mouseoutDelay),this.mouseoutDelay=window.setTimeout(function(){t._mouseoutHandler()},n)},mapMousemoveHandler:function(t){var n=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).showMapMarker,e=void 0===n||n;if(!1!==this._areasFlattended){var i,r=null,o=2*Math.pow(100,2),a=1.1/111111,s=R(this._areasFlattended);try{for(s.s();!(i=s.n()).done;){var u=i.value,l=t.latlng.lat-u.latlng.lat,h=t.latlng.lng-u.latlng.lng;if(Math.abs(l)<a&&Math.abs(h)<a){this._internalMousemoveHandler(u,e);break}var c=Math.pow(l,2)+Math.pow(h,2);c<o&&(r=u,o=c)}}catch(t){s.e(t)}finally{s.f()}r&&this._internalMousemoveHandler(r,e)}},_mousemoveHandler:function(t,n,e){var i=k(this._svg.node()),i=this._areasFlattended[this._findItemForX(i[0])];i&&this._internalMousemoveHandler(i)},_internalMousemoveHandler:function(t){var n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],e=this._defined(t)?t.altitude:"-",i=t.position,r=t.latlng,o=t.areaIdx,t=t.type,a=this._dynamicBoxSize(".focusbox text")[1]+10,o=0===o?this._categories[this.options.selectedAttributeIdx].distances[o]:this._categories[this.options.selectedAttributeIdx].distances[o]-this._categories[this.options.selectedAttributeIdx].distances[o-1],n=(n&&this._showMapMarker(r,e,t),this._distTspan.text(" "+i.toFixed(1)+" km"),this._altTspan.text(" "+e+" m"),this._areaTspan.text(" "+o.toFixed(1)+" km"),this._typeTspan.text(" "+t),this._focusRect.attr("width",a),this._focusLine.style("display","block").attr("x1",this._x(i)).attr("x2",this._x(i)),this._x(i)-(a+5)),r=this._width-this._margin.left-this._margin.right;this._x(i)+a<r&&this._focus.style("display","initial").attr("transform","translate("+this._x(i)+","+this._y(this._elevationBounds.min)+")"),this._x(i)+a>r&&this._focus.style("display","initial").attr("transform","translate("+n+","+this._y(this._elevationBounds.min)+")")},_findItemForX:function(t){var n=Kn(function(t){return t.position}).left,t=this._x.invert(t);return n(this._areasFlattended,t)},_findCoordsForY:function(t){for(var t=this._y.invert(t),n=this._areasFlattended,e=t,i=[],r=0;r<n.length;r++)n[r].altitude>=e&&i.push(r);for(var o=[],a=0,s=0;s<i.length-1;s++)i[s+1]!==i[s]+1&&(o.push(i.slice(a,s+1)),a=s+1);o.push(i.slice(a,i.length));for(var u=0;u<o.length;u++)for(var l=0;l<o[u].length;l++)o[u][l]=n[o[u][l]].latlng;return o},_getTranslation:function(t){return this.options.translation[t]||this._defaultTranslation[t]||(console.error("Unexpected error when looking up the translation for "+t),"No translation found")}}),x.control.heightgraph=function(t){return new x.Control.Heightgraph(t)},x.Control.Heightgraph},o=window,"function"==typeof define&&define.amd?define(["leaflet"],e):"object"===("undefined"==typeof exports?"undefined":O(exports))&&(void 0!==o&&o.L?module.exports=e(L):module.exports=e(require("leaflet"))),void 0!==o&&o.L&&(o.L.Control.Heightgraph=e(L))}();
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,i){"function"==typeof define&&define.amd?define(["leaflet"],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(void 0!==i&&i.L?module.exports=t(L):module.exports=t(require("leaflet"))),void 0!==i&&i.L&&(i.L.Control.Locate=t(L))}(function(l){function o(i,o,t){(t=t.split(" ")).forEach(function(t){l.DomUtil[i].call(this,o,t)})}function i(t,i){o("addClass",t,i)}function s(t,i){o("removeClass",t,i)}var t=l.Marker.extend({initialize:function(t,i){l.Util.setOptions(this,i),this._latlng=t,this.createIcon()},createIcon:function(){var t=this.options,i="",t=(void 0!==t.color&&(i+="stroke:".concat(t.color,";")),void 0!==t.weight&&(i+="stroke-width:".concat(t.weight,";")),void 0!==t.fillColor&&(i+="fill:".concat(t.fillColor,";")),void 0!==t.fillOpacity&&(i+="fill-opacity:".concat(t.fillOpacity,";")),void 0!==t.opacity&&(i+="opacity:".concat(t.opacity,";")),this._getIconSVG(t,i));this._locationIcon=l.divIcon({className:t.className,html:t.svg,iconSize:[t.w,t.h]}),this.setIcon(this._locationIcon)},_getIconSVG:function(t,i){var o=t.radius,t=o+t.weight,s=2*t;return{className:"leaflet-control-locate-location",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(s,'" height="').concat(s,'" version="1.1" viewBox="-').concat(t," -").concat(t," ").concat(s," ").concat(s,'">')+'<circle r="'+o+'" style="'+i+'" /></svg>',w:s,h:s}},setStyle:function(t){l.Util.setOptions(this,t),this.createIcon()}}),e=t.extend({initialize:function(t,i,o){l.Util.setOptions(this,o),this._latlng=t,this._heading=i,this.createIcon()},setHeading:function(t){this._heading=t},_getIconSVG:function(t,i){var o=t.radius,s=t.width+t.weight,o=2*(o+t.depth+t.weight),t="M0,0 l".concat(t.width/2,",").concat(t.depth," l-").concat(s,",0 z"),e="transform: rotate(".concat(this._heading,"deg)");return{className:"leaflet-control-locate-heading",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(s,'" height="').concat(o,'" version="1.1" viewBox="-').concat(s/2," 0 ").concat(s," ").concat(o,'" style="').concat(e,'">')+'<path d="'+t+'" style="'+i+'" /></svg>',w:s,h:o}}}),t=l.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPanOrZoom",keepCurrentZoomLevel:!1,initialZoomLevel:!1,getLocationBounds:function(t){return t.bounds},flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,showCompass:!0,markerClass:t,compassClass:e,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"leaflet-control-locate-location-arrow",iconLoading:"leaflet-control-locate-spinner",iconElementTag:"span",textElementTag:"small",circlePadding:[0,0],metric:!0,createButtonCallback:function(t,i){var t=l.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",t),o=(t.title=i.strings.title,t.href="#",t.setAttribute("role","button"),l.DomUtil.create(i.iconElementTag,i.icon,t));return void 0!==i.strings.text&&(l.DomUtil.create(i.textElementTag,"leaflet-locate-text",t).textContent=i.strings.text,t.classList.add("leaflet-locate-text-active"),t.parentNode.style.display="flex",0<i.icon.length)&&o.classList.add("leaflet-locate-icon"),{link:t,icon:o}},onLocationError:function(t,i){alert(t.message)},onLocationOutsideMapBounds:function(t){t.stop(),alert(t.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize:function(t){for(var i in t)"object"===_typeof(this.options[i])?l.extend(this.options[i],t[i]):this.options[i]=t[i];this.options.followMarkerStyle=l.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=l.extend({},this.options.circleStyle,this.options.followCircleStyle),this.options.followCompassStyle=l.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd:function(t){var i=l.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control"),t=(this._container=i,this._map=t,this._layer=this.options.layer||new l.LayerGroup,this._layer.addTo(t),this._event=void 0,this._compassHeading=null,this._prevBounds=null,this.options.createButtonCallback(i,this.options));return this._link=t.link,this._icon=t.icon,l.DomEvent.on(this._link,"click",function(t){l.DomEvent.stopPropagation(t),l.DomEvent.preventDefault(t),this._onClick()},this).on(this._link,"dblclick",l.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),i},_onClick:function(){this._justClicked=!0;var t=this._isFollowing();if(this._userPanned=!1,this._userZoomed=!1,this._active&&!this._event)this.stop();else if(this._active){var i=this.options.clickBehavior,o=i.outOfView;switch(o=i[o=this._map.getBounds().contains(this._event.latlng)?t?i.inView:i.inViewNotFollowing:o]?i[o]:o){case"setView":this.setView();break;case"stop":this.stop(),this.options.returnToPrevBounds&&(this.options.flyTo?this._map.flyToBounds:this._map.fitBounds).bind(this._map)(this._prevBounds)}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start:function(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView)&&this.setView(),this._updateContainerStyle()},stop:function(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},stopFollowing:function(){this._userPanned=!0,this._updateContainerStyle(),this._drawMarker()},_activate:function(){var t,i,o;!this._active&&this._map&&(this._map.locate(this.options.locateOptions),this._map.fire("locateactivate",this),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this),this._map.on("zoomstart",this._onZoom,this),this._map.on("zoomend",this._onZoomEnd,this),this.options.showCompass)&&((t="ondeviceorientationabsolute"in window)||"ondeviceorientation"in window)&&(i=this,o=function(){l.DomEvent.on(window,t?"deviceorientationabsolute":"deviceorientation",i._onDeviceOrientation,i)},DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(t){"granted"===t&&o()}):o())},_deactivate:function(){this._active&&this._map&&(this._map.stopLocate(),this._map.fire("locatedeactivate",this),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this),this._map.off("zoomstart",this._onZoom,this),this._map.off("zoomend",this._onZoomEnd,this),this.options.showCompass)&&(this._compassHeading=null,"ondeviceorientationabsolute"in window?l.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this):"ondeviceorientation"in window&&l.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this))},setView:function(){var t;this._drawMarker(),this._isOutsideMapBounds()?(this._event=void 0,this.options.onLocationOutsideMapBounds(this)):this._justClicked&&!1!==this.options.initialZoomLevel?(t=this.options.flyTo?this._map.flyTo:this._map.setView).bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel):this.options.keepCurrentZoomLevel?(t=this.options.flyTo?this._map.flyTo:this._map.panTo).bind(this._map)([this._event.latitude,this._event.longitude]):(t=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds,this._ignoreEvent=!0,t.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.initialZoomLevel||this.options.locateOptions.maxZoom}),l.Util.requestAnimFrame(function(){this._ignoreEvent=!1},this))},_drawCompass:function(){var t,i;this._event&&(t=this._event.latlng,this.options.showCompass&&t&&null!==this._compassHeading&&(i=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle,this._compass?(this._compass.setLatLng(t),this._compass.setHeading(this._compassHeading),this._compass.setStyle&&this._compass.setStyle(i)):this._compass=new this.options.compassClass(t,this._compassHeading,i).addTo(this._layer)),!this._compass||this.options.showCompass&&null!==this._compassHeading||(this._compass.removeFrom(this._layer),this._compass=null))},_drawMarker:function(){void 0===this._event.accuracy&&(this._event.accuracy=0);var t,i,o,s=this._event.accuracy,e=this._event.latlng,n=(this.options.drawCircle&&(o=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle,this._circle?this._circle.setLatLng(e).setRadius(s).setStyle(o):this._circle=l.circle(e,s,o).addTo(this._layer)),i=this.options.metric?(t=s.toFixed(0),this.options.strings.metersUnit):(t=(3.2808399*s).toFixed(0),this.options.strings.feetUnit),this.options.drawMarker&&(o=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle,this._marker?(this._marker.setLatLng(e),this._marker.setStyle&&this._marker.setStyle(o)):this._marker=new this.options.markerClass(e,o).addTo(this._layer)),this._drawCompass(),this.options.strings.popup);function a(){return"string"==typeof n?l.Util.template(n,{distance:t,unit:i}):"function"==typeof n?n({distance:t,unit:i}):n}this.options.showPopup&&n&&this._marker&&this._marker.bindPopup(a())._popup.setLatLng(e),this.options.showPopup&&n&&this._compass&&this._compass.bindPopup(a())._popup.setLatLng(e)},_removeMarker:function(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload:function(){this.stop(),this._map.off("unload",this._unload,this)},_setCompassHeading:function(t){!isNaN(parseFloat(t))&&isFinite(t)?(t=Math.round(t),this._compassHeading=t,l.Util.requestAnimFrame(this._drawCompass,this)):this._compassHeading=null},_onCompassNeedsCalibration:function(){this._setCompassHeading()},_onDeviceOrientation:function(t){this._active&&(t.webkitCompassHeading?this._setCompassHeading(t.webkitCompassHeading):t.absolute&&t.alpha&&this._setCompassHeading(360-t.alpha))},_onLocationError:function(t){3==t.code&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(t,this))},_onLocationFound:function(t){if((!this._event||this._event.latlng.lat!==t.latlng.lat||this._event.latlng.lng!==t.latlng.lng||this._event.accuracy!==t.accuracy)&&this._active){switch(this._event=t,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"untilPanOrZoom":this._userPanned||this._userZoomed||this.setView();break;case"always":this.setView()}this._justClicked=!1}},_onDrag:function(){this._event&&!this._ignoreEvent&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_onZoom:function(){this._event&&!this._ignoreEvent&&(this._userZoomed=!0,this._updateContainerStyle(),this._drawMarker())},_onZoomEnd:function(){this._event&&this._drawCompass(),this._event&&!this._ignoreEvent&&this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing:function(){return!!this._active&&("always"===this.options.setView||("untilPan"===this.options.setView?!this._userPanned:"untilPanOrZoom"===this.options.setView?!this._userPanned&&!this._userZoomed:void 0))},_isOutsideMapBounds:function(){return void 0!==this._event&&this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle:function(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses:function(t){"requesting"==t?(s(this._container,"active following"),i(this._container,"requesting"),s(this._icon,this.options.icon),i(this._icon,this.options.iconLoading)):"active"==t?(s(this._container,"requesting following"),i(this._container,"active"),s(this._icon,this.options.iconLoading),i(this._icon,this.options.icon)):"following"==t&&(s(this._container,"requesting"),i(this._container,"active following"),s(this._icon,this.options.iconLoading),i(this._icon,this.options.icon))},_cleanClasses:function(){l.DomUtil.removeClass(this._container,"requesting"),l.DomUtil.removeClass(this._container,"active"),l.DomUtil.removeClass(this._container,"following"),s(this._icon,this.options.iconLoading),i(this._icon,this.options.icon)},_resetVariables:function(){this._active=!1,this._justClicked=!1,this._userPanned=!1,this._userZoomed=!1}});return l.control.locate=function(t){return new l.Control.Locate(t)},t},window);
!function(){var g=L.LineUtil.isFlat||L.LineUtil._flat;function n(s){var e,a=[s.latLng([90,180]),s.latLng([90,-180]),s.latLng([-90,-180]),s.latLng([-90,180])];s.version<"1.0.0"?(s.extend(s.Polygon.prototype,{initialize:function(t,n){var i;a=n.worldLatLngs||a,n&&n.invert&&!n.invertMultiPolygon&&((i=[]).push(a),i.push(t[0]),t=i),s.Polyline.prototype.initialize.call(this,t,n),this._initWithHoles(t)},getBounds:function(){return this.options.invert?new s.LatLngBounds(this._holes):new s.LatLngBounds(this.getLatLngs())}}),s.extend(s.MultiPolygon.prototype,{initialize:function(t,n){if(a=n.worldLatLngs||a,this._layers={},(this._options=n).invert){n.invertMultiPolygon=!0;var i,o=[];for(i in o.push(a),t)o.push(t[i][0]);t=[o]}this.setLatLngs(t)}})):(e={toGeoJSON:s.Polygon.prototype.toGeoJSON},s.extend(s.Polygon.prototype,{_setLatLngs:function(t){if(this._originalLatLngs=t,g(this._originalLatLngs)&&(this._originalLatLngs=[this._originalLatLngs]),this.options.invert){a=this.options.worldLatLngs||a;var n,i=[];for(n in i.push(a),t)i.push(t[n]);t=[i]}s.Polyline.prototype._setLatLngs.call(this,t)},getBounds:function(){return this._originalLatLngs?new s.LatLngBounds(this._originalLatLngs):new s.LatLngBounds(this.getLatLngs())},getLatLngs:function(){return this._originalLatLngs},toGeoJSON:function(t){var n,i,o;return this.options.invert?(i=(n=!g(this._originalLatLngs))&&!g(this._originalLatLngs[0]),o=s.GeoJSON.latLngsToCoords(this._originalLatLngs,i?2:n?1:0,!0,t),s.GeoJSON.getFeature(this,{type:(i?"Multi":"")+"Polygon",coordinates:o=n?o:[o]})):e.toGeoJSON.call(this,t)}}))}"function"==typeof define&&define.amd?define(["leaflet"],function(t){n(t)}):n(L)}();
"use strict";L.Control.StravaSegments=L.Control.extend({options:{runningIcon:"fa-trophy",runningTitle:"Show Strava running segments",bikingIcon:"fa-bicycle",bikingTitle:"Show Strava biking segments",loadingIcon:"fa-spinner fa-pulse",loadingTitle:"Loadingâ¦",stravaToken:null},onError:function(t){console.warn("Error getting Strava segments:",t)},onAdd:function(t){var e=this;return this.stravaLayer=new L.LayerGroup([],{attribution:'<a href="https://strava.com">Strava</a>'}),this.runningButton=new L.easyButton({states:[{stateName:"default",icon:e.options.runningIcon,onClick:function(){e.showSegments(t,this,"running")},title:e.options.runningTitle},{stateName:"loading",icon:e.options.loadingIcon,title:e.options.loadingTitle}]}),this.bikingButton=new L.easyButton({states:[{stateName:"default",icon:e.options.bikingIcon,onClick:function(){e.showSegments(t,this,"biking")},title:e.options.bikingTitle},{stateName:"loading",icon:e.options.loadingIcon,title:e.options.loadingTitle}]}),new L.easyBar([this.bikingButton,this.runningButton]).addTo(t),t.on("zoom",function(t){t=t.target;e.toggleButtonsState(t)}),this.toggleButtonsState(t),new L.DomUtil.create("div")},toggleButtonsState:function(t){t.getZoom()<13?(this.bikingButton.disable(),this.runningButton.disable()):(this.bikingButton.enable(),this.runningButton.enable())},computeAngle:function(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI},showSegments:function(t,e,n){e.state("loading"),this.fetchSegments(t,e,n,t.getBounds())},fetchSegments:function(h,f,m,p){var v=this,t="https://www.strava.com/api/v3/segments/explore?bounds="+p.getSouth()+","+p.getWest()+","+p.getNorth()+","+p.getEast()+"&activity_type="+m;this.stravaLayer.addTo(h),this.get(t,L.bind(function(t,e){if(t)f.state("default"),v.onError(t);else{var t=JSON.parse(e).segments,n=(10===t.length?(v.fetchSegments(h,f,m,L.latLngBounds(p.getSouthWest(),p.getCenter())),v.fetchSegments(h,f,m,L.latLngBounds(p.getSouthEast(),p.getCenter())),v.fetchSegments(h,f,m,L.latLngBounds(p.getNorthEast(),p.getCenter())),v.fetchSegments(h,f,m,L.latLngBounds(p.getNorthWest(),p.getCenter()))):f.state("default"),!0),e=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s,r,g,u,l,c,d=i.value;-1===v.stravaLayer.getLayers().map(function(t){return t.options.id}).indexOf(d.id)&&(s=polyline.decode(d.points),r="running"===m?"red":"blue",g=new L.TriangleMarker(s[0],{width:12,height:10,rotation:v.computeAngle(L.point(s[0]),L.point(s[1])),color:r}),u=new L.Circle(s[s.length-1],{radius:30,color:r}),(l=new L.Polyline(s,{id:d.id,weight:3,color:r})).on("mouseover",function(t){t.target.setStyle({weight:5})}),l.on("mouseout",function(t){t.target.setStyle({weight:3})}),c="<h4>"+d.name+"</h4>",c+="Distance: "+d.distance+"m, hill","NC"!=d.climb_category_desc&&(c+=" (cat. "+d.climb_category_desc+")"),c+=": "+d.elev_difference+"m (avg "+d.avg_grade+"%)",v.stravaLayer.addLayer(g),v.stravaLayer.addLayer(u),v.stravaLayer.addLayer(l.bindTooltip(c)))}}catch(t){e=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(e)throw o}}}}))},get:function(t,e){var n=this;if(this.options.stravaToken){var o=new XMLHttpRequest;o.open("GET",t,!0),o.setRequestHeader("Authorization","Bearer "+this.options.stravaToken),o.onload=function(){200!==o.status&&0!==o.status||!o.responseText?e(n.getError(o)):e(null,o.responseText)},o.onerror=function(){e(n.getError(o))};try{o.send()}catch(t){e(t)}}else e("Strava API token no set.")},getError:function(t){var e="no response from server";return t.responseText?e=t.responseText:(t.status||t.statusText)&&(e=t.status+": "+t.statusText),e}}),L.control.stravaSegments=function(t){return new L.Control.StravaSegments(t)};
L.Control.StandardAttribution=L.Control.Attribution,L.Control.PermalinkAttribution=L.Control.Attribution.extend({onAdd:function(t){var o=L.Control.StandardAttribution.prototype.onAdd.call(this,t);return t.on("moveend",this._update,this),o},onRemove:function(t){t.off("moveend",this._update),L.Control.StandardAttribution.prototype.onRemove.call(this,t)},_update:function(){if(this._map){var t,o,n=[];for(t in this._attributions)this._attributions[t]&&((0<t.indexOf("/openstreetmap.org")||0<t.indexOf("/www.openstreetmap.org"))&&(t=t.replace(/(['"])http[^'"]+openstreetmap.org[^'"]*(['"])/,"$1"+(o="http://www.openstreetmap.org/#map={zoom}/{lat}/{lon}")+"$2"),this._map.options.attributionEditLink)&&(o=o.replace("#","edit#"),t=t.replace(/(openstreetmap.org[^'"]*(['"])[^>]*>[^<]+<\/a>)/,"$1 (<a href=$2"+o+"$2 target=$2osmedit$2>Edit</a>)")),o=this._map.getCenter(),t=t.replace(/\{zoom\}/g,this._map.getZoom()).replace(/\{lat\}/g,L.Util.formatNum(o.lat,4)).replace(/\{lon\}/g,L.Util.formatNum(o.lng,4)),n.push(t));var i=[];this.options.prefix&&i.push(this.options.prefix),n.length&&i.push(n.join(", ")),this._container.innerHTML=i.join(" | ")}}}),L.control.permalinkAttribution=function(t){return new L.Control.PermalinkAttribution(t)},L.Map.mergeOptions({attributionEditLink:!1}),L.Control.Attribution=L.Control.PermalinkAttribution,L.control.standardAttribution=L.control.attribution,L.control.attribution=L.control.permalinkAttribution;
function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=_superPropBase(t,e);if(r)return(r=Object.getOwnPropertyDescriptor(r,e)).get?r.get.call(arguments.length<3?t:n):r.value}).apply(this,arguments)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){var r=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(n);return _possibleConstructorReturn(this,r?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof3(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _defineProperty3(t,e,n){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return s};var s={},t=Object.prototype,u=t.hasOwnProperty,l=Object.defineProperty||function(t,e,n){t[e]=n.value},e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",i=e.toStringTag||"@@toStringTag";function o(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,n){return t[e]=n}}function a(t,e,n,r){var i,o,s,a,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),r=new x(r||[]);return l(e,"_invoke",{value:(i=t,o=n,s=r,a="suspendedStart",function(t,e){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===t)throw e;return E()}for(s.method=t,s.arg=e;;){var n=s.delegate;if(n){n=function t(e,n){var r=n.method,i=e.iterator[r];if(void 0===i)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=void 0,t(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;r=c(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,p;i=r.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,p):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}(n,s);if(n){if(n===p)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";n=c(i,o,s);if("normal"===n.type){if(a=s.done?"completed":"suspendedYield",n.arg===p)continue;return{value:n.arg,done:s.done}}"throw"===n.type&&(a="completed",s.method="throw",s.arg=n.arg)}})}),e}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}s.wrap=a;var p={};function h(){}function f(){}function d(){}var e={},y=(o(e,r,function(){return this}),Object.getPrototypeOf),y=y&&y(y(w([]))),g=(y&&y!==t&&u.call(y,r)&&(e=y),d.prototype=h.prototype=Object.create(e));function m(t){["next","throw","return"].forEach(function(e){o(t,e,function(t){return this._invoke(e,t)})})}function v(s,a){var e;l(this,"_invoke",{value:function(n,r){function t(){return new a(function(t,e){!function e(t,n,r,i){var o,t=c(s[t],s,n);if("throw"!==t.type)return(n=(o=t.arg).value)&&"object"==_typeof3(n)&&u.call(n,"__await")?a.resolve(n.__await).then(function(t){e("next",t,r,i)},function(t){e("throw",t,r,i)}):a.resolve(n).then(function(t){o.value=t,r(o)},function(t){return e("throw",t,r,i)});i(t.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}})}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function w(e){if(e){var n,t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:E}}function E(){return{value:void 0,done:!0}}return l(g,"constructor",{value:f.prototype=d,configurable:!0}),l(d,"constructor",{value:f,configurable:!0}),f.displayName=o(d,i,"GeneratorFunction"),s.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,o(t,i,"GeneratorFunction")),t.prototype=Object.create(g),t},s.awrap=function(t){return{__await:t}},m(v.prototype),o(v.prototype,n,function(){return this}),s.AsyncIterator=v,s.async=function(t,e,n,r,i){void 0===i&&(i=Promise);var o=new v(a(t,e,n,r),i);return s.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},m(g),o(g,i,"Generator"),o(g,r,function(){return this}),o(g,"toString",function(){return"[object Generator]"}),s.keys=function(t){var e,n=Object(t),r=[];for(e in n)r.push(e);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},s.values=w,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return o.type="throw",o.arg=n,r.next=t,e&&(r.method="next",r.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=u.call(i,"catchLoc"),a=u.call(i,"finallyLoc");if(s&&a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}var o=(i=i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc?null:i)?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,r,i=this.tryEntries[e];if(i.tryLoc===t)return"throw"===(n=i.completion).type&&(r=n.arg,b(i)),r}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:w(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},s}function _classCallCheck2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass2(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof3(t)?t:String(t)}function _toPrimitive(t,e){if("object"!==_typeof3(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==_typeof3(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray3(t){return _arrayWithoutHoles2(t)||_iterableToArray2(t)||_unsupportedIterableToArray2(t)||_nonIterableSpread2()}function _nonIterableSpread2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray2(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles2(t){if(Array.isArray(t))return _arrayLikeToArray2(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray2(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray2(t,e){var n;if(t)return"string"==typeof t?_arrayLikeToArray2(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray2(t,e):void 0}function _arrayLikeToArray2(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _typeof3(t){return(_typeof3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function r(i,o,s){function a(e,t){if(!o[e]){if(!i[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(u)return u(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}n=o[e]={exports:{}},i[e][0].call(n.exports,function(t){return a(i[e][1][t]||t)},n,n.exports,r,i,o,s)}return o[e].exports}for(var u="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,e,n){var r=t("overpass-frontend"),i=t("./src/OverpassLayer"),t=t("./src/OverpassLayerList");"undefined"!=typeof window&&(window.OverpassLayer=i,window.OverpassLayerList=t,window.OverpassFrontend=r),i.List=t,e.exports=i},{"./src/OverpassLayer":299,"./src/OverpassLayerList":301,"overpass-frontend":220}],2:[function(t,e,n){function o(t,e){if(0!==t.length){r(t[0],e);for(var n=1;n<t.length;n++)r(t[n],!e)}}function r(t,e){for(var n=0,r=0,i=0,o=t.length,s=o-1;i<o;s=i++){var a=(t[i][0]-t[s][0])*(t[s][1]+t[i][1]),u=n+a;r+=Math.abs(n)>=Math.abs(a)?n-u+a:a-u+n,n=u}0<=n+r!=!!e&&t.reverse()}e.exports=function t(e,n){var r,i=e&&e.type;if("FeatureCollection"===i)for(r=0;r<e.features.length;r++)t(e.features[r],n);else if("GeometryCollection"===i)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],n);else if("Feature"===i)t(e.geometry,n);else if("Polygon"===i)o(e.coordinates,n);else if("MultiPolygon"===i)for(r=0;r<e.coordinates.length;r++)o(e.coordinates[r],n);return e}},{}],3:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},u=(Object.defineProperty(n,"__esModule",{value:!0}),r(t("@turf/bearing"))),l=r(t("@turf/destination")),c=r(t("@turf/distance")),p=t("@turf/helpers"),h=t("@turf/invariant");n.default=function(t,e,n){void 0===n&&(n={});for(var r,i,o=h.getGeom(t).coordinates,s=0,a=0;a<o.length&&!(s<=e&&a===o.length-1);a++){if(e<=s)return(r=e-s)?(i=u.default(o[a],o[a-1])-180,l.default(o[a],r,i,n)):p.point(o[a]);s+=c.default(o[a],o[a+1],n)}return p.point(o[o.length-1])}},{"@turf/bearing":7,"@turf/destination":24,"@turf/distance":26,"@turf/helpers":30,"@turf/invariant":32}],4:[function(t,e,n){"use strict";var r=t("@turf/meta");function i(t){var e=[1/0,1/0,-1/0,-1/0];return r.coordEach(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}e.exports=i,e.exports.default=i},{"@turf/meta":6}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=6371008.8,i={meters:r,metres:r,millimeters:1e3*r,millimetres:1e3*r,centimeters:100*r,centimetres:100*r,kilometers:r/1e3,kilometres:r/1e3,miles:r/1609.344,nauticalmiles:r/1852,inches:39.37*r,yards:r/1.0936,feet:3.28084*r,radians:1,degrees:r/111325},o={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/r,degrees:1/111325},s={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function a(t,e,n){if(!_(n=n||{}))throw new Error("options is invalid");var r=n.bbox,n=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");r&&b(r),n&&x(n);var i={type:"Feature"};return n&&(i.id=n),r&&(i.bbox=r),i.properties=e||{},i.geometry=t,i}function u(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(v(t[0])&&v(t[1]))return a({type:"Point",coordinates:t},e,n);throw new Error("coordinates must contain numbers")}function l(t,e,n){if(!t)throw new Error("coordinates is required");for(var r=0;r<t.length;r++){var i=t[r];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++){if(0===r&&0===o&&!v(i[0][0])||!v(i[0][1]))throw new Error("coordinates must contain numbers");if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}}return a({type:"Polygon",coordinates:t},e,n)}function c(t,e,n){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(v(t[0][1])&&v(t[0][1]))return a({type:"LineString",coordinates:t},e,n);throw new Error("coordinates must contain numbers")}function p(t,e){if(!_(e=e||{}))throw new Error("options is invalid");var n=e.bbox,e=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&b(n),e&&x(e);var r={type:"FeatureCollection"};return e&&(r.id=e),n&&(r.bbox=n),r.features=t,r}function h(t,e,n){if(t)return a({type:"MultiLineString",coordinates:t},e,n);throw new Error("coordinates is required")}function f(t,e,n){if(t)return a({type:"MultiPoint",coordinates:t},e,n);throw new Error("coordinates is required")}function d(t,e,n){if(t)return a({type:"MultiPolygon",coordinates:t},e,n);throw new Error("coordinates is required")}function y(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=i[e||"kilometers"];if(n)return t*n;throw new Error(e+" units is invalid")}function g(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=i[e||"kilometers"];if(n)return t/n;throw new Error(e+" units is invalid")}function m(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function v(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function _(t){return!!t&&t.constructor===Object}function b(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!v(t))throw new Error("bbox must only contain numbers")})}function x(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(_typeof3(t)))throw new Error("id must be a number or a string")}n.earthRadius=r,n.factors=i,n.unitsFactors=o,n.areaFactors=s,n.feature=a,n.geometry=function(t,e,n){if(!_(n=n||{}))throw new Error("options is invalid");var r,n=n.bbox;if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");switch(n&&b(n),t){case"Point":r=u(e).geometry;break;case"LineString":r=c(e).geometry;break;case"Polygon":r=l(e).geometry;break;case"MultiPoint":r=f(e).geometry;break;case"MultiLineString":r=h(e).geometry;break;case"MultiPolygon":r=d(e).geometry;break;default:throw new Error(t+" is invalid")}return n&&(r.bbox=n),r},n.point=u,n.points=function(t,e,n){if(!t)throw new Error("coordinates is required");if(Array.isArray(t))return p(t.map(function(t){return u(t,e)}),n);throw new Error("coordinates must be an Array")},n.polygon=l,n.polygons=function(t,e,n){if(!t)throw new Error("coordinates is required");if(Array.isArray(t))return p(t.map(function(t){return l(t,e)}),n);throw new Error("coordinates must be an Array")},n.lineString=c,n.lineStrings=function(t,e,n){if(!t)throw new Error("coordinates is required");if(Array.isArray(t))return p(t.map(function(t){return c(t,e)}),n);throw new Error("coordinates must be an Array")},n.featureCollection=p,n.multiLineString=h,n.multiPoint=f,n.multiPolygon=d,n.geometryCollection=function(t,e,n){if(!t)throw new Error("geometries is required");if(Array.isArray(t))return a({type:"GeometryCollection",geometries:t},e,n);throw new Error("geometries must be an Array")},n.round=function(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(!e||0<=e)return e=Math.pow(10,e||0),Math.round(t*e)/e;throw new Error("precision must be a positive number")},n.radiansToLength=y,n.lengthToRadians=g,n.lengthToDegrees=function(t,e){return m(g(t,e))},n.bearingToAzimuth=function(t){if(null==t)throw new Error("bearing is required");return(t%=360)<0&&(t+=360),t},n.radiansToDegrees=m,n.degreesToRadians=function(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180},n.convertLength=function(t,e,n){if(null==t)throw new Error("length is required");if(0<=t)return y(g(t,e),n||"kilometers");throw new Error("length must be a positive number")},n.convertArea=function(t,e,n){if(null==t)throw new Error("area is required");if(!(0<=t))throw new Error("area must be a positive number");if(!(e=s[e||"meters"]))throw new Error("invalid original units");if(n=s[n||"kilometers"])return t/e*n;throw new Error("invalid final units")},n.isNumber=v,n.isObject=_,n.validateBBox=b,n.validateId=x,n.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},n.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},n.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},n.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},n.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},n.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},n.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var h=t("@turf/helpers");function w(t,e,n){if(null!==t)for(var r,i,o,s=0,a=t.type,u="FeatureCollection"===a,l="Feature"===a,c=u?t.features.length:1,p=0;p<c;p++)for(var h,f,d=(f=!!(h=u?t.features[p].geometry:l?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1,y=0;y<d;y++){var g=0,m=0,v=f?h.geometries[y]:h;if(null!==v){var _=v.coordinates,b=v.type,x=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1;switch(b){case null:break;case"Point":if(!1===e(_,s,p,g,m))return!1;s++,g++;break;case"LineString":case"MultiPoint":for(r=0;r<_.length;r++){if(!1===e(_[r],s,p,g,m))return!1;s++,"MultiPoint"===b&&g++}"LineString"===b&&g++;break;case"Polygon":case"MultiLineString":for(r=0;r<_.length;r++){for(i=0;i<_[r].length-x;i++){if(!1===e(_[r][i],s,p,g,m))return!1;s++}"MultiLineString"===b&&g++,"Polygon"===b&&m++}"Polygon"===b&&g++;break;case"MultiPolygon":for(r=0;r<_.length;r++){for("MultiPolygon"===b&&(m=0),i=0;i<_[r].length;i++){for(o=0;o<_[r][i].length-x;o++){if(!1===e(_[r][i][o],s,p,g,m))return!1;s++}m++}g++}break;case"GeometryCollection":for(r=0;r<v.geometries.length;r++)if(!1===w(v.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function r(t,e){for(var n,r,i,o,s,a,u,l,c,p=0,h="FeatureCollection"===t.type,f="Feature"===t.type,d=h?t.features.length:1,y=0;y<d;y++){for(s=h?t.features[y].geometry:f?t.geometry:t,u=h?t.features[y].properties:f?t.properties:{},l=h?t.features[y].bbox:f?t.bbox:void 0,c=h?t.features[y].id:f?t.id:void 0,o=(a=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,r=0;r<o;r++)if(null===(i=a?s.geometries[r]:s)){if(!1===e(null,p,u,l,c))return!1}else switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,p,u,l,c))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],p,u,l,c))return!1;break;default:throw new Error("Unknown Geometry Type")}p++}}function a(t,l){r(t,function(t,e,n,r,i){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1===l(h.feature(t,n,{bbox:r,id:i}),e,0)?!1:void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var a=0;a<t.coordinates.length;a++){var u=t.coordinates[a];if(!1===l(h.feature({type:o,coordinates:u},n),e,a))return!1}})}function i(t,p){a(t,function(s,a,u){var l=0;if(s.geometry){var c,t=s.geometry.type;if("Point"!==t&&"MultiPoint"!==t)return!1!==w(s,function(t,e,n,r,i){if(void 0!==c){var o=h.lineString([c,t],s.properties);if(!1===p(o,a,u,i,l))return!1;l++}c=t})&&void 0}})}function u(t,s){if(!t)throw new Error("geojson is required");a(t,function(t,e,n){if(null!==t.geometry){var r=t.geometry.type,i=t.geometry.coordinates;switch(r){case"LineString":if(!1===s(t,e,n,0,0))return!1;break;case"Polygon":for(var o=0;o<i.length;o++)if(!1===s(h.lineString(i[o],t.properties),e,n,o))return!1}}})}n.coordEach=w,n.coordReduce=function(t,o,s,e){var a=s;return w(t,function(t,e,n,r,i){a=0===e&&void 0===s?t:o(a,t,e,n,r,i)},e),a},n.propEach=o,n.propReduce=function(t,n,r){var i=r;return o(t,function(t,e){i=0===e&&void 0===r?t:n(i,t,e)}),i},n.featureEach=s,n.featureReduce=function(t,n,r){var i=r;return s(t,function(t,e){i=0===e&&void 0===r?t:n(i,t,e)}),i},n.coordAll=function(t){var e=[];return w(t,function(t){e.push(t)}),e},n.geomEach=r,n.geomReduce=function(t,o,s){var a=s;return r(t,function(t,e,n,r,i){a=0===e&&void 0===s?t:o(a,t,e,n,r,i)}),a},n.flattenEach=a,n.flattenReduce=function(t,r,i){var o=i;return a(t,function(t,e,n){o=0===e&&0===n&&void 0===i?t:r(o,t,e,n)}),o},n.segmentEach=i,n.segmentReduce=function(t,o,s){var a=s,u=!1;return i(t,function(t,e,n,r,i){a=!1===u&&void 0===s?t:o(a,t,e,n,r,i),u=!0}),a},n.lineEach=u,n.lineReduce=function(t,i,o){var s=o;return u(t,function(t,e,n,r){s=0===e&&void 0===o?t:i(s,t,e,n,r)}),s},n.findSegment=function(t,e){if(!h.isObject(e=e||{}))throw new Error("options is invalid");var n,r=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.segmentIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),h.lineString([u[s],u[s+1]],a,e);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),h.lineString([u[o][s],u[o][s+1]],a,e);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s-1),h.lineString([u[i][s],u[i][s+1]],a,e);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s-1),h.lineString([u[i][o][s],u[i][o][s+1]],a,e)}throw new Error("geojson is invalid")},n.findPoint=function(t,e){if(!h.isObject(e=e||{}))throw new Error("options is invalid");var n,r=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.coordIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return h.point(u,a,e);case"MultiPoint":return i<0&&(i=u.length+i),h.point(u[i],a,e);case"LineString":return s<0&&(s=u.length+s),h.point(u[s],a,e);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),h.point(u[o][s],a,e);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s),h.point(u[i][s],a,e);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s),h.point(u[i][o][s],a,e)}throw new Error("geojson is invalid")}},{"@turf/helpers":5}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("@turf/helpers"),s=t("@turf/invariant");function a(t,e,n){var r,i;return!0===(n=void 0===n?{}:n).final?(a(e,t)+180)%360:(n=s.getCoord(t),t=s.getCoord(e),e=o.degreesToRadians(n[0]),r=o.degreesToRadians(t[0]),n=o.degreesToRadians(n[1]),t=o.degreesToRadians(t[1]),i=Math.sin(r-e)*Math.cos(t),n=Math.cos(n)*Math.sin(t)-Math.sin(n)*Math.cos(t)*Math.cos(r-e),o.radiansToDegrees(Math.atan2(i,n)))}n.default=a},{"@turf/helpers":30,"@turf/invariant":32}],8:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},u=(Object.defineProperty(n,"__esModule",{value:!0}),r(t("@turf/boolean-point-in-polygon"))),l=r(t("@turf/line-intersect")),i=t("@turf/meta"),c=r(t("@turf/polygon-to-line"));function o(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(function(t,e,n){var r=n[0]-t[0],i=n[1]-t[1],o=e[0]-t[0],s=e[1]-t[1];if(r*s-i*o!=0)return;return Math.abs(o)>=Math.abs(s)?0<o?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:0<s?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]}(t.coordinates[n],t.coordinates[n+1],e.coordinates))return 1}function s(t,e){for(var n=0,r=e.coordinates;n<r.length;n++){var i=r[n];if(u.default(i,t))return 1}return 0<l.default(e,c.default(t)).features.length}n.default=function(t,n){var r=!0;return i.flattenEach(t,function(e){i.flattenEach(n,function(t){if(!1===r)return!1;r=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!function(t,e){return t[0]===e[0]&&t[1]===e[1]}(t.coordinates,e.coordinates);case"LineString":return!o(e,t);case"Polygon":return!u.default(t,e)}break;case"LineString":switch(e.type){case"Point":return!o(t,e);case"LineString":return!function(t,e){if(0<l.default(t,e).features.length)return 1;return}(t,e);case"Polygon":return!s(e,t)}break;case"Polygon":switch(e.type){case"Point":return!u.default(e,t);case"LineString":return!s(t,e);case"Polygon":return!function(t,e){for(var n=0,r=t.coordinates[0];n<r.length;n++){var i=r[n];if(u.default(i,e))return 1}for(var o=0,s=e.coordinates[0];o<s.length;o++){var a=s[o];if(u.default(a,t))return 1}if(0<l.default(c.default(t),c.default(e)).features.length)return 1;return}(e,t)}}return!1}(e.geometry,t.geometry)})}),r}},{"@turf/boolean-point-in-polygon":9,"@turf/line-intersect":34,"@turf/meta":36,"@turf/polygon-to-line":45}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var c=t("@turf/invariant");function p(t,e,n){for(var r=!1,i=0,o=(e=e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]?e.slice(0,e.length-1):e).length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],u=e[o][0],l=e[o][1];if(t[1]*(s-u)+a*(u-t[0])+l*(t[0]-s)==0&&(s-t[0])*(u-t[0])<=0&&(a-t[1])*(l-t[1])<=0)return!n;a>t[1]!=l>t[1]&&t[0]<(u-s)*(t[1]-a)/(l-a)+s&&(r=!r)}return r}n.default=function(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=c.getCoord(t),i=(t=c.getGeom(e)).type,e=e.bbox,o=t.coordinates;if(e&&!1==(t=r,(e=e)[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]))return!1;"Polygon"===i&&(o=[o]);for(var s=!1,a=0;a<o.length&&!s;a++)if(p(r,o[a][0],n.ignoreBoundary)){for(var u=!1,l=1;l<o[a].length&&!u;)p(r,o[a][l],!n.ignoreBoundary)&&(u=!0),l++;u||(s=!0)}return s}},{"@turf/invariant":32}],10:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=(Object.defineProperty(n,"__esModule",{value:!0}),r(t("@turf/boolean-disjoint"))),o=t("@turf/meta");n.default=function(t,n){var r=!1;return o.flattenEach(t,function(e){o.flattenEach(n,function(t){if(!0===r)return!0;r=!i.default(e.geometry,t.geometry)})}),r}},{"@turf/boolean-disjoint":8,"@turf/meta":36}],11:[function(t,e,n){"use strict";var c=t("@turf/invariant");function r(t,e,n){if("object"!==_typeof3(n=n||{}))throw new Error("options is invalid");var r=n.ignoreBoundary;if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=c.getCoord(t),o=c.getCoords(e),n=(e.geometry||e).type,t=e.bbox;if(t&&!1==(e=i,(t=t)[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]))return!1;"Polygon"===n&&(o=[o]);for(var s=0,a=!1;s<o.length&&!a;s++)if(p(i,o[s][0],r)){for(var u=!1,l=1;l<o[s].length&&!u;)p(i,o[s][l],!r)&&(u=!0),l++;u||(a=!0)}return a}function p(t,e,n){for(var r=!1,i=0,o=(e=e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]?e.slice(0,e.length-1):e).length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],u=e[o][0],l=e[o][1];if(t[1]*(s-u)+a*(u-t[0])+l*(t[0]-s)==0&&(s-t[0])*(u-t[0])<=0&&(a-t[1])*(l-t[1])<=0)return!n;a>t[1]!=l>t[1]&&t[0]<(u-s)*(t[1]-a)/(l-a)+s&&(r=!r)}return r}e.exports=r,e.exports.default=r},{"@turf/invariant":13}],12:[function(t,e,n){arguments[4][5][0].apply(n,arguments)},{dup:5}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@turf/helpers");n.getCoord=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&2<=t.length&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},n.getCoords=function(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},n.containsNumber=function t(e){if(1<e.length&&r.isNumber(e[0])&&r.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},n.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},n.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},n.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<t.features.length;r++){var i=t.features[r];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+i.geometry.type)}},n.getGeom=function(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")},n.getGeomType=function(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")},n.getType=function(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}},{"@turf/helpers":12}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("@turf/invariant");n.default=function(t,e,n){void 0===n&&(n={});for(var r=a.getCoord(t),i=a.getCoords(e),o=0;o<i.length-1;o++){var s=!1;if(n.ignoreEndVertices&&(0===o&&(s="start"),o===i.length-2&&(s="end"),0===o)&&o+1===i.length-1&&(s="both"),function(t,e,n,r,i){var o=n[0],s=n[1],a=t[0],t=t[1],u=e[0],e=e[1],l=n[0]-a,n=n[1]-t,c=u-a,p=e-t,l=l*p-n*c;if(null!==i){if(Math.abs(l)>i)return}else if(0!=l)return;{if(!r)return Math.abs(c)>=Math.abs(p)?0<c?a<=o&&o<=u:u<=o&&o<=a:0<p?t<=s&&s<=e:e<=s&&s<=t;if("start"===r)return Math.abs(c)>=Math.abs(p)?0<c?a<o&&o<=u:u<=o&&o<a:0<p?t<s&&s<=e:e<=s&&s<t;if("end"===r)return Math.abs(c)>=Math.abs(p)?0<c?a<=o&&o<u:u<o&&o<=a:0<p?t<=s&&s<e:e<s&&s<=t;if("both"===r)return Math.abs(c)>=Math.abs(p)?0<c?a<o&&o<u:u<o&&o<a:0<p?t<s&&s<e:e<s&&s<t}return}(i[o],i[o+1],r,s,void 0===n.epsilon?null:n.epsilon))return!0}return!1}},{"@turf/invariant":32}],15:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},j=(Object.defineProperty(n,"__esModule",{value:!0}),r(t("@turf/bbox"))),q=r(t("@turf/boolean-point-on-line")),B=r(t("@turf/boolean-point-in-polygon")),G=t("@turf/invariant");function z(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function U(t,e){return t[0]===e[0]&&t[1]===e[1]}n.default=function(t,e){var n=G.getGeom(t),r=G.getGeom(e),i=n.type,o=r.type;switch(i){case"Point":switch(o){case"MultiPoint":var s,a=n,u=r,l=!1;for(s=0;s<u.coordinates.length;s++)if(U(u.coordinates[s],a.coordinates)){l=!0;break}return l;case"LineString":return q.default(n,r,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return B.default(n,r,{ignoreBoundary:!0});default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"MultiPoint":for(var c=n,p=r,h=0;h<c.coordinates.length;h++){for(var f=!1,d=0;d<p.coordinates.length;d++)U(c.coordinates[h],p.coordinates[d])&&(f=!0);if(!f)return!1}return!0;case"LineString":for(var y=n,g=r,m=!1,v=0;v<y.coordinates.length;v++){if(!q.default(y.coordinates[v],g))return!1;m=m||q.default(y.coordinates[v],g,{ignoreEndVertices:!0})}return m;case"Polygon":case"MultiPolygon":for(var _=n,b=r,x=!0,w=!1,E=0;E<_.coordinates.length;E++){if(!(w=B.default(_.coordinates[1],b))){x=!1;break}w=B.default(_.coordinates[1],b,{ignoreBoundary:!0})}return x&&w;default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"LineString":for(var S=n,I=r,N=0;N<S.coordinates.length;N++)if(!q.default(S.coordinates[N],I))return!1;return!0;case"Polygon":case"MultiPolygon":var O=n,C=r,k=j.default(C),D=j.default(O);if(!z(k,D))return!1;for(var A,M=!1,L=0;L<O.coordinates.length-1;L++){if(!B.default(O.coordinates[L],C))return!1;(M=M||B.default(O.coordinates[L],C,{ignoreBoundary:!0}))||(A=function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}(O.coordinates[L],O.coordinates[L+1]),M=B.default(A,C,{ignoreBoundary:!0}))}return M;default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Polygon":case"MultiPolygon":var P=n,T=r,F=j.default(P);if(!z(j.default(T),F))return!1;for(var R=0;R<P.coordinates[0].length;R++)if(!B.default(P.coordinates[0][R],T))return!1;return!0;default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}},{"@turf/bbox":16,"@turf/boolean-point-in-polygon":17,"@turf/boolean-point-on-line":14,"@turf/invariant":32}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@turf/meta");function i(t){var e=[1/0,1/0,-1/0,-1/0];return r.coordEach(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}n.default=i.default=i},{"@turf/meta":36}],17:[function(t,e,n){arguments[4][9][0].apply(n,arguments)},{"@turf/invariant":32,dup:9}],18:[function(t,e,n){"use strict";var r=t("@turf/center"),u=t("turf-jsts"),l=t("@turf/meta"),c=t("d3-geo"),p=t("@turf/helpers");function i(t){return t&&"object"===_typeof3(t)&&"default"in t?t:{default:t}}var h=i(r);function o(t,e,n){var r=(n=n||{}).units||"kilometers",i=n.steps||8;if(!t)throw new Error("geojson is required");if("object"!==_typeof3(n))throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var o=[];switch(t.type){case"GeometryCollection":return l.geomEach(t,function(t){t=f(t,e,r,i);t&&o.push(t)}),p.featureCollection(o);case"FeatureCollection":return l.featureEach(t,function(t){t=f(t,e,r,i);t&&l.featureEach(t,function(t){t&&o.push(t)})}),p.featureCollection(o)}return f(t,e,r,i)}function f(t,e,n,r){var i,o,s=t.properties||{},a="Feature"===t.type?t.geometry:t;return"GeometryCollection"===a.type?(i=[],l.geomEach(t,function(t){t=f(t,e,n,r);t&&i.push(t)}),p.featureCollection(i)):(t=function(t){t=h.default(t).geometry.coordinates,t=[-t[0],-t[1]];return c.geoAzimuthalEquidistant().rotate(t).scale(p.earthRadius)}(a),a={type:a.type,coordinates:function e(t,n){if("object"!==_typeof3(t[0]))return n(t);return t.map(function(t){return e(t,n)})}(a.coordinates,t)},a=(new u.GeoJSONReader).read(a),o=p.radiansToLength(p.lengthToRadians(e,n),"meters"),a=u.BufferOp.bufferOp(a,o,r),function t(e){if(Array.isArray(e[0]))return t(e[0]);return isNaN(e[0])}((a=(new u.GeoJSONWriter).write(a)).coordinates)?void 0:(o={type:a.type,coordinates:function e(t,n){if("object"!==_typeof3(t[0]))return n.invert(t);return t.map(function(t){return e(t,n)})}(a.coordinates,t)},p.feature(o,s)))}e.exports=o,e.exports.default=o},{"@turf/center":20,"@turf/helpers":30,"@turf/meta":36,"d3-geo":61,"turf-jsts":287}],19:[function(t,e,n){arguments[4][16][0].apply(n,arguments)},{"@turf/meta":36,dup:16}],20:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=(Object.defineProperty(n,"__esModule",{value:!0}),r(t("@turf/bbox"))),o=t("@turf/helpers");n.default=function(t,e){void 0===e&&(e={});var n=((t=i.default(t))[0]+t[2])/2,t=(t[1]+t[3])/2;return o.point([n,t],e.properties,e)}},{"@turf/bbox":19,"@turf/helpers":30}],21:[function(t,e,n){"use strict";var r,i=(r=t("@turf/bbox"))&&"object"===_typeof3(r)&&"default"in r?r.default:r,o=t("@turf/helpers");function s(t,e){if(!o.isObject(e=e||{}))throw new Error("options is invalid");var n,e=e.properties;if(t)return n=((t=i(t))[0]+t[2])/2,t=(t[1]+t[3])/2,o.point([n,t],e);throw new Error("geojson is required")}e.exports=s,e.exports.default=s},{"@turf/bbox":4,"@turf/helpers":22}],22:[function(t,e,n){arguments[4][5][0].apply(n,arguments)},{dup:5}],23:[function(t,e,n){"use strict";function r(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return i(t);case"FeatureCollection":return e=t,n={type:"FeatureCollection"},Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:n[t]=e[t]}}),n.features=e.features.map(i),n;case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return o(t);default:throw new Error("unknown GeoJSON type")}var e,n}function i(e){var n={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:n[t]=e[t]}}),n.properties=function n(r){var i={};if(!r)return i;Object.keys(r).forEach(function(t){var e=r[t];"object"===_typeof3(e)?null===e?i[t]=null:e.length?i[t]=e.map(function(t){return t}):i[t]=n(e):i[t]=e});return i}(e.properties),n.geometry=o(e.geometry),n}function o(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?e.geometries=t.geometries.map(o):e.coordinates=function e(t){if("object"!==_typeof3(t[0]))return t.slice();return t.map(function(t){return e(t)})}(t.coordinates),e}e.exports=r,e.exports.default=r},{}],24:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var s=t("@turf/helpers"),a=t("@turf/invariant");n.default=function(t,e,n,r){void 0===r&&(r={});var t=a.getCoord(t),i=s.degreesToRadians(t[0]),t=s.degreesToRadians(t[1]),n=s.degreesToRadians(n),e=s.lengthToRadians(e,r.units),o=Math.asin(Math.sin(t)*Math.cos(e)+Math.cos(t)*Math.sin(e)*Math.cos(n)),i=i+Math.atan2(Math.sin(n)*Math.sin(e)*Math.cos(t),Math.cos(e)-Math.sin(t)*Math.sin(o)),n=s.radiansToDegrees(i),e=s.radiansToDegrees(o);return s.point([n,e],r.properties)}},{"@turf/helpers":30,"@turf/invariant":32}],25:[function(t,e,n){"use strict";var r=t("polygon-clipping"),i=t("@turf/helpers"),o=t("@turf/invariant");function s(t){return t&&"object"===_typeof3(t)&&"default"in t?t:{default:t}}var a=s(r);function u(t,e){var n=o.getGeom(t),e=o.getGeom(e),t=t.properties||{},n=a.default.difference(n.coordinates,e.coordinates);return 0===n.length?null:1===n.length?i.polygon(n[0],t):i.multiPolygon(n,t)}e.exports=u,e.exports.default=u},{"@turf/helpers":30,"@turf/invariant":32,"polygon-clipping":282}],26:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("@turf/invariant"),s=t("@turf/helpers");n.default=function(t,e,n){void 0===n&&(n={});var t=o.getCoord(t),e=o.getCoord(e),r=s.degreesToRadians(e[1]-t[1]),i=s.degreesToRadians(e[0]-t[0]),t=s.degreesToRadians(t[1]),e=s.degreesToRadians(e[1]),r=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(t)*Math.cos(e);return s.radiansToLength(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),n.units)}},{"@turf/helpers":30,"@turf/invariant":32}],27:[function(t,e,n){"use strict";var r=t("@turf/meta"),i=t("@turf/helpers");function o(e){var n=[];return"FeatureCollection"===e.type?r.featureEach(e,function(e){r.coordEach(e,function(t){n.push(i.point(t,e.properties))})}):r.coordEach(e,function(t){n.push(i.point(t,e.properties))}),i.featureCollection(n)}e.exports=o,e.exports.default=o},{"@turf/helpers":28,"@turf/meta":29}],28:[function(t,e,n){arguments[4][5][0].apply(n,arguments)},{dup:5}],29:[function(t,e,n){arguments[4][6][0].apply(n,arguments)},{"@turf/helpers":28,dup:6}],30:[function(t,e,r){"use strict";function a(t,e,n){var r={type:"Feature"};return 0!==(n=void 0===n?{}:n).id&&!n.id||(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function i(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(d(t[0])&&d(t[1]))return a({type:"Point",coordinates:t},e,n);throw new Error("coordinates must contain numbers")}function o(t,e,n){void 0===n&&(n={});for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:t},e,n)}function s(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:t},e,n)}function u(t,e){var n={type:"FeatureCollection"};return(e=void 0===e?{}:e).id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function l(t,e,n){return a({type:"MultiLineString",coordinates:t},e,n=void 0===n?{}:n)}function c(t,e,n){return a({type:"MultiPoint",coordinates:t},e,n=void 0===n?{}:n)}function p(t,e,n){return a({type:"MultiPolygon",coordinates:t},e,n=void 0===n?{}:n)}function h(t,e){var n=r.factors[e=void 0===e?"kilometers":e];if(n)return t*n;throw new Error(e+" units is invalid")}function f(t,e){var n=r.factors[e=void 0===e?"kilometers":e];if(n)return t/n;throw new Error(e+" units is invalid")}function n(t){return 180*(t%(2*Math.PI))/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.earthRadius=6371008.8,r.factors={centimeters:100*r.earthRadius,centimetres:100*r.earthRadius,degrees:r.earthRadius/111325,feet:3.28084*r.earthRadius,inches:39.37*r.earthRadius,kilometers:r.earthRadius/1e3,kilometres:r.earthRadius/1e3,meters:r.earthRadius,metres:r.earthRadius,miles:r.earthRadius/1609.344,millimeters:1e3*r.earthRadius,millimetres:1e3*r.earthRadius,nauticalmiles:r.earthRadius/1852,radians:1,yards:1.0936*r.earthRadius},r.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/r.earthRadius,yards:1.0936133},r.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},r.feature=a,r.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return s(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return c(e).geometry;case"MultiLineString":return l(e).geometry;case"MultiPolygon":return p(e).geometry;default:throw new Error(t+" is invalid")}},r.point=i,r.points=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return i(t,e)}),n)},r.polygon=o,r.polygons=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return o(t,e)}),n)},r.lineString=s,r.lineStrings=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return s(t,e)}),n)},r.featureCollection=u,r.multiLineString=l,r.multiPoint=c,r.multiPolygon=p,r.geometryCollection=function(t,e,n){return a({type:"GeometryCollection",geometries:t},e,n=void 0===n?{}:n)},r.round=function(t,e){if(!(e=void 0===e?0:e)||0<=e)return e=Math.pow(10,e||0),Math.round(t*e)/e;throw new Error("precision must be a positive number")},r.radiansToLength=h,r.lengthToRadians=f,r.lengthToDegrees=function(t,e){return n(f(t,e))},r.bearingToAzimuth=function(t){return(t%=360)<0&&(t+=360),t},r.radiansToDegrees=n,r.degreesToRadians=function(t){return t%360*Math.PI/180},r.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),0<=t)return h(f(t,e),n);throw new Error("length must be a positive number")},r.convertArea=function(t,e,n){if(void 0===e&&(e="meters"),void 0===n&&(n="kilometers"),!(0<=t))throw new Error("area must be a positive number");if(!(e=r.areaFactors[e]))throw new Error("invalid original units");if(n=r.areaFactors[n])return t/e*n;throw new Error("invalid final units")},r.isNumber=d,r.isObject=function(t){return!!t&&t.constructor===Object},r.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!d(t))throw new Error("bbox must only contain numbers")})},r.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(_typeof3(t)))throw new Error("id must be a number or a string")}},{}],31:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=(Object.defineProperty(n,"__esModule",{value:!0}),t("@turf/helpers")),o=t("@turf/invariant"),s=r(t("polygon-clipping"));n.default=function(t,e,n){return void 0===n&&(n={}),t=o.getGeom(t),e=o.getGeom(e),0===(t=s.default.intersection(t.coordinates,e.coordinates)).length?null:1===t.length?i.polygon(t[0],n.properties):i.multiPolygon(t,n.properties)}},{"@turf/helpers":30,"@turf/invariant":32,"polygon-clipping":282}],32:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@turf/helpers");n.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&2<=t.length&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},n.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},n.containsNumber=function t(e){if(1<e.length&&r.isNumber(e[0])&&r.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},n.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},n.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},n.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=t.features;r<i.length;r++){var o=i[r];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}},n.getGeom=function(t){return"Feature"===t.type?t.geometry:t},n.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":("Feature"===t.type&&null!==t.geometry?t.geometry:t).type}},{"@turf/helpers":30}],33:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=(Object.defineProperty(n,"__esModule",{value:!0}),r(t("@turf/distance"))),o=t("@turf/meta");n.default=function(t,n){return void 0===n&&(n={}),o.segmentReduce(t,function(t,e){e=e.geometry.coordinates;return t+i.default(e[0],e[1],n)},0)}},{"@turf/distance":26,"@turf/meta":36}],34:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},l=(Object.defineProperty(n,"__esModule",{value:!0}),t("@turf/helpers")),c=t("@turf/invariant"),s=r(t("@turf/line-segment")),a=t("@turf/meta"),u=r(t("geojson-rbush"));function p(t,e){t=c.getCoords(t),e=c.getCoords(e);if(2!==t.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==e.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var n=t[0][0],r=t[0][1],i=t[1][0],t=t[1][1],o=e[0][0],s=e[0][1],a=e[1][0],e=e[1][1],u=(e-s)*(i-n)-(a-o)*(t-r),a=(a-o)*(r-s)-(e-s)*(n-o),e=(i-n)*(r-s)-(t-r)*(n-o);return 0!=u&&(s=e/u,0<=(o=a/u))&&o<=1&&0<=s&&s<=1?l.point([n+o*(i-n),r+o*(t-r)]):null}n.default=function(t,e){var n,r,i={},o=[];return"LineString"===t.type&&(t=l.feature(t)),"LineString"===e.type&&(e=l.feature(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length?(n=p(t,e))&&o.push(n):((r=u.default()).load(s.default(e)),a.featureEach(s.default(t),function(n){a.featureEach(r.search(n),function(t){var e,t=p(n,t);t&&(e=c.getCoords(t).join(","),i[e]||(i[e]=!0,o.push(t)))})})),l.featureCollection(o)}},{"@turf/helpers":30,"@turf/invariant":32,"@turf/line-segment":35,"@turf/meta":36,"geojson-rbush":78}],35:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var u=t("@turf/helpers"),s=t("@turf/invariant"),r=t("@turf/meta");n.default=function(t){var o;if(t)return o=[],r.flattenEach(t,function(t){var e=t,n=o,r=[],i=e.geometry;if(null!==i){switch(i.type){case"Polygon":r=s.getCoords(i);break;case"LineString":r=[s.getCoords(i)]}r.forEach(function(t){var s,a;s=e.properties,a=[],t.reduce(function(t,e){var n,r,i,o=u.lineString([t,e],s);return o.bbox=(n=e,r=(t=t)[0],t=t[1],i=n[0],n=n[1],[r<i?r:i,t<n?t:n,i<r?r:i,n<t?t:n]),a.push(o),e}),a.forEach(function(t){t.id=n.length,n.push(t)})})}}),u.featureCollection(o);throw new Error("geojson is required")}},{"@turf/helpers":30,"@turf/invariant":32,"@turf/meta":36}],36:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var d=t("@turf/helpers");function w(t,e,n){if(null!==t)for(var r,i,o,s=0,a=t.type,u="FeatureCollection"===a,l="Feature"===a,c=u?t.features.length:1,p=0;p<c;p++)for(var h,f,d=(f=!!(h=u?t.features[p].geometry:l?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1,y=0;y<d;y++){var g=0,m=0,v=f?h.geometries[y]:h;if(null!==v){var _=v.coordinates,b=v.type,x=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1;switch(b){case null:break;case"Point":if(!1===e(_,s,p,g,m))return!1;s++,g++;break;case"LineString":case"MultiPoint":for(r=0;r<_.length;r++){if(!1===e(_[r],s,p,g,m))return!1;s++,"MultiPoint"===b&&g++}"LineString"===b&&g++;break;case"Polygon":case"MultiLineString":for(r=0;r<_.length;r++){for(i=0;i<_[r].length-x;i++){if(!1===e(_[r][i],s,p,g,m))return!1;s++}"MultiLineString"===b&&g++,"Polygon"===b&&m++}"Polygon"===b&&g++;break;case"MultiPolygon":for(r=0;r<_.length;r++){for(i=m=0;i<_[r].length;i++){for(o=0;o<_[r][i].length-x;o++){if(!1===e(_[r][i][o],s,p,g,m))return!1;s++}m++}g++}break;case"GeometryCollection":for(r=0;r<v.geometries.length;r++)if(!1===w(v.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function r(t,e){for(var n,r,i,o,s,a,u,l,c,p=0,h="FeatureCollection"===t.type,f="Feature"===t.type,d=h?t.features.length:1,y=0;y<d;y++){for(s=h?t.features[y].geometry:f?t.geometry:t,u=h?t.features[y].properties:f?t.properties:{},l=h?t.features[y].bbox:f?t.bbox:void 0,c=h?t.features[y].id:f?t.id:void 0,o=(a=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,r=0;r<o;r++)if(null===(i=a?s.geometries[r]:s)){if(!1===e(null,p,u,l,c))return!1}else switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,p,u,l,c))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],p,u,l,c))return!1;break;default:throw new Error("Unknown Geometry Type")}p++}}function a(t,l){r(t,function(t,e,n,r,i){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1===l(d.feature(t,n,{bbox:r,id:i}),e,0)?!1:void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var a=0;a<t.coordinates.length;a++){var u=t.coordinates[a];if(!1===l(d.feature({type:o,coordinates:u},n),e,a))return!1}})}function i(t,f){a(t,function(o,s,a){var u=0;if(o.geometry){var l,c,p,h,t=o.geometry.type;if("Point"!==t&&"MultiPoint"!==t)return h=p=c=0,!1!==w(o,function(t,e,n,r,i){if(void 0===l||c<s||p<r||h<i)l=t,c=s,p=r,h=i,u=0;else{r=d.lineString([l,t],o.properties);if(!1===f(r,s,a,i,u))return!1;u++,l=t}})&&void 0}})}function u(t,s){if(!t)throw new Error("geojson is required");a(t,function(t,e,n){if(null!==t.geometry){var r=t.geometry.type,i=t.geometry.coordinates;switch(r){case"LineString":if(!1===s(t,e,n,0,0))return!1;break;case"Polygon":for(var o=0;o<i.length;o++)if(!1===s(d.lineString(i[o],t.properties),e,n,o))return!1}}})}n.coordAll=function(t){var e=[];return w(t,function(t){e.push(t)}),e},n.coordEach=w,n.coordReduce=function(t,o,s,e){var a=s;return w(t,function(t,e,n,r,i){a=0===e&&void 0===s?t:o(a,t,e,n,r,i)},e),a},n.featureEach=s,n.featureReduce=function(t,n,r){var i=r;return s(t,function(t,e){i=0===e&&void 0===r?t:n(i,t,e)}),i},n.findPoint=function(t,e){if(!d.isObject(e=e||{}))throw new Error("options is invalid");var n,r=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.coordIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return d.point(u,a,e);case"MultiPoint":return i<0&&(i=u.length+i),d.point(u[i],a,e);case"LineString":return s<0&&(s=u.length+s),d.point(u[s],a,e);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),d.point(u[o][s],a,e);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s),d.point(u[i][s],a,e);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s),d.point(u[i][o][s],a,e)}throw new Error("geojson is invalid")},n.findSegment=function(t,e){if(!d.isObject(e=e||{}))throw new Error("options is invalid");var n,r=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.segmentIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),d.lineString([u[s],u[s+1]],a,e);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),d.lineString([u[o][s],u[o][s+1]],a,e);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s-1),d.lineString([u[i][s],u[i][s+1]],a,e);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s-1),d.lineString([u[i][o][s],u[i][o][s+1]],a,e)}throw new Error("geojson is invalid")},n.flattenEach=a,n.flattenReduce=function(t,r,i){var o=i;return a(t,function(t,e,n){o=0===e&&0===n&&void 0===i?t:r(o,t,e,n)}),o},n.geomEach=r,n.geomReduce=function(t,o,s){var a=s;return r(t,function(t,e,n,r,i){a=0===e&&void 0===s?t:o(a,t,e,n,r,i)}),a},n.lineEach=u,n.lineReduce=function(t,i,o){var s=o;return u(t,function(t,e,n,r){s=0===e&&void 0===o?t:i(s,t,e,n,r)}),s},n.propEach=o,n.propReduce=function(t,n,r){var i=r;return o(t,function(t,e){i=0===e&&void 0===r?t:n(i,t,e)}),i},n.segmentEach=i,n.segmentReduce=function(t,o,s){var a=s,u=!1;return i(t,function(t,e,n,r,i){a=!1===u&&void 0===s?t:o(a,t,e,n,r,i),u=!0}),a}},{"@turf/helpers":30}],37:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},f=(Object.defineProperty(n,"__esModule",{value:!0}),r(t("@turf/bearing"))),d=r(t("@turf/distance")),y=r(t("@turf/destination")),g=r(t("@turf/line-intersect")),i=t("@turf/meta"),m=t("@turf/helpers"),v=t("@turf/invariant");n.default=function(t,l,c){void 0===c&&(c={});var p=m.point([1/0,1/0],{dist:1/0}),h=0;return i.flattenEach(t,function(t){for(var e=v.getCoords(t),n=0;n<e.length-1;n++){var r=m.point(e[n]),i=(r.properties.dist=d.default(l,r,c),m.point(e[n+1])),o=(i.properties.dist=d.default(l,i,c),d.default(r,i,c)),s=Math.max(r.properties.dist,i.properties.dist),a=f.default(r,i),u=y.default(l,s,a+90,c),s=y.default(l,s,a-90,c),a=g.default(m.lineString([u.geometry.coordinates,s.geometry.coordinates]),m.lineString([r.geometry.coordinates,i.geometry.coordinates])),u=null;0<a.features.length&&((u=a.features[0]).properties.dist=d.default(l,u,c),u.properties.location=h+d.default(r,u,c)),r.properties.dist<p.properties.dist&&((p=r).properties.index=n,p.properties.location=h),i.properties.dist<p.properties.dist&&((p=i).properties.index=n+1,p.properties.location=h+o),u&&u.properties.dist<p.properties.dist&&((p=u).properties.index=n),h+=o}}),p}},{"@turf/bearing":7,"@turf/destination":24,"@turf/distance":26,"@turf/helpers":30,"@turf/invariant":32,"@turf/line-intersect":34,"@turf/meta":36}],38:[function(t,e,n){"use strict";function r(t){return t&&"object"===_typeof3(t)&&"default"in t?t.default:t}var s=r(t("@turf/clone")),a=r(t("@turf/distance")),u=t("@turf/meta");function i(r,t){if(!r)throw new Error("targetPoint is required");var i,o;if(t)return o=1/0,u.featureEach(t,function(t,e){var n=a(r,t);n<o&&((i=s(t)).properties.featureIndex=e,i.properties.distanceToPoint=n,o=n)}),i;throw new Error("points is required")}e.exports=i,e.exports.default=i},{"@turf/clone":23,"@turf/distance":39,"@turf/meta":42}],39:[function(t,e,n){"use strict";var o=t("@turf/invariant"),s=t("@turf/helpers");function r(t,e,n){var r,i;if(s.isObject(n=n||{}))return n=n.units,t=o.getCoord(t),e=o.getCoord(e),i=s.degreesToRadians(e[1]-t[1]),r=s.degreesToRadians(e[0]-t[0]),t=s.degreesToRadians(t[1]),e=s.degreesToRadians(e[1]),i=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(r/2),2)*Math.cos(t)*Math.cos(e),s.radiansToLength(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),n);throw new Error("options is invalid")}e.exports=r,e.exports.default=r},{"@turf/helpers":40,"@turf/invariant":41}],40:[function(t,e,n){arguments[4][5][0].apply(n,arguments)},{dup:5}],41:[function(t,e,n){arguments[4][13][0].apply(n,arguments)},{"@turf/helpers":40,dup:13}],42:[function(t,e,n){arguments[4][6][0].apply(n,arguments)},{"@turf/helpers":40,dup:6}],43:[function(t,e,n){"use strict";function r(t){return t&&"object"===_typeof3(t)&&"default"in t?t.default:t}var h=r(t("@turf/explode")),f=r(t("@turf/center")),d=r(t("@turf/nearest-point")),y=r(t("@turf/boolean-point-in-polygon")),g=t("@turf/helpers");function i(t){for(var e="FeatureCollection"===(t=t).type?t:"Feature"===t.type?g.featureCollection([t]):g.featureCollection([g.feature(t)]),n=f(e),r=!1,i=0;!r&&i<e.features.length;){var o=e.features[i].geometry,s=!1;if("Point"===o.type)n.geometry.coordinates[0]===o.coordinates[0]&&n.geometry.coordinates[1]===o.coordinates[1]&&(r=!0);else if("MultiPoint"===o.type)for(var a=!1,u=0;!a&&u<o.coordinates.length;)n.geometry.coordinates[0]===o.coordinates[u][0]&&n.geometry.coordinates[1]===o.coordinates[u][1]&&(a=r=!0),u++;else if("LineString"===o.type)for(u=0;!s&&u<o.coordinates.length-1;)m(n.geometry.coordinates[0],n.geometry.coordinates[1],o.coordinates[u][0],o.coordinates[u][1],o.coordinates[u+1][0],o.coordinates[u+1][1])&&(r=s=!0),u++;else if("MultiLineString"===o.type)for(var l=0;l<o.coordinates.length;){s=!1,u=0;for(var c=o.coordinates[l];!s&&u<c.length-1;)m(n.geometry.coordinates[0],n.geometry.coordinates[1],c[u][0],c[u][1],c[u+1][0],c[u+1][1])&&(r=s=!0),u++;l++}else"Polygon"!==o.type&&"MultiPolygon"!==o.type||y(n,o)&&(r=!0);i++}if(r)return n;for(var p=g.featureCollection([]),i=0;i<e.features.length;i++)p.features=p.features.concat(h(e.features[i]).features);return g.point(d(n,p).geometry.coordinates)}function m(t,e,n,r,i,o){return Math.sqrt((i-n)*(i-n)+(o-r)*(o-r))===Math.sqrt((t-n)*(t-n)+(e-r)*(e-r))+Math.sqrt((i-t)*(i-t)+(o-e)*(o-e))}e.exports=i,e.exports.default=i},{"@turf/boolean-point-in-polygon":11,"@turf/center":21,"@turf/explode":27,"@turf/helpers":44,"@turf/nearest-point":38}],44:[function(t,e,n){arguments[4][5][0].apply(n,arguments)},{dup:5}],45:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("@turf/helpers"),s=t("@turf/invariant");function r(t,e){return void 0===e&&(e={}),a(s.getGeom(t).coordinates,e.properties||("Feature"===t.type?t.properties:{}))}function i(t,e){void 0===e&&(e={});var n=s.getGeom(t).coordinates,r=e.properties||("Feature"===t.type?t.properties:{}),i=[];return n.forEach(function(t){i.push(a(t,r))}),o.featureCollection(i)}function a(t,e){return 1<t.length?o.multiLineString(t,e):o.lineString(t[0],e)}n.default=function(t,e){void 0===e&&(e={});var n=s.getGeom(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return r(n,e);case"MultiPolygon":return i(n,e);default:throw new Error("invalid poly")}},n.polygonToLine=r,n.multiPolygonToLine=i,n.coordsToLine=a},{"@turf/helpers":30,"@turf/invariant":32}],46:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=(Object.defineProperty(n,"__esModule",{value:!0}),r(t("polygon-clipping"))),o=t("@turf/invariant"),s=t("@turf/helpers");n.default=function(t,e,n){return void 0===n&&(n={}),t=o.getGeom(t),e=o.getGeom(e),0===(t=i.default.union(t.coordinates,e.coordinates)).length?null:1===t.length?s.polygon(t[0],n.properties):s.multiPolygon(t,n.properties)}},{"@turf/helpers":30,"@turf/invariant":32,"polygon-clipping":282}],47:[function(t,e,n){"use strict";function r(t,e){return(e=void 0===e?Object:e)&&"function"==typeof e.freeze?e.freeze(t):t}var i=r({HTML:"text/html",isHTML:function(t){return t===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),o=r({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(t){return t===o.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});n.assign=function(t,e){if(null===t||"object"!==_typeof3(t))throw new TypeError("target is not an object");for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},n.freeze=r,n.MIME_TYPE=i,n.NAMESPACE=o},{}],48:[function(t,e,n){var r=t("./conventions"),i=t("./dom"),l=t("./entities"),t=t("./sax"),o=i.DOMImplementation,c=r.NAMESPACE,s=t.ParseError,p=t.XMLReader;function h(t){return t.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function a(t){this.options=t||{locator:{}}}function f(){this.cdata=!1}function d(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function y(t){if(t)return"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function u(t,e,n){return"string"==typeof t?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}function g(t,e){(t.currentElement||t.doc).appendChild(e)}a.prototype.parseFromString=function(t,e){var n=this.options,r=new p,i=n.domBuilder||new f,o=n.errorHandler,s=n.locator,a=n.xmlns||{},e=/\/x?html?$/.test(e),u=e?l.HTML_ENTITIES:l.XML_ENTITIES,o=(s&&i.setDocumentLocator(s),r.errorHandler=function(r,t,i){if(!r){if(t instanceof f)return t;r=t}var o={},s=r instanceof Function;function e(e){var n=r[e];!n&&s&&(n=2==r.length?function(t){r(e,t)}:r),o[e]=n?function(t){n("[xmldom "+e+"]\t"+t+y(i))}:function(){}}return i=i||{},e("warning"),e("error"),e("fatalError"),o}(o,i,s),r.domBuilder=n.domBuilder||i,e&&(a[""]=c.HTML),a.xml=a.xml||c.XML,n.normalizeLineEndings||h);return t&&"string"==typeof t?r.parse(o(t),a,u):r.errorHandler.error("invalid doc source"),i.doc},f.prototype={startDocument:function(){this.doc=(new o).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,n,r){var i=this.doc,o=i.createElementNS(t,n||e),s=r.length;g(this,o),this.currentElement=o,this.locator&&d(this.locator,o);for(var a=0;a<s;a++){var t=r.getURI(a),u=r.getValue(a),n=r.getQName(a),l=i.createAttributeNS(t,n);this.locator&&d(r.getLocator(a),l),l.value=l.nodeValue=u,o.setAttributeNode(l)}},endElement:function(t,e,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){t=this.doc.createProcessingInstruction(t,e);this.locator&&d(this.locator,t),g(this,t)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){var r;(t=u.apply(this,arguments))&&(r=this.cdata?this.doc.createCDATASection(t):this.doc.createTextNode(t),this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(t)&&this.doc.appendChild(r),this.locator)&&d(this.locator,r)},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,n){t=u.apply(this,arguments);var r=this.doc.createComment(t);this.locator&&d(this.locator,r),g(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n){var r=this.doc.implementation;r&&r.createDocumentType&&(r=r.createDocumentType(t,e,n),this.locator&&d(this.locator,r),g(this,r),this.doc.doctype=r)},warning:function(t){console.warn("[xmldom warning]\t"+t,y(this.locator))},error:function(t){console.error("[xmldom error]\t"+t,y(this.locator))},fatalError:function(t){throw new s(t,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){f.prototype[t]=function(){return null}}),n.__DOMHandler=f,n.normalizeLineEndings=h,n.DOMParser=a},{"./conventions":47,"./dom":49,"./entities":50,"./sax":52}],49:[function(t,D,e){var b=t("./conventions").NAMESPACE;function F(t){return""!==t}function j(t,e){return t.hasOwnProperty(e)||(t[e]=!0),t}function u(t){return t?(t=(t=t)?t.split(/[\t\n\f\r ]+/).filter(F):[],Object.keys(t.reduce(j,{}))):[]}function i(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function n(t,e){var n,r=t.prototype;r instanceof e||((n=function(){}).prototype=e.prototype,i(r,n=new n),t.prototype=r=n),r.constructor!=t&&("function"!=typeof t&&console.error("unknown Class:"+t),r.constructor=t)}var r,t={},o=(t.ELEMENT_NODE=1,t.ATTRIBUTE_NODE=2,t.TEXT_NODE=3,t.CDATA_SECTION_NODE=4,t.ENTITY_REFERENCE_NODE=5,t.ENTITY_NODE=6,t.PROCESSING_INSTRUCTION_NODE=7,t.COMMENT_NODE=8,t.DOCUMENT_NODE=9,t.DOCUMENT_TYPE_NODE=10,t.DOCUMENT_FRAGMENT_NODE=11,t.NOTATION_NODE=12,{}),s={};o.INDEX_SIZE_ERR=(s[1]="Index size error",1),o.DOMSTRING_SIZE_ERR=(s[2]="DOMString size error",2),o.HIERARCHY_REQUEST_ERR=(s[3]="Hierarchy request error",3),o.WRONG_DOCUMENT_ERR=(s[4]="Wrong document",4),o.INVALID_CHARACTER_ERR=(s[5]="Invalid character",5),o.NO_DATA_ALLOWED_ERR=(s[6]="No data allowed",6),o.NO_MODIFICATION_ALLOWED_ERR=(s[7]="No modification allowed",7),o.NOT_FOUND_ERR=(s[8]="Not found",8),o.NOT_SUPPORTED_ERR=(s[9]="Not supported",9),o.INUSE_ATTRIBUTE_ERR=(s[10]="Attribute in use",10),o.INVALID_STATE_ERR=(s[11]="Invalid state",11),o.SYNTAX_ERR=(s[12]="Syntax error",12),o.INVALID_MODIFICATION_ERR=(s[13]="Invalid modification",13),o.NAMESPACE_ERR=(s[14]="Invalid namespace",14),o.INVALID_ACCESS_ERR=(s[15]="Invalid access",15);function a(t,e){var n;return e instanceof Error?n=e:(n=this,Error.call(this,s[t]),this.message=s[t],Error.captureStackTrace&&Error.captureStackTrace(this,a)),n.code=t,e&&(this.message=this.message+": "+e),n}function h(){}function l(t,e){this._node=t,this._refresh=e,c(this)}function c(t){var e,n=t._node._inc||t._node.ownerDocument._inc;t._inc!=n&&(e=t._refresh(t._node),X(t,"length",e.length),i(e,t),t._inc=n)}function f(){}function p(t,e){for(var n=t.length;n--;)if(t[n]===e)return n}function d(t,e,n,r){r?e[p(e,r)]=n:e[e.length++]=n,t&&(e=(n.ownerElement=t).ownerDocument)&&(r&&w(e,t,r),r=t,t=n,(n=e)&&n._inc++,t.namespaceURI===b.XMLNS)&&(r._nsMap[t.prefix?t.localName:""]=t.value)}function y(t,e,n){var r=p(e,n);if(!(0<=r))throw a(8,new Error(t.tagName+"@"+n));for(var i,o=e.length-1;r<o;)e[r]=e[++r];e.length=o,t&&(i=t.ownerDocument)&&(w(i,t,n),n.ownerElement=null)}function g(){}function m(){}function x(t){return("<"==t?"&lt;":">"==t&&"&gt;")||("&"==t?"&amp;":'"'==t&&"&quot;")||"&#"+t.charCodeAt()+";"}function v(t,e){if(e(t))return 1;if(t=t.firstChild)do{if(v(t,e))return 1}while(t=t.nextSibling)}function _(){}function w(t,e,n){t&&t._inc++,n.namespaceURI===b.XMLNS&&delete e._nsMap[n.prefix?n.localName:""]}function E(t,e,n){if(t&&t._inc){t._inc++;var r=e.childNodes;if(n)r[r.length++]=n;else{for(var i=e.firstChild,o=0;i;)i=(r[o++]=i).nextSibling;r.length=o,delete r[r.length]}}}function q(t,e){var n=e.previousSibling,r=e.nextSibling;return n?n.nextSibling=r:t.firstChild=r,r?r.previousSibling=n:t.lastChild=n,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,E(t.ownerDocument,t),e}function B(t,e,n){var r=e.parentNode;if(r&&r.removeChild(e),11===e.nodeType){var i=e.firstChild;if(null==i)return e;var o=e.lastChild}else i=o=e;r=n?n.previousSibling:t.lastChild;for(i.previousSibling=r,o.nextSibling=n,r?r.nextSibling=i:t.firstChild=i,null==n?t.lastChild=o:n.previousSibling=o;i.parentNode=t,i!==o&&(i=i.nextSibling););return E(t.ownerDocument||t,t),11==e.nodeType&&(e.firstChild=e.lastChild=null),e}function S(){this._nsMap={}}function I(){}function N(){}function O(){}function C(){}function k(){}function A(){}function G(){}function z(){}function M(){}function L(){}function P(){}function U(){}function V(t,e){var n,r=[],i=9==this.nodeType&&this.documentElement||this,o=i.prefix,s=i.namespaceURI;return R(this,r,t,e,n=s&&null==o&&null==i.lookupPrefix(s)?[{namespace:s,prefix:null}]:n),r.join("")}function $(t,e,n){var r=t.prefix||"",i=t.namespaceURI;if(i&&("xml"!==r||i!==b.XML)&&i!==b.XMLNS){for(var o=n.length;o--;){var s=n[o];if(s.prefix===r)return s.namespace!==i}return 1}}function T(t,e,n){t.push(" ",e,'="',n.replace(/[<>&"\t\n\r]/g,x),'"')}function R(t,e,n,r,i){if(i=i||[],r){if(!(t=r(t)))return;if("string"==typeof t)return void e.push(t)}switch(t.nodeType){case 1:var o=t.attributes,s=o.length,a=t.firstChild,u=t.tagName,l=u;if(!(n=b.isHTML(t.namespaceURI)||n)&&!t.prefix&&t.namespaceURI){for(var c,p=0;p<o.length;p++)if("xmlns"===o.item(p).name){c=o.item(p).value;break}if(!c)for(var h=i.length-1;0<=h;h--)if(""===(f=i[h]).prefix&&f.namespace===t.namespaceURI){c=f.namespace;break}if(c!==t.namespaceURI)for(var f,h=i.length-1;0<=h;h--)if((f=i[h]).namespace===t.namespaceURI){f.prefix&&(l=f.prefix+":"+u);break}}e.push("<",l);for(var d=0;d<s;d++)"xmlns"==(y=o.item(d)).prefix?i.push({prefix:y.localName,namespace:y.value}):"xmlns"==y.nodeName&&i.push({prefix:"",namespace:y.value});for(var y,g,m,d=0;d<s;d++)$(y=o.item(d),0,i)&&(T(e,(g=y.prefix||"")?"xmlns:"+g:"xmlns",m=y.namespaceURI),i.push({prefix:g,namespace:m})),R(y,e,n,r,i);if(u===l&&$(t,0,i)&&(T(e,(g=t.prefix||"")?"xmlns:"+g:"xmlns",m=t.namespaceURI),i.push({prefix:g,namespace:m})),a||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(e.push(">"),n&&/^script$/i.test(u))for(;a;)a.data?e.push(a.data):R(a,e,n,r,i.slice()),a=a.nextSibling;else for(;a;)R(a,e,n,r,i.slice()),a=a.nextSibling;e.push("</",l,">")}else e.push("/>");return;case 9:case 11:for(a=t.firstChild;a;)R(a,e,n,r,i.slice()),a=a.nextSibling;return;case 2:return T(e,t.name,t.value);case 3:return e.push(t.data.replace(/[<&>]/g,x));case 4:return e.push("<![CDATA[",t.data,"]]>");case 8:return e.push("\x3c!--",t.data,"--\x3e");case 10:var v=t.publicId,_=t.systemId;return e.push("<!DOCTYPE ",t.name),void(v?(e.push(" PUBLIC ",v),_&&"."!=_&&e.push(" ",_),e.push(">")):_&&"."!=_?e.push(" SYSTEM ",_,">"):((v=t.internalSubset)&&e.push(" [",v,"]"),e.push(">")));case 7:return e.push("<?",t.target," ",t.data,"?>");case 5:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function X(t,e,n){t[e]=n}a.prototype=Error.prototype,i(o,a),h.prototype={length:0,item:function(t){return this[t]||null},toString:function(t,e){for(var n=[],r=0;r<this.length;r++)R(this[r],n,t,e);return n.join("")}},l.prototype.item=function(t){return c(this),this[t]},n(l,h),f.prototype={length:0,item:h.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var n=this[e];if(n.nodeName==t)return n}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new a(10);e=this.getNamedItem(t.nodeName);return d(this._ownerElement,this,t,e),e},setNamedItemNS:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new a(10);return e=this.getNamedItemNS(t.namespaceURI,t.localName),d(this._ownerElement,this,t,e),e},removeNamedItem:function(t){t=this.getNamedItem(t);return y(this._ownerElement,this,t),t},removeNamedItemNS:function(t,e){t=this.getNamedItemNS(t,e);return y(this._ownerElement,this,t),t},getNamedItemNS:function(t,e){for(var n=this.length;n--;){var r=this[n];if(r.localName==e&&r.namespaceURI==t)return r}return null}},g.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,n){var r=new _;return r.implementation=this,r.childNodes=new h,r.doctype=n||null,n&&r.appendChild(n),e&&(n=r.createElementNS(t,e),r.appendChild(n)),r},createDocumentType:function(t,e,n){var r=new A;return r.name=t,r.nodeName=t,r.publicId=e||"",r.systemId=n||"",r}},m.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return B(this,t,e)},replaceChild:function(t,e){this.insertBefore(t,e),e&&this.removeChild(e)},removeChild:function(t){return q(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(t){return function t(e,n,r){var i=new n.constructor;for(var o in n){var s;Object.prototype.hasOwnProperty.call(n,o)&&"object"!=_typeof3(s=n[o])&&s!=i[o]&&(i[o]=s)}n.childNodes&&(i.childNodes=new h);i.ownerDocument=e;switch(i.nodeType){case 1:var a=n.attributes,u=i.attributes=new f,l=a.length;u._ownerElement=i;for(var c=0;c<l;c++)i.setAttributeNode(t(e,a.item(c),!0));break;case 2:r=!0}if(r)for(var p=n.firstChild;p;)i.appendChild(t(e,p,r)),p=p.nextSibling;return i}(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&3==e.nodeType&&3==t.nodeType?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(t){for(var e=this;e;){var n=e._nsMap;if(n)for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&n[r]===t)return r;e=2==e.nodeType?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var n=e._nsMap;if(n&&Object.prototype.hasOwnProperty.call(n,t))return n[t];e=2==e.nodeType?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){return null==this.lookupPrefix(t)}},i(t,m),i(t,m.prototype),_.prototype={nodeName:"#document",nodeType:9,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(11==t.nodeType)for(var n=t.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,e),n=r}else null==this.documentElement&&1==t.nodeType&&(this.documentElement=t),B(this,t,e),t.ownerDocument=this;return t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),q(this,t)},importNode:function(t,e){return function t(e,n,r){var i;switch(n.nodeType){case 1:(i=n.cloneNode(!1)).ownerDocument=e;case 11:break;case 2:r=!0}i=i||n.cloneNode(!1);i.ownerDocument=e;i.parentNode=null;if(r)for(var o=n.firstChild;o;)i.appendChild(t(e,o,r)),o=o.nextSibling;return i}(this,t,e)},getElementById:function(e){var n=null;return v(this.documentElement,function(t){if(1==t.nodeType&&t.getAttribute("id")==e)return n=t,!0}),n},getElementsByClassName:function(s){var a=u(s);return new l(this,function(i){var o=[];return 0<a.length&&v(i.documentElement,function(t){var e,n,r;t!==i&&1===t.nodeType&&(e=t.getAttribute("class"))&&((n=s===e)||(e=u(e),n=a.every((r=e,function(t){return r&&-1!==r.indexOf(t)}))),n)&&o.push(t)}),o})},createElement:function(t){var e=new S;return e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new h,(e.attributes=new f)._ownerElement=e},createDocumentFragment:function(){var t=new L;return t.ownerDocument=this,t.childNodes=new h,t},createTextNode:function(t){var e=new O;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new C;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new k;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var n=new P;return n.ownerDocument=this,n.tagName=n.target=t,n.nodeValue=n.data=e,n},createAttribute:function(t){var e=new I;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new M;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var n=new S,r=e.split(":"),i=n.attributes=new f;return n.childNodes=new h,n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.namespaceURI=t,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=e,i._ownerElement=n},createAttributeNS:function(t,e){var n=new I,r=e.split(":");return n.ownerDocument=this,n.nodeName=e,n.name=e,n.namespaceURI=t,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=e,n}},n(_,m),_.prototype.getElementsByTagName=(S.prototype={nodeType:1,hasAttribute:function(t){return null!=this.getAttributeNode(t)},getAttribute:function(t){t=this.getAttributeNode(t);return t&&t.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){t=this.ownerDocument.createAttribute(t);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(t){t=this.getAttributeNode(t);t&&this.removeAttributeNode(t)},appendChild:function(t){return 11===t.nodeType?this.insertBefore(t,null):(e=this,(t=t).parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,E(e.ownerDocument,e,t),t);var e},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){t=this.getAttributeNodeNS(t,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(t,e){return null!=this.getAttributeNodeNS(t,e)},getAttributeNS:function(t,e){t=this.getAttributeNodeNS(t,e);return t&&t.value||""},setAttributeNS:function(t,e,n){t=this.ownerDocument.createAttributeNS(t,e);t.value=t.nodeValue=""+n,this.setAttributeNode(t)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(r){return new l(this,function(e){var n=[];return v(e,function(t){t===e||1!=t.nodeType||"*"!==r&&t.tagName!=r||n.push(t)}),n})},getElementsByTagNameNS:function(r,i){return new l(this,function(e){var n=[];return v(e,function(t){t===e||1!==t.nodeType||"*"!==r&&t.namespaceURI!==r||"*"!==i&&t.localName!=i||n.push(t)}),n})}}).getElementsByTagName,_.prototype.getElementsByTagNameNS=S.prototype.getElementsByTagNameNS,n(S,m),I.prototype.nodeType=2,n(I,m),N.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(s[3])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,n){var r=this.data.substring(0,t),t=this.data.substring(t+e);this.nodeValue=this.data=n=r+n+t,this.length=n.length}},n(N,m),O.prototype={nodeName:"#text",nodeType:3,splitText:function(t){var e=(n=this.data).substring(t),n=n.substring(0,t),t=(this.data=this.nodeValue=n,this.length=n.length,this.ownerDocument.createTextNode(e));return this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling),t}},n(O,N),C.prototype={nodeName:"#comment",nodeType:8},n(C,N),k.prototype={nodeName:"#cdata-section",nodeType:4},n(k,N),A.prototype.nodeType=10,n(A,m),G.prototype.nodeType=12,n(G,m),z.prototype.nodeType=6,n(z,m),M.prototype.nodeType=5,n(M,m),L.prototype.nodeName="#document-fragment",L.prototype.nodeType=11,n(L,m),P.prototype.nodeType=7,n(P,m),U.prototype.serializeToString=function(t,e,n){return V.call(t,e,n)},m.prototype.toString=V;try{Object.defineProperty&&(r=function t(e){switch(e.nodeType){case 1:case 11:var n=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&n.push(t(e)),e=e.nextSibling;return n.join("");default:return e.nodeValue}},Object.defineProperty(l.prototype,"length",{get:function(){return c(this),this.$$length}}),Object.defineProperty(m.prototype,"textContent",{get:function(){return r(this)},set:function(t){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),X=function(t,e,n){t["$$"+e]=n})}catch(t){}e.DocumentType=A,e.DOMException=a,e.DOMImplementation=g,e.Element=S,e.Node=m,e.NodeList=h,e.XMLSerializer=U},{"./conventions":47}],50:[function(t,e,n){t=t("./conventions").freeze;n.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=t({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"Ã",Aacute:"Ã",Acirc:"Ã",Atilde:"Ã",Auml:"Ã",Aring:"Ã",AElig:"Ã",Ccedil:"Ã",Egrave:"Ã",Eacute:"Ã",Ecirc:"Ã",Euml:"Ã",Igrave:"Ã",Iacute:"Ã",Icirc:"Ã",Iuml:"Ã",ETH:"Ã",Ntilde:"Ã",Ograve:"Ã",Oacute:"Ã",Ocirc:"Ã",Otilde:"Ã",Ouml:"Ã",Oslash:"Ã",Ugrave:"Ã",Uacute:"Ã",Ucirc:"Ã",Uuml:"Ã",Yacute:"Ã",THORN:"Ã",szlig:"Ã",agrave:"Ã ",aacute:"Ã¡",acirc:"Ã¢",atilde:"Ã£",auml:"Ã¤",aring:"Ã¥",aelig:"Ã¦",ccedil:"Ã§",egrave:"Ã¨",eacute:"Ã©",ecirc:"Ãª",euml:"Ã«",igrave:"Ã¬",iacute:"Ã­",icirc:"Ã®",iuml:"Ã¯",eth:"Ã°",ntilde:"Ã±",ograve:"Ã²",oacute:"Ã³",ocirc:"Ã´",otilde:"Ãµ",ouml:"Ã¶",oslash:"Ã¸",ugrave:"Ã¹",uacute:"Ãº",ucirc:"Ã»",uuml:"Ã¼",yacute:"Ã½",thorn:"Ã¾",yuml:"Ã¿",nbsp:"Â ",iexcl:"Â¡",cent:"Â¢",pound:"Â£",curren:"Â¤",yen:"Â¥",brvbar:"Â¦",sect:"Â§",uml:"Â¨",copy:"Â©",ordf:"Âª",laquo:"Â«",not:"Â¬",shy:"Â­Â­",reg:"Â®",macr:"Â¯",deg:"Â°",plusmn:"Â±",sup2:"Â²",sup3:"Â³",acute:"Â´",micro:"Âµ",para:"Â¶",middot:"Â·",cedil:"Â¸",sup1:"Â¹",ordm:"Âº",raquo:"Â»",frac14:"Â¼",frac12:"Â½",frac34:"Â¾",iquest:"Â¿",times:"Ã",divide:"Ã·",forall:"â",part:"â",exist:"â",empty:"â",nabla:"â",isin:"â",notin:"â",ni:"â",prod:"â",sum:"â",minus:"â",lowast:"â",radic:"â",prop:"â",infin:"â",ang:"â ",and:"â§",or:"â¨",cap:"â©",cup:"âª",int:"â«",there4:"â´",sim:"â¼",cong:"â",asymp:"â",ne:"â ",equiv:"â¡",le:"â¤",ge:"â¥",sub:"â",sup:"â",nsub:"â",sube:"â",supe:"â",oplus:"â",otimes:"â",perp:"â¥",sdot:"â",Alpha:"Î",Beta:"Î",Gamma:"Î",Delta:"Î",Epsilon:"Î",Zeta:"Î",Eta:"Î",Theta:"Î",Iota:"Î",Kappa:"Î",Lambda:"Î",Mu:"Î",Nu:"Î",Xi:"Î",Omicron:"Î",Pi:"Î ",Rho:"Î¡",Sigma:"Î£",Tau:"Î¤",Upsilon:"Î¥",Phi:"Î¦",Chi:"Î§",Psi:"Î¨",Omega:"Î©",alpha:"Î±",beta:"Î²",gamma:"Î³",delta:"Î´",epsilon:"Îµ",zeta:"Î¶",eta:"Î·",theta:"Î¸",iota:"Î¹",kappa:"Îº",lambda:"Î»",mu:"Î¼",nu:"Î½",xi:"Î¾",omicron:"Î¿",pi:"Ï",rho:"Ï",sigmaf:"Ï",sigma:"Ï",tau:"Ï",upsilon:"Ï",phi:"Ï",chi:"Ï",psi:"Ï",omega:"Ï",thetasym:"Ï",upsih:"Ï",piv:"Ï",OElig:"Å",oelig:"Å",Scaron:"Å ",scaron:"Å¡",Yuml:"Å¸",fnof:"Æ",circ:"Ë",tilde:"Ë",ensp:"â",emsp:"â",thinsp:"â",zwnj:"â",zwj:"â",lrm:"â",rlm:"â",ndash:"â",mdash:"â",lsquo:"â",rsquo:"â",sbquo:"â",ldquo:"â",rdquo:"â",bdquo:"â",dagger:"â ",Dagger:"â¡",bull:"â¢",hellip:"â¦",permil:"â°",prime:"â²",Prime:"â³",lsaquo:"â¹",rsaquo:"âº",oline:"â¾",euro:"â¬",trade:"â¢",larr:"â",uarr:"â",rarr:"â",darr:"â",harr:"â",crarr:"âµ",lceil:"â",rceil:"â",lfloor:"â",rfloor:"â",loz:"â",spades:"â ",clubs:"â£",hearts:"â¥",diams:"â¦"}),n.entityMap=n.HTML_ENTITIES},{"./conventions":47}],51:[function(t,e,n){var r=t("./dom");n.DOMImplementation=r.DOMImplementation,n.XMLSerializer=r.XMLSerializer,n.DOMParser=t("./dom-parser").DOMParser},{"./dom":49,"./dom-parser":48}],52:[function(t,e,n){var A=t("./conventions").NAMESPACE,t=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+t.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+t.source+r.source+"*(?::"+t.source+r.source+"*)?$"),M=0,L=1,P=2,T=3,R=4,D=5,F=6,j=7;function q(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,q)}function o(){}function B(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function G(t,e,n){for(var r=t.tagName,i=null,o=t.length;o--;){var s=t[o],a=s.qName,u=s.value,a=0<(c=a.indexOf(":"))?(l=s.prefix=a.slice(0,c),p=a.slice(c+1),"xmlns"===l&&p):(l=null,"xmlns"===(p=a)&&"");s.localName=p,!1!==a&&(null==i&&(i={},f(n,n={})),n[a]=i[a]=u,s.uri=A.XMLNS,e.startPrefixMapping(a,u))}for(var l,o=t.length;o--;)(l=(s=t[o]).prefix)&&("xml"===l&&(s.uri=A.XML),"xmlns"!==l)&&(s.uri=n[l||""]);var c,p=0<(c=r.indexOf(":"))?(l=t.prefix=r.slice(0,c),t.localName=r.slice(c+1)):(l=null,t.localName=r),h=t.uri=n[l||""];if(e.startElement(h,p,r,t),!t.closed)return t.currentNSMap=n,t.localNSMap=i,1;if(e.endElement(h,p,r),i)for(l in i)Object.prototype.hasOwnProperty.call(i,l)&&e.endPrefixMapping(l)}function f(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function z(){this.attributeNames={}}(q.prototype=new Error).name=q.name,o.prototype={parse:function(t,e,n){var r=this.domBuilder;r.startDocument(),f(e,e={}),function(n,t,r,i,o){function s(t){var e=t.slice(1,-1);return Object.hasOwnProperty.call(r,e)?r[e]:"#"===e.charAt(0)?65535<(e=parseInt(e.substr(1).replace("x","0x")))?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e):(o.error("entity not found:"+t),t)}function e(t){var e;d<t&&(e=n.substring(d,t).replace(/&#?\w+;/g,s),p&&a(d),i.characters(e,0,t-d),d=t)}function a(t,e){for(;l<=t&&(e=c.exec(n));)u=e.index,l=u+e[0].length,p.lineNumber++;p.columnNumber=t-u+1}var u=0,l=0,c=/.*(?:\r\n?|\n)|.*$/g,p=i.locator,h=[{currentNSMap:t}],f={},d=0;for(;;){try{var y,g,m=n.indexOf("<",d);if(m<0)return n.substr(d).match(/^\s*$/)||(y=i.doc,g=y.createTextNode(n.substr(d)),y.appendChild(g),i.currentElement=g);switch(d<m&&e(m),n.charAt(m+1)){case"/":var v=n.indexOf(">",m+3),_=n.substring(m+2,v).replace(/[ \t\n\r]+$/g,""),b=h.pop(),x=(v<0?(_=n.substring(m+2).replace(/[\s<].*/,""),o.error("end tag name: "+_+" is not complete:"+b.tagName),v=m+1+_.length):_.match(/\s</)&&(_=_.replace(/[\s<].*/,""),o.error("end tag name: "+_+" maybe not complete"),v=m+1+_.length),b.localNSMap),w=b.tagName==_;if(w||b.tagName&&b.tagName.toLowerCase()==_.toLowerCase()){if(i.endElement(b.uri,b.localName,_),x)for(var E in x)Object.prototype.hasOwnProperty.call(x,E)&&i.endPrefixMapping(E);w||o.fatalError("end tag name: "+_+" is not match the current start tagName:"+b.tagName)}else h.push(b);v++;break;case"?":p&&a(m),v=function(t,e,n){var r=t.indexOf("?>",e);if(r){t=t.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(t)return t[0].length,n.processingInstruction(t[1],t[2]),r+2}return-1}(n,m,i);break;case"!":p&&a(m),v=function(t,e,n,r){{if("-"===t.charAt(e+2))return"-"===t.charAt(e+3)?(o=t.indexOf("--\x3e",e+4),e<o?(n.comment(t,e+4,o-e-4),o+3):(r.error("Unclosed comment"),-1)):-1;if("CDATA["==t.substr(e+3,6))return o=t.indexOf("]]>",e+9),n.startCDATA(),n.characters(t,e+9,o-e-9),n.endCDATA(),o+3;var i,r=function(t,e){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=e,i.exec(t);for(;n=i.exec(t);)if(r.push(n),n[1])return r}(t,e),o=r.length;if(1<o&&/!doctype/i.test(r[0][0]))return t=r[1][0],i=e=!1,3<o&&(/^public$/i.test(r[2][0])?(e=r[3][0],i=4<o&&r[4][0]):/^system$/i.test(r[2][0])&&(i=r[3][0])),r=r[o-1],n.startDTD(t,e,i),n.endDTD(),r.index+r[0].length}return-1}(n,m,i,o);break;default:p&&a(m);var S=new z,I=h[h.length-1].currentNSMap,v=function(t,e,r,n,i,o){function s(t,e,n){r.attributeNames.hasOwnProperty(t)&&o.fatalError("Attribute "+t+" redefined"),r.addValue(t,e.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,i),n)}var a,u=++e,l=M;for(;;){var c=t.charAt(u);switch(c){case"=":if(l===L)a=t.slice(e,u);else if(l!==P)throw new Error("attribute equal must after attrName");l=T;break;case"'":case'"':if(l===T||l===L){if(l===L&&(o.warning('attribute value must after "="'),a=t.slice(e,u)),e=u+1,!(0<(u=t.indexOf(c,e))))throw new Error("attribute value no end '"+c+"' match");p=t.slice(e,u),s(a,p,e-1)}else{if(l!=R)throw new Error('attribute value must after "="');p=t.slice(e,u),s(a,p,e),o.warning('attribute "'+a+'" missed start quot('+c+")!!"),e=u+1}l=D;break;case"/":switch(l){case M:r.setTagName(t.slice(e,u));case D:case F:case j:l=j,r.closed=!0;case R:case L:case P:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),l==M&&r.setTagName(t.slice(e,u)),u;case">":switch(l){case M:r.setTagName(t.slice(e,u));case D:case F:case j:break;case R:case L:"/"===(p=t.slice(e,u)).slice(-1)&&(r.closed=!0,p=p.slice(0,-1));case P:l===P&&(p=a),l==R?(o.warning('attribute "'+p+'" missed quot(")!'),s(a,p,e)):(A.isHTML(n[""])&&p.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+p+'" missed value!! "'+p+'" instead!!'),s(p,p,e));break;case T:throw new Error("attribute value missed!!")}return u;case"Â":c=" ";default:if(c<=" ")switch(l){case M:r.setTagName(t.slice(e,u)),l=F;break;case L:a=t.slice(e,u),l=P;break;case R:var p=t.slice(e,u);o.warning('attribute "'+p+'" missed quot(")!!'),s(a,p,e);case D:l=F}else switch(l){case P:r.tagName;A.isHTML(n[""])&&a.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),s(a,a,e),e=u,l=L;break;case D:o.warning('attribute space is required"'+a+'"!!');case F:l=L,e=u;break;case T:l=R,e=u;break;case j:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}(n,m,S,I,s,o),N=S.length;if(!S.closed&&function(t,e,n,r){var i=r[n];null==i&&((i=t.lastIndexOf("</"+n+">"))<e&&(i=t.lastIndexOf("</"+n)),r[n]=i);return i<e}(n,v,S.tagName,f)&&(S.closed=!0,r.nbsp||o.warning("unclosed xml attribute")),p&&N){for(var O=B(p,{}),C=0;C<N;C++){var k=S[C];a(k.offset),k.locator=B(p,{})}i.locator=O,G(S,i,I)&&h.push(S),i.locator=p}else G(S,i,I)&&h.push(S);A.isHTML(S.uri)&&!S.closed?v=function(t,e,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var o=t.indexOf("</"+n+">",e),t=t.substring(e+1,o);if(/[&<]/.test(t))return/^script$/i.test(n)?i.characters(t,0,t.length):(t=t.replace(/&#?\w+;/g,r),i.characters(t,0,t.length)),o}return e+1}(n,v,S.tagName,s,i):v++}}catch(t){if(t instanceof q)throw t;o.error("element parse error: "+t),v=-1}d<v?d=v:e(Math.max(m,d)+1)}}(t,e,n,r,this.errorHandler),r.endDocument()}},z.prototype={setTagName:function(t){if(!i.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,n){if(!i.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:n}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}},n.XMLReader=o,n.ParseError=q},{"./conventions":47}],53:[function(t,n,r){!function(fe,de){!function(){var t,e;t=this,e=function(t){"use strict";function D(r){for(var t=arguments.length,i=new Array(1<t?t-1:0),e=1;e<t;e++)i[e-1]=arguments[e];return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.apply(void 0,i.concat(e))}}function c(i){return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.pop();return i.call(this,e,r)}}var F="function"==typeof queueMicrotask&&queueMicrotask,e="function"==typeof de&&de,n="object"===_typeof3(fe)&&"function"==typeof fe.nextTick;function j(t){setTimeout(t,0)}function q(i){return function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return i(function(){return t.apply(void 0,n)})}}var y=q(F?queueMicrotask:e?de:n?fe.nextTick:j);function r(i){return u(i)?function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.pop();return B(i.apply(this,e),r)}:c(function(t,e){var n;try{n=i.apply(this,t)}catch(t){return e(t)}if(n&&"function"==typeof n.then)return B(n,e);e(null,n)})}function B(t,e){return t.then(function(t){G(e,null,t)},function(t){G(e,t&&t.message?t:new Error(t))})}function G(t,e,n){try{t(e,n)}catch(t){y(function(t){throw t},t)}}function u(t){return"AsyncFunction"===t[Symbol.toStringTag]}function m(t){if("function"!=typeof t)throw new Error("expected a function");return u(t)?r(t):t}function o(s,t){var a=1<arguments.length&&void 0!==t?t:s.length;if(a)return function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return"function"==typeof n[a-1]?s.apply(this,n):new Promise(function(i,o){n[a-1]=function(t){if(t)return o(t);for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i(1<n.length?n:n[0])},s.apply(t,n)})};throw new Error("arity is undefined")}function z(i){return function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o(function(t){var n=this;return i(e,function(t,e){m(t).apply(n,r.concat(e))},t)})}}function U(t,e,n,r){e=e||[];var i=[],o=0,s=m(n);return t(e,function(t,e,n){var r=o++;s(t,function(t,e){i[r]=e,n(t)})},function(t){r(t,i)})}function p(t){return t&&"number"==typeof t.length&&0<=t.length&&t.length%1==0}var h={};function v(i){function t(){if(null!==i){var t=i;i=null;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(this,n)}}return Object.assign(t,i),t}function V(t){var e,n,r,i,o,s,a,u,l,c;return p(t)?(n=-1,r=(e=t).length,function(){return++n<r?{value:e[n],key:n}:null}):(i=(i=t)[Symbol.iterator]&&i[Symbol.iterator]())?(l=i,c=-1,function(){var t=l.next();return t.done?null:(c++,{value:t.value,key:c})}):(s=(o=t)?Object.keys(o):[],a=-1,u=s.length,function t(){var e=s[++a];return"__proto__"===e?t():a<u?{value:o[e],key:e}:null})}function _(i){return function(){if(null===i)throw new Error("Callback was already called.");var t=i;i=null;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(this,n)}}function $(t,e,n,r){var i=!1,o=!1,s=!1,a=0,u=0;function l(){e<=a||s||i||(s=!0,t.next().then(function(t){var e=t.value,t=t.done;o||i||(s=!1,t?(i=!0,a<=0&&r(null)):(a++,n(e,u,c),u++,l()))}).catch(p))}function c(t,e){if(--a,!o)return t?p(t):!1!==t?e===h||i&&a<=0?(i=!0,r(null)):void l():void(o=i=!0)}function p(t){o||(i=!(s=!1),r(t))}l()}function s(c){return function(t,e,n){if(n=v(n),c<=0)throw new RangeError("concurrency limit cannot be less than 1");var r,i,o,s,a;return t?"AsyncGenerator"===t[Symbol.toStringTag]?$(t,c,e,n):"function"==typeof t[Symbol.asyncIterator]?$(t[Symbol.asyncIterator](),c,e,n):(r=V(t),s=0,a=o=i=!1,void l()):n(null);function u(t,e){if(!o)if(--s,t)i=!0,n(t);else if(!1===t)o=i=!0;else{if(e===h||i&&s<=0)return i=!0,n(null);a||l()}}function l(){for(a=!0;s<c&&!i;){var t=r();if(null===t)return i=!0,void(s<=0&&n(null));s+=1,e(t.value,t.key,_(u))}a=!1}}}var i=o(function(t,e,n,r){return s(e)(t,m(n),r)},4);function X(t,e,n){n=v(n);var r=0,i=0,o=t.length,s=!1;function a(t,e){!0!==(s=!1===t||s)&&(t?n(t):++i!==o&&e!==h||n(null))}for(0===o&&n(null);r<o;r++)e(t[r],r,_(a))}function Y(t,e,n){return i(t,1/0,e,n)}var a=o(function(t,e,n){return(p(t)?X:Y)(t,m(e),n)},3);var l=o(function(t,e,n){return U(a,t,e,n)},3),F=z(l);var f=o(function(t,e,n){return i(t,1,e,n)},3);var J=o(function(t,e,n){return U(f,t,e,n)},3),W=z(J),b=Symbol("promiseCallback");function x(){var i,o;function t(t){if(t)return o(t);for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i(1<n.length?n:n[0])}return t[b]=new Promise(function(t,e){i=t,o=e}),t}function H(a,t,s){"number"!=typeof t&&(s=t,t=null),s=v(s||x());var e=Object.keys(a).length;if(!e)return s(null);t=t||e;var u={},l=0,c=!1,p=!1,h=Object.create(null),n=[],f=[],d={};Object.keys(a).forEach(function(r){var i,o,s=a[r];Array.isArray(s)?(i=s.slice(0,s.length-1),0===(o=i.length)?(y(r,s),f.push(r)):(d[r]=o,i.forEach(function(t){if(!a[t])throw new Error("async.auto task `"+r+"` has a non-existent dependency `"+t+"` in "+i.join(", "));var e=function(){0===--o&&y(r,s)},n=h[t];(n=n||(h[t]=[])).push(e)}))):(y(r,[s]),f.push(r))});for(var r,i=0;f.length;)r=f.pop(),i++,!function(n){var r=[];return Object.keys(a).forEach(function(t){var e=a[t];Array.isArray(e)&&0<=e.indexOf(n)&&r.push(t)}),r}(r).forEach(function(t){0==--d[t]&&f.push(t)});if(i!==e)throw new Error("async.auto cannot execute tasks due to a recursive dependency");function y(r,i){n.push(function(){var o,t,e,n;o=r,t=i,p||(e=_(function(t){for(var e,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];l--,!1===t?c=!0:(r.length<2&&(r=_slicedToArray(r,1)[0]),t?(e={},Object.keys(u).forEach(function(t){e[t]=u[t]}),e[o]=r,p=!0,h=Object.create(null),c||s(t,e)):(u[o]=r,(h[o]||[]).forEach(function(t){return t()}),g()))}),l++,n=m(t[t.length-1]),1<t.length?n(u,e):n(e))})}function g(){if(!c){if(0===n.length&&0===l)return s(null,u);for(;n.length&&l<t;)n.shift()()}}return g(),s[b]}var K=/^(?:async\s+)?(?:function)?\s*\w*\s*\(\s*([^)]+)\s*\)(?:\s*{)/,Q=/^(?:async\s+)?\(?\s*([^)=]+)\s*\)?(?:\s*=>)/,Z=/,/,tt=/(=.+)?(\s*)$/;function et(t){var t=function(t){for(var e,n="",r=0,i=t.indexOf("*/");r<t.length;)"/"===t[r]&&"/"===t[r+1]?r=-1===(e=t.indexOf("\n",r))?t.length:e:-1!==i&&"/"===t[r]&&"*"===t[r+1]&&-1!==(e=t.indexOf("*/",r))?i=t.indexOf("*/",r=e+2):(n+=t[r],r++);return n}(t.toString()),e=(e=t.match(K))||t.match(Q);if(e)return _slicedToArray(e,2)[1].replace(/\s/g,"").split(Z).map(function(t){return t.replace(tt,"").trim()});throw new Error("could not parse args in autoInject\nSource:\n"+t)}function nt(s,t){var a={};return Object.keys(s).forEach(function(t){var r,i=s[t],e=u(i),n=!e&&1===i.length||e&&0===i.length;if(Array.isArray(i))r=_toConsumableArray3(i),i=r.pop(),a[t]=r.concat(0<r.length?o:i);else if(n)a[t]=i;else{if(r=et(i),0===i.length&&!e&&0===r.length)throw new Error("autoInject task functions require explicit parameters.");e||r.pop(),a[t]=r.concat(o)}function o(e,t){var n=r.map(function(t){return e[t]});n.push(t),m(i).apply(void 0,_toConsumableArray3(n))}}),H(a,t)}var rt=function(){function t(){_classCallCheck2(this,t),this.head=this.tail=null,this.length=0}return _createClass2(t,[{key:"removeLink",value:function(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,--this.length,t}},{key:"empty",value:function(){for(;this.head;)this.shift();return this}},{key:"insertAfter",value:function(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1}},{key:"insertBefore",value:function(t,e){e.prev=t.prev,(e.next=t).prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1}},{key:"unshift",value:function(t){this.head?this.insertBefore(this.head,t):it(this,t)}},{key:"push",value:function(t){this.tail?this.insertAfter(this.tail,t):it(this,t)}},{key:"shift",value:function(){return this.head&&this.removeLink(this.head)}},{key:"pop",value:function(){return this.tail&&this.removeLink(this.tail)}},{key:"toArray",value:function(){return _toConsumableArray3(this)}},{key:Symbol.iterator,value:_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.head;case 1:if(e)return t.next=4,e.data;t.next=7;break;case 4:e=e.next,t.next=1;break;case 7:case"end":return t.stop()}},t,this)})},{key:"remove",value:function(t){for(var e=this.head;e;){var n=e.next;t(e)&&this.removeLink(e),e=n}return this}}]),t}();function it(t,e){t.length=1,t.head=t.tail=e}function ot(t,e,n){if(null==e)e=1;else if(0===e)throw new RangeError("Concurrency must not be zero");var s=m(t),l=0,c=[],a={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function u(t,e){return t?e?void(a[t]=a[t].filter(function(t){return t!==e})):a[t]=[]:Object.keys(a).forEach(function(t){return a[t]=[]})}function p(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];a[t].forEach(function(t){return t.apply(void 0,n)})}var h=!1;function r(t,e,i,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");var o,s;function r(t){if(t)return i?s(t):o();for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(n.length<=1)return o(n[0]);o(n)}d.started=!0;t=d._createTaskItem(t,!i&&n||r);if(e?d._tasks.unshift(t):d._tasks.push(t),h||(h=!0,y(function(){h=!1,d.process()})),i||!n)return new Promise(function(t,e){o=t,s=e})}function i(t){return 0===t.length&&d.idle()&&(y(function(){return p("drain")}),1)}function o(o){return function(t){if(!t)return new Promise(function(n,r){var e,i;i=function(t,e){if(t)return r(t);n(e)},a[e=o].push(function t(){u(e,t),i.apply(void 0,arguments)})});u(o),a[o].push(t)}}var f=!1,d=(_defineProperty3(t={_tasks:new rt,_createTaskItem:function(t,e){return{data:t,callback:e}}},Symbol.iterator,_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(d._tasks[Symbol.iterator](),"t0",1);case 1:case"end":return t.stop()}},t)})),_defineProperty3(t,"concurrency",e),_defineProperty3(t,"payload",n),_defineProperty3(t,"buffer",e/4),_defineProperty3(t,"started",!1),_defineProperty3(t,"paused",!1),_defineProperty3(t,"push",function(t,e){return Array.isArray(t)?i(t)?void 0:t.map(function(t){return r(t,!1,!1,e)}):r(t,!1,!1,e)}),_defineProperty3(t,"pushAsync",function(t,e){return Array.isArray(t)?i(t)?void 0:t.map(function(t){return r(t,!1,!0,e)}):r(t,!1,!0,e)}),_defineProperty3(t,"kill",function(){u(),d._tasks.empty()}),_defineProperty3(t,"unshift",function(t,e){return Array.isArray(t)?i(t)?void 0:t.map(function(t){return r(t,!0,!1,e)}):r(t,!0,!1,e)}),_defineProperty3(t,"unshiftAsync",function(t,e){return Array.isArray(t)?i(t)?void 0:t.map(function(t){return r(t,!0,!0,e)}):r(t,!0,!0,e)}),_defineProperty3(t,"remove",function(t){d._tasks.remove(t)}),_defineProperty3(t,"process",function(){if(!f){for(f=!0;!d.paused&&l<d.concurrency&&d._tasks.length;){var t=[],e=[],n=d._tasks.length;d.payload&&(n=Math.min(n,d.payload));for(var r=0;r<n;r++){var i=d._tasks.shift();t.push(i),c.push(i),e.push(i.data)}l+=1,0===d._tasks.length&&p("empty"),l===d.concurrency&&p("saturated");var o=_(function(u){return function(t){--l;for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,o=u.length;i<o;i++){var s=u[i],a=c.indexOf(s);0===a?c.shift():0<a&&c.splice(a,1),s.callback.apply(s,[t].concat(n)),null!=t&&p("error",t,s.data)}l<=d.concurrency-d.buffer&&p("unsaturated"),d.idle()&&p("drain"),d.process()}}(t));s(e,o)}f=!1}}),_defineProperty3(t,"length",function(){return d._tasks.length}),_defineProperty3(t,"running",function(){return l}),_defineProperty3(t,"workersList",function(){return c}),_defineProperty3(t,"idle",function(){return d._tasks.length+l===0}),_defineProperty3(t,"pause",function(){d.paused=!0}),_defineProperty3(t,"resume",function(){!1!==d.paused&&(d.paused=!1,y(d.process))}),t);return Object.defineProperties(d,{saturated:{writable:!1,value:o("saturated")},unsaturated:{writable:!1,value:o("unsaturated")},empty:{writable:!1,value:o("empty")},drain:{writable:!1,value:o("drain")},error:{writable:!1,value:o("error")}}),d}function st(t,e){return ot(t,1,e)}function at(t,e,n){return ot(t,e,n)}var d=o(function(t,r,e,n){n=v(n);var i=m(e);return f(t,function(t,e,n){i(r,t,function(t,e){r=e,n(t)})},function(t){return n(t,r)})},4);function ut(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e.map(m);return function(){for(var n=this,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=e[e.length-1];return"function"==typeof i?e.pop():i=x(),d(o,e,function(t,e,i){e.apply(n,t.concat(function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i(t,n)}))},function(t,e){return i.apply(void 0,[t].concat(_toConsumableArray3(e)))}),i[b]}}function lt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return ut.apply(void 0,_toConsumableArray3(e.reverse()))}var g=o(function(t,e,n,r){return U(s(e),t,n,r)},4);var w=o(function(t,e,n,i){var r=m(n);return g(t,e,function(t,i){r(t,function(t){if(t)return i(t);for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return i(t,n)})},function(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&(n=n.concat.apply(n,_toConsumableArray3(e[r])));return i(t,n)})},4);var E=o(function(t,e,n){return w(t,1/0,e,n)},3);var S=o(function(t,e,n){return w(t,1,e,n)},3);function ct(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.pop().apply(void 0,[null].concat(r))}}function I(a,u){return function(t,e,n,r){var i,o=!1,s=m(n);t(e,function(n,t,r){s(n,function(t,e){return t||!1===t?r(t):a(e)&&!i?(i=u(o=!0,n),r(null,h)):void r()})},function(t){if(t)return r(t);r(null,o?i:u(!1))})}}var N=o(function(t,e,n){return I(function(t){return t},function(t,e){return e})(a,t,e,n)},3);var O=o(function(t,e,n,r){return I(function(t){return t},function(t,e){return e})(s(e),t,n,r)},4);var C=o(function(t,e,n){return I(function(t){return t},function(t,e){return e})(s(1),t,e,n)},3);function pt(i){return function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return m(t).apply(void 0,n.concat([function(t){if("object"===("undefined"==typeof console?"undefined":_typeof3(console)))if(t)console.error&&console.error(t);else if(console[i]){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];n.forEach(function(t){return console[i](t)})}}]))}}var ht=pt("dir");var k=o(function(t,e,i){i=_(i);var o,n=m(t),s=m(e);function r(t){if(t)return i(t);if(!1!==t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];o=n,s.apply(void 0,n.concat([a]))}}function a(t,e){return t?i(t):!1!==t?e?void n(r):i.apply(void 0,[null].concat(_toConsumableArray3(o))):void 0}return a(null,!0)},3);function ft(t,e,n){var i=m(e);return k(t,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.pop();i.apply(void 0,e.concat([function(t,e){return r(t,!e)}]))},n)}function dt(r){return function(t,e,n){return r(t,n)}}var A=o(function(t,e,n){return a(t,dt(m(e)),n)},3);var M=o(function(t,e,n,r){return s(e)(t,dt(m(n)),r)},4);var L=o(function(t,e,n){return M(t,1,e,n)},3);function yt(o){return u(o)?o:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.pop(),i=!0;e.push(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];i?y(function(){return r.apply(void 0,e)}):r.apply(void 0,e)}),o.apply(this,e),i=!1}}var P=o(function(t,e,n){return I(function(t){return!t},function(t){return!t})(a,t,e,n)},3);var T=o(function(t,e,n,r){return I(function(t){return!t},function(t){return!t})(s(e),t,n,r)},4);var gt=o(function(t,e,n){return I(function(t){return!t},function(t){return!t})(f,t,e,n)},3);function mt(t,r,e,i){var o=new Array(r.length);t(r,function(t,n,r){e(t,function(t,e){o[n]=!!e,r(t)})},function(t){if(t)return i(t);for(var e=[],n=0;n<r.length;n++)o[n]&&e.push(r[n]);i(null,e)})}function vt(t,e,o,n){var s=[];t(e,function(n,r,i){o(n,function(t,e){if(t)return i(t);e&&s.push({index:r,value:n}),i(t)})},function(t){if(t)return n(t);n(null,s.sort(function(t,e){return t.index-e.index}).map(function(t){return t.value}))})}function _t(t,e,n,r){return(p(e)?mt:vt)(t,e,m(n),r)}var bt=o(function(t,e,n){return _t(a,t,e,n)},3);var xt=o(function(t,e,n,r){return _t(s(e),t,n,r)},4);var wt=o(function(t,e,n){return _t(f,t,e,n)},3);var Et=o(function(t,e){var n=_(e),r=m(yt(t));return function t(e){if(e)return n(e);!1!==e&&r(t)}()},2);var St=o(function(t,e,n,a){var i=m(n);return g(t,e,function(n,r){i(n,function(t,e){return t?r(t):r(t,{key:e,val:n})})},function(t,e){for(var n,r,i={},o=Object.prototype.hasOwnProperty,s=0;s<e.length;s++)e[s]&&(n=e[s].key,r=e[s].val,o.call(i,n)?i[n].push(r):i[n]=[r]);return a(t,i)})},4);function It(t,e,n){return St(t,1/0,e,n)}function Nt(t,e,n){return St(t,1,e,n)}var Ot=pt("log");var Ct=o(function(t,e,n,r){r=v(r);var i={},o=m(n);return s(e)(t,function(t,n,r){o(t,n,function(t,e){if(t)return r(t);i[n]=e,r(t)})},function(t){return r(t,i)})},4);function kt(t,e,n){return Ct(t,1/0,e,n)}function At(t,e,n){return Ct(t,1,e,n)}function Mt(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(t){return t},u=Object.create(null),l=Object.create(null),r=m(t),e=c(function(t,e){var a=n.apply(void 0,_toConsumableArray3(t));a in u?y(function(){return e.apply(void 0,[null].concat(_toConsumableArray3(u[a])))}):a in l?l[a].push(e):(l[a]=[e],r.apply(void 0,_toConsumableArray3(t).concat([function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t||(u[a]=n);var i=l[a];delete l[a];for(var o=0,s=i.length;o<s;o++)i[o].apply(i,[t].concat(n))}])))});return e.memo=u,e.unmemoized=t,e}var n=q(n?fe.nextTick:e?de:j),Lt=o(function(t,e,n){var s=p(e)?[]:{};t(e,function(t,i,o){m(t)(function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];n.length<2&&(n=_slicedToArray(n,1)[0]),s[i]=n,o(t)})},function(t){return n(t,s)})},3);function Pt(t,e){return Lt(a,t,e)}function Tt(t,e,n){return Lt(s(e),t,n)}function Rt(t,e){var n=m(t);return ot(function(t,e){n(t[0],e)},e,1)}var Dt=function(){function t(){_classCallCheck2(this,t),this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}return _createClass2(t,[{key:"length",get:function(){return this.heap.length}},{key:"empty",value:function(){return this.heap=[],this}},{key:"percUp",value:function(t){for(var e;0<t&&jt(this.heap[t],this.heap[e=Ft(t)]);){var n=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=n,t=e}}},{key:"percDown",value:function(t){for(var e;(e=1+(t<<1))<this.heap.length&&(e+1<this.heap.length&&jt(this.heap[e+1],this.heap[e])&&(e+=1),!jt(this.heap[t],this.heap[e]));){var n=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=n,t=e}}},{key:"push",value:function(t){t.pushCount=++this.pushCount,this.heap.push(t),this.percUp(this.heap.length-1)}},{key:"unshift",value:function(t){return this.heap.push(t)}},{key:"shift",value:function(){var t=_slicedToArray(this.heap,1)[0];return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),t}},{key:"toArray",value:function(){return _toConsumableArray3(this)}},{key:Symbol.iterator,value:_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(e<this.heap.length)return t.next=4,this.heap[e].data;t.next=7;break;case 4:e++,t.next=1;break;case 7:case"end":return t.stop()}},t,this)})},{key:"remove",value:function(t){for(var e=0,n=0;n<this.heap.length;n++)t(this.heap[n])||(this.heap[e]=this.heap[n],e++);this.heap.splice(e);for(var r=Ft(this.heap.length-1);0<=r;r--)this.percDown(r);return this}}]),t}();function Ft(t){return(t+1>>1)-1}function jt(t,e){return t.priority!==e.priority?t.priority<e.priority:t.pushCount<e.pushCount}function qt(t,e){var t=Rt(t,e),r=t.push,i=t.pushAsync;function o(t,e){return Array.isArray(t)?t.map(function(t){return{data:t,priority:e}}):{data:t,priority:e}}return t._tasks=new Dt,t._createTaskItem=function(t,e){return{data:t.data,priority:t.priority,callback:e}},t.push=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length?arguments[2]:void 0;return r(o(t,e),n)},t.pushAsync=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length?arguments[2]:void 0;return i(o(t,e),n)},delete t.unshift,delete t.unshiftAsync,t}e=o(function(t,e){if(e=v(e),!Array.isArray(t))return e(new TypeError("First argument to race must be an array of functions"));if(!t.length)return e();for(var n=0,r=t.length;n<r;n++)m(t[n])(e)},2);function Bt(t,e,n,r){t=_toConsumableArray3(t).reverse();return d(t,e,n,r)}function Gt(t){var e=m(t);return c(function(t,o){return t.push(function(t){var e={};t&&(e.error=t);for(var n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];0<r.length&&((t=r).length<=1&&(t=r[0]),e.value=t),o(null,e)}),e.apply(this,t)})}function zt(e){var n,r=this;return Array.isArray(e)?n=e.map(Gt):(n={},Object.keys(e).forEach(function(t){n[t]=Gt.call(r,e[t])})),n}function Ut(t,e,n,r){var i=m(n);return _t(t,e,function(t,n){i(t,function(t,e){n(t,!e)})},r)}var Vt=o(function(t,e,n){return Ut(a,t,e,n)},3);var $t=o(function(t,e,n,r){return Ut(s(e),t,n,r)},4);var Xt=o(function(t,e,n){return Ut(f,t,e,n)},3);function Yt(t){return function(){return t}}var Jt=5,Wt=0;function Ht(t,e,o){var s={times:Jt,intervalFunc:Yt(Wt)};if(arguments.length<3&&"function"==typeof t)o=e||x(),e=t;else{var n=s;if("object"===_typeof3(t))n.times=+t.times||Jt,n.intervalFunc="function"==typeof t.interval?t.interval:Yt(+t.interval||Wt),n.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");n.times=+t||Jt}o=o||x()}if("function"!=typeof e)throw new Error("Invalid arguments for async.retry");var r=m(e),a=1;return function i(){r(function(t){if(!1!==t)if(t&&a++<s.times&&("function"!=typeof s.errorFilter||s.errorFilter(t)))setTimeout(i,s.intervalFunc(a-1));else{for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];o.apply(void 0,[t].concat(n))}})}(),o[b]}function Kt(r,t){t||(t=r,r=null);var i=r&&r.arity||t.length,o=(u(t)&&(i+=1),m(t));return c(function(e,t){function n(t){o.apply(void 0,_toConsumableArray3(e).concat([t]))}return(e.length<i-1||null==t)&&(e.push(t),t=x()),r?Ht(r,n,t):Ht(n,t),t[b]})}function Qt(t,e){return Lt(f,t,e)}var Zt=o(function(t,e,n){return I(Boolean,function(t){return t})(a,t,e,n)},3);var te=o(function(t,e,n,r){return I(Boolean,function(t){return t})(s(e),t,n,r)},4);var ee=o(function(t,e,n){return I(Boolean,function(t){return t})(f,t,e,n)},3);var ne=o(function(t,e,n){var i=m(e);return l(t,function(n,r){i(n,function(t,e){if(t)return r(t);r(t,{value:n,criteria:e})})},function(t,e){if(t)return n(t);n(null,e.sort(r).map(function(t){return t.value}))});function r(t,e){t=t.criteria,e=e.criteria;return t<e?-1:e<t?1:0}},3);function re(i,o,s){var a=m(i);return c(function(t,e){var n,r=!1;t.push(function(){r||(e.apply(void 0,arguments),clearTimeout(n))}),n=setTimeout(function(){var t=i.name||"anonymous";(t=new Error('Callback function "'+t+'" timed out.')).code="ETIMEDOUT",s&&(t.info=s),r=!0,e(t)},o),a.apply(void 0,_toConsumableArray3(t))})}function ie(t,e,n,r){n=m(n);return g(function(t){for(var e=Array(t);t--;)e[t]=t;return e}(t),e,n,r)}function oe(t,e,n){return ie(t,1/0,e,n)}function se(t,e,n){return ie(t,1,e,n)}function ae(t,r,e,n){arguments.length<=3&&"function"==typeof r&&(n=e,e=r,r=Array.isArray(t)?[]:{}),n=v(n||x());var i=m(e);return a(t,function(t,e,n){i(r,t,e,n)},function(t){return n(t,r)}),n[b]}var ue=o(function(t,e){var o,s=null;return L(t,function(t,i){m(t)(function(t){if(!1===t)return i(t);for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];o=n.length<2?n[0]:n,i((s=t)?null:{})})},function(){return e(s,o)})});function le(t){return function(){return(t.unmemoized||t).apply(void 0,arguments)}}var R=o(function(t,e,i){i=_(i);var n=m(e),o=m(t),s=[];function r(t){if(t)return i(t);for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];s=n,!1!==t&&o(a)}function a(t,e){return t?i(t):!1!==t?e?void n(r):i.apply(void 0,[null].concat(_toConsumableArray3(s))):void 0}return o(a)},3);function ce(t,e,n){var r=m(t);return R(function(n){return r(function(t,e){return n(t,!e)})},e,n)}var pe=o(function(i,o){var s;return o=v(o),Array.isArray(i)?i.length?(s=0,void a([])):o():o(new Error("First argument to waterfall must be an array of functions"));function a(t){m(i[s++]).apply(void 0,_toConsumableArray3(t).concat([_(e)]))}function e(t){if(!1!==t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(t||s===i.length)return o.apply(void 0,[t].concat(n));a(n)}}}),he={apply:D,applyEach:F,applyEachSeries:W,asyncify:r,auto:H,autoInject:nt,cargo:st,cargoQueue:at,compose:lt,concat:E,concatLimit:w,concatSeries:S,constant:ct,detect:N,detectLimit:O,detectSeries:C,dir:ht,doUntil:ft,doWhilst:k,each:A,eachLimit:M,eachOf:a,eachOfLimit:i,eachOfSeries:f,eachSeries:L,ensureAsync:yt,every:P,everyLimit:T,everySeries:gt,filter:bt,filterLimit:xt,filterSeries:wt,forever:Et,groupBy:It,groupByLimit:St,groupBySeries:Nt,log:Ot,map:l,mapLimit:g,mapSeries:J,mapValues:kt,mapValuesLimit:Ct,mapValuesSeries:At,memoize:Mt,nextTick:n,parallel:Pt,parallelLimit:Tt,priorityQueue:qt,queue:Rt,race:e,reduce:d,reduceRight:Bt,reflect:Gt,reflectAll:zt,reject:Vt,rejectLimit:$t,rejectSeries:Xt,retry:Ht,retryable:Kt,seq:ut,series:Qt,setImmediate:y,some:Zt,someLimit:te,someSeries:ee,sortBy:ne,timeout:re,times:oe,timesLimit:ie,timesSeries:se,transform:ae,tryEach:ue,unmemoize:le,until:ce,waterfall:pe,whilst:R,all:P,allLimit:T,allSeries:gt,any:Zt,anyLimit:te,anySeries:ee,find:N,findLimit:O,findSeries:C,flatMap:E,flatMapLimit:w,flatMapSeries:S,forEach:A,forEachSeries:L,forEachLimit:M,forEachOf:a,forEachOfSeries:f,forEachOfLimit:i,inject:d,foldl:d,foldr:Bt,select:bt,selectLimit:xt,selectSeries:wt,wrapSync:r,during:R,doDuring:k};t.default=he,t.apply=D,t.applyEach=F,t.applyEachSeries=W,t.asyncify=r,t.auto=H,t.autoInject=nt,t.cargo=st,t.cargoQueue=at,t.compose=lt,t.concat=E,t.concatLimit=w,t.concatSeries=S,t.constant=ct,t.detect=N,t.detectLimit=O,t.detectSeries=C,t.dir=ht,t.doUntil=ft,t.doWhilst=k,t.each=A,t.eachLimit=M,t.eachOf=a,t.eachOfLimit=i,t.eachOfSeries=f,t.eachSeries=L,t.ensureAsync=yt,t.every=P,t.everyLimit=T,t.everySeries=gt,t.filter=bt,t.filterLimit=xt,t.filterSeries=wt,t.forever=Et,t.groupBy=It,t.groupByLimit=St,t.groupBySeries=Nt,t.log=Ot,t.map=l,t.mapLimit=g,t.mapSeries=J,t.mapValues=kt,t.mapValuesLimit=Ct,t.mapValuesSeries=At,t.memoize=Mt,t.nextTick=n,t.parallel=Pt,t.parallelLimit=Tt,t.priorityQueue=qt,t.queue=Rt,t.race=e,t.reduce=d,t.reduceRight=Bt,t.reflect=Gt,t.reflectAll=zt,t.reject=Vt,t.rejectLimit=$t,t.rejectSeries=Xt,t.retry=Ht,t.retryable=Kt,t.seq=ut,t.series=Qt,t.setImmediate=y,t.some=Zt,t.someLimit=te,t.someSeries=ee,t.sortBy=ne,t.timeout=re,t.times=oe,t.timesLimit=ie,t.timesSeries=se,t.transform=ae,t.tryEach=ue,t.unmemoize=le,t.until=ce,t.waterfall=pe,t.whilst=R,t.all=P,t.allLimit=T,t.allSeries=gt,t.any=Zt,t.anyLimit=te,t.anySeries=ee,t.find=N,t.findLimit=O,t.findSeries=C,t.flatMap=E,t.flatMapLimit=w,t.flatMapSeries=S,t.forEach=A,t.forEachSeries=L,t.forEachLimit=M,t.forEachOf=a,t.forEachOfSeries=f,t.forEachOfLimit=i,t.inject=d,t.foldl=d,t.foldr=Bt,t.select=bt,t.selectLimit=xt,t.selectSeries=wt,t.wrapSync=r,t.during=R,t.doDuring=k,Object.defineProperty(t,"__esModule",{value:!0})},"object"===_typeof3(r)&&void 0!==n?e(r):"function"==typeof define&&define.amd?define(["exports"],e):e(t.async={})}.call(this)}.call(this,t("_process"),t("timers").setImmediate)},{_process:283,timers:286}],54:[function(t,e,n){"use strict";var l=t("geojson-bounds"),r=t("haversine");function c(e){var t,n,r,i=this;if(null==e)this.minlat=-90,this.minlon=-180,this.maxlat=90,this.maxlon=180;else if("function"==typeof e.getSouthWest&&(n=e.getSouthWest().wrap(),r=e.getNorthEast().wrap(),e={minlat:n.lat,minlon:n.lng,maxlat:r.lat,maxlon:r.lng}),"Feature"===e.type)r=(n="GeometryCollection"===e.geometry.type?e.geometry.geometries.map(function(t){t=new c({type:"Feature",geometry:t});return[t.minlon,t.minlat,t.maxlon,t.maxlat]}):["MultiPoint","MultiPolygon","MultiLineString"].includes(e.geometry.type)?e.geometry.coordinates.map(function(t){return l.extent({type:"Feature",geometry:{type:e.geometry.type.substr(5),coordinates:t}})}):[l.extent(e)]).shift(),this.minlat=r[1],this.minlon=r[0],this.maxlat=r[3],this.maxlon=r[2],n.forEach(function(t){return i.extend({minlat:t[1],minlon:t[0],maxlat:t[3],maxlon:t[2]})}),this._wrap();else if("FeatureCollection"===e.type){if(0!==e.features.length){for(var o=new c(e.features[0]),s=1;s<e.features.length;s++)o.extend(e.features[s]);this.minlat=o.minlat,this.minlon=o.minlon,this.maxlat=o.maxlat,this.maxlon=o.maxlon}}else{(e="bounds"in e?e.bounds:e).lat&&(this.minlat=+e.lat,this.maxlat=+e.lat),e.lon&&(this.minlon=+e.lon,this.maxlon=+e.lon),e.latitude&&(this.minlat=+e.latitude,this.maxlat=+e.latitude,this.minlon=+e.longitude,this.maxlon=+e.longitude),Array.isArray(e)&&(this.minlat=+e[0],this.maxlat=+e[0],this.minlon=+e[1],this.maxlon=+e[1]),e.lng&&(this.minlon=+e.lng,this.maxlon=+e.lng);for(var a=["minlon","minlat","maxlon","maxlat"],u=0;u<a.length;u++)(t=a[u])in e&&(this[t]=e[t]);this._wrap()}}c.prototype.wrapMaxLon=function(){return this.minlon>this.maxlon?this.maxlon+360:this.maxlon},c.prototype.wrapMinLon=function(){return this.minlon>this.maxlon?this.minlon-360:this.minlon},c.prototype._wrap=function(){return(this.minlon<-180||180<this.minlon)&&(this.minlon=(this.minlon+180)%360-180),(this.maxlon<-180||180<this.maxlon)&&(this.maxlon=(this.maxlon+180)%360-180),this},c.prototype.intersects=function(t){return!((t=t instanceof c?t:new c(t)).maxlat<this.minlat||t.minlat>this.maxlat||!(this.wrapMaxLon()>=t.minlon&&this.minlon<=t.wrapMaxLon()||this.maxlon>=t.wrapMinLon()&&this.wrapMinLon()<=t.maxlon))},c.prototype.within=function(t){return!((t=t instanceof c?t:new c(t)).maxlat<this.maxlat||t.minlat>this.minlat||!(this.wrapMinLon()>=t.wrapMinLon()&&this.maxlon<=t.maxlon||this.minlon>=t.minlon&&this.wrapMaxLon()<=t.wrapMaxLon()))},c.prototype.toTile=function(){return new c({minlat:Math.floor(10*this.minlat)/10,minlon:Math.floor(10*this.minlon)/10,maxlat:Math.ceil(10*this.maxlat)/10,maxlon:Math.ceil(10*this.maxlon)/10})},c.prototype.toBBoxString=c.prototype.toLonLatString=function(){return this.minlon+","+this.minlat+","+this.maxlon+","+this.maxlat},c.prototype.toLatLonString=function(){return this.minlat+","+this.minlon+","+this.maxlat+","+this.maxlon},c.prototype.diagonalLength=function(){var t=this.maxlat-this.minlat,e=this.wrapMaxLon()-this.minlon;return Math.sqrt(t*t+e*e)},c.prototype.diagonalDistance=function(){return r({latitude:this.minlat,longitude:this.minlon},{latitude:this.maxlat,longitude:this.maxlon},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},c.prototype.getCenter=function(){var t=this.maxlat-this.minlat,e=this.wrapMaxLon()-this.minlon,e=this.minlon+e/2;return{lat:this.minlat+t/2,lon:e=e<-180||180<e?(e+180)%360-180:e}},c.prototype.getNorth=function(){return this.maxlat},c.prototype.getSouth=function(){return this.minlat},c.prototype.getEast=function(){return this.maxlon},c.prototype.getWest=function(){return this.minlon},c.prototype.extend=function(t){(t=t instanceof c?t:new c(t)).minlat<this.minlat&&(this.minlat=t.minlat),t.maxlat>this.maxlat&&(this.maxlat=t.maxlat);for(var e=-360;e<=360;e+=360)if(t.wrapMaxLon()+e>this.minlon&&t.minlon+e<this.wrapMaxLon())return this.minlon=Math.min(this.minlon,t.minlon+e),this.maxlon=Math.max(this.wrapMaxLon(),t.wrapMaxLon()+e),void this._wrap();var n=Math.min(this.minlon,t.minlon),r=Math.max(this.minlon,t.minlon),i=Math.max(this.wrapMaxLon(),t.wrapMaxLon()),o=Math.min(this.wrapMaxLon(),t.wrapMaxLon());i-n<o-r+360?(this.minlon=n,this.maxlon=i):(this.minlon=r,this.maxlon=o),this._wrap()},c.prototype.toGeoJSON=function(){return this.minlon>this.maxlon?{type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:[[[[this.minlon,this.minlat],[180,this.minlat],[180,this.maxlat],[this.minlon,this.maxlat],[this.minlon,this.minlat]]],[[[-180,this.minlat],[this.maxlon,this.minlat],[this.maxlon,this.maxlat],[-180,this.maxlat],[-180,this.minlat]]]]}}:{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[this.minlon,this.minlat],[this.maxlon,this.minlat],[this.maxlon,this.maxlat],[this.minlon,this.maxlat],[this.minlon,this.minlat]]]}}},c.prototype.toLeaflet=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return"shiftWorld"in t||(t.shiftWorld=[0,0]),L.latLngBounds(L.latLng(this.minlat,this.minlon+(this.minlon<0?t.shiftWorld[0]:t.shiftWorld[1])),L.latLng(this.maxlat,this.maxlon+(this.maxlon<0?t.shiftWorld[0]:t.shiftWorld[1])))},void 0!==e&&e.exports&&(e.exports=c),"undefined"!=typeof window&&(window.BoundingBox=c)},{"geojson-bounds":77,haversine:79}],55:[function(t,e,n){},{}],56:[function(t,e,n){"use strict";function s(t,e){var n=document.head||document.getElementsByTagName("head")[0],r=i[i.length-1];if((e=e||{}).insertAt=e.insertAt||"bottom","top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),i.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}var i=[];e.exports={createLink:function(t,e){var n,r,i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("link");for(n in o.href=t,o.rel="stylesheet",e)e.hasOwnProperty(n)&&(r=e[n],o.setAttribute("data-"+n,r));i.appendChild(o)},createStyle:function(t,e,n){n=n||{};var r,i,o=document.createElement("style");for(r in o.type="text/css",e)e.hasOwnProperty(r)&&(i=e[r],o.setAttribute("data-"+r,i));o.sheet?(o.innerHTML=t,o.sheet.cssText=t,s(o,{insertAt:n.insertAt})):o.styleSheet?(s(o,{insertAt:n.insertAt}),o.styleSheet.cssText=t):(o.appendChild(document.createTextNode(t)),s(o,{insertAt:n.insertAt}))}}},{}],57:[function(t,e,n){arguments[4][55][0].apply(n,arguments)},{dup:55}],58:[function(t,e,n){var a={array:function(r){var i=0,o=0,s=[0,1,3,7,15,31,63,127,255];return function(t){for(var e=0;0<t;){var n=8-i;n<=t?(e=(e<<=n)|s[n]&r[o++],i=0,t-=n):(e=(e<<=t)|(r[o]&s[t]<<8-t-i)>>8-t-i,i+=t,t=0)}return e}},simple:function(t){for(var e,n=a.header(t),r=[],i=0;-1!=(e=a.decompress(t,n))&&(r.push(e),i+=e.byteLength),-1!=e;);for(var o=new Uint8Array(i),i=0,s=0;s<r.length;++s)o.set(e=r[s],i),i+=e.byteLength;return o},header:function(t){if(4348520!=t(24))throw"No magic number found";t=t(8)-48;if(t<1||9<t)throw"Not a BZIP archive";return t},decompress:function(t,D,e){for(var n="",r=0;r<6;r++)n+=t(8).toString(16);if("177245385090"==n)return-1;if("314159265359"!=n)throw"eek not valid bzip data";if(t(32),t(1))throw"unsupported obsolete version";var i=t(24);if(9e5<i)throw"Initial position larger than buffer size";var o=t(16),s=new Uint8Array(256),a=0;for(r=0;r<16;r++)if(o&1<<15-r){var u=t(16);for(h=0;h<16;h++)u&1<<15-h&&(s[a++]=16*r+h)}var l=t(3);if(l<2||6<l)throw"another error";var c=t(15);if(0==c)throw"meh";for(var p=[],r=0;r<l;r++)p[r]=r;for(var F=new Uint8Array(32768),r=0;r<c;r++){for(var h=0;t(1);h++)if(l<=h)throw"whoops another error";var f=p[h];p.splice(h,1),p.splice(0,0,f),F[r]=f}for(var d=a+2,j=[],h=0;h<l;h++){var y=new Uint8Array(258),g=new Uint8Array(21);o=t(5);for(var m,r=0;r<d;r++){for(;;){if(o<1||20<o)throw"I gave up a while ago on writing error messages";if(!t(1))break;t(1)?o--:o++}y[r]=o}for(var v,_=m=y[0],r=1;r<d;r++)y[r]>m?m=y[r]:y[r]<_&&(_=y[r]);(v=j[h]={}).permute=new Uint32Array(258),v.limit=new Uint32Array(21),v.base=new Uint32Array(21),v.minLen=_,v.maxLen=m;for(var b=v.base.subarray(1),x=v.limit.subarray(1),w=0,r=_;r<=m;r++)for(o=0;o<d;o++)y[o]==r&&(v.permute[w++]=o);for(r=_;r<=m;r++)g[r]=x[r]=0;for(r=0;r<d;r++)g[y[r]]++;for(w=o=0,r=_;r<m;r++)w+=g[r],x[r]=w-1,w<<=1,b[r+1]=w-(o+=g[r]);x[m]=w+g[m]-1,b[_]=0}for(var E,S,I=new Uint32Array(256),r=0;r<256;r++)p[r]=r;for(var N=E=d=S=0,O=new Uint32Array(9e5);;){if(!d--){if(d=49,c<=S)throw"meow i'm a kitty, that's an error";b=(v=j[F[S++]]).base.subarray(1),x=v.limit.subarray(1)}for(h=t(r=v.minLen);;){if(r>v.maxLen)throw"rawr i'm a dinosaur";if(h<=x[r])break;r++,h=h<<1|t(1)}if((h-=b[r])<0||258<=h)throw"moo i'm a cow";var C=v.permute[h];if(0==C||1==C)N||(N=1,o=0),o+=0==C?N:2*N,N<<=1;else{if(N){if(9e5<=E+o)throw"Boom.";for(I[f=s[p[N=0]]]+=o;o--;)O[E++]=f}if(a<C)break;if(9e5<=E)throw"I can't think of anything. Error";f=p[r=C-1],p.splice(r,1),p.splice(0,0,f),I[f=s[f]]++,O[E++]=f}}if(i<0||E<=i)throw"I'm a monkey and I'm throwing something at someone, namely you";for(h=0,r=0;r<256;r++)u=h+I[r],I[r]=h,h=u;for(r=0;r<E;r++)O[I[f=255&O[r]]]|=r<<8,I[f]++;var k,A,M,L=0,P=0,T=0,R=(E&&(P=255&(L=O[i]),L>>=8,T=-1),new Uint8Array(9e5)),q=0;for(e=e||1/0;E;){for(E--,A=P,P=255&(L=O[L]),L>>=8,3==T++?(k=P,M=A,P=-1):(k=1,M=P);k--;)if(R[q++]=M,!--e)return R;P!=A&&(T=0)}return R.subarray(0,q)}};e.exports=a},{}],59:[function(t,e,n){"use strict";var s=t("type/value/is"),o=t("type/plain-function/is"),a=t("es5-ext/object/assign"),u=t("es5-ext/object/normalize-options"),l=t("es5-ext/string/#/contains");(e.exports=function(t,e){var n,r,i,o;return arguments.length<2||"string"!=typeof t?(o=e,e=t,t=null):o=arguments[2],s(t)?(n=l.call(t,"c"),r=l.call(t,"e"),i=l.call(t,"w")):r=!(n=i=!0),t={value:e,configurable:n,enumerable:r,writable:i},o?a(u(o),t):t}).gs=function(t,e,n){var r,i;return"string"!=typeof t?(i=n,n=e,e=t,t=null):i=arguments[3],s(e)?o(e)?s(n)?o(n)||(i=n,n=void 0):n=void 0:(i=e,e=n=void 0):e=void 0,t=s(t)?(r=l.call(t,"c"),l.call(t,"e")):!(r=!0),e={get:e,set:n,configurable:r,enumerable:t},i?a(u(i),e):e}},{"es5-ext/object/assign":63,"es5-ext/object/normalize-options":70,"es5-ext/string/#/contains":73,"type/plain-function/is":291,"type/value/is":293}],60:[function(t,e,n){var r,i;r=this,i=function(t){"use strict";function a(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function e(o){var n;return 1===o.length&&(n=o,o=function(t,e){return a(n(t),e)}),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;o(t[i],e)<0?n=1+i:r=i}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;0<o(t[i],e)?r=i:n=1+i}return n}}}var n=e(a),y=n.right,n=n.left;function c(t,e){return[t,e]}function l(t){return null===t?NaN:+t}function r(t,e){var n,r,i=t.length,o=0,s=-1,a=0,u=0;if(null==e)for(;++s<i;)isNaN(n=l(t[s]))||(u+=(r=n-a)*(n-(a+=r/++o)));else for(;++s<i;)isNaN(n=l(e(t[s],s,t)))||(u+=(r=n-a)*(n-(a+=r/++o)));if(1<o)return u/(o-1)}function i(t,e){t=r(t,e);return t&&Math.sqrt(t)}function o(t,e){var n,r,i,o=t.length,s=-1;if(null==e){for(;++s<o;)if(null!=(n=t[s])&&n<=n)for(r=i=n;++s<o;)null!=(n=t[s])&&(n<r&&(r=n),i<n)&&(i=n)}else for(;++s<o;)if(null!=(n=e(t[s],s,t))&&n<=n)for(r=i=n;++s<o;)null!=(n=e(t[s],s,t))&&(n<r&&(r=n),i<n)&&(i=n);return[r,i]}var s=Array.prototype,u=s.slice,p=s.map;function g(t){return function(){return t}}function m(t){return t}function v(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}var h=Math.sqrt(50),f=Math.sqrt(10),d=Math.sqrt(2);function _(t,e,n){e=(e-t)/Math.max(0,n),t=Math.floor(Math.log(e)/Math.LN10),n=e/Math.pow(10,t);return 0<=t?(h<=n?10:f<=n?5:d<=n?2:1)*Math.pow(10,t):-Math.pow(10,-t)/(h<=n?10:f<=n?5:d<=n?2:1)}function b(t,e,n){var n=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),n=n/r;return h<=n?r*=10:f<=n?r*=5:d<=n&&(r*=2),e<t?-r:r}function x(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function w(t,e,n){var r,i;if(null==n&&(n=l),r=t.length)return(e=+e)<=0||r<2?+n(t[0],0,t):1<=e?+n(t[r-1],r-1,t):(r=(r-1)*e,(i=+n(t[e=Math.floor(r)],e,t))+(+n(t[e+1],e+1,t)-i)*(r-e))}function E(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n<=n)for(r=n;++o<i;)null!=(n=t[o])&&n<r&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n<=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&n<r&&(r=n);return r}function S(t){if(!(i=t.length))return[];for(var e=-1,n=E(t,I),r=new Array(n);++e<n;)for(var i,o=-1,s=r[e]=new Array(i);++o<i;)s[o]=t[o][e];return r}function I(t){return t.length}t.bisect=y,t.bisectRight=y,t.bisectLeft=n,t.ascending=a,t.bisector=e,t.cross=function(t,e,n){var r,i,o,s,a=t.length,u=e.length,l=new Array(a*u);for(null==n&&(n=c),r=o=0;r<a;++r)for(s=t[r],i=0;i<u;++i,++o)l[o]=n(s,e[i]);return l},t.descending=function(t,e){return e<t?-1:t<e?1:t<=e?0:NaN},t.deviation=i,t.extent=o,t.histogram=function(){var h=m,f=o,d=x;function e(t){for(var e,n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=h(t[i],i,t);for(var o=f(r),s=o[0],a=o[1],u=d(r,s,a),l=(Array.isArray(u)||(u=b(s,a,u),u=v(Math.ceil(s/u)*u,a,u)),u.length);u[0]<=s;)u.shift(),--l;for(;u[l-1]>a;)u.pop(),--l;var c,p=new Array(l+1);for(i=0;i<=l;++i)(c=p[i]=[]).x0=0<i?u[i-1]:s,c.x1=i<l?u[i]:a;for(i=0;i<n;++i)s<=(e=r[i])&&e<=a&&p[y(u,e,0,l)].push(t[i]);return p}return e.value=function(t){return arguments.length?(h="function"==typeof t?t:g(t),e):h},e.domain=function(t){return arguments.length?(f="function"==typeof t?t:g([t[0],t[1]]),e):f},e.thresholds=function(t){return arguments.length?(d="function"==typeof t?t:Array.isArray(t)?g(u.call(t)):g(t),e):d},e},t.thresholdFreedmanDiaconis=function(t,e,n){return t=p.call(t,l).sort(a),Math.ceil((n-e)/(2*(w(t,.75)-w(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,e,n){return Math.ceil((n-e)/(3.5*i(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=x,t.max=function(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n<=n)for(r=n;++o<i;)null!=(n=t[o])&&r<n&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n<=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&r<n&&(r=n);return r},t.mean=function(t,e){var n,r=t.length,i=r,o=-1,s=0;if(null==e)for(;++o<r;)isNaN(n=l(t[o]))?--i:s+=n;else for(;++o<r;)isNaN(n=l(e(t[o],o,t)))?--i:s+=n;if(i)return s/i},t.median=function(t,e){var n,r=t.length,i=-1,o=[];if(null==e)for(;++i<r;)isNaN(n=l(t[i]))||o.push(n);else for(;++i<r;)isNaN(n=l(e(t[i],i,t)))||o.push(n);return w(o.sort(a),.5)},t.merge=function(t){for(var e,n,r,i=t.length,o=-1,s=0;++o<i;)s+=t[o].length;for(n=new Array(s);0<=--i;)for(e=(r=t[i]).length;0<=--e;)n[--s]=r[e];return n},t.min=E,t.pairs=function(t,e){null==e&&(e=c);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return o},t.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},t.quantile=w,t.range=v,t.scan=function(t,e){if(n=t.length){var n,r,i=0,o=0,s=t[o];for(null==e&&(e=a);++i<n;)(e(r=t[i],s)<0||0!==e(s,s))&&(s=r,o=i);return 0===e(s,s)?o:void 0}},t.shuffle=function(t,e,n){for(var r,i,o=(null==n?t.length:n)-(e=null==e?0:+e);o;)i=Math.random()*o--|0,r=t[o+e],t[o+e]=t[i+e],t[i+e]=r;return t},t.sum=function(t,e){var n,r=t.length,i=-1,o=0;if(null==e)for(;++i<r;)(n=+t[i])&&(o+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(o+=n);return o},t.ticks=function(t,e,n){var r,i,o,s,a=-1;if(n=+n,(t=+t)===(e=+e)&&0<n)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(s=_(t,e,n))||!isFinite(s))return[];if(0<s)for(t=Math.ceil(t/s),e=Math.floor(e/s),o=new Array(i=Math.ceil(e-t+1));++a<i;)o[a]=(t+a)*s;else for(t=Math.floor(t*s),e=Math.ceil(e*s),o=new Array(i=Math.ceil(t-e+1));++a<i;)o[a]=(t-a)/s;return r&&o.reverse(),o},t.tickIncrement=_,t.tickStep=b,t.transpose=S,t.variance=r,t.zip=function(){return S(arguments)},Object.defineProperty(t,"__esModule",{value:!0})},"object"===_typeof3(n)&&void 0!==e?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i(r.d3=r.d3||{})},{}],61:[function(t,e,n){var r,i;r=this,i=function(t,S){"use strict";function e(){return new n}function n(){this.reset()}n.prototype={constructor:n,reset:function(){this.s=this.t=0},add:function(t){j(F,t,this.t),j(this,F.s,this.s),this.s?this.t+=F.t:this.s=F.t},valueOf:function(){return this.s}};var F=new n;function j(t,e,n){var r=t.s=e+n,i=r-e;t.t=e-(r-i)+(n-i)}var A=1e-6,N=Math.PI,d=N/2,q=N/4,O=2*N,M=180/N,L=N/180,P=Math.abs,B=Math.atan,T=Math.atan2,C=Math.cos,G=Math.ceil,z=Math.exp,U=Math.log,V=Math.pow,k=Math.sin,$=Math.sign||function(t){return 0<t?1:t<0?-1:0},R=Math.sqrt,X=Math.tan;function Y(t){return 1<t?0:t<-1?N:Math.acos(t)}function D(t){return 1<t?d:t<-1?-d:Math.asin(t)}function J(t){return(t=k(t/2))*t}function r(){}function W(t,e){t&&K.hasOwnProperty(t.type)&&K[t.type](t,e)}var H={Feature:function(t,e){W(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)W(n[r].geometry,e)}},K={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Q(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Q(n[r],e,0)},Polygon:function(t,e){Z(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Z(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)W(n[r],e)}};function Q(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function Z(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Q(t[n],e,1);e.polygonEnd()}var tt,et,nt,rt,it,u=function(t,e){t&&H.hasOwnProperty(t.type)?H[t.type](t,e):W(t,e)},ot=e(),st=e(),i={point:r,lineStart:r,lineEnd:r,polygonStart:function(){ot.reset(),i.lineStart=at,i.lineEnd=ut},polygonEnd:function(){var t=+ot;st.add(t<0?O+t:t),this.lineStart=this.lineEnd=this.point=r},sphere:function(){st.add(O)}};function at(){i.point=lt}function ut(){ct(tt,et)}function lt(t,e){i.point=ct,tt=t,et=e,nt=t*=L,rt=C(e=(e*=L)/2+q),it=k(e)}function ct(t,e){var n=(t*=L)-nt,r=0<=n?1:-1,n=r*n,i=C(e=(e*=L)/2+q),e=k(e),o=it*e,s=rt*i+o*C(n),o=o*r*k(n);ot.add(T(o,s)),nt=t,rt=i,it=e}var l,c,p,h,f,pt,ht,ft;function dt(t){return[T(t[1],t[0]),D(t[2])]}function yt(t){var e=t[0],t=t[1],n=C(t);return[n*C(e),n*k(e),k(t)]}function gt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function mt(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function vt(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function _t(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function bt(t){var e=R(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var y,g,xt=e(),m={point:wt,lineStart:St,lineEnd:It,polygonStart:function(){m.point=Nt,m.lineStart=Ot,m.lineEnd=Ct,xt.reset(),i.polygonStart()},polygonEnd:function(){i.polygonEnd(),m.point=wt,m.lineStart=St,m.lineEnd=It,ot<0?(l=-(p=180),c=-(h=90)):A<xt?h=90:xt<-A&&(c=-90),g[0]=l,g[1]=p}};function wt(t,e){y.push(g=[l=t,p=t]),e<c&&(c=e),h<e&&(h=e)}function Et(t,e){var n,r,i,o,s,a=yt([t*L,e*L]);ft?(n=mt(ft,a),bt(n=mt([n[1],-n[0],0],n)),n=dt(n),s=t-f,i=n[0]*M*(r=0<s?1:-1),(s=180<P(s))^(r*f<i&&i<r*t)?(o=n[1]*M,h<o&&(h=o)):s^(r*f<(i=(360+i)%360-180)&&i<r*t)?(o=-n[1]*M)<c&&(c=o):(e<c&&(c=e),h<e&&(h=e)),s?t<f?v(l,t)>v(l,p)&&(p=t):v(t,p)>v(l,p)&&(l=t):l<=p?(t<l&&(l=t),p<t&&(p=t)):f<t?v(l,t)>v(l,p)&&(p=t):v(t,p)>v(l,p)&&(l=t)):y.push(g=[l=t,p=t]),e<c&&(c=e),h<e&&(h=e),ft=a,f=t}function St(){m.point=Et}function It(){g[0]=l,g[1]=p,m.point=wt,ft=null}function Nt(t,e){var n;ft?(n=t-f,xt.add(180<P(n)?n+(0<n?360:-360):n)):(pt=t,ht=e),i.point(t,e),Et(t,e)}function Ot(){i.lineStart()}function Ct(){Nt(pt,ht),i.lineEnd(),P(xt)>A&&(l=-(p=180)),g[0]=l,g[1]=p,ft=null}function v(t,e){return(e-=t)<0?e+360:e}function kt(t,e){return t[0]-e[0]}function At(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var Mt,Lt,Pt,Tt,Rt,Dt,Ft,jt,qt,Bt,Gt,zt,Ut,_,b,x,o={sphere:r,point:Vt,lineStart:Xt,lineEnd:Wt,polygonStart:function(){o.lineStart=Ht,o.lineEnd=Kt},polygonEnd:function(){o.lineStart=Xt,o.lineEnd=Wt}};function Vt(t,e){t*=L;var n=C(e*=L);$t(n*C(t),n*k(t),k(e))}function $t(t,e,n){Pt+=(t-Pt)/++Mt,Tt+=(e-Tt)/Mt,Rt+=(n-Rt)/Mt}function Xt(){o.point=Yt}function Yt(t,e){t*=L;var n=C(e*=L);_=n*C(t),b=n*k(t),x=k(e),o.point=Jt,$t(_,b,x)}function Jt(t,e){t*=L;var n=C(e*=L),r=n*C(t),n=n*k(t),t=k(e),e=T(R((e=b*t-x*n)*e+(e=x*r-_*t)*e+(e=_*n-b*r)*e),_*r+b*n+x*t);Lt+=e,Dt+=e*(_+(_=r)),Ft+=e*(b+(b=n)),jt+=e*(x+(x=t)),$t(_,b,x)}function Wt(){o.point=Vt}function Ht(){o.point=Qt}function Kt(){Zt(zt,Ut),o.point=Vt}function Qt(t,e){zt=t,Ut=e,t*=L,e*=L,o.point=Zt;var n=C(e);_=n*C(t),b=n*k(t),x=k(e),$t(_,b,x)}function Zt(t,e){t*=L;var n=C(e*=L),r=n*C(t),n=n*k(t),t=k(e),e=b*t-x*n,i=x*r-_*t,o=_*n-b*r,s=R(e*e+i*i+o*o),a=D(s),s=s&&-a/s;qt+=s*e,Bt+=s*i,Gt+=s*o,Lt+=a,Dt+=a*(_+(_=r)),Ft+=a*(b+(b=n)),jt+=a*(x+(x=t)),$t(_,b,x)}function te(t){return function(){return t}}var ee=function(n,r){function t(t,e){return t=n(t,e),r(t[0],t[1])}return n.invert&&r.invert&&(t.invert=function(t,e){return(t=r.invert(t,e))&&n.invert(t[0],t[1])}),t};function ne(t,e){return[N<t?t-O:t<-N?t+O:t,e]}function re(t,e,n){return(t%=O)?e||n?ee(oe(t),se(e,n)):oe(t):e||n?se(e,n):ne}function ie(n){return function(t,e){return[N<(t+=n)?t-O:t<-N?t+O:t,e]}}function oe(t){var e=ie(t);return e.invert=ie(-t),e}function se(t,e){var i=C(t),o=k(t),s=C(e),a=k(e);function n(t,e){var n=C(e),r=C(t)*n,t=k(t)*n,n=k(e),e=n*i+r*o;return[T(t*s-e*a,r*i-n*o),D(e*s+t*a)]}return n.invert=function(t,e){var n=C(e),r=C(t)*n,t=k(t)*n,n=k(e),e=n*s-t*a;return[T(t*s+n*a,r*i+e*o),D(e*i-r*o)]},n}ne.invert=ne;var ae=function(e){function t(t){return(t=e(t[0]*L,t[1]*L))[0]*=M,t[1]*=M,t}return e=re(e[0]*L,e[1]*L,2<e.length?e[2]*L:0),t.invert=function(t){return(t=e.invert(t[0]*L,t[1]*L))[0]*=M,t[1]*=M,t},t};function ue(t,e,n,r,i,o){if(n){var s=C(e),a=k(e),u=r*n;null==i?(i=e+r*O,o=e-u/2):(i=le(s,i),o=le(s,o),(0<r?i<o:o<i)&&(i+=r*O));for(var l,c=i;0<r?o<c:c<o;c-=u)l=dt([s,-a*C(c),-a*k(c)]),t.point(l[0],l[1])}}function le(t,e){(e=yt(e))[0]-=t,bt(e);t=Y(-e[1]);return((-e[2]<0?-t:t)+O-A)%O}var ce=function(){var n,e=[];return{point:function(t,e){n.push([t,e])},lineStart:function(){e.push(n=[])},lineEnd:r,rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))},result:function(){var t=e;return e=[],n=null,t}}},pe=function(t,e,n,r,i,o){var s=t[0],a=t[1],u=0,l=1,c=e[0]-s,p=e[1]-a,n=n-s;if(c||!(0<n)){if(n/=c,c<0){if(n<u)return;n<l&&(l=n)}else if(0<c){if(l<n)return;u<n&&(u=n)}if(n=i-s,c||!(n<0)){if(n/=c,c<0){if(l<n)return;u<n&&(u=n)}else if(0<c){if(n<u)return;n<l&&(l=n)}if(n=r-a,p||!(0<n)){if(n/=p,p<0){if(n<u)return;n<l&&(l=n)}else if(0<p){if(l<n)return;u<n&&(u=n)}if(n=o-a,p||!(n<0)){if(n/=p,p<0){if(l<n)return;u<n&&(u=n)}else if(0<p){if(n<u)return;n<l&&(l=n)}return 0<u&&(t[0]=s+u*c,t[1]=a+u*p),l<1&&(e[0]=s+l*c,e[1]=a+l*p),!0}}}}},he=function(t,e){return P(t[0]-e[0])<A&&P(t[1]-e[1])<A};function fe(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var de=function(t,e,n,r,o){var s,i,a=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],i=t[e];if(he(r,i)){for(o.lineStart(),s=0;s<e;++s)o.point((r=t[s])[0],r[1]);o.lineEnd()}else a.push(n=new fe(r,t,null,!0)),u.push(n.o=new fe(r,null,n,!1)),a.push(n=new fe(i,t,null,!1)),u.push(n.o=new fe(i,null,n,!0))}}),a.length){for(u.sort(e),ye(a),ye(u),s=0,i=u.length;s<i;++s)u[s].e=n=!n;for(var l,c,p=a[0];;){for(var h=p,f=!0;h.v;)if((h=h.n)===p)return;l=h.z,o.lineStart();do{if(h.v=h.o.v=!0,h.e){if(f)for(s=0,i=l.length;s<i;++s)o.point((c=l[s])[0],c[1]);else r(h.x,h.n.x,1,o);h=h.n}else{if(f)for(l=h.p.z,s=l.length-1;0<=s;--s)o.point((c=l[s])[0],c[1]);else r(h.x,h.p.x,-1,o);h=h.p}}while(l=(h=h.o).z,f=!f,!h.v);o.lineEnd()}}};function ye(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var ge=1e9,me=-ge;function ve(m,v,_,b){function x(t,e){return m<=t&&t<=_&&v<=e&&e<=b}function w(t,e,n,r){var i=0,o=0;if(null==t||(i=s(t,n))!==(o=s(e,n))||a(t,e)<0^0<n)for(;r.point(0===i||3===i?m:_,1<i?b:v),(i=(i+n+4)%4)!==o;);else r.point(e[0],e[1])}function s(t,e){return P(t[0]-m)<A?0<e?0:3:P(t[0]-_)<A?0<e?2:1:P(t[1]-v)<A?0<e?1:0:0<e?3:2}function E(t,e){return a(t.x,e.x)}function a(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(r){var i,p,o,s,a,u,l,c,h,f,d,y=r,t=ce(),e={point:n,lineStart:function(){e.point=g,p&&p.push(o=[]);f=!0,h=!1,l=c=NaN},lineEnd:function(){i&&(g(s,a),u&&h&&t.rejoin(),i.push(t.result()));e.point=n,h&&y.lineEnd()},polygonStart:function(){y=t,i=[],p=[],d=!0},polygonEnd:function(){var t=function(){for(var t=0,e=0,n=p.length;e<n;++e)for(var r,i,o=p[e],s=1,a=o.length,u=o[0],l=u[0],c=u[1];s<a;++s)r=l,i=c,u=o[s],l=u[0],c=u[1],i<=b?b<c&&(c-i)*(m-r)<(l-r)*(b-i)&&++t:c<=b&&(l-r)*(b-i)<(c-i)*(m-r)&&--t;return t}(),e=d&&t,n=(i=S.merge(i)).length;(e||n)&&(r.polygonStart(),e&&(r.lineStart(),w(null,null,1,r),r.lineEnd()),n&&de(i,E,t,w,r),r.polygonEnd());y=r,i=p=o=null}};function n(t,e){x(t,e)&&y.point(t,e)}function g(t,e){var n,r,i=x(t,e);p&&o.push([t,e]),f?(s=t,a=e,f=!1,(u=i)&&(y.lineStart(),y.point(t,e))):i&&h?y.point(t,e):(n=[l=Math.max(me,Math.min(ge,l)),c=Math.max(me,Math.min(ge,c))],r=[t=Math.max(me,Math.min(ge,t)),e=Math.max(me,Math.min(ge,e))],pe(n,r,m,v,_,b)?(h||(y.lineStart(),y.point(n[0],n[1])),y.point(r[0],r[1]),i||y.lineEnd(),d=!1):i&&(y.lineStart(),y.point(t,e),d=!1)),l=t,c=e,h=i}return e}}function _e(t,e){var n=e[0],r=e[1],i=[k(n),-C(n),0],o=0,s=0;Ee.reset();for(var a=0,u=t.length;a<u;++a)if(c=(l=t[a]).length)for(var l,c,p=l[c-1],h=p[0],f=p[1]/2+q,d=k(f),y=C(f),g=0;g<c;++g,h=v,d=b,y=_,p=m){var m=l[g],v=m[0],_=m[1]/2+q,b=k(_),_=C(_),x=v-h,w=0<=x?1:-1,E=w*x,S=N<E,I=d*b;Ee.add(T(I*w*k(E),y*_+I*C(E))),o+=S?x+w*O:x,S^n<=h^n<=v&&(bt(I=mt(yt(p),yt(m))),bt(E=mt(i,I)),(w=(S^0<=x?-1:1)*D(E[2]))<r||r===w&&(I[0]||I[1]))&&(s+=S^0<=x?1:-1)}return(o<-A||o<A&&Ee<-A)^1&s}var be,xe,we,Ee=e(),Se=e(),Ie={sphere:r,point:r,lineStart:function(){Ie.point=Oe,Ie.lineEnd=Ne},lineEnd:r,polygonStart:r,polygonEnd:r};function Ne(){Ie.point=Ie.lineEnd=r}function Oe(t,e){be=t*=L,xe=k(e*=L),we=C(e),Ie.point=Ce}function Ce(t,e){t*=L;var n=k(e*=L),e=C(e),r=P(t-be),i=C(r),r=e*k(r),o=we*n-xe*e*i,i=xe*n+we*e*i;Se.add(T(R(r*r+o*o),i)),be=t,xe=n,we=e}function ke(t,e){return Me[0]=t,Me[1]=e,Ae(Le)}var Ae=function(t){return Se.reset(),u(t,Ie),+Se},Me=[null,null],Le={type:"LineString",coordinates:Me},Pe={Feature:function(t,e){return Re(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(Re(n[r].geometry,e))return!0;return!1}},Te={Sphere:function(){return!0},Point:function(t,e){return De(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(De(n[r],e))return!0;return!1},LineString:function(t,e){return Fe(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Fe(n[r],e))return!0;return!1},Polygon:function(t,e){return je(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(je(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(Re(n[r],e))return!0;return!1}};function Re(t,e){return!(!t||!Te.hasOwnProperty(t.type))&&Te[t.type](t,e)}function De(t,e){return 0===ke(t,e)}function Fe(t,e){var n=ke(t[0],t[1]);return ke(t[0],e)+ke(e,t[1])<=n+A}function je(t,e){return!!_e(t.map(qe),Be(e))}function qe(t){return(t=t.map(Be)).pop(),t}function Be(t){return[t[0]*L,t[1]*L]}function Ge(t,e,n){var r=S.range(t,e-A,n).concat(e);return function(e){return r.map(function(t){return[e,t]})}}function ze(t,e,n){var r=S.range(t,e-A,n).concat(e);return function(e){return r.map(function(t){return[t,e]})}}function Ue(){var e,n,r,i,o,s,a,u,l,c,p,h,f=10,d=f,y=90,g=360,m=2.5;function v(){return{type:"MultiLineString",coordinates:t()}}function t(){return S.range(G(i/y)*y,r,y).map(p).concat(S.range(G(u/g)*g,a,g).map(h)).concat(S.range(G(n/f)*f,e,f).filter(function(t){return P(t%y)>A}).map(l)).concat(S.range(G(s/d)*d,o,d).filter(function(t){return P(t%g)>A}).map(c))}return v.lines=function(){return t().map(function(t){return{type:"LineString",coordinates:t}})},v.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(h(a).slice(1),p(r).reverse().slice(1),h(u).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.extentMajor(t).extentMinor(t):v.extentMinor()},v.extentMajor=function(t){return arguments.length?(i=+t[0][0],r=+t[1][0],u=+t[0][1],a=+t[1][1],r<i&&(t=i,i=r,r=t),a<u&&(t=u,u=a,a=t),v.precision(m)):[[i,u],[r,a]]},v.extentMinor=function(t){return arguments.length?(n=+t[0][0],e=+t[1][0],s=+t[0][1],o=+t[1][1],e<n&&(t=n,n=e,e=t),o<s&&(t=s,s=o,o=t),v.precision(m)):[[n,s],[e,o]]},v.step=function(t){return arguments.length?v.stepMajor(t).stepMinor(t):v.stepMinor()},v.stepMajor=function(t){return arguments.length?(y=+t[0],g=+t[1],v):[y,g]},v.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],v):[f,d]},v.precision=function(t){return arguments.length?(m=+t,l=Ge(s,o,90),c=ze(n,e,m),p=Ge(u,a,90),h=ze(i,r,m),v):m},v.extentMajor([[-180,-90+A],[180,90-A]]).extentMinor([[-180,-80-A],[180,80+A]])}var Ve,$e,Xe,Ye,Je=function(t){return t},We=e(),He=e(),a={point:r,lineStart:r,lineEnd:r,polygonStart:function(){a.lineStart=Ke,a.lineEnd=tn},polygonEnd:function(){a.lineStart=a.lineEnd=a.point=r,We.add(P(He)),He.reset()},result:function(){var t=We/2;return We.reset(),t}};function Ke(){a.point=Qe}function Qe(t,e){a.point=Ze,Ve=Xe=t,$e=Ye=e}function Ze(t,e){He.add(Ye*t-Xe*e),Xe=t,Ye=e}function tn(){Ze(Ve,$e)}var en=1/0,nn=en,rn=-en,on=rn,sn={point:function(t,e){t<en&&(en=t);rn<t&&(rn=t);e<nn&&(nn=e);on<e&&(on=e)},lineStart:r,lineEnd:r,polygonStart:r,polygonEnd:r,result:function(){var t=[[en,nn],[rn,on]];return rn=on=-(nn=en=1/0),t}};var an,un,s,w,ln=0,cn=0,pn=0,hn=0,fn=0,dn=0,yn=0,gn=0,mn=0,E={point:vn,lineStart:_n,lineEnd:wn,polygonStart:function(){E.lineStart=En,E.lineEnd=Sn},polygonEnd:function(){E.point=vn,E.lineStart=_n,E.lineEnd=wn},result:function(){var t=mn?[yn/mn,gn/mn]:dn?[hn/dn,fn/dn]:pn?[ln/pn,cn/pn]:[NaN,NaN];return ln=cn=pn=hn=fn=dn=yn=gn=mn=0,t}};function vn(t,e){ln+=t,cn+=e,++pn}function _n(){E.point=bn}function bn(t,e){E.point=xn,vn(s=t,w=e)}function xn(t,e){var n=t-s,r=e-w,n=R(n*n+r*r);hn+=n*(s+t)/2,fn+=n*(w+e)/2,dn+=n,vn(s=t,w=e)}function wn(){E.point=vn}function En(){E.point=In}function Sn(){Nn(an,un)}function In(t,e){E.point=Nn,vn(an=s=t,un=w=e)}function Nn(t,e){var n=t-s,r=e-w,n=R(n*n+r*r);hn+=n*(s+t)/2,fn+=n*(w+e)/2,dn+=n,yn+=(n=w*t-s*e)*(s+t),gn+=n*(w+e),mn+=3*n,vn(s=t,w=e)}function On(t){this._context=t}On.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,O)}},result:r};var Cn,kn,An,Mn,Ln,Pn=e(),Tn={point:r,lineStart:function(){Tn.point=Rn},lineEnd:function(){Cn&&Dn(kn,An),Tn.point=r},polygonStart:function(){Cn=!0},polygonEnd:function(){Cn=null},result:function(){var t=+Pn;return Pn.reset(),t}};function Rn(t,e){Tn.point=Dn,kn=Mn=t,An=Ln=e}function Dn(t,e){Mn-=t,Ln-=e,Pn.add(R(Mn*Mn+Ln*Ln)),Mn=t,Ln=e}function Fn(){this._string=[]}function jn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}Fn.prototype={_radius:4.5,_circle:jn(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=jn(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){var t;return this._string.length?(t=this._string.join(""),this._string=[],t):null}};var qn=function(v,_,b,x){return function(r,a){var u,l,c,n=_(a),e=r.invert(x[0],x[1]),p=ce(),h=_(p),f=!1,i={point:o,lineStart:s,lineEnd:d,polygonStart:function(){i.point=y,i.lineStart=g,i.lineEnd=m,l=[],u=[]},polygonEnd:function(){i.point=o,i.lineStart=s,i.lineEnd=d,l=S.merge(l);var t=_e(u,e);l.length?(f||(a.polygonStart(),f=!0),de(l,Gn,t,b,a)):t&&(f||(a.polygonStart(),f=!0),a.lineStart(),b(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),l=u=null},sphere:function(){a.polygonStart(),a.lineStart(),b(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function o(t,e){var n=r(t,e);v(t=n[0],e=n[1])&&a.point(t,e)}function t(t,e){t=r(t,e);n.point(t[0],t[1])}function s(){i.point=t,n.lineStart()}function d(){i.point=o,n.lineEnd()}function y(t,e){c.push([t,e]);t=r(t,e);h.point(t[0],t[1])}function g(){h.lineStart(),c=[]}function m(){y(c[0][0],c[0][1]),h.lineEnd();var t,e,n,r,i=h.clean(),o=p.result(),s=o.length;if(c.pop(),u.push(c),c=null,s)if(1&i){if(0<(e=(n=o[0]).length-1)){for(f||(a.polygonStart(),f=!0),a.lineStart(),t=0;t<e;++t)a.point((r=n[t])[0],r[1]);a.lineEnd()}}else 1<s&&2&i&&o.push(o.pop().concat(o.shift())),l.push(o.filter(Bn))}return i}};function Bn(t){return 1<t.length}function Gn(t,e){return((t=t.x)[0]<0?t[1]-d-A:d-t[1])-((e=e.x)[0]<0?e[1]-d-A:d-e[1])}var zn=qn(function(){return!0},function(l){var c,p=NaN,h=NaN,f=NaN;return{lineStart:function(){l.lineStart(),c=1},point:function(t,e){var n,r,i,o,s,a=0<t?N:-N,u=P(t-p);P(u-N)<A?(l.point(p,h=0<(h+e)/2?d:-d),l.point(f,h),l.lineEnd(),l.lineStart(),l.point(a,h),l.point(t,h),c=0):f!==a&&N<=u&&(P(p-f)<A&&(p-=f*A),P(t-a)<A&&(t-=a*A),u=h,i=e,s=k((n=p)-(r=t)),h=P(s)>A?B((k(u)*(o=C(i))*k(r)-k(i)*(r=C(u))*k(n))/(r*o*s)):(u+i)/2,l.point(f,h),l.lineEnd(),l.lineStart(),l.point(a,h),c=0),l.point(p=t,h=e),f=a},lineEnd:function(){l.lineEnd(),p=h=NaN},clean:function(){return 2-c}}},function(t,e,n,r){var i;null==t?(i=n*d,r.point(-N,i),r.point(0,i),r.point(N,i),r.point(N,0),r.point(N,-i),r.point(0,-i),r.point(-N,-i),r.point(-N,0),r.point(-N,i)):P(t[0]-e[0])>A?(t=t[0]<e[0]?N:-N,i=n*t/2,r.point(-t,i),r.point(0,i),r.point(t,i)):r.point(e[0],e[1])},[-N,-d]);function Un(i,o){var y=C(i),p=0<y,h=P(y)>A;function f(t,e){return C(t)*C(e)>y}function d(t,e,n){var r,i,o,s,a,u,l,c=[1,0,0],p=mt(yt(t),yt(e)),h=gt(p,p),f=p[0],d=h-f*f;return d?(r=mt(c,p),vt(c=_t(c,y*h/d),_t(p,-y*f/d)),(d=(p=gt(c,h=r))*p-(f=gt(h,h))*(gt(c,c)-1))<0?void 0:(vt(d=_t(h,(-p-(r=R(d)))/f),c),d=dt(d),n?(i=t[0],o=e[0],s=t[1],e=e[1],o<i&&(l=i,i=o,o=l),!(u=P((a=o-i)-N)<A)&&e<s&&(l=s,s=e,e=l),(u||a<A?u?0<s+e^d[1]<(P(d[0]-i)<A?s:e):s<=d[1]&&d[1]<=e:N<a^(i<=d[0]&&d[0]<=o))?(vt(l=_t(h,(-p+r)/f),c),[d,dt(l)]):void 0):d)):!n&&t}function g(t,e){var n=p?i:N-i,r=0;return t<-n?r|=1:n<t&&(r|=2),e<-n?r|=4:n<e&&(r|=8),r}return qn(f,function(o){var s,a,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(t,e){var n,r=[t,e],i=f(t,e),t=p?i?0:g(t,e):i?g(t+(t<0?N:-N),e):0;!s&&(l=u=i)&&o.lineStart(),i===u||(n=d(s,r))&&!he(s,n)&&!he(r,n)||(r[0]+=A,r[1]+=A,i=f(r[0],r[1])),i!==u?(c=0,i?(o.lineStart(),n=d(r,s),o.point(n[0],n[1])):(n=d(s,r),o.point(n[0],n[1]),o.lineEnd()),s=n):h&&s&&p^i&&(t&a||!(e=d(r,s,!0))||(c=0,p?(o.lineStart(),o.point(e[0][0],e[0][1]),o.point(e[1][0],e[1][1]),o.lineEnd()):(o.point(e[1][0],e[1][1]),o.lineEnd(),o.lineStart(),o.point(e[0][0],e[0][1])))),!i||s&&he(s,r)||o.point(r[0],r[1]),s=r,u=i,a=t},lineEnd:function(){u&&o.lineEnd(),s=null},clean:function(){return c|(l&&u)<<1}}},function(t,e,n,r){ue(r,i,o,n,t,e)},p?[0,-i]:[-N,i-N])}function Vn(r){return function(t){var e,n=new $n;for(e in r)n[e]=r[e];return n.stream=t,n}}function $n(){}function Xn(t,e,n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent(),n=(t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),u(n,t.stream(sn)),sn.result()),s=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),r=+e[0][0]+(r-s*(n[1][0]+n[0][0]))/2,e=+e[0][1]+(i-s*(n[1][1]+n[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*s).translate([r,e])}function Yn(t,e,n){return Xn(t,[[0,0],e],n)}$n.prototype={constructor:$n,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Jn(t,e){return+e?(O=t,C=e,function(r){var n,i,o,s,a,u,l,c,p,h,f,d,y={point:t,lineStart:e,lineEnd:m,polygonStart:function(){r.polygonStart(),y.lineStart=v},polygonEnd:function(){r.polygonEnd(),y.lineStart=e}};function t(t,e){t=O(t,e),r.point(t[0],t[1])}function e(){c=NaN,y.point=g,r.lineStart()}function g(t,e){var n=yt([t,e]),e=O(t,e);k(c,p,l,h,f,d,c=e[0],p=e[1],l=t,h=n[0],f=n[1],d=n[2],Wn,r),r.point(c,p)}function m(){y.point=t,r.lineEnd()}function v(){e(),y.point=_,y.lineEnd=b}function _(t,e){g(n=t,e),i=c,o=p,s=h,a=f,u=d,y.point=g}function b(){k(c,p,l,h,f,d,i,o,n,s,a,u,Wn,r),y.lineEnd=m,m()}return y}):(n=t,Vn({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}}));var n,O,C;function k(t,e,n,r,i,o,s,a,u,l,c,p,h,f){var d,y,g,m,v,_,b,x,w,E,S=s-t,I=a-e,N=S*S+I*I;4*C<N&&h--&&(g=o+p,b=D(g/=m=R((d=r+l)*d+(y=i+c)*y+g*g)),v=P(P(g)-1)<A||P(n-u)<A?(n+u)/2:T(y,d),_=(b=O(v,b))[0],b=b[1],C<(E=I*(x=_-t)-S*(w=b-e))*E/N||.3<P((S*x+I*w)/N-.5)||r*l+i*c+o*p<Hn)&&(k(t,e,n,r,i,o,_,b,v,d/=m,y/=m,g,h,f),f.point(_,b),k(_,b,v,d,y,g,s,a,u,l,c,p,h,f))}}var Wn=16,Hn=C(30*L);var Kn=Vn({point:function(t,e){this.stream.point(t*L,e*L)}});function I(t){return Qn(function(){return t})()}function Qn(t){var n,r,i,e,o,s,a,u,l,c,p=150,h=480,f=250,d=0,y=0,g=0,m=0,v=0,_=null,b=zn,x=null,w=Je,E=.5,S=Jn(O,E);function I(t){return[(t=o(t[0]*L,t[1]*L))[0]*p+r,i-t[1]*p]}function N(t){return(t=o.invert((t[0]-r)/p,(i-t[1])/p))&&[t[0]*M,t[1]*M]}function O(t,e){return[(t=n(t,e))[0]*p+r,i-t[1]*p]}function C(){o=ee(e=re(g,m,v),n);var t=n(d,y);return r=h-t[0]*p,i=f+t[1]*p,k()}function k(){return l=c=null,I}return I.stream=function(t){return l&&c===t?l:l=Kn(b(e,S(w(c=t))))},I.clipAngle=function(t){return arguments.length?(b=+t?Un(_=t*L,6*L):(_=null,zn),k()):_*M},I.clipExtent=function(t){return arguments.length?(w=null==t?(x=s=a=u=null,Je):ve(x=+t[0][0],s=+t[0][1],a=+t[1][0],u=+t[1][1]),k()):null==x?null:[[x,s],[a,u]]},I.scale=function(t){return arguments.length?(p=+t,C()):p},I.translate=function(t){return arguments.length?(h=+t[0],f=+t[1],C()):[h,f]},I.center=function(t){return arguments.length?(d=t[0]%360*L,y=t[1]%360*L,C()):[d*M,y*M]},I.rotate=function(t){return arguments.length?(g=t[0]%360*L,m=t[1]%360*L,v=2<t.length?t[2]%360*L:0,C()):[g*M,m*M,v*M]},I.precision=function(t){return arguments.length?(S=Jn(O,E=t*t),k()):R(E)},I.fitExtent=function(t,e){return Xn(I,t,e)},I.fitSize=function(t,e){return Yn(I,t,e)},function(){return n=t.apply(this,arguments),I.invert=n.invert&&N,C()}}function Zn(t){var e=0,n=N/3,r=Qn(t),t=r(e,n);return t.parallels=function(t){return arguments.length?r(e=t[0]*L,n=t[1]*L):[e*M,n*M]},t}function tr(t,e){var n,r,i,o=k(t),s=(o+k(e))/2;return P(s)<A?(n=C(t),a.invert=function(t,e){return[t/n,D(e*n)]},a):(i=R(r=1+o*(2*s-o))/s,u.invert=function(t,e){e=i-e;return[T(t,P(e))/s*$(e),D((r-(t*t+e*e)*s*s)/(2*s))]},u);function a(t,e){return[t*n,k(e)/n]}function u(t,e){e=R(r-2*s*k(e))/s;return[e*k(t*=s),i-e*C(t)]}}function er(){return Zn(tr).scale(155.424).center([0,33.6442])}function nr(){return er().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function rr(i){return function(t,e){var n=C(t),r=C(e),n=i(n*r);return[n*r*k(t),n*k(e)]}}function ir(o){return function(t,e){var n=R(t*t+e*e),r=o(n),i=k(r),r=C(r);return[T(t*i,n*r),D(n&&e*i/n)]}}var or=rr(function(t){return R(2/(1+t))}),sr=(or.invert=ir(function(t){return 2*D(t/2)}),rr(function(t){return(t=Y(t))&&t/k(t)}));sr.invert=ir(function(t){return t});function ar(t,e){return[t,U(X((d+e)/2))]}ar.invert=function(t,e){return[t,2*B(z(e))-d]};function ur(n){var r,i,o,s=I(n),e=s.center,a=s.scale,u=s.translate,l=s.clipExtent,c=null;function p(){var t=N*a(),e=s(ae(s.rotate()).invert([0,0]));return l(null==c?[[e[0]-t,e[1]-t],[e[0]+t,e[1]+t]]:n===ar?[[Math.max(e[0]-t,c),r],[Math.min(e[0]+t,i),o]]:[[c,Math.max(e[1]-t,r)],[i,Math.min(e[1]+t,o)]])}return s.scale=function(t){return(arguments.length?(a(t),p):a)()},s.translate=function(t){return(arguments.length?(u(t),p):u)()},s.center=function(t){return(arguments.length?(e(t),p):e)()},s.clipExtent=function(t){return arguments.length?(null==t?c=r=i=o=null:(c=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),p()):null==c?null:[[c,r],[i,o]]},p()}function lr(t){return X((d+t)/2)}function cr(t,e){var n=C(t),r=t===e?k(t):U(n/C(e))/U(lr(e)/lr(t)),i=n*V(lr(t),r)/r;return r?(o.invert=function(t,e){var e=i-e,n=$(r)*R(t*t+e*e);return[T(t,P(e))/r*$(e),2*B(V(i/n,1/r))-d]},o):ar;function o(t,e){0<i?e<-d+A&&(e=-d+A):d-A<e&&(e=d-A);e=i/V(lr(e),r);return[e*k(r*t),i-e*C(r*t)]}}function pr(t,e){return[t,e]}pr.invert=pr;function hr(t,e){var n=C(t),r=t===e?k(t):(n-C(e))/(e-t),i=n/r+t;return P(r)<A?pr:(o.invert=function(t,e){e=i-e;return[T(t,P(e))/r*$(e),i-$(r)*R(t*t+e*e)]},o);function o(t,e){e=i-e,t*=r;return[e*k(t),i-e*C(t)]}}function fr(t,e){var n=C(e),r=C(t)*n;return[n*k(t)/r,k(e)/r]}fr.invert=ir(B);function dr(n,r,i,o){return 1===n&&1===r&&0===i&&0===o?Je:Vn({point:function(t,e){this.stream.point(t*n+i,e*r+o)}})}function yr(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}yr.invert=function(t,e){var n=e,r=25;do{var i=n*n,o=i*i}while(n-=o=(n*(1.007226+i*(.015085+o*(.028874*i-.044475-.005916*o)))-e)/(1.007226+i*(.045255+o*(.259866*i-.311325-.005916*11*o))),P(o)>A&&0<--r);return[t/(.8707+(i=n*n)*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979)),n]};function gr(t,e){return[C(e)*k(t),k(e)]}gr.invert=ir(D);function mr(t,e){var n=C(e),r=1+C(t)*n;return[n*k(t)/r,k(e)/r]}mr.invert=ir(function(t){return 2*B(t)});function vr(t,e){return[U(X((d+e)/2)),-t]}vr.invert=function(t,e){return[-e,2*B(z(t))-d]};t.geoArea=function(t){return st.reset(),u(t,i),2*st},t.geoBounds=function(t){var e,n,r,i,o,s,a;if(h=p=-(l=c=1/0),y=[],u(t,m),n=y.length){for(y.sort(kt),e=1,o=[r=y[0]];e<n;++e)At(r,(i=y[e])[0])||At(r,i[1])?(v(r[0],i[1])>v(r[0],r[1])&&(r[1]=i[1]),v(i[0],r[1])>v(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)(a=v(r[1],(i=o[e])[0]))>s&&(s=a,l=i[0],p=r[1])}return y=g=null,l===1/0||c===1/0?[[NaN,NaN],[NaN,NaN]]:[[l,c],[p,h]]},t.geoCentroid=function(t){Mt=Lt=Pt=Tt=Rt=Dt=Ft=jt=qt=Bt=Gt=0,u(t,o);var t=qt,e=Bt,n=Gt,r=t*t+e*e+n*n;return r<1e-12&&(t=Dt,e=Ft,n=jt,Lt<A&&(t=Pt,e=Tt,n=Rt),(r=t*t+e*e+n*n)<1e-12)?[NaN,NaN]:[T(e,t)*M,D(n/R(r))*M]},t.geoCircle=function(){var r,i,o=te([0,0]),s=te(90),a=te(6),u={point:function(t,e){r.push(t=i(t,e)),t[0]*=M,t[1]*=M}};function e(){var t=o.apply(this,arguments),e=s.apply(this,arguments)*L,n=a.apply(this,arguments)*L;return r=[],i=re(-t[0]*L,-t[1]*L,0).invert,ue(u,e,n,1),t={type:"Polygon",coordinates:[r]},r=i=null,t}return e.center=function(t){return arguments.length?(o="function"==typeof t?t:te([+t[0],+t[1]]),e):o},e.radius=function(t){return arguments.length?(s="function"==typeof t?t:te(+t),e):s},e.precision=function(t){return arguments.length?(a="function"==typeof t?t:te(+t),e):a},e},t.geoClipExtent=function(){var e,n,r,i=0,o=0,s=960,a=500;return r={stream:function(t){return e&&n===t?e:e=ve(i,o,s,a)(n=t)},extent:function(t){return arguments.length?(i=+t[0][0],o=+t[0][1],s=+t[1][0],a=+t[1][1],e=n=null,r):[[i,o],[s,a]]}}},t.geoContains=function(t,e){return(t&&Pe.hasOwnProperty(t.type)?Pe[t.type]:Re)(t,e)},t.geoDistance=ke,t.geoGraticule=Ue,t.geoGraticule10=function(){return Ue()()},t.geoInterpolate=function(t,e){var n=t[0]*L,r=t[1]*L,t=e[0]*L,e=e[1]*L,i=C(r),o=k(r),s=C(e),a=k(e),u=i*C(n),l=i*k(n),c=s*C(t),p=s*k(t),h=2*D(R(J(e-r)+i*s*J(t-n))),f=k(h);return(e=h?function(t){var e=k(t*=h)/f,t=k(h-t)/f,n=t*u+e*c,r=t*l+e*p,t=t*o+e*a;return[T(r,n)*M,T(t,R(n*n+r*r))*M]}:function(){return[n*M,r*M]}).distance=h,e},t.geoLength=Ae,t.geoPath=function(e,n){var r,i,o=4.5;function s(t){return t&&("function"==typeof o&&i.pointRadius(+o.apply(this,arguments)),u(t,r(i))),i.result()}return s.area=function(t){return u(t,r(a)),a.result()},s.measure=function(t){return u(t,r(Tn)),Tn.result()},s.bounds=function(t){return u(t,r(sn)),sn.result()},s.centroid=function(t){return u(t,r(E)),E.result()},s.projection=function(t){return arguments.length?(r=null==t?(e=null,Je):(e=t).stream,s):e},s.context=function(t){return arguments.length?(i=null==t?(n=null,new Fn):new On(n=t),"function"!=typeof o&&i.pointRadius(o),s):n},s.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(i.pointRadius(+t),+t),s):o},s.projection(e).context(n)},t.geoAlbers=nr,t.geoAlbersUsa=function(){var e,n,i,o,s,r,a=nr(),u=er().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=er().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){r=[t,e]}};function p(t){var e=t[0],t=t[1];return r=null,i.point(e,t),r||(o.point(e,t),r)||(s.point(e,t),r)}function h(){return e=n=null,p}return p.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,n=(t[1]-n[1])/e;return(.12<=n&&n<.234&&-.425<=r&&r<-.214?u:.166<=n&&n<.234&&-.214<=r&&r<-.115?l:a).invert(t)},p.stream=function(t){return e&&n===t?e:(r=[a.stream(n=t),u.stream(t),l.stream(t)],i=r.length,e={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},p.precision=function(t){return arguments.length?(a.precision(t),u.precision(t),l.precision(t),h()):a.precision()},p.scale=function(t){return arguments.length?(a.scale(t),u.scale(.35*t),l.scale(t),p.translate(a.translate())):a.scale()},p.translate=function(t){var e,n,r;return arguments.length?(e=a.scale(),n=+t[0],r=+t[1],i=a.translate(t).clipExtent([[n-.455*e,r-.238*e],[n+.455*e,r+.238*e]]).stream(c),o=u.translate([n-.307*e,r+.201*e]).clipExtent([[n-.425*e+A,r+.12*e+A],[n-.214*e-A,r+.234*e-A]]).stream(c),s=l.translate([n-.205*e,r+.212*e]).clipExtent([[n-.214*e+A,r+.166*e+A],[n-.115*e-A,r+.234*e-A]]).stream(c),h()):a.translate()},p.fitExtent=function(t,e){return Xn(p,t,e)},p.fitSize=function(t,e){return Yn(p,t,e)},p.scale(1070)},t.geoAzimuthalEqualArea=function(){return I(or).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=or,t.geoAzimuthalEquidistant=function(){return I(sr).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=sr,t.geoConicConformal=function(){return Zn(cr).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=cr,t.geoConicEqualArea=er,t.geoConicEqualAreaRaw=tr,t.geoConicEquidistant=function(){return Zn(hr).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=hr,t.geoEquirectangular=function(){return I(pr).scale(152.63)},t.geoEquirectangularRaw=pr,t.geoGnomonic=function(){return I(fr).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=fr,t.geoIdentity=function(){var e,n,r,i,o,s,a=1,u=0,l=0,c=1,p=1,h=Je,f=null,d=Je;function y(){return i=o=null,s}return s={stream:function(t){return i&&o===t?i:i=h(d(o=t))},clipExtent:function(t){return arguments.length?(d=null==t?(f=e=n=r=null,Je):ve(f=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),y()):null==f?null:[[f,e],[n,r]]},scale:function(t){return arguments.length?(h=dr((a=+t)*c,a*p,u,l),y()):a},translate:function(t){return arguments.length?(h=dr(a*c,a*p,u=+t[0],l=+t[1]),y()):[u,l]},reflectX:function(t){return arguments.length?(h=dr(a*(c=t?-1:1),a*p,u,l),y()):c<0},reflectY:function(t){return arguments.length?(h=dr(a*c,a*(p=t?-1:1),u,l),y()):p<0},fitExtent:function(t,e){return Xn(s,t,e)},fitSize:function(t,e){return Yn(s,t,e)}}},t.geoProjection=I,t.geoProjectionMutator=Qn,t.geoMercator=function(){return ur(ar).scale(961/O)},t.geoMercatorRaw=ar,t.geoNaturalEarth1=function(){return I(yr).scale(175.295)},t.geoNaturalEarth1Raw=yr,t.geoOrthographic=function(){return I(gr).scale(249.5).clipAngle(90+A)},t.geoOrthographicRaw=gr,t.geoStereographic=function(){return I(mr).scale(250).clipAngle(142)},t.geoStereographicRaw=mr,t.geoTransverseMercator=function(){var t=ur(vr),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],2<t.length?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=vr,t.geoRotation=ae,t.geoStream=u,t.geoTransform=function(t){return{stream:Vn(t)}},Object.defineProperty(t,"__esModule",{value:!0})},"object"===_typeof3(n)&&void 0!==e?i(n,t("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],i):i(r.d3=r.d3||{},r.d3)},{"d3-array":60}],62:[function(t,e,n){"use strict";e.exports=function(){}},{}],63:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?Object.assign:t("./shim")},{"./is-implemented":64,"./shim":65}],64:[function(t,e,n){"use strict";e.exports=function(){var t=Object.assign;return"function"==typeof t&&(t(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},{}],65:[function(t,e,n){"use strict";var s=t("../keys"),a=t("../valid-value"),u=Math.max;e.exports=function(e,n){var r,t,i,o=u(arguments.length,2);for(e=Object(a(e)),i=function(t){try{e[t]=n[t]}catch(t){r=r||t}},t=1;t<o;++t)s(n=arguments[t]).forEach(i);if(void 0!==r)throw r;return e}},{"../keys":67,"../valid-value":72}],66:[function(t,e,n){"use strict";var r=t("../function/noop")();e.exports=function(t){return t!==r&&null!==t}},{"../function/noop":62}],67:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?Object.keys:t("./shim")},{"./is-implemented":68,"./shim":69}],68:[function(t,e,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],69:[function(t,e,n){"use strict";var r=t("../is-value"),i=Object.keys;e.exports=function(t){return i(r(t)?Object(t):t)}},{"../is-value":66}],70:[function(t,e,n){"use strict";var o=t("./is-value"),r=Array.prototype.forEach,s=Object.create;e.exports=function(t){var i=s(null);return r.call(arguments,function(t){if(o(t)){var e,n=Object(t),r=i;for(e in n)r[e]=n[e]}}),i}},{"./is-value":66}],71:[function(t,e,n){"use strict";e.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},{}],72:[function(t,e,n){"use strict";var r=t("./is-value");e.exports=function(t){if(r(t))return t;throw new TypeError("Cannot use null or undefined")}},{"./is-value":66}],73:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?String.prototype.contains:t("./shim")},{"./is-implemented":74,"./shim":75}],74:[function(t,e,n){"use strict";var r="razdwatrzy";e.exports=function(){return"function"==typeof r.contains&&!0===r.contains("dwa")&&!1===r.contains("foo")}},{}],75:[function(t,e,n){"use strict";var r=String.prototype.indexOf;e.exports=function(t){return-1<r.call(this,t,arguments[1])}},{}],76:[function(t,e,n){"use strict";var r=t("d"),s=t("es5-ext/object/valid-callable"),a=Function.prototype.apply,u=Function.prototype.call,i=Object.create,o=Object.defineProperty,l=Object.defineProperties,c=Object.prototype.hasOwnProperty,p={configurable:!0,enumerable:!1,writable:!0},h=function(t,e){var n;return s(e),c.call(this,"__ee__")?n=this.__ee__:(n=p.value=i(null),o(this,"__ee__",p),p.value=null),n[t]?"object"===_typeof3(n[t])?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},t=function(t,e){var n,r;return s(e),r=this,h.call(this,t,n=function(){f.call(r,t,n),a.call(e,this,arguments)}),n.__eeOnceListener__=e,this},f=function(t,e){var n,r,i,o;if(s(e),c.call(this,"__ee__")&&(n=this.__ee__)[t])if("object"===_typeof3(r=n[t]))for(o=0;i=r[o];++o)i!==e&&i.__eeOnceListener__!==e||(2===r.length?n[t]=r[o?0:1]:r.splice(o,1));else r!==e&&r.__eeOnceListener__!==e||delete n[t];return this},d=function(t){var e,n,r,i,o;if(c.call(this,"__ee__")&&(i=this.__ee__[t]))if("object"===_typeof3(i)){for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];for(i=i.slice(),e=0;r=i[e];++e)a.call(r,this,o)}else switch(arguments.length){case 1:u.call(i,this);break;case 2:u.call(i,this,arguments[1]);break;case 3:u.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];a.call(i,this,o)}},y={on:h,once:t,off:f,emit:d},g={on:r(h),once:r(t),off:r(f),emit:r(d)},m=l({},g);e.exports=n=function(t){return null==t?i(m):l(Object(t),g)},n.methods=y},{d:59,"es5-ext/object/valid-callable":71}],77:[function(t,n,e){!function(t){!function(){function i(t,e){for(var n=(e=e||[]).length,r=0;r<t.length;r++)Array.isArray(t[r])&&Array.isArray(t[r][0])?(i(t[r],e),n=e.length):e[n++]=t[r];return Array.isArray(e[0])?e:[e]}function o(t){return Math.max.apply(null,t.map(function(t){return t[1]}))}function s(t){return Math.max.apply(null,t.map(function(t){return t[0]}))}function a(t){return Math.min.apply(null,t.map(function(t){return t[1]}))}function u(t){return Math.min.apply(null,t.map(function(t){return t[0]}))}function e(t){return i(t.geometry.coordinates)}function c(t){if(!t)return[];switch(t.type){case"Feature":return e(t);case"GeometryCollection":return i(t.geometries.map(c));case"FeatureCollection":return i(t.features.map(e));case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiPolygon":case"MultiLineString":return i(t.coordinates);default:return[]}}n.exports={envelope:function(t){return t=c(t),e=u(t),n=a(t),r=s(t),t=o(t),{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[e,n],[e,t],[r,t],[r,n],[e,n]]]}};var e,n,r},extent:function(t){return[u(t=c(t)),a(t),s(t),o(t)]},centroid:function(t){for(var e=c(t),n={x:0,y:0},r=0,i=0,o=0,s=0,a=0,u=0,l=0;l<e.length-1;l++)i=e[l][0],o=e[l][1],s=e[l+1][0],r+=u=i*(a=e[l+1][1])-s*o,n.x+=(i+s)*u,n.y+=(o+a)*u;return i=e[e.length-1][0],o=e[e.length-1][1],s=e[0][0],r+=u=i*(a=e[0][1])-s*o,n.x+=(i+s)*u,n.y+=(o+a)*u,n.x=n.x/(6*(r*=.5)),n.y=n.y/(6*r),[n.x,n.y]},xMin:function(t){return u(c(t))},xMax:function(t){return s(c(t))},yMin:function(t){return a(c(t))},yMax:function(t){return o(c(t))}}}.call(this)}.call(this,t("_process"))},{_process:283}],78:[function(t,e,n){var r=t("rbush"),i=t("@turf/helpers"),o=t("@turf/meta"),s=t("@turf/bbox").default,a=o.featureEach,u=(o.coordEach,i.polygon,i.featureCollection);function l(t){t=new r(t);return t.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox||s(t),r.prototype.insert.call(this,t)},t.load=function(t){var e=[];return Array.isArray(t)?t.forEach(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox||s(t),e.push(t)}):a(t,function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox||s(t),e.push(t)}),r.prototype.load.call(this,e)},t.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox||s(t),r.prototype.remove.call(this,t,e)},t.clear=function(){return r.prototype.clear.call(this)},t.search=function(t){t=r.prototype.search.call(this,this.toBBox(t));return u(t)},t.collides=function(t){return r.prototype.collides.call(this,this.toBBox(t))},t.all=function(){var t=r.prototype.all.call(this);return u(t)},t.toJSON=function(){return r.prototype.toJSON.call(this)},t.fromJSON=function(t){return r.prototype.fromJSON.call(this,t)},t.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else{if("Feature"!==t.type&&"FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},t}e.exports=l,e.exports.default=l},{"@turf/bbox":4,"@turf/helpers":30,"@turf/meta":36,rbush:284}],79:[function(t,e,n){var s;function a(t){return t*Math.PI/180}function u(t,e){switch(t){case"[lat,lon]":return{latitude:e[0],longitude:e[1]};case"[lon,lat]":return{latitude:e[1],longitude:e[0]};case"{lon,lat}":return{latitude:e.lat,longitude:e.lon};case"{lat,lng}":return{latitude:e.lat,longitude:e.lng};case"geojson":return{latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0]};default:return e}}s={km:6371,mile:3960,meter:6371e3,nmi:3440},void 0!==e&&e.exports&&(e.exports=function(t,e,n){var r=(n=n||{}).unit in s?s[n.unit]:s.km,t=u(n.format,t),e=u(n.format,e),i=a(e.latitude-t.latitude),o=a(e.longitude-t.longitude),t=a(t.latitude),e=a(e.latitude),i=Math.sin(i/2)*Math.sin(i/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(t)*Math.cos(e),o=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i));return n.threshold?n.threshold>r*o:r*o})},{}],80:[function(t,e,n){"use strict";var r=/&/g,i=/</g,o=/\'/g,s=/\"/g,a=/[&<>\"\']/;e.exports=function(t){return null!=t&&("string"!=typeof t&&(t=String(t)),a.test(String(t)))?t.replace(r,"&amp;").replace(i,"&lt;").replace(o,"&apos;").replace(s,"&quot;"):t}},{}],81:[function(t,e,n){t=t("./_getNative")(t("./_root"),"DataView");e.exports=t},{"./_getNative":136,"./_root":171}],82:[function(t,e,n){var r=t("./_hashClear"),i=t("./_hashDelete"),o=t("./_hashGet"),s=t("./_hashHas"),t=t("./_hashSet");function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=i,a.prototype.get=o,a.prototype.has=s,a.prototype.set=t,e.exports=a},{"./_hashClear":142,"./_hashDelete":143,"./_hashGet":144,"./_hashHas":145,"./_hashSet":146}],83:[function(t,e,n){var r=t("./_listCacheClear"),i=t("./_listCacheDelete"),o=t("./_listCacheGet"),s=t("./_listCacheHas"),t=t("./_listCacheSet");function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=i,a.prototype.get=o,a.prototype.has=s,a.prototype.set=t,e.exports=a},{"./_listCacheClear":153,"./_listCacheDelete":154,"./_listCacheGet":155,"./_listCacheHas":156,"./_listCacheSet":157}],84:[function(t,e,n){t=t("./_getNative")(t("./_root"),"Map");e.exports=t},{"./_getNative":136,"./_root":171}],85:[function(t,e,n){var r=t("./_mapCacheClear"),i=t("./_mapCacheDelete"),o=t("./_mapCacheGet"),s=t("./_mapCacheHas"),t=t("./_mapCacheSet");function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=i,a.prototype.get=o,a.prototype.has=s,a.prototype.set=t,e.exports=a},{"./_mapCacheClear":158,"./_mapCacheDelete":159,"./_mapCacheGet":160,"./_mapCacheHas":161,"./_mapCacheSet":162}],86:[function(t,e,n){t=t("./_getNative")(t("./_root"),"Promise");e.exports=t},{"./_getNative":136,"./_root":171}],87:[function(t,e,n){t=t("./_getNative")(t("./_root"),"Set");e.exports=t},{"./_getNative":136,"./_root":171}],88:[function(t,e,n){var r=t("./_MapCache"),i=t("./_setCacheAdd"),t=t("./_setCacheHas");function o(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}o.prototype.add=o.prototype.push=i,o.prototype.has=t,e.exports=o},{"./_MapCache":85,"./_setCacheAdd":172,"./_setCacheHas":173}],89:[function(t,e,n){var r=t("./_ListCache"),i=t("./_stackClear"),o=t("./_stackDelete"),s=t("./_stackGet"),a=t("./_stackHas"),t=t("./_stackSet");function u(t){t=this.__data__=new r(t);this.size=t.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=t,e.exports=u},{"./_ListCache":83,"./_stackClear":175,"./_stackDelete":176,"./_stackGet":177,"./_stackHas":178,"./_stackSet":179}],90:[function(t,e,n){t=t("./_root").Symbol;e.exports=t},{"./_root":171}],91:[function(t,e,n){t=t("./_root").Uint8Array;e.exports=t},{"./_root":171}],92:[function(t,e,n){t=t("./_getNative")(t("./_root"),"WeakMap");e.exports=t},{"./_getNative":136,"./_root":171}],93:[function(t,e,n){e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},{}],94:[function(t,e,n){e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}},{}],95:[function(t,e,n){var c=t("./_baseTimes"),p=t("./isArguments"),h=t("./isArray"),f=t("./isBuffer"),d=t("./_isIndex"),y=t("./isTypedArray"),g=Object.prototype.hasOwnProperty;e.exports=function(t,e){var n,r=h(t),i=!r&&p(t),o=!r&&!i&&f(t),s=!r&&!i&&!o&&y(t),a=r||i||o||s,u=a?c(t.length,String):[],l=u.length;for(n in t)!e&&!g.call(t,n)||a&&("length"==n||o&&("offset"==n||"parent"==n)||s&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||d(n,l))||u.push(n);return u}},{"./_baseTimes":120,"./_isIndex":147,"./isArguments":188,"./isArray":189,"./isBuffer":191,"./isTypedArray":197}],96:[function(t,e,n){e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},{}],97:[function(t,e,n){e.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},{}],98:[function(t,e,n){e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},{}],99:[function(t,e,n){var r=t("./eq");e.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},{"./eq":183}],100:[function(t,e,n){var r=t("./_baseForOwn"),t=t("./_createBaseEach")(r);e.exports=t},{"./_baseForOwn":102,"./_createBaseEach":127}],101:[function(t,e,n){t=t("./_createBaseFor")();e.exports=t},{"./_createBaseFor":128}],102:[function(t,e,n){var r=t("./_baseFor"),i=t("./keys");e.exports=function(t,e){return t&&r(t,e,i)}},{"./_baseFor":101,"./keys":198}],103:[function(t,e,n){var i=t("./_castPath"),o=t("./_toKey");e.exports=function(t,e){for(var n=0,r=(e=i(e,t)).length;null!=t&&n<r;)t=t[o(e[n++])];return n&&n==r?t:void 0}},{"./_castPath":125,"./_toKey":181}],104:[function(t,e,n){var r=t("./_arrayPush"),i=t("./isArray");e.exports=function(t,e,n){return e=e(t),i(t)?e:r(e,n(t))}},{"./_arrayPush":97,"./isArray":189}],105:[function(t,e,n){var r=t("./_Symbol"),i=t("./_getRawTag"),o=t("./_objectToString"),s=r?r.toStringTag:void 0;e.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(s&&s in Object(t)?i:o)(t)}},{"./_Symbol":90,"./_getRawTag":137,"./_objectToString":169}],106:[function(t,e,n){e.exports=function(t,e){return null!=t&&e in Object(t)}},{}],107:[function(t,e,n){var r=t("./_baseGetTag"),i=t("./isObjectLike");e.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},{"./_baseGetTag":105,"./isObjectLike":195}],108:[function(t,e,n){var s=t("./_baseIsEqualDeep"),a=t("./isObjectLike");e.exports=function t(e,n,r,i,o){return e===n||(null==e||null==n||!a(e)&&!a(n)?e!=e&&n!=n:s(e,n,r,i,t,o))}},{"./_baseIsEqualDeep":109,"./isObjectLike":195}],109:[function(t,e,n){var p=t("./_Stack"),h=t("./_equalArrays"),f=t("./_equalByTag"),d=t("./_equalObjects"),y=t("./_getTag"),g=t("./isArray"),m=t("./isBuffer"),v=t("./isTypedArray"),_="[object Arguments]",b="[object Array]",x="[object Object]",w=Object.prototype.hasOwnProperty;e.exports=function(t,e,n,r,i,o){var s=g(t),a=g(e),u=s?b:y(t),a=a?b:y(e),l=(u=u==_?x:u)==x,c=(a=a==_?x:a)==x;if((a=u==a)&&m(t)){if(!m(e))return!1;l=!(s=!0)}if(a&&!l)return o=o||new p,s||v(t)?h(t,e,n,r,i,o):f(t,e,u,n,r,i,o);if(!(1&n)){s=l&&w.call(t,"__wrapped__"),u=c&&w.call(e,"__wrapped__");if(s||u)return i(s?t.value():t,u?e.value():e,n,r,o=o||new p)}return a&&(o=o||new p,d(t,e,n,r,i,o))}},{"./_Stack":89,"./_equalArrays":129,"./_equalByTag":130,"./_equalObjects":131,"./_getTag":139,"./isArray":189,"./isBuffer":191,"./isTypedArray":197}],110:[function(t,e,n){var f=t("./_Stack"),d=t("./_baseIsEqual");e.exports=function(t,e,n,r){var i=n.length,o=i,s=!r;if(null==t)return!o;for(t=Object(t);i--;){var a=n[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var u=(a=n[i])[0],l=t[u],c=a[1];if(s&&a[2]){if(void 0===l&&!(u in t))return!1}else{var p,h=new f;if(!(void 0===(p=r?r(l,c,u,t,e,h):p)?d(c,l,3,r,h):p))return!1}}return!0}},{"./_Stack":89,"./_baseIsEqual":108}],111:[function(t,e,n){var r=t("./isFunction"),i=t("./_isMasked"),o=t("./isObject"),s=t("./_toSource"),a=/^\[object .+?Constructor\]$/,t=Function.prototype,u=Object.prototype,t=t.toString,u=u.hasOwnProperty,l=RegExp("^"+t.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(t){return!(!o(t)||i(t))&&(r(t)?l:a).test(s(t))}},{"./_isMasked":150,"./_toSource":182,"./isFunction":192,"./isObject":194}],112:[function(t,e,n){var r=t("./_baseGetTag"),i=t("./isLength"),o=t("./isObjectLike"),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(t){return o(t)&&i(t.length)&&!!s[r(t)]}},{"./_baseGetTag":105,"./isLength":193,"./isObjectLike":195}],113:[function(t,e,n){var r=t("./_baseMatches"),i=t("./_baseMatchesProperty"),o=t("./identity"),s=t("./isArray"),a=t("./property");e.exports=function(t){return"function"==typeof t?t:null==t?o:"object"==_typeof3(t)?s(t)?i(t[0],t[1]):r(t):a(t)}},{"./_baseMatches":116,"./_baseMatchesProperty":117,"./identity":187,"./isArray":189,"./property":201}],114:[function(t,e,n){var r=t("./_isPrototype"),i=t("./_nativeKeys"),o=Object.prototype.hasOwnProperty;e.exports=function(t){if(!r(t))return i(t);var e,n=[];for(e in Object(t))o.call(t,e)&&"constructor"!=e&&n.push(e);return n}},{"./_isPrototype":151,"./_nativeKeys":167}],115:[function(t,e,n){var s=t("./_baseEach"),a=t("./isArrayLike");e.exports=function(t,r){var i=-1,o=a(t)?Array(t.length):[];return s(t,function(t,e,n){o[++i]=r(t,e,n)}),o}},{"./_baseEach":100,"./isArrayLike":190}],116:[function(t,e,n){var r=t("./_baseIsMatch"),i=t("./_getMatchData"),o=t("./_matchesStrictComparable");e.exports=function(e){var n=i(e);return 1==n.length&&n[0][2]?o(n[0][0],n[0][1]):function(t){return t===e||r(t,e,n)}}},{"./_baseIsMatch":110,"./_getMatchData":135,"./_matchesStrictComparable":164}],117:[function(t,e,n){var i=t("./_baseIsEqual"),o=t("./get"),s=t("./hasIn"),a=t("./_isKey"),u=t("./_isStrictComparable"),l=t("./_matchesStrictComparable"),c=t("./_toKey");e.exports=function(n,r){return a(n)&&u(r)?l(c(n),r):function(t){var e=o(t,n);return void 0===e&&e===r?s(t,n):i(r,e,3)}}},{"./_baseIsEqual":108,"./_isKey":148,"./_isStrictComparable":152,"./_matchesStrictComparable":164,"./_toKey":181,"./get":185,"./hasIn":186}],118:[function(t,e,n){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},{}],119:[function(t,e,n){var r=t("./_baseGet");e.exports=function(e){return function(t){return r(t,e)}}},{"./_baseGet":103}],120:[function(t,e,n){e.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},{}],121:[function(t,e,n){var r=t("./_Symbol"),i=t("./_arrayMap"),o=t("./isArray"),s=t("./isSymbol"),t=r?r.prototype:void 0,a=t?t.toString:void 0;e.exports=function t(e){var n;return"string"==typeof e?e:o(e)?i(e,t)+"":s(e)?a?a.call(e):"":"0"==(n=e+"")&&1/e==-1/0?"-0":n}},{"./_Symbol":90,"./_arrayMap":96,"./isArray":189,"./isSymbol":196}],122:[function(t,e,n){e.exports=function(e){return function(t){return e(t)}}},{}],123:[function(t,e,n){e.exports=function(t,e){return t.has(e)}},{}],124:[function(t,e,n){var r=t("./identity");e.exports=function(t){return"function"==typeof t?t:r}},{"./identity":187}],125:[function(t,e,n){var r=t("./isArray"),i=t("./_isKey"),o=t("./_stringToPath"),s=t("./toString");e.exports=function(t,e){return r(t)?t:i(t,e)?[t]:o(s(t))}},{"./_isKey":148,"./_stringToPath":180,"./isArray":189,"./toString":204}],126:[function(t,e,n){t=t("./_root")["__core-js_shared__"];e.exports=t},{"./_root":171}],127:[function(t,e,n){var a=t("./isArrayLike");e.exports=function(o,s){return function(t,e){if(null!=t){if(!a(t))return o(t,e);for(var n=t.length,r=s?n:-1,i=Object(t);(s?r--:++r<n)&&!1!==e(i[r],r,i););}return t}}},{"./isArrayLike":190}],128:[function(t,e,n){e.exports=function(u){return function(t,e,n){for(var r=-1,i=Object(t),o=n(t),s=o.length;s--;){var a=o[u?s:++r];if(!1===e(i[a],a,i))break}return t}}},{}],129:[function(t,e,n){var g=t("./_SetCache"),m=t("./_arraySome"),v=t("./_cacheHas");e.exports=function(t,e,n,r,i,o){var s=1&n,a=t.length,u=e.length;if(a!=u&&!(s&&a<u))return!1;var u=o.get(t),l=o.get(e);if(u&&l)return u==e&&l==t;var c=-1,p=!0,h=2&n?new g:void 0;for(o.set(t,e),o.set(e,t);++c<a;){var f,d=t[c],y=e[c];if(void 0!==(f=r?s?r(y,d,c,e,t,o):r(d,y,c,t,e,o):f)){if(f)continue;p=!1;break}if(h){if(!m(e,function(t,e){if(!v(h,e)&&(d===t||i(d,t,n,r,o)))return h.push(e)})){p=!1;break}}else if(d!==y&&!i(d,y,n,r,o)){p=!1;break}}return o.delete(t),o.delete(e),p}},{"./_SetCache":88,"./_arraySome":98,"./_cacheHas":123}],130:[function(t,e,n){var r=t("./_Symbol"),l=t("./_Uint8Array"),c=t("./eq"),p=t("./_equalArrays"),h=t("./_mapToArray"),f=t("./_setToArray"),t=r?r.prototype:void 0,d=t?t.valueOf:void 0;e.exports=function(t,e,n,r,i,o,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return t.byteLength==e.byteLength&&o(new l(t),new l(e))?!0:!1;case"[object Boolean]":case"[object Date]":case"[object Number]":return c(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=h;case"[object Set]":a=a||f;if(t.size!=e.size&&!(1&r))return!1;var u=s.get(t);if(u)return u==e;r|=2,s.set(t,e);u=p(a(t),a(e),r,i,o,s);return s.delete(t),u;case"[object Symbol]":if(d)return d.call(t)==d.call(e)}return!1}},{"./_Symbol":90,"./_Uint8Array":91,"./_equalArrays":129,"./_mapToArray":163,"./_setToArray":174,"./eq":183}],131:[function(t,e,n){var v=t("./_getAllKeys"),_=Object.prototype.hasOwnProperty;e.exports=function(t,e,n,r,i,o){var s=1&n,a=v(t),u=a.length;if(u!=v(e).length&&!s)return!1;for(var l=u;l--;){var c=a[l];if(!(s?c in e:_.call(e,c)))return!1}var p=o.get(t),h=o.get(e);if(p&&h)return p==e&&h==t;for(var f=!0,d=(o.set(t,e),o.set(e,t),s);++l<u;){var y,g=t[c=a[l]],m=e[c];if(!(void 0===(y=r?s?r(m,g,c,e,t,o):r(g,m,c,t,e,o):y)?g===m||i(g,m,n,r,o):y)){f=!1;break}d=d||"constructor"==c}return f&&!d&&(p=t.constructor)!=(h=e.constructor)&&"constructor"in t&&"constructor"in e&&!("function"==typeof p&&p instanceof p&&"function"==typeof h&&h instanceof h)&&(f=!1),o.delete(t),o.delete(e),f}},{"./_getAllKeys":133}],132:[function(t,n,e){!function(e){!function(){var t="object"==_typeof3(e)&&e&&e.Object===Object&&e;n.exports=t}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],133:[function(t,e,n){var r=t("./_baseGetAllKeys"),i=t("./_getSymbols"),o=t("./keys");e.exports=function(t){return r(t,o,i)}},{"./_baseGetAllKeys":104,"./_getSymbols":138,"./keys":198}],134:[function(t,e,n){var r=t("./_isKeyable");e.exports=function(t,e){return t=t.__data__,r(e)?t["string"==typeof e?"string":"hash"]:t.map}},{"./_isKeyable":149}],135:[function(t,e,n){var o=t("./_isStrictComparable"),s=t("./keys");e.exports=function(t){for(var e=s(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,o(i)]}return e}},{"./_isStrictComparable":152,"./keys":198}],136:[function(t,e,n){var r=t("./_baseIsNative"),i=t("./_getValue");e.exports=function(t,e){return t=i(t,e),r(t)?t:void 0}},{"./_baseIsNative":111,"./_getValue":140}],137:[function(t,e,n){var t=t("./_Symbol"),r=Object.prototype,o=r.hasOwnProperty,s=r.toString,a=t?t.toStringTag:void 0;e.exports=function(t){var e=o.call(t,a),n=t[a];try{var r=!(t[a]=void 0)}catch(t){}var i=s.call(t);return r&&(e?t[a]=n:delete t[a]),i}},{"./_Symbol":90}],138:[function(t,e,n){var r=t("./_arrayFilter"),t=t("./stubArray"),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols;e.exports=o?function(e){return null==e?[]:(e=Object(e),r(o(e),function(t){return i.call(e,t)}))}:t},{"./_arrayFilter":94,"./stubArray":202}],139:[function(t,e,n){var r=t("./_DataView"),i=t("./_Map"),o=t("./_Promise"),s=t("./_Set"),a=t("./_WeakMap"),u=t("./_baseGetTag"),l=t("./_toSource"),c="[object Map]",p="[object Promise]",h="[object Set]",f="[object WeakMap]",d="[object DataView]",y=l(r),g=l(i),m=l(o),v=l(s),_=l(a),t=u;(r&&t(new r(new ArrayBuffer(1)))!=d||i&&t(new i)!=c||o&&t(o.resolve())!=p||s&&t(new s)!=h||a&&t(new a)!=f)&&(t=function(t){var e=u(t),t="[object Object]"==e?t.constructor:void 0,t=t?l(t):"";if(t)switch(t){case y:return d;case g:return c;case m:return p;case v:return h;case _:return f}return e}),e.exports=t},{"./_DataView":81,"./_Map":84,"./_Promise":86,"./_Set":87,"./_WeakMap":92,"./_baseGetTag":105,"./_toSource":182}],140:[function(t,e,n){e.exports=function(t,e){return null==t?void 0:t[e]}},{}],141:[function(t,e,n){var a=t("./_castPath"),u=t("./isArguments"),l=t("./isArray"),c=t("./_isIndex"),p=t("./isLength"),h=t("./_toKey");e.exports=function(t,e,n){for(var r=-1,i=(e=a(e,t)).length,o=!1;++r<i;){var s=h(e[r]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&p(i)&&c(s,i)&&(l(t)||u(t))}},{"./_castPath":125,"./_isIndex":147,"./_toKey":181,"./isArguments":188,"./isArray":189,"./isLength":193}],142:[function(t,e,n){var r=t("./_nativeCreate");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},{"./_nativeCreate":166}],143:[function(t,e,n){e.exports=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t}},{}],144:[function(t,e,n){var r=t("./_nativeCreate"),i=Object.prototype.hasOwnProperty;e.exports=function(t){var e,n=this.__data__;return r?"__lodash_hash_undefined__"===(e=n[t])?void 0:e:i.call(n,t)?n[t]:void 0}},{"./_nativeCreate":166}],145:[function(t,e,n){var r=t("./_nativeCreate"),i=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},{"./_nativeCreate":166}],146:[function(t,e,n){var r=t("./_nativeCreate");e.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},{"./_nativeCreate":166}],147:[function(t,e,n){var r=/^(?:0|[1-9]\d*)$/;e.exports=function(t,e){var n=_typeof3(t);return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&r.test(t))&&-1<t&&t%1==0&&t<e}},{}],148:[function(t,e,n){var r=t("./isArray"),i=t("./isSymbol"),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(t,e){var n;return!r(t)&&(!("number"!=(n=_typeof3(t))&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||s.test(t)||!o.test(t)||null!=e&&t in Object(e))}},{"./isArray":189,"./isSymbol":196}],149:[function(t,e,n){e.exports=function(t){var e=_typeof3(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},{}],150:[function(t,e,n){var t=t("./_coreJsData"),r=(t=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";e.exports=function(t){return!!r&&r in t}},{"./_coreJsData":126}],151:[function(t,e,n){var r=Object.prototype;e.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},{}],152:[function(t,e,n){var r=t("./isObject");e.exports=function(t){return t==t&&!r(t)}},{"./isObject":194}],153:[function(t,e,n){e.exports=function(){this.__data__=[],this.size=0}},{}],154:[function(t,e,n){var r=t("./_assocIndexOf"),i=Array.prototype.splice;e.exports=function(t){var e=this.__data__;return!((t=r(e,t))<0||(t==e.length-1?e.pop():i.call(e,t,1),--this.size,0))}},{"./_assocIndexOf":99}],155:[function(t,e,n){var r=t("./_assocIndexOf");e.exports=function(t){var e=this.__data__;return(t=r(e,t))<0?void 0:e[t][1]}},{"./_assocIndexOf":99}],156:[function(t,e,n){var r=t("./_assocIndexOf");e.exports=function(t){return-1<r(this.__data__,t)}},{"./_assocIndexOf":99}],157:[function(t,e,n){var i=t("./_assocIndexOf");e.exports=function(t,e){var n=this.__data__,r=i(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}},{"./_assocIndexOf":99}],158:[function(t,e,n){var r=t("./_Hash"),i=t("./_ListCache"),o=t("./_Map");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},{"./_Hash":82,"./_ListCache":83,"./_Map":84}],159:[function(t,e,n){var r=t("./_getMapData");e.exports=function(t){return t=r(this,t).delete(t),this.size-=t?1:0,t}},{"./_getMapData":134}],160:[function(t,e,n){var r=t("./_getMapData");e.exports=function(t){return r(this,t).get(t)}},{"./_getMapData":134}],161:[function(t,e,n){var r=t("./_getMapData");e.exports=function(t){return r(this,t).has(t)}},{"./_getMapData":134}],162:[function(t,e,n){var i=t("./_getMapData");e.exports=function(t,e){var n=i(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}},{"./_getMapData":134}],163:[function(t,e,n){e.exports=function(t){var n=-1,r=Array(t.size);return t.forEach(function(t,e){r[++n]=[e,t]}),r}},{}],164:[function(t,e,n){e.exports=function(e,n){return function(t){return null!=t&&t[e]===n&&(void 0!==n||e in Object(t))}}},{}],165:[function(t,e,n){var r=t("./memoize");e.exports=function(t){var e=(t=r(t,function(t){return 500===e.size&&e.clear(),t})).cache;return t}},{"./memoize":200}],166:[function(t,e,n){t=t("./_getNative")(Object,"create");e.exports=t},{"./_getNative":136}],167:[function(t,e,n){t=t("./_overArg")(Object.keys,Object);e.exports=t},{"./_overArg":170}],168:[function(t,e,n){var t=t("./_freeGlobal"),n="object"==_typeof3(n)&&n&&!n.nodeType&&n,r=n&&"object"==_typeof3(e)&&e&&!e.nodeType&&e,i=r&&r.exports===n&&t.process,n=function(){try{var t=r&&r.require&&r.require("util").types;return t?t:i&&i.binding&&i.binding("util")}catch(t){}}();e.exports=n},{"./_freeGlobal":132}],169:[function(t,e,n){var r=Object.prototype.toString;e.exports=function(t){return r.call(t)}},{}],170:[function(t,e,n){e.exports=function(e,n){return function(t){return e(n(t))}}},{}],171:[function(t,e,n){var t=t("./_freeGlobal"),r="object"==("undefined"==typeof self?"undefined":_typeof3(self))&&self&&self.Object===Object&&self,t=t||r||Function("return this")();e.exports=t},{"./_freeGlobal":132}],172:[function(t,e,n){e.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},{}],173:[function(t,e,n){e.exports=function(t){return this.__data__.has(t)}},{}],174:[function(t,e,n){e.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},{}],175:[function(t,e,n){var r=t("./_ListCache");e.exports=function(){this.__data__=new r,this.size=0}},{"./_ListCache":83}],176:[function(t,e,n){e.exports=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t}},{}],177:[function(t,e,n){e.exports=function(t){return this.__data__.get(t)}},{}],178:[function(t,e,n){e.exports=function(t){return this.__data__.has(t)}},{}],179:[function(t,e,n){var i=t("./_ListCache"),o=t("./_Map"),s=t("./_MapCache");e.exports=function(t,e){var n=this.__data__;if(n instanceof i){var r=n.__data__;if(!o||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new s(r)}return n.set(t,e),this.size=n.size,this}},{"./_ListCache":83,"./_Map":84,"./_MapCache":85}],180:[function(t,e,n){var t=t("./_memoizeCapped"),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,t=t(function(t){var i=[];return 46===t.charCodeAt(0)&&i.push(""),t.replace(r,function(t,e,n,r){i.push(n?r.replace(o,"$1"):e||t)}),i});e.exports=t},{"./_memoizeCapped":165}],181:[function(t,e,n){var r=t("./isSymbol");e.exports=function(t){var e;return"string"==typeof t||r(t)?t:"0"==(e=t+"")&&1/t==-1/0?"-0":e}},{"./isSymbol":196}],182:[function(t,e,n){var r=Function.prototype.toString;e.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},{}],183:[function(t,e,n){e.exports=function(t,e){return t===e||t!=t&&e!=e}},{}],184:[function(t,e,n){var r=t("./_arrayEach"),i=t("./_baseEach"),o=t("./_castFunction"),s=t("./isArray");e.exports=function(t,e){return(s(t)?r:i)(t,o(e))}},{"./_arrayEach":93,"./_baseEach":100,"./_castFunction":124,"./isArray":189}],185:[function(t,e,n){var r=t("./_baseGet");e.exports=function(t,e,n){return void 0===(t=null==t?void 0:r(t,e))?n:t}},{"./_baseGet":103}],186:[function(t,e,n){var r=t("./_baseHasIn"),i=t("./_hasPath");e.exports=function(t,e){return null!=t&&i(t,e,r)}},{"./_baseHasIn":106,"./_hasPath":141}],187:[function(t,e,n){e.exports=function(t){return t}},{}],188:[function(t,e,n){var r=t("./_baseIsArguments"),i=t("./isObjectLike"),t=Object.prototype,o=t.hasOwnProperty,s=t.propertyIsEnumerable,t=r(function(){return arguments}())?r:function(t){return i(t)&&o.call(t,"callee")&&!s.call(t,"callee")};e.exports=t},{"./_baseIsArguments":107,"./isObjectLike":195}],189:[function(t,e,n){var r=Array.isArray;e.exports=r},{}],190:[function(t,e,n){var r=t("./isFunction"),i=t("./isLength");e.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},{"./isFunction":192,"./isLength":193}],191:[function(t,e,n){var r=t("./_root"),t=t("./stubFalse"),n="object"==_typeof3(n)&&n&&!n.nodeType&&n,i=n&&"object"==_typeof3(e)&&e&&!e.nodeType&&e,i=i&&i.exports===n?r.Buffer:void 0,n=i?i.isBuffer:void 0;e.exports=n||t},{"./_root":171,"./stubFalse":203}],192:[function(t,e,n){var r=t("./_baseGetTag"),i=t("./isObject");e.exports=function(t){return!!i(t)&&("[object Function]"==(t=r(t))||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)}},{"./_baseGetTag":105,"./isObject":194}],193:[function(t,e,n){e.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},{}],194:[function(t,e,n){e.exports=function(t){var e=_typeof3(t);return null!=t&&("object"==e||"function"==e)}},{}],195:[function(t,e,n){e.exports=function(t){return null!=t&&"object"==_typeof3(t)}},{}],196:[function(t,e,n){var r=t("./_baseGetTag"),i=t("./isObjectLike");e.exports=function(t){return"symbol"==_typeof3(t)||i(t)&&"[object Symbol]"==r(t)}},{"./_baseGetTag":105,"./isObjectLike":195}],197:[function(t,e,n){var r=t("./_baseIsTypedArray"),i=t("./_baseUnary"),t=t("./_nodeUtil"),t=t&&t.isTypedArray,i=t?i(t):r;e.exports=i},{"./_baseIsTypedArray":112,"./_baseUnary":122,"./_nodeUtil":168}],198:[function(t,e,n){var r=t("./_arrayLikeKeys"),i=t("./_baseKeys"),o=t("./isArrayLike");e.exports=function(t){return(o(t)?r:i)(t)}},{"./_arrayLikeKeys":95,"./_baseKeys":114,"./isArrayLike":190}],199:[function(t,e,n){var r=t("./_arrayMap"),i=t("./_baseIteratee"),o=t("./_baseMap"),s=t("./isArray");e.exports=function(t,e){return(s(t)?r:o)(t,i(e,3))}},{"./_arrayMap":96,"./_baseIteratee":113,"./_baseMap":115,"./isArray":189}],200:[function(t,e,n){var s=t("./_MapCache");function a(r,i){if("function"!=typeof r||null!=i&&"function"!=typeof i)throw new TypeError("Expected a function");function o(){var t=arguments,e=i?i.apply(this,t):t[0],n=o.cache;return n.has(e)?n.get(e):(t=r.apply(this,t),o.cache=n.set(e,t)||n,t)}return o.cache=new(a.Cache||s),o}a.Cache=s,e.exports=a},{"./_MapCache":85}],201:[function(t,e,n){var r=t("./_baseProperty"),i=t("./_basePropertyDeep"),o=t("./_isKey"),s=t("./_toKey");e.exports=function(t){return o(t)?r(s(t)):i(t)}},{"./_baseProperty":118,"./_basePropertyDeep":119,"./_isKey":148,"./_toKey":181}],202:[function(t,e,n){e.exports=function(){return[]}},{}],203:[function(t,e,n){e.exports=function(){return!1}},{}],204:[function(t,e,n){var r=t("./_baseToString");e.exports=function(t){return null==t?"":r(t)}},{"./_baseToString":121}],205:[function(t,e,n){var r,i;r=this,i=function(){return t.prototype.closeDatabase=function(){this.catalog&&this.catalog.db&&(this.catalog.db.close(),this.catalog.db=null)},t.prototype.checkAvailability=function(){return!("undefined"==typeof indexedDB||!indexedDB)},t.prototype.loadKey=t.prototype.loadDatabase=function(e,n){var t=this.app,r=this;null===this.catalog||null===this.catalog.db?this.catalog=new s(function(t){r.catalog=t,r.loadDatabase(e,n)}):this.catalog.getAppKey(t,e,function(t){"function"==typeof n?0===t.id?n(null):n(t.val):console.log(t.val)})},t.prototype.saveKey=t.prototype.saveDatabase=function(e,n,r){var t=this.app,i=this;function o(t){t&&!0===t.success?r(null):r(new Error("Error saving database")),i.options.closeAfterSave&&i.closeDatabase()}null===this.catalog||null===this.catalog.db?this.catalog=new s(function(t){i.saveDatabase(e,n,o)}):this.catalog.setAppKey(t,e,n,o)},t.prototype.deleteKey=t.prototype.deleteDatabase=function(e,n){var t=this.app,r=this;null===this.catalog||null===this.catalog.db?this.catalog=new s(function(t){r.catalog=t,r.deleteDatabase(e,n)}):this.catalog.getAppKey(t,e,function(t){t=t.id;0!==t?r.catalog.deleteAppKey(t,n):"function"==typeof n&&n({success:!0})})},t.prototype.deleteDatabasePartitions=function(e){var n=this;this.getDatabaseList(function(t){t.forEach(function(t){t.startsWith(e)&&n.deleteDatabase(t)})})},t.prototype.getKeyList=t.prototype.getDatabaseList=function(r){var t=this.app,e=this;null===this.catalog||null===this.catalog.db?this.catalog=new s(function(t){e.catalog=t,e.getDatabaseList(r)}):this.catalog.getAppKeys(t,function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].key);"function"==typeof r?r(e):e.forEach(function(t){console.log(t)})})},t.prototype.getCatalogSummary=function(a){this.app;var e=this;null===this.catalog||null===this.catalog.db?this.catalog=new s(function(t){e.catalog=t,e.getCatalogSummary(a)}):this.catalog.getAllKeys(function(t){for(var e,n,r,i,o=[],s=0;s<t.length;s++)n=(e=t[s]).app||"",r=e.key||"",i=e.val||"",n=2*n.length+2*r.length+i.length+1,o.push({app:e.app,key:e.key,size:n});"function"==typeof a?a(o):o.forEach(function(t){console.log(t)})})},s.prototype.initializeLokiCatalog=function(e){var t=indexedDB.open("LokiCatalog",1),n=this;t.onupgradeneeded=function(t){var t=t.target.result;t.objectStoreNames.contains("LokiAKV")&&t.deleteObjectStore("LokiAKV"),t.objectStoreNames.contains("LokiAKV")||((t=t.createObjectStore("LokiAKV",{keyPath:"id",autoIncrement:!0})).createIndex("app","app",{unique:!1}),t.createIndex("key","key",{unique:!1}),t.createIndex("appkey","appkey",{unique:!0}))},t.onsuccess=function(t){n.db=t.target.result,"function"==typeof e&&e(n)},t.onerror=function(t){throw t}},s.prototype.getAppKey=function(t,e,n){var r,i,t=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("appkey").get(t+","+e);t.onsuccess=(r=n,function(t){t=t.target.result;null==t&&(t={id:0,success:!1}),"function"==typeof r?r(t):console.log(t)}),t.onerror=(i=n,function(t){if("function"!=typeof i)throw t;i({id:0,success:!1})})},s.prototype.getAppKeyById=function(t,e,n){var r,i;this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").get(t).onsuccess=(r=n,i=e,function(t){"function"==typeof i?i(t.target.result,r):console.log(t.target.result)})},s.prototype.setAppKey=function(r,i,o,s){var e,a=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV"),u=a.index("appkey").get(r+","+i);u.onsuccess=function(t){var e,n,t=t.target.result,t=(null==t?t={app:r,key:i,appkey:r+","+i,val:o}:t.val=o,a.put(t));t.onerror=(e=s,function(t){"function"==typeof e?e({success:!1}):(console.error("LokiCatalog.setAppKey (set) onerror"),console.error(u.error))}),t.onsuccess=(n=s,function(t){"function"==typeof n&&n({success:!0})})},u.onerror=(e=s,function(t){"function"==typeof e?e({success:!1}):(console.error("LokiCatalog.setAppKey (get) onerror"),console.error(u.error))})},s.prototype.deleteAppKey=function(t,e){var n,r,i=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV").delete(t);i.onsuccess=(n=e,function(t){"function"==typeof n&&n({success:!0})}),i.onerror=(r=e,function(t){"function"==typeof r?r({success:!1}):(console.error("LokiCatalog.deleteAppKey raised onerror"),console.error(i.error))})},s.prototype.getAppKeys=function(t,e){var n,r,i,o=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("app"),t=IDBKeyRange.only(t),o=o.openCursor(t);o.onsuccess=(n=[],r=e,function(t){var e,t=t.target.result;t?(e=t.value,n.push(e),t.continue()):"function"==typeof r?r(n):console.log(n)}),o.onerror=(i=e,function(t){"function"==typeof i?i(null):(console.error("LokiCatalog.getAppKeys raised onerror"),console.error(t))})},s.prototype.getAllKeys=function(t){var n,r,e,i=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").openCursor();i.onsuccess=(n=[],r=t,function(t){var e,t=t.target.result;t?(e=t.value,n.push(e),t.continue()):"function"==typeof r?r(n):console.log(n)}),i.onerror=(e=t,function(t){"function"==typeof e&&e(null)})},t;function t(t,e){if(this.app="loki",this.options=e||{},void 0!==t&&(this.app=t),this.catalog=null,!this.checkAvailability())throw new Error("indexedDB does not seem to be supported for your environment")}function s(t){this.db=null,this.initializeLokiCatalog(t)}},"function"==typeof define&&define.amd?define([],i):"object"===_typeof3(n)?e.exports=i():r.LokiIndexedAdapter=i()},{}],206:[function(q,n,r){!function(F,j){!function(){var t,e;t=this,e=function(){"use strict";var w=Object.prototype.hasOwnProperty;function f(t){var e,n;if(Array.isArray(t)){for(n=0;n<t.length;n++)f(t[n]);s(t)}else if(null!==t&&"object"===_typeof3(t)){for(e in t)t.hasOwnProperty(e)&&f(t[e]);s(t)}}function s(t){Object.isFrozen(t)||Object.freeze(t)}function a(t){return Object.isFrozen(t)?h(t,"shallow"):t}var E={copyProperties:function(t,e){for(var n in t)e[n]=t[n]},resolveTransformObject:function(t,e,n){var r,i;if("number"!=typeof n&&(n=0),!(10<=++n))for(r in t)"string"==typeof t[r]&&0===t[r].indexOf("[%lktxp]")?(i=t[r].substring(8),e.hasOwnProperty(i)&&(t[r]=e[i])):"object"===_typeof3(t[r])&&(t[r]=E.resolveTransformObject(t[r],e,n));return t},resolveTransformParams:function(t,e){var n,r,i=[];if(void 0===e)return t;for(n=0;n<t.length;n++)r=h(t[n],"shallow-recurse-objects"),i.push(E.resolveTransformObject(r,e));return i},getIn:function(t,e,n){if(null!=t){if(!n)return t[e];if("string"==typeof e&&(e=e.split(".")),!Array.isArray(e))throw new Error("path must be a string or array. Found "+_typeof3(e));for(var r=0,i=e.length;null!=t&&r<i;)t=t[e[r++]];return r&&r==i?t:void 0}}},v={aeq:t,lt:e,gt:n};function t(t,e){var n,r,i,o;if(t===e)return!0;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:i=1;break;case!1:i=3;break;case!0:i=4;break;case"":i=5;break;default:i=t==t?9:0}switch(e){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=e==e?9:0}if(9!==i||9!==o)return i===o}return n=Number(t),r=Number(e),n==n||r==r?n===r:t.toString()==e.toString()}function e(t,e,n){var r,i,o,s;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}switch(e){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=e==e?9:0}if(9!==o||9!==s)return o===s?n:o<s}return r=Number(t),i=Number(e),r==r&&i==i?r<i||!(i<r)&&n:r==r&&i!=i||(i!=i||r==r)&&(t<e||!(e<t)&&(t==e?n:(r=t.toString())<(i=e.toString())||r==i&&n))}function n(t,e,n){var r,i,o,s;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}switch(e){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=e==e?9:0}if(9!==o||9!==s)return o===s?n:s<o}return r=Number(t),i=Number(e),r==r&&i==i?i<r||!(r<i)&&n:(r!=r||i==i)&&(i==i&&r!=r||e<t||!(t<e)&&(t==e?n:(r=t.toString(),(i=e.toString())<r||r==i&&n)))}function d(t,e,n){return v.aeq(t,e)?0:v.lt(t,e,!1)?n?1:-1:v.gt(t,e,!1)?n?-1:1:0}function S(t,e,n,r,i,o){var s,a=o||0,o=e[a],u=!1;if("object"===_typeof3(t)&&o in t&&(s=t[o]),a+1>=e.length)u=n(s,r,i);else if(Array.isArray(s))for(var l=0,c=s.length;l<c&&!0!==(u=S(s[l],e,n,r,i,a+1));l+=1);else u=S(s,e,n,r,i,a+1);return u}function r(e){return"string"==typeof e||Array.isArray(e)?function(t){return-1!==e.indexOf(t)}:"object"===_typeof3(e)&&null!==e?function(t){return w.call(e,t)}:null}function o(t,e,n){for(var r in e)if(w.call(e,r))return I[r](t,e[r],n);return!1}var I={$eq:function(t,e){return t===e},$aeq:function(t,e){return t==e},$ne:function(t,e){return e!=e?t==t:t!==e},$dteq:function(t,e){return v.aeq(t,e)},$gt:function(t,e){return v.gt(t,e,!1)},$gte:function(t,e){return v.gt(t,e,!0)},$lt:function(t,e){return v.lt(t,e,!1)},$lte:function(t,e){return v.lt(t,e,!0)},$jgt:function(t,e){return e<t},$jgte:function(t,e){return e<=t},$jlt:function(t,e){return t<e},$jlte:function(t,e){return t<=e},$between:function(t,e){return null!=t&&v.gt(t,e[0],!0)&&v.lt(t,e[1],!0)},$jbetween:function(t,e){return null!=t&&t>=e[0]&&t<=e[1]},$in:function(t,e){return-1!==e.indexOf(t)},$inSet:function(t,e){return e.has(t)},$nin:function(t,e){return-1===e.indexOf(t)},$keyin:function(t,e){return t in e},$nkeyin:function(t,e){return!(t in e)},$definedin:function(t,e){return void 0!==e[t]},$undefinedin:function(t,e){return void 0===e[t]},$regex:function(t,e){return e.test(t)},$containsString:function(t,e){return"string"==typeof t&&-1!==t.indexOf(e)},$containsNone:function(t,e){return!I.$containsAny(t,e)},$containsAny:function(t,e){t=r(t);return null!==t&&(Array.isArray(e)?e.some(t):t(e))},$contains:function(t,e){t=r(t);return null!==t&&(Array.isArray(e)?e.every(t):t(e))},$elemMatch:function(t,r){return!!Array.isArray(t)&&t.some(function(n){return Object.keys(r).every(function(t){var e=r[t];return"object"===_typeof3(e)&&e||(e={$eq:e}),-1!==t.indexOf(".")?S(n,t.split("."),o,r[t],n):o(n[t],e,n)})})},$type:function(t,e,n){var r=_typeof3(t);return"object"===r&&(Array.isArray(t)?r="array":t instanceof Date&&(r="date")),"object"!==_typeof3(e)?r===e:o(r,e,n)},$finite:function(t,e){return e===isFinite(t)},$size:function(t,e,n){return!!Array.isArray(t)&&("object"!==_typeof3(e)?t.length===e:o(t.length,e,n))},$len:function(t,e,n){return"string"==typeof t&&("object"!==_typeof3(e)?t.length===e:o(t.length,e,n))},$where:function(t,e){return!0===e(t)},$not:function(t,e,n){return!o(t,e,n)},$and:function(t,e,n){for(var r=0,i=e.length;r<i;r+=1)if(!o(t,e[r],n))return!1;return!0},$or:function(t,e,n){for(var r=0,i=e.length;r<i;r+=1)if(o(t,e[r],n))return!0;return!1},$exists:function(t,e){return e?void 0!==t:void 0===t}},N=(["$eq","$aeq","$ne","$dteq","$gt","$gte","$lt","$lte","$jgt","$jgte","$jlt","$jlte","$type"].forEach(function(t){var r=I[t];I["$"+t]=function(t,e,n){if("string"==typeof e)return r(t,n[e]);if("function"==typeof e)return r(t,e(n));throw new Error("Invalid argument to $$ matcher")}}),{$eq:I.$eq,$aeq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0});function h(e,t){if(null==e)return null;switch(t||"parse-stringify"){case"parse-stringify":n=JSON.parse(JSON.stringify(e));break;case"jquery-extend-deep":n=jQuery.extend(!0,{},e);break;case"shallow":n=Object.create(e.constructor.prototype),Object.keys(e).map(function(t){n[t]=e[t]});break;case"shallow-assign":n=Object.create(e.constructor.prototype),Object.assign(n,e);break;case"shallow-recurse-objects":var n=h(e,"shallow");Object.keys(e).forEach(function(t){"object"===_typeof3(e[t])&&"Object"===e[t].constructor.name?n[t]=h(e[t],"shallow-recurse-objects"):Array.isArray(e[t])&&(n[t]=function(t,e){if("parse-stringify"==e)return h(t,e);for(var n=[],r=0,i=t.length;r<i;r++)n[r]=h(t[r],e);return n}(e[t],"shallow-recurse-objects"))})}return n}function i(){try{return window&&void 0!==window.localStorage&&null!==window.localStorage}catch(t){}}function u(){}function l(t,e){this.filename=t||"loki.db",this.collections=[],this.databaseVersion=1.5,this.engineVersion=1.5,this.autosave=!1,this.autosaveInterval=5e3,this.autosaveHandle=null,this.throttledSaves=!0,this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,this.throttledSavePending=!1,this.throttledCallbacks=[],this.verbose=!(!e||!e.hasOwnProperty("verbose"))&&e.verbose,this.events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]};e&&e.hasOwnProperty("env")?this.ENV=e.env:this.ENV=void 0!==j&&(j.android||j.NSObject)?"NATIVESCRIPT":"undefined"==typeof window||void 0!==j&&j.window&&void 0!==F?"NODEJS":"undefined"==typeof document||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?"CORDOVA":"BROWSER","undefined"===this.ENV&&(this.ENV="NODEJS"),this.configureOptions(e,!0),this.on("init",this.clearChanges)}function c(t){this.hashStore={},this.options=t||{},this.options.hasOwnProperty("asyncResponses")||(this.options.asyncResponses=!1),this.options.hasOwnProperty("asyncTimeout")||(this.options.asyncTimeout=50)}function p(t,e){if(this.mode="reference",this.adapter=null,this.options=e||{},this.dbref=null,this.dbname="",this.pageIterator={},!t)throw new Error("LokiPartitioningAdapter requires a (non-reference mode) adapter on construction");if("reference"===t.mode)throw new Error("LokiPartitioningAdapter cannot be instantiated with a reference mode adapter");this.adapter=t,this.options.hasOwnProperty("paging")||(this.options.paging=!1),this.options.hasOwnProperty("pageSize")||(this.options.pageSize=26214400),this.options.hasOwnProperty("delimiter")||(this.options.delimiter="$<\n")}function y(){try{this.fs=q("fs")}catch(t){this.fs=null}}function g(){}function m(t,e){return this.collection=t,this.filteredrows=[],this.filterInitialized=!1,this}function _(t,e,n){this.collection=t,this.name=e,this.rebuildPending=!1,this.options=n||{},this.options.hasOwnProperty("persistent")||(this.options.persistent=!1),this.options.hasOwnProperty("sortPriority")||(this.options.sortPriority="passive"),this.options.hasOwnProperty("minRebuildInterval")||(this.options.minRebuildInterval=1),this.resultset=new m(t),this.resultdata=[],this.resultsdirty=!1,this.cachedresultset=null,this.filterPipeline=[],this.collection.disableFreeze||Object.freeze(this.filterPipeline),this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,this.events={rebuild:[],filter:[],sort:[]}}function b(t,e){this.name=t,this.data=[],this.idIndex=null,this.binaryIndices={},this.constraints={unique:{},exact:{}},this.uniqueNames=[],this.transforms={},this.objType=t,this.dirty=!0,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null;var a=this,n=((e=e||{}).hasOwnProperty("unique")&&(Array.isArray(e.unique)||(e.unique=[e.unique]),e.unique.forEach(function(t){a.uniqueNames.push(t)})),e.hasOwnProperty("exact")&&e.exact.forEach(function(t){a.constraints.exact[t]=new R(t)}),this.adaptiveBinaryIndices=!e.hasOwnProperty("adaptiveBinaryIndices")||e.adaptiveBinaryIndices,this.transactional=!!e.hasOwnProperty("transactional")&&e.transactional,this.cloneObjects=!!e.hasOwnProperty("clone")&&e.clone,this.cloneMethod=e.hasOwnProperty("cloneMethod")?e.cloneMethod:"parse-stringify",this.asyncListeners=!!e.hasOwnProperty("asyncListeners")&&e.asyncListeners,this.disableMeta=!!e.hasOwnProperty("disableMeta")&&e.disableMeta,this.disableChangesApi=!e.hasOwnProperty("disableChangesApi")||e.disableChangesApi,this.disableDeltaChangesApi=!e.hasOwnProperty("disableDeltaChangesApi")||e.disableDeltaChangesApi,this.disableChangesApi&&(this.disableDeltaChangesApi=!0),this.autoupdate=!!e.hasOwnProperty("autoupdate")&&e.autoupdate,this.serializableIndices=!e.hasOwnProperty("serializableIndices")||e.serializableIndices,this.disableFreeze=!e.hasOwnProperty("disableFreeze")||e.disableFreeze,this.ttl={age:null,ttlInterval:null,daemon:null},this.setTTL(e.ttl||-1,e.ttlInterval),this.maxId=0,this.DynamicViews=[],this.events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this.changes=[],this.dirtyIds=[],[]);if(e&&e.indices)if("[object Array]"===Object.prototype.toString.call(e.indices))n=e.indices;else{if("string"!=typeof e.indices)throw new TypeError("Indices needs to be a string or an array of strings");n=[e.indices]}for(var r=0;r<n.length;r++)this.ensureIndex(n[r]);function u(t,e){var n=null!==e&&"object"===_typeof3(e)?Object.keys(e):null;if(n&&n.length&&["string","boolean","number"].indexOf(_typeof3(e))<0){for(var r={},i=0;i<n.length;i++){var o,s=n[i];e.hasOwnProperty(s)&&(!t.hasOwnProperty(s)||0<=a.uniqueNames.indexOf(s)||"$loki"==s||"meta"==s?r[s]=e[s]:void 0!==(o=u(t[s],e[s]))&&o!={}&&(r[s]=o))}return 0===Object.keys(r).length?void 0:r}return t===e?void 0:e}function i(){a.changes=[]}this.observerCallback=function(t){var e="function"==typeof Set?new Set:[];e.add||(e.add=function(t){return-1===this.indexOf(t)&&this.push(t),this}),t.forEach(function(t){e.add(t.object)}),e.forEach(function(t){if(!w.call(t,"$loki"))return a.removeAutoUpdateObserver(t);try{a.update(t)}catch(t){}})},this.getChangeDelta=function(t,e){return e?u(e,t):JSON.parse(JSON.stringify(t))},this.getObjectDelta=u,this.getChanges=function(){return a.changes},this.flushChanges=i,this.setChangesApi=function(t){a.disableChangesApi=!t,t||(a.disableDeltaChangesApi=!1)},this.on("delete",function(t){a.disableChangesApi||a.createChange(a.name,"R",t)}),this.on("warning",function(t){a.lokiConsoleWrapper.warn(t)}),i()}function x(t){return-1!==t.indexOf(".")}function O(t){return parseFloat(t,10)}function C(t,e){return t+e}function D(t,e){return t-e}function k(t){return t.reduce(C,0)/t.length}function A(t,e,n){if(!1===n)return t[e];for(var r=e.split("."),i=t;0<r.length;)i=i[r.shift()];return i}function M(t,e,n){for(var r,i,o=0,s=t.length;o<s;){if(0===(r=n.apply(null,[e,t[i=o+s>>1]])))return{found:!0,index:i};r<0?s=i:o=1+i}return{found:!1,index:s}}function L(n){return function(t,e){return M(t,e,n)}}function P(){}function T(t){this.field=t,this.keyMap=Object.create(null),this.lokiMap=Object.create(null)}function R(t){this.index=Object.create(null),this.field=t}return u.prototype.events={},u.prototype.asyncListeners=!1,u.prototype.on=function(t,e){var n=this;return Array.isArray(t)?t.forEach(function(t){n.on(t,e)}):(this.events[t]||(this.events[t]=[])).push(e),e},u.prototype.emit=function(t){var e,n=this;if(!t||!this.events[t])throw new Error("No event "+t+" defined");this.events[t].length&&(e=Array.prototype.slice.call(arguments,1),this.events[t].forEach(function(t){n.asyncListeners?setTimeout(function(){t.apply(n,e)},1):t.apply(n,e)}))},u.prototype.addListener=u.prototype.on,u.prototype.removeListener=function(t,e){var n=this;Array.isArray(t)?t.forEach(function(t){n.removeListener(t,e)}):this.events[t]&&(t=this.events[t]).splice(t.indexOf(e),1)},((l.prototype=new u).constructor=l).prototype.getIndexedAdapter=function(){var t;return t="function"==typeof q?q("./loki-indexed-adapter.js"):t},l.prototype.configureOptions=function(t,e){var n,r={fs:y,localStorage:g,memory:c};this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,void 0!==t&&(this.options=t,this.options.hasOwnProperty("persistenceMethod")&&"function"==typeof r[t.persistenceMethod]&&(this.persistenceMethod=t.persistenceMethod,this.persistenceAdapter=new r[t.persistenceMethod]),this.options.hasOwnProperty("adapter")&&(this.persistenceMethod="adapter",this.persistenceAdapter=t.adapter,this.options.adapter=null,this.isIncremental="incremental"===this.persistenceAdapter.mode),t.autoload&&e&&(n=this,setTimeout(function(){n.loadDatabase(t,t.autoloadCallback)},1)),this.options.hasOwnProperty("autosaveInterval")&&(this.autosaveDisable(),this.autosaveInterval=parseInt(this.options.autosaveInterval,10)),this.options.hasOwnProperty("autosave")&&this.options.autosave&&(this.autosaveDisable(),this.autosave=!0,this.options.hasOwnProperty("autosaveCallback")?this.autosaveEnable(t,t.autosaveCallback):this.autosaveEnable()),this.options.hasOwnProperty("throttledSaves"))&&(this.throttledSaves=this.options.throttledSaves),this.options.hasOwnProperty("serializationMethod")||(this.options.serializationMethod="normal"),this.options.hasOwnProperty("destructureDelimiter")||(this.options.destructureDelimiter="$<\n"),null===this.persistenceAdapter&&(this.persistenceMethod={NODEJS:"fs",BROWSER:"localStorage",CORDOVA:"localStorage",MEMORY:"memory"}[this.ENV],this.persistenceMethod)&&(this.persistenceAdapter=new r[this.persistenceMethod])},l.prototype.copy=function(t){var e,n,r=new l(this.filename,{env:"NA"});if(t=t||{},r.loadJSONObject(this,{retainDirtyFlags:!0}),t.hasOwnProperty("removeNonSerializable")&&!0===t.removeNonSerializable)for(r.autosaveHandle=null,r.persistenceAdapter=null,e=r.collections.length,n=0;n<e;n++)r.collections[n].constraints=null,r.collections[n].ttl=null;return r},l.prototype.addCollection=function(t,e){var n,r=this.collections.length;if(e&&!0===e.disableMeta){if(!1===e.disableChangesApi)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(!1===e.disableDeltaChangesApi)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if("number"==typeof e.ttl&&0<e.ttl)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}for(n=0;n<r;n+=1)if(this.collections[n].name===t)return this.collections[n];e=new b(t,e);return e.isIncremental=this.isIncremental,this.collections.push(e),this.verbose&&(e.lokiConsoleWrapper=console),e},l.prototype.loadCollection=function(t){if(!t.name)throw new Error("Collection must have a name property to be loaded");this.collections.push(t)},l.prototype.getCollection=function(t){for(var e=this.collections.length,n=0;n<e;n+=1)if(this.collections[n].name===t)return this.collections[n];return this.emit("warning","collection "+t+" not found"),null},l.prototype.renameCollection=function(t,e){t=this.getCollection(t);return t&&(t.name=e),t},l.prototype.listCollections=function(){for(var t=this.collections.length,e=[];t--;)e.push({name:this.collections[t].name,type:this.collections[t].objType,count:this.collections[t].data.length});return e},l.prototype.removeCollection=function(t){for(var e=this.collections.length,n=0;n<e;n+=1)if(this.collections[n].name===t){var r,i=new b(t,{}),o=this.collections[n];for(r in o)o.hasOwnProperty(r)&&i.hasOwnProperty(r)&&(o[r]=i[r]);return void this.collections.splice(n,1)}},l.prototype.getName=function(){return this.name},l.prototype.serializeReplacer=function(t,e){switch(t){case"autosaveHandle":case"persistenceAdapter":case"constraints":case"ttl":return null;case"throttledSavePending":case"throttledCallbacks":return;case"lokiConsoleWrapper":return null;default:return e}},l.prototype.toJson=l.prototype.serialize=function(t){switch((t=t||{}).hasOwnProperty("serializationMethod")||(t.serializationMethod=this.options.serializationMethod),t.serializationMethod){case"normal":return JSON.stringify(this,this.serializeReplacer);case"pretty":return JSON.stringify(this,this.serializeReplacer,2);case"destructured":return this.serializeDestructured();default:return JSON.stringify(this,this.serializeReplacer)}},l.prototype.serializeDestructured=function(t){var e,n,r,i,o,s=[];if((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),!0===t.partitioned&&t.hasOwnProperty("partition")&&0<=t.partition)return this.serializeCollection({delimited:t.delimited,delimiter:t.delimiter,collectionIndex:t.partition});for((o=new l(this.filename)).loadJSONObject(this),e=0;e<o.collections.length;e++)o.collections[e].data=[];if(!0===t.partitioned&&-1===t.partition)return o.serialize({serializationMethod:"normal"});for(s.push(o.serialize({serializationMethod:"normal"})),o=null,e=0;e<this.collections.length;e++)if(r=this.serializeCollection({delimited:t.delimited,delimiter:t.delimiter,collectionIndex:e}),!1===t.partitioned&&!1===t.delimited){if(!Array.isArray(r))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(i=r.length,n=0;n<i;n++)s.push(r[n]),r[n]=null;s.push("")}else s.push(r);return t.partitioned?(t.delimited,s):t.delimited?(s.push(""),s.join(t.delimiter)):(s.push(""),s)},l.prototype.serializeCollection=function(t){var e,n,r=[];if((t=t||{}).hasOwnProperty("delimited")||(t.delimited=!0),!t.hasOwnProperty("collectionIndex"))throw new Error("serializeCollection called without 'collectionIndex' option");for(e=this.collections[t.collectionIndex].data.length,r=[],n=0;n<e;n++)r.push(JSON.stringify(this.collections[t.collectionIndex].data[n]));return t.delimited?(r.push(""),r.join(t.delimiter)):r},l.prototype.deserializeDestructured=function(t,e){var n,r,i,o=[],s=0,a=1,u=!1;if((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),e.partitioned){if(e.hasOwnProperty("partition"))return-1===e.partition?JSON.parse(t[0]):this.deserializeCollection(t[e.partition+1],e);for(r=(n=JSON.parse(t[0])).collections.length,s=0;s<r;s++)n.collections[s].data=this.deserializeCollection(t[s+1],e)}else{if(e.delimited){if(o=t.split(e.delimiter),t=null,0===o.length)return null}else o=t;for(r=(n=JSON.parse(o[0])).collections.length,o[0]=null;!u;)o[a],""===o[a]?++s>r&&(u=!0):(i=JSON.parse(o[a]),n.collections[s].data.push(i)),o[a++]=null}return n},l.prototype.deserializeCollection=function(t,e){var n,r,i=[];for((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),e.delimited?(i=t.split(e.delimiter)).pop():i=t,r=i.length,n=0;n<r;n++)i[n]=JSON.parse(i[n]);return i},l.prototype.loadJSON=function(t,e){var n;if(0===t.length)n={};else switch(this.options.serializationMethod){case"normal":case"pretty":n=JSON.parse(t);break;case"destructured":n=this.deserializeDestructured(t);break;default:n=JSON.parse(t)}this.loadJSONObject(n,e)},l.prototype.loadJSONObject=function(t,e){var n,r,i,o,s,a,u=0,l=t.collections?t.collections.length:0;for(this.name=t.name,t.hasOwnProperty("throttledSaves")&&e&&!e.hasOwnProperty("throttledSaves")&&(this.throttledSaves=t.throttledSaves),this.collections=[];u<l;u+=1){if(n=t.collections[u],(r=this.addCollection(n.name,{disableChangesApi:n.disableChangesApi,disableDeltaChangesApi:n.disableDeltaChangesApi,disableMeta:n.disableMeta,disableFreeze:!n.hasOwnProperty("disableFreeze")||n.disableFreeze})).adaptiveBinaryIndices=!!n.hasOwnProperty("adaptiveBinaryIndices")&&!0===n.adaptiveBinaryIndices,r.transactional=n.transactional,r.asyncListeners=n.asyncListeners,r.cloneObjects=n.cloneObjects,r.cloneMethod=n.cloneMethod||"parse-stringify",r.autoupdate=n.autoupdate,r.changes=n.changes,r.dirtyIds=n.dirtyIds||[],e&&!0===e.retainDirtyFlags?r.dirty=n.dirty:r.dirty=!1,i=n.data.length,o=0,e&&e.hasOwnProperty(n.name))for(s=function(t){var n,r=e[t.name];return r.proto?(n=r.inflate||E.copyProperties,function(t){var e=new r.proto;return n(t,e),e}):r.inflate}(n);o<i;o++)a=s(n.data[o]),r.data[o]=a,r.addAutoUpdateObserver(a),r.disableFreeze||f(r.data[o]);else for(;o<i;o++)r.data[o]=n.data[o],r.addAutoUpdateObserver(r.data[o]),r.disableFreeze||f(r.data[o]);if(r.maxId=void 0===n.maxId?0:n.maxId,void 0!==n.binaryIndices&&(r.binaryIndices=n.binaryIndices),void 0!==n.transforms&&(r.transforms=n.transforms),r.uniqueNames=[],n.hasOwnProperty("uniqueNames")&&(r.uniqueNames=n.uniqueNames),void 0!==n.DynamicViews){for(var c=0;c<n.DynamicViews.length;c++){var p=n.DynamicViews[c],h=r.addDynamicView(p.name,p.options);h.resultdata=p.resultdata,h.resultsdirty=p.resultsdirty,h.filterPipeline=p.filterPipeline,h.sortCriteriaSimple=p.sortCriteriaSimple,h.sortCriteria=p.sortCriteria,h.sortFunction=null,h.sortDirty=p.sortDirty,r.disableFreeze||(f(h.filterPipeline),h.sortCriteriaSimple?f(h.sortCriteriaSimple):h.sortCriteria&&f(h.sortCriteria)),h.resultset.filteredrows=p.resultset.filteredrows,h.resultset.filterInitialized=p.resultset.filterInitialized,h.rematerialize({removeWhereFilters:!0})}t.databaseVersion<1.5&&(r.ensureAllIndexes(!0),r.dirty=!0)}}},l.prototype.close=function(t){this.autosave&&(this.autosaveDisable(),this.autosaveDirty())&&(this.saveDatabase(t),t=void 0),t&&this.on("close",t),this.emit("close")},l.prototype.generateChangesNotification=function(t){function e(t){return t.name}var n=[],r=t||this.collections.map(e);return this.collections.forEach(function(t){-1!==r.indexOf(t.name)&&(n=n.concat(t.getChanges()))}),n},l.prototype.serializeChanges=function(t){return JSON.stringify(this.generateChangesNotification(t))},l.prototype.clearChanges=function(){this.collections.forEach(function(t){t.flushChanges&&t.flushChanges()})},c.prototype.loadDatabase=function(t,e){var n=this;this.options.asyncResponses?setTimeout(function(){n.hashStore.hasOwnProperty(t)?e(n.hashStore[t].value):e(null)},this.options.asyncTimeout):this.hashStore.hasOwnProperty(t)?e(this.hashStore[t].value):e(null)},c.prototype.saveDatabase=function(t,e,n){var r,i=this;this.options.asyncResponses?setTimeout(function(){r=i.hashStore.hasOwnProperty(t)?i.hashStore[t].savecount:0,i.hashStore[t]={savecount:r+1,lastsave:new Date,value:e},n()},this.options.asyncTimeout):(r=this.hashStore.hasOwnProperty(t)?this.hashStore[t].savecount:0,this.hashStore[t]={savecount:r+1,lastsave:new Date,value:e},n())},c.prototype.deleteDatabase=function(t,e){this.hashStore.hasOwnProperty(t)&&delete this.hashStore[t],"function"==typeof e&&e()},p.prototype.loadDatabase=function(t,n){var r=this;this.dbname=t,this.dbref=new l(t),this.adapter.loadDatabase(t,function(t){var e;t?("string"!=typeof t&&n(new Error("LokiPartitioningAdapter received an unexpected response from inner adapter loadDatabase()")),e=JSON.parse(t),r.dbref.loadJSONObject(e),e=null,r.dbref.collections.length,0===r.dbref.collections.length?n(r.dbref):(r.pageIterator={collection:0,pageIndex:0},r.loadNextPartition(0,function(){n(r.dbref)}))):n(t)})},p.prototype.loadNextPartition=function(e,n){var t=this.dbname+"."+e,r=this;!0===this.options.paging?(this.pageIterator.pageIndex=0,this.loadNextPage(n)):this.adapter.loadDatabase(t,function(t){t=r.dbref.deserializeCollection(t,{delimited:!0,collectionIndex:e});r.dbref.collections[e].data=t,++e<r.dbref.collections.length?r.loadNextPartition(e,n):n()})},p.prototype.loadNextPage=function(i){var t=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,o=this;this.adapter.loadDatabase(t,function(t){var e,n=t.split(o.options.delimiter),r=n.length,t=(t="")===n[r-1];for(t&&(n.pop(),""===n[(r=n.length)-1])&&1===r&&(n.pop(),r=n.length),e=0;e<r;e++)o.dbref.collections[o.pageIterator.collection].data.push(JSON.parse(n[e])),n[e]=null;n=[],t?++o.pageIterator.collection<o.dbref.collections.length?o.loadNextPartition(o.pageIterator.collection,i):i():(o.pageIterator.pageIndex++,o.loadNextPage(i))})},p.prototype.exportDatabase=function(t,e,n){var r,i=e.collections.length;for(this.dbref=e,this.dbname=t,this.dirtyPartitions=[-1],r=0;r<i;r++)e.collections[r].dirty&&this.dirtyPartitions.push(r);this.saveNextPartition(function(t){n(t)})},p.prototype.saveNextPartition=function(e){var n=this,t=this.dirtyPartitions.shift(),r=this.dbname+(-1===t?"":"."+t);this.options.paging&&-1!==t?(this.pageIterator={collection:t,docIndex:0,pageIndex:0},this.saveNextPage(function(t){0===n.dirtyPartitions.length?e(t):n.saveNextPartition(e)})):(t=this.dbref.serializeDestructured({partitioned:!0,delimited:!0,partition:t}),this.adapter.saveDatabase(r,t,function(t){t?e(t):0===n.dirtyPartitions.length?e(null):n.saveNextPartition(e)}))},p.prototype.saveNextPage=function(e){function t(t){l="",t&&e(t),c?e(null):(r.pageIterator.pageIndex++,r.saveNextPage(e))}var n,r=this,i=this.dbref.collections[this.pageIterator.collection],o=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,s=0,a=i.data.length,u=this.options.delimiter.length,l="",c=!1,p=!1;for(0===i.data.length&&(c=!0);;)if(c||(n=JSON.stringify(i.data[this.pageIterator.docIndex]),l+=n,s+=n.length,++this.pageIterator.docIndex>=a&&(c=!0)),(p=s>=this.options.pageSize?!0:p)&&!c||(l+=this.options.delimiter,s+=u),c||p)return void this.adapter.saveDatabase(o,l,t)},y.prototype.loadDatabase=function(n,r){var i=this;this.fs.stat(n,function(t,e){!t&&e.isFile()?i.fs.readFile(n,{encoding:"utf8"},function(t,e){r(t?new Error(t):e)}):r(null)})},y.prototype.saveDatabase=function(e,t,n){var r=this,i=e+"~";this.fs.writeFile(i,t,function(t){t?n(new Error(t)):r.fs.rename(i,e,n)})},y.prototype.deleteDatabase=function(t,e){this.fs.unlink(t,function(t){t?e(new Error(t)):e()})},g.prototype.loadDatabase=function(t,e){i()?e(localStorage.getItem(t)):e(new Error("localStorage is not available"))},g.prototype.saveDatabase=function(t,e,n){i()?(localStorage.setItem(t,e),n(null)):n(new Error("localStorage is not available"))},g.prototype.deleteDatabase=function(t,e){i()?(localStorage.removeItem(t),e(null)):e(new Error("localStorage is not available"))},l.prototype.throttledSaveDrain=function(t,e){var n=this,r=(new Date).getTime();this.throttledSaves||t(!0),(e=e||{}).hasOwnProperty("recursiveWait")||(e.recursiveWait=!0),e.hasOwnProperty("recursiveWaitLimit")||(e.recursiveWaitLimit=!1),e.hasOwnProperty("recursiveWaitLimitDuration")||(e.recursiveWaitLimitDuration=2e3),e.hasOwnProperty("started")||(e.started=(new Date).getTime()),this.throttledSaves&&this.throttledSavePending?e.recursiveWait?this.throttledCallbacks.push(function(){n.throttledSavePending?e.recursiveWaitLimit&&r-e.started>e.recursiveWaitLimitDuration?t(!1):n.throttledSaveDrain(t,e):t(!0)}):this.throttledCallbacks.push(t):t(!0)},l.prototype.loadDatabaseInternal=function(n,t){var r=t||function(t,e){if(t)throw t},i=this;null!==this.persistenceAdapter?this.persistenceAdapter.loadDatabase(this.filename,function(t){if("string"==typeof t){var e=!1;try{i.loadJSON(t,n||{}),e=!0}catch(t){r(t)}e&&(r(null),i.emit("loaded","database "+i.filename+" loaded"))}else t?t instanceof Error?r(t):"object"===_typeof3(t)?(i.loadJSONObject(t,n||{}),r(null),i.emit("loaded","database "+i.filename+" loaded")):r("unexpected adapter response : "+t):(r(null),i.emit("loaded","empty database "+i.filename+" loaded"))}):r(new Error("persistenceAdapter not configured"))},l.prototype.loadDatabase=function(e,n){var r=this;this.throttledSaves?this.throttledSaveDrain(function(t){t?(r.throttledSavePending=!0,r.loadDatabaseInternal(e,function(t){0===r.throttledCallbacks.length?r.throttledSavePending=!1:r.saveDatabase(),"function"==typeof n&&n(t)})):"function"==typeof n&&n(new Error("Unable to pause save throttling long enough to read database"))},e):this.loadDatabaseInternal(e,n)},l.prototype.saveDatabaseInternal=function(t){var n,e=t||function(t){if(t)throw t},r=this;this.persistenceAdapter?"incremental"===this.persistenceAdapter.mode?(this.ignoreAutosave=!0,this.persistenceAdapter.saveDatabase(this.filename,function(){var t;if(r.ignoreAutosave=!1,!n)return t=r.copy({removeNonSerializable:!0}),n=r.collections.map(function(t){return[t.dirty,t.dirtyIds]}),r.collections.forEach(function(t){t.dirty=!1,t.dirtyIds=[]}),t;e(new Error("adapter error - getLokiCopy called more than once"))},function(t){r.ignoreAutosave=!1,t&&n&&r.collections.forEach(function(t,e){e=n[e];t.dirty=t.dirty||e[0],t.dirtyIds=t.dirtyIds.concat(e[1])}),e(t)})):"reference"===this.persistenceAdapter.mode&&"function"==typeof this.persistenceAdapter.exportDatabase?this.persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}),function(t){r.autosaveClearFlags(),e(t)}):(this.autosaveClearFlags(),this.persistenceAdapter.saveDatabase(this.filename,this.serialize(),function(t){e(t)})):e(new Error("persistenceAdapter not configured"))},l.prototype.save=l.prototype.saveDatabase=function(t){var n,r;this.throttledSaves?this.throttledSavePending?this.throttledCallbacks.push(t):(n=this.throttledCallbacks,this.throttledCallbacks=[],n.unshift(t),this.throttledSavePending=!0,(r=this).saveDatabaseInternal(function(e){r.throttledSavePending=!1,n.forEach(function(t){"function"==typeof t&&setTimeout(function(){t(e)},1)}),0<r.throttledCallbacks.length&&r.saveDatabase()})):this.saveDatabaseInternal(t)},l.prototype.deleteDatabase=function(t,e){var n="function"!=typeof t||e?e||function(t,e){if(t)throw t}:t;null!==this.persistenceAdapter?this.persistenceAdapter.deleteDatabase(this.filename,function(t){n(t)}):n(new Error("persistenceAdapter not configured"))},l.prototype.autosaveDirty=function(){for(var t=0;t<this.collections.length;t++)if(this.collections[t].dirty)return!0;return!1},l.prototype.autosaveClearFlags=function(){for(var t=0;t<this.collections.length;t++)this.collections[t].dirty=!1},l.prototype.autosaveEnable=function(t,e){this.autosave=!0;var n=5e3,r=this;void 0!==this.autosaveInterval&&null!==this.autosaveInterval&&(n=this.autosaveInterval),this.autosaveHandle=setInterval(function(){r.autosaveDirty()&&!r.ignoreAutosave&&r.saveDatabase(e)},n)},l.prototype.autosaveDisable=function(){void 0!==this.autosaveHandle&&null!==this.autosaveHandle&&(clearInterval(this.autosaveHandle),this.autosaveHandle=null)},m.prototype.reset=function(){return 0<this.filteredrows.length&&(this.filteredrows=[]),this.filterInitialized=!1,this},m.prototype.toJSON=function(){var t=this.copy();return t.collection=null,t},m.prototype.limit=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var e=new m(this.collection);return e.filteredrows=this.filteredrows.slice(0,t),e.filterInitialized=!0,e},m.prototype.offset=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var e=new m(this.collection);return e.filteredrows=this.filteredrows.slice(t),e.filterInitialized=!0,e},m.prototype.branch=m.prototype.copy=function(){var t=new m(this.collection);return 0<this.filteredrows.length&&(t.filteredrows=this.filteredrows.slice()),t.filterInitialized=this.filterInitialized,t},m.prototype.transform=function(t,e){var n,r,i=this;if("object"!==_typeof3(t="string"==typeof t&&this.collection.transforms.hasOwnProperty(t)?this.collection.transforms[t]:t)||!Array.isArray(t))throw new Error("Invalid transform");for(void 0!==e&&(t=E.resolveTransformParams(t,e)),n=0;n<t.length;n++)switch((r=t[n]).type){case"find":i.find(r.value);break;case"where":i.where(r.value);break;case"simplesort":i.simplesort(r.property,r.desc||r.options);break;case"compoundsort":i.compoundsort(r.value);break;case"sort":i.sort(r.value);break;case"limit":i=i.limit(r.value);break;case"offset":i=i.offset(r.value);break;case"map":i=i.map(r.value,r.dataOptions);break;case"eqJoin":i=i.eqJoin(r.joinData,r.leftJoinKey,r.rightJoinKey,r.mapFun,r.dataOptions);break;case"mapReduce":i=i.mapReduce(r.mapFunction,r.reduceFunction);break;case"update":i.update(r.value);break;case"remove":i.remove()}return i},m.prototype.sort=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());function e(t,e){return n(r[t],r[e])}var n,r;n=t,r=this.collection.data;return this.filteredrows.sort(e),this},m.prototype.simplesort=function(n,t){var r,i,o,s,a,e=10,u=this.collection.data.length,l=this.filteredrows.length,c=this.collection.binaryIndices.hasOwnProperty(n);if(!0===(t=void 0!==t&&!1!==t?t:{desc:!1})&&(t={desc:!0}),0===l){if(this.filterInitialized)return this;if(this.collection.binaryIndices.hasOwnProperty(n))return this.collection.ensureIndex(n),this.filteredrows=this.collection.binaryIndices[n].values.slice(0),t.desc&&this.filteredrows.reverse(),this;this.filteredrows=this.collection.prepareFullDocIndex()}else if(!t.disableIndexIntersect&&c&&(u/l<=(e=t.useJavascriptSorting?6:e)||t.forceIndexIntersect)){for(var p=this.filteredrows,h={},f=0;f<l;f++)h[p[f]]=!0;c=this.collection.binaryIndices[n].values;return this.filteredrows=c.filter(function(t){return h[t]}),t.desc&&this.filteredrows.reverse(),this}return t.useJavascriptSorting?this.sort(function(t,e){return t[n]===e[n]?0:t[n]>e[n]?1:t[n]<e[n]?-1:void 0}):(r=n,i=t.desc,o=this.collection.data,this.filteredrows.sort(function(t,e){return a=~r.indexOf(".")?(a=r.split("."),s=E.getIn(o[t],a,!0),E.getIn(o[e],a,!0)):(s=o[t][r],o[e][r]),d(s,a,i)}),this)},m.prototype.compoundsort=function(t){if(0===t.length)throw new Error("Invalid call to compoundsort, need at least one property");var e;if(1===t.length)return e=t[0],Array.isArray(e)?this.simplesort(e[0],e[1]):this.simplesort(e,!1);for(var p,h,n=0,r=t.length;n<r;n+=1)e=t[n],Array.isArray(e)||(t[n]=[e,!1]);return this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex()),p=t,h=this.collection.data,this.filteredrows.sort(function(t,e){for(var n,r,i,o,s=p,a=h[t],u=h[e],l=0,c=s.length;l<c;l++)if(o=~(r=(n=s[l])[0]).indexOf(".")?(o=r.split("."),i=E.getIn(a,o,!0),E.getIn(u,o,!0)):(i=a[r],u[r]),0!==(r=d(i,o,n[1])))return r;return 0}),this},m.prototype.$or=m.prototype.findOr=function(t){for(var e,n,r,i=0,o=[],s=[],a=(this.count(),0),u=t.length;a<u;a++)for(n=(e=this.branch().find(t[a]).filteredrows).length,i=0;i<n;i++)void 0===s[r=e[i]]&&(s[r]=!0,o.push(r));return this.filteredrows=o,this.filterInitialized=!0,this},m.prototype.$and=m.prototype.findAnd=function(t){for(var e=0,n=t.length;e<n;e++){if(0===this.count())return this;this.find(t[e])}return this},m.prototype.find=function(t,e){if(0===this.collection.data.length)this.filteredrows=[],this.filterInitialized=!0;else{var n,r,i,o,s,a,u,l=t||"getAll",t=!1,c=[],p=[],h=null;if(e=e||!1,"object"===_typeof3(l)){for(n in l)(o={})[n]=l[n],p.push(o),w.call(l,n)&&(i=l[r=n]);if(1<p.length)return this.find({$and:p},e)}if(r&&"getAll"!==l)if("$and"===r||"$or"===r)this[r](i),e&&1<this.filteredrows.length&&(this.filteredrows=this.filteredrows.slice(0,1));else{if(null===i||"object"!==_typeof3(i)||i instanceof Date)s="$eq",a=i;else{if("object"!==_typeof3(i))throw new Error("Do not know what you want to do.");for(u in i)if(w.call(i,u)){a=i[s=u];break}}"$regex"!==s&&"object"!==_typeof3(a)||(a=function t(e,n){if("$regex"===e)Array.isArray(n)?n=new RegExp(n[0],n[1]):n instanceof RegExp||(n=new RegExp(n));else if("object"===_typeof3(n))for(var r in n)"$regex"!==r&&"object"!==_typeof3(n[r])||(n[r]=t(r,n[r]));return n}(s,a));var f,d,y=-1!==r.indexOf("."),g=(!this.filterInitialized&&this.collection.binaryIndices[r]&&N[s]&&(!0!==this.collection.adaptiveBinaryIndices&&this.collection.ensureIndex(r),t=!0,h=this.collection.binaryIndices[r]),!t&&"$in"===s&&Array.isArray(a)&&"undefined"!=typeof Set&&(a=new Set(a),s="$inSet"),I[s]),m=this.collection.data,v=0,_=0,b=0;if(this.filterInitialized){if(_=(f=this.filteredrows).length,y){for(r=r.split("."),v=0;v<_;v++)if(S(d=m[b=f[v]],r,g,a,d)&&(c.push(b),e))return this.filteredrows=c,this}else for(v=0;v<_;v++)if(g((d=m[b=f[v]])[r],a,d)&&(c.push(b),e))return this.filteredrows=c,this}else if(t){var x=this.collection.calculateRange(s,r,a);if("$in"!==s){for(v=x[0];v<=x[1];v++)if(!0!==N[s]){if(N[s](E.getIn(m[h.values[v]],r,y),a)&&(c.push(h.values[v]),e))return this.filteredrows=c,this.filterInitialized=!0,this}else if(c.push(h.values[v]),e)return this.filteredrows=c,this.filterInitialized=!0,this}else for(v=0,_=x.length;v<_;v++)if(c.push(h.values[x[v]]),e)return this.filteredrows=c,this.filterInitialized=!0,this}else if(_=m.length,y){for(r=r.split("."),v=0;v<_;v++)if(S(d=m[v],r,g,a,d)&&(c.push(v),e))return this.filteredrows=c,this.filterInitialized=!0,this}else for(v=0;v<_;v++)if(g((d=m[v])[r],a,d)&&(c.push(v),e))return this.filteredrows=c,this.filterInitialized=!0,this;this.filteredrows=c,this.filterInitialized=!0}else e&&(this.filterInitialized?this.filteredrows=this.filteredrows.slice(0,1):(this.filteredrows=0<this.collection.data.length?[0]:[],this.filterInitialized=!0))}return this},m.prototype.where=function(t){var e,n=[];if("function"!=typeof t)throw new TypeError("Argument is not a stored view or a function");e=t;try{if(this.filterInitialized){for(var r=this.filteredrows.length;r--;)!0===e(this.collection.data[this.filteredrows[r]])&&n.push(this.filteredrows[r]);this.filteredrows=n}else{for(var i=this.collection.data.length;i--;)!0===e(this.collection.data[i])&&n.push(i);this.filteredrows=n,this.filterInitialized=!0}return this}catch(t){throw t}},m.prototype.count=function(){return this.filterInitialized?this.filteredrows.length:this.collection.count()},m.prototype.data=function(t){var e,n,r,i=[],o=this.collection.data;if((t=t||{}).removeMeta&&!t.forceClones&&(t.forceClones=!0,t.forceCloneMethod=t.forceCloneMethod||"shallow"),!this.collection.disableDeltaChangesApi&&this.collection.disableFreeze&&(t.forceClones=!0,t.forceCloneMethod="parse-stringify"),!this.filterInitialized){if(0===this.filteredrows.length){if(this.collection.cloneObjects||t.forceClones){for(a=o.length,r=t.forceCloneMethod||this.collection.cloneMethod,n=0;n<a;n++)e=h(o[n],r),t.removeMeta&&(delete e.$loki,delete e.meta),i.push(e);return i}return o.slice()}this.filterInitialized=!0}var s=this.filteredrows,a=s.length;if(this.collection.cloneObjects||t.forceClones)for(r=t.forceCloneMethod||this.collection.cloneMethod,n=0;n<a;n++)e=h(o[s[n]],r),t.removeMeta&&(delete e.$loki,delete e.meta),i.push(e);else for(n=0;n<a;n++)i.push(o[s[n]]);return i},m.prototype.update=function(t){if("function"!=typeof t)throw new TypeError("Argument is not a function");this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());for(var e,n=this.filteredrows.length,r=this.collection.data,i=0;i<n;i++)this.disableFreeze&&!this.collection.cloneObjects&&this.collection.disableDeltaChangesApi?(t(r[this.filteredrows[i]]),this.collection.update(r[this.filteredrows[i]])):(t(e=h(r[this.filteredrows[i]],this.collection.cloneMethod)),this.collection.update(e));return this},m.prototype.remove=function(){return this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex()),this.collection.removeBatchByPositions(this.filteredrows),this.filteredrows=[],this},m.prototype.mapReduce=function(t,e){try{return e(this.data().map(t))}catch(t){throw t}},m.prototype.eqJoin=function(t,e,n,r,i){var o,s,a=[],u=[],l="function"==typeof e,c="function"==typeof n,p={},h=(s=this.data(i)).length;if(t instanceof b)a=t.chain().data(i);else if(t instanceof m)a=t.data(i);else{if(!Array.isArray(t))throw new TypeError("joinData needs to be an array or result set");a=t}for(var f=a.length,d=0;d<f;d++)p[o=c?n(a[d]):a[d][n]]=a[d];r=r||function(t,e){return{left:t,right:e}};for(var y=0;y<h;y++)o=l?e(s[y]):s[y][e],u.push(r(s[y],p[o]||{}));return this.collection=new b("joinData"),this.collection.insert(u),this.filteredrows=[],this.filterInitialized=!1,this},m.prototype.map=function(t,e){e=this.data(e).map(t);return this.collection=new b("mappedData"),this.collection.insert(e),this.filteredrows=[],this.filterInitialized=!1,this},((_.prototype=new u).constructor=_).prototype.getSort=function(){return this.sortFunction||this.sortCriteria||this.sortCriteriaSimple},_.prototype.rematerialize=function(t){t=t||{},this.resultdata=[],this.resultsdirty=!0,this.resultset=new m(this.collection),(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple)&&(this.sortDirty=!0);var e,n,r,i=Object.isFrozen(this.filterPipeline);if(t.hasOwnProperty("removeWhereFilters"))for(i&&(this.filterPipeline=this.filterPipeline.slice()),n=e=this.filterPipeline.length;n--;)"where"===this.filterPipeline[n].type&&(n!==this.filterPipeline.length-1&&(this.filterPipeline[n]=this.filterPipeline[this.filterPipeline.length-1]),this.filterPipeline.length--);var o=this.filterPipeline;for(this.filterPipeline=[],e=o.length,r=0;r<e;r++)this.applyFind(o[r].val,o[r].uid);return i&&Object.freeze(this.filterPipeline),this.data(),this.emit("rebuild",this),this},_.prototype.branchResultset=function(t,e){var n=this.resultset.branch();return void 0===t?n:n.transform(t,e)},_.prototype.toJSON=function(){var t=new _(this.collection,this.name,this.options);return t.resultset=this.resultset,t.resultdata=[],t.resultsdirty=!0,t.filterPipeline=this.filterPipeline,t.sortFunction=this.sortFunction,t.sortCriteria=this.sortCriteria,t.sortCriteriaSimple=this.sortCriteriaSimple||null,t.sortDirty=this.sortDirty,t.collection=null,t},_.prototype.removeFilters=function(t){t=t||{},this.rebuildPending=!1,this.resultset.reset(),this.resultdata=[],this.resultsdirty=!0,this.cachedresultset=null;var e=Object.isFrozen(this.filterPipeline),n=0<this.filterPipeline.length;this.filterPipeline=[],e&&Object.freeze(this.filterPipeline),this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,!(this.sortDirty=!1)===t.queueSortPhase&&this.queueSortPhase(),n&&this.emit("filter")},_.prototype.applySort=function(t){return this.sortFunction=t,this.sortCriteria=null,this.sortCriteriaSimple=null,this.queueSortPhase(),this.emit("sort"),this},_.prototype.applySimpleSort=function(t,e){return this.sortCriteriaSimple={propname:t,options:e||!1},this.collection.disableFreeze||f(this.sortCriteriaSimple),this.sortCriteria=null,this.sortFunction=null,this.queueSortPhase(),this.emit("sort"),this},_.prototype.applySortCriteria=function(t){return this.sortCriteria=t,this.collection.disableFreeze||f(this.sortCriteria),this.sortCriteriaSimple=null,this.sortFunction=null,this.queueSortPhase(),this.emit("sort"),this},_.prototype.startTransaction=function(){return this.cachedresultset=this.resultset.copy(),this},_.prototype.commit=function(){return this.cachedresultset=null,this},_.prototype.rollback=function(){return this.resultset=this.cachedresultset,this.options.persistent&&(this.resultdata=this.resultset.data(),this.emit("rebuild",this)),this},_.prototype._indexOfFilterWithId=function(t){if("string"==typeof t||"number"==typeof t)for(var e=0,n=this.filterPipeline.length;e<n;e+=1)if(t===this.filterPipeline[e].uid)return e;return-1},_.prototype._addFilter=function(t){var e=Object.isFrozen(this.filterPipeline);e&&(this.filterPipeline=this.filterPipeline.slice()),this.collection.disableFreeze||f(t),this.filterPipeline.push(t),e&&Object.freeze(this.filterPipeline),this.resultset[t.type](t.val)},_.prototype.reapplyFilters=function(){this.resultset.reset(),this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0);var t=this.filterPipeline,e=Object.isFrozen(t);this.filterPipeline=[];for(var n=0,r=t.length;n<r;n+=1)this._addFilter(t[n]);return e&&Object.freeze(this.filterPipeline),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this.emit("filter"),this},_.prototype.applyFilter=function(t){var e,n=this._indexOfFilterWithId(t.uid);return 0<=n?((e=Object.isFrozen(this.filterPipeline))&&(this.filterPipeline=this.filterPipeline.slice()),this.filterPipeline[n]=t,e&&(s(t),Object.freeze(this.filterPipeline)),this.reapplyFilters()):(this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0),this._addFilter(t),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this.emit("filter"),this)},_.prototype.applyFind=function(t,e){return this.applyFilter({type:"find",val:t,uid:e}),this},_.prototype.applyWhere=function(t,e){return this.applyFilter({type:"where",val:t,uid:e}),this},_.prototype.removeFilter=function(t){var e=this._indexOfFilterWithId(t);if(e<0)throw new Error("Dynamic view does not contain a filter with ID: "+t);t=Object.isFrozen(this.filterPipeline);return t&&(this.filterPipeline=this.filterPipeline.slice()),this.filterPipeline.splice(e,1),t&&Object.freeze(this.filterPipeline),this.reapplyFilters(),this},_.prototype.count=function(){return this.resultsdirty&&(this.resultdata=this.resultset.data()),this.resultset.count()},_.prototype.data=function(t){return(this.sortDirty||this.resultsdirty)&&this.performSortPhase({suppressRebuildEvent:!0}),this.options.persistent?this.resultdata:this.resultset.data(t)},_.prototype.queueRebuildEvent=function(){var t;this.rebuildPending||(this.rebuildPending=!0,t=this,setTimeout(function(){t.rebuildPending&&(t.rebuildPending=!1,t.emit("rebuild",t))},this.options.minRebuildInterval))},_.prototype.queueSortPhase=function(){var t;this.sortDirty||(this.sortDirty=!0,"active"===(t=this).options.sortPriority?setTimeout(function(){t.performSortPhase()},this.options.minRebuildInterval):this.queueRebuildEvent())},_.prototype.performSortPhase=function(t){(this.sortDirty||this.resultsdirty)&&(t=t||{},this.sortDirty&&(this.sortFunction?this.resultset.sort(this.sortFunction):this.sortCriteria?this.resultset.compoundsort(this.sortCriteria):this.sortCriteriaSimple&&this.resultset.simplesort(this.sortCriteriaSimple.propname,this.sortCriteriaSimple.options),this.sortDirty=!1),this.options.persistent&&(this.resultdata=this.resultset.data(),this.resultsdirty=!1),t.suppressRebuildEvent||this.emit("rebuild",this))},_.prototype.evaluateDocument=function(t,e){if(this.resultset.filterInitialized){var n,r=this.resultset.filteredrows,e=e?-1:r.indexOf(+t),i=r.length,o=new m(this.collection);o.filteredrows=[t],o.filterInitialized=!0;for(var s=0,a=this.filterPipeline.length;s<a;s++)o[(n=this.filterPipeline[s]).type](n.val);var u=0===o.filteredrows.length?-1:0;-1===e&&-1==u||(-1===e&&-1!=u?(r.push(t),this.options.persistent&&this.resultdata.push(this.collection.data[t]),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent()):-1!==e&&-1==u?(e<i-1?(r.splice(e,1),this.options.persistent&&this.resultdata.splice(e,1)):(r.length=i-1,this.options.persistent&&(this.resultdata.length=i-1)),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent()):-1!==e&&-1!=u&&(this.options.persistent&&(this.resultdata[e]=this.collection.data[t]),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent()))}else this.options.persistent&&(this.resultdata=this.resultset.data()),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent()},_.prototype.removeDocument=function(t){var e,n,r,i={},o={},s=this.resultset,a=this.resultset.filteredrows,u=a.length;if(this.resultset.filterInitialized){for(n=(t=Array.isArray(t)?t:[t]).length,e=0;e<n;e++)i[t[e]]=!0;for(l=0;l<u;l++)i[a[l]]&&(o[l]=!0);0<Object.keys(o).length&&(this.resultset.filteredrows=this.resultset.filteredrows.filter(function(t,e){return!o[e]}),this.options.persistent&&(this.resultdata=this.resultdata.filter(function(t,e){return!o[e]})),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());for(var u=s.filteredrows.length,l=0;l<u;l++)r=t.filter(function(e){return function(t){return t<s.filteredrows[e]}}(l)),s.filteredrows[l]-=r.length}else this.options.persistent&&(this.resultdata=this.resultset.data()),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent()},_.prototype.mapReduce=function(t,e){try{return e(this.data().map(t))}catch(t){throw t}},((b.prototype=new u).contructor=b).prototype.createChange=function(t,e,n,r){this.changes.push({name:t,operation:e,obj:"U"!=e||this.disableDeltaChangesApi?JSON.parse(JSON.stringify(n)):this.getChangeDelta(n,r)})},b.prototype.insertMeta=function(t){var e,n;if(!this.disableMeta&&t)if(Array.isArray(t))for(e=t.length,n=0;n<e;n++)t[n].hasOwnProperty("meta")||(t[n].meta={}),t[n].meta.created=(new Date).getTime(),t[n].meta.revision=0;else t.meta||(t.meta={}),t.meta.created=(new Date).getTime(),t.meta.revision=0},b.prototype.updateMeta=function(t){return!this.disableMeta&&t&&(this.disableFreeze||((t=a(t)).meta=a(t.meta)),t.meta.updated=(new Date).getTime(),t.meta.revision+=1),t},b.prototype.createInsertChange=function(t){this.createChange(this.name,"I",t)},b.prototype.createUpdateChange=function(t,e){this.createChange(this.name,"U",t,e)},b.prototype.insertMetaWithChange=function(t){this.insertMeta(t),this.createInsertChange(t)},b.prototype.updateMetaWithChange=function(t,e,n){return t=this.updateMeta(t,n),this.createUpdateChange(t,e),t},b.prototype.lokiConsoleWrapper={log:function(){},warn:function(){},error:function(){}},b.prototype.addAutoUpdateObserver=function(t){this.autoupdate&&"function"==typeof Object.observe&&Object.observe(t,this.observerCallback,["add","update","delete","reconfigure","setPrototype"])},b.prototype.removeAutoUpdateObserver=function(t){this.autoupdate&&"function"==typeof Object.observe&&Object.unobserve(t,this.observerCallback)},b.prototype.addTransform=function(t,e){if(this.transforms.hasOwnProperty(t))throw new Error("a transform by that name already exists");this.transforms[t]=e},b.prototype.getTransform=function(t){return this.transforms[t]},b.prototype.setTransform=function(t,e){this.transforms[t]=e},b.prototype.removeTransform=function(t){delete this.transforms[t]},b.prototype.byExample=function(t){var e,n,r=[];for(e in t)t.hasOwnProperty(e)&&r.push(((n={})[e]=t[e],n));return{$and:r}},b.prototype.findObject=function(t){return this.findOne(this.byExample(t))},b.prototype.findObjects=function(t){return this.find(this.byExample(t))},b.prototype.ttlDaemonFuncGen=function(){var t=this,n=this.ttl.age;return function(){var e=Date.now();t.chain().where(function(t){t=t.meta.updated||t.meta.created;return n<e-t}).remove()}},b.prototype.setTTL=function(t,e){t<0?clearInterval(this.ttl.daemon):(this.ttl.age=t,this.ttl.ttlInterval=e,this.ttl.daemon=setInterval(this.ttlDaemonFuncGen(),e))},b.prototype.prepareFullDocIndex=function(){for(var t=this.data.length,e=new Array(t),n=0;n<t;n+=1)e[n]=n;return e},b.prototype.configureOptions=function(t){(t=t||{}).hasOwnProperty("adaptiveBinaryIndices")&&(this.adaptiveBinaryIndices=t.adaptiveBinaryIndices,this.adaptiveBinaryIndices)&&this.ensureAllIndexes()},b.prototype.ensureIndex=function(t,e){if(void 0===e&&(e=!1),null==t)throw new Error("Attempting to set index without an associated property");var n,r,i,o,s;this.binaryIndices[t]&&!e&&!this.binaryIndices[t].dirty||!0===this.adaptiveBinaryIndices&&this.binaryIndices.hasOwnProperty(t)&&!e||(e={name:t,dirty:!0,values:this.prepareFullDocIndex()},this.binaryIndices[t]=e,n=t,r=this.data,s=!!~n.indexOf(".")&&n.split("."),e.values.sort(function(t,e){if(o=s?(i=E.getIn(r[t],s,!0),E.getIn(r[e],s,!0)):(i=r[t][n],r[e][n]),i!==o){if(v.lt(i,o,!1))return-1;if(v.gt(i,o,!1))return 1}return 0}),e.dirty=!1,this.dirty=!0)},b.prototype.checkAllIndexes=function(t){var e,n=this.binaryIndices,r=[];for(e in n)!w.call(n,e)||this.checkIndex(e,t)||r.push(e);return r},b.prototype.checkIndex=function(t,e){(e=e||{}).randomSamplingFactor&&!1!==e.randomSampling&&(e.randomSampling=!0),e.randomSamplingFactor=e.randomSamplingFactor||.1,(e.randomSamplingFactor<0||1<e.randomSamplingFactor)&&(e.randomSamplingFactor=.1);var n,r,i,o,s,a=!0;if(!this.binaryIndices.hasOwnProperty(t))throw new Error("called checkIndex on property without an index: "+t);if(this.adaptiveBinaryIndices||this.ensureIndex(t),(o=(s=this.binaryIndices[t].values).length)!==this.data.length)return e.repair&&this.ensureIndex(t,!0),!1;if(0===o)return!0;var u=-1!==t.indexOf(".");if(1===o)a=0===s[0];else if(e.randomSampling){if(I.$lte(E.getIn(this.data[s[0]],t,u),E.getIn(this.data[s[1]],t,u))||(a=!1),a=I.$lte(E.getIn(this.data[s[o-2]],t,u),E.getIn(this.data[s[o-1]],t,u))?a:!1)for(r=Math.floor((o-1)*e.randomSamplingFactor),n=0;n<r-1;n++)if(i=Math.floor(Math.random()*(o-1)),!I.$lte(E.getIn(this.data[s[i]],t,u),E.getIn(this.data[s[i+1]],t,u))){a=!1;break}}else for(n=0;n<o-1;n++)if(!I.$lte(E.getIn(this.data[s[n]],t,u),E.getIn(this.data[s[n+1]],t,u))){a=!1;break}return!a&&e.repair&&this.ensureIndex(t,!0),a},b.prototype.getBinaryIndexValues=function(t){for(var e=this.binaryIndices[t].values,n=[],r=0;r<e.length;r++)n.push(E.getIn(this.data[e[r]],t,!0));return n},b.prototype.getUniqueIndex=function(t,e){var n=this.constraints.unique[t];return!n&&e?this.ensureUniqueIndex(t):n},b.prototype.ensureUniqueIndex=function(t){var e=this.constraints.unique[t];return e||-1==this.uniqueNames.indexOf(t)&&this.uniqueNames.push(t),this.constraints.unique[t]=e=new T(t),this.data.forEach(function(t){e.set(t)}),e},b.prototype.ensureAllIndexes=function(t){var e,n=this.binaryIndices;for(e in n)w.call(n,e)&&this.ensureIndex(e,t)},b.prototype.flagBinaryIndexesDirty=function(){var t,e=this.binaryIndices;for(t in e)w.call(e,t)&&(e[t].dirty=!0)},b.prototype.flagBinaryIndexDirty=function(t){this.binaryIndices[t]&&(this.binaryIndices[t].dirty=!0)},b.prototype.count=function(t){return(t?this.chain().find(t).filteredrows:this.data).length},b.prototype.ensureId=function(){if(!this.idIndex){for(var t=this.data,e=0,n=t.length,r=new Array(n);e<n;e++)r[e]=t[e].$loki;this.idIndex=r}},b.prototype.ensureIdAsync=function(t){this.async(function(){this.ensureId()},t)},b.prototype.addDynamicView=function(t,e){t=new _(this,t,e);return this.DynamicViews.push(t),t},b.prototype.removeDynamicView=function(e){this.DynamicViews=this.DynamicViews.filter(function(t){return t.name!==e})},b.prototype.getDynamicView=function(t){for(var e=0;e<this.DynamicViews.length;e++)if(this.DynamicViews[e].name===t)return this.DynamicViews[e];return null},b.prototype.findAndUpdate=function(t,e){"function"==typeof t?this.updateWhere(t,e):this.chain().find(t).update(e)},b.prototype.findAndRemove=function(t){this.chain().find(t).remove()},b.prototype.insert=function(t,e){if(!Array.isArray(t))return this.insertOne(t);var n,r=[],e=e&&!this.cloneObjects&&this.adaptiveBinaryIndices&&0<Object.keys(this.binaryIndices).length;e&&(this.adaptiveBinaryIndices=!1);try{this.emit("pre-insert",t);for(var i=0,o=t.length;i<o;i++){if(!(n=this.insertOne(t[i],!0)))return;r.push(n)}}finally{e&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}return this.emit("insert",r),1===(r=this.cloneObjects?h(r,this.cloneMethod):r).length?r[0]:r},b.prototype.insertOne=function(t,e){var n=null;if("object"!==_typeof3(t)?n=new TypeError("Document needs to be an object"):null===t&&(n=new TypeError("Object cannot be null")),null!==n)throw this.emit("error",n),n;n=this.cloneObjects?h(t,this.cloneMethod):t;if(this.disableFreeze||(n=a(n)),this.disableMeta||(void 0===n.meta?n.meta={revision:0,created:0}:this.disableFreeze||(n.meta=a(n.meta))),e||this.emit("pre-insert",n),this.add(n))return this.disableChangesApi?this.insertMeta(n):this.insertMetaWithChange(n),this.disableFreeze||f(n),t=this.cloneObjects?h(n,this.cloneMethod):n,e||this.emit("insert",t),this.addAutoUpdateObserver(t),t},b.prototype.clear=function(t){var e=this;t=t||{},this.data=[],this.idIndex=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null,this.maxId=0,this.DynamicViews=[],this.dirty=!0,this.constraints={unique:{},exact:{}},!0===t.removeIndices?(this.binaryIndices={},this.uniqueNames=[]):Object.keys(this.binaryIndices).forEach(function(t){e.binaryIndices[t].dirty=!1,e.binaryIndices[t].values=[]})},b.prototype.update=function(t){var e,n,r;if(Array.isArray(t)){r=t.length,(e=!this.cloneObjects&&this.adaptiveBinaryIndices&&0<Object.keys(this.binaryIndices).length)&&(this.adaptiveBinaryIndices=!1);try{for(n=0;n<r;n+=1)this.update(t[n])}finally{e&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}}else{if(!w.call(t,"$loki"))throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();var i,o,s,a=this.get(t.$loki,!0),u=this;if(!a)throw new Error("Trying to update a document not in collection.");i=a[0],s=a[1],o=this.cloneObjects||!this.disableDeltaChangesApi&&this.disableFreeze?h(t,this.cloneMethod):t,this.emit("pre-update",t),this.uniqueNames.forEach(function(t){u.getUniqueIndex(t,!0).update(i,o)}),(this.data[s]=o)!==t&&this.addAutoUpdateObserver(t);for(var l,c,p=0;p<this.DynamicViews.length;p++)this.DynamicViews[p].evaluateDocument(s,!1);if(this.adaptiveBinaryIndices)for(l in this.binaryIndices)this.adaptiveBinaryIndexUpdate(s,l);else this.flagBinaryIndexesDirty();return this.idIndex[s]=o.$loki,this.isIncremental&&this.dirtyIds.push(o.$loki),this.commit(),this.dirty=!0,o=this.disableChangesApi?this.updateMeta(o):this.updateMetaWithChange(o,i),this.disableFreeze||f(o),c=this.cloneObjects?h(o,this.cloneMethod):o,this.emit("update",c,i),c}catch(t){throw this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),t}}},b.prototype.add=function(t){if("object"!==_typeof3(t))throw new TypeError("Object being added needs to be an object");if(void 0!==t.$loki)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this.maxId++,isNaN(this.maxId)&&(this.maxId=this.data[this.data.length-1].$loki+1);var e=this.maxId;t.$loki=e,this.disableMeta||(t.meta.version=0);for(var n=0,r=this.uniqueNames.length;n<r;n++)this.getUniqueIndex(this.uniqueNames[n],!0).set(t);this.idIndex&&this.idIndex.push(e),this.isIncremental&&this.dirtyIds.push(e),this.data.push(t);for(var i,o=this.data.length-1,s=this.DynamicViews.length,n=0;n<s;n++)this.DynamicViews[n].evaluateDocument(o,!0);if(this.adaptiveBinaryIndices)for(i in this.binaryIndices)this.adaptiveBinaryIndexInsert(o,i);else this.flagBinaryIndexesDirty();return this.commit(),this.dirty=!0,this.cloneObjects?h(t,this.cloneMethod):t}catch(t){throw this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),t}},b.prototype.updateWhere=function(t,e){var n,r=this.where(t),i=0;try{for(;i<r.length;i++)n=e(r[i]),this.update(n)}catch(t){this.rollback(),this.lokiConsoleWrapper.error(t.message)}},b.prototype.removeWhere=function(t){var e;"function"==typeof t?(e=this.data.filter(t),this.remove(e)):this.chain().find(t).remove()},b.prototype.removeDataOnly=function(){this.remove(this.data.slice())},b.prototype.removeBatchByPositions=function(n){var t,e,r,i,o,s=n.length,a={},u=Object.keys(this.binaryIndices).length,l=Object.keys(this.constraints.unique).length,c=this.adaptiveBinaryIndices&&0<Object.keys(this.binaryIndices).length,p=this;try{for(this.startTransaction(),this.ensureId(),r=0;r<s;r++)a[this.idIndex[n[r]]]=!0;if(0<(t=this.DynamicViews.length)||0<u||0<l){if(0<t)for(e=0;e<t;e++)this.DynamicViews[e].removeDocument(n);if(this.adaptiveBinaryIndices&&!c)for(o in this.binaryIndices)this.adaptiveBinaryIndexRemove(n,o);else this.flagBinaryIndexesDirty();l&&this.uniqueNames.forEach(function(t){var e=p.getUniqueIndex(t);if(e)for(r=0;r<s;r++)null!==(i=p.data[n[r]])[t]&&void 0!==i[t]&&e.remove(i[t])})}if(!this.disableChangesApi||1<this.events.delete.length)for(r=0;r<s;r++)this.emit("delete",this.data[n[r]]);if(this.data=this.data.filter(function(t){return!a[t.$loki]}),this.isIncremental)for(r=0;r<s;r++)this.dirtyIds.push(this.idIndex[n[r]]);this.idIndex=this.idIndex.filter(function(t){return!a[t]}),this.adaptiveBinaryIndices&&c&&(this.adaptiveBinaryIndices=!1,this.ensureAllIndexes(!0),this.adaptiveBinaryIndices=!0),this.commit(),this.dirty=!0}catch(t){return this.rollback(),c&&(this.adaptiveBinaryIndices=!0),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),null}},b.prototype.removeBatch=function(t){for(var e=t.length,n=this.data.length,r={},i=[],o=0;o<n;o++)r[this.data[o].$loki]=o;for(o=0;o<e;o++)"object"===_typeof3(t[o])?i.push(r[t[o].$loki]):i.push(r[t[o]]);this.removeBatchByPositions(i)},b.prototype.remove=function(n){if("object"!==_typeof3(n="number"==typeof n?this.get(n):n))throw new Error("Parameter is not an object");if(Array.isArray(n))this.removeBatch(n);else{if(!w.call(n,"$loki"))throw new Error("Object is not a document stored in the collection");try{this.startTransaction();var t=this.get(n.$loki,!0),e=t[1],r=this;this.uniqueNames.forEach(function(t){var e;null!==n[t]&&void 0!==n[t]&&(e=r.getUniqueIndex(t))&&e.remove(n[t])});for(var i,o=0;o<this.DynamicViews.length;o++)this.DynamicViews[o].removeDocument(e);if(this.adaptiveBinaryIndices)for(i in this.binaryIndices)this.adaptiveBinaryIndexRemove(e,i);else this.flagBinaryIndexesDirty();return this.data.splice(e,1),this.removeAutoUpdateObserver(n),this.idIndex.splice(e,1),this.isIncremental&&this.dirtyIds.push(n.$loki),this.commit(),this.dirty=!0,this.emit("delete",t[0]),delete(n=this.disableFreeze?n:a(n)).$loki,delete n.meta,this.disableFreeze||s(n),n}catch(t){return this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),null}}},b.prototype.get=function(t,e){this.idIndex||this.ensureId();var n,e=e||!1,r=this.idIndex,i=r.length-1,o=0;if(t="number"==typeof t?t:parseInt(t,10),isNaN(t))throw new TypeError("Passed id is not an integer");for(;r[o]<r[i];)r[n=o+i>>1]<t?o=1+n:i=n;return i===o&&r[o]===t?e?[this.data[o],o]:this.data[o]:null},b.prototype.getBinaryIndexPosition=function(t,e){var n=E.getIn(this.data[t],e,!0),r=this.binaryIndices[e].values,e=this.calculateRange("$eq",e,n);if(0!==e[0]||-1!==e[1])for(var n=e[0],i=e[1],o=n;o<=i;o++)if(r[o]===t)return o;return null},b.prototype.adaptiveBinaryIndexInsert=function(t,e){var n=-1!==e.indexOf("."),r=this.binaryIndices[e].values,i=E.getIn(this.data[t],e,n),r=(!0===this.serializableIndices&&i instanceof Date&&(this.data[t][e]=i.getTime(),i=E.getIn(this.data[t],e)),0===r.length?0:this.calculateRangeStart(e,i,!0,n));this.binaryIndices[e].values.splice(r,0,t)},b.prototype.adaptiveBinaryIndexUpdate=function(t,e){for(var n=this.binaryIndices[e].values,r=n.length,i=0;i<r&&n[i]!==t;i++);this.binaryIndices[e].values.splice(i,1),this.adaptiveBinaryIndexInsert(t,e)},b.prototype.adaptiveBinaryIndexRemove=function(t,e,n){var r,i,o,s,a,u,l=this.binaryIndices[e],c={};if(Array.isArray(t)){if(1!==(s=t.length)){for(o=0;o<s;o++)c[t[o]]=!0;if(l.values=l.values.filter(function(t){return!c[t]}),!0===n)return;var p=t.slice();for(p.sort(function(t,e){return t-e}),r=l.values.length,i=0;i<r;i++){for(a=l.values[i],o=u=0;o<s&&a>p[o];o++)u++;l.values[i]-=u}return}t=t[0]}if(null===(e=this.getBinaryIndexPosition(t,e)))return null;if(l.values.splice(e,1),!0!==n)for(r=l.values.length,i=0;i<r;i++)l.values[i]>t&&l.values[i]--},b.prototype.calculateRangeStart=function(t,e,n,r){var i,o=this.data,s=this.binaryIndices[t].values,a=0,u=s.length-1;if(0===s.length)return-1;for(E.getIn(o[s[a]],t,r),E.getIn(o[s[u]],t,r);a<u;)v.lt(E.getIn(o[s[i=a+u>>1]],t,r),e,!1)?a=1+i:u=i;var l=a;return v.aeq(e,E.getIn(o[s[l]],t,r))?l:v.lt(e,E.getIn(o[s[l]],t,r),!1)?n?l:l-1:n?l+1:l},b.prototype.calculateRangeEnd=function(t,e,n){var r,i=this.data,o=this.binaryIndices[t].values,s=0,a=o.length-1;if(0===o.length)return-1;for(E.getIn(i[o[s]],t,n),E.getIn(i[o[a]],t,n);s<a;)v.lt(e,E.getIn(i[o[r=s+a>>1]],t,n),!1)?a=r:s=1+r;var u=a;return v.aeq(e,E.getIn(i[o[u]],t,n))?u:v.gt(e,E.getIn(i[o[u]],t,n),!1)?u+1:v.aeq(e,E.getIn(i[o[u-1]],t,n))?u-1:u},b.prototype.calculateRange=function(t,e,n){var r,i,o,s=this.data,a=this.binaryIndices[e].values,u=a.length-1;if(0===s.length)return[0,-1];var l=-1!==e.indexOf("."),c=E.getIn(s[a[0]],e,l),p=E.getIn(s[a[u]],e,l);switch(t){case"$eq":case"$aeq":case"$dteq":if(v.lt(n,c,!1)||v.gt(n,p,!1))return[0,-1];break;case"$gt":if(v.gt(n,p,!0))return[0,-1];if(v.gt(c,n,!1))return[0,u];break;case"$gte":if(v.gt(n,p,!1))return[0,-1];if(v.gt(c,n,!0))return[0,u];break;case"$lt":if(v.lt(n,c,!0))return[0,-1];if(v.lt(p,n,!1))return[0,u];break;case"$lte":if(v.lt(n,c,!1))return[0,-1];if(v.lt(p,n,!0))return[0,u];break;case"$between":return v.gt(n[0],p,!1)?[0,-1]:v.lt(n[1],c,!1)||((r=this.calculateRangeStart(e,n[0],!1,l))<0&&r++,u<(o=this.calculateRangeEnd(e,n[1],l))&&o--,v.gt(E.getIn(s[a[r]],e,l),n[0],!0)||r++,v.lt(E.getIn(s[a[o]],e,l),n[1],!0)||o--,o<r)?[0,-1]:[r,o];case"$in":for(var h=[],f=[],d=0,y=n.length;d<y;d++)for(var g=this.calculateRange("$eq",e,n[d]),m=g[0];m<=g[1];m++)void 0===h[m]&&(h[m]=!0,f.push(m));return f}switch(t){case"$eq":case"$aeq":case"$dteq":case"$gte":case"$lt":r=this.calculateRangeStart(e,n,!1,l),i=E.getIn(s[a[r]],e,l)}switch(t){case"$eq":case"$aeq":case"$dteq":case"$lte":case"$gt":o=this.calculateRangeEnd(e,n,l),E.getIn(s[a[o]],e,l)}switch(t){case"$eq":case"$aeq":case"$dteq":return v.aeq(i,n)?[r,o]:[0,-1];case"$gt":return v.aeq(E.getIn(s[a[o]],e,l),n)?[o+1,u]:[o,u];case"$gte":return v.aeq(E.getIn(s[a[r]],e,l),n)?[r,u]:[r+1,u];case"$lt":return v.aeq(E.getIn(s[a[r]],e,l),n)?[0,r-1]:[0,r];case"$lte":return v.aeq(E.getIn(s[a[o]],e,l),n)?[0,o]:[0,o-1];default:return[0,s.length-1]}},b.prototype.by=function(e,t){var n;return void 0===t?(n=this,function(t){return n.by(e,t)}):(t=this.getUniqueIndex(e,!0).get(t),this.cloneObjects?h(t,this.cloneMethod):t)},b.prototype.findOne=function(t){t=t||{};t=this.chain().find(t,!0).data();return Array.isArray(t)&&0===t.length?null:this.cloneObjects?h(t[0],this.cloneMethod):t[0]},b.prototype.chain=function(t,e){var n=new m(this);return void 0===t?n:n.transform(t,e)},b.prototype.find=function(t){return this.chain().find(t).data()},b.prototype.findOneUnindexed=function(t,e){for(var n=this.data.length;n--;)if(E.getIn(this.data[n],t,!0)===e)return this.data[n];return null},b.prototype.startTransaction=function(){if(this.transactional){this.cachedData=h(this.data,this.cloneMethod),this.cachedIndex=this.idIndex,this.cachedBinaryIndex=this.binaryIndices,this.cachedDirtyIds=this.dirtyIds;for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].startTransaction()}},b.prototype.commit=function(){if(this.transactional){this.cachedData=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedDirtyIds=null;for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].commit()}},b.prototype.rollback=function(){if(this.transactional){null!==this.cachedData&&null!==this.cachedIndex&&(this.data=this.cachedData,this.idIndex=this.cachedIndex,this.binaryIndices=this.cachedBinaryIndex,this.dirtyIds=this.cachedDirtyIds);for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].rollback()}},b.prototype.async=function(t,e){setTimeout(function(){if("function"!=typeof t)throw new TypeError("Argument passed for async execution is not a function");t(),e()},0)},b.prototype.where=function(t){return this.chain().where(t).data()},b.prototype.mapReduce=function(t,e){try{return e(this.data.map(t))}catch(t){throw t}},b.prototype.eqJoin=function(t,e,n,r,i){return new m(this).eqJoin(t,e,n,r,i)},b.prototype.stages={},b.prototype.getStage=function(t){return this.stages[t]||(this.stages[t]={}),this.stages[t]},b.prototype.commitLog=[],b.prototype.stage=function(t,e){var n=JSON.parse(JSON.stringify(e));return this.getStage(t)[e.$loki]=n},b.prototype.commitStage=function(t,e){var n,r=this.getStage(t),i=(new Date).getTime();for(n in r)this.update(r[n]),this.commitLog.push({timestamp:i,message:e,data:JSON.parse(JSON.stringify(r[n]))});this.stages[t]={}},b.prototype.no_op=function(){},b.prototype.extract=function(t){for(var e=0,n=this.data.length,r=x(t),i=[];e<n;e+=1)i.push(A(this.data[e],t,r));return i},b.prototype.max=function(t){return Math.max.apply(null,this.extract(t))},b.prototype.min=function(t){return Math.min.apply(null,this.extract(t))},b.prototype.maxRecord=function(t){for(var e,n=0,r=this.data.length,i=x(t),o={index:0,value:void 0};n<r;n+=1)(void 0===e||e<A(this.data[n],t,i))&&(e=A(this.data[n],t,i),o.index=this.data[n].$loki);return o.value=e,o},b.prototype.minRecord=function(t){for(var e,n=0,r=this.data.length,i=x(t),o={index:0,value:void 0};n<r;n+=1)(void 0===e||e>A(this.data[n],t,i))&&(e=A(this.data[n],t,i),o.index=this.data[n].$loki);return o.value=e,o},b.prototype.extractNumerical=function(t){return this.extract(t).map(O).filter(Number).filter(function(t){return!isNaN(t)})},b.prototype.avg=function(t){return k(this.extractNumerical(t))},b.prototype.stdDev=function(t){return t=this.extractNumerical(t),e=k(t),t=k(t.map(function(t){t-=e;return t*t})),Math.sqrt(t);var e},b.prototype.mode=function(t){var e,n,r,i={};for(n in this.extract(t).forEach(function(t){i[t]?i[t]+=1:i[t]=1}),i)e?e<i[n]&&(r=n):e=i[r=n];return r},b.prototype.median=function(t){var t=this.extractNumerical(t),e=(t.sort(D),Math.floor(t.length/2));return t.length%2?t[e]:(t[e-1]+t[e])/2},P.prototype={keys:[],values:[],sort:function(t,e){return t<e?-1:e<t?1:0},setSort:function(t){this.bs=new L(t)},bs:function(){return new L(this.sort)},set:function(t,e){var n=this.bs(this.keys,t);n.found?this.values[n.index]=e:(this.keys.splice(n.index,0,t),this.values.splice(n.index,0,e))},get:function(t){return this.values[M(this.keys,t,this.sort).index]}},T.prototype.keyMap={},T.prototype.lokiMap={},T.prototype.set=function(t){var e=t[this.field];if(null!=e){if(this.keyMap[e])throw new Error("Duplicate key for property "+this.field+": "+e);this.keyMap[e]=t,this.lokiMap[t.$loki]=e}},T.prototype.get=function(t){return this.keyMap[t]},T.prototype.byId=function(t){return this.keyMap[this.lokiMap[t]]},T.prototype.update=function(t,e){var n;this.lokiMap[t.$loki]!==e[this.field]?(n=this.lokiMap[t.$loki],this.set(e),this.keyMap[n]=void 0):this.keyMap[t[this.field]]=e},T.prototype.remove=function(t){var e=this.keyMap[t];if(null==e)throw new Error("Key is not in unique index: "+this.field);this.keyMap[t]=void 0,this.lokiMap[e.$loki]=void 0},T.prototype.clear=function(){this.keyMap=Object.create(null),this.lokiMap=Object.create(null)},R.prototype={set:function(t,e){this.index[t]?this.index[t].push(e):this.index[t]=[e]},remove:function(t,e){var n,r=this.index[t];for(n in r)r[n]==e&&r.splice(n,1);r.length<1&&(this.index[t]=void 0)},get:function(t){return this.index[t]},clear:function(t){this.index={}}},l.deepFreeze=f,l.freeze=s,l.unFreeze=a,l.LokiOps=I,l.Collection=b,l.DynamicView=_,l.Resultset=m,l.KeyValueStore=P,l.LokiMemoryAdapter=c,l.LokiPartitioningAdapter=p,l.LokiLocalStorageAdapter=g,l.LokiFsAdapter=y,l.persistenceAdapters={fs:y,localStorage:g},l.aeq=t,l.lt=e,l.gt=n,l.Comparators=v,l},"function"==typeof define&&define.amd?define([],e):"object"===_typeof3(r)?n.exports=e():t.loki=e()}.call(this)}.call(this,q("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./loki-indexed-adapter.js":205,_process:283,fs:57}],207:[function(t,e,n){arguments[4][9][0].apply(n,arguments)},{"@turf/invariant":32,dup:9}],208:[function(t,e,n){var s={nearestPointOnLine:t("@turf/nearest-point-on-line").default,booleanPointInPolygon:t("@turf/boolean-point-in-polygon").default};e.exports=function e(t,n,r){var i,o;if(!t.geometry)return null;switch(t.geometry.type){case"LineString":case"MultiLineString":return s.nearestPointOnLine(t,n,r);case"Polygon":return s.booleanPointInPolygon(n,t,r)?((o=JSON.parse(JSON.stringify(n))).properties={dist:0,location:0},o):((o=JSON.parse(JSON.stringify(t))).geometry.type="MultiLineString",e(o,n,r));case"MultiPolygon":return 0<(i=(i=(i=t.geometry.coordinates.map(function(t){return e({type:"Feature",geometry:{type:"Polygon",coordinates:t}},n,r)})).filter(function(t){return t})).sort(function(t,e){return t&&e?t.properties.dist-e.properties.dist:null})).length?i[0]:void 0;case"GeometryCollection":return 0<(i=(i=(i=t.geometry.geometries.map(function(t){return e({type:"Feature",geometry:t},n,r)})).filter(function(t){return t})).sort(function(t,e){return t&&e?t.properties.dist-e.properties.dist:null})).length?i[0]:void 0;default:console.log("nearestPointOnGeometry: don't know how to handle "+t.geometry.type)}}},{"@turf/boolean-point-in-polygon":207,"@turf/nearest-point-on-line":37}],209:[function(t,e,n){e.exports=t("./polygon-features.json")},{"./polygon-features.json":210}],210:[function(t,e,n){e.exports=[{key:"building",polygon:"all"},{key:"highway",polygon:"whitelist",values:["services","rest_area","escape","elevator"]},{key:"natural",polygon:"blacklist",values:["coastline","cliff","ridge","arete","tree_row"]},{key:"landuse",polygon:"all"},{key:"waterway",polygon:"whitelist",values:["riverbank","dock","boatyard","dam"]},{key:"amenity",polygon:"all"},{key:"leisure",polygon:"all"},{key:"barrier",polygon:"whitelist",values:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},{key:"railway",polygon:"whitelist",values:["station","turntable","roundhouse","platform"]},{key:"area",polygon:"all"},{key:"boundary",polygon:"all"},{key:"man_made",polygon:"blacklist",values:["cutline","embankment","pipeline"]},{key:"power",polygon:"whitelist",values:["plant","substation","generator","transformer"]},{key:"place",polygon:"all"},{key:"shop",polygon:"all"},{key:"aeroway",polygon:"blacklist",values:["taxiway"]},{key:"tourism",polygon:"all"},{key:"historic",polygon:"all"},{key:"public_transport",polygon:"all"},{key:"office",polygon:"all"},{key:"building:part",polygon:"all"},{key:"military",polygon:"all"},{key:"ruins",polygon:"all"},{key:"area:highway",polygon:"all"},{key:"craft",polygon:"all"},{key:"golf",polygon:"all"},{key:"indoor",polygon:"all"}]},{}],211:[function(t,e,n){var P=t("./lodash.custom.js"),T=t("@mapbox/geojson-rewind"),r={};function i(t,e){return(t.version||e.version)&&t.version!==e.version?(+t.version||0)>(+e.version||0)?t:e:P.merge(t,e)}t("osm-polygon-features").forEach(function(t){var e,n;"all"===t.polygon?r[t.key]=!0:(e="whitelist"===t.polygon?"included_values":"excluded_values",n={},t.values.forEach(function(t){n[t]=!0}),r[t.key]={},r[t.key][e]=n)});function R(t){function e(t){return t[0]}function n(t){return t[t.length-1]}function r(t,e){return void 0!==t&&void 0!==e&&t.id===e.id}for(var i,o,s,a,u,l,c=[];t.length;)for(i=t.pop().nodes.slice(),c.push(i);t.length&&!r(e(i),n(i));){for(o=e(i),s=n(i),a=0;a<t.length;a++){if(r(s,e(l=t[a].nodes))){u=i.push,l=l.slice(1);break}if(r(s,n(l))){u=i.push,l=l.slice(0,-1).reverse();break}if(r(o,n(l))){u=i.unshift,l=l.slice(0,-1);break}if(r(o,e(l))){u=i.unshift,l=l.slice(1).reverse();break}l=u=null}if(!l)break;t.splice(a,1),u.apply(i,l)}return c}e.exports=(t=function(t,M,L){var e,s,a,u,l,c;function p(t,e,n){t.hasAttribute(n)&&(e[n]=t.getAttribute(n))}function h(t,e){t=P.clone(t);p(e,t,"lat"),p(e,t,"lon"),t.__is_center_placeholder=!0,u.push(t)}function f(t,e){var r=P.clone(t);function n(t,e,n){n={type:"node",id:"_"+r.type+"/"+r.id+"bounds"+n,lat:t,lon:e};r.nodes.push(n.id),u.push(n)}r.nodes=[],n(e.getAttribute("minlat"),e.getAttribute("minlon"),1),n(e.getAttribute("maxlat"),e.getAttribute("minlon"),2),n(e.getAttribute("maxlat"),e.getAttribute("maxlon"),3),n(e.getAttribute("minlat"),e.getAttribute("maxlon"),4),r.nodes.push(r.nodes[0]),r.__is_bounds_placeholder=!0,l.push(r)}function d(r,t){P.isArray(r.nodes)||(r.nodes=[],P.each(t,function(t,e){r.nodes.push("_anonymous@"+t.getAttribute("lat")+"/"+t.getAttribute("lon"))})),P.each(t,function(t,e){var n;t.getAttribute("lat")&&(n=t.getAttribute("lat"),t=t.getAttribute("lon"),e={type:"node",id:e=r.nodes[e],lat:n,lon:t},u.push(e))})}function y(o,t){function s(t,e){var n;l.some(function(t){return"way"==t.type&&t.id==e})||(n={type:"way",id:e,nodes:[]},P.each(t,function(t){var e;t.getAttribute("lat")?(e=t.getAttribute("lat"),t=t.getAttribute("lon"),e={type:"node",id:"_anonymous@"+e+"/"+t,lat:e,lon:t},n.nodes.push(e.id),u.push(e)):n.nodes.push(void 0)}),l.push(n))}P.each(t,function(t,e){var n,r,i;"node"==o.members[e].type?t.getAttribute("lat")&&(n=t.getAttribute("lat"),r=t.getAttribute("lon"),i=o.members[e].ref,u.push({type:"node",id:i,lat:n,lon:r})):"way"==o.members[e].type&&0<t.getElementsByTagName("nd").length&&(o.members[e].ref="_fullGeom"+o.members[e].ref,s(t.getElementsByTagName("nd"),o.members[e].ref))})}return M=P.merge({verbose:!1,flatProperties:!0,uninterestingTags:{source:!0,source_ref:!0,"source:ref":!0,history:!0,attribution:!0,created_by:!0,"tiger:county":!0,"tiger:tlid":!0,"tiger:upload_uuid":!0},polygonFeatures:r,deduplicator:i},M),"undefined"!=typeof XMLDocument&&t instanceof XMLDocument||"undefined"==typeof XMLDocument&&t.childNodes?(e=t,u=new Array,l=new Array,c=new Array,P.each(e.getElementsByTagName("node"),function(t,e){var n={},r=(P.each(t.getElementsByTagName("tag"),function(t){n[t.getAttribute("k")]=t.getAttribute("v")}),{type:"node"});p(t,r,"id"),p(t,r,"lat"),p(t,r,"lon"),p(t,r,"version"),p(t,r,"timestamp"),p(t,r,"changeset"),p(t,r,"uid"),p(t,r,"user"),P.isEmpty(n)||(r.tags=n),u.push(r)}),P.each(e.getElementsByTagName("way"),function(t,e){var n={},r=[],i=(P.each(t.getElementsByTagName("tag"),function(t){n[t.getAttribute("k")]=t.getAttribute("v")}),!1),o=(P.each(t.getElementsByTagName("nd"),function(t,e){var n;(n=t.getAttribute("ref"))&&(r[e]=n),!i&&t.getAttribute("lat")&&(i=!0)}),{type:"way"});p(t,o,"id"),p(t,o,"version"),p(t,o,"timestamp"),p(t,o,"changeset"),p(t,o,"uid"),p(t,o,"user"),0<r.length&&(o.nodes=r),P.isEmpty(n)||(o.tags=n),(s=t.getElementsByTagName("center")[0])&&h(o,s),i?d(o,t.getElementsByTagName("nd")):(a=t.getElementsByTagName("bounds")[0])&&f(o,a),l.push(o)}),P.each(e.getElementsByTagName("relation"),function(t,e){var n={},r=[],i=(P.each(t.getElementsByTagName("tag"),function(t){n[t.getAttribute("k")]=t.getAttribute("v")}),!1),o=(P.each(t.getElementsByTagName("member"),function(t,e){r[e]={},p(t,r[e],"ref"),p(t,r[e],"role"),p(t,r[e],"type"),(!i&&"node"==r[e].type&&t.getAttribute("lat")||"way"==r[e].type&&0<t.getElementsByTagName("nd").length)&&(i=!0)}),{type:"relation"});p(t,o,"id"),p(t,o,"version"),p(t,o,"timestamp"),p(t,o,"changeset"),p(t,o,"uid"),p(t,o,"user"),0<r.length&&(o.members=r),P.isEmpty(n)||(o.tags=n),(s=t.getElementsByTagName("center")[0])&&h(o,s),i?y(o,t.getElementsByTagName("member")):(a=t.getElementsByTagName("bounds")[0])&&f(o,a),c.push(o)}),g(u,l,c)):function(t){var s=new Array,i=new Array,e=new Array;function n(t){var e=P.clone(t);e.lat=t.center.lat,e.lon=t.center.lon,e.__is_center_placeholder=!0,s.push(e)}function r(t){var r=P.clone(t);function e(t,e,n){n={type:"node",id:"_"+r.type+"/"+r.id+"bounds"+n,lat:t,lon:e};r.nodes.push(n.id),s.push(n)}r.nodes=[],e(r.bounds.minlat,r.bounds.minlon,1),e(r.bounds.maxlat,r.bounds.minlon,2),e(r.bounds.maxlat,r.bounds.maxlon,3),e(r.bounds.minlat,r.bounds.maxlon,4),r.nodes.push(r.nodes[0]),r.__is_bounds_placeholder=!0,i.push(r)}function o(r){P.isArray(r.nodes)||(r.nodes=r.geometry.map(function(t){return null!==t?"_anonymous@"+t.lat+"/"+t.lon:"_anonymous@unknown_location"})),r.geometry.forEach(function(t,e){var n;t&&(n=t.lat,t=t.lon,e=r.nodes[e],s.push({type:"node",id:e,lat:n,lon:t}))})}function a(t){function o(t,e){var n;i.some(function(t){return"way"==t.type&&t.id==e})||(n={type:"way",id:e,nodes:[]},t.forEach(function(t){var e;t?(e=t.lat,t=t.lon,e={type:"node",id:"_anonymous@"+e+"/"+t,lat:e,lon:t},n.nodes.push(e.id),s.push(e)):n.nodes.push(void 0)}),i.push(n))}t.members.forEach(function(t,e){var n,r,i;"node"==t.type?t.lat&&(n=t.lat,r=t.lon,i=t.ref,s.push({type:"node",id:i,lat:n,lon:r})):"way"==t.type&&t.geometry&&(t.ref="_fullGeom"+t.ref,o(t.geometry,t.ref))})}for(var u=0;u<t.elements.length;u++)switch(t.elements[u].type){case"node":var l=t.elements[u];s.push(l);break;case"way":l=P.clone(t.elements[u]);l.nodes=P.clone(l.nodes),i.push(l),l.center&&n(l),l.geometry?o(l):l.bounds&&r(l);break;case"relation":var c=P.clone(t.elements[u]),p=(c.members=P.clone(c.members),e.push(c),c.members&&c.members.some(function(t){return"node"==t.type&&t.lat||"way"==t.type&&t.geometry&&0<t.geometry.length}));c.center&&n(c),p?a(c):c.bounds&&r(c)}return g(s,i,e)}(t);function g(t,e,i){function o(t,e){if("object"!==_typeof3(e)&&(e={}),"function"==typeof M.uninterestingTags)return!M.uninterestingTags(t,e);for(var n in t)if(!0!==M.uninterestingTags[n]&&!0!==e[n]&&e[n]!==t[n])return 1}function h(t){var e,n={timestamp:t.timestamp,version:t.version,changeset:t.changeset,user:t.user,uid:t.uid};for(e in n)void 0===n[e]&&delete n[e];return n}for(var n=new Object,r=new Object,s=0;s<t.length;s++)void 0!==(n[(p=void 0!==n[(p=t[s]).id]?M.deduplicator(p,n[p.id]):p).id]=p).tags&&o(p.tags)&&(r[p.id]=!0);for(s=0;s<i.length;s++)if(P.isArray(i[s].members))for(var a=0;a<i[s].members.length;a++)"node"==i[s].members[a].type&&(r[i[s].members[a].ref]=!0);for(var f=new Object,u=new Object,s=0;s<e.length;s++){var l=e[s];if(f[l.id]&&(l=M.deduplicator(l,f[l.id])),f[l.id]=l,P.isArray(l.nodes))for(a=0;a<l.nodes.length;a++)"object"!==_typeof3(l.nodes[a])&&(u[l.nodes[a]]=!0,l.nodes[a]=n[l.nodes[a]])}var c=new Array;for(g in n){var p=n[g];u[g]&&!r[g]||c.push(p)}for(var d=new Array,s=0;s<i.length;s++){var y=i[s];d[y.id]&&(y=M.deduplicator(y,d[y.id])),d[y.id]=y}var g,m,v={node:{},way:{},relation:{}};for(g in d){y=d[g];if(P.isArray(y.members))for(a=0;a<y.members.length;a++){var _=y.members[a].type,b=y.members[a].ref;"number"!=typeof b&&(b=b.replace("_fullGeom","")),v[_]?(void 0===v[_][b]&&(v[_][b]=[]),v[_][b].push({role:y.members[a].role,rel:y.id,reltags:y.tags})):M.verbose&&console.warn("Relation",y.type+"/"+y.id,"member",_+"/"+b,"ignored because it has an invalid type")}else M.verbose&&console.warn("Relation",y.type+"/"+y.id,"ignored because it has no members")}var x=[];for(s=0;s<c.length;s++)void 0===c[s].lon||void 0===c[s].lat?M.verbose&&console.warn("POI",c[s].type+"/"+c[s].id,"ignored because it lacks coordinates"):(k={type:"Feature",id:c[s].type+"/"+c[s].id,properties:{type:c[s].type,id:c[s].id,tags:c[s].tags||{},relations:v.node[c[s].id]||[],meta:h(c[s])},geometry:{type:"Point",coordinates:[+c[s].lon,+c[s].lat]}},c[s].__is_center_placeholder&&(k.properties.geometry="center"),L?L(k):x.push(k));function w(){if(d[i[s].id]!==i[s])return"continue";if(void 0!==i[s].tags&&("route"==i[s].tags.type||"waterway"==i[s].tags.type)){if(!P.isArray(i[s].members))return M.verbose&&console.warn("Route",i[s].type+"/"+i[s].id,"ignored because it has no members"),"continue";if(i[s].members.forEach(function(t){f[t.ref]&&!o(f[t.ref].tags)&&(f[t.ref].is_skippablerelationmember=!0)}),n=i[s],r=!1,t=(t=n.members.filter(function(t){return"way"===t.type})).map(function(e){var t=f[e.ref];if(void 0!==t&&void 0!==t.nodes)return{id:e.ref,role:e.role,way:t,nodes:t.nodes.filter(function(t){return void 0!==t||(r=!0,M.verbose&&console.warn("Route",n.type+"/"+n.id,"tainted by a way",e.type+"/"+e.ref,"with a missing node"),!1)})};M.verbose&&console.warn("Route "+n.type+"/"+n.id,"tainted by a missing or incomplete  way",e.type+"/"+e.ref),r=!0}),t=R(t=P.compact(t)),!1===(k=0==(t=P.compact(t.map(function(t){return P.compact(t.map(function(t){return[+t.lon,+t.lat]}))}))).length?(M.verbose&&console.warn("Route",n.type+"/"+n.id,"contains no coordinates"),!1):(t={type:"Feature",id:n.type+"/"+n.id,properties:{type:n.type,id:n.id,tags:n.tags||{},relations:v[n.type][n.id]||[],meta:h(n)},geometry:{type:1===t.length?"LineString":"MultiLineString",coordinates:1===t.length?t[0]:t}},r&&(M.verbose&&console.warn("Route",n.type+"/"+n.id,"is tainted"),t.properties.tainted=!0),t)))return M.verbose&&console.warn("Route relation",i[s].type+"/"+i[s].id,"ignored because it has invalid geometry"),"continue";L?L(T(k)):S.push(k)}var n,r,t;if(void 0!==i[s].tags&&("multipolygon"==i[s].tags.type||"boundary"==i[s].tags.type)){function e(t,e){var n=!1,r=N?"way":"relation",i="number"==typeof t.id?t.id:+t.id.replace("_fullGeom","");function o(t){function e(t){return t.map(function(t){return[+t.lat,+t.lon]})}function r(t,e){for(var n=t[0],r=t[1],i=!1,o=0,s=e.length-1;o<e.length;s=o++){var a=e[o][0],u=e[o][1],l=e[s][0],c=e[s][1];r<u!=r<c&&n<(l-a)*(r-u)/(c-u)+a&&(i=!i)}return i}var n;for(t=e(t),n=0;n<s.length;n++)if(function(t,e){for(var n=0;n<e.length;n++)if(r(e[n],t))return!0;return!1}(e(s[n]),t))return n}e=(e=e.members.filter(function(t){return"way"===t.type})).map(function(e){var t=f[e.ref];if(void 0!==t&&void 0!==t.nodes)return{id:e.ref,role:e.role||"outer",way:t,nodes:t.nodes.filter(function(t){return void 0!==t||(n=!0,M.verbose&&console.warn("Multipolygon",r+"/"+i,"tainted by a way",e.type+"/"+e.ref,"with a missing node"),!1)})};M.verbose&&console.warn("Multipolygon",r+"/"+i,"tainted by a missing or incomplete way",e.type+"/"+e.ref),n=!0});for(var s=R((e=P.compact(e)).filter(function(t){return"outer"===t.role})),a=R(e.filter(function(t){return"inner"===t.role})),u=s.map(function(t){return[t]}),l=0;l<a.length;l++){var c=o(a[l]);void 0!==c?u[c].push(a[l]):M.verbose&&console.warn("Multipolygon",r+"/"+i,"contains an inner ring with no containing outer")}var p,e=[];return 0==(e=P.compact(u.map(function(t){t=P.compact(t.map(function(t){if(!(t.length<4))return P.compact(t.map(function(t){return[+t.lon,+t.lat]}));M.verbose&&console.warn("Multipolygon",r+"/"+i,"contains a ring with less than four nodes")}));if(0!=t.length)return t;M.verbose&&console.warn("Multipolygon",r+"/"+i,"contains an empty ring cluster")}))).length?(M.verbose&&console.warn("Multipolygon",r+"/"+i,"contains no coordinates"),!1):(p="MultiPolygon",1===e.length&&(p="Polygon",e=e[0]),t={type:"Feature",id:t.type+"/"+i,properties:{type:t.type,id:i,tags:t.tags||{},relations:v[t.type][t.id]||[],meta:h(t)},geometry:{type:p,coordinates:e}},n&&(M.verbose&&console.warn("Multipolygon",r+"/"+i,"is tainted"),t.properties.tainted=!0),t)}if(!P.isArray(i[s].members))return M.verbose&&console.warn("Multipolygon",i[s].type+"/"+i[s].id,"ignored because it has no members"),"continue";for(a=I=0;a<i[s].members.length;a++)"outer"==i[s].members[a].role?I++:M.verbose&&"inner"!=i[s].members[a].role&&console.warn("Multipolygon",i[s].type+"/"+i[s].id,"member",i[s].members[a].type+"/"+i[s].members[a].ref,'ignored because it has an invalid role: "'+i[s].members[a].role+'"');if(i[s].members.forEach(function(t){f[t.ref]&&("outer"!==t.role||o(f[t.ref].tags,i[s].tags)||(f[t.ref].is_skippablerelationmember=!0),"inner"!==t.role||o(f[t.ref].tags)||(f[t.ref].is_skippablerelationmember=!0))}),0==I)return M.verbose&&console.warn("Multipolygon relation",i[s].type+"/"+i[s].id,"ignored because it has no outer ways"),"continue";if(N=!1,1!=I||o(i[s].tags,{type:!0})||(N=!0),k=null,N){if(O=i[s].members.filter(function(t){return"outer"===t.role})[0],void 0===(O=f[O.ref]))return M.verbose&&console.warn("Multipolygon relation",i[s].type+"/"+i[s].id,"ignored because outer way",O.type+"/"+O.ref,"is missing"),"continue";O.is_skippablerelationmember=!0,k=e(O,i[s])}else k=e(i[s],i[s]);if(!1===k)return M.verbose&&console.warn("Multipolygon relation",i[s].type+"/"+i[s].id,"ignored because it has invalid geometry"),"continue";L?L(T(k)):S.push(k)}}for(var E=[],S=[],s=0;s<i.length;s++){var I,N,O;w()}for(s=0;s<e.length;s++)if(f[e[s].id]===e[s])if(P.isArray(e[s].nodes)){if(!e[s].is_skippablerelationmember){"number"!=typeof e[s].id&&(e[s].id=+e[s].id.replace("_fullGeom","")),e[s].tainted=!1,e[s].hidden=!1;var C,k,A=new Array;for(a=0;a<e[s].nodes.length;a++)"object"==_typeof3(e[s].nodes[a])?A.push([+e[s].nodes[a].lon,+e[s].nodes[a].lat]):(M.verbose&&console.warn("Way",e[s].type+"/"+e[s].id,"is tainted by an invalid node"),e[s].tainted=!0);A.length<=1?M.verbose&&console.warn("Way",e[s].type+"/"+e[s].id,"ignored because it contains too few nodes"):(C="LineString",void 0!==e[s].nodes[0]&&void 0!==e[s].nodes[e[s].nodes.length-1]&&e[s].nodes[0].id===e[s].nodes[e[s].nodes.length-1].id&&(void 0!==e[s].tags&&function(t){var e=M.polygonFeatures;if("function"==typeof e)return e(t);if("no"!==t.area)for(var n in t){var r=t[n],n=e[n];if(void 0!==n&&"no"!==r){if(!0===n)return 1;if(n.included_values&&!0===n.included_values[r])return 1;if(n.excluded_values&&!0!==n.excluded_values[r])return 1}}return}(e[s].tags)||e[s].__is_bounds_placeholder)&&(C="Polygon",A=[A]),k={type:"Feature",id:e[s].type+"/"+e[s].id,properties:{type:e[s].type,id:e[s].id,tags:e[s].tags||{},relations:v.way[e[s].id]||[],meta:h(e[s])},geometry:{type:C,coordinates:A}},e[s].tainted&&(M.verbose&&console.warn("Way",e[s].type+"/"+e[s].id,"is tainted"),k.properties.tainted=!0),e[s].__is_bounds_placeholder&&(k.properties.geometry="bounds"),L?L(T(k)):("LineString"==C?E:S).push(k))}}else M.verbose&&console.warn("Way",e[s].type+"/"+e[s].id,"ignored because it has no nodes");return!!L||((m={type:"FeatureCollection",features:[]}).features=m.features.concat(S),m.features=m.features.concat(E),m.features=m.features.concat(x),M.flatProperties&&m.features.forEach(function(t){t.properties=P.merge(t.properties.meta,t.properties.tags,{id:t.properties.type+"/"+t.properties.id})}),T(m))}}).toGeojson=t},{"./lodash.custom.js":212,"@mapbox/geojson-rewind":2,"osm-polygon-features":209}],212:[function(t,Je,We){!function(Ye){!function(){!function(){var D,g="__lodash_hash_undefined__",F=1,j=2,m=1/0,b=9007199254740991,q="[object Arguments]",tt="[object Array]",et="[object Boolean]",nt="[object Date]",rt="[object Error]",x="[object Function]",w="[object GeneratorFunction]",B="[object Map]",it="[object Number]",G="[object Object]",E="[object Promise]",ot="[object RegExp]",z="[object Set]",st="[object String]",at="[object Symbol]",S="[object WeakMap]",ut="[object ArrayBuffer]",U="[object DataView]",I="[object Float32Array]",N="[object Float64Array]",O="[object Int8Array]",C="[object Int16Array]",k="[object Int32Array]",A="[object Uint8Array]",M="[object Uint8ClampedArray]",L="[object Uint16Array]",P="[object Uint32Array]",T=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,R=/^\w*$/,lt=/^\./,ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/\\(\\)?/g,ht=/\w*$/,ft=/^\[object .+?Constructor\]$/,dt=/^(?:0|[1-9]\d*)$/,e={},d=(e[I]=e[N]=e[O]=e[C]=e[k]=e[A]=e[M]=e[L]=e[P]=!0,e[q]=e[tt]=e[ut]=e[et]=e[U]=e[nt]=e[rt]=e[x]=e[B]=e[it]=e[G]=e[ot]=e[z]=e[st]=e[S]=!1,{}),t=(d[q]=d[tt]=d[ut]=d[U]=d[et]=d[nt]=d[I]=d[N]=d[O]=d[C]=d[k]=d[B]=d[it]=d[G]=d[ot]=d[z]=d[st]=d[at]=d[A]=d[M]=d[L]=d[P]=!0,d[rt]=d[x]=d[S]=!1,"object"==_typeof3(Ye)&&Ye&&Ye.Object===Object&&Ye),n="object"==("undefined"==typeof self?"undefined":_typeof3(self))&&self&&self.Object===Object&&self,n=t||n||Function("return this")(),yt="object"==_typeof3(We)&&We&&!We.nodeType&&We,gt=yt&&"object"==_typeof3(Je)&&Je&&!Je.nodeType&&Je,mt=gt&&gt.exports===yt,vt=mt&&t.process,t=function(){try{return vt&&vt.binding("util")}catch(t){}}(),t=t&&t.isTypedArray;function _t(t,e){return t.set(e[0],e[1]),t}function bt(t,e){return t.add(e),t}function xt(t,e){for(var n=-1,r=t?t.length:0;++n<r&&!1!==e(t[n],n,t););return t}function wt(t,e,n,r){var i=-1,o=t?t.length:0;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function V(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function Et(t){var n=-1,r=Array(t.size);return t.forEach(function(t,e){r[++n]=[e,t]}),r}function St(e,n){return function(t){return e(n(t))}}function It(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var Nt=Array.prototype,r=Function.prototype,Ot=Object.prototype,i=n["__core-js_shared__"],Ct=(i=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",kt=r.toString,$=Ot.hasOwnProperty,At=kt.call(Object),o=Ot.toString,Mt=RegExp("^"+kt.call($).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),i=mt?n.Buffer:D,r=n.Symbol,Lt=n.Uint8Array,Pt=St(Object.getPrototypeOf,Object),Tt=Object.create,Rt=Ot.propertyIsEnumerable,Dt=Nt.splice,mt=Object.getOwnPropertySymbols,Nt=i?i.isBuffer:D,Ft=St(Object.keys,Object),jt=Math.max,i=h(n,"DataView"),s=h(n,"Map"),qt=h(n,"Promise"),Bt=h(n,"Set"),n=h(n,"WeakMap"),a=h(Object,"create"),Gt=!Rt.call({valueOf:1},"valueOf"),zt=f(i),Ut=f(s),Vt=f(qt),$t=f(Bt),Xt=f(n),r=r?r.prototype:D,X=r?r.valueOf:D,Yt=r?r.toString:D;function u(){}function l(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function c(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function p(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Jt(t){var e=-1,n=t?t.length:0;for(this.__data__=new p;++e<n;)this.add(t[e])}function Y(t){this.__data__=new c(t)}function Wt(t,e){var n,r=H(t)||_(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],i=r.length,o=!!i;for(n in t)!e&&!$.call(t,n)||o&&("length"==n||_e(n,i))||r.push(n);return r}function Ht(t,e,n){(n===D||W(t[e],n))&&("number"!=typeof e||n!==D||e in t)||(t[e]=n)}function Kt(t,e,n){var r=t[e];$.call(t,e)&&W(r,n)&&(n!==D||e in t)||(t[e]=n)}function Qt(t,e){for(var n=t.length;n--;)if(W(t[n][0],e))return n;return-1}function v(n,r,i,o,t,e,s){var a;if((a=o?e?o(n,t,e,s):o(n):a)===D){if(!K(n))return n;t=H(n);if(t){if(a=function(t){var e=t.length,n=t.constructor(e);e&&"string"==typeof t[0]&&$.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(n),!r)return de(n,a)}else{var u,l,c=J(n),p=c==x||c==w;if(ke(n))return u=n,(l=r)?u.slice():(l=new u.constructor(u.length),u.copy(l),l);if(c==G||c==q||p&&!e){if(V(n))return e?n:{};if(a="function"!=typeof(u=p?{}:n).constructor||xe(u)?{}:function(t){return K(t)?Tt(t):{}}(Pt(u)),!r)return p=l=n,p=(f=a)&&ye(p,Z(p),f),ye(l,ve(l),p)}else{if(!d[c])return e?n:{};a=function(t,e,n,r){var i=t.constructor;switch(e){case ut:return fe(t);case et:case nt:return new i(+t);case U:return function(t,e){e=e?fe(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}(t,r);case I:case N:case O:case C:case k:case A:case M:case L:case P:return function(t,e){e=e?fe(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}(t,r);case B:return function(t,e,n){return wt(e?n(Et(t),!0):Et(t),_t,new t.constructor)}(t,r,n);case it:case st:return new i(t);case ot:return function(t){var e=new t.constructor(t.source,ht.exec(t));return e.lastIndex=t.lastIndex,e}(t);case z:return function(t,e,n){return wt(e?n(It(t),!0):It(t),bt,new t.constructor)}(t,r,n);case at:return function(t){return X?Object(X.call(t)):{}}(t)}}(n,c,v,r)}}var h,f=(s=s||new Y).get(n);if(f)return f;s.set(n,a),xt((h=t?h:i?function(t,e,n){e=e(t);return H(t)?e:function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}(e,n(t))}(n,Z,ve):Z(n))||n,function(t,e){h&&(t=n[e=t]),Kt(a,e,v(t,r,i,o,e,n,s))})}return a}l.prototype.clear=function(){this.__data__=a?a(null):{}},l.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},l.prototype.get=function(t){var e,n=this.__data__;return a?(e=n[t])===g?D:e:$.call(n,t)?n[t]:D},l.prototype.has=function(t){var e=this.__data__;return a?e[t]!==D:$.call(e,t)},l.prototype.set=function(t,e){return this.__data__[t]=a&&e===D?g:e,this},c.prototype.clear=function(){this.__data__=[]},c.prototype.delete=function(t){var e=this.__data__;return!((t=Qt(e,t))<0||(t==e.length-1?e.pop():Dt.call(e,t,1),0))},c.prototype.get=function(t){var e=this.__data__;return(t=Qt(e,t))<0?D:e[t][1]},c.prototype.has=function(t){return-1<Qt(this.__data__,t)},c.prototype.set=function(t,e){var n=this.__data__,r=Qt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},p.prototype.clear=function(){this.__data__={hash:new l,map:new(s||c),string:new l}},p.prototype.delete=function(t){return me(this,t).delete(t)},p.prototype.get=function(t){return me(this,t).get(t)},p.prototype.has=function(t){return me(this,t).has(t)},p.prototype.set=function(t,e){return me(this,t).set(t,e),this},Jt.prototype.add=Jt.prototype.push=function(t){return this.__data__.set(t,g),this},Jt.prototype.has=function(t){return this.__data__.has(t)},Y.prototype.clear=function(){this.__data__=new c},Y.prototype.delete=function(t){return this.__data__.delete(t)},Y.prototype.get=function(t){return this.__data__.get(t)},Y.prototype.has=function(t){return this.__data__.has(t)},Y.prototype.set=function(t,e){var n=this.__data__;if(n instanceof c){var r=n.__data__;if(!s||r.length<199)return r.push([t,e]),this;n=this.__data__=new p(r)}return n.set(t,e),this};function Zt(t,e){if(null!=t){if(!y(t))return te(t,e);for(var n=t.length,r=ee?n:-1,i=Object(t);(ee?r--:++r<n)&&!1!==e(i[r],r,i););}return t}te=function(t,e){return t&&re(t,e,Z)};var te,ee,ne,re=function(t,e,n){for(var r=-1,i=Object(t),o=n(t),s=o.length;s--;){var a=o[ne?s:++r];if(!1===e(i[a],a,i))break}return t};function ie(t,e){for(var n=0,r=(e=be(e,t)?[e]:he(e)).length;null!=t&&n<r;)t=t[Ie(e[n++])];return n&&n==r?t:D}function oe(t,e){return null!=t&&e in Object(t)}function se(t,e,n,r,i){if(t===e)return!0;if(null==t||null==e||!K(t)&&!Q(e))return t!=t&&e!=e;var o=se,s=H(t),a=H(e),u=tt,l=tt,a=(s||(u=(u=J(t))==q?G:u),a||(l=(l=J(e))==q?G:l),u==G&&!V(t)),c=l==G&&!V(e);if((l=u==l)&&!a){i=i||new Y;if(s||Re(t))return ge(t,e,o,n,r,i);else{var p=t;var h=e;var f=u;var d=o;var y=n;var g=r;var m=i;switch(f){case U:if(p.byteLength!=h.byteLength||p.byteOffset!=h.byteOffset)return!1;p=p.buffer,h=h.buffer;case ut:return p.byteLength==h.byteLength&&d(new Lt(p),new Lt(h))?!0:!1;case et:case nt:case it:return W(+p,+h);case rt:return p.name==h.name&&p.message==h.message;case ot:case st:return p==h+"";case B:var v=Et;case z:var _=g&j;if(v=v||It,p.size!=h.size&&!_)return!1;_=m.get(p);if(_)return _==h;g|=F,m.set(p,h);_=ge(v(p),v(h),d,y,g,m);return m.delete(p),_;case at:if(X)return X.call(p)==X.call(h)}return!1;return}}if(!(r&j)){var s=a&&$.call(t,"__wrapped__"),u=c&&$.call(e,"__wrapped__");if(s||u)return a=s?t.value():t,c=u?e.value():e,i=i||new Y,o(a,c,n,r,i)}if(l){i=i||new Y;var b=t,x=e,w=o,E=n,S=r,I=i,N=S&j,O=Z(b),C=O.length,s=Z(x).length;if(C!=s&&!N)return!1;for(var k=C;k--;){var A=O[k];if(!(N?A in x:$.call(x,A)))return!1}if((s=I.get(b))&&I.get(x))return s==x;for(var M=!0,L=(I.set(b,x),I.set(x,b),N);++k<C;){A=O[k];var P,T=b[A],R=x[A];if(!((P=E?N?E(R,T,A,x,b,I):E(T,R,A,b,x,I):P)===D?T===R||w(T,R,E,S,I):P)){M=!1;break}L=L||"constructor"==A}return M&&!L&&(s=b.constructor,u=x.constructor,s!=u)&&"constructor"in b&&"constructor"in x&&!("function"==typeof s&&s instanceof s&&"function"==typeof u&&u instanceof u)&&(M=!1),I.delete(b),I.delete(x),M}return!1}function ae(t){var e;return K(t)&&(e=t,!(Ct&&Ct in e))&&(Ae(t)||V(t)?Mt:ft).test(f(t))}function ue(t){if("function"==typeof t)return t;if(null==t)return ze;if("object"==_typeof3(t))if(H(t)){var n=t[0],r=t[1];return be(n)&&we(r)?Ee(Ie(n),r):function(t){var e=je(t,n);return e===D&&e===r?qe(t,n):se(r,e,D,F|j)}}else{var e=t,i=function(t){var e=Z(t),n=e.length;for(;n--;){var r=e[n],i=t[r];e[n]=[r,i,we(i)]}return e}(e);return 1==i.length&&i[0][2]?Ee(i[0][0],i[0][1]):function(t){return t===e||function(t,e,n,r){var i=n.length,o=i,s=!r;if(null==t)return!o;for(t=Object(t);i--;){var a=n[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var u=(a=n[i])[0],l=t[u],c=a[1];if(s&&a[2]){if(l===D&&!(u in t))return!1}else{var p,h=new Y;if(!((p=r?r(l,c,u,t,e,h):p)===D?se(c,l,r,F|j,h):p))return!1}}return!0}(t,e,i)}}return Ve(t)}function le(t){if(!K(t)){var e=t,n=[];if(null!=e)for(var r in Object(e))n.push(r);return n}var i,o=xe(t),s=[];for(i in t)("constructor"!=i||!o&&$.call(t,i))&&s.push(i);return s}function ce(h,f,d,y,g){var m;h!==f&&xt((m=H(f)||Re(f)?m:le(f))||f,function(t,e){var n,r,i,o,s,a,u,l,c,p;K(t=m?f[e=t]:t)?(g=g||new Y,r=f,o=d,s=ce,a=y,u=g,l=(n=h)[i=e],c=r[i],(p=u.get(c))?Ht(n,i,p):(p=a?a(l,c,i+"",n,r,u):D,(r=p===D)&&(H(p=c)||Re(c)?p=H(l)?l:Ce(l)?de(l):v(c,!(r=!1)):Le(c)||_(c)?p=_(l)?De(l):!K(l)||o&&Ae(l)?v(c,!(r=!1)):l:r=!1),r&&(u.set(c,p),s(p,c,o,a,u),u.delete(c)),Ht(n,i,p))):(l=y?y(h[e],t,e+"",h,f,g):D,Ht(h,e,l=l===D?t:l))})}function pe(u,l){return l=jt(l===D?u.length-1:l,0),function(){for(var t=arguments,e=-1,n=jt(t.length-l,0),r=Array(n);++e<n;)r[e]=t[l+e];for(var e=-1,i=Array(l+1);++e<l;)i[e]=t[e];i[l]=r;var o=u,s=this,a=i;switch(a.length){case 0:return o.call(s);case 1:return o.call(s,a[0]);case 2:return o.call(s,a[0],a[1]);case 3:return o.call(s,a[0],a[1],a[2])}return o.apply(s,a)}}function he(t){return H(t)?t:Se(t)}function fe(t){var e=new t.constructor(t.byteLength);return new Lt(e).set(new Lt(t)),e}function de(t,e){var n=-1,r=t.length;for(e=e||Array(r);++n<r;)e[n]=t[n];return e}function ye(t,e,n,r){n=n||{};for(var i=-1,o=e.length;++i<o;){var s=e[i],a=r?r(n[s],t[s],s,n,t):D;Kt(n,s,a===D?t[s]:a)}return n}function ge(t,e,n,r,i,o){var s=i&j,a=t.length,u=e.length;if(a!=u&&!(s&&a<u))return!1;u=o.get(t);if(u&&o.get(e))return u==e;var l=-1,c=!0,p=i&F?new Jt:D;for(o.set(t,e),o.set(e,t);++l<a;){var h,f=t[l],d=e[l];if((h=r?s?r(d,f,l,e,t,o):r(f,d,l,t,e,o):h)!==D){if(h)continue;c=!1;break}if(p){if(!function(t,e){for(var n=-1,r=t?t.length:0;++n<r;)if(e(t[n],n,t))return 1}(e,function(t,e){return!p.has(e)&&(f===t||n(f,t,r,i,o))&&p.add(e)})){c=!1;break}}else if(f!==d&&!n(f,d,r,i,o)){c=!1;break}}return o.delete(t),o.delete(e),c}function me(t,e){var n,r,t=t.__data__;return("string"==(r=_typeof3(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?t["string"==typeof e?"string":"hash"]:t.map}function h(t,e){e=e;t=null==(t=t)?D:t[e];return ae(t)?t:D}var ve=mt?St(mt,Object):$e,J=function(t){return o.call(t)};function _e(t,e){return!!(e=null==e?b:e)&&("number"==typeof t||dt.test(t))&&-1<t&&t%1==0&&t<e}function be(t,e){var n;if(!H(t))return"number"==(n=_typeof3(t))||"symbol"==n||"boolean"==n||null==t||Pe(t)||R.test(t)||!T.test(t)||null!=e&&t in Object(e)}function xe(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ot)}function we(t){return t==t&&!K(t)}function Ee(e,n){return function(t){return null!=t&&t[e]===n&&(n!==D||e in Object(t))}}(i&&J(new i(new ArrayBuffer(1)))!=U||s&&J(new s)!=B||qt&&J(qt.resolve())!=E||Bt&&J(new Bt)!=z||n&&J(new n)!=S)&&(J=function(t){var e=o.call(t),t=e==G?t.constructor:D,t=t?f(t):D;if(t)switch(t){case zt:return U;case Ut:return B;case Vt:return E;case $t:return z;case Xt:return S}return e});var Se=Oe(function(t){t=Fe(t);var i=[];return lt.test(t)&&i.push(""),t.replace(ct,function(t,e,n,r){i.push(n?r.replace(pt,"$1"):e||t)}),i});function Ie(t){var e;return"string"==typeof t||Pe(t)?t:"0"==(e=t+"")&&1/t==-m?"-0":e}function f(t){if(null!=t){try{return kt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ne(t,e){return(H(t)?xt:Zt)(t,function(t,e){var n=(n=u.iteratee||Ue)===Ue?ue:n;return arguments.length?n(t,e):n}(e,3))}function Oe(r,i){if("function"!=typeof r||i&&"function"!=typeof i)throw new TypeError("Expected a function");function o(){var t=arguments,e=i?i.apply(this,t):t[0],n=o.cache;return n.has(e)?n.get(e):(t=r.apply(this,t),o.cache=n.set(e,t),t)}return o.cache=new(Oe.Cache||p),o}function W(t,e){return t===e||t!=t&&e!=e}function _(t){return Ce(t)&&$.call(t,"callee")&&(!Rt.call(t,"callee")||o.call(t)==q)}Oe.Cache=p;var H=Array.isArray;function y(t){return null!=t&&Me(t.length)&&!Ae(t)}function Ce(t){return Q(t)&&y(t)}var ke=Nt||Xe;function Ae(t){t=K(t)?o.call(t):"";return t==x||t==w}function Me(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=b}function K(t){var e=_typeof3(t);return!!t&&("object"==e||"function"==e)}function Q(t){return!!t&&"object"==_typeof3(t)}function Le(t){return!(!Q(t)||o.call(t)!=G||V(t))&&(null===(t=Pt(t))||"function"==typeof(t=$.call(t,"constructor")&&t.constructor)&&t instanceof t&&kt.call(t)==At)}function Pe(t){return"symbol"==_typeof3(t)||Q(t)&&o.call(t)==at}var Te,Re=t?(Te=t,function(t){return Te(t)}):function(t){return Q(t)&&Me(t.length)&&!!e[o.call(t)]};function De(t){return ye(t,Be(t))}function Fe(t){return null==t?"":"string"==typeof(t=t)?t:Pe(t)?Yt?Yt.call(t):"":"0"==(e=t+"")&&1/t==-m?"-0":e;var e}function je(t,e,n){t=null==t?D:ie(t,e);return t===D?n:t}function qe(t,e){return null!=t&&function(t,e,n){for(var r,i=-1,o=(e=be(e,t)?[e]:he(e)).length;++i<o;){var s=Ie(e[i]);if(!(r=null!=t&&n(t,s)))break;t=t[s]}return r||!!(o=t?t.length:0)&&Me(o)&&_e(s,o)&&(H(t)||_(t))}(t,e,oe)}function Z(t){return(y(t)?Wt:function(t){if(!xe(t))return Ft(t);var e,n=[];for(e in Object(t))$.call(t,e)&&"constructor"!=e&&n.push(e);return n})(t)}function Be(t){return y(t)?Wt(t,!0):le(t)}Ge=function(t,e,n){ce(t,e,n)};var Ge,r=pe(function(t,e){var n=-1,r=e.length,i=1<r?e[r-1]:D,o=2<r?e[2]:D,i=3<Ge.length&&"function"==typeof i?(r--,i):D;for(o&&function(t,e,n){if(K(n)){var r=_typeof3(e);if("number"==r?y(n)&&_e(e,n.length):"string"==r&&e in n)return W(n[e],t)}return}(e[0],e[1],o)&&(i=r<3?D:i,r=1),t=Object(t);++n<r;){var s=e[n];s&&Ge(t,s,n,i)}return t});function ze(t){return t}function Ue(t){return ue("function"==typeof t?t:v(t,!0))}function Ve(t){return be(t)?(n=Ie(t),function(t){return null==t?D:t[n]}):(e=t,function(t){return ie(t,e)});var e,n}function $e(){return[]}function Xe(){return!1}u.compact=function(t){for(var e=-1,n=t?t.length:0,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},u.iteratee=Ue,u.keys=Z,u.keysIn=Be,u.memoize=Oe,u.merge=r,u.property=Ve,u.toPlainObject=De,u.clone=function(t){return v(t,!1,!0)},u.eq=W,u.forEach=Ne,u.get=je,u.hasIn=qe,u.identity=ze,u.isArguments=_,u.isArray=H,u.isArrayLike=y,u.isArrayLikeObject=Ce,u.isBuffer=ke,u.isEmpty=function(t){if(y(t)&&(H(t)||"string"==typeof t||"function"==typeof t.splice||ke(t)||_(t)))return!t.length;var e,n=J(t);if(n==B||n==z)return!t.size;if(Gt||xe(t))return!Ft(t).length;for(e in t)if($.call(t,e))return!1;return!0},u.isFunction=Ae,u.isLength=Me,u.isObject=K,u.isObjectLike=Q,u.isPlainObject=Le,u.isSymbol=Pe,u.isTypedArray=Re,u.stubArray=$e,u.stubFalse=Xe,u.toString=Fe,u.each=Ne,u.VERSION="4.15.0",gt&&((gt.exports=u)._=u,yt._=u)}.call(this)}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],213:[function(t,e,n){var i=t("boundingbox"),o=t("./turf"),r=t("./Filter"),s={},a=function(){"use strict";function n(t,e){_classCallCheck2(this,n),this.overpass=t,this.id=e,this.filter=new r(e),this.area=null}return _createClass2(n,[{key:"add",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;e&&e.ids||(t=new i(t).toGeoJSON(),e&&e.bounds&&(t=o.intersect(t,e.bounds)),null===this.area?this.area=t:this.area=o.union(t,this.area))}},{key:"check",value:function(e){var t,n=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(r&&r.invalid)return!0;if(r&&r.ids)return(t="nwr"===(t=[r.id.match(/^(node|way|relation|nwr)/)[1]])[0]?["node","way","relation"]:t).every(function(e){return r.ids.every(function(t){return e.substr(0,1)+t in n.overpass.cacheElements})});if((e=new i(e).toGeoJSON(),r&&r.bounds&&(e=o.intersect(e,r.bounds)),this.area)&&!o.difference(e,this.area))return!0;return Object.values(s).some(function(t){return t.id!==n.id&&!(!t.filter.isSupersetOf(n.filter)||!t.area||o.difference(e,t.area))})}},{key:"clear",value:function(){this.area=null,delete s[this.id]}},{key:"toGeoJSON",value:function(){return this.area}}]),n}();a.get=function(t,e){return e in s||(s[e]=new a(t,e)),s[e]},a.clear=function(){for(var t in s)delete s[t]},a.list=s,e.exports=a},{"./Filter":219,"./turf":280,boundingbox:54}],214:[function(t,e,n){var c=t("./parseString"),p=t("./evaluator/__functions__"),r=t("./evaluator/__operators__"),i=t("./evaluatorExport"),h=t("./EvaluatorValue");function f(t,e){return t?t.right?t.right=f(t.right,e):t.right=e:t=e,t}function d(t,e){t.right?d(t.right,e):t.parameters.push(e)}function y(t,e){e=new r[e](e,t,null);return t&&t.op&&e.priority()<t.priority()?(e.left=t.right||null,t.right=e):t=e,t}t=function(){"use strict";function l(){_classCallCheck2(this,l)}return _createClass2(l,[{key:"toJSON",value:function(){return i(this.data)}},{key:"parse",value:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=(this.data=null,0);;)if(0===n){var r=t.match(/^(\s*)((-?[0-9]+(\.[0-9]+)?)|(["'!-])|(t\[\s*)|([a-z_]*)\(|(,\)))/);if(!r)throw new Error("mode 0");if(r[3])t=t.substr(r[1].length+r[3].length),this.data=f(this.data,new h(parseFloat(r[3]))),n=1;else if(["!","-"].includes(r[5]))this.data=y(this.data,"-"===r[5]?"â":r[5]),t=t.substr(r[1].length+r[5].length);else if(r[5]){var i=_slicedToArray(c(t.substr(r[1].length)),2),o=i[0];t=i[1],this.data=f(this.data,new h(o)),n=1}else if(r[6])n=10,t=t.substr(r[1].length+r[6].length);else if(void 0!==r[7])n=20,t=t.substr(r[1].length+r[7].length+1),this.data=f(this.data,new p[r[7]](r[7],[]));else if(r[8])return t=t.substr(r[1].length)}else if(1===n){i=t.match(/^(\s*)([),:].*|)$/);if(i)return t=t.substr(i[1].length);o=t.match(/^\s*([=!]=|[<>]=?|[+*-/]|&&|\|\||\?)/);if(!o)throw new Error("mode 1");if(t=t.substr(o[0].length),this.data=y(this.data,o[1]),n=0,"?"===o[1]){var r=new l,s=(t=r.parse(t,e+1,!0),this.data.left=r.data,t.match(/^\s*:/));if(!s)throw new Error("mode 1 - ternary 2nd parameter expected");t=t.substr(s[0].length),t=r.parse(t,e+1),this.data.right=r.data,n=1}}else if(10===n){var s=_slicedToArray(c(t),2),a=s[0];t=s[1],this.data=f(this.data,new p.tag("tag",[new h(a)])),n=11}else if(11===n){a=t.match(/^\s*\]/);if(!a)throw new Error("mode 11");t=t.substr(a[0].length),n=1}else if(20===n){t.match(/^\s*\)/)||(t=(u=new l).parse(t,e+1),d(this.data,u.data));var u=t.match(/^\s*([),])/);if(!u)throw new Error("20");t=t.substr(u[0].length),n=")"===u[1]?1:20}}},{key:"exec",value:function(t){return this.data.eval(t)}},{key:"simplify",value:function(){return this.data.simplify()}},{key:"toString",value:function(){return this.data.toString(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{toString:!0})}},{key:"toQl",value:function(){return this.data.toString({})}},{key:"toValue",value:function(){return this.data.toValue()}},{key:"compileLokiJS",value:function(){return this.data.compileLokiJS()}},{key:"cacheDescriptors",value:function(o){var t,e=this;this.simplified||(this.simplified=this.simplify()),"value"in this.simplified?o.forEach(function(t){e.simplified.value||(t.invalid=!0)}):(t=[{filters:"",properties:0}],this.simplified.cacheDescriptors(t),o.forEach(function(r){var i=JSON.parse(JSON.stringify(r));t.forEach(function(t,e){var n=r;0<e&&(n=JSON.parse(JSON.stringify(i)),o.push(n)),n.filters+="(if:"+t.filters+")",n.properties|=t.properties})}))}},{key:"isSupersetOf",value:function(t){return this.data.isSupersetOf(t.data)}}]),l}();e.exports=t},{"./EvaluatorValue":218,"./evaluator/__functions__":239,"./evaluator/__operators__":240,"./evaluatorExport":257,"./parseString":266}],215:[function(t,e,n){var o=t("./evaluatorExport"),s=t("./EvaluatorPart"),a=t("./EvaluatorValue");e.exports=function(){"use strict";_inherits(i,s);var r=_createSuper(i);function i(t,e){var n;return _classCallCheck2(this,i),(n=r.call(this)).fun=t,n.parameters=e,n}return _createClass2(i,[{key:"toJSON",value:function(){return{fun:this.fun,parameters:this.parameters.map(function(t){return o(t)})}}},{key:"toString",value:function(e){var t=this.parameters.map(function(t){return t.toString(e)});return this.fun+"("+t.join(",")+")"}},{key:"toValue",value:function(){return null}},{key:"simplify",value:function(){var t=this.toValue();return null!==t?new a(t):(t=this.parameters.map(function(t){return t.simplify()}),new this.constructor(this.fun,t))}},{key:"compileLokiJS",value:function(){return{needMatch:!0}}},{key:"calcRequestProperties",value:function(){var e=this.requestProperties;return this.parameters.forEach(function(t){e|=t.calcRequestProperties()}),e}}]),i}()},{"./EvaluatorPart":217,"./EvaluatorValue":218,"./evaluatorExport":257}],216:[function(t,e,n){var r=t("./evaluatorExport"),s=t("./EvaluatorPart"),a=t("./EvaluatorValue");e.exports=function(){"use strict";_inherits(o,s);var i=_createSuper(o);function o(t,e,n){var r;return _classCallCheck2(this,o),(r=i.call(this)).op=t,r.left=e,r.right=n,r}return _createClass2(o,[{key:"toJSON",value:function(){return{op:this.op,left:r(this.left),right:r(this.right)}}},{key:"toValue",value:function(){return null===this.left.toValue()||null===this.right.toValue()?null:this.eval({})}},{key:"simplify",value:function(){var t,e=this.toValue();return null!==e?new a(e):(e=this.left?this.left.simplify():null,t=this.right?this.right.simplify():null,new this.constructor(this.op,e,t))}},{key:"compileLokiJS",value:function(){return{needMatch:!0}}},{key:"calcRequestProperties",value:function(){var t=this.requestProperties;return this.left&&(t|=this.left.calcRequestProperties()),this.right&&(t|=this.right.calcRequestProperties()),t}}]),o}()},{"./EvaluatorPart":217,"./EvaluatorValue":218,"./evaluatorExport":257}],217:[function(t,e,n){e.exports=function(){"use strict";function t(){_classCallCheck2(this,t)}return _createClass2(t,[{key:"compileLokiJS",value:function(){return{needMatch:!0}}},{key:"isSupersetOf",value:function(t){var e=this;return JSON.stringify(this)===JSON.stringify(t)||("||"===t.op?this.isSupersetOf(t.left)&&this.isSupersetOf(t.right):"&&"===t.op?this.isSupersetOf(t.left)||this.isSupersetOf(t.right):"and"===t.fun?t.parameters.some(function(t){return e.isSupersetOf(t)}):void 0)}},{key:"simplify",value:function(){return this}},{key:"cacheDescriptors",value:function(t){var e=this;t.forEach(function(t){t.filters+=e.toString({}),t.properties|=e.calcRequestProperties()})}},{key:"calcRequestProperties",value:function(){return 0}}]),t}()},{}],218:[function(t,e,n){var i=t("./EvaluatorPart");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t){var e;return _classCallCheck2(this,r),(e=n.call(this)).value=t,e}return _createClass2(r,[{key:"eval",value:function(t){return this.value}},{key:"toJSON",value:function(){return"boolean"==typeof this.value?this.value?1:0:this.value}},{key:"toString",value:function(){return"number"==typeof this.value?""+this.value:"string"==typeof this.value?'"'+this.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"':"boolean"==typeof this.value?this.value?"1":"0":void 0}},{key:"toValue",value:function(){return this.value}},{key:"compileLokiJS",value:function(){return{value:this.value}}}]),r}()},{"./EvaluatorPart":217}],219:[function(t,e,n){var o=t("./turf"),u=t("strsearch2regexp"),f=t("./filterJoin"),a=t("./defines"),b=t("./qlFunctions/__index__"),x=t("./parseString"),w=t("./parseParentheses"),l=t("./qlFunctions/qlFunction");function r(t){return'"'+t.replace(/"/g,'\\"')+'"'}function d(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(t))return t.map(d).join("");if(t.or)return{or:t.or.map(d)};var n=t.keyRegexp?"~":"";if(t instanceof l)return t.toString(e);if(t.type)return t.type;switch(t.op){case"has_key":return"i"===t.keyRegexp?"[~"+r(t.key)+'~".",i]':n?"[~"+r(t.key)+'~"."]':"["+n+r(t.key)+"]";case"not_exists":return"[!"+r(t.key)+"]";case"=":case"!=":case"~":case"!~":return"["+n+r(t.key)+t.op+r(t.value)+"]";case"~i":case"!~i":return"["+n+r(t.key)+t.op.substr(0,t.op.length-1)+r(t.value)+",i]";case"has":return"["+n+r(t.key)+"~"+r("^(.*;|)"+t.value+"(|;.*)$")+"]";case"strsearch":return"["+n+r(t.key)+"~"+r(u(t.value))+",i]";default:throw new Error("unknown operator"+JSON.stringify(t))}}function s(e,t){if(Array.isArray(t))return t.every(function(t){return s(e,t)});if(t.type)return e.type===t.type;if(t.or)return t.or.some(function(t){return s(e,t)});if(t.and)return t.and.every(function(t){return s(e,t)});if(t.keyRegexp){t.value&&(n=new RegExp(t.value,t.op.match(/i$/)?"i":""));var n,r,i=new RegExp(t.key,"i"===t.keyRegexp?"i":"");for(r in e.tags)if(r.match(i)){if(!n)return!0;if(e.tags[r].match(n))return!0}return!1}if(t instanceof l)return t.test(e);switch(t.op){case"has_key":return e.tags&&t.key in e.tags;case"not_exists":return e.tags&&!(t.key in e.tags);case"=":return e.tags&&t.key in e.tags&&e.tags[t.key]===t.value;case"!=":return e.tags&&(!(t.key in e.tags)||e.tags[t.key]!==t.value);case"~":return e.tags&&t.key in e.tags&&e.tags[t.key].match(t.value);case"!~":return e.tags&&(!(t.key in e.tags)||!e.tags[t.key].match(t.value));case"~i":return e.tags&&t.key in e.tags&&e.tags[t.key].match(new RegExp(t.value,"i"));case"!~i":return e.tags&&(!(t.key in e.tags)||!e.tags[t.key].match(new RegExp(t.value,"i")));case"has":return e.tags&&t.key in e.tags&&-1!==e.tags[t.key].split(/;/).indexOf(t.value);case"strsearch":return e.tags&&t.key in e.tags&&e.tags[t.key].match(new RegExp(u(t.value),"i"));default:return console.log("match: unknown operator in filter",t),!1}}function i(t){if("string"==typeof t){var e=function t(e,n){for(var r,i,o=1<arguments.length&&void 0!==n?n:0,s=[],a=[],u=0,l=!1,c=null;;)if(0===u){if(e.match(/^\s*$/))return[0===o&&1===s.length?s[0]:s,e];if(l=!1,(i=e.match(/^\s*(node|way|relation|rel|nwr|\()/))&&"("===i[1]){var p=_slicedToArray(t(e=e.slice(i[0].length),o+1),2),h=p[0];e=p[1],u=1,s.push({or:h}),a=[]}else{if(!i)throw new Error("Can't parse query, expected type of object (e.g. 'node'): "+e);"rel"===i[1]?a.push({type:"relation"}):"nwr"!==i[1]&&a.push({type:i[1]}),u=10,e=e.slice(i[0].length)}}else if(1===u){if(i=e.match(/^\s*\)\s*;?\s*/))return 0===o?[1===s.length?s[0]:s,e]:[s,e=e.slice(i[0].length)];u=0}else if(10===u)if((p=e.match(/^\s*(\[|\(|;)/))&&"["===p[1])e=e.slice(p[0].length),u=11;else if(p&&"("===p[1])e=e.slice(p[0].length-1),u=20;else{if(!p||";"!==p[1]){if(!p&&e.match(/^\s*$/))return a.length&&s.push(a),[0===o&&1===s.length?s[0]:s,""];throw new Error("Can't parse query, expected '[' or ';': "+e)}e=e.slice(p[0].length),s.push(a),a=[],c=null,u=1}else if(11===u){if((i=e.match(/^(\s*)(([~!])\s*)?([a-zA-Z0-9_]+|"|')/))&&i[2]&&("~"===i[3]?l=!0:"!"===i[3]&&(c=!0)),!i||'"'!==i[4]&&"'"!==i[4]){if(!i)throw new Error("Can't parse query, expected key: "+e);f=i[4],e=e.slice(i[0].length)}else{e=e.slice(i[1].length+(i[2]||"").length);var f=(h=x(e))[0];e=h[1]}u=12}else if(12===u)if((i=e.match(/^\s*(=|!=|~|!~|\^|]|%)/))&&"]"===i[1]){var d={key:f,op:"has_key"};l&&(d.keyRegexp=!0),c&&(d.op="not_exists"),a.push(d),e=e.slice(i[0].length),c=null,u=10}else{if(!i)throw new Error("Can't parse query, expected operator or ']': "+e);if(c)throw new Error("Can't parse query, expected ']': "+e);r="^"===i[1]?"has":"%"===i[1]?"strsearch":i[1],u=13,e=e.slice(i[0].length)}else if(13===u){if(!(i=e.match(/^(\s*)([a-zA-Z0-9_]+|"|')/))||'"'!==i[2]&&"'"!==i[2]){if(!i)throw new Error("Can't parse query, expected value: "+e);y=i[2],e=e.slice(i[0].length)}else{e=e.slice(i[1].length);var y=(d=x(e))[0];e=d[1]}u=14}else if(14===u){if(!(i=e.match(/^\s*(,i)?\]/)))throw new Error("Can't parse query, expected ']': "+e);if(",i"===i[1]){if("~"!==r&&"!~"!==r)throw new Error("Can't parse query, expected ']': "+e);r+="i"}var g={key:f,op:r};"."===y?g.op="has_key":g.value=y,l&&(g.keyRegexp=!r.match(/^!?~i$/)||"i"),a.push(g),u=10,e=e.slice(i[0].length)}else if(20===u){var g=w(e),m=(e=g[1],g[0].match(/^\s*(\d+)\s*$/)),v=g[0].match(/^((\s*\d+(.\d+)?\s*,){3}\s*\d+(.\d+)?\s*)$/),_=g[0].match(/^\s*(\w+)\s*:\s*(.*)\s*$/);if(m)a.push(new b.id(m[1]));else if(v)a.push(new b.bbox(v[1]));else{if(!_)throw new Error("Can't parse query, expected id, bbox or function: "+e);if(m=_[1],!b[m])throw new Error("Unsupported filter function: "+m);a.push(new b[m](_[2]))}u=10}}(t);if(e[1].trim())throw new Error("Can't parse query, trailing characters: "+e[1]);return e[0]}if(null!==t)return"object"===_typeof3(t)&&"Filter"===t.constructor.name?t=t.def:Array.isArray(t)&&(t=t.map(i)),t.and&&(t.and=t.and.map(i)),t.or?t.or=t.or.map(i):!t.fun||t instanceof l||(t=new b[t.fun](t.value)),t}t=function(){"use strict";function e(t){_classCallCheck2(this,e),this.def=t?i(t):[]}return _createClass2(e,[{key:"uniqId",value:function(){return this._uniqId=(this._uniqId||0)+1,this._uniqId}},{key:"match",value:function(e,t){var n=this;return t=t||this.def,(t=Array.isArray(t)&&Array.isArray(t[0])?t[t.length-1]:t).or?t.or.some(function(t){return n.match(e,t)}):t.and?t.and.every(s.bind(this,e)):t.filter(s.bind(this,e)).length===t.length}},{key:"toString",value:function(t){return this.toQl({toString:!0},t)}},{key:"toQl",value:function(){var t,e,n,r,i,o,s=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},u=(u=1<arguments.length?arguments[1]:void 0)||this.def;if(Array.isArray(u)&&Array.isArray(u[0]))return u.map(function(t){return s.toQl(a,t)}).join("");if(u.or)return"("+u.or.map(function(t){var e=JSON.parse(JSON.stringify(a));return e.inputSet=a.inputSet,e.outputSet="",s.toQl(e,t)}).join("")+")"+(a.outputSet?"->"+a.outputSet:"")+";";if(u.and)return t=u.and[0],e=u.and[u.and.length-1],n=u.and.concat().slice(1,u.and.length-1),h=".x"+this.uniqId(),r=JSON.parse(JSON.stringify(a)),i=JSON.parse(JSON.stringify(a)),o=JSON.parse(JSON.stringify(a)),r.outputSet=h,i.inputSet=h,i.outputSet=h,o.inputSet=h,this.toQl(r,t)+n.map(function(t){return s.toQl(i,t)}).join("")+this.toQl(o,e);a.inputSet||(a.inputSet=""),a.outputSet||(a.outputSet="");var l,c=u.filter(function(t){return t.type});switch(c.length){case 0:l=["nwr"];break;case 1:l=[c[0].type];break;default:throw new Error("Filter: only one type query allowed!")}var p=f(u.filter(function(t){return!t.type}).map(function(t){return d(t,a)})),h=1<p.length?"("+p.map(function(e){return l.map(function(t){return t+a.inputSet+e}).join(";")}).join(";")+";)":1===l.length?l[0]+a.inputSet+p[0]:"("+l.map(function(t){return t+a.inputSet+p[0]}).join(";")+";)";return h+(a.outputSet?"->"+a.outputSet:"")+";"}},{key:"toLokijs",value:function(){var e,n,t,i,o,s=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=(r=1<arguments.length?arguments[1]:void 0)||this.def;return(r=Array.isArray(r)&&Array.isArray(r[0])?r[r.length-1]:r).or?(e=!1,0<(t={$or:r.or.map(function(t){t=s.toLokijs(a,t);return t.needMatch&&(e=!0),delete t.needMatch,t})}).$or.filter(function(t){return 0===Object.keys(t).length}).length&&delete t.$or,e&&(t.needMatch=!0),t):r.and?(n=!1,t={$and:r.and.map(function(t){t=s.toLokijs(a,t);return t.needMatch&&(n=!0),delete t.needMatch,t}).filter(function(t){return Object.keys(t).length})},n&&(t.needMatch=!0),t):(i={},o=[],(r=Array.isArray(r)?r:[r]).forEach(function(t){var e,n,r;t.keyRegexp?(e="needMatch",n=!0):t instanceof l?((r=t.compileLokiJS()).needMatch&&(i.needMatch=!0),delete r.needMatch,Object.keys(r).length&&(i.$and?i.$and.push(r):i.$and=[r])):"="===t.op?(e="tags."+t.key,n={$eq:t.value}):"!="===t.op?(e="tags."+t.key,n={$ne:t.value}):"has_key"===t.op?(e="tags."+t.key,n={$exists:!0}):"not_exists"===t.op?(e="tags."+t.key,n={$exists:!1}):"has"===t.op?(e="tags."+t.key,n={$regex:"^(.*;|)"+t.value+"(|;.*)$"}):"~"===t.op||"~i"===t.op?(e="tags."+t.key,n={$regex:new RegExp(t.value,"~i"===t.op?"i":"")}):"!~"===t.op||"!~i"===t.op?(e="tags."+t.key,n={$not:{$regex:new RegExp(t.value,"!~i"===t.op?"i":"")}}):"strsearch"===t.op?(e="tags."+t.key,n={$regex:new RegExp(u(t.value),"i")}):t.type?(e="type",n={$eq:t.type}):t.or?o.push(t.or.map(function(t){t=s.toLokijs(a,t);return t.needMatch&&(i.needMatch=!0,delete t.needMatch),t})):console.log("unknown filter",t),e&&n&&("needMatch"===e?i.needMatch=!0:e in i?("$and"in i[e]||(i[e]={$and:[i[e]]}),i[e].$and.push(n)):i[e]=n)}),1===(o=o.filter(function(t){return Object.keys(t).length})).length?i.$or=o[0]:1<o.length&&(i.$and=o.map(function(t){return{$or:t}})),i)}},{key:"cacheDescriptors",value:function(){var t=Array.isArray(this.def)&&Array.isArray(this.def[0])?this._caches(this.def[this.def.length-1]):this._caches(this.def);return t.forEach(function(t){t.id=(t.type||"nwr")+t.filters+"(properties:"+t.properties+")",delete t.type,delete t.filters,delete t.properties}),t}},{key:"_caches",value:function(t){var e,o=this,s=[{filters:"",properties:0}];return t.or?(e=[],t.or.forEach(function(t){t=o._caches(t);Array.isArray(t)?e=e.concat(t):e.push(t)}),e):((t=Array.isArray(t)?t:[t]).forEach(function(e){if(e.type)s=s.map(function(t){return t.type&&t.type!==e.type?t.type="-":t.type=e.type,t});else if(e.op)s=s.map(function(t){return t.filters+=d(e),t.properties|=a.TAGS,t});else if(e instanceof l)e.cacheDescriptors(s);else if(e.or){var r=[];e.or.forEach(function(t){var n=o._caches(t);s.forEach(function(e){n.forEach(function(t){r.push(o._cacheMerge(e,t))})})}),s=r}else{if(!e.and)throw new Error("caches(): invalid entry");var i=s;e.and.forEach(function(t){var n=i;i=[],o._caches(t).forEach(function(e){n.forEach(function(t){i.push(o._cacheMerge(t,e))})})}),s=i}}),s)}},{key:"_cacheMerge",value:function(e,t){var n,r,i={};for(n in e)i[n]=e[n];return i.filters+=t.filters,i.properties|=t.properties,t.type&&(e.type&&e.type!==t.type?i.type="-":i.type=t.type),t.ids&&(i.ids=t.ids,e.ids)&&(i.ids=t.ids.filter(function(t){return e.ids.includes(t)})),t.invalid&&(i.invalid=!0),t.bounds&&e.bounds?(r=o.intersect(e.bounds,t.bounds))?i.bounds=r.geometry:(i.invalid=!0,delete i.bounds):t.bounds&&(i.bounds=t.bounds),i}},{key:"isSupersetOf",value:function(t){return this._isSupersetOf(this.def,t.def)}},{key:"_isSupersetOf",value:function(e,n){var r=this;return e.or?e.or.some(function(t){return r._isSupersetOf(t,n)}):e.and?e.and.every(function(t){return r._isSupersetOf(t,n)}):n.or?n.or.every(function(t){return r._isSupersetOf(e,t)}):n.and?n.and.some(function(t){return r._isSupersetOf(e,t)}):!e.some(function(e){return!n.some(function(t){return e.type&&t.type?e.type===t.type:d(t,{toString:!0})===d(e,{toString:!0})||!(!["~","~i"].includes(e.op)||"="!==t.op||e.key!==t.key||!t.value.match(RegExp(e.value,"~i"===e.op?"i":"")))||!(!(["~","~i"].includes(e.op)&&e.keyRegexp&&"="===t.op&&t.key.match(RegExp(e.key,"i"===e.keyRegexp?"i":""))&&t.value.match(RegExp(e.value,"~i"===e.op?"i":"")))&&("has_key"!==e.op||!t.op||["!=","!~","!~i","not_exists"].includes(t.op)||e.key!==t.key)&&("has_key"!==e.op||!e.keyRegexp||!t.op||["!=","!~","!~i","not_exists"].includes(t.op)||!t.key.match(RegExp(e.key,"i"===e.keyRegexp?"i":"")))&&!(e instanceof l&&t instanceof l&&e.isSupersetOf(t)))})})}},{key:"properties",value:function(){var t=Array.isArray(this.def)&&Array.isArray(this.def[0])?this._caches(this.def[this.def.length-1]):this._caches(this.def);return t.reduce(function(t,e){return t|e.properties},0)}}]),e}();e.exports=t},{"./defines":238,"./filterJoin":259,"./parseParentheses":265,"./parseString":266,"./qlFunctions/__index__":267,"./qlFunctions/qlFunction":275,"./turf":280,strsearch2regexp:285}],220:[function(N,O,t){!function(I){!function(){var t,e=N("event-emitter"),a=N("async"),l=N("weight-sort"),u=N("boundingbox"),r=N("lokijs"),c=N("./httpLoad"),p=N("./removeNullEntries"),n=N("./BBoxQueryCache"),b=N("./OverpassObject"),s=N("./OverpassNode"),h=N("./OverpassWay"),f=N("./OverpassRelation"),i=N("./RequestGet"),d=N("./RequestBBox"),y=N("./RequestMulti"),o=N("./defines"),g=N("./loadOsmFile"),x=N("./copyOsm3sMeta"),w=N("./timestamp"),m=N("./Filter"),v=N("./isGeoJSON"),E=N("./boundsIsFullWorld"),_=function(){"use strict";function _(t,e){for(var n in _classCallCheck2(this,_),this.url=t,this.options={effortPerRequest:1e3,effortNode:1,effortWay:4,effortRelation:64,effortBBoxFeature:4,timeGap:10,timeGap429:500,timeGap429Exp:3,loadChunkSize:1e3},e)this.options[n]=e[n];t=new r;this.db=t.addCollection("osm",{unique:["id"]}),this.clearCache(),this.requests=[],this.requestIsActive=!1,this.errorCount=0,this.pendingNotifyMemberUpdate={},this.pendingUpdateEmit={},this.url.match(/\.(json|osm\.bz2|osm)$/)?(this.localOnly=!0,this.ready=!1,this._loadFile()):(this.remote=!0,this.ready=!0)}return _createClass2(_,[{key:"clearCache",value:function(){this.localOnly||(this.cacheElements={},this.cacheElementsMemberOf={},this.cacheTimestamp=w(),this.db.clear(),n.clear(),this.hasStretchLon180=!1)}},{key:"_loadFile",value:function(){var o,s=this;g(this.url,function(t,e){if(t)return console.log("Error loading file",t),s.emit("error",t);o=x(e);for(var n=[],r=0;r<e.elements.length;r+=s.options.loadChunkSize)n.push(e.elements.slice(r,r+s.options.loadChunkSize));var i=[];a.eachLimit(n,1,function(t,e){t.forEach(function(t){t=s.createOrUpdateOSMObject(t,{osm3sMeta:o,properties:_.TAGS|_.META|_.MEMBERS});i.push(t)}),I.setTimeout(e,0)},function(t){if(s.pendingNotifies(),i.forEach(function(t){t.properties|=_.ALL,o.bounds?o.bounds.extend(t.bounds):o.bounds=new u(t.bounds)}),t)return console.log("Error loading file",t),s.emit("error",t);s.emit("load",o),s.ready=!0,s._overpassProcess()})})}},{key:"get",value:function(t,e,n,r){t=new i(this,{ids:t,options:e,featureCallback:n,finalCallback:r});return this.requests.push(t),this._next(),t}},{key:"getCached",value:function(t,e){return void 0===(e=void 0===e?{}:e).properties&&(e.properties=o.DEFAULT),t in this.cacheElements&&((t=this.cacheElements[t]).missingObject?null:(e.properties&t.properties)===e.properties&&t)}},{key:"_overpassProcess",value:function(){var n=this;if(this.ready&&(this.requests.forEach(function(t,e){t&&t.timestampPreprocess<n.cacheTimestamp&&(t.preprocess(),t.timestampPreprocess=n.cacheTimestamp,t.finished?n.requests[e]=null:(t.mayFinish()||n.localOnly)&&t.finish())}),this.requests=p(this.requests),!this.requestIsActive)&&this.ready&&this.requests.length){this.requests=l(this.requests,"priority"),this.requestIsActive=!0;for(var t,e,r={bbox:null,todo:{},requests:[],subRequests:[],query:"",minPriority:this.requests[0].priority,minEffort:0,maxEffort:0},i=0;i<this.requests.length&&!((s=this.requests[i]).priority>r.minPriority&&(null===r.maxEffort||r.maxEffort>this.options.effortPerRequest));i++)s.willInclude(r)&&(t=(e=s.minMaxEffort()).minEffort,e=e.maxEffort,0<r.minEffort&&r.minEffort+t>this.options.effortPerRequest||(r.minEffort+=t,null===e?r.maxEffort=null:null!==r.maxEffort&&(r.maxEffort+=e),r.requests.push(s)));var o=this.options.effortPerRequest;for(i=0;i<r.requests.length;i++){var s=r.requests[i],a=r.requests.slice(i).filter(function(t){return t.priority===s.priority}),a=(r.maxEffort=Math.ceil(o/a.length),s.compileQuery(r));if(0===a.parts.length)console.log("subRequest has no parts! Why was willInclude true?",a);else if(r.subRequests.push(a),""!==r.query&&(r.query+="\nout count;\n"),o-=a.effort,r.query+=a.query,o<=0)break}if(""===r.query)return this._next();r.queryOptions="[out:json]",r.bbox&&!E(r.bbox)&&(r.queryOptions+="[bbox:"+r.bbox.toLatLonString()+"]");var u=r.queryOptions+";\n"+r.query;setTimeout(function(){c(this.url,null,u,this._handleResult.bind(this,r)),this.emit("start",{},r)}.bind(this),this.options.timeGap)}}},{key:"_handleResult",value:function(t,e,n){var r,i=this,o=(this.requestIsActive=!1,{});if(null!==(e=null===e&&n.remark?n.remark:e))this.errorCount++,o.status=e.status,o.errorCount=this.errorCount,this.errorCount<=3?429===e.status?(this.requestIsActive=!0,r=Math.pow(this.options.timeGap429Exp,this.errorCount-1)*this.options.timeGap429,o.retry=!0,o.retryTimeout=r,this.emit("reject",o,t),I.setTimeout(function(){i.requestIsActive=!1,i._overpassProcess()},r-this.options.timeGap)):(this.emit("error",e,t),this._overpassProcess()):(429===e.status&&(o.retry=!1,this.emit("reject",o,t)),this.emit("error",o,t),t.subRequests.forEach(function(t){t.request.finish(e)}));else{this.errorCount=0;var s=x(n),a=(this.emit("load",s,t),0),u=0,l=t.subRequests[0],c=l.request,p=l.parts[0];"count"in p||(p.count=0);for(var h,f,d=0;d<n.elements.length;d++){var y=n.elements[d];if(S(y))++u>=l.parts.length?(c.finishSubRequest(l),c.mayFinish()&&!c.finished&&c.finish(),a++,c=(l=t.subRequests[a]).request,"count"in(p=l.parts[u=0])||(p.count=0)):p=l.parts[u];else{p.osm3sMeta=s;var g=this.createOrUpdateOSMObject(y,p),m=(delete t.todo[g.id],this.cacheElements[g.id].memberIds());if(m)for(var v=0;v<m.length;v++)m[v]in this.cacheElementsMemberOf?this.cacheElementsMemberOf[m[v]].push(this.cacheElements[g.id]):this.cacheElementsMemberOf[m[v]]=[this.cacheElements[g.id]];p.count++,p.receiveObject&&p.receiveObject(g),c.aborted||c.finished||!p.featureCallback||p.checkFeatureCallback&&!p.checkFeatureCallback(g,p)||p.featureCallback(e,g)}}for(h in a!==t.subRequests.length-1&&u!==t.subRequests[a].parts.length-1&&console.log("too many parts!!!!"),t.todo)h in this.cacheElements?((f=this.cacheElements[h]).missingObject=!0,this.db.update(f.dbInsert())):((f=new b).id=h,f.type={n:"node",w:"way",r:"relation"}[h.substr(0,1)],f.osm_id=h.substr(1),f.properties=_.ALL,f.missingObject=!0,this.cacheElements[h]=f,this.db.insert(f.dbInsert()));this.cacheTimestamp=w(),this.pendingNotifies(),c.finishSubRequest(l),this._next()}}},{key:"BBoxQuery",value:function(t,e,n,r,i){var o,s,a=new u(e);return v(e)||(e=a),o=a.minlon>a.maxlon?((o=new u(a)).maxlon=180,(s=new u(a)).minlon=-180,new y(this,{featureCallback:r,finalCallback:i},[new d(this,{query:t,bbox:o,bounds:e,options:n,doneFeatures:{}}),new d(this,{query:t,bbox:s,bounds:e,options:n,doneFeatures:{}})])):new d(this,{query:t,bbox:a,bounds:e,options:n,doneFeatures:{},featureCallback:r,finalCallback:i}),this.requests.push(o),this._next(),o}},{key:"clearBBoxQuery",value:function(t){new m(t).cacheDescriptors().forEach(function(t){n.get({id:t}).clear()})}},{key:"_abortRequest",value:function(t){t=this.requests.indexOf(t);-1!==t&&(this.requests[t]=null)}},{key:"_finishRequest",value:function(t){t=this.requests.indexOf(t);0<=t&&(this.requests[t]=null)}},{key:"_next",value:function(){a.setImmediate(function(){this._overpassProcess()}.bind(this))}},{key:"abortAllRequests",value:function(){for(var t=0;t<this.requests.length;t++)null!==this.requests[t]&&this.requests[t].abort();this.requests=[],this.requestIsActive=!1}},{key:"removeFromCache",value:function(n){for(var r=this,i=("string"==typeof n&&(n=[n]),0);i<n.length;i++)!function(){var e,t;n[i]in r.cacheElements&&((e=r.cacheElements[n[i]]).members&&e.members.forEach(function(t){t=r.cacheElements[t.id];t.memberOf=t.memberOf.filter(function(t){return t.id!==e.id})}),t=r.cacheElements[n[i]].dbData,delete r.cacheElements[n[i]],r.db.remove(t))}()}},{key:"notifyMemberUpdates",value:function(){var t,e=this.pendingNotifyMemberUpdate;for(t in this.pendingNotifyMemberUpdate={},e){var n=this.cacheElements[t];n.notifyMemberUpdate(e[t]),this.pendingUpdateEmit[n.id]=n}}},{key:"pendingNotifies",value:function(){var e=this,t=(this.notifyMemberUpdates(),Object.values(this.pendingUpdateEmit));this.pendingUpdateEmit={},t.forEach(function(t){t.emit("update",t),e.db.update(t.dbInsert())})}},{key:"createOrUpdateOSMObject",value:function(t,e){var n=this,r=t.type.substr(0,1)+t.id,i=null,o=!0;if(r in this.cacheElements&&!this.cacheElements[r]&&console.log("why can this be null?",r),r in this.cacheElements&&this.cacheElements[r]){if(o=!1,~(i=this.cacheElements[r]).properties&0===e.properties)return i}else i=new("relation"===t.type?f:"way"===t.type?h:"node"===t.type?s:b)(r);return i.overpass=this,i.updateData(t,e),i.memberOf.forEach(function(t){t.id in n.pendingNotifyMemberUpdate?n.pendingNotifyMemberUpdate[t.id].push(i):n.pendingNotifyMemberUpdate[t.id]=[i]}),this.pendingUpdateEmit[i.id]=i,o?this.db.insert(i.dbInsert()):this.db.update(i.dbInsert()),this.cacheElements[r]=i}},{key:"regexpEscape",value:function(t){return t.replace("\\","\\\\").replace(".","\\.").replace("|","\\|").replace("[","\\[").replace("]","\\]").replace("(","\\(").replace(")","\\)").replace("{","\\{").replace("}","\\}").replace("?","\\?").replace("+","\\+").replace("*","\\*").replace("^","\\^").replace("$","\\$")}}]),_}();for(t in o)_[t]=o[t];function S(t){return"count"in t||"type"in t&&"count"===t.type}e(_.prototype),_.Filter=m,O.exports=_}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./BBoxQueryCache":213,"./Filter":219,"./OverpassNode":221,"./OverpassObject":222,"./OverpassRelation":223,"./OverpassWay":224,"./RequestBBox":226,"./RequestGet":228,"./RequestMulti":230,"./boundsIsFullWorld":234,"./copyOsm3sMeta":237,"./defines":238,"./httpLoad":261,"./isGeoJSON":262,"./loadOsmFile":263,"./removeNullEntries":278,"./timestamp":279,async:53,boundingbox:54,"event-emitter":76,lokijs:206,"weight-sort":294}],221:[function(t,e,n){var r=t("./OverpassObject"),o=t("boundingbox"),s=t("./defines"),a=t("./turf"),t=function(){"use strict";_inherits(i,r);var t=_createSuper(i);function i(){return _classCallCheck2(this,i),t.apply(this,arguments)}return _createClass2(i,[{key:"GeoJSON",value:function(){var t={type:"Feature",id:this.type+"/"+this.osm_id,properties:this.GeoJSONProperties()};return this.geometry&&(t.geometry={type:"Point",coordinates:[this.geometry.lon,this.geometry.lat]}),t}},{key:"exportOSMXML",value:function(t,e,n){var r=this;_get(_getPrototypeOf(i.prototype),"exportOSMXML",this).call(this,t,e,function(t,e){return t?n(t):e?(e.setAttribute("lat",r.geometry.lat),e.setAttribute("lon",r.geometry.lon),void n(null,e)):n(null)})}},{key:"exportOSMJSON",value:function(t,e,n){var r=this;_get(_getPrototypeOf(i.prototype),"exportOSMJSON",this).call(this,t,e,function(t,e){return t?n(t):e?(e.lat=r.geometry.lat,e.lon=r.geometry.lon,void n(null,e)):n(null)})}},{key:"updateData",value:function(t,e){_get(_getPrototypeOf(i.prototype),"updateData",this).call(this,t,e),t.lat&&(this.geometry={lat:t.lat,lon:t.lon},this.bounds=new o(t),this.center=this.bounds.getCenter(),this.properties=this.properties|s.GEOM|s.BBOX|s.CENTER),this.properties|=s.MEMBERS}},{key:"leafletFeature",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!this.geometry)return null;"shiftWorld"in t||(t.shiftWorld=[0,0]);var e={lat:this.geometry.lat,lon:this.geometry.lon+t.shiftWorld[this.geometry.lon<0?0:1]};switch("nodeFeature"in t?t.nodeFeature:null){case"Marker":return L.marker(e,t);case"Circle":return L.circle(e,t.radius,t);default:return L.circleMarker(e,t)}}},{key:"intersects",value:function(t){return this.bounds?t.intersects?t.intersects(this.bounds)?2:0:a.booleanIntersects(this.GeoJSON(),t)?2:0:1}}]),i}();e.exports=t},{"./OverpassObject":222,"./defines":238,"./turf":280,boundingbox:54}],222:[function(t,e,n){var r=t("event-emitter"),i=t("boundingbox"),o=t("./defines"),s=t("./isGeoJSON"),a=t("./turf"),u=t("./booleanWithin"),t=function(){"use strict";function t(){_classCallCheck2(this,t),this.data={},this.properties=0,this.memberOf=[]}return _createClass2(t,[{key:"memberIds",value:function(){return[]}},{key:"member_ids",value:function(){return console.log("called deprecated OverpassObject.member_ids() function - replace by memberIds()"),this.memberIds()}},{key:"notifyMemberOf",value:function(t,e,n){this.memberOf.push({id:t.id,role:e,sequence:n})}},{key:"updateData",value:function(t,e){for(var n in void 0===this.id&&(this.id=t.type.substr(0,1)+t.id,this.type=t.type,this.osm_id=t.id),this.osm3sMeta=e.osm3sMeta,t)this.data[n]=t[n];t.bounds?(this.bounds=new i(t.bounds),this.center=this.bounds.getCenter(),this.diagonalLength=this.bounds.diagonalLength()):t.center&&(this.bounds=new i(t.center),this.center=this.bounds.getCenter()),!e.bounds||!this.bounds||e.bounds.intersects(this.bounds)?this.properties=this.properties|e.properties:this.properties=this.properties|o.BBOX|o.CENTER,e.boundsNoMatch&&this.bounds&&(void 0===this.boundsPossibleMatch&&(this.boundsPossibleMatch=this.bounds.toGeoJSON()),this.boundsPossibleMatch=a.difference(this.boundsPossibleMatch,e.bounds.toGeoJSON())),this.geometry&&delete this.boundsPossibleMatch,e.properties&o.TAGS?void 0===t.tags?this.tags={}:this.tags=t.tags:t.tags&&(this.tags=t.tags,this.properties|=o.TAGS),this.errors=[],t.timestamp&&(this.meta={timestamp:t.timestamp,version:t.version,changeset:t.changeset,user:t.user,uid:t.uid},this.properties|=o.META)}},{key:"notifyMemberUpdate",value:function(t){}},{key:"title",value:function(){return this.tags&&(this.tags.name||this.tags.operator||this.tags.ref)||this.id}},{key:"GeoJSON",value:function(){return{type:"Feature",id:this.type+"/"+this.osm_id,geometry:null,properties:this.GeoJSONProperties()}}},{key:"GeoJSONProperties",value:function(){var t,e={};if(e["@id"]=this.type+"/"+this.osm_id,this.tags)for(t in this.tags)e[t]=this.tags[t];if(this.meta)for(t in this.meta)e["@"+t]=this.meta[t];for(t in this.osm3sMeta)e["@osm3s:"+t]=this.osm3sMeta[t];return e}},{key:"exportGeoJSON",value:function(e,n){var r=this;this.overpass.get(this.id,{properties:o.TAGS|o.MEMBERS|o.META|o.GEOM},function(){},function(t){if(t)return n(t);n(null,r.GeoJSON(e))})}},{key:"exportOSMXML",value:function(e,n,r){var i=this;return n._alreadyIncluded||(n._alreadyIncluded={}),this.id in n._alreadyIncluded?r(null):(n._alreadyIncluded[this.id]=!0,(this.properties&(o.TAGS|o.MEMBERS|o.META))!=(o.TAGS|o.MEMBERS|o.META)?this.overpass.get(this.id,{properties:o.TAGS|o.MEMBERS|o.META},function(){},function(t){if(t)return r(t);i._exportOSMXML(e,n,r)}):void this._exportOSMXML(e,n,r))}},{key:"_exportOSMXML",value:function(t,e,n){var r=e.ownerDocument.createElement(this.type);if(r.setAttribute("id",this.osm_id),this.meta&&(r.setAttribute("version",this.meta.version),r.setAttribute("timestamp",this.meta.timestamp),r.setAttribute("changeset",this.meta.changeset),r.setAttribute("uid",this.meta.uid),r.setAttribute("user",this.meta.user)),this.tags)for(var i in this.tags){var o=e.ownerDocument.createElement("tag");o.setAttribute("k",i),o.setAttribute("v",this.tags[i]),r.appendChild(o)}e.appendChild(r),n(null,r)}},{key:"exportOSMJSON",value:function(e,n,r){var i=this;return this.id in n?r(null):(n[this.id]={},(this.properties&(o.TAGS|o.MEMBERS|o.META))!=(o.TAGS|o.MEMBERS|o.META)?this.overpass.get(this.id,{properties:o.TAGS|o.MEMBERS|o.META},function(){},function(t){if(t)return r(t);i._exportOSMJSON(e,n,r)}):void this._exportOSMJSON(e,n,r))}},{key:"_exportOSMJSON",value:function(t,e,n){e=e[this.id];e.type=this.type,e.id=this.osm_id,this.meta&&(e.version=this.meta.version,e.timestamp=this.meta.timestamp,e.changeset=this.meta.changeset,e.uid=this.meta.uid,e.user=this.meta.user),this.tags&&Object.keys(this.tags).length&&(e.tags=this.tags),n(null,e)}},{key:"intersects",value:function(t){if(this.bounds)if(t.intersects){if(!t.intersects(this.bounds))return 0;if(this.bounds.within(t))return 2}else{var e=this.bounds.toGeoJSON();if(!a.booleanIntersects(e,t))return 0;if(u(e,t))return 2}return!this.boundsPossibleMatch||(e=a.intersect(s(t)?t:t.toGeoJSON(),this.boundsPossibleMatch))&&"Polygon"===e.geometry.type?1:0}},{key:"leafletFeature",value:function(t){return null}},{key:"dbInsert",value:function(){return this.dbData||(this.dbData={}),this.dbData.tags=this.tags,this.dbData.osmMeta=this.meta,this.dbData.id=this.id,this.dbData.osm_id=this.osm_id,this.dbData.type=this.type,this.bounds&&this.bounds.minlat&&(this.dbData.minlat=this.bounds.minlat,this.dbData.minlon=this.bounds.minlon,this.dbData.maxlat=this.bounds.maxlat,this.dbData.maxlon=this.bounds.maxlon,this.bounds.minlon>this.bounds.maxlon)&&(this.dbData.stretchLon180=!0,this.overpass.hasStretchLon180=!0),this.dbData}},{key:"dbSet",value:function(t){for(var e in this.dbData||this.dbInsert(),t)this.dbData[e]=t[e];this.overpass.db.update(this.dbData)}}]),t}();r(t.prototype),e.exports=t},{"./booleanWithin":233,"./defines":238,"./isGeoJSON":262,"./turf":280,boundingbox:54,"event-emitter":76}],223:[function(t,e,n){var l=t("async"),r=t("boundingbox"),i=t("osmtogeojson"),o=t("./OverpassObject"),a=t("./defines"),s=t("./geojsonShiftWorld"),c=t("./turf"),t=function(){"use strict";_inherits(u,o);var t=_createSuper(u);function u(){return _classCallCheck2(this,u),t.apply(this,arguments)}return _createClass2(u,[{key:"updateData",value:function(t,e){var i,o=this;_get(_getPrototypeOf(u.prototype),"updateData",this).call(this,t,e),t.bounds&&(this.bounds=new r(t.bounds),this.center=this.bounds.getCenter(),this.properties|=a.BBOX|a.CENTER),t.center&&(this.center=t.center,this.properties|=a.CENTER),t.members&&(this.members=[],this.properties|=a.MEMBERS,i=!!this.memberFeatures,this.memberFeatures=t.members.map(function(t,e){o.members.push(t),"way"===t.type&&"string"==typeof t.ref&&(n=t.ref.match(/^_fullGeom([0-9]+)$/))&&(t.ref=parseInt(n[1])),t.id=t.type.substr(0,1)+t.ref;var n=JSON.parse(JSON.stringify(t)),r=(n.id=n.ref,delete n.ref,delete n.role,a.ID_ONLY),n=(("node"===t.type&&"lat"in t||"way"===t.type&&"geometry"in t)&&(r|=a.GEOM),o.overpass.createOrUpdateOSMObject(n,{properties:r}));return i||n.notifyMemberOf(o,t.role,e),n}),this.updateGeometry())}},{key:"updateGeometry",value:function(){var n,t,s=this;this.members&&(n=!0,t=[{type:"relation",id:this.osm_id,tags:this.tags,members:this.members.map(function(t){var e={ref:t.ref,type:t.type,role:t.role};return t.id in s.overpass.cacheElements?(0==((t=s.overpass.cacheElements[t.id]).properties&a.GEOM)&&(n=!1),"node"===t.type?t.geometry&&(e.lat=t.geometry.lat,e.lon=t.geometry.lon):"way"===t.type&&(e.geometry=t.geometry)):n=!1,e})}],this.geometry=i({elements:t}),n&&(this.properties=this.properties|a.GEOM),this.members.forEach(function(t,e){var n,r,i,o;"way"===t.type&&(i=s.overpass.cacheElements[t.id]).members&&"way"===t.type&&(n=i.members[0].id,r=i.members[i.members.length-1].id,i=i.memberOf.filter(function(t){return t.sequence===e&&t.id===s.id})[0],0<e&&"way"===(o=s.overpass.cacheElements[s.members[e-1].id]).type&&o.members&&(n===o.members[0].id||n===o.members[o.members.length-1].id?t.connectedPrev="forward":r===o.members[0].id||r===o.members[o.members.length-1].id?t.connectedPrev="backward":t.connectedPrev="no"),e<s.members.length-1&&"way"===(o=s.overpass.cacheElements[s.members[e+1].id]).type&&o.members&&(n===o.members[0].id||n===o.members[o.members.length-1].id?t.connectedNext="backward":r===o.members[0].id||r===o.members[o.members.length-1].id?t.connectedNext="forward":t.connectedNext="no"),!t.connectedPrev||!t.connectedNext||t.connectedPrev===t.connectedNext?t.dir=t.connectedPrev||t.connectedNext||null:t.dir=null,i?("dir"in t&&(i.dir=t.dir),"connectedPrev"in t&&(i.connectedPrev=t.connectedPrev),"connectedNext"in t&&(i.connectedNext=t.connectedNext)):console.log("Warning: memberOf reference "+t.id+" -> "+s.id+" (#"+e+") does not exist."))}),this.properties&a.BBOX||(this.members.forEach(function(t){t=s.overpass.cacheElements[t.id];t.bounds&&(s.bounds?s.bounds.extend(t.bounds):s.bounds=new r(t.bounds)),s.bounds&&(s.center=s.bounds.getCenter())}),this.bounds&&n&&(this.properties=this.properties|a.BBOX|a.CENTER)))}},{key:"notifyMemberUpdate",value:function(t){_get(_getPrototypeOf(u.prototype),"notifyMemberUpdate",this).call(this,t),this.members&&this.updateGeometry()}},{key:"memberIds",value:function(){if(!this._memberIds){if(void 0===this.data.members)return null;this._memberIds=[];for(var t=0;t<this.data.members.length;t++){var e=this.data.members[t];this._memberIds.push(e.type.substr(0,1)+e.ref)}}return this._memberIds}},{key:"member_ids",value:function(){return console.log("called deprecated OverpassRelation.member_ids() function - replace by memberIds()"),this.memberIds()}},{key:"leafletFeature",value:function(){var t,n,r=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.data.members?("shiftWorld"in i||(i.shiftWorld=[0,0]),this.geometry?((n=L.geoJSON(s(this.geometry,i.shiftWorld),{pointToLayer:function(t,e,n){var r;switch(t.nodeFeature){case"Marker":r=L.marker(n,t);break;case"Circle":r=L.circle(n,t.radius,t);break;default:r=L.circleMarker(n,t)}return r}.bind(this,i)})).setStyle(i),this.memberFeatures.forEach(function(t,e){t.properties&a.GEOM||t.once("update",function(t){n.clearLayers(),n.addData(r.geometry),n.setStyle(i)})}),n):((t=L.featureGroup())._updateCallbacks=[],t)):null}},{key:"GeoJSON",value:function(){var t={type:"Feature",id:this.type+"/"+this.osm_id,properties:this.GeoJSONProperties()};return this.members&&(1===this.geometry.features.length?t.geometry=this.geometry.features[0].geometry:t.geometry={type:"GeometryCollection",geometries:this.memberFeatures.map(function(t){return t.GeoJSON().geometry}).filter(function(t){return t}).filter(function(t){return"GeometryCollection"!==t.type||t.geometries.length})}),t}},{key:"exportOSMXML",value:function(o,s,e){var a=this;_get(_getPrototypeOf(u.prototype),"exportOSMXML",this).call(this,o,s,function(t,i){return t?e(t):i?void(a.members?l.each(a.members,function(t,e){var n=a.overpass.cacheElements[t.id],r=s.ownerDocument.createElement("member");r.setAttribute("ref",n.osm_id),r.setAttribute("type",n.type),r.setAttribute("role",t.role),i.appendChild(r),n.exportOSMXML(o,s,e)},function(t){e(t,i)}):e(null,i)):e(null)})}},{key:"exportOSMJSON",value:function(i,o,e){var s=this;_get(_getPrototypeOf(u.prototype),"exportOSMJSON",this).call(this,i,o,function(t,r){return t?e(t):r?void(s.members?(r.members=[],l.each(s.members,function(t,e){var n=s.overpass.cacheElements[t.id];r.members.push({ref:n.osm_id,type:n.type,role:t.role}),n.exportOSMJSON(i,o,e)},function(t){e(t,r)})):e(null,r)):e(null)})}},{key:"intersects",value:function(t){var e,n=_get(_getPrototypeOf(u.prototype),"intersects",this).call(this,t);if(0===n||2===n)return n;if(this.geometry){var n=this.geometry,r=t.toGeoJSON?t.toGeoJSON():t;if(this.bounds&&this.bounds.minlon>this.bounds.maxlon&&(n=s(n,[360,0]),r=s(r,[360,0])),c.booleanIntersects(n,r))return 2;for(e=0;e<this.data.members.length;e++)if("relation"===this.data.members[e].type)return 1;return this.properties&a.GEOM?0:1}if(this.members)for(e in this.members){var i=this.members[e].id,i=this.overpass.cacheElements[i];if(i&&2===i.intersects(t))return 2}return 1}}]),u}();e.exports=t},{"./OverpassObject":222,"./defines":238,"./geojsonShiftWorld":260,"./turf":280,async:53,boundingbox:54,osmtogeojson:211}],224:[function(t,e,n){var u=t("async"),r=t("boundingbox"),i=t("./OverpassObject"),o=t("./defines"),s=t("./turf"),t=function(){"use strict";_inherits(a,i);var t=_createSuper(a);function a(){return _classCallCheck2(this,a),t.apply(this,arguments)}return _createClass2(a,[{key:"updateData",value:function(t,e){if(t.nodes&&(this.nodes=t.nodes),t.geometry&&(this.geometry=t.geometry,this.properties|=o.GEOM),_get(_getPrototypeOf(a.prototype),"updateData",this).call(this,t,e),void 0!==this.data.nodes){this.members=[],this.properties|=o.MEMBERS;for(var n=0;n<this.data.nodes.length;n++){this.members.push({id:"n"+this.data.nodes[n],ref:this.data.nodes[n],type:"node"});var r=o.ID_ONLY,i={id:this.data.nodes[n],type:"node"};t.geometry&&t.geometry[n]&&(r|=o.GEOM,i.lat=t.geometry[n].lat,i.lon=t.geometry[n].lon),this.overpass.createOrUpdateOSMObject(i,{properties:r}).notifyMemberOf(this,null,n)}}this.checkGeometry()}},{key:"notifyMemberUpdate",value:function(t){_get(_getPrototypeOf(a.prototype),"notifyMemberUpdate",this).call(this,t),this.checkGeometry()}},{key:"checkGeometry",value:function(){var e=this;if(this.members&&0==(this.properties&o.GEOM)){if(this.geometry=this.members.map(function(t){t=e.overpass.cacheElements[t.id];return t?t.geometry:null}).filter(function(t){return t}),0===this.geometry.length)return void delete this.geometry;this.geometry.length===this.members.length&&(this.properties=this.properties|o.GEOM)}this.geometry&&0==(this.properties&o.BBOX)&&(this.bounds=new r(this.geometry[0]),this.geometry.slice(1).forEach(function(t){return e.bounds.extend(t)})),this.bounds&&0==(this.properties&o.CENTER)&&(this.center=this.bounds.getCenter()),(this.properties&o.GEOM)===o.GEOM&&(this.properties=this.properties|o.BBOX|o.CENTER)}},{key:"memberIds",value:function(){if(!this._memberIds){if(!this.nodes)return null;this._memberIds=[];for(var t=0;t<this.nodes.length;t++){var e=this.nodes[t];this._memberIds.push("n"+e)}}return this._memberIds}},{key:"member_ids",value:function(){return console.log("called deprecated OverpassWay.member_ids() function - replace by memberIds()"),this.memberIds()}},{key:"GeoJSON",value:function(){var t,e,n={type:"Feature",id:this.type+"/"+this.osm_id,properties:this.GeoJSONProperties()};return this.geometry&&(e=1<(t=this.geometry.filter(function(t){return t}).map(function(t){return[t.lon,t.lat]})).length&&this.members&&this.members[0].id===this.members[this.members.length-1].id,n.geometry=e?{type:"Polygon",coordinates:[t]}:{type:"LineString",coordinates:t}),n}},{key:"exportOSMXML",value:function(i,o,e){var s=this;_get(_getPrototypeOf(a.prototype),"exportOSMXML",this).call(this,i,o,function(t,r){return t?e(t):r?void(s.members?u.each(s.members,function(t,e){var t=s.overpass.cacheElements[t.id],n=o.ownerDocument.createElement("nd");n.setAttribute("ref",t.osm_id),r.appendChild(n),t.exportOSMXML(i,o,e)},function(t){e(t,r)}):e(null,r)):e(null)})}},{key:"exportOSMJSON",value:function(r,i,e){var o=this;_get(_getPrototypeOf(a.prototype),"exportOSMJSON",this).call(this,r,i,function(t,n){return t?e(t):n?void(o.members?(n.nodes=[],u.each(o.members,function(t,e){t=o.overpass.cacheElements[t.id];n.nodes.push(t.osm_id),t.exportOSMJSON(r,i,e)},function(t){e(t,n)})):e(null,n)):e(null)})}},{key:"leafletFeature",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!this.geometry)return null;"shiftWorld"in e||(e.shiftWorld=[0,0]);var t=this.geometry.filter(function(t){return t}).map(function(t){return{lat:t.lat,lon:t.lon+e.shiftWorld[t.lon<0?0:1]}});return this.geometry[this.geometry.length-1]&&this.geometry[0]&&this.geometry[this.geometry.length-1].lat===this.geometry[0].lat&&this.geometry[this.geometry.length-1].lon===this.geometry[0].lon?L.polygon(t,e):L.polyline(t,e)}},{key:"intersects",value:function(t){var e=_get(_getPrototypeOf(a.prototype),"intersects",this).call(this,t);return 0===e||2===e?e:this.geometry?(t.toGeoJSON?s.booleanIntersects(this.GeoJSON(),t.toGeoJSON()):s.booleanIntersects(this.GeoJSON(),t))?2:0:1}}]),a}();e.exports=t},{"./OverpassObject":222,"./defines":238,"./turf":280,async:53,boundingbox:54}],225:[function(t,e,n){var r=t("event-emitter"),i=t("./SortedCallbacks"),t=function(){"use strict";function r(t,e){for(var n in _classCallCheck2(this,r),this.overpass=t,e)this[n]=e[n];this.options||(this.options={}),this.priority="priority"in this.options?this.options.priority:0;t=new i(this.options,this.featureCallback,this.finalCallback);this.featureCallback=t.next.bind(t),this.finalCallback=t.final.bind(t),this.count=0,this.callCount=0,this.timestampPreprocess=0}return _createClass2(r,[{key:"abort",value:function(){this.aborted=!0,this.emit("abort"),this.overpass._abortRequest(this)}},{key:"finish",value:function(t){this.aborted||this.finalCallback(t),this.overpass._finishRequest(this),this.finished=!0,this.emit("finish",t)}},{key:"willInclude",value:function(t){return!0}},{key:"minMaxEffort",value:function(){return{minEffort:0,maxEffort:0}}},{key:"compileQuery",value:function(t){t=this._compileQuery(t);return this.emit("subrequest-compile",t),this.callCount++,t}},{key:"receiveObject",value:function(t){this.count++}},{key:"finishSubRequest",value:function(t){this.emit("subrequest-finish",t)}}]),r}();r(t.prototype),e.exports=t},{"./SortedCallbacks":231,"event-emitter":76}],226:[function(t,e,n){var o=t("./Request"),a=t("./overpassOutOptions"),s=t("./defines"),u=t("./BBoxQueryCache"),l=t("./RequestBBoxMembers"),c=t("./Filter"),p=t("./boundsToLokiQuery"),h=t("./boundsIsFullWorld"),t=function(){"use strict";_inherits(i,o);var r=_createSuper(i);function i(t,e){var n;if(_classCallCheck2(this,i),(n=r.call(this,t,e)).type="BBoxQuery",void 0===n.options.properties&&(n.options.properties=s.DEFAULT),n.options.properties|=s.BBOX,n.options.minEffort=n.options.minEffort||256,n.query.match(/;\s*$/)||(n.query+=";"),!("noCacheQuery"in n.options&&n.options.noCacheQuery)){try{n.options.filter?(n.filterQuery=new c({and:[n.query,n.options.filter]}),n.query=n.filterQuery.toQl()):n.filterQuery=new c(n.query)}catch(t){return _possibleConstructorReturn(n,n.finish(t))}n.lokiQuery=n.filterQuery.toLokijs(),n.lokiQueryNeedMatch=!!n.lokiQuery.needMatch,delete n.lokiQuery.needMatch,h(n.bounds)||(n.lokiQuery={$and:[n.lokiQuery,p(n.bbox,n.overpass)]});t=new c({and:[n.filterQuery,new c("nwr(properties:"+n.options.properties+")")]});n.options.properties=t.properties(),n.cacheDescriptors=t.cacheDescriptors().map(function(t){return{cache:u.get(n.overpass,t.id),cacheDescriptors:t}})}return n.loadFinish=!1,"members"in n.options&&l(_assertThisInitialized(n)),n}return _createClass2(i,[{key:"preprocess",value:function(){var t=[];this.lokiQuery&&(t=this.overpass.db.find(this.lokiQuery));for(var e=0;e<t.length;e++){if(this.options.limit&&this.count>=this.options.limit)return void(this.loadFinish=!0);var n,r=t[e].id;r in this.overpass.cacheElements&&(n=this.overpass.cacheElements[r],r in this.doneFeatures||this.lokiQueryNeedMatch&&!this.filterQuery.match(n)||n.intersects(this.bounds)<2||(this.options.properties&n.properties)===this.options.properties&&(this.receiveObject(n),this.featureCallback(null,n)))}this.options.limit&&this.count>=this.options.limit&&(this.loadFinish=!0)}},{key:"willInclude",value:function(t){if(this.loadFinish)return!1;if(t.bbox&&t.bbox.toLatLonString()!==this.bbox.toLatLonString())return!1;for(var e in t.bbox=this.bbox,t.requests){e=t.requests[e];if(e instanceof i&&e.query===this.query)return!1}return!0}},{key:"minMaxEffort",value:function(){var t,e;return this.loadFinish?{minEffort:0,maxEffort:0}:(t=this.options.minEffort,e=null,this.options.limit&&(e=(this.options.limit-this.count)*this.overpass.options.effortBBoxFeature,t=Math.min(t,e)),{minEffort:t,maxEffort:e})}},{key:"_compileQuery",value:function(t){if(this.loadFinish||t.bbox&&t.bbox.toLatLonString()!==this.bbox.toLatLonString())return{query:"",request:this,parts:[],effort:0};var e,n=this.minMaxEffort(),t=Math.max(t.maxEffort,n.minEffort),r=(n.maxEffort&&(t=Math.min(t,n.maxEffort)),this.query.substr(0,this.query.length-1)+"->.result;\n"),i="",o=0;for(e in this.doneFeatures){var s=this.doneFeatures[e];o%1e3==999&&(r+="("+i+")->.done;\n",i=".done;"),i+=s.type+"("+s.osm_id+");",o++}return o&&(r=r+"("+i+")->.done;\n(.result; - .done;)->.result;\n"),"split"in this.options||(this.options.effortSplit=Math.ceil(t/this.overpass.options.effortBBoxFeature)),{query:r+=".result out "+a(this.options)+";",request:this,parts:[{properties:this.options.properties,receiveObject:this.receiveObject.bind(this),checkFeatureCallback:this.checkFeatureCallback.bind(this),featureCallback:this.featureCallback}],effort:this.options.split?this.options.split*this.overpass.options.effortBBoxFeature:t}}},{key:"receiveObject",value:function(t){_get(_getPrototypeOf(i.prototype),"receiveObject",this).call(this,t),this.doneFeatures[t.id]=t}},{key:"checkFeatureCallback",value:function(t){return!this.bounds||0!==t.intersects(this.bounds)}},{key:"finishSubRequest",value:function(t){var e=this;_get(_getPrototypeOf(i.prototype),"finishSubRequest",this).call(this,t),("effortSplit"in this.options&&this.options.effortSplit>t.parts[0].count||this.options.split>t.parts[0].count)&&(this.loadFinish=!0,this.cacheDescriptors)&&this.cacheDescriptors.forEach(function(t){t.cache.add(e.bbox,t.cacheDescriptors)}),this.options.limit&&this.options.limit<=this.count&&(this.loadFinish=!0)}},{key:"needLoad",value:function(){var e=this;return!(this.loadFinish||this.cacheDescriptors&&this.cacheDescriptors.every(function(t){return t.cache.check(e.bbox,t.cacheDescriptors)}))}},{key:"mayFinish",value:function(){return!this.needLoad()}}]),i}();e.exports=t},{"./BBoxQueryCache":213,"./Filter":219,"./Request":225,"./RequestBBoxMembers":227,"./boundsIsFullWorld":234,"./boundsToLokiQuery":235,"./defines":238,"./overpassOutOptions":264}],227:[function(t,e,n){var i=t("./defines"),a=t("./overpassOutOptions"),o=t("lodash/forEach"),u=t("lodash/map"),l=t("lodash/keys"),c=t("boundingbox"),s=t("./SortedCallbacks"),p=t("./isGeoJSON"),h=t("./Request"),r=function(){"use strict";_inherits(r,h);var n=_createSuper(r);function r(t){_classCallCheck2(this,r),(e=n.call(this,t.overpass,{})).master=t,e.options=e.master.options,e.options.properties|=i.MEMBERS,e.options.memberProperties=e.options.memberProperties||i.DEFAULT,e.options.memberProperties|=i.BBOX,e.options.memberBounds&&(p(e.options.memberBounds)?e.bounds=e.options.memberBounds:e.bounds=new c(e.options.memberBounds)),e.master._compileQuery=e._compileQuery.bind(_assertThisInitialized(e),e.master._compileQuery),e.master.needLoad=e.needLoad.bind(_assertThisInitialized(e),e.master.needLoad),e.master.mayFinish=e.mayFinish.bind(_assertThisInitialized(e),e.master.mayFinish),e.master.preprocess=e.preprocess.bind(_assertThisInitialized(e),e.master.preprocess),e.master.willInclude=e.willInclude.bind(_assertThisInitialized(e),e.master.willInclude),e.master.minMaxEffort=e.minMaxEffort.bind(_assertThisInitialized(e),e.master.minMaxEffort),e.master.finishSubRequest=e.finishSubRequest.bind(_assertThisInitialized(e),e.master.finishSubRequest),e.master.featureCallback=e.receiveMasterObject.bind(_assertThisInitialized(e),e.master.featureCallback),e.doneFeatures={},e.relations={},e.currentRelations=[],e.todo={},e.loadFinish=!0;var e,t=new s(e.options,e.options.memberCallback,e.finalCallback);return e.options.memberCallback=t.next.bind(t),e.finalCallback=t.final.bind(t),e}return _createClass2(r,[{key:"willInclude",value:function(t,e){t=t.call(this.master,e);return!this.loadFinish||t}},{key:"minMaxEffort",value:function(t){var t=t.call(this.master),e=t.minEffort,t=t.maxEffort;return this.loadFinish||(e+=64,t=null),{minEffort:e,maxEffort:t}}},{key:"preprocess",value:function(t){var n=this;t.call(this.master),this.todo={},o(this.relations,function(t){o(t.members,function(t){t.id in n.doneFeatures||(n.todo[t.id]=void 0)})}),o(this.todo,function(t,e){e in n.overpass.cacheElements&&(e=n.overpass.cacheElements[e],n.bounds&&!e.intersects(n.bounds)||(n.options.memberProperties&e.properties)===n.options.memberProperties&&(n.receiveObject(e),n.options.memberCallback(null,e)))})}},{key:"_compileQuery",value:function(t,e){t=t.call(this.master,e);if(0!==l(this.relations).length){var n,r="(\n",e=(r=r+u(this.relations,function(t){return"relation"===t.type?"relation("+t.osm_id+");\n":""}).join("")+")->.result;",this.currentRelations=l(this.relations),""),i=(r+="(\n  node(r.result)"+(e=this.bounds?"("+new c(this.bounds).toLatLonString()+")":e)+";\n  way(r.result)"+e+";\n  relation(r.result)"+e+";\n)->.resultMembers;\n",""),o=0;for(n in this.doneFeatures){var s=this.doneFeatures[n];o%1e3==999&&(r+="("+i+")->.doneMembers;\n",i=".doneMembers;"),i+=s.type+"("+s.osm_id+");",o++}o&&(r=r+"("+i+")->.doneMembers;\n(.resultMembers; - .doneMembers;)->.resultMembers;\n"),this.part={properties:this.options.memberProperties,receiveObject:this.receiveObject.bind(this),checkFeatureCallback:this.checkFeatureCallback.bind(this),featureCallback:this.options.memberCallback,count:0},r+=".resultMembers out "+a(this.part)+";",this.loadFinish=!0,t.parts.length&&(t.query+="\nout count;\n"),t.query+=r,t.parts.push(this.part)}return t}},{key:"receiveMasterObject",value:function(t,e,n,r){this.relations[n.id]=n,this.loadFinish=!1,t(e,n,r)}},{key:"receiveObject",value:function(t){_get(_getPrototypeOf(r.prototype),"receiveObject",this).call(this,t),this.doneFeatures[t.id]=t}},{key:"checkFeatureCallback",value:function(t){return!this.bounds||0!==t.intersects(this.bounds)}},{key:"finishSubRequest",value:function(t,e){t.call(this.master,e),l(this.relations).length!==this.currentRelations.length&&(this.loadFinish=!1)}},{key:"needLoad",value:function(t){return!0===t.call(this.master)||!this.loadFinish}},{key:"mayFinish",value:function(t){return!1!==t.call(this.master)&&this.loadFinish}}]),r}();e.exports=function(t){return new r(t)}},{"./Request":225,"./SortedCallbacks":231,"./defines":238,"./isGeoJSON":262,"./overpassOutOptions":264,boundingbox:54,"lodash/forEach":184,"lodash/keys":198,"lodash/map":199}],228:[function(t,e,n){var r=t("./Request"),p=t("./defines"),s=t("boundingbox"),h=t("./overpassOutOptions"),a=t("./RequestGetMembers"),u=t("./isGeoJSON"),t=function(){"use strict";_inherits(o,r);var i=_createSuper(o);function o(t,e){var n;_classCallCheck2(this,o),(n=i.call(this,t,e)).type="get","string"==typeof n.ids?n.ids=[n.ids]:n.ids=n.ids.concat(),void 0===n.options.properties&&(n.options.properties=p.DEFAULT);for(var r=0;r<n.ids.length;r++)n.ids[r]in n.overpass.cacheElements&&!1===n.overpass.cacheElements[n.ids[r]]&&delete n.overpass.cacheElements[n.ids[r]];return n.options.bounds?(u(n.options.bounds)&&(n.geojsonBounds=n.options.bounds),n.options.bounds=new s(n.options.bounds)):n.options.bbox&&(n.options.bounds=new s(n.options.bbox),delete n.options.bbox,console.error('OverpassFrontend.get(): option "bbox" is deprecated, use "bounds" instead')),delete n.options.split,n.done={},"members"in n.options&&a(_assertThisInitialized(n)),n}return _createClass2(o,[{key:"_effortForId",value:function(t){if(!t)return null;switch(t.substr(0,1)){case"n":return this.overpass.options.effortNode;case"w":return this.overpass.options.effortWay;case"r":return this.overpass.options.effortRelation}}},{key:"minMaxEffort",value:function(){var e=this,t=this.ids.filter(function(t){return t});return 0===t.length?{minEffort:0,maxEffort:0}:{minEffort:Math.min.apply(this,t.map(function(t){return e._effortForId(t)})),maxEffort:t.map(function(t){return e._effortForId(t)}).reduce(function(t,e){return t+e})}}},{key:"preprocess",value:function(){this.allFound=!0;for(var t=0;t<this.ids.length;t++){var e=this.ids[t];if(null!==e){if(e in this.overpass.cacheElements){var n=this.overpass.cacheElements[e],r=!0;if(n.missingObject){this.featureCallback(null,null,t),this.ids[t]=null;continue}if(this.options.bounds)if(0===(this.geojsonBounds?n.intersects(this.geojsonBounds):n.intersects(this.options.bounds))||!n.bounds&&n.properties|p.BBOX){this.featureCallback(null,!1,t),this.ids[t]=null;continue}if(r=!1!==n&&null!==n&&(this.options.properties&n.properties)!==this.options.properties?!1:r){this.receiveObject(n),this.featureCallback(null,n,t),this.ids[t]=null;continue}}else if(null!==e&&!e.match(/^[nwr][0-9]+$/)){this.featureCallback(null,null,t),this.ids[t]=null;continue}this.allFound=!1}}}},{key:"_compileQuery",value:function(t){var e="",n="",r="",i="",o="",s=0;this.options.bounds&&(o="("+this.options.bounds.toLatLonString()+")");for(var a=0;a<this.ids.length;a++){var u=this.ids[a],l=h(this.options);if(s>t.maxEffort)break;if(null!==u&&(!(u in t.todo)&&(!(this.options.bounds&&u in this.overpass.cacheElements&&this.overpass.cacheElements[u].properties&p.BBOX)||this.overpass.cacheElements[u].intersects(this.options.bounds)))){switch(u.substr(0,1)){case"n":n+="node("+u.substr(1)+");\n",s+=this.overpass.options.effortNode;break;case"w":r+="way("+u.substr(1)+");\n",s+=this.overpass.options.effortWay;break;case"r":i+="relation("+u.substr(1)+");\n",s+=this.overpass.options.effortRelation}t.todo[u]=!0}}""!==n&&(e+="(("+n+");)->.n;\n",o)&&(e+="(node.n; - node.n"+o+"->.n;);\nout ids bb qt;\n"),""!==r&&(e+="(("+r+");)->.w;\n",o)&&(e+="(way.w; - way.w"+o+"->.w;);\nout ids bb qt;\n"),""!==i&&(e+="(("+i+");)->.r;\n",o)&&(e+="(relation.r; - relation.r"+o+"->.r;);\nout ids bb qt;\n");var c=[];return!o||""===n&&""===r&&""===i||(e+="out count;\n",c.push({properties:p.BBOX,bounds:this.options.bounds,boundsNoMatch:!0})),""!==n&&(e+=".n out "+l+";\n"),""!==r&&(e+=".w out "+l+";\n"),""!==i&&(e+=".r out "+l+";\n"),e&&c.push({properties:this.options.properties,receiveObject:this.receiveObject.bind(this),checkFeatureCallback:this.checkFeatureCallback.bind(this),featureCallback:this._featureCallback.bind(this,this.featureCallback)}),{query:e,effort:s,request:this,parts:c}}},{key:"checkFeatureCallback",value:function(t){return!this.geojsonBounds||0!==t.intersects(this.geojsonBounds)}},{key:"_featureCallback",value:function(e,t,n){for(var r,i=[];-1!==(r=this.ids.indexOf(n.id));)this.ids[r]=null,i.push(r);this.options.bounds&&!n.intersects(this.options.bounds)?i.forEach(function(t){return e(null,!1,t)}):i.forEach(function(t){return e(null,n,t)})}},{key:"needLoad",value:function(){return this.preprocess(),this.allFound}},{key:"mayFinish",value:function(){return this.allFound}}]),o}();e.exports=t},{"./Request":225,"./RequestGetMembers":229,"./defines":238,"./isGeoJSON":262,"./overpassOutOptions":264,boundingbox:54}],229:[function(t,e,n){var i=t("./defines"),a=t("./overpassOutOptions"),o=t("lodash/forEach"),u=t("lodash/map"),l=t("lodash/keys"),c=t("boundingbox"),s=t("./isGeoJSON"),p=t("./Request"),r=function(){"use strict";_inherits(r,p);var n=_createSuper(r);function r(t){var e;return _classCallCheck2(this,r),(e=n.call(this,t.overpass,{})).master=t,e.options=e.master.options,e.options.properties|=i.MEMBERS,e.options.memberProperties=e.options.memberProperties||i.DEFAULT,e.options.memberProperties|=i.BBOX,e.options.memberBounds&&(s(e.options.memberBounds)?e.bounds=e.options.memberBounds:e.bounds=new c(e.options.memberBounds)),e.master._compileQuery=e._compileQuery.bind(_assertThisInitialized(e),e.master._compileQuery),e.master.needLoad=e.needLoad.bind(_assertThisInitialized(e),e.master.needLoad),e.master.mayFinish=e.mayFinish.bind(_assertThisInitialized(e),e.master.mayFinish),e.master.preprocess=e.preprocess.bind(_assertThisInitialized(e),e.master.preprocess),e.master.willInclude=e.willInclude.bind(_assertThisInitialized(e),e.master.willInclude),e.master.minMaxEffort=e.minMaxEffort.bind(_assertThisInitialized(e),e.master.minMaxEffort),e.master.finishSubRequest=e.finishSubRequest.bind(_assertThisInitialized(e),e.master.finishSubRequest),e.master.featureCallback=e.receiveMasterObject.bind(_assertThisInitialized(e),e.master.featureCallback),e.doneFeatures={},e.relations={},e.currentRelations=[],e.todo={},e}return _createClass2(r,[{key:"willInclude",value:function(t,e){var n=this,t=t.call(this.master,e);return!this.loadFinish&&!!t&&("extMembersList"in e?this.master.priority<=e.extMembersPriority?(l(this.relations).forEach(function(t){e.extMembersList[t]=n.relations[t]}),e.extMembersRequests.push(this),!1):void 0:(e.extMembersList=this.relations,e.extMembersRequests=[this],e.extMembersPriority=this.master.priority,!0))}},{key:"minMaxEffort",value:function(t){var t=t.call(this.master),e=t.minEffort,t=t.maxEffort;return this.loadFinish||(e+=64,t=null),{minEffort:e,maxEffort:t}}},{key:"preprocess",value:function(t){var n=this;t.call(this.master),this.todo={},o(this.relations,function(t){o(t.members,function(t){t.id in n.doneFeatures||(n.todo[t.id]=void 0)})}),o(this.todo,function(t,e){e in n.overpass.cacheElements&&(e=n.overpass.cacheElements[e],n.bounds&&!e.intersects(n.bounds)||(n.options.memberProperties&e.properties)===n.options.memberProperties&&(n.receiveObject(e),n.options.memberCallback(null,e)))})}},{key:"_compileQuery",value:function(t,e){var r,n,i,o,s,t=t.call(this.master,e);return 0!==l(this.relations).length&&(r=(r="(\n")+u(e.extMembersList,function(t){return"relation"===t.type?"relation("+t.osm_id+");\n":""}).join("")+")->.result;",this.currentRelations=l(this.relations),n="",this.bounds&&(n="("+new c(this.bounds).toLatLonString()+")"),r+="(\n  node(r.result)"+n+";\n  way(r.result)"+n+";\n  relation(r.result)"+n+";\n)->.resultMembers;\n",i="",o=0,s={},e.extMembersRequests.forEach(function(t){for(var e in t.doneFeatures){var n;e in s||(n=t.doneFeatures[e],o%1e3==999&&(r+="("+i+")->.doneMembers;\n",i=".doneMembers;"),i+=n.type+"("+n.osm_id+");",o++,s[e]=!0)}t.loadFinish=!0}),o&&(r=r+"("+i+")->.doneMembers;\n(.resultMembers; - .doneMembers;)->.resultMembers;\n"),this.part={properties:this.options.memberProperties,receiveObject:this.receiveObject.bind(this),checkFeatureCallback:this.checkFeatureCallback.bind(this),featureCallback:this.options.memberCallback,count:0},r+=".resultMembers out "+a(this.part)+";",t.parts.length&&(t.query+="\nout count;\n"),t.query+=r,t.parts.push(this.part)),t}},{key:"receiveMasterObject",value:function(t,e,n,r){this.relations[n.id]=n,this.loadFinish=!1,t(e,n,r)}},{key:"receiveObject",value:function(t){_get(_getPrototypeOf(r.prototype),"receiveObject",this).call(this,t),this.doneFeatures[t.id]=t}},{key:"checkFeatureCallback",value:function(t){return!this.bounds||0!==t.intersects(this.bounds)}},{key:"finishSubRequest",value:function(t,e){t.call(this.master,e),l(this.relations).length!==this.currentRelations.length&&(this.loadFinish=!1)}},{key:"needLoad",value:function(t){return!0===t.call(this.master)||!this.loadFinish}},{key:"mayFinish",value:function(t){return!1!==t.call(this.master)&&this.loadFinish}}]),r}();e.exports=function(t){return new r(t)}},{"./Request":225,"./defines":238,"./isGeoJSON":262,"./overpassOutOptions":264,boundingbox:54,"lodash/forEach":184,"lodash/keys":198,"lodash/map":199}],230:[function(t,e,n){var r=t("./Request"),t=function(){"use strict";_inherits(o,r);var i=_createSuper(o);function o(t,e,n){var r;return _classCallCheck2(this,o),(r=i.call(this,t,e)).type="RequestMulti",r.doneFeatures={},r.requests=n,r.requests.forEach(function(t){t.on("finish",function(){r.requests.splice(r.requests.indexOf(t),1)}),t.on("subrequest-compile",function(t){return r.emit("subrequest-compile",t)}),t.on("subrequest-finish",function(t){return r.emit("subrequest-finish",t)}),t.featureCallback=function(t,e){e.id in r.doneFeatures||(r.doneFeatures[e.id]=!0,r.featureCallback(t,e))},t.finalCallback=function(){},r.overpass.requests.push(t)}),r}return _createClass2(o,[{key:"abort",value:function(){this.requests.forEach(function(t){return t.abort()}),_get(_getPrototypeOf(o.prototype),"abort",this).call(this)}},{key:"willInclude",value:function(){return!1}},{key:"preprocess",value:function(){}},{key:"mayFinish",value:function(){return!this.requests.length}}]),o}();e.exports=t},{"./Request":225}],231:[function(t,e,n){var i=t("async"),o=t("weight-sort"),s=t("./defines"),t=function(){"use strict";function r(t,e,n){_classCallCheck2(this,r),this.list=[],this.lastIndex=-1,this.featureCallback=e,this.finalCallback=n,this.options=t,"sort"in this.options&&!1!==this.options.sort||(this.options.sort=null),"sortDir"in this.options||(this.options.sortDir="asc"),!0===this.options.sort&&(this.options.sort="index"),"BBoxDiagonalLength"===this.options.sort&&(this.options.properties|=s.BBOX)}return _createClass2(r,[{key:"next",value:function(t,e,n){void 0===n&&(n=this.list.length),this.list[n]={err:t,feature:e,index:n},(null===this.options.sort||"index"===this.options.sort&&"asc"===this.options.sortDir&&n===this.lastIndex+1)&&(i.setImmediate(function(){this.featureCallback(this.list[n].err,this.list[n].feature,n)}.bind(this)),this.lastIndex=n)}},{key:"final",value:function(e){if("BBoxDiagonalLength"===this.options.sort){for(var t=0;t<this.list.length;t++){var n=this.list[t].feature;n&&n.bounds&&(this.list[t].weight=n.bounds.diagonalLength())}this.list=o(this.list)}"desc"===this.options.sortDir&&this.list.reverse(),i.setImmediate(function(){if(null!==this.options.sort)for(var t=this.lastIndex+1;t<this.list.length;t++)this.list[t]&&this.featureCallback(this.list[t].err,this.list[t].feature,t);this.finalCallback(e)}.bind(this))}}]),r}();e.exports=t},{"./defines":238,async:53,"weight-sort":294}],232:[function(t,e,n){e.exports=function(t){return t.reduce(function(t,e,n){return n%2==0?t.push([null,e]):t[t.length-1][0]=e,t},[])}},{}],233:[function(t,e,n){var r=t("./turf");function i(t){return t.geometry&&"MultiPolygon"===t.geometry.type?t.geometry.coordinates.map(function(t){return{type:"Feature",geometry:{type:"Polygon",coordinates:t}}}):[t]}e.exports=function(t,e){var t=i(t),n=i(e),e=t.filter(function(e){return!!n.filter(function(t){return r.booleanWithin(e,t)}).length});return t.length===e.length}},{"./turf":280}],234:[function(t,e,n){e.exports=function(t){return-90===t.minlat&&90===t.maxlat&&-180===t.minlon&&180===t.maxlon}},{}],235:[function(t,e,n){e.exports=function(t,e){return t.minlon<=t.maxlon?e.hasStretchLon180?{minlat:{$lte:t.maxlat},maxlat:{$gte:t.minlat},$or:[{minlon:{$lte:t.maxlon},maxlon:{$gte:t.minlon}},{minlon:{$lte:t.maxlon},stretchLon180:{$eq:!0}},{maxlon:{$gte:t.minlon},stretchLon180:{$eq:!0}}]}:{minlat:{$lte:t.maxlat},minlon:{$lte:t.maxlon},maxlat:{$gte:t.minlat},maxlon:{$gte:t.minlon}}:(t={minlat:{$lte:t.maxlat},maxlat:{$gte:t.minlat},$or:[{minlon:{$gte:0},maxlon:{$gte:t.minlon}},{minlon:{$lte:t.maxlon},maxlon:{$lte:0}}]},e.hasStretchLon180&&t.$or.push({stretchLon180:{$eq:!0}}),t)}},{}],236:[function(t,e,n){e.exports=function(t){for(var e={version:parseFloat(t.getAttribute("version")),generator:t.getAttribute("generator"),osm3s:{},elements:[]},n=t.getElementsByTagName("note"),n=(n.length&&(e.osm3s.copyright=n[0].textContent),t.getElementsByTagName("meta")),r=(n.length&&(e.osm3s.timestamp_osm_base=n[0].getAttribute("osm_base"),n[0].hasAttribute("areas"))&&(e.osm3s.timestamp_areas_base=n[0].getAttribute("areas")),t.firstChild);r;){var i={};if("node"===r.nodeName||"way"===r.nodeName||"relation"===r.nodeName){i.type=r.nodeName,i.id=parseInt(r.getAttribute("id")),i.changeset=parseInt(r.getAttribute("changeset")),i.timestamp=r.getAttribute("timestamp"),i.user=r.getAttribute("user"),i.uid=parseInt(r.getAttribute("uid")),i.version=parseInt(r.getAttribute("version")),"node"===i.type?(i.lat=parseFloat(r.getAttribute("lat")),i.lon=parseFloat(r.getAttribute("lon"))):"way"===i.type?i.nodes=[]:"relation"===i.type&&(i.members=[]);for(var o=r.firstChild;o;){if("tag"===o.nodeName)"tags"in i||(i.tags={}),i.tags[o.getAttribute("k")]=o.getAttribute("v");else if("member"===o.nodeName){var s={type:o.getAttribute("type"),ref:parseInt(o.getAttribute("ref")),role:o.getAttribute("role")},a=(o.hasAttribute("lat")&&(s.lat=parseFloat(o.getAttribute("lat")),s.lon=parseFloat(o.getAttribute("lon"))),o.firstChild);if("way"===s.type&&a)for(s.geometry=[];a;)"nd"===a.nodeName&&s.geometry.push({lat:parseFloat(a.getAttribute("lat")),lon:parseFloat(a.getAttribute("lon"))}),a=a.nextSibling;i.members.push(s)}else"nd"===o.nodeName&&(i.nodes.push(parseInt(o.getAttribute("ref"))),o.hasAttribute("lat"))&&(i.geometry||(i.geometry=[]),i.geometry.push({lat:parseFloat(o.getAttribute("lat")),lon:parseFloat(o.getAttribute("lon"))}));o=o.nextSibling}e.elements.push(i)}r=r.nextSibling}return e}},{}],237:[function(t,e,n){e.exports=function(t){var e,n={};for(e in t)"elements"!==e&&"osm3s"!==e&&(n[e]=t[e]);if(t.osm3s)for(var r in t.osm3s)n[r]=t.osm3s[r];return n}},{}],238:[function(t,e,n){e.exports={ID_ONLY:0,TAGS:1,META:2,MEMBERS:4,BBOX:8,GEOM:16,CENTER:32,ALL:63,DEFAULT:13}},{}],239:[function(t,e,n){e.exports={"":t("./parantheses"),changeset:t("./meta"),count_distinct_members:t("./count_members"),count_members:t("./count_members"),count_by_role:t("./count_members"),count_distinct_by_role:t("./count_members"),debug:t("./debug"),id:t("./meta"),is_closed:t("./is_closed"),is_tag:t("./is_tag"),length:t("./length"),tag:t("./tag"),timestamp:t("./meta"),type:t("./meta"),count_tags:t("./count_tags"),uid:t("./meta"),user:t("./meta"),version:t("./meta")}},{"./count_members":243,"./count_tags":244,"./debug":245,"./is_closed":247,"./is_tag":248,"./length":249,"./meta":250,"./parantheses":252,"./tag":254}],240:[function(t,e,n){e.exports={"?":t("./ternary"),"||":t("./disjunction"),"&&":t("./conjunction"),"==":t("./comparison"),"!=":t("./comparison"),"<":t("./comparison"),"<=":t("./comparison"),">":t("./comparison"),">=":t("./comparison"),"+":t("./simpleMath"),"-":t("./simpleMath"),"*":t("./simpleMath"),"/":t("./simpleMath"),"!":t("./negation"),"â":t("./unaryMinus")}},{"./comparison":241,"./conjunction":242,"./disjunction":246,"./negation":251,"./simpleMath":253,"./ternary":255,"./unaryMinus":256}],241:[function(t,e,n){var r=t("../EvaluatorOperator"),i=t("../evaluatorHelper"),a={"!=":function(t,e){return t!=e},"==":function(t,e){return t==e},"<":function(t,e){return t<e},"<=":function(t,e){return t<=e},">":function(t,e){return e<t},">=":function(t,e){return e<=t}},s={"!=":5,"==":5,"<":4,"<=":4,">":4,">=":4},u={"!=":"$ne","==":"$eq","<":"$lt","<=":"$lte",">":"$gt",">=":"$gte"},l={"!=":"$ne","==":"$eq","<":"$gt","<=":"$gte",">":"$lt",">=":"$lte"},c={"==":function(t,e,n){if("=="===e)return t==n},"!=":function(t,e,n){return!1},"<":function(t,e,n){switch(e){case"<":case"<=":return n<t}},"<=":function(t,e,n){switch(e){case"<":case"<=":case"==":return n<=t}},">":function(t,e,n){switch(e){case">":case">=":return t<n}},">=":function(t,e,n){switch(e){case">":case">=":case"==":return t<=n}}},p={"==":function(t,e,n){if("=="===e)return t==n},"!=":function(t,e,n){return!1},"<":function(t,e,n){switch(e){case"<":case"<=":return t<n}},"<=":function(t,e,n){switch(e){case"<":case"<=":case"==":return t<=n}},">":function(t,e,n){switch(e){case">":case">=":return n<t}},">=":function(t,e,n){switch(e){case">":case">=":case"==":return n<=t}}};e.exports=function(){"use strict";_inherits(o,r);var t=_createSuper(o);function o(){return _classCallCheck2(this,o),t.apply(this,arguments)}return _createClass2(o,[{key:"eval",value:function(t){var e=this.left.eval(t),t=this.right.eval(t);return i.isNumber(e)&&i.isNumber(t)&&(e=parseFloat(e),t=parseFloat(t)),a[this.op](e,t)}},{key:"toString",value:function(t){return this.left.toString(t)+this.op+this.right.toString(t)}},{key:"priority",value:function(){return s[this.op]}},{key:"compileLokiJS",value:function(){var t,e=this.left.compileLokiJS(),n=this.right.compileLokiJS(),r=u[this.op],i=l[this.op],o={},s={};return e&&Object.values(e)&&'{"$exists":true}'===JSON.stringify(Object.values(e)[0])&&n&&"value"in n?(t=Object.keys(e)[0],s[r]=n.value,o[t]=s,o):e&&"value"in e&&n&&Object.values(n)&&'{"$exists":true}'===JSON.stringify(Object.values(n)[0])?(r=Object.keys(n)[0],s[i]=e.value,o[r]=s,o):"value"in e&&"value"in n?{value:a[this.op](e.value,n.value)}:{needMatch:!0}}},{key:"isSupersetOf",value:function(t){var e,n,r,i=_get(_getPrototypeOf(o.prototype),"isSupersetOf",this).call(this,t);return void 0!==i?i:(i=this.left.compileLokiJS(),e=this.right.compileLokiJS(),n=t.left?t.left.compileLokiJS():null,r=t.right?t.right.compileLokiJS():null,this.left&&this.left.fun&&t.left&&t.left.fun&&JSON.stringify(this.left)===JSON.stringify(t.left)&&"value"in e&&"value"in r?this.op in c&&c[this.op](e.value,t.op,r.value):this.right&&this.right.fun&&t.right&&t.right.fun&&JSON.stringify(this.right)===JSON.stringify(t.right)&&"value"in i&&"value"in n?this.op in p&&p[this.op](i.value,t.op,n.value):void 0)}}]),o}()},{"../EvaluatorOperator":216,"../evaluatorHelper":258}],242:[function(t,e,n){var r=t("../EvaluatorOperator"),i=t("../evaluatorHelper");e.exports=function(){"use strict";_inherits(n,r);var t=_createSuper(n);function n(){return _classCallCheck2(this,n),t.apply(this,arguments)}return _createClass2(n,[{key:"eval",value:function(t){var e=this.left.eval(t),t=this.right.eval(t);return i.isNumber(e)&&i.isNumber(t)&&(e=parseFloat(e),t=parseFloat(t)),e&&t}},{key:"priority",value:function(){return 6}},{key:"toString",value:function(t){return this.left.toString(t)+"&&"+this.right.toString(t)}},{key:"compileLokiJS",value:function(){var t=this.left.compileLokiJS(),e=this.right.compileLokiJS(),n=t.needMatch,r=e.needMatch,i=(delete t.needMatch,delete e.needMatch,Object.keys(t)),o=Object.keys(e);return!i.length&&o.length?(e.needMatch=!(!n&&!r),e):i.length&&!o.length?(t.needMatch=!(!n&&!r),t):{$and:[t,e],needMatch:!(!n&&!r)}}},{key:"isSupersetOf",value:function(t){var e=_get(_getPrototypeOf(n.prototype),"isSupersetOf",this).call(this,t);return void 0!==e?e:!(!this.left.isSupersetOf(t)||!this.right.isSupersetOf(t))||void 0}}]),n}()},{"../EvaluatorOperator":216,"../evaluatorHelper":258}],243:[function(t,e,n){var i=t("../EvaluatorFunction"),o=t("../defines");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t,e){return _classCallCheck2(this,r),(t=n.call(this,t,e)).requestProperties=o.MEMBERS,t}return _createClass2(r,[{key:"eval",value:function(t){var e,n={};switch(this.fun){case"count_members":return t.members.length;case"count_by_role":return e=this.parameters[0].eval(t),t.members.filter(function(t){return t.role===e}).length;case"count_distinct_members":return t.members.forEach(function(t){n[t.id]=!0}),Object.keys(n).length;case"count_distinct_by_role":return e=this.parameters[0].eval(t),t.members.filter(function(t){return t.role===e}).forEach(function(t){n[t.id]=!0}),Object.keys(n).length}}}]),r}()},{"../EvaluatorFunction":215,"../defines":238}],244:[function(t,e,n){var i=t("../EvaluatorFunction"),o=t("../defines");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t,e){return _classCallCheck2(this,r),(t=n.call(this,t,e)).requestProperties=o.TAGS,t}return _createClass2(r,[{key:"eval",value:function(t){return t.tags?Object.keys(t.tags).length:null}}]),r}()},{"../EvaluatorFunction":215,"../defines":238}],245:[function(t,e,n){var r=t("../EvaluatorFunction");e.exports=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck2(this,e),t.apply(this,arguments)}return _createClass2(e,[{key:"eval",value:function(t){t=this.parameters[0].eval(t);return console.log(t),t}},{key:"toString",value:function(e){var t=this.parameters.map(function(t){return t.toString(e)});return!0===e.toString?this.fun+"("+t.join(",")+")":t.join(",")}},{key:"toValue",value:function(){return this.parameters[0].toValue()}},{key:"compileLokiJS",value:function(){return this.parameters[0].compileLokiJS()}}]),e}()},{"../EvaluatorFunction":215}],246:[function(t,e,n){var r=t("../EvaluatorOperator"),i=t("../evaluatorHelper");e.exports=function(){"use strict";_inherits(n,r);var t=_createSuper(n);function n(){return _classCallCheck2(this,n),t.apply(this,arguments)}return _createClass2(n,[{key:"eval",value:function(t){var e=this.left.eval(t),t=this.right.eval(t);return i.isNumber(e)&&i.isNumber(t)&&(e=parseFloat(e),t=parseFloat(t)),e||t}},{key:"toString",value:function(t){return this.left.toString(t)+"||"+this.right.toString(t)}},{key:"priority",value:function(){return 7}},{key:"compileLokiJS",value:function(){var t,e,n,r,i=this.left.compileLokiJS(),o=this.right.compileLokiJS();return"value"in i?i.value?{value:!0}:o:(t=i.needMatch,e=o.needMatch,delete i.needMatch,delete o.needMatch,n=Object.keys(i),r=Object.keys(o),!n.length&&r.length?(o.needMatch=!(!i.needMatch&&!o.needMatch),o):n.length&&!r.length?(i.needMatch=!(!i.needMatch&&!o.needMatch),i):{$or:[i,o],needMatch:!(!t&&!e)})}},{key:"isSupersetOf",value:function(t){var e=_get(_getPrototypeOf(n.prototype),"isSupersetOf",this).call(this,t);return void 0!==e?e:!(!this.left.isSupersetOf(t)&&!this.right.isSupersetOf(t))||void 0}},{key:"cacheDescriptors",value:function(t){var e=JSON.parse(JSON.stringify(t));this.left.cacheDescriptors(t),this.right.cacheDescriptors(e),t.push.apply(t,_toConsumableArray3(e))}}]),n}()},{"../EvaluatorOperator":216,"../evaluatorHelper":258}],247:[function(t,e,n){var i=t("../EvaluatorFunction"),o=t("../defines");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t,e){return _classCallCheck2(this,r),(t=n.call(this,t,e)).requestProperties=o.MEMBERS,t}return _createClass2(r,[{key:"eval",value:function(t){return"way"!==t.type?0:t.members?t.members[0].id===t.members[t.members.length-1].id?1:0:t.geometry?t.geometry[0].lat===t.geometry[t.geometry.length-1].lat&&t.geometry[0].lon===t.geometry[t.geometry.length-1].lon?1:0:void 0}}]),r}()},{"../EvaluatorFunction":215,"../defines":238}],248:[function(t,e,n){var i=t("../EvaluatorFunction"),o=t("../defines");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t,e){return _classCallCheck2(this,r),(t=n.call(this,t,e)).requestProperties=o.TAGS,t}return _createClass2(r,[{key:"eval",value:function(e){var t=this.parameters.map(function(t){return t.eval(e)});return e.tags&&t[0]in e.tags?1:0}},{key:"compileLokiJS",value:function(){var t,e=this.parameters.map(function(t){return t.compileLokiJS()});if(e[0]&&"value"in e[0])return(t={})["tags."+e[0].value]={$exists:!0},t}}]),r}()},{"../EvaluatorFunction":215,"../defines":238}],249:[function(t,e,n){var i=t("../turf"),o=t("../EvaluatorFunction"),s=t("../defines");e.exports=function(){"use strict";_inherits(r,o);var n=_createSuper(r);function r(t,e){return _classCallCheck2(this,r),(t=n.call(this,t,e)).requestProperties=s.GEOM,t}return _createClass2(r,[{key:"eval",value:function(t){var e;return"geomLength"in t.dbData?t.dbData.geomLength:(e=t.GeoJSON())&&e.geometry?(e=1e3*i.length(e,{units:"kilometers"}),t.dbSet({geomLength:e}),e):null}},{key:"compileLokiJS",value:function(t){return{needMatch:!0}}}]),r}()},{"../EvaluatorFunction":215,"../defines":238,"../turf":280}],250:[function(t,e,n){var i=t("../EvaluatorFunction"),o=t("../defines");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t,e){return _classCallCheck2(this,r),t=n.call(this,t,e),["id","type"].includes(t.fun)?t.requestProperties=o.ID_ONLY:t.requestProperties=o.META,t}return _createClass2(r,[{key:"eval",value:function(t){switch(this.fun){case"id":return t.osm_id;case"type":return t.type;case"version":return t.meta&&t.meta.version;case"timestamp":return t.meta&&t.meta.timestamp;case"changeset":return t.meta&&t.meta.changeset;case"uid":return t.meta&&t.meta.uid;case"user":return t.meta&&t.meta.user}}},{key:"compileLokiJS",value:function(){switch(this.fun){case"id":return{osm_id:{$exists:!0}};case"type":return{type:{$exists:!0}};case"version":return{"osmMeta.version":{$exists:!0}};case"timestamp":return{"osmMeta.timestamp":{$exists:!0}};case"changeset":return{"osmMeta.changeset":{$exists:!0}};case"uid":return{"osmMeta.uid":{$exists:!0}};case"user":return{"osmMeta.user":{$exists:!0}}}}}]),r}()},{"../EvaluatorFunction":215,"../defines":238}],251:[function(t,e,n){var r=t("../EvaluatorOperator"),i=t("../evaluatorHelper");e.exports=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck2(this,e),t.apply(this,arguments)}return _createClass2(e,[{key:"eval",value:function(t){t=this.right.eval(t);return(t=i.isNumber(t)?parseFloat(t):t)?0:1}},{key:"priority",value:function(){return 1}},{key:"toString",value:function(t){return"!"+this.right.toString(t)}},{key:"toValue",value:function(){return null===this.right.toValue()?null:this.eval({})}},{key:"compileLokiJS",value:function(){var t=this.right.compileLokiJS();if("value"in t)return{value:!t.value};if(null!==t&&"object"===_typeof3(t)){var e=Object.keys(t);if(1===e.length&&"needMatch"in t)return{needMatch:!0};if(1===e.length&&"$exists"in t[e])return t[e].$exists=!t[e].$exists,t}return{needMatch:!0}}}]),e}()},{"../EvaluatorOperator":216,"../evaluatorHelper":258}],252:[function(t,e,n){var r=t("../EvaluatorFunction");e.exports=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck2(this,e),t.apply(this,arguments)}return _createClass2(e,[{key:"eval",value:function(t){return this.parameters[0].eval(t)}},{key:"toValue",value:function(){return this.parameters[0].toValue()}},{key:"compileLokiJS",value:function(){return this.parameters[0].compileLokiJS()}}]),e}()},{"../EvaluatorFunction":215}],253:[function(t,e,n){var r=t("../EvaluatorOperator"),i=t("../evaluatorHelper"),o={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return t/e}},s={"+":3,"-":3,"*":2,"/":2};e.exports=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck2(this,e),t.apply(this,arguments)}return _createClass2(e,[{key:"eval",value:function(t){var e=this.left.eval(t),t=this.right.eval(t),t=i.isNumber(e)&&i.isNumber(t)?(e=parseFloat(e),parseFloat(t)):(e=e.toString(),t.toString());return o[this.op](e,t)}},{key:"toString",value:function(t){return this.left.toString(t)+this.op+this.right.toString(t)}},{key:"priority",value:function(){return s[this.op]}},{key:"compileLokiJS",value:function(){var t=this.left.compileLokiJS(),e=this.right.compileLokiJS();return"value"in t&&"value"in e?{value:o[this.op](t.value,e.value)}:{needMatch:!0}}}]),e}()},{"../EvaluatorOperator":216,"../evaluatorHelper":258}],254:[function(t,e,n){var i=t("../EvaluatorFunction"),o=t("../defines");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t,e){return _classCallCheck2(this,r),(t=n.call(this,t,e)).requestProperties=o.TAGS,t}return _createClass2(r,[{key:"eval",value:function(e){var t=this.parameters.map(function(t){return t.eval(e)});return e.tags&&e.tags[t[0]]}},{key:"toString",value:function(t){return"t["+this.parameters[0].toString(t)+"]"}},{key:"compileLokiJS",value:function(){var t,e=this.parameters.map(function(t){return t.compileLokiJS()});if(e[0]&&"value"in e[0])return(t={})["tags."+e[0].value]={$exists:!0},t}}]),r}()},{"../EvaluatorFunction":215,"../defines":238}],255:[function(t,e,n){var r=t("../evaluatorExport"),i=t("../EvaluatorOperator"),a=t("../EvaluatorValue");e.exports=function(){"use strict";_inherits(s,i);var o=_createSuper(s);function s(t,e,n,r){var i;return _classCallCheck2(this,s),(i=o.call(this)).op=t,i.condition=e,i.left=n,i.right=r,i}return _createClass2(s,[{key:"eval",value:function(t){return(this.condition.eval(t)?this.left:this.right).eval(t)}},{key:"toValue",value:function(){var t=this.condition.toValue();return null===t?null:(t?this.left:this.right).toValue()}},{key:"toJSON",value:function(){var t=_get(_getPrototypeOf(s.prototype),"toJSON",this).call(this);return t.condition=r(this.condition),t}},{key:"toString",value:function(t){return this.condition.toString(t)+"?"+this.left.toString(t)+":"+this.right.toString(t)}},{key:"priority",value:function(){return 8}},{key:"isSupersetOf",value:function(t){var e=_get(_getPrototypeOf(s.prototype),"isSupersetOf",this).call(this,t);return void 0!==e?e:!(!this.left.isSupersetOf(t)||!this.right.isSupersetOf(t))||void 0}},{key:"cacheDescriptors",value:function(t){var e=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(t));this.condition.cacheDescriptors(t),this.left.cacheDescriptors(e),this.right.cacheDescriptors(n),t.push.apply(t,_toConsumableArray3(e)),t.push.apply(t,_toConsumableArray3(n))}},{key:"simplify",value:function(){var t,e,n=this.toValue();return null!==n?new a(n,this.master):(n=this.condition.simplify(),t=this.left.simplify(),e=this.right.simplify(),new s(this.op,n,t,e))}}]),s}()},{"../EvaluatorOperator":216,"../EvaluatorValue":218,"../evaluatorExport":257}],256:[function(t,e,n){var r=t("../EvaluatorOperator"),i=t("../evaluatorHelper");e.exports=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck2(this,e),t.apply(this,arguments)}return _createClass2(e,[{key:"eval",value:function(t){t=this.right.eval(t);return-(t=i.isNumber(t)?parseFloat(t):t)}},{key:"toString",value:function(t){return"-"+this.right.toString(t)}},{key:"toValue",value:function(){return null===this.right.toValue()?null:this.eval({})}},{key:"priority",value:function(){return 0}},{key:"compileLokiJS",value:function(){var t=this.right.compileLokiJS();return"value"in t?{value:-t.value}:{needMatch:!0}}}]),e}()},{"../EvaluatorOperator":216,"../evaluatorHelper":258}],257:[function(t,e,n){e.exports=function(t){return null===t||["number","string","boolean"].includes(_typeof3(t))?t:t.toJSON()}},{}],258:[function(t,e,n){e.exports={isNumber:function(t){return"number"==typeof t||"boolean"!=typeof t&&null!=t&&!!t.match(/^[0-9]+(\.[0-9]+)?$/)},isValue:function(t){return null===t||["number","string","boolean"].includes(_typeof3(t))}}},{}],259:[function(t,e,n){e.exports=function r(t){var i=[""];return(t=Array.isArray(t)?t:[t]).forEach(function(e){var t,n;i=e.or?(t=e.or.map(r),n=[],i.forEach(function(e){n=n.concat(t.map(function(t){return e+t}))}),n):i.map(function(t){return t+e})}),i}},{}],260:[function(t,e,n){e.exports=function e(t,n){switch(t.type){case"FeatureCollection":return{type:"FeatureCollection",features:t.features.map(function(t){return e(t,n)})};case"Feature":return{type:"Feature",geometry:e(t.geometry,n),properties:t.properties};case"GeometryCollection":return{type:"GeometryCollection",geometries:t.geometries.map(function(t){return e(t,n)}),properties:t.properties};case"Point":return{type:"Point",coordinates:[t.coordinates[0]+n[t.coordinates[0]<0?0:1],t.coordinates[1]]};case"Polygon":case"MultiLineString":return{type:t.type,coordinates:t.coordinates.map(function(t){return t.map(function(t){return[t[0]+n[t[0]<0?0:1],t[1]]})})};case"MultiPolygon":return{type:"MultiPolygon",coordinates:t.coordinates.map(function(t){return t.map(function(t){return t.map(function(t){return[t[0]+n[t[0]<0?0:1],t[1]]})})})};case"LineString":case"MultiPoint":return{type:t.type,coordinates:t.coordinates.map(function(t){return[t[0]+n[t[0]<0?0:1],t[1]]})};default:console.log(t)}}},{}],261:[function(t,e,n){!function(o){!function(){"undefined"==typeof XMLHttpRequest&&(o.XMLHttpRequest=("undefined"!=typeof window?window.XMLHttpRequest:void 0!==o?o.XMLHttpRequest:null).XMLHttpRequest),e.exports=function(t,e,n,s){var a=new o.XMLHttpRequest,r=(a.onreadystatechange=function(){var e=null;if(4===a.readyState)if(200===a.status){try{e=JSON.parse(a.responseText)}catch(t){}s(null,e)}else try{new Error(JSON.parse(a.responseText))}catch(t){if(-1!==a.responseText.search("OSM3S Response")){for(var n=a.responseText.split(/\n/),r="",i=0;i<n.length;i++){var o=n[i].match(/<p><strong style="color:#FF0000">Error<\/strong>: (.*)<\/p>/);o&&(r+=o[1]+"\n")}""===r&&(r="Got error "+a.status);e=new Error(r);e.status=a.status,s(e,null)}else{e=new Error(a.responseText);e.status=a.status,s(e,null)}}},"GET"),i=null;n&&(r="POST",i=n),"//"===t.substr(0,2)&&(t="undefined"==typeof location?"https:"+t:location.protocol+t),a.open(r,t,!0);try{a.send(i)}catch(t){s(t,null)}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],262:[function(t,e,n){e.exports=function(t){return t&&("Feature"===t.type||"FeatureCollection"===t.type)}},{}],263:[function(n,r,t){!function(e){!function(){var t=n("fs"),s=n("@xmldom/xmldom").DOMParser,a=n("bzip2"),u=n("./convertFromXML");r.exports=function(i,o){var r;"undefined"!=typeof location||i.match(/^(http:|https:|)\/\//)?((r=new e.XMLHttpRequest).onreadystatechange=function(){if(4===r.readyState)if(200===r.status){if(i.match(/\.osm\.bz2$/)){for(var t=new Uint8Array(r.response),e=a.simple(a.array(t)),t="",n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);t=decodeURIComponent(escape(t)),e=(new s).parseFromString(t.toString(),"text/xml"),e=u(e.getElementsByTagName("osm")[0])}else e=r.responseXML?u(r.responseXML.firstChild):JSON.parse(r.responseText);o(null,e)}else o(r)},(i="//"===i.substr(0,2)?"undefined"==typeof location?"https:"+i:e.location.protocol+i:i).match(/\.osm\.bz2$/)&&(r.responseType="arraybuffer"),r.overrideMimeType("text/xml"),r.open("GET",i),r.send()):t.readFile(i,function(t,e){var n;if(t)return o(t);if(i.match(/\.osm(\.bz2)?$/)){if(i.match(/\.osm\.bz2$/)){n=a.simple(a.array(e)),e="";for(var r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);e=decodeURIComponent(escape(e))}n=(new s).parseFromString(e.toString(),"text/xml"),n=u(n.getElementsByTagName("osm")[0])}else n=JSON.parse(e);o(null,n)})}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./convertFromXML":236,"@xmldom/xmldom":51,bzip2:58,fs:57}],264:[function(t,e,n){var r=t("./defines");e.exports=function(t,e){var n="";return"split"in t&&0<t.split?n+=t.split+" ":"effortSplit"in t&&(n+=t.effortSplit+" "),t.properties&r.META?n+="meta ":t.properties&r.TAGS?t.properties&r.MEMBERS?n+="body ":n+="tags ":t.properties&r.MEMBERS?n+="skel ":n+="ids ",t.properties&r.GEOM?n+="geom ":t.properties&r.BBOX?n+="bb ":t.properties&r.CENTER&&(n+="center "),n+="qt"}},{"./defines":238}],265:[function(t,e,n){var u=t("./parseString");e.exports=function t(e){var n="",r=e[0];if(e=e.slice(1),!"([{".includes(r))throw new Error("parseParentheses(): "+r+" is not a valid opening character");var i=")]}"["([{".indexOf(r)],o=new RegExp("^([^([{'\"\\"+i+"]*)([([{'\"\\"+i+"])");do{var s=e.match(o);if(!s)throw new Error("Can't parse string from query: "+e);if(s[2]===i)return[n+=s[1],e=e.slice(s[0].length)];if("([{".includes(s[2])){n+=s[1];var a=t(e=e.slice(s[1].length));n+=s[2]+a[0]+")]}"["([{".indexOf(s[2])],e=a[1]}else{if(!"'\"".includes(s[2]))throw new Error("haeh?");n+=s[1],e=e.slice(s[1].length);a=u(e);n+=s[2]+a[0]+s[2],e=a[1]}}while(e.length);throw new Error("Can't parse string, no string end detected!")}},{"./parseString":266}],266:[function(t,e,n){e.exports=function(t){var e="",n=t[0];for(t=t.slice(1);t.length;){var r=t.match("^[^\\\\"+n+"]+");if(r)e+=r[0],t=t.slice(r[0].length);else{if("\\"!==t[0]){if(t[0]===n)return[e,t=t.slice(1)];throw new Error("Can't parse string from query: "+t)}e+=t[1],t=t.slice(2)}}throw new Error("Can't parse string, no string end detected!")}},{}],267:[function(t,e,n){e.exports={around:t("./around"),bbox:t("./bbox"),id:t("./id"),if:t("./if"),newer:t("./newer"),uid:t("./uid"),user:t("./user"),poly:t("./poly"),properties:t("./properties")}},{"./around":268,"./bbox":269,"./id":270,"./if":271,"./newer":272,"./poly":273,"./properties":274,"./uid":276,"./user":277}],268:[function(t,e,n){var i=t("../turf"),o=t("../arrayToCoords"),s=t("../defines"),a=t("./qlFunction");e.exports=function(){"use strict";_inherits(r,a);var n=_createSuper(r);function r(t){_classCallCheck2(this,r),e=n.call(this);var e,t=t.split(/,/g);if(t.length<3)throw new Error('around function expects "distance,latitude,longitude[,latitude,longitude[,...]]"');if(3===t.length)e.value={distance:parseFloat(t[0]),geometry:{type:"Point",coordinates:[parseFloat(t[2]),parseFloat(t[1])]}};else{if(t.length%2!=1)throw new Error('around function expects "distance,latitude,longitude[,latitude,longitude[,...]]"');e.value={distance:parseFloat(t[0]),geometry:{type:"LineString",coordinates:o(t.slice(1).map(function(t){return parseFloat(t)}))}}}return e}return _createClass2(r,[{key:"test",value:function(t){return t.intersects(this.bounds())}},{key:"toString",value:function(){return"(around:"+this.value.distance+","+this.value.geometry.coordinates[1]+","+this.value.geometry.coordinates[0]+")"}},{key:"compileLokiJS",value:function(){return{needMatch:!0}}},{key:"cacheDescriptors",value:function(t){var n=this.bounds();t.forEach(function(t){var e=t.bounds?i.intersect(t.bounds,n):n;null===e?t.invalid=!0:(t.bounds=e.geometry,t.properties|=s.GEOM)})}},{key:"isSupersetOf",value:function(t){return t instanceof r&&"Point"===this.value.geometry.type&&"Point"===t.value.geometry.type?1e3*i.distance(this.value.geometry,t.value.geometry,"kilometers")<this.value.distance-t.value.distance:t.bounds?!!i.difference(this.bounds(),t.bounds()):void 0}},{key:"bounds",value:function(){return this._bounds||(this._bounds=i.buffer(this.value.geometry,this.value.distance/1e3,{units:"kilometers"})),this._bounds}}]),r}()},{"../arrayToCoords":232,"../defines":238,"../turf":280,"./qlFunction":275}],269:[function(t,e,n){var i=t("boundingbox"),o=t("../turf"),s=t("../defines"),a=t("./qlFunction");e.exports=function(){"use strict";_inherits(r,a);var n=_createSuper(r);function r(t){_classCallCheck2(this,r),e=n.call(this);var e,t=t.split(/,/g);if(4!==t.length)throw new Error('bbox function expects "latitude,longitude,latitude,longitude"');return t=t.map(function(t){return parseFloat(t)}),e.value=new i({minlat:t[0],minlon:t[1],maxlat:t[2],maxlon:t[3]}),e}return _createClass2(r,[{key:"test",value:function(t){return t.intersects(this.value)}},{key:"toString",value:function(){return"("+this.value.toLatLonString()+")"}},{key:"compileLokiJS",value:function(){return{needMatch:!0}}},{key:"cacheDescriptors",value:function(t){var n=this.value.toGeoJSON();t.forEach(function(t){var e=t.bounds?o.intersect(t.bounds,n):n;null===e?t.invalid=!0:(t.bounds=e.geometry,t.properties|=s.GEOM)})}},{key:"isSupersetOf",value:function(t){return t instanceof r?t.value.within(this.value):t.bounds?!!o.difference(this.bounds(),t.bounds()):void 0}},{key:"bounds",value:function(){return this.value.toGeoJSON()}}]),r}()},{"../defines":238,"../turf":280,"./qlFunction":275,boundingbox:54}],270:[function(t,e,n){var i=t("../defines"),o=t("./qlFunction");e.exports=function(){"use strict";_inherits(r,o);var n=_createSuper(r);function r(t){var e;return _classCallCheck2(this,r),e=n.call(this),Array.isArray(t)?e.value=t:e.value=t.split(/,/g).map(function(t){return parseInt(t)}),e}return _createClass2(r,[{key:"test",value:function(t){return this.value.includes(t.osm_id)}},{key:"toString",value:function(){return"(id:"+this.value.join(",")+")"}},{key:"compileLokiJS",value:function(){return 1===this.value.length?{osm_id:{$eq:this.value[0]}}:{osm_id:{$in:this.value}}}},{key:"cacheDescriptors",value:function(t){var n=this;t.forEach(function(t){var e=n.value;t.ids&&(e=t.ids.filter(function(t){return n.value.includes(t)})),t.ids=e.sort(),t.properties|=i.ID_ONLY})}},{key:"isSupersetOf",value:function(t){var e=this;if(t instanceof r)return!t.value.filter(function(t){return!e.value.includes(t)}).length}}]),r}()},{"../defines":238,"./qlFunction":275}],271:[function(t,e,n){var i=t("./qlFunction"),o=t("../Evaluator");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t){var e;return _classCallCheck2(this,r),(e=n.call(this)).fun="if",e.value=new o,e.value.parse(t),e}return _createClass2(r,[{key:"test",value:function(t){return this.value.exec(t)}},{key:"toString",value:function(){return"(if:"+this.value.toString(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})+")"}},{key:"compileLokiJS",value:function(){var t=this.value.compileLokiJS();return"value"in t?{needMatch:!t.value}:"property"in t?{needMatch:!0}:t}},{key:"cacheDescriptors",value:function(t){this.value.cacheDescriptors(t)}},{key:"isSupersetOf",value:function(t){return"if"===t.fun&&this.value.isSupersetOf(t.value)}}]),r}()},{"../Evaluator":214,"./qlFunction":275}],272:[function(t,e,n){var i=t("../defines"),o=t("./qlFunction"),s=t("../parseString");e.exports=function(){"use strict";_inherits(r,o);var n=_createSuper(r);function r(t){_classCallCheck2(this,r),(e=n.call(this)).requestProperties=i.META;var e,t=s(t);if(console.log(t),t||t[1].match(/^\s*$/))return e.value=t[0],e;throw new Error("newer expects a string with a timestamp")}return _createClass2(r,[{key:"test",value:function(t){if(t.meta)return t.meta.timestamp>=this.value}},{key:"toString",value:function(){return'(newer:"'+this.value+'")'}},{key:"compileLokiJS",value:function(){return{"osmMeta.timestamp":{$gte:this.value}}}},{key:"isSupersetOf",value:function(t){if(t instanceof r)return t.value>=this.value}}]),r}()},{"../defines":238,"../parseString":266,"./qlFunction":275}],273:[function(t,e,n){var i=t("../turf"),o=t("../defines"),s=t("../arrayToCoords"),a=t("./qlFunction");e.exports=function(){"use strict";_inherits(r,a);var n=_createSuper(r);function r(t){_classCallCheck2(this,r),e=n.call(this);var e,t=t.match(/^\s*["']([0-9. ]*)["']\s*$/);if(!t)throw new Error("poly function expects quoted coordinates separated by space");t=t[1].split(/ /g);if(t.length<6||t.length%2!=0)throw new Error("poly function expects minimum three pairs of coordinates");return e.value=t.map(function(t){return parseFloat(t)}),e}return _createClass2(r,[{key:"test",value:function(t){return t.intersects(this.bounds())}},{key:"toString",value:function(){return'(poly:"'+this.value.join(" ")+'")'}},{key:"compileLokiJS",value:function(){return{needMatch:!0}}},{key:"cacheDescriptors",value:function(t){var n=this.bounds();t.forEach(function(t){var e=t.bounds?i.intersect(t.bounds,n):n;null===e?(delete t.bounds,t.invalid=!0):(t.bounds=e.geometry,t.properties|=o.GEOM)})}},{key:"isSupersetOf",value:function(t){if(t.bounds)return!!i.difference(this.bounds(),t.bounds())}},{key:"bounds",value:function(){var t;return this._bounds||(t=s(this.value),this._bounds={type:"Feature",geometry:{type:"Polygon",coordinates:[t.concat([t[0]])]}}),this._bounds}}]),r}()},{"../arrayToCoords":232,"../defines":238,"../turf":280,"./qlFunction":275}],274:[function(t,e,n){var i=t("./qlFunction");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t){var e;return _classCallCheck2(this,r),(e=n.call(this)).value=parseInt(t),e}return _createClass2(r,[{key:"test",value:function(t){return!!(t.properties&this.value)}},{key:"toString",value:function(t){return!0===t.toString?"(properties:"+this.value+")":""}},{key:"compileLokiJS",value:function(){return{needMatch:!0}}},{key:"cacheDescriptors",value:function(t){var e=this;t.forEach(function(t){t.properties|=e.value})}},{key:"isSupersetOf",value:function(t){if(t instanceof r)return(t.value&this.value)===t.value}}]),r}()},{"./qlFunction":275}],275:[function(t,e,n){e.exports=function(){"use strict";function t(){_classCallCheck2(this,t),this.fun=this.constructor.name}return _createClass2(t,[{key:"cacheDescriptors",value:function(t){var e=this;t.forEach(function(t){t.filters+=e.toString(),t.properties|=e.requestProperties||0})}}]),t}()},{}],276:[function(t,e,n){var i=t("../defines"),o=t("./qlFunction");e.exports=function(){"use strict";_inherits(r,o);var n=_createSuper(r);function r(t){var e;return _classCallCheck2(this,r),(e=n.call(this)).requestProperties=i.META,e.value=t.split(/,/g).map(function(t){if(t.match(/^\s*\d+\s*/))return parseInt(t);throw new Error('Error parsing uid filter, expect a numeric value: "'+t+'"')}),e}return _createClass2(r,[{key:"test",value:function(t){if(t.meta)return this.value.includes(t.meta.uid)}},{key:"toString",value:function(){return"(uid:"+this.value.join(",")+")"}},{key:"compileLokiJS",value:function(){return 1===this.value.length?{"osmMeta.uid":{$eq:this.value[0]}}:{"osmMeta.uid":{$in:this.value}}}},{key:"isSupersetOf",value:function(t){var e=this;if(t instanceof r)return!t.value.filter(function(t){return!e.value.includes(t)}).length}}]),r}()},{"../defines":238,"./qlFunction":275}],277:[function(t,e,n){var u=t("../defines"),r=t("./qlFunction"),l=t("../parseString");e.exports=function(){"use strict";_inherits(a,r);var s=_createSuper(a);function a(t){_classCallCheck2(this,a),(e=s.call(this)).requestProperties=u.META,e.value=[];for(var e,n=!0;n;){var r,i,n=!1,o=t.match(/^(\s*)(([\w\d]+)\s*(,)?|"|')/);o&&(['"',"'"].includes(o[2])?(r=void 0,t=t.substr(o[1].length),r=(i=_slicedToArray(l(t),2))[0],t=i[1],e.value.push(r),(i=t.match(/^\s*,/))&&(t=t.substr(i[0].length),n=!0)):(e.value.push(o[3]),t=t.substr(o[1].length+o[2].length),n=!!o[4]))}if(t.match(/^\s*$/))return e;throw new Error("Can't parse user query: "+t)}return _createClass2(a,[{key:"test",value:function(t){if(t.meta)return this.value.includes(t.meta.user)}},{key:"toString",value:function(){return"(user:"+this.value.map(function(t){return'"'+t+'"'}).join(",")+")"}},{key:"compileLokiJS",value:function(){return 1===this.value.length?{"osmMeta.user":{$eq:this.value[0]}}:{"osmMeta.user":{$in:this.value}}}},{key:"isSupersetOf",value:function(t){var e=this;if(t instanceof a)return!t.value.filter(function(t){return!e.value.includes(t)}).length}}]),a}()},{"../defines":238,"../parseString":266,"./qlFunction":275}],278:[function(t,e,n){e.exports=function(t){for(var e;-1!==(e=t.indexOf(null));)t.splice(e,1);return t}},{}],279:[function(t,e,n){e.exports=function(){return(new Date).getTime()}},{}],280:[function(t,e,n){e.exports={booleanIntersects:t("@turf/boolean-intersects").default,booleanWithin:t("@turf/boolean-within").default,buffer:t("@turf/buffer").default,distance:t("@turf/distance").default,difference:t("@turf/difference").default,intersect:t("@turf/intersect").default,length:t("@turf/length").default,union:t("@turf/union").default}},{"@turf/boolean-intersects":10,"@turf/boolean-within":15,"@turf/buffer":18,"@turf/difference":25,"@turf/distance":26,"@turf/intersect":31,"@turf/length":33,"@turf/union":46}],281:[function(t,e,n){!function(s){!function(){"use strict";function h(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function o(t,e){for(var n,r="",i=0,o=-1,s=0,a=0;a<=t.length;++a){if(a<t.length)n=t.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(o!==a-1&&1!==s)if(o!==a-1&&2===s){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(2<r.length){var u=r.lastIndexOf("/");if(u!==r.length-1){i=-1===u?(r="",0):(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),o=a,s=0;continue}}else if(2===r.length||1===r.length){r="",o=a,s=i=0;continue}e&&(0<r.length?r+="/..":r="..",i=2)}else 0<r.length?r+="/"+t.slice(o+1,a):r=t.slice(o+1,a),i=a-o-1;o=a,s=0}else 46===n&&-1!==s?++s:s=-1}return r}var f={resolve:function(){for(var t,e="",n=!1,r=arguments.length-1;-1<=r&&!n;r--){var i=0<=r?arguments[r]:t=void 0===t?s.cwd():t;h(i),0!==i.length&&(e=i+"/"+e,n=47===i.charCodeAt(0))}return e=o(e,!n),n?0<e.length?"/"+e:"/":0<e.length?e:"."},normalize:function(t){var e,n;return h(t),0===t.length?".":(e=47===t.charCodeAt(0),n=47===t.charCodeAt(t.length-1),0<(t=0!==(t=o(t,!e)).length||e?t:".").length&&n&&(t+="/"),e?"/"+t:t)},isAbsolute:function(t){return h(t),0<t.length&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var t,e=0;e<arguments.length;++e){var n=arguments[e];h(n),0<n.length&&(void 0===t?t=n:t+="/"+n)}return void 0===t?".":f.normalize(t)},relative:function(t,e){if(h(t),h(e),t===e)return"";if((t=f.resolve(t))===(e=f.resolve(e)))return"";for(var n=1;n<t.length&&47===t.charCodeAt(n);++n);for(var r=t.length,i=r-n,o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var s=e.length-o,a=i<s?i:s,u=-1,l=0;l<=a;++l){if(l===a){if(a<s){if(47===e.charCodeAt(o+l))return e.slice(o+l+1);if(0===l)return e.slice(o+l)}else a<i&&(47===t.charCodeAt(n+l)?u=l:0===l&&(u=0));break}var c=t.charCodeAt(n+l);if(c!==e.charCodeAt(o+l))break;47===c&&(u=l)}for(var p="",l=n+u+1;l<=r;++l)l!==r&&47!==t.charCodeAt(l)||(0===p.length?p+="..":p+="/..");return 0<p.length?p+e.slice(o+u):(47===e.charCodeAt(o+=u)&&++o,e.slice(o))},_makeLong:function(t){return t},dirname:function(t){if(h(t),0===t.length)return".";for(var e=47===t.charCodeAt(0),n=-1,r=!0,i=t.length-1;1<=i;--i)if(47===t.charCodeAt(i)){if(!r){n=i;break}}else r=!1;return-1===n?e?"/":".":e&&1===n?"//":t.slice(0,n)},basename:function(t,e){if(void 0!==e&&"string"!=typeof e)throw new TypeError('"ext" argument must be a string');h(t);var n=0,r=-1,i=!0;if(void 0!==e&&0<e.length&&e.length<=t.length){if(e.length===t.length&&e===t)return"";for(var o=e.length-1,s=-1,a=t.length-1;0<=a;--a){var u=t.charCodeAt(a);if(47===u){if(!i){n=a+1;break}}else-1===s&&(i=!1,s=a+1),0<=o&&(u===e.charCodeAt(o)?-1==--o&&(r=a):(o=-1,r=s))}return n===r?r=s:-1===r&&(r=t.length),t.slice(n,r)}for(a=t.length-1;0<=a;--a)if(47===t.charCodeAt(a)){if(!i){n=a+1;break}}else-1===r&&(i=!1,r=a+1);return-1===r?"":t.slice(n,r)},extname:function(t){h(t);for(var e=-1,n=0,r=-1,i=!0,o=0,s=t.length-1;0<=s;--s){var a=t.charCodeAt(s);if(47===a){if(i)continue;n=s+1;break}-1===r&&(i=!1,r=s+1),46===a?-1===e?e=s:1!==o&&(o=1):-1!==e&&(o=-1)}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===n+1?"":t.slice(e,r)},format:function(t){if(null===t||"object"!==_typeof3(t))throw new TypeError('The "pathObject" argument must be of type Object. Received type '+_typeof3(t));return e="/",n=(t=t).dir||t.root,r=t.base||(t.name||"")+(t.ext||""),n?n===t.root?n+r:n+e+r:r;var e,n,r},parse:function(t){h(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(0!==t.length){for(var n,r=47===t.charCodeAt(0),i=r?(e.root="/",1):0,o=-1,s=0,a=-1,u=!0,l=t.length-1,c=0;i<=l;--l){if(47===(n=t.charCodeAt(l))){if(u)continue;s=l+1;break}-1===a&&(u=!1,a=l+1),46===n?-1===o?o=l:1!==c&&(c=1):-1!==o&&(c=-1)}-1===o||-1===a||0===c||1===c&&o===a-1&&o===s+1?-1!==a&&(e.base=e.name=0===s&&r?t.slice(1,a):t.slice(s,a)):(0===s&&r?(e.name=t.slice(1,o),e.base=t.slice(1,a)):(e.name=t.slice(s,o),e.base=t.slice(s,a)),e.ext=t.slice(o,a)),0<s?e.dir=t.slice(0,s-1):r&&(e.dir="/")}return e},sep:"/",delimiter:":",win32:null,posix:null};f.posix=f,e.exports=f}.call(this)}.call(this,t("_process"))},{_process:283}],282:[function(t,n,r){!function(N){!function(){var t,e;t=this,e=function(){"use strict";function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}var u=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function e(t,e){return e<t?1:t<e?-1:0}function s(t,e,n){for(var r=new u(null,null),i=r,o=r;;){var s=n(t,e.key);if(s<0){if(null===e.left)break;if(n(t,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,null===(e=a).left)break}o.left=e,e=(o=e).left}else{if(!(0<s))break;if(null===e.right)break;if(0<n(t,e.right.key)){a=e.right;if(e.right=a.left,a.left=e,null===(e=a).right)break}i.right=e,e=(i=e).right}}return i.right=e.left,o.left=e.right,e.left=r.right,e.right=r.left,e}function a(t,e,n,r){e=new u(t,e);return null===n?e.left=e.right=null:(t=r(t,(n=s(t,n,r)).key))<0?(e.left=n.left,(e.right=n).left=null):0<=t&&(e.right=n.right,(e.left=n).right=null),e}function c(t,e,n){var r=null,i=null;return e&&(0===(n=n((e=s(t,e,n)).key,t))?(r=e.left,i=e.right):n<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)),{left:r,right:i}}t.prototype.insert=function(t,e){return this._size++,this._root=a(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var e=new u(t,e),n=(null===this._root&&(e.left=e.right=null,this._size++,this._root=e),this._comparator),r=s(t,this._root,n),n=n(t,r.key);return 0===n?this._root=r:(n<0?(e.left=r.left,(e.right=r).left=null):0<n&&(e.right=r.right,(e.left=r).right=null),this._size++,this._root=e),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=s(t,e,n)).key)?(null===e.left?r=e.right:(r=s(t,e.left,n)).right=e.right,this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=s(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=s(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this},t.prototype.range=function(t,e,n,r){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(0<o((s=i.pop()).key,e))break;if(0<=o(s.key,t)&&n.call(r,s))return this;s=s.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(t){t=t.key;return e.push(t)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(t){t=t.data;return e.push(t)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(t=void 0===t?this._root:t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(t=void 0===t?this._root:t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(0<i.length){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right)for(n=t.right;n.left;)n=n.left;else for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;e=i<0?(n=e).left:e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left)for(n=t.left;n.right;)n=n.right;else for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;e=i<0?e.left:(n=e).right}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){for(var t=this._root,e=t,n=[],r=!1,i=t=new u(null,null);!r;)e?(n.push(e),e=e.left):0<n.length?e=(e=i=i.next=n.pop()).right:r=!0;return i.next=null,t.next},t.prototype.load=function(t,e,n){void 0===e&&(e=[]);var r=t.length,i=this._comparator;return(n=void 0===n?!1:n)&&function t(e,n,r,i,o){if(i<=r)return;var s=e[r+i>>1];var a=r-1;var u=i+1;for(;;){for(;o(e[++a],s)<0;);for(;0<o(e[--u],s););if(u<=a)break;var l=e[a];e[a]=e[u],e[u]=l,l=n[a],n[a]=n[u],n[u]=l}t(e,n,r,u,o);t(e,n,u+1,i,o)}(t,e,0,r-1,i),null===this._root?(this._root=function t(e,n,r,i){var o=i-r;{var s,a;if(0<o)return o=r+Math.floor(o/2),a=e[o],s=n[o],(a=new u(a,s)).left=t(e,n,r,o),a.right=t(e,n,o+1,i),a}return null}(t,e,0,r),this._size=r):(n=function(t,e,n){var r=new u(null,null),i=r,o=t,s=e;for(;null!==o&&null!==s;)n(o.key,s.key)<0?o=(i.next=o).next:s=(i.next=s).next,i=i.next;null!==o?i.next=o:null!==s&&(i.next=s);return r.next}(this.toList(),function(t,e){for(var n=new u(null,null),r=n,i=0;i<t.length;i++)r=r.next=new u(t[i],e[i]);return r.next=null,n.next}(t,e),i),r=this._size+r,this._root=function t(e,n,r){var i=r-n;{var o;if(0<i)return i=n+Math.floor(i/2),n=t(e,n,i),(o=e.head).left=n,e.head=e.head.next,o.right=t(e,i+1,r),o}return null}({head:n},0,r)),this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){var e=[];return function t(e,n,r,i,o){e&&(i(n+(r?"âââ ":"âââ ")+o(e)+"\n"),n+=r?"    ":"â   ",e.left&&t(e.left,n,!1,i,o),e.right)&&t(e.right,n,!0,i,o)}(this._root,"",!0,function(t){return e.push(t)},t=void 0===t?function(t){return String(t.key)}:t),e.join("")},t.prototype.update=function(t,e,n){var r=this._comparator,i=c(t,this._root,r),o=i.left,i=i.right;r(t,e)<0?i=a(e,n,i,r):o=a(e,n,o,r),this._root=(t=o,e=r,null===(n=i)?t:(null!==t&&((n=s(t.key,n,e)).left=t),n))},t.prototype.split=function(t){return c(t,this._root,this._comparator)};var C=t;function t(t){void 0===t&&(t=e),this._root=null,this._size=0,this._comparator=t}function p(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y}function k(t,e){var n,r;return e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y?null:(n=(t.ll.x<e.ll.x?e:t).ll.x,r=(t.ur.x<e.ur.x?t:e).ur.x,{ll:{x:n,y:(t.ll.y<e.ll.y?e:t).ll.y},ur:{x:r,y:(t.ur.y<e.ur.y?t:e).ur.y}})}function o(t,e){var n;return-y<t&&t<y&&-y<e&&e<y||(n=t-e)*n<g*t*e?0:t<e?-1:1}function h(t,e,n){return e={x:e.x-t.x,y:e.y-t.y},n={x:n.x-t.x,y:n.y-t.y},t=v(e,n),o(t,0)}function f(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}}function d(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}}var y=Number.EPSILON,g=(y=void 0===y?Math.pow(2,-52):y)*y,n=function(){function t(){l(this,t),this.reset()}return i(t,[{key:"reset",value:function(){this.xRounder=new m,this.yRounder=new m}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),m=function(){function t(){l(this,t),this.tree=new C,this.round(0)}return i(t,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);return null!==n&&0===o(e.key,n.key)||null!==(n=this.tree.next(e))&&0===o(e.key,n.key)?(this.tree.remove(t),n.key):t}}]),t}(),A=new n,v=function(t,e){return t.x*e.y-t.y*e.x},_=function(t,e){return t.x*e.x+t.y*e.y},b=function(t){return Math.sqrt(_(t,t))},M=function(){function r(t,e){l(this,r),void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}return i(r,null,[{key:"compare",value:function(t,e){var n=r.comparePoints(t.point,e.point);return 0!==n?n:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:w.compare(t.segment,e.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),i(r,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,r=e.length;n<r;n++){var i=e[n];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var r=e+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&n.otherSE.point.events===i.otherSE.point.events&&n.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(n){function i(t){var e=t.otherSE;o.set(t,{sine:function(t,e,n){e={x:e.x-t.x,y:e.y-t.y},n={x:n.x-t.x,y:n.y-t.y};return v(n,e)/b(n)/b(e)}(r.point,n.point,e.point),cosine:function(t,e,n){e={x:e.x-t.x,y:e.y-t.y},n={x:n.x-t.x,y:n.y-t.y};return _(n,e)/b(n)/b(e)}(r.point,n.point,e.point)})}var r=this,o=new Map;return function(t,e){o.has(t)||i(t),o.has(e)||i(e);var t=o.get(t),n=t.sine,t=t.cosine,e=o.get(e),r=e.sine,e=e.cosine;return 0<=n&&0<=r?t<e?1:e<t?-1:0:n<0&&r<0?t<e?-1:e<t?1:0:r<n?-1:n<r?1:0}}}]),r}(),x=0,w=function(){function u(t,e,n,r){l(this,u),this.id=++x,(this.leftSE=t).segment=this,t.otherSE=e,(this.rightSE=e).segment=this,e.otherSE=t,this.rings=n,this.windings=r}return i(u,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(i<r)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,u=t.rightSE.point.y,l=e.rightSE.point.y;if(n<r)return a<s&&a<u?1:s<a&&u<a?-1:(c=t.comparePoint(e.leftSE.point))<0?1:!(0<c)&&0!==(c=e.comparePoint(t.rightSE.point))?c:-1;if(r<n)return s<a&&s<l?-1:a<s&&l<s?1:0!==(c=e.comparePoint(t.leftSE.point))?c:!((c=t.comparePoint(e.rightSE.point))<0)&&0<c?-1:1;if(s<a)return-1;if(a<s)return 1;if(i<o){var c=e.comparePoint(t.rightSE.point);if(0!==c)return c}if(o<i){c=t.comparePoint(e.rightSE.point);if(c<0)return 1;if(0<c)return-1}if(i!==o){c=u-s,s=i-n,n=l-a,a=o-r;if(s<c&&n<a)return 1;if(c<s&&a<n)return-1}return o<i?1:i<o||u<l?-1:l<u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),i(u,[{key:"replaceRightSE",value:function(t){this.rightSE=t,(this.rightSE.segment=this).rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:e<t?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){var e,n,r;return this.isAnEndpoint(t)?0:(r=this.leftSE.point,n=this.rightSE.point,e=this.vector(),r.x===n.x?t.x===r.x?0:t.x<r.x?1:-1:(n=(t.y-r.y)/e.y,n=r.x+n*e.x,t.x===n||(n=(t.x-r.x)/e.x,r=r.y+n*e.y,t.y===r)?0:t.y<r?-1:1))}},{key:"getIntersection",value:function(t){var e,n,r,i,o,s,a=this.bbox(),u=t.bbox(),l=k(a,u);return null===l?null:(o=this.leftSE.point,i=this.rightSE.point,e=t.leftSE.point,s=t.rightSE.point,r=p(a,e)&&0===this.comparePoint(e),n=p(u,o)&&0===t.comparePoint(o),a=p(a,s)&&0===this.comparePoint(s),u=p(u,i)&&0===t.comparePoint(i),n&&r?u&&!a?i:!u&&a?s:null:n?a&&o.x===s.x&&o.y===s.y?null:o:r?u&&i.x===e.x&&i.y===e.y?null:e:u&&a?null:u?i:a?s:(n=o,r=this.vector(),u=e,i=t.vector(),null!==(e=0===r.x?d(u,i,n.x):0===i.x?d(n,r,u.x):0===r.y?f(u,i,n.y):0===i.y?f(n,r,u.y):0==(a=v(r,i))?null:(s={x:u.x-n.x,y:u.y-n.y},o=v(s,r)/a,s=v(s,i)/a,{x:(n.x+s*r.x+(u.x+o*i.x))/2,y:(n.y+s*r.y+(u.y+o*i.y))/2}))&&p(l,e)?A.round(e.x,e.y):null))}},{key:"split",value:function(t){var e=[],n=void 0!==t.events,r=new M(t,!0),t=new M(t,!1),i=this.rightSE,i=(this.replaceRightSE(t),e.push(t),e.push(r),new u(r,i,this.rings.slice(),this.windings.slice()));return 0<M.comparePoints(i.leftSE.point,i.rightSE.point)&&i.swapEvents(),0<M.comparePoints(this.leftSE.point,this.rightSE.point)&&this.swapEvents(),n&&(r.checkForConsuming(),t.checkForConsuming()),e}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var e=this,n=t;e.consumedBy;)e=e.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var t=u.compare(e,n);if(0!==t){0<t&&(t=e,e=n,n=t),e.prev===n&&(t=e,e=n,n=t);for(var r=0,i=n.rings.length;r<i;r++){var o=n.rings[r],s=n.windings[r],a=e.rings.indexOf(o);-1===a?(e.rings.push(o),e.windings.push(s)):e.windings[a]+=s}n.rings=null,n.windings=null,n.consumedBy=e,n.leftSE.consumedBy=e.leftSE,n.rightSE.consumedBy=e.rightSE}}},{key:"prevInResult",value:function(){return void 0===this._prevInResult&&(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){var t;return void 0===this._beforeState&&(this.prev?(t=this.prev.consumedBy||this.prev,this._beforeState=t.afterState()):this._beforeState={rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0===this._afterState){for(var t=this.beforeState(),e=(this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]},this._afterState.rings),n=this._afterState.windings,r=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var s=this.rings[i],a=this.windings[i],u=e.indexOf(s);-1===u?(e.push(s),n.push(a)):n[u]+=a}for(var l,c,p=[],h=[],f=0,d=e.length;f<d;f++)0!==n[f]&&(c=(l=e[f]).poly,-1===h.indexOf(c))&&(l.isExterior?p.push(c):(-1===h.indexOf(c)&&h.push(c),-1!==(c=p.indexOf(l.poly))&&p.splice(c,1)));for(var y=0,g=p.length;y<g;y++){var m=p[y].multiPoly;-1===r.indexOf(m)&&r.push(m)}}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0===this._isInResult){var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(F.type){case"union":var n=0===t.length,r=0===e.length;this._isInResult=n!=r;break;case"intersection":n=(t.length<e.length?(i=t.length,e):(i=e.length,t)).length;this._isInResult=n===F.numMultiPolys&&i<n;break;case"xor":r=Math.abs(t.length-e.length);this._isInResult=r%2==1;break;case"difference":var i=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=i(t)!==i(e);break;default:throw new Error("Unrecognized operation type found ".concat(F.type))}}return this._isInResult}}],[{key:"fromRing",value:function(t,e,n){var r,i,o,s=M.comparePoints(t,e);if(s<0)r=t,i=e,o=1;else{if(!(0<s))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));r=e,i=t,o=-1}return new u(new M(r,!0),new M(i,!1),[n],[o])}}]),u}(),E=function(){function a(t,e,n){if(l(this,a),!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=n,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");for(var e=A.round(t[0][0],t[0][1]),r=(this.bbox={ll:{x:e.x,y:e.y},ur:{x:e.x,y:e.y}},e),i=1,o=t.length;i<o;i++){if("number"!=typeof t[i][0]||"number"!=typeof t[i][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var s=A.round(t[i][0],t[i][1]);s.x===r.x&&s.y===r.y||(this.segments.push(w.fromRing(r,s,this)),s.x<this.bbox.ll.x&&(this.bbox.ll.x=s.x),s.y<this.bbox.ll.y&&(this.bbox.ll.y=s.y),s.x>this.bbox.ur.x&&(this.bbox.ur.x=s.x),s.y>this.bbox.ur.y&&(this.bbox.ur.y=s.y),r=s)}e.x===r.x&&e.y===r.y||this.segments.push(w.fromRing(r,e,this))}return i(a,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),a}(),S=function(){function o(t,e){if(l(this,o),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new E(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,r=t.length;n<r;n++){var i=new E(t[n],this,!1);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=e}return i(o,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),o}(),L=function(){function o(t,e){if(l(this,o),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,r=t.length;n<r;n++){var i=new S(t[n],this);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=e}return i(o,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),o}(),P=function(){function m(t){l(this,m);for(var e=0,n=(this.events=t).length;e<n;e++)t[e].segment.ringOut=this;this.poly=null}return i(m,null,[{key:"factory",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(i.isInResult()&&!i.ringOut){for(var o,s=i.leftSE,a=i.rightSE,u=[s],l=s.point,c=[];;){if(o=s,s=a,u.push(s),s.point===l)break;for(;;){var p=s.getAvailableLinkedEvents();if(0===p.length)throw y=u[0].point,g=u[u.length-1].point,new Error("Unable to complete output ring starting at [".concat(y.x,",")+" ".concat(y.y,"]. Last matching segment found ends at")+" [".concat(g.x,", ").concat(g.y,"]."));if(1===p.length){a=p[0].otherSE;break}for(var h=null,f=0,d=c.length;f<d;f++)if(c[f].point===s.point){h=f;break}if(null===h){c.push({index:u.length,point:s.point});var y=s.getLeftmostComparator(o),a=p.sort(y)[0].otherSE;break}var g=c.splice(h)[0],p=u.splice(g.index);p.unshift(p[0].otherSE),e.push(new m(p.reverse()))}}e.push(new m(u))}}return e}}]),i(m,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var i=this.events[n].point,o=this.events[n+1].point;0!==h(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;0===h(e[0],t,e[1])&&e.shift(),e.push(e[0]);for(var s=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:e.length-1,u=this.isExteriorRing()?e.length:-1,l=[],c=a;c!=u;c+=s)l.push([e[c].x,e[c].y]);return l}},{key:"isExteriorRing",value:function(){var t;return void 0===this._isExteriorRing&&(t=this.enclosingRing(),this._isExteriorRing=!t||!t.isExteriorRing()),this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];0<M.compare(t,r)&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();o=(i=o.prevInResult())?i.prevInResult():null}}}]),m}(),I=function(){function e(t){l(this,e),((this.exteriorRing=t).poly=this).interiorRings=[]}return i(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),e}(),T=function(){function e(t){l(this,e),this.rings=t,this.polys=this._composePolys(t)}return i(e,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i,o=t[n];o.poly||(o.isExteriorRing()?e.push(new I(o)):((i=o.enclosingRing()).poly||e.push(new I(i)),i.poly.addInterior(o)))}return e}}]),e}(),R=function(){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:w.compare;l(this,n),this.queue=t,this.tree=new C(e),this.segments=[]}return i(n,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e);else{var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=r,o=r,s=void 0,a=void 0;void 0===s;)null===(i=this.tree.prev(i))?s=null:void 0===i.key.consumedBy&&(s=i.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){r=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(r=u),!s.isAnEndpoint(u)))for(var l=this._splitSafely(s,u),c=0,p=l.length;c<p;c++)n.push(l[c])}u=null;if(a){var h=a.getIntersection(e);if(null!==h&&(e.isAnEndpoint(h)||(u=h),!a.isAnEndpoint(h)))for(var f=this._splitSafely(a,h),d=0,y=f.length;d<y;d++)n.push(f[d])}if(null!==r||null!==u)for(var h=null,g=(h=null!==r&&(null===u||M.comparePoints(r,u)<=0)?r:u,this.queue.remove(e.rightSE),n.push(e.rightSE),e.split(h)),m=0,v=g.length;m<v;m++)n.push(g[m]);0<n.length?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){r=s.getIntersection(a);if(null!==r){if(!s.isAnEndpoint(r))for(var _=this._splitSafely(s,r),b=0,x=_.length;b<x;b++)n.push(_[b]);if(!a.isAnEndpoint(r))for(var w=this._splitSafely(a,r),E=0,S=w.length;E<S;E++)n.push(w[E])}}this.tree.remove(e)}}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE,e=(this.queue.remove(n),t.split(e));return e.push(n),void 0===t.consumedBy&&this.tree.insert(t),e}}]),n}(),D=void 0!==N&&N.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,j=void 0!==N&&N.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,F=new(function(){function t(){l(this,t)}return i(t,[{key:"run",value:function(t,e,n){F.type=t,A.reset();for(var r=[new L(e,!0)],i=0,o=n.length;i<o;i++)r.push(new L(n[i],!1));if(F.numMultiPolys=r.length,"difference"===F.type)for(var s=r[0],a=1;a<r.length;)null!==k(r[a].bbox,s.bbox)?a++:r.splice(a,1);if("intersection"===F.type)for(var u=0,l=r.length;u<l;u++)for(var c=r[u],p=u+1,h=r.length;p<h;p++)if(null===k(c.bbox,r[p].bbox))return[];for(var f=new C(M.compare),d=0,y=r.length;d<y;d++)for(var g=r[d].getSweepEvents(),m=0,v=g.length;m<v;m++)if(f.insert(g[m]),f.size>D)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var _=new R(f),b=f.size,x=f.pop();x;){var w,E=x.key;if(f.size===b)throw w=E.segment,new Error("Unable to pop() ".concat(E.isLeft?"left":"right"," SweepEvent ")+"[".concat(E.point.x,", ").concat(E.point.y,"] from segment #").concat(w.id," ")+"[".concat(w.leftSE.point.x,", ").concat(w.leftSE.point.y,"] -> ")+"[".concat(w.rightSE.point.x,", ").concat(w.rightSE.point.y,"] from queue. ")+"Please file a bug report.");if(f.size>D)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(_.segments.length>j)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var S=_.process(E),I=0,N=S.length;I<N;I++){var O=S[I];void 0===O.consumedBy&&f.insert(O)}b=f.size,x=f.pop()}A.reset();t=P.factory(_.segments);return new T(t).getGeom()}}]),t}());return{union:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return F.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return F.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return F.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return F.run("difference",t,n)}}},"object"===_typeof3(r)&&void 0!==n?n.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).polygonClipping=e()}.call(this)}.call(this,t("_process"))},{_process:283}],283:[function(t,e,n){var r,i,e=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return(r=setTimeout)(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var u,l=[],c=!1,p=-1;function h(){c&&u&&(c=!1,u.length?l=u.concat(l):p=-1,l.length)&&f()}function f(){if(!c){for(var t=a(h),e=(c=!0,l.length);e;){for(u=l,l=[];++p<e;)u&&u[p].run();p=-1,e=l.length}u=null,c=!1,!function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return(i=clearTimeout)(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function y(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new d(t,e)),1!==l.length||c||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=y,e.addListener=y,e.once=y,e.off=y,e.removeListener=y,e.removeAllListeners=y,e.emit=y,e.prependListener=y,e.prependOnceListener=y,e.listeners=function(t){return[]},e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],284:[function(t,e,n){var r,i;r=this,i=function(){"use strict";function f(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function u(t,e){return t<e?-1:e<t?1:0}function t(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function d(t,e){y(t,0,t.children.length,e,t)}function y(t,e,n,r,i){(i=i||v(null)).minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];h(i,t.leaf?r(s):s)}return i}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function o(t,e){return t.minX-e.minX}function s(t,e){return t.minY-e.minY}function g(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function m(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function l(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function v(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(t,e,n,r,i){for(var o,s,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(o=e+Math.ceil((n-e)/r/2)*r,function t(e,n,r,i,o){for(;r<i;){600<i-r&&(s=i-r+1,a=n-r+1,l=Math.log(s),u=.5*Math.exp(2*l/3),l=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1),t(e,n,Math.max(r,Math.floor(n-a*u/s+l)),Math.min(i,Math.floor(n+(s-a)*u/s+l)),o));var s,a,u,l,c=e[n],p=r,h=i;for(f(e,r,n),0<o(e[i],c)&&f(e,r,i);p<h;){for(f(e,p,h),p++,h--;o(e[p],c)<0;)p++;for(;0<o(e[h],c);)h--}0===o(e[r],c)?f(e,r,h):f(e,++h,i),h<=n&&(r=h+1),n<=h&&(i=h-1)}}(s=t,o,e||0,n||s.length-1,i||u),a.push(e,o,o,n))}return t.prototype.all=function(){return this._all(this.data,[])},t.prototype.search=function(t){var e=this.data,n=[];if(l(t,e))for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?r(s):s;l(t,a)&&(e.leaf?n.push(s):c(t,a)?this._all(s,n):i.push(s))}e=i.pop()}return n},t.prototype.collides=function(t){var e=this.data;if(l(t,e))for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(l(t,o)){if(e.leaf||c(t,o))return!0;n.push(i)}}e=n.pop()}return!1},t.prototype.load=function(t){if(t&&t.length)if(t.length<this._minEntries)for(var e=0;e<t.length;e++)this.insert(t[e]);else{var n,r=this._build(t.slice(),0,t.length-1,0);this.data.children.length?this.data.height===r.height?this._splitRoot(this.data,r):(this.data.height<r.height&&(n=this.data,this.data=r,r=n),this._insert(r,this.data.height-r.height-1,!0)):this.data=r}return this},t.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},t.prototype.clear=function(){return this.data=v([]),this},t.prototype.remove=function(t,e){if(t)for(var n,r,i,o=this.data,s=this.toBBox(t),a=[],u=[];o||a.length;){if(o||(o=a.pop(),r=a[a.length-1],n=u.pop(),i=!0),o.leaf){var l=function(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}(t,o.children,e);if(-1!==l)return o.children.splice(l,1),a.push(o),this._condense(a),this}i||o.leaf||!c(o,s)?r?(n++,o=r.children[n],i=!1):o=null:(a.push(o),u.push(n),o=(r=o).children[n=0])}return this},t.prototype.toBBox=function(t){return t},t.prototype.compareMinX=function(t,e){return t.minX-e.minX},t.prototype.compareMinY=function(t,e){return t.minY-e.minY},t.prototype.toJSON=function(){return this.data},t.prototype.fromJSON=function(t){return this.data=t,this},t.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},t.prototype._build=function(t,e,n,r){var i,o=n-e+1,s=this._maxEntries;if(o<=s)d(i=v(t.slice(e,n+1)),this.toBBox);else{r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),(i=v([])).leaf=!1,i.height=r;var a=Math.ceil(o/s),u=a*Math.ceil(Math.sqrt(s));_(t,e,n,u,this.compareMinX);for(var l=e;l<=n;l+=u){var c=Math.min(l+u-1,n);_(t,l,c,a,this.compareMinY);for(var p=l;p<=c;p+=a){var h=Math.min(p+a-1,c);i.children.push(this._build(t,p,h,r-1))}}d(i,this.toBBox)}return i},t.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var u=e.children[a],l=g(u),c=(p=t,c=u,(Math.max(c.maxX,p.maxX)-Math.min(c.minX,p.minX))*(Math.max(c.maxY,p.maxY)-Math.min(c.minY,p.minY))-l);c<o?(o=c,i=l<i?l:i,s=u):c===o&&l<i&&(i=l,s=u)}e=s||e.children[0]}var p,c;return e},t.prototype._insert=function(t,e,n){var n=n?t:this.toBBox(t),r=[],i=this._chooseSubtree(n,this.data,e,r);for(i.children.push(t),h(i,n);0<=e&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},t.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries,i=(this._chooseSplitAxis(n,i,r),this._chooseSplitIndex(n,i,r)),r=v(n.children.splice(i,n.children.length-i));r.height=n.height,r.leaf=n.leaf,d(n,this.toBBox),d(r,this.toBBox),e?t[e-1].children.push(r):this._splitRoot(n,r)},t.prototype._splitRoot=function(t,e){this.data=v([t,e]),this.data.height=t.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},t.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,s,a=1/0,u=1/0,l=e;l<=n-e;l++){var c=y(t,0,l,this.toBBox),p=y(t,l,n,this.toBBox),h=(s=c,h=p,0,i=Math.max(s.minX,h.minX),o=Math.max(s.minY,h.minY),f=Math.min(s.maxX,h.maxX),s=Math.min(s.maxY,h.maxY),Math.max(0,f-i)*Math.max(0,s-o)),f=g(c)+g(p);h<a?(a=h,r=l,u=f<u?f:u):h===a&&f<u&&(u=f,r=l)}return r||n-e},t.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:o,i=t.leaf?this.compareMinY:s;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},t.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=y(t,0,e,i),s=y(t,n-e,n,i),a=m(o)+m(s),u=e;u<n-e;u++){var l=t.children[u];h(o,t.leaf?i(l):l),a+=m(o)}for(var c=n-e-1;e<=c;c--){var p=t.children[c];h(s,t.leaf?i(p):p),a+=m(s)}return a},t.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;0<=r;r--)h(e[r],t)},t.prototype._condense=function(t){for(var e=t.length-1,n=void 0;0<=e;e--)0===t[e].children.length?0<e?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():d(t[e],this.toBBox)},t},"object"==_typeof3(n)&&void 0!==e?e.exports=i():"function"==typeof define&&define.amd?define(i):(r=r||self).RBush=i()},{}],285:[function(t,e,n){e.exports=function(t){return t.replace(".","\\.").replace(" ",".*").replace("a","[aÃ Ã¡Ã¢Ã£Ã¤Ã¥]").replace("A","[AÃÃÃÃÃÃ]").replace("C","[CÃ]").replace("c","[cÃ§]").replace("E","[EÃÃÃ]").replace("I","[IÃÃÃÃ]").replace("D","[DÃ]").replace("N","[NÃ]").replace("O","[OÃÃÃÃÃÃ]").replace("X","[XÃ]").replace("U","[UÃÃÃÃ]").replace("Y","[YÃ]").replace("s","[sÃ]").replace("e","[eÃ¨eÃ©ÃªÃ«Ä]").replace("i","[iÃ¬Ã­Ã®Ã¯]").replace("d","[dÃ°]").replace("n","[nÃ±]").replace("o","[oÃ²Ã³Ã´ÃµÃ¶Ã¸]").replace("u","[uÃ¹ÃºÃ»Ã¼]").replace("y","[yÃ½Ã¿]")}},{}],286:[function(u,t,l){!function(n,a){!function(){var r=u("process/browser.js").nextTick,t=Function.prototype.apply,i=Array.prototype.slice,o={},s=0;function e(t,e){this._id=t,this._clearFn=e}l.setTimeout=function(){return new e(t.call(setTimeout,window,arguments),clearTimeout)},l.setInterval=function(){return new e(t.call(setInterval,window,arguments),clearInterval)},l.clearTimeout=l.clearInterval=function(t){t.close()},e.prototype.unref=e.prototype.ref=function(){},e.prototype.close=function(){this._clearFn.call(window,this._id)},l.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},l.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},l._unrefActive=l.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},l.setImmediate="function"==typeof n?n:function(t){var e=s++,n=!(arguments.length<2)&&i.call(arguments,1);return o[e]=!0,r(function(){o[e]&&(n?t.apply(null,n):t.call(null),l.clearImmediate(e))}),e},l.clearImmediate="function"==typeof a?a:function(t){delete o[t]}}.call(this)}.call(this,u("timers").setImmediate,u("timers").clearImmediate)},{"process/browser.js":283,timers:286}],287:[function(t,e,n){var r,i;r=this,i=function(D){"use strict";function F(){}function j(t){this.message=t||""}function q(t){this.message=t||""}function B(t){this.message=t||""}function G(){}function z(t){return null===t?0:t.color}function n(t){return null===t?null:t.parent}function U(t,e){null!==t&&(t.color=e)}function V(t){return null===t?null:t.left}function $(t){return null===t?null:t.right}function X(){this.root_=null,this.size_=0}function Y(){}function J(){this.array_=[],arguments[0]instanceof Dt&&this.addAll(arguments[0])}function W(t){this.message=t||""}function H(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");for(var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,r=((r=1 in arguments&&parseInt(Number(arguments[1]),10)||0)<0?Math.max(n+r,0):Math.min(r,n)),i=((i=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n)<0?Math.max(n+arguments[2],0):Math.min(i,n));r<i;)e[r]=t,++r;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};function K(){}function l(){}K.prototype.interfaces_=function(){return[]},K.prototype.getClass=function(){return K},K.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n},(Q=Error)&&(Z.__proto__=Q);var Q,p=(Z.prototype=Object.create(Q&&Q.prototype)).constructor=Z,t={MAX_VALUE:{configurable:!0}};function Z(t){Q.call(this,t),this.name="IllegalArgumentException",this.message=t,this.stack=(new Q).stack}l.isNaN=function(t){return Number.isNaN(t)},l.doubleToLongBits=function(t){return t},l.longBitsToDouble=function(t){return t},l.isInfinite=function(t){return!Number.isFinite(t)},t.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(l,t);function tt(){}function et(){}function nt(){}function v(){var t;this.x=null,this.y=null,this.z=null,0===arguments.length?(this.x=0,this.y=0,this.z=v.NULL_ORDINATE):1===arguments.length?(this.x=(t=arguments[0]).x,this.y=t.y,this.z=t.z):2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=v.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])}function rt(){}function h(){}function g(t,e){return t.interfaces_&&-1<t.interfaces_().indexOf(e)}function it(){}function ot(t){this.str=t}function st(t){this.value=t}function at(){}function f(){this._hi=0,(this._lo=0)===arguments.length?this.init(0):1===arguments.length?"number"==typeof arguments[0]||arguments[0]instanceof f?this.init(arguments[0]):"string"==typeof arguments[0]&&f.call(this,f.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])}function ut(){}function d(){}function lt(){}function ct(){}var pt,t={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}},ht=(v.prototype.setOrdinate=function(t,e){switch(t){case v.X:this.x=e;break;case v.Y:this.y=e;break;case v.Z:this.z=e;break;default:throw new p("Invalid ordinate index: "+t)}},v.prototype.equals2D=function(){var t,e;return 1===arguments.length?this.x===(t=arguments[0]).x&&this.y===t.y:2===arguments.length?!!K.equalsWithTolerance(this.x,(t=arguments[0]).x,e=arguments[1])&&!!K.equalsWithTolerance(this.y,t.y,e):void 0},v.prototype.getOrdinate=function(t){switch(t){case v.X:return this.x;case v.Y:return this.y;case v.Z:return this.z}throw new p("Invalid ordinate index: "+t)},v.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||l.isNaN(this.z))&&l.isNaN(t.z)},v.prototype.equals=function(t){return t instanceof v&&this.equals2D(t)},v.prototype.equalInZ=function(t,e){return K.equalsWithTolerance(this.z,t.z,e)},v.prototype.compareTo=function(t){return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0},v.prototype.clone=function(){},v.prototype.copy=function(){return new v(this)},v.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},v.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,t=this.z-t.z;return Math.sqrt(e*e+n*n+t*t)},v.prototype.distance=function(t){var e=this.x-t.x,t=this.y-t.y;return Math.sqrt(e*e+t*t)},v.prototype.hashCode=function(){return 37*(629+v.hashCode(this.x))+v.hashCode(this.y)},v.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},v.prototype.interfaces_=function(){return[tt,et,F]},v.prototype.getClass=function(){return v},v.hashCode=function(){var t;if(1===arguments.length)return t=l.doubleToLongBits(arguments[0]),Math.trunc((t^t)>>>32)},t.DimensionalComparator.get=function(){return ht},t.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},t.NULL_ORDINATE.get=function(){return l.NaN},t.X.get=function(){return 0},t.Y.get=function(){return 1},t.Z.get=function(){return 2},Object.defineProperties(v,t),function(t){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){if(2!==t&&3!==t)throw new p("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}),t=(ht.prototype.compare=function(t,e){var n=ht.compare(t.x,e.x);return 0!==n||0!==(n=ht.compare(t.y,e.y))?n:this._dimensionsToTest<=2?0:ht.compare(t.z,e.z)},ht.prototype.interfaces_=function(){return[nt]},ht.prototype.getClass=function(){return ht},ht.compare=function(t,e){return t<e?-1:e<t?1:l.isNaN(t)?l.isNaN(e)?0:-1:l.isNaN(e)?1:0},rt.prototype.create=function(){},rt.prototype.interfaces_=function(){return[]},rt.prototype.getClass=function(){return rt},{INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}}),t=(h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h.toLocationSymbol=function(t){switch(t){case h.EXTERIOR:return"e";case h.BOUNDARY:return"b";case h.INTERIOR:return"i";case h.NONE:return"-"}throw new p("Unknown location value: "+t)},t.INTERIOR.get=function(){return 0},t.BOUNDARY.get=function(){return 1},t.EXTERIOR.get=function(){return 2},t.NONE.get=function(){return-1},Object.defineProperties(h,t),{LOG_10:{configurable:!0}}),t=(it.prototype.interfaces_=function(){return[]},it.prototype.getClass=function(){return it},it.log10=function(t){t=Math.log(t);return l.isInfinite(t)||l.isNaN(t)?t:t/it.LOG_10},it.min=function(t,e,n,r){return t=r<(t=n<(t=e<t?e:t)?n:t)?r:t},it.clamp=function(){var t,e,n;return"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]?(n=arguments[0],t=arguments[1],e=arguments[2],n<t?t:e<n?e:n):Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])?(t=arguments[0],e=arguments[1],n=arguments[2],t<e?e:n<t?n:t):void 0},it.wrap=function(t,e){return t<0?e- -t%e:t%e},it.max=function(){var t,e,n;return 3===arguments.length?(t=(t=n=arguments[0])<(e=arguments[1])?e:n)<(e=arguments[2])?e:t:4===arguments.length?(n=(n=(n=arguments[0])<(e=arguments[1])?e:n)<(t=arguments[2])?t:n)<(e=arguments[3])?e:n:void 0},it.average=function(t,e){return(t+e)/2},t.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(it,t),ot.prototype.append=function(t){this.str+=t},ot.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},ot.prototype.toString=function(t){return this.str},st.prototype.intValue=function(){return this.value},st.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},st.isNaN=function(t){return Number.isNaN(t)},at.isWhitespace=function(t){return t<=32&&0<=t||127===t},at.toUpperCase=function(t){return t.toUpperCase()},{PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}}),t=(f.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},f.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),r=f.magnitude(n._hi),i=f.TEN.pow(r);(n=n.divide(i)).gt(f.TEN)?(n=n.divide(f.TEN),r+=1):n.lt(f.ONE)&&(n=n.multiply(f.TEN),--r);for(var o=r+1,s=new ot,a=f.MAX_PRINT_DIGITS-1,u=0;u<=a;u++){t&&u===o&&s.append(".");var l=Math.trunc(n._hi);if(l<0)break;var c=!1,p=0,p=9<l?(c=!0,"9"):"0"+l,p=(s.append(p),n=n.subtract(f.valueOf(l)).multiply(f.TEN),c&&n.selfAdd(f.TEN),!0),l=f.magnitude(n._hi);if(!(p=l<0&&Math.abs(l)>=a-u?!1:p))break}return e[0]=r,s.toString()},f.prototype.sqr=function(){return this.multiply(this)},f.prototype.doubleValue=function(){return this._hi+this._lo},f.prototype.subtract=function(){return arguments[0]instanceof f?this.add(arguments[0].negate()):"number"==typeof arguments[0]?this.add(-arguments[0]):void 0},f.prototype.equals=function(){var t;if(1===arguments.length)return this._hi===(t=arguments[0])._hi&&this._lo===t._lo},f.prototype.isZero=function(){return 0===this._hi&&0===this._lo},f.prototype.selfSubtract=function(){var t;return arguments[0]instanceof f?(t=arguments[0],this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)):"number"==typeof arguments[0]?(t=arguments[0],this.isNaN()?this:this.selfAdd(-t,0)):void 0},f.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},f.prototype.min=function(t){return this.le(t)?this:t},f.prototype.selfDivide=function(){var t,e,n,r,i,o,s,a,u;return 1===arguments.length?arguments[0]instanceof f?this.selfDivide((a=arguments[0])._hi,a._lo):"number"==typeof arguments[0]?this.selfDivide(arguments[0],0):void 0:2===arguments.length?(u=i=s=o=r=n=e=a=null,o=this._hi/(t=arguments[0]),s=(this._hi-(i=o*t)-(u=(a=(s=f.SPLIT*o)-(a=s-o))*(n=(u=f.SPLIT*t)-(n=u-t))-i+a*(r=t-n)+(e=o-a)*n+e*r)+this._lo-o*arguments[1])/t,this._hi=u=o+s,this._lo=o-u+s,this):void 0},f.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},f.prototype.divide=function(){var t,e,n,r,i,o,s,a,u;return arguments[0]instanceof f?(s=i=a=r=n=e=o=u=null,o=(r=this._hi/(t=arguments[0])._hi)-(u=(a=f.SPLIT*r)-(a-r)),s=u*(e=(s=f.SPLIT*t._hi)-(s-t._hi))-(i=r*t._hi)+u*(n=t._hi-e)+o*e+o*n,a=(this._hi-i-s+this._lo-r*t._lo)/t._hi,new f(s=r+a,r-s+a)):"number"==typeof arguments[0]?l.isNaN(u=arguments[0])?f.createNaN():f.copy(this).selfDivide(u,0):void 0},f.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},f.prototype.pow=function(t){if(0===t)return f.valueOf(1);var e=new f(this),n=f.valueOf(1),r=Math.abs(t);if(1<r)for(;0<r;)r%2==1&&n.selfMultiply(e),0<(r/=2)&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},f.prototype.ceil=function(){var t,e;return this.isNaN()?f.NaN:(e=0,(t=Math.ceil(this._hi))===this._hi&&(e=Math.ceil(this._lo)),new f(t,e))},f.prototype.compareTo=function(t){return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0},f.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},f.prototype.setValue=function(){return arguments[0]instanceof f||"number"==typeof arguments[0]?(this.init(arguments[0]),this):void 0},f.prototype.max=function(t){return this.ge(t)?this:t},f.prototype.sqrt=function(){var t,e;return this.isZero()?f.valueOf(0):this.isNegative()?f.NaN:(e=1/Math.sqrt(this._hi),t=this._hi*e,t=f.valueOf(t),e=this.subtract(t.sqr())._hi*(.5*e),t.add(e))},f.prototype.selfAdd=function(){var t,e,n,r,i,o,s,a,u;return 1===arguments.length?arguments[0]instanceof f?this.selfAdd((n=arguments[0])._hi,n._lo):"number"==typeof arguments[0]?(s=o=i=u=n=null,s=(e=arguments[0])-(o=(i=this._hi+e)-this._hi)+(this._hi-(i-o))+this._lo,this._hi=(n=i+s)+(u=s+(i-n)),this._lo=u+(n-this._hi),this):void 0:2===arguments.length?(r=n=u=i=s=o=e=null,i=this._hi+(a=arguments[0]),o=this._lo+(t=arguments[1]),u=i-(n=i-this._hi),s=o-(r=o-this._lo),a=(e=i+(n=(u=a-n+(this._hi-u))+o))+(n=(s=t-r+(this._lo-s))+(n+(i-e))),u=n+(e-a),this._hi=a,this._lo=u,this):void 0},f.prototype.selfMultiply=function(){var t,e,n,r,i,o,s;return 1===arguments.length?arguments[0]instanceof f?this.selfMultiply((r=arguments[0])._hi,r._lo):"number"==typeof arguments[0]?this.selfMultiply(arguments[0],0):void 0:2===arguments.length?(i=n=e=o=s=r=null,r=(n=f.SPLIT*this._hi)-this._hi,s=this._hi-(r=n-r),o=(n=this._hi*(t=arguments[0]))+(i=r*(o=(i=f.SPLIT*t)-(o=i-t))-n+r*(e=t-o)+s*o+s*e+(this._hi*arguments[1]+this._lo*t)),s=i+(r=n-o),this._hi=o,this._lo=s,this):void 0},f.prototype.selfSqr=function(){return this.selfMultiply(this)},f.prototype.floor=function(){var t,e;return this.isNaN()?f.NaN:(e=0,(t=Math.floor(this._hi))===this._hi&&(e=Math.floor(this._lo)),new f(t,e))},f.prototype.negate=function(){return this.isNaN()?this:new f(-this._hi,-this._lo)},f.prototype.clone=function(){},f.prototype.multiply=function(){var t;return arguments[0]instanceof f?(t=arguments[0]).isNaN()?f.createNaN():f.copy(this).selfMultiply(t):"number"==typeof arguments[0]?l.isNaN(t=arguments[0])?f.createNaN():f.copy(this).selfMultiply(t,0):void 0},f.prototype.isNaN=function(){return l.isNaN(this._hi)},f.prototype.intValue=function(){return Math.trunc(this._hi)},f.prototype.toString=function(){var t=f.magnitude(this._hi);return-3<=t&&t<=20?this.toStandardNotation():this.toSciNotation()},f.prototype.toStandardNotation=function(){var t,e,n=this.getSpecialNumberString();return null!==n?n:(n=new Array(1).fill(null),t=this.extractSignificantDigits(!0,n),n=n[0]+1,"."===(e=t).charAt(0)?e="0"+t:n<0?e="0."+f.stringOfChar("0",-n)+t:-1===t.indexOf(".")&&(n=n-t.length,e=t+f.stringOfChar("0",n)+".0"),this.isNegative()?"-"+e:e)},f.prototype.reciprocal=function(){var t,e,n,r=null,i=(t=1/this._hi)-(r=(e=f.SPLIT*t)-(e-t)),o=(n=f.SPLIT*this._hi)-this._hi,s=t+(e=(1-(s=t*this._hi)-(r*(o=n-o)-s+r*(n=this._hi-o)+i*o+i*n)-t*this._lo)/this._hi);return new f(s,t-s+e)},f.prototype.toSciNotation=function(){if(this.isZero())return f.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var t=new Array(1).fill(null),e=this.extractSignificantDigits(!1,t),t=f.SCI_NOT_EXPONENT_CHAR+t[0];if("0"===e.charAt(0))throw new Error("Found leading zero: "+e);var n="",e=(1<e.length&&(n=e.substring(1)),e.charAt(0)+"."+n);return this.isNegative()?"-"+e+t:e+t},f.prototype.abs=function(){return this.isNaN()?f.NaN:this.isNegative()?this.negate():new f(this)},f.prototype.isPositive=function(){return(0<this._hi||0===this._hi)&&0<this._lo},f.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},f.prototype.add=function(){var t;return arguments[0]instanceof f||"number"==typeof arguments[0]?(t=arguments[0],f.copy(this).selfAdd(t)):void 0},f.prototype.init=function(){var t,e;1===arguments.length?"number"==typeof arguments[0]?(this._hi=arguments[0],this._lo=0):arguments[0]instanceof f&&(this._hi=(t=arguments[0])._hi,this._lo=t._lo):2===arguments.length&&(t=arguments[0],e=arguments[1],this._hi=t,this._lo=e)},f.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},f.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},f.prototype.trunc=function(){return this.isNaN()?f.NaN:this.isPositive()?this.floor():this.ceil()},f.prototype.signum=function(){return 0<this._hi?1:this._hi<0?-1:0<this._lo?1:this._lo<0?-1:0},f.prototype.interfaces_=function(){return[F,tt,et]},f.prototype.getClass=function(){return f},f.sqr=function(t){return f.valueOf(t).selfMultiply(t)},f.valueOf=function(){return"string"==typeof arguments[0]?f.parse(arguments[0]):"number"==typeof arguments[0]?new f(arguments[0]):void 0},f.sqrt=function(t){return f.valueOf(t).sqrt()},f.parse=function(t){for(var e=0,n=t.length;at.isWhitespace(t.charAt(e));)e++;var r=!1;e<n&&("-"!==(p=t.charAt(e))&&"+"!==p||(e++,"-"===p&&(r=!0)));for(var i=new f,o=0,s=0,a=0;!(n<=e);){var u=t.charAt(e);if(e++,at.isDigit(u)){var l=u-"0";i.selfMultiply(f.TEN),i.selfAdd(l),o++}else{if("."!==u){if("e"!==u&&"E"!==u)throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t);l=t.substring(e);try{a=st.parseInt(l)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+l+" in string "+t):e}break}s=o}}var c,p=i,h=o-s-a;return 0==h?p=i:0<h?(c=f.TEN.pow(h),p=i.divide(c)):h<0&&(c=f.TEN.pow(-h),p=i.multiply(c)),r?p.negate():p},f.createNaN=function(){return new f(l.NaN,l.NaN)},f.copy=function(t){return new f(t)},f.magnitude=function(t){var t=Math.abs(t),e=Math.log(t)/Math.log(10),e=Math.trunc(Math.floor(e));return 10*Math.pow(10,e)<=t&&(e+=1),e},f.stringOfChar=function(t,e){for(var n=new ot,r=0;r<e;r++)n.append(t);return n.toString()},t.PI.get=function(){return new f(3.141592653589793,12246467991473532e-32)},t.TWO_PI.get=function(){return new f(6.283185307179586,24492935982947064e-32)},t.PI_2.get=function(){return new f(1.5707963267948966,6123233995736766e-32)},t.E.get=function(){return new f(2.718281828459045,14456468917292502e-32)},t.NaN.get=function(){return new f(l.NaN,l.NaN)},t.EPS.get=function(){return 123259516440783e-46},t.SPLIT.get=function(){return 134217729},t.MAX_PRINT_DIGITS.get=function(){return 32},t.TEN.get=function(){return f.valueOf(10)},t.ONE.get=function(){return f.valueOf(1)},t.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},t.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(f,t),{DP_SAFE_EPSILON:{configurable:!0}}),t=(ut.prototype.interfaces_=function(){return[]},ut.prototype.getClass=function(){return ut},ut.orientationIndex=function(t,e,n){var r,i=ut.orientationIndexFilter(t,e,n);return i<=1?i:(i=f.valueOf(e.x).selfAdd(-t.x),t=f.valueOf(e.y).selfAdd(-t.y),r=f.valueOf(n.x).selfAdd(-e.x),n=f.valueOf(n.y).selfAdd(-e.y),i.selfMultiply(n).selfSubtract(t.selfMultiply(r)).signum())},ut.signOfDet2x2=function(t,e,n,r){return t.multiply(r).selfSubtract(e.multiply(n)).signum()},ut.intersection=function(t,e,n,r){var i=f.valueOf(r.y).selfSubtract(n.y).selfMultiply(f.valueOf(e.x).selfSubtract(t.x)),o=f.valueOf(r.x).selfSubtract(n.x).selfMultiply(f.valueOf(e.y).selfSubtract(t.y)),i=i.subtract(o),o=f.valueOf(r.x).selfSubtract(n.x).selfMultiply(f.valueOf(t.y).selfSubtract(n.y)),s=f.valueOf(r.y).selfSubtract(n.y).selfMultiply(f.valueOf(t.x).selfSubtract(n.x)),o=o.subtract(s).selfDivide(i).doubleValue(),s=f.valueOf(t.x).selfAdd(f.valueOf(e.x).selfSubtract(t.x).selfMultiply(o)).doubleValue(),o=f.valueOf(e.x).selfSubtract(t.x).selfMultiply(f.valueOf(t.y).selfSubtract(n.y)),e=f.valueOf(e.y).selfSubtract(t.y).selfMultiply(f.valueOf(t.x).selfSubtract(n.x)),t=o.subtract(e).selfDivide(i).doubleValue(),o=f.valueOf(n.y).selfAdd(f.valueOf(r.y).selfSubtract(n.y).selfMultiply(t)).doubleValue();return new v(s,o)},ut.orientationIndexFilter=function(t,e,n){var r=null,i=(t.x-n.x)*(e.y-n.y),t=(t.y-n.y)*(e.x-n.x),e=i-t;if(0<i){if(t<=0)return ut.signum(e);r=i+t}else{if(!(i<0))return ut.signum(e);if(0<=t)return ut.signum(e);r=-i-t}n=ut.DP_SAFE_EPSILON*r;return n<=e||n<=-e?ut.signum(e):2},ut.signum=function(t){return 0<t?1:t<0?-1:0},t.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(ut,t),{X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}}),ft=(t.X.get=function(){return 0},t.Y.get=function(){return 1},t.Z.get=function(){return 2},t.M.get=function(){return 3},d.prototype.setOrdinate=function(t,e,n){},d.prototype.size=function(){},d.prototype.getOrdinate=function(t,e){},d.prototype.getCoordinate=function(){},d.prototype.getCoordinateCopy=function(t){},d.prototype.getDimension=function(){},d.prototype.getX=function(t){},d.prototype.clone=function(){},d.prototype.expandEnvelope=function(t){},d.prototype.copy=function(){},d.prototype.getY=function(t){},d.prototype.toCoordinateArray=function(){},d.prototype.interfaces_=function(){return[et]},d.prototype.getClass=function(){return d},Object.defineProperties(d,t),(pt=lt)&&(dt.__proto__=pt),((dt.prototype=Object.create(pt&&pt.prototype)).constructor=dt).prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt},dt);function dt(){pt.call(this,"Projective point not representable on the Cartesian plane.")}ct.arraycopy=function(t,e,n,r,i){for(var o=0,s=e;s<e+i;s++)n[r+o]=t[s],o++},ct.getProperty=function(t){return{"line.separator":"\n"}[t]};function yt(){var t,e,n,r,i,o,s;this.x=null,this.y=null,this.w=null,0===arguments.length?(this.x=0,this.y=0,this.w=1):1===arguments.length?(this.x=(t=arguments[0]).x,this.y=t.y,this.w=1):2===arguments.length?"number"==typeof arguments[0]&&"number"==typeof arguments[1]?(t=arguments[0],r=arguments[1],this.x=t,this.y=r,this.w=1):arguments[0]instanceof yt&&arguments[1]instanceof yt?(this.x=(t=arguments[0]).y*(r=arguments[1]).w-r.y*t.w,this.y=r.x*t.w-t.x*r.w,this.w=t.x*r.y-r.x*t.y):arguments[0]instanceof v&&arguments[1]instanceof v&&(this.x=(r=arguments[0]).y-(t=arguments[1]).y,this.y=t.x-r.x,this.w=r.x*t.y-t.x*r.y):3===arguments.length?(t=arguments[0],r=arguments[1],e=arguments[2],this.x=t,this.y=r,this.w=e):4===arguments.length&&(e=(t=arguments[0]).y-(r=arguments[1]).y,n=r.x-t.x,r=t.x*r.y-r.x*t.y,i=(t=arguments[2]).y-(s=arguments[3]).y,o=s.x-t.x,s=t.x*s.y-s.x*t.y,this.x=n*s-o*r,this.y=i*r-e*s,this.w=e*o-i*n)}function u(){var t,e;this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length?this.init():1===arguments.length?arguments[0]instanceof v?this.init((t=arguments[0]).x,t.x,t.y,t.y):arguments[0]instanceof u&&this.init(arguments[0]):2===arguments.length?this.init((t=arguments[0]).x,(e=arguments[1]).x,t.y,e.y):4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])}yt.prototype.getY=function(){var t=this.y/this.w;if(l.isNaN(t)||l.isInfinite(t))throw new ft;return t},yt.prototype.getX=function(){var t=this.x/this.w;if(l.isNaN(t)||l.isInfinite(t))throw new ft;return t},yt.prototype.getCoordinate=function(){var t=new v;return t.x=this.getX(),t.y=this.getY(),t},yt.prototype.interfaces_=function(){return[]},yt.prototype.getClass=function(){return yt},yt.intersection=function(t,e,n,r){var i=t.y-e.y,o=e.x-t.x,e=t.x*e.y-e.x*t.y,t=n.y-r.y,s=r.x-n.x,r=n.x*r.y-r.x*n.y,n=i*s-t*o,o=(o*r-s*e)/n,s=(t*e-i*r)/n;if(l.isNaN(o)||l.isInfinite(o)||l.isNaN(s)||l.isInfinite(s))throw new ft;return new v(o,s)};function gt(t){this.geometryFactory=t||new w}function mt(t){this.parser=new gt(t)}function y(){}var vt,_t,t={serialVersionUID:{configurable:!0}},bt=(u.prototype.getArea=function(){return this.getWidth()*this.getHeight()},u.prototype.equals=function(t){return t instanceof u&&(t=t,this.isNull()?t.isNull():this._maxx===t.getMaxX()&&this._maxy===t.getMaxY()&&this._minx===t.getMinX()&&this._miny===t.getMinY())},u.prototype.intersection=function(t){var e,n,r;return this.isNull()||t.isNull()||!this.intersects(t)?new u:(e=(this._minx>t._minx?this:t)._minx,n=(this._miny>t._miny?this:t)._miny,r=(this._maxx<t._maxx?this:t)._maxx,t=(this._maxy<t._maxy?this:t)._maxy,new u(e,r,n,t))},u.prototype.isNull=function(){return this._maxx<this._minx},u.prototype.getMaxX=function(){return this._maxx},u.prototype.covers=function(){var t,e;return 1===arguments.length?arguments[0]instanceof v?this.covers((t=arguments[0]).x,t.y):arguments[0]instanceof u?(t=arguments[0],!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy):void 0:2===arguments.length?(t=arguments[0],e=arguments[1],!this.isNull()&&t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy):void 0},u.prototype.intersects=function(){var t,e;return 1===arguments.length?arguments[0]instanceof u?(t=arguments[0],!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)):arguments[0]instanceof v?this.intersects((t=arguments[0]).x,t.y):void 0:2===arguments.length?(t=arguments[0],e=arguments[1],!this.isNull()&&!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)):void 0},u.prototype.getMinY=function(){return this._miny},u.prototype.getMinX=function(){return this._minx},u.prototype.expandToInclude=function(){var t;if(1===arguments.length){if(arguments[0]instanceof v){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof u){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else 2===arguments.length&&(e=arguments[0],t=arguments[1],this.isNull()?(this._minx=e,this._maxx=e,this._miny=t,this._maxy=t):(e<this._minx&&(this._minx=e),e>this._maxx&&(this._maxx=e),t<this._miny&&(this._miny=t),t>this._maxy&&(this._maxy=t)))},u.prototype.minExtent=function(){var t,e;return this.isNull()?0:(t=this.getWidth())<(e=this.getHeight())?t:e},u.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},u.prototype.compareTo=function(t){return this.isNull()?t.isNull()?0:-1:t.isNull()?1:this._minx<t._minx?-1:this._minx>t._minx?1:this._miny<t._miny?-1:this._miny>t._miny?1:this._maxx<t._maxx?-1:this._maxx>t._maxx?1:this._maxy<t._maxy?-1:this._maxy>t._maxy?1:0},u.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},u.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},u.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},u.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},u.prototype.maxExtent=function(){var t,e;return this.isNull()?0:(t=this.getWidth(),(e=this.getHeight())<t?t:e)},u.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},u.prototype.contains=function(){return 1===arguments.length?arguments[0]instanceof u||arguments[0]instanceof v?this.covers(arguments[0]):void 0:2===arguments.length?this.covers(arguments[0],arguments[1]):void 0},u.prototype.centre=function(){return this.isNull()?null:new v((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},u.prototype.init=function(){var t,e,n,r;0===arguments.length?this.setToNull():1===arguments.length?arguments[0]instanceof v?this.init((t=arguments[0]).x,t.x,t.y,t.y):arguments[0]instanceof u&&(this._minx=(t=arguments[0])._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy):2===arguments.length?this.init((t=arguments[0]).x,(e=arguments[1]).x,t.y,e.y):4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),n<r?(this._miny=n,this._maxy=r):(this._miny=r,this._maxy=n))},u.prototype.getMaxY=function(){return this._maxy},u.prototype.distance=function(t){var e,n;return this.intersects(t)?0:(e=0,this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx),n=0,this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n))},u.prototype.hashCode=function(){return 37*(37*(37*(629+v.hashCode(this._minx))+v.hashCode(this._maxx))+v.hashCode(this._miny))+v.hashCode(this._maxy)},u.prototype.interfaces_=function(){return[tt,F]},u.prototype.getClass=function(){return u},u.intersects=function(){var t,e,n,r,i,o,s,a;return 3===arguments.length?(e=arguments[0],n=arguments[1],(t=arguments[2]).x>=(e.x<n.x?e:n).x&&t.x<=(e.x>n.x?e:n).x&&t.y>=(e.y<n.y?e:n).y&&t.y<=(e.y>n.y?e:n).y):4===arguments.length?(t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],i=Math.min(n.x,r.x),o=Math.max(n.x,r.x),s=Math.min(t.x,e.x),a=Math.max(t.x,e.x),!(o<s||a<i||(i=Math.min(n.y,r.y),o=Math.max(n.y,r.y),s=Math.min(t.y,e.y),a=Math.max(t.y,e.y),o<s)||a<i)):void 0},t.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(u,t),{typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/}),xt=(gt.prototype.read=function(t){t=t.replace(/[\n\r]/g," ");var e,n,r=bt.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=bt.emptyTypeStr.exec(t))[2]=void 0),void 0===(e=r&&(n=r[1].toLowerCase(),r=r[2],wt[n])?wt[n].apply(this,[r]):e))throw new Error("Could not parse WKT "+t);return e},gt.prototype.write=function(t){return this.extractGeometry(t)},gt.prototype.extractGeometry=function(t){var e,n=t.getGeometryType().toLowerCase();return xt[n]?(e=n.toUpperCase(),t.isEmpty()?e+" EMPTY":e+"("+xt[n].apply(this,[t])+")"):null},{coordinate:function(t){return t.x+" "+t.y},point:function(t){return xt.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+xt.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(xt.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(xt.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+xt.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+xt.linestring.apply(this,[t._shell])+")");for(var n=0,r=t._holes.length;n<r;++n)e.push("("+xt.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+xt.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}}),wt={point:function(t){return void 0===t?this.geometryFactory.createPoint():(t=t.trim().split(bt.spaces),this.geometryFactory.createPoint(new v(Number.parseFloat(t[0]),Number.parseFloat(t[1]))))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(bt.trimParens,"$1"),r.push(wt.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(r)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(bt.spaces),r.push(new v(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(bt.spaces),r.push(new v(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(bt.parenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(bt.trimParens,"$1"),r.push(wt.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(r)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,r=t.trim().split(bt.parenComma),i=[],o=0,s=r.length;o<s;++o)e=r[o].replace(bt.trimParens,"$1"),e=wt.linestring.apply(this,[e]),e=this.geometryFactory.createLinearRing(e._points),0===o?n=e:i.push(e);return this.geometryFactory.createPolygon(n,i)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(bt.doubleParenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(bt.trimParens,"$1"),r.push(wt.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(r)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],r=0,i=e.length;r<i;++r)n.push(this.read(e[r]));return this.geometryFactory.createGeometryCollection(n)}},Et=(mt.prototype.write=function(t){return this.parser.write(t)},mt.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"},(_t=Error)&&(Nt.__proto__=_t),(Nt.prototype=Object.create(_t&&_t.prototype)).constructor=Nt),St=((vt=Et)&&(It.__proto__=vt),((It.prototype=Object.create(vt&&vt.prototype)).constructor=It).prototype.interfaces_=function(){return[]},It.prototype.getClass=function(){return It},It);function It(){vt.call(this),0===arguments.length?vt.call(this):1===arguments.length&&vt.call(this,arguments[0])}function Nt(t){_t.call(this,t),this.name="RuntimeException",this.message=t,this.stack=(new _t).stack}y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y.shouldNeverReachHere=function(){var t;if(0===arguments.length)y.shouldNeverReachHere(null);else if(1===arguments.length)throw new St("Should never reach here"+(null!==(t=arguments[0])?": "+t:""))},y.isTrue=function(){var t,e;if(1===arguments.length)y.isTrue(t=arguments[0],null);else if(2===arguments.length&&(t=arguments[0],e=arguments[1],!t))throw null===e?new St:new St(e)},y.equals=function(){var t,e,n;if(2===arguments.length)y.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],!e.equals(t)))throw new St("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};function Ot(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new v,this._intPt[1]=new v,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}function Ct(){}var kt,t={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}},At=(Ot.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},Ot.prototype.getTopologySummary=function(){var t=new ot;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},Ot.prototype.computeIntersection=function(t,e,n,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,n,r)},Ot.prototype.getIntersectionNum=function(){return this._result},Ot.prototype.computeIntLineIndex=function(){var t;0===arguments.length?null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1)):1===arguments.length&&(this.getEdgeDistance(t=arguments[0],0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0))},Ot.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},Ot.prototype.setPrecisionModel=function(t){this._precisionModel=t},Ot.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},Ot.prototype.getIntersection=function(t){return this._intPt[t]},Ot.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},Ot.prototype.hasIntersection=function(){return this._result!==Ot.NO_INTERSECTION},Ot.prototype.getEdgeDistance=function(t,e){return Ot.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},Ot.prototype.isCollinear=function(){return this._result===Ot.COLLINEAR_INTERSECTION},Ot.prototype.toString=function(){return mt.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+mt.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},Ot.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},Ot.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},Ot.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},Ot.prototype.interfaces_=function(){return[]},Ot.prototype.getClass=function(){return Ot},Ot.computeEdgeDistance=function(t,e,n){var r,i=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y),s=-1;return t.equals(e)?s=0:t.equals(n)?s=o<i?i:o:(n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y),0!==(s=o<i?n:r)||t.equals(e)||(s=Math.max(n,r))),y.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s},Ot.nonRobustComputeEdgeDistance=function(t,e,n){var r=t.x-e.x,i=t.y-e.y,r=Math.sqrt(r*r+i*i);return y.isTrue(!(0===r&&!t.equals(e)),"Invalid distance calculation"),r},t.DONT_INTERSECT.get=function(){return 0},t.DO_INTERSECT.get=function(){return 1},t.COLLINEAR.get=function(){return 2},t.NO_INTERSECTION.get=function(){return 0},t.POINT_INTERSECTION.get=function(){return 1},t.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(Ot,t),(kt=Ot)&&(Mt.__proto__=kt),((Mt.prototype=Object.create(kt&&kt.prototype)).constructor=Mt).prototype.isInSegmentEnvelopes=function(t){var e=new u(this._inputLines[0][0],this._inputLines[0][1]),n=new u(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},Mt.prototype.computeIntersection=function(){var t,e,n;return 3!==arguments.length?kt.prototype.computeIntersection.apply(this,arguments):(t=arguments[0],e=arguments[1],n=arguments[2],this._isProper=!1,u.intersects(e,n,t)&&0===m.orientationIndex(e,n,t)&&0===m.orientationIndex(n,e,t)?(this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this._result=kt.POINT_INTERSECTION,null):void(this._result=kt.NO_INTERSECTION))},Mt.prototype.normalizeToMinimum=function(t,e,n,r,i){i.x=this.smallestInAbsValue(t.x,e.x,n.x,r.x),i.y=this.smallestInAbsValue(t.y,e.y,n.y,r.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},Mt.prototype.safeHCoordinateIntersection=function(e,n,r,i){var o=null;try{o=yt.intersection(e,n,r,i)}catch(t){if(!(t instanceof ft))throw t;o=Mt.nearestEndpoint(e,n,r,i)}return o},Mt.prototype.intersection=function(t,e,n,r){var i=this.intersectionWithNormalization(t,e,n,r);return this.isInSegmentEnvelopes(i)||(i=new v(Mt.nearestEndpoint(t,e,n,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(i),i},Mt.prototype.smallestInAbsValue=function(t,e,n,r){var i=Math.abs(t);return Math.abs(e)<i&&(t=e,i=Math.abs(e)),Math.abs(n)<i&&(t=n,i=Math.abs(n)),t=Math.abs(r)<i?r:t},Mt.prototype.checkDD=function(t,e,n,r,i){t=ut.intersection(t,e,n,r),e=this.isInSegmentEnvelopes(t);ct.out.println("DD in env = "+e+"  --------------------- "+t),1e-4<i.distance(t)&&ct.out.println("Distance = "+i.distance(t))},Mt.prototype.intersectionWithNormalization=function(t,e,n,r){var t=new v(t),e=new v(e),n=new v(n),r=new v(r),i=new v,t=(this.normalizeToEnvCentre(t,e,n,r,i),this.safeHCoordinateIntersection(t,e,n,r));return t.x+=i.x,t.y+=i.y,t},Mt.prototype.computeCollinearIntersection=function(t,e,n,r){var i=u.intersects(t,e,n),o=u.intersects(t,e,r),s=u.intersects(n,r,t),a=u.intersects(n,r,e);return i&&o?(this._intPt[0]=n,this._intPt[1]=r,kt.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,kt.COLLINEAR_INTERSECTION):i&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||o||a?kt.COLLINEAR_INTERSECTION:kt.POINT_INTERSECTION):i&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||o||s?kt.COLLINEAR_INTERSECTION:kt.POINT_INTERSECTION):o&&s?(this._intPt[0]=r,this._intPt[1]=t,!r.equals(t)||i||a?kt.COLLINEAR_INTERSECTION:kt.POINT_INTERSECTION):o&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||i||s?kt.COLLINEAR_INTERSECTION:kt.POINT_INTERSECTION):kt.NO_INTERSECTION},Mt.prototype.normalizeToEnvCentre=function(t,e,n,r,i){var o=(t.x<e.x?t:e).x,s=(t.y<e.y?t:e).y,a=(t.x>e.x?t:e).x,u=(t.y>e.y?t:e).y,l=(n.x<r.x?n:r).x,c=(n.y<r.y?n:r).y,p=(n.x>r.x?n:r).x,h=(n.y>r.y?n:r).y,s=((c<s?s:c)+(u<h?u:h))/2;i.x=((l<o?o:l)+(a<p?a:p))/2,i.y=s,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},Mt.prototype.computeIntersect=function(t,e,n,r){var i,o,s,a;return this._isProper=!1,!u.intersects(t,e,n,r)||(i=m.orientationIndex(t,e,n),o=m.orientationIndex(t,e,r),0<i&&0<o)||i<0&&o<0||(s=m.orientationIndex(n,r,t),a=m.orientationIndex(n,r,e),0<s&&0<a)||s<0&&a<0?kt.NO_INTERSECTION:0===i&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,r):(0===i||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(r)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(r)?this._intPt[0]=e:0===i?this._intPt[0]=new v(n):0===o?this._intPt[0]=new v(r):0===s?this._intPt[0]=new v(t):0===a&&(this._intPt[0]=new v(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,r)),kt.POINT_INTERSECTION)},Mt.prototype.interfaces_=function(){return[]},Mt.prototype.getClass=function(){return Mt},Mt.nearestEndpoint=function(t,e,n,r){var i=t,o=m.distancePointLine(t,n,r),s=m.distancePointLine(e,n,r);return s<o&&(o=s,i=e),(s=m.distancePointLine(n,t,e))<o&&(o=s,i=n),(s=m.distancePointLine(r,t,e))<o&&(o=s,i=r),i},Mt);function Mt(){kt.apply(this,arguments)}Ct.prototype.interfaces_=function(){return[]},Ct.prototype.getClass=function(){return Ct},Ct.orientationIndex=function(t,e,n){var r=e.x-t.x,t=e.y-t.y,i=n.x-e.x,n=n.y-e.y;return Ct.signOfDet2x2(r,t,i,n)},Ct.signOfDet2x2=function(t,e,n,r){var i,o=null,s=null,o=1;if(0===t||0===r)return 0===e||0===n?0:0<e?0<n?-o:o:0<n?o:-o;if(0===e||0===n)return 0<r?0<t?o:-o:0<t?-o:o;if(0<e?0<r?e<=r||(o=-o,s=t,t=n,n=s,s=e,e=r,r=s):r=e<=-r?(o=-o,n=-n,-r):(s=t,t=-n,n=s,s=e,e=-r,s):0<r?-e<=r?(o=-o,t=-t,e=-e):(s=-t,t=n,n=s,s=-e,e=r,r=s):r=r<=e?(t=-t,e=-e,n=-n,-r):(o=-o,s=-t,t=-n,n=s,s=-e,e=-r,s),0<t){if(!(0<n))return o;if(!(t<=n))return o}else{if(0<n)return-o;if(!(n<=t))return-o;o=-o,t=-t,n=-n}for(;;){if((r-=(i=Math.floor(n/t))*e)<0)return-o;if(e<r)return o;if((n-=i*t)+n<t){if(e<r+r)return o}else{if(r+r<e)return-o;n=t-n,r=e-r,o=-o}if(0===r)return 0===n?0:-o;if(0===n)return o;if((e-=(i=Math.floor(t/n))*r)<0)return o;if(r<e)return-o;if((t-=i*n)+t<n){if(r<e+e)return-o}else{if(e+e<r)return o;t=n-t,e=r-e,o=-o}if(0===e)return 0===t?0:o;if(0===t)return-o}};function Lt(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1,this._p=arguments[0]}function Pt(){}function _(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()}function Tt(){}function Rt(){}function Dt(){}function Ft(){}Lt.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y)return n=t.x,(r=e.x)<n&&(n=e.x,r=t.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null;if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var n=t.x-this._p.x,r=t.y-this._p.y,t=e.x-this._p.x,e=e.y-this._p.y,n=Ct.signOfDet2x2(n,r,t,e);if(0===n)return this._isPointOnSegment=!0,null;0<(n=e<r?-n:n)&&this._crossingCount++}},Lt.prototype.isPointInPolygon=function(){return this.getLocation()!==h.EXTERIOR},Lt.prototype.getLocation=function(){return this._isPointOnSegment?h.BOUNDARY:this._crossingCount%2==1?h.INTERIOR:h.EXTERIOR},Lt.prototype.isOnSegment=function(){return this._isPointOnSegment},Lt.prototype.interfaces_=function(){return[]},Lt.prototype.getClass=function(){return Lt},Lt.locatePointInRing=function(){if(arguments[0]instanceof v&&g(arguments[1],d)){for(var t=arguments[0],e=arguments[1],n=new Lt(t),r=new v,i=new v,o=1;o<e.size();o++)if(e.getCoordinate(o,r),e.getCoordinate(o-1,i),n.countSegment(r,i),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof v&&arguments[1]instanceof Array){for(var t=arguments[0],s=arguments[1],a=new Lt(t),u=1;u<s.length;u++){var l=s[u],c=s[u-1];if(a.countSegment(l,c),a.isOnSegment())return a.getLocation()}return a.getLocation()}};var jt,m=function(){},t={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}},t=(m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},m.orientationIndex=function(t,e,n){return ut.orientationIndex(t,e,n)},m.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var i=t[r].x-n,o=t[r+1].y;e+=i*(t[r-1].y-o)}return e/2}if(g(arguments[0],d)){var s=arguments[0],a=s.size();if(a<3)return 0;var u=new v,l=new v,c=new v,p=(s.getCoordinate(0,l),s.getCoordinate(1,c),l.x);c.x-=p;for(var h=0,f=1;f<a-1;f++)u.y=l.y,l.x=c.x,l.y=c.y,s.getCoordinate(f+1,c),c.x-=p,h+=l.x*(u.y-c.y);return h/2}},m.distanceLineLine=function(t,e,n,r){var i,o,s,a;return t.equals(e)?m.distancePointLine(t,n,r):n.equals(r)?m.distancePointLine(r,t,e):(i=!1,(i=!u.intersects(t,e,n,r)||0==(o=(e.x-t.x)*(r.y-n.y)-(e.y-t.y)*(r.x-n.x))||(a=(t.y-n.y)*(r.x-n.x)-(t.x-n.x)*(r.y-n.y),s=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,(a=a/o)<0)||1<a||s<0||1<s?!0:i)?it.min(m.distancePointLine(t,n,r),m.distancePointLine(e,n,r),m.distancePointLine(n,t,e),m.distancePointLine(r,t,e)):0)},m.isPointInRing=function(t,e){return m.locatePointInRing(t,e)!==h.EXTERIOR},m.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new v;t.getCoordinate(0,r);for(var i=r.x,o=r.y,s=1;s<e;s++){t.getCoordinate(s,r);var a=r.x,u=r.y,l=a-i,c=u-o;n+=Math.sqrt(l*l+c*c),i=a,o=u}return n},m.isCCW=function(t){var e=t.length-1;if(e<3)throw new p("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,i=1;i<=e;i++){var o=t[i];o.y>n.y&&(n=o,r=i)}for(var s=r;t[s=--s<0?e:s].equals2D(n)&&s!==r;);for(var a=r;t[a=(a+1)%e].equals2D(n)&&a!==r;);var u,l=t[s],c=t[a];return!(l.equals2D(n)||c.equals2D(n)||l.equals2D(c))&&(0===(u=m.computeOrientation(l,n,c))?l.x>c.x:0<u)},m.locatePointInRing=function(t,e){return Lt.locatePointInRing(t,e)},m.distancePointLinePerpendicular=function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),t=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(t)*Math.sqrt(r)},m.computeOrientation=function(t,e,n){return m.orientationIndex(t,e,n)},m.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new p("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var i=m.distancePointLine(t,e[r],e[r+1]);i<n&&(n=i)}return n}var o,s,a,u,l;if(3===arguments.length)return o=arguments[0],(s=arguments[1]).x===(a=arguments[2]).x&&s.y===a.y||(u=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),(l=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/u)<=0)?o.distance(s):1<=l?o.distance(a):(l=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/u,Math.abs(l)*Math.sqrt(u))},m.isOnLine=function(t,e){for(var n=new At,r=1;r<e.length;r++){var i=e[r-1],o=e[r];if(n.computeIntersection(t,i,o),n.hasIntersection())return!0}return!1},t.CLOCKWISE.get=function(){return-1},t.RIGHT.get=function(){return m.CLOCKWISE},t.COUNTERCLOCKWISE.get=function(){return 1},t.LEFT.get=function(){return m.COUNTERCLOCKWISE},t.COLLINEAR.get=function(){return 0},t.STRAIGHT.get=function(){return m.COLLINEAR},Object.defineProperties(m,t),Pt.prototype.filter=function(t){},Pt.prototype.interfaces_=function(){return[]},Pt.prototype.getClass=function(){return Pt},{serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}}),qt=(_.prototype.isGeometryCollection=function(){return this.getSortIndex()===_.SORTINDEX_GEOMETRYCOLLECTION},_.prototype.getFactory=function(){return this._factory},_.prototype.getGeometryN=function(t){return this},_.prototype.getArea=function(){return 0},_.prototype.isRectangle=function(){return!1},_.prototype.equals=function(){var t;return arguments[0]instanceof _?null!==(t=arguments[0])&&this.equalsTopo(t):arguments[0]instanceof Object?(t=arguments[0])instanceof _&&this.equalsExact(t):void 0},_.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},_.prototype.geometryChanged=function(){this.apply(_.geometryChangedFilter)},_.prototype.geometryChangedAction=function(){this._envelope=null},_.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},_.prototype.getLength=function(){return 0},_.prototype.getNumGeometries=function(){return 1},_.prototype.compareTo=function(){var t,e;return 1===arguments.length?(t=e=arguments[0],this.getSortIndex()!==t.getSortIndex()?this.getSortIndex()-t.getSortIndex():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)):2===arguments.length?(t=arguments[0],e=arguments[1],this.getSortIndex()!==t.getSortIndex()?this.getSortIndex()-t.getSortIndex():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(t,e)):void 0},_.prototype.getUserData=function(){return this._userData},_.prototype.getSRID=function(){return this._SRID},_.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},_.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===_.SORTINDEX_GEOMETRYCOLLECTION)throw new p("This method does not support GeometryCollection arguments")},_.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},_.prototype.norm=function(){var t=this.copy();return t.normalize(),t},_.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},_.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new u(this._envelope)},_.prototype.setSRID=function(t){this._SRID=t},_.prototype.setUserData=function(t){this._userData=t},_.prototype.compare=function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var i=n.next(),o=r.next(),i=i.compareTo(o);if(0!==i)return i}return n.hasNext()?1:r.hasNext()?-1:0},_.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},_.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===_.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===_.SORTINDEX_MULTIPOINT||this.getSortIndex()===_.SORTINDEX_MULTILINESTRING||this.getSortIndex()===_.SORTINDEX_MULTIPOLYGON},_.prototype.interfaces_=function(){return[et,tt,F]},_.prototype.getClass=function(){return _},_.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},_.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},t.serialVersionUID.get=function(){return 0x799ea46522854c00},t.SORTINDEX_POINT.get=function(){return 0},t.SORTINDEX_MULTIPOINT.get=function(){return 1},t.SORTINDEX_LINESTRING.get=function(){return 2},t.SORTINDEX_LINEARRING.get=function(){return 3},t.SORTINDEX_MULTILINESTRING.get=function(){return 4},t.SORTINDEX_POLYGON.get=function(){return 5},t.SORTINDEX_MULTIPOLYGON.get=function(){return 6},t.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},t.geometryChangedFilter.get=function(){return qt},Object.defineProperties(_,t),function(){}),t=(qt.interfaces_=function(){return[Pt]},qt.filter=function(t){t.geometryChangedAction()},Tt.prototype.filter=function(t){},Tt.prototype.interfaces_=function(){return[]},Tt.prototype.getClass=function(){return Tt},{Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}}),Bt=(Rt.prototype.isInBoundary=function(t){},Rt.prototype.interfaces_=function(){return[]},Rt.prototype.getClass=function(){return Rt},t.Mod2BoundaryNodeRule.get=function(){return Bt},t.EndPointBoundaryNodeRule.get=function(){return Gt},t.MultiValentEndPointBoundaryNodeRule.get=function(){return zt},t.MonoValentEndPointBoundaryNodeRule.get=function(){return Ut},t.MOD2_BOUNDARY_RULE.get=function(){return new Bt},t.ENDPOINT_BOUNDARY_RULE.get=function(){return new Gt},t.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new zt},t.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Ut},t.OGC_SFS_BOUNDARY_RULE.get=function(){return Rt.MOD2_BOUNDARY_RULE},Object.defineProperties(Rt,t),function(){}),Gt=(Bt.prototype.isInBoundary=function(t){return t%2==1},Bt.prototype.interfaces_=function(){return[Rt]},Bt.prototype.getClass=function(){return Bt},function(){}),zt=(Gt.prototype.isInBoundary=function(t){return 0<t},Gt.prototype.interfaces_=function(){return[Rt]},Gt.prototype.getClass=function(){return Gt},function(){}),Ut=(zt.prototype.isInBoundary=function(t){return 1<t},zt.prototype.interfaces_=function(){return[Rt]},zt.prototype.getClass=function(){return zt},function(){}),Vt=(Ut.prototype.isInBoundary=function(t){return 1===t},Ut.prototype.interfaces_=function(){return[Rt]},Ut.prototype.getClass=function(){return Ut},Dt.prototype.add=function(){},Dt.prototype.addAll=function(){},Dt.prototype.isEmpty=function(){},Dt.prototype.iterator=function(){},Dt.prototype.size=function(){},Dt.prototype.toArray=function(){},Dt.prototype.remove=function(){},(j.prototype=new Error).name="IndexOutOfBoundsException",Ft.prototype.hasNext=function(){},Ft.prototype.next=function(){},Ft.prototype.remove=function(){},(jt=Dt)&&($t.__proto__=jt),(($t.prototype=Object.create(jt&&jt.prototype)).constructor=$t).prototype.get=function(){},$t.prototype.set=function(){},$t.prototype.isEmpty=function(){},$t);function $t(){jt.apply(this,arguments)}(q.prototype=new Error).name="NoSuchElementException";function c(){}(Jt=Vt)&&(Zt.__proto__=Jt),((Zt.prototype=Object.create(Jt&&Jt.prototype)).constructor=Zt).prototype.ensureCapacity=function(){},Zt.prototype.interfaces_=function(){return[Jt,Dt]},Zt.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(t,arguments[1]),!0},Zt.prototype.clear=function(){this.array_=[]},Zt.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Zt.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},Zt.prototype.iterator=function(){return new Wt(this)},Zt.prototype.get=function(t){if(t<0||t>=this.size())throw new j;return this.array_[t]},Zt.prototype.isEmpty=function(){return 0===this.array_.length},Zt.prototype.size=function(){return this.array_.length},Zt.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Zt.prototype.remove=function(t){for(var e=!1,n=0,r=this.array_.length;n<r;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e};var Xt,Yt,Jt,b=Zt,Wt=((Yt=Ft)&&(Qt.__proto__=Yt),((Qt.prototype=Object.create(Yt&&Yt.prototype)).constructor=Qt).prototype.next=function(){if(this.position_===this.arrayList_.size())throw new q;return this.arrayList_.get(this.position_++)},Qt.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},Qt.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},Qt.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},Qt),Ht=((Xt=b)&&(Kt.__proto__=Xt),(Kt.prototype=Object.create(Xt&&Xt.prototype)).constructor=Kt,(t={coordArrayType:{configurable:!0}}).coordArrayType.get=function(){return new Array(0).fill(null)},Kt.prototype.getCoordinate=function(t){return this.get(t)},Kt.prototype.addAll=function(){if(2!==arguments.length)return Xt.prototype.addAll.apply(this,arguments);for(var t=arguments[0],e=arguments[1],n=!1,r=t.iterator();r.hasNext();)this.add(r.next(),e),n=!0;return n},Kt.prototype.clone=function(){for(var t=Xt.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},Kt.prototype.toCoordinateArray=function(){return this.toArray(Kt.coordArrayType)},Kt.prototype.add=function(){if(1===arguments.length)Xt.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],!0),!0;if(arguments[0]instanceof v&&"boolean"==typeof arguments[1]){var t=arguments[0];if(!arguments[1]&&1<=this.size()&&this.get(this.size()-1).equals2D(t))return null;Xt.prototype.add.call(this,t)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];if(arguments[2])for(var r=0;r<e.length;r++)this.add(e[r],n);else for(var i=e.length-1;0<=i;i--)this.add(e[i],n);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof v){var t=arguments[0],o=arguments[1];if(!arguments[2]){var s=this.size();if(0<s){if(0<t&&this.get(t-1).equals2D(o))return null;if(t<s&&this.get(t).equals2D(o))return null}}Xt.prototype.add.call(this,t,o)}}else if(4===arguments.length){var a=arguments[0],u=arguments[1],s=arguments[2],l=arguments[3],c=1;l<s&&(c=-1);for(var p=s;p!==l;p+=c)this.add(a[p],u);return!0}},Kt.prototype.closeRing=function(){0<this.size()&&this.add(new v(this.get(0)),!1)},Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt},Object.defineProperties(Kt,t),Kt),t={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};function Kt(){var t,e;Xt.call(this),0!==arguments.length&&(1===arguments.length?(this.ensureCapacity((t=arguments[0]).length),this.add(t,!0)):2===arguments.length&&(t=arguments[0],e=arguments[1],this.ensureCapacity(t.length),this.add(t,e)))}function Qt(t){Yt.call(this),this.arrayList_=t,this.position_=0}function Zt(){Jt.call(this),this.array_=[],arguments[0]instanceof Dt&&this.addAll(arguments[0])}t.ForwardComparator.get=function(){return ne},t.BidirectionalComparator.get=function(){return re},t.coordArrayType.get=function(){return new Array(0).fill(null)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},c.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(c.indexOf(r,e)<0)return r}return null},c.scroll=function(t,e){e=c.indexOf(e,t);if(e<0)return null;var n=new Array(t.length).fill(null);ct.arraycopy(t,e,n,0,t.length-e),ct.arraycopy(t,0,n,t.length-e,e),ct.arraycopy(n,0,t,0,t.length)},c.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t!==e){if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1}return!0}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];if(r!==i){if(null===r||null===i)return!1;if(r.length!==i.length)return!1;for(var s=0;s<r.length;s++)if(0!==o.compare(r[s],i[s]))return!1}return!0}},c.intersection=function(t,e){for(var n=new Ht,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()},c.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},c.removeRepeatedPoints=function(t){return c.hasRepeatedPoints(t)?new Ht(t,!1).toCoordinateArray():t},c.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var i=t[r];t[r]=t[e-r],t[e-r]=i}},c.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var r=new Array(e).fill(null);if(0!==e)for(var i=0,o=0;o<t.length;o++)null!==t[o]&&(r[i++]=t[o]);return r},c.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new v(t[n]);return e}if(5===arguments.length)for(var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],u=0;u<a;u++)o[s+u]=new v(r[i+u])},c.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e[t.length-n-1];if(0!==r.compareTo(i))return!1}return!0},c.envelope=function(t){for(var e=new u,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},c.toCoordinateArray=function(t){return t.toArray(c.coordArrayType)},c.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},c.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},c.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,n=t[e].compareTo(t[n]);if(0!==n)return n}return 1},c.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(0!==r)return r;n++}return n<e.length?-1:n<t.length?1:0},c.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||0<e.compareTo(t[n]))&&(e=t[n]);return e},c.extract=function(t,e,n){e=it.clamp(e,0,t.length);var r=(n=it.clamp(n,-1,t.length))-e+1,i=(n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0),new Array(r).fill(null));if(0!==r)for(var o=0,s=e;s<=n;s++)i[o++]=t[s];return i},Object.defineProperties(c,t);function te(){}var ee,ne=function(){},re=(ne.prototype.compare=function(t,e){return c.compare(t,e)},ne.prototype.interfaces_=function(){return[nt]},ne.prototype.getClass=function(){return ne},function(){}),t=(re.prototype.compare=function(t,e){var n;return t.length<e.length?-1:t.length>e.length?1:0===t.length||(n=c.compare(t,e),c.isEqualReversed(t,e))?0:n},re.prototype.OLDcompare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0!==n.length)for(var i=c.increasingDirection(n),o=c.increasingDirection(r),s=0<i?0:n.length-1,a=0<o?0:n.length-1,u=0;u<n.length;u++){var l=n[s].compareTo(r[a]);if(0!==l)return l;s+=i,a+=o}return 0},re.prototype.interfaces_=function(){return[nt]},re.prototype.getClass=function(){return re},te.prototype.get=function(){},te.prototype.put=function(){},te.prototype.size=function(){},te.prototype.values=function(){},te.prototype.entrySet=function(){},(ee=te)&&(ie.__proto__=ee),(ie.prototype=Object.create(ee&&ee.prototype)).constructor=ie);function ie(){ee.apply(this,arguments)}(B.prototype=new Error).name="OperationNotSupported",(G.prototype=new Dt).contains=function(){};(se=G)&&(ce.__proto__=se),((ce.prototype=Object.create(se&&se.prototype)).constructor=ce).prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},ce.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},ce.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},ce.prototype.remove=function(t){throw new Error},ce.prototype.size=function(){return this.array_.length},ce.prototype.isEmpty=function(){return 0===this.array_.length},ce.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},ce.prototype.iterator=function(){return new ue(this)};var oe,se,ae=ce,ue=((oe=Ft)&&(le.__proto__=oe),((le.prototype=Object.create(oe&&oe.prototype)).constructor=le).prototype.next=function(){if(this.position_===this.hashSet_.size())throw new q;return this.hashSet_.array_[this.position_++]},le.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},le.prototype.remove=function(){throw new B},le);function le(t){oe.call(this),this.hashSet_=t,this.position_=0}function ce(){se.call(this),this.array_=[],arguments[0]instanceof Dt&&this.addAll(arguments[0])}(X.prototype=new t).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(0<n))return e.value;e=e.right}}return null},X.prototype.put=function(t,e){if(null===this.root_)this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1;else{var n,r,i,o=this.root_;do{if(n=o,(r=t.compareTo(o.key))<0)o=o.left;else{if(!(0<r))return i=o.value,o.value=e,i;o=o.right}}while(null!==o);var s={key:t,left:null,right:null,value:e,parent:n,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};r<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++}return null},X.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;){var e;n(t)===V(n(n(t)))?1===z(e=$(n(n(t))))?(U(n(t),0),U(e,0),U(n(n(t)),1),t=n(n(t))):(t===$(n(t))&&(t=n(t),this.rotateLeft(t)),U(n(t),0),U(n(n(t)),1),this.rotateRight(n(n(t)))):1===z(e=V(n(n(t))))?(U(n(t),0),U(e,0),U(n(n(t)),1),t=n(n(t))):(t===V(n(t))&&(t=n(t),this.rotateRight(t)),U(n(t),0),U(n(n(t)),1),this.rotateLeft(n(n(t))))}this.root_.color=0},X.prototype.values=function(){var t=new b,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=X.successor(e));)t.add(e.value);return t},X.prototype.entrySet=function(){var t=new ae,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=X.successor(e));)t.add(e);return t},X.prototype.rotateLeft=function(t){var e;null!=t&&(e=t.right,t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,(e.left=t).parent=e)},X.prototype.rotateRight=function(t){var e;null!=t&&(e=t.left,t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,(e.right=t).parent=e)},X.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},X.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,r=t;null!==n&&r===n.right;)n=(r=n).parent;return n},X.prototype.size=function(){return this.size_};function pe(){}function he(){}function r(){}function fe(){}function de(){}pe.prototype.interfaces_=function(){return[]},pe.prototype.getClass=function(){return pe},Y.prototype=new G,(J.prototype=new Y).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},J.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},J.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},J.prototype.remove=function(t){throw new B},J.prototype.size=function(){return this.array_.length},J.prototype.isEmpty=function(){return 0===this.array_.length},J.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},J.prototype.iterator=function(){return new me(this)};var ye,ge,me=function(t){this.treeSet_=t,this.position_=0},t=(me.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new q;return this.treeSet_.array_[this.position_++]},me.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},me.prototype.remove=function(){throw new B},he.sort=function(){var t,e,n,r=arguments[0];if(1===arguments.length)r.sort(function(t,e){return t.compareTo(e)});else if(2===arguments.length)n=arguments[1],r.sort(function(t,e){return n.compare(t,e)});else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var i=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<i.length;t++)r.push(i[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],e.sort(function(t,e){return n.compare(t,e)}),i=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<i.length;t++)r.push(i[t])},he.asList=function(t){for(var e=new b,n=0,r=t.length;n<r;n++)e.add(t[n]);return e},{P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}}),ve=(t.P.get=function(){return 0},t.L.get=function(){return 1},t.A.get=function(){return 2},t.FALSE.get=function(){return-1},t.TRUE.get=function(){return-2},t.DONTCARE.get=function(){return-3},t.SYM_FALSE.get=function(){return"F"},t.SYM_TRUE.get=function(){return"T"},t.SYM_DONTCARE.get=function(){return"*"},t.SYM_P.get=function(){return"0"},t.SYM_L.get=function(){return"1"},t.SYM_A.get=function(){return"2"},r.prototype.interfaces_=function(){return[]},r.prototype.getClass=function(){return r},r.toDimensionSymbol=function(t){switch(t){case r.FALSE:return r.SYM_FALSE;case r.TRUE:return r.SYM_TRUE;case r.DONTCARE:return r.SYM_DONTCARE;case r.P:return r.SYM_P;case r.L:return r.SYM_L;case r.A:return r.SYM_A}throw new p("Unknown dimension value: "+t)},r.toDimensionValue=function(t){switch(at.toUpperCase(t)){case r.SYM_FALSE:return r.FALSE;case r.SYM_TRUE:return r.TRUE;case r.SYM_DONTCARE:return r.DONTCARE;case r.SYM_P:return r.P;case r.SYM_L:return r.L;case r.SYM_A:return r.A}throw new p("Unknown dimension symbol: "+t)},Object.defineProperties(r,t),fe.prototype.filter=function(t){},fe.prototype.interfaces_=function(){return[]},fe.prototype.getClass=function(){return fe},de.prototype.filter=function(t,e){},de.prototype.isDone=function(){},de.prototype.isGeometryChanged=function(){},de.prototype.interfaces_=function(){return[]},de.prototype.getClass=function(){return de},(ge=_)&&(i.__proto__=ge),t={serialVersionUID:{configurable:!0}},((i.prototype=Object.create(ge&&ge.prototype)).constructor=i).prototype.computeEnvelopeInternal=function(){for(var t=new u,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},i.prototype.getGeometryN=function(t){return this._geometries[t]},i.prototype.getSortIndex=function(){return ge.SORTINDEX_GEOMETRYCOLLECTION},i.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getCoordinates(),i=0;i<r.length;i++)t[++e]=r[i];return t},i.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},i.prototype.equalsExact=function(){if(2!==arguments.length)return ge.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._geometries.length!==n._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(n._geometries[r],e))return!1;return!0},i.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();he.sort(this._geometries)},i.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},i.prototype.getBoundaryDimension=function(){for(var t=r.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},i.prototype.getDimension=function(){for(var t=r.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},i.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},i.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},i.prototype.getNumGeometries=function(){return this._geometries.length},i.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},i.prototype.compareToSameClass=function(){var t;if(1===arguments.length)return t=arguments[0],e=new J(he.asList(this._geometries)),t=new J(he.asList(t._geometries)),this.compare(e,t);if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=e,i=this.getNumGeometries(),o=r.getNumGeometries(),s=0;s<i&&s<o;){var a=this.getGeometryN(s),u=r.getGeometryN(s),a=a.compareToSameClass(u,n);if(0!==a)return a;s++}return s<i?1:s<o?-1:0}},i.prototype.apply=function(){if(g(arguments[0],Tt))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(g(arguments[0],de)){var n=arguments[0];if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(this._geometries[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(g(arguments[0],fe)){var i=arguments[0];i.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(i)}else if(g(arguments[0],Pt)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},i.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),y.shouldNeverReachHere(),null},i.prototype.clone=function(){var t=ge.prototype.clone.call(this);t._geometries=new Array(this._geometries.length).fill(null);for(var e=0;e<this._geometries.length;e++)t._geometries[e]=this._geometries[e].clone();return t},i.prototype.getGeometryType=function(){return"GeometryCollection"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(i,t),i),_e=((ye=ve)&&(xe.__proto__=ye),t={serialVersionUID:{configurable:!0}},((xe.prototype=Object.create(ye&&ye.prototype)).constructor=xe).prototype.getSortIndex=function(){return _.SORTINDEX_MULTILINESTRING},xe.prototype.equalsExact=function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1],!!this.isEquivalentClass(t)&&ye.prototype.equalsExact.call(this,t,e)):ye.prototype.equalsExact.apply(this,arguments)},xe.prototype.getBoundaryDimension=function(){return this.isClosed()?r.FALSE:0},xe.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},xe.prototype.getDimension=function(){return 1},xe.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},xe.prototype.getBoundary=function(){return new be(this).getBoundary()},xe.prototype.getGeometryType=function(){return"MultiLineString"},xe.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new xe(t,this._factory)},xe.prototype.interfaces_=function(){return[pe]},xe.prototype.getClass=function(){return xe},t.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(xe,t),xe),be=function(){var t,e;this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length?(e=Rt.MOD2_BOUNDARY_RULE,this._geom=t=arguments[0],this._geomFact=t.getFactory(),this._bnRule=e):2===arguments.length&&(t=arguments[0],e=arguments[1],this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e)};function xe(){ye.apply(this,arguments)}function i(t,e){if(ge.call(this,e),this._geometries=t||[],ge.hasNullElements(this._geometries))throw new p("geometries must not contain null elements")}be.prototype.boundaryMultiLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():1===(t=this.computeBoundaryCoordinates(t)).length?this._geomFact.createPoint(t[0]):this._geomFact.createMultiPointFromCoords(t)},be.prototype.getBoundary=function(){return this._geom instanceof Oe?this.boundaryLineString(this._geom):this._geom instanceof _e?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},be.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},be.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},be.prototype.computeBoundaryCoordinates=function(t){var e=new b;this._endpointMap=new X;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);0!==r.getNumPoints()&&(this.addEndpoint(r.getCoordinateN(0)),this.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var i=this._endpointMap.entrySet().iterator();i.hasNext();){var o=i.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return c.toCoordinateArray(e)},be.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Ne,this._endpointMap.put(t,e)),e.count++},be.prototype.interfaces_=function(){return[]},be.prototype.getClass=function(){return be},be.getBoundary=function(){return 1===arguments.length?new be(arguments[0]).getBoundary():2===arguments.length?new be(arguments[0],arguments[1]).getBoundary():void 0};function we(){}function Ee(){}function Se(){}var Ie,Ne=function(){this.count=null},t=(Ne.prototype.interfaces_=function(){return[]},Ne.prototype.getClass=function(){return Ne},{NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}}),Oe=(we.prototype.interfaces_=function(){return[]},we.prototype.getClass=function(){return we},we.chars=function(t,e){for(var n=new Array(e).fill(null),r=0;r<e;r++)n[r]=t;return String(n)},we.getStackTrace=function(){var t;if(1===arguments.length)return t=new function(){},e=new function(){},arguments[0].printStackTrace(e),t.toString();if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r="",i=new function(){}(we.getStackTrace(e)),o=0;o<n;o++)try{r+=i.readLine()+we.NEWLINE}catch(t){if(!!1)throw t;y.shouldNeverReachHere()}return r}},we.split=function(t,e){for(var n=e.length,r=new b,i=""+t,o=i.indexOf(e);0<=o;){var s=i.substring(0,o);r.add(s),o=(i=i.substring(o+n)).indexOf(e)}0<i.length&&r.add(i);for(var a=new Array(r.size()).fill(null),u=0;u<a.length;u++)a[u]=r.get(u);return a},we.toString=function(){if(1===arguments.length)return we.SIMPLE_ORDINATE_FORMAT.format(arguments[0])},we.spaces=function(t){return we.chars(" ",t)},t.NEWLINE.get=function(){return ct.getProperty("line.separator")},t.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}},Object.defineProperties(we,t),Ee.prototype.interfaces_=function(){return[]},Ee.prototype.getClass=function(){return Ee},Ee.copyCoord=function(t,e,n,r){for(var i=Math.min(t.getDimension(),n.getDimension()),o=0;o<i;o++)n.setOrdinate(r,o,t.getOrdinate(e,o))},Ee.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,d.X)===t.getOrdinate(e-1,d.X)&&t.getOrdinate(0,d.Y)===t.getOrdinate(e-1,d.Y)},Ee.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),i=0;i<n;i++)for(var o=0;o<r;o++){var s=t.getOrdinate(i,o),a=e.getOrdinate(i,o);if(!(t.getOrdinate(i,o)===e.getOrdinate(i,o)||l.isNaN(s)&&l.isNaN(a)))return!1}return!0},Ee.extend=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();if(Ee.copy(e,0,r,0,i),0<i)for(var o=i;o<n;o++)Ee.copy(e,i-1,r,o,1);return r},Ee.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),r=0;r<=n;r++)Ee.swap(t,r,e-r)},Ee.swap=function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var i=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,i)}},Ee.copy=function(t,e,n,r,i){for(var o=0;o<i;o++)Ee.copyCoord(t,e+o,n,r+o)},Ee.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),r=new ot;r.append("(");for(var i=0;i<e;i++){0<i&&r.append(" ");for(var o=0;o<n;o++)0<o&&r.append(","),r.append(we.toString(t.getOrdinate(i,o)))}return r.append(")"),r.toString()}},Ee.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Ee.createClosedRing(t,e,4):e.getOrdinate(0,d.X)===e.getOrdinate(n-1,d.X)&&e.getOrdinate(0,d.Y)===e.getOrdinate(n-1,d.Y)?e:Ee.createClosedRing(t,e,n+1)},Ee.createClosedRing=function(t,e,n){var r=t.create(n,e.getDimension()),t=e.size();Ee.copy(e,0,r,0,t);for(var i=t;i<n;i++)Ee.copy(e,0,r,i,1);return r},(Ie=_)&&(e.__proto__=Ie),t={serialVersionUID:{configurable:!0}},((e.prototype=Object.create(Ie&&Ie.prototype)).constructor=e).prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new u:this._points.expandEnvelope(new u)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return Ie.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2!==arguments.length)return Ie.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._points.size()!==n._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),n._points.getCoordinate(r),e))return!1;return!0},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return 0<this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))&&Ee.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?r.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return m.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Ee.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var r=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==r)return r;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}var i;if(2===arguments.length)return i=arguments[0],arguments[1].compare(this._points,i._points)},e.prototype.apply=function(){if(g(arguments[0],Tt))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(g(arguments[0],de)){var n=arguments[0];if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(n.filter(this._points,r),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else(g(arguments[0],fe)||g(arguments[0],Pt))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new be(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var t=Ie.prototype.clone.call(this);return t._points=this._points.clone(),t},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(1===(t=null===t?this.getFactory().getCoordinateSequenceFactory().create([]):t).size())throw new p("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[pe]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,t),e);function e(t,e){Ie.call(this,e),this._points=null,this.init(t)}Se.prototype.interfaces_=function(){return[]},Se.prototype.getClass=function(){return Se};function Ce(){}(ke=_)&&(o.__proto__=ke),t={serialVersionUID:{configurable:!0}},((o.prototype=Object.create(ke&&ke.prototype)).constructor=o).prototype.computeEnvelopeInternal=function(){var t;return this.isEmpty()?new u:((t=new u).expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t)},o.prototype.getSortIndex=function(){return ke.SORTINDEX_POINT},o.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},o.prototype.equalsExact=function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1],!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))):ke.prototype.equalsExact.apply(this,arguments)},o.prototype.normalize=function(){},o.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},o.prototype.getBoundaryDimension=function(){return r.FALSE},o.prototype.getDimension=function(){return 0},o.prototype.getNumPoints=function(){return this.isEmpty()?0:1},o.prototype.reverse=function(){return this.copy()},o.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},o.prototype.compareToSameClass=function(){var t;return 1===arguments.length?(t=arguments[0],this.getCoordinate().compareTo(t.getCoordinate())):2===arguments.length?(t=arguments[0],arguments[1].compare(this._coordinates,t._coordinates)):void 0},o.prototype.apply=function(){if(g(arguments[0],Tt)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(g(arguments[0],de)){t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else(g(arguments[0],fe)||g(arguments[0],Pt))&&arguments[0].filter(this)},o.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},o.prototype.clone=function(){var t=ke.prototype.clone.call(this);return t._coordinates=this._coordinates.clone(),t},o.prototype.getGeometryType=function(){return"Point"},o.prototype.copy=function(){return new o(this._coordinates.copy(),this._factory)},o.prototype.getCoordinateSequence=function(){return this._coordinates},o.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},o.prototype.isEmpty=function(){return 0===this._coordinates.size()},o.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),y.isTrue(t.size()<=1),this._coordinates=t},o.prototype.isSimple=function(){return!0},o.prototype.interfaces_=function(){return[Se]},o.prototype.getClass=function(){return o},t.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(o,t);var ke,Ae=o;function o(t,e){ke.call(this,e),this._coordinates=t||null,this.init(this._coordinates)}Ce.prototype.interfaces_=function(){return[]},Ce.prototype.getClass=function(){return Ce};function Me(t){this._factory=t||null,this._isUserDataCopied=!1}(Re=_)&&(s.__proto__=Re),t={serialVersionUID:{configurable:!0}},((s.prototype=Object.create(Re&&Re.prototype)).constructor=s).prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},s.prototype.getSortIndex=function(){return Re.SORTINDEX_POLYGON},s.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},s.prototype.getArea=function(){var t=0;t+=Math.abs(m.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(m.signedArea(this._holes[e].getCoordinateSequence()));return t},s.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var r=t.getX(n);if(r!==e.getMinX()&&r!==e.getMaxX())return!1;r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var i=t.getX(0),o=t.getY(0),s=1;s<=4;s++){var a=t.getX(s),u=t.getY(s);if(a!==i==(u!==o))return!1;i=a,o=u}return!0},s.prototype.equalsExact=function(){if(2!==arguments.length)return Re.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,t=this._shell,r=n._shell;if(!t.equalsExact(r,e))return!1;if(this._holes.length!==n._holes.length)return!1;for(var i=0;i<this._holes.length;i++)if(!this._holes[i].equalsExact(n._holes[i],e))return!1;return!0},s.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);he.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var r=new Array(e.getCoordinates().length-1).fill(null),i=(ct.arraycopy(e.getCoordinates(),0,r,0,r.length),c.minCoordinate(e.getCoordinates()));c.scroll(r,i),ct.arraycopy(r,0,e.getCoordinates(),0,r.length),e.getCoordinates()[r.length]=r[0],m.isCCW(e.getCoordinates())===n&&c.reverse(e.getCoordinates())}},s.prototype.getCoordinate=function(){return this._shell.getCoordinate()},s.prototype.getNumInteriorRing=function(){return this._holes.length},s.prototype.getBoundaryDimension=function(){return 1},s.prototype.getDimension=function(){return 2},s.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},s.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},s.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},s.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},s.prototype.compareToSameClass=function(){if(1===arguments.length)return t=this._shell,r=arguments[0]._shell,t.compareToSameClass(r);if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t,r=this._shell,t=n._shell,r=r.compareToSameClass(t,e);if(0!==r)return r;for(var i=this.getNumInteriorRing(),o=n.getNumInteriorRing(),s=0;s<i&&s<o;){var a=this.getInteriorRingN(s),u=n.getInteriorRingN(s),a=a.compareToSameClass(u,e);if(0!==a)return a;s++}return s<i?1:s<o?-1:0}},s.prototype.apply=function(t){if(g(t,Tt)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(g(t,de)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(g(t,fe))t.filter(this);else if(g(t,Pt)){t.filter(this),this._shell.apply(t);for(var r=0;r<this._holes.length;r++)this._holes[r].apply(t)}},s.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},s.prototype.clone=function(){var t=Re.prototype.clone.call(this);t._shell=this._shell.clone(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].clone();return t},s.prototype.getGeometryType=function(){return"Polygon"},s.prototype.copy=function(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),n=0;n<e.length;n++)e[n]=this._holes[n].copy();return new s(t,e,this._factory)},s.prototype.getExteriorRing=function(){return this._shell},s.prototype.isEmpty=function(){return this._shell.isEmpty()},s.prototype.getInteriorRingN=function(t){return this._holes[t]},s.prototype.interfaces_=function(){return[Ce]},s.prototype.getClass=function(){return s},t.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(s,t);var Le,Pe,Te,Re,De=s,Fe=((Te=ve)&&(ze.__proto__=Te),t={serialVersionUID:{configurable:!0}},((ze.prototype=Object.create(Te&&Te.prototype)).constructor=ze).prototype.getSortIndex=function(){return _.SORTINDEX_MULTIPOINT},ze.prototype.isValid=function(){return!0},ze.prototype.equalsExact=function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1],!!this.isEquivalentClass(t)&&Te.prototype.equalsExact.call(this,t,e)):Te.prototype.equalsExact.apply(this,arguments)},ze.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():Te.prototype.getCoordinate.apply(this,arguments)},ze.prototype.getBoundaryDimension=function(){return r.FALSE},ze.prototype.getDimension=function(){return 0},ze.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},ze.prototype.getGeometryType=function(){return"MultiPoint"},ze.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new ze(t,this._factory)},ze.prototype.interfaces_=function(){return[Se]},ze.prototype.getClass=function(){return ze},t.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(ze,t),ze),je=((Pe=Oe)&&(Ge.__proto__=Pe),t={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}},((Ge.prototype=Object.create(Pe&&Pe.prototype)).constructor=Ge).prototype.getSortIndex=function(){return _.SORTINDEX_LINEARRING},Ge.prototype.getBoundaryDimension=function(){return r.FALSE},Ge.prototype.isClosed=function(){return!!this.isEmpty()||Pe.prototype.isClosed.call(this)},Ge.prototype.reverse=function(){var t=this._points.copy();return Ee.reverse(t),this.getFactory().createLinearRing(t)},Ge.prototype.validateConstruction=function(){if(!this.isEmpty()&&!Pe.prototype.isClosed.call(this))throw new p("Points of LinearRing do not form a closed linestring");if(1<=this.getCoordinateSequence().size()&&this.getCoordinateSequence().size()<Ge.MINIMUM_VALID_SIZE)throw new p("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},Ge.prototype.getGeometryType=function(){return"LinearRing"},Ge.prototype.copy=function(){return new Ge(this._points.copy(),this._factory)},Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge},t.MINIMUM_VALID_SIZE.get=function(){return 4},t.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(Ge,t),Ge),qe=((Le=ve)&&(Be.__proto__=Le),t={serialVersionUID:{configurable:!0}},((Be.prototype=Object.create(Le&&Le.prototype)).constructor=Be).prototype.getSortIndex=function(){return _.SORTINDEX_MULTIPOLYGON},Be.prototype.equalsExact=function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1],!!this.isEquivalentClass(t)&&Le.prototype.equalsExact.call(this,t,e)):Le.prototype.equalsExact.apply(this,arguments)},Be.prototype.getBoundaryDimension=function(){return 1},Be.prototype.getDimension=function(){return 2},Be.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},Be.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new b,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),r=0;r<n.getNumGeometries();r++)t.add(n.getGeometryN(r));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))},Be.prototype.getGeometryType=function(){return"MultiPolygon"},Be.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Be(t,this._factory)},Be.prototype.interfaces_=function(){return[Ce]},Be.prototype.getClass=function(){return Be},t.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(Be,t),Be),t={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};function Be(){Le.apply(this,arguments)}function Ge(t,e){t instanceof v&&e instanceof w&&(t=e.getCoordinateSequenceFactory().create(t)),Pe.call(this,t,e),this.validateConstruction()}function ze(){Te.apply(this,arguments)}function s(t,e,n){if(Re.call(this,n),this._shell=null,(this._holes=null)===t&&(t=this.getFactory().createLinearRing()),Re.hasNullElements(e=null===e?[]:e))throw new p("holes must not contain null elements");if(t.isEmpty()&&Re.hasNonEmptyElements(e))throw new p("shell is empty but holes are not");this._shell=t,this._holes=e}Me.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},Me.prototype.edit=function(t,e){return null===t?null:(e=this.editInternal(t,e),this._isUserDataCopied&&e.setUserData(t.getUserData()),e)},Me.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof ve?this.editGeometryCollection(t,e):t instanceof De?this.editPolygon(t,e):t instanceof Ae||t instanceof Oe?e.edit(t,this._factory):(y.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},Me.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),r=new b,i=0;i<n.getNumGeometries();i++){var o=this.edit(n.getGeometryN(i),e);null===o||o.isEmpty()||r.add(o)}return n.getClass()===Fe?this._factory.createMultiPoint(r.toArray([])):n.getClass()===_e?this._factory.createMultiLineString(r.toArray([])):n.getClass()===qe?this._factory.createMultiPolygon(r.toArray([])):this._factory.createGeometryCollection(r.toArray([]))},Me.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if((n=null===n?this._factory.createPolygon(null):n).isEmpty())return n;t=this.edit(n.getExteriorRing(),e);if(null===t||t.isEmpty())return this._factory.createPolygon();for(var r=new b,i=0;i<n.getNumInteriorRing();i++){var o=this.edit(n.getInteriorRingN(i),e);null===o||o.isEmpty()||r.add(o)}return this._factory.createPolygon(t,r.toArray([]))},Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me},Me.GeometryEditorOperation=function(){},t.NoOpGeometryOperation.get=function(){return Xe},t.CoordinateOperation.get=function(){return Ye},t.CoordinateSequenceOperation.get=function(){return Je},Object.defineProperties(Me,t);function Ue(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new v}else if(g(arguments[0],d)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)this._coordinates[r]=n.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var i=arguments[0],o=arguments[1];this._coordinates=i,this._dimension=o,null===i&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],o=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=o;for(var a=0;a<s;a++)this._coordinates[a]=new v}}function Ve(){}function a(){var t;this._modelType=null,this._scale=null,0===arguments.length?this._modelType=a.FLOATING:1===arguments.length&&(arguments[0]instanceof rn?(this._modelType=arguments[0])===a.FIXED&&this.setScale(1):"number"==typeof arguments[0]?(t=arguments[0],this._modelType=a.FIXED,this.setScale(t)):arguments[0]instanceof a&&(this._modelType=(t=arguments[0])._modelType,this._scale=t._scale))}var $e,Xe=function(){},Ye=(Xe.prototype.edit=function(t,e){return t},Xe.prototype.interfaces_=function(){return[Me.GeometryEditorOperation]},Xe.prototype.getClass=function(){return Xe},function(){}),Je=(Ye.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof je?e.createLinearRing(n):t instanceof Oe?e.createLineString(n):t instanceof Ae?0<n.length?e.createPoint(n[0]):e.createPoint():t},Ye.prototype.interfaces_=function(){return[Me.GeometryEditorOperation]},Ye.prototype.getClass=function(){return Ye},function(){}),t=(Je.prototype.edit=function(t,e){return t instanceof je?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Oe?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Ae?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},Je.prototype.interfaces_=function(){return[Me.GeometryEditorOperation]},Je.prototype.getClass=function(){return Je},{serialVersionUID:{configurable:!0}}),t=(Ue.prototype.setOrdinate=function(t,e,n){switch(e){case d.X:this._coordinates[t].x=n;break;case d.Y:this._coordinates[t].y=n;break;case d.Z:this._coordinates[t].z=n;break;default:throw new p("invalid ordinateIndex")}},Ue.prototype.size=function(){return this._coordinates.length},Ue.prototype.getOrdinate=function(t,e){switch(e){case d.X:return this._coordinates[t].x;case d.Y:return this._coordinates[t].y;case d.Z:return this._coordinates[t].z}return l.NaN},Ue.prototype.getCoordinate=function(){var t,e;if(1===arguments.length)return this._coordinates[arguments[0]];2===arguments.length&&(t=arguments[0],(e=arguments[1]).x=this._coordinates[t].x,e.y=this._coordinates[t].y,e.z=this._coordinates[t].z)},Ue.prototype.getCoordinateCopy=function(t){return new v(this._coordinates[t])},Ue.prototype.getDimension=function(){return this._dimension},Ue.prototype.getX=function(t){return this._coordinates[t].x},Ue.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Ue(t,this._dimension)},Ue.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Ue.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Ue(t,this._dimension)},Ue.prototype.toString=function(){if(0<this._coordinates.length){var t=new ot(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Ue.prototype.getY=function(t){return this._coordinates[t].y},Ue.prototype.toCoordinateArray=function(){return this._coordinates},Ue.prototype.interfaces_=function(){return[d,F]},Ue.prototype.getClass=function(){return Ue},t.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Ue,t),{serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}}),We=(Ve.prototype.readResolve=function(){return Ve.instance()},Ve.prototype.create=function(){var t,e;return 1===arguments.length?arguments[0]instanceof Array||g(arguments[0],d)?new Ue(arguments[0]):void 0:2===arguments.length?(t=arguments[0],(e=3<(e=arguments[1])?3:e)<2?new Ue(t):new Ue(t,e)):void 0},Ve.prototype.interfaces_=function(){return[rt,F]},Ve.prototype.getClass=function(){return Ve},Ve.instance=function(){return Ve.instanceObject},t.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},t.instanceObject.get=function(){return new Ve},Object.defineProperties(Ve,t),($e=te)&&(He.__proto__=$e),((He.prototype=Object.create($e&&$e.prototype)).constructor=He).prototype.get=function(t){return this.map_.get(t)||null},He.prototype.put=function(t,e){return this.map_.set(t,e),e},He.prototype.values=function(){for(var t=new b,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},He.prototype.entrySet=function(){var e=new ae;return this.map_.entries().forEach(function(t){return e.add(t)}),e},He.prototype.size=function(){return this.map_.size()},He),t={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};function He(){$e.call(this),this.map_=new Map}a.prototype.equals=function(t){return t instanceof a&&this._modelType===t._modelType&&this._scale===t._scale},a.prototype.compareTo=function(t){var e=this.getMaximumSignificantDigits(),t=t.getMaximumSignificantDigits();return new st(e).compareTo(new st(t))},a.prototype.getScale=function(){return this._scale},a.prototype.isFloating=function(){return this._modelType===a.FLOATING||this._modelType===a.FLOATING_SINGLE},a.prototype.getType=function(){return this._modelType},a.prototype.toString=function(){var t="UNKNOWN";return this._modelType===a.FLOATING?t="Floating":this._modelType===a.FLOATING_SINGLE?t="Floating-Single":this._modelType===a.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},a.prototype.makePrecise=function(){if("number"==typeof arguments[0])return!l.isNaN(t=arguments[0])&&this._modelType!==a.FLOATING_SINGLE&&this._modelType===a.FIXED?Math.round(t*this._scale)/this._scale:t;if(arguments[0]instanceof v){var t=arguments[0];if(this._modelType===a.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}},a.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===a.FLOATING?t=16:this._modelType===a.FLOATING_SINGLE?t=6:this._modelType===a.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},a.prototype.setScale=function(t){this._scale=Math.abs(t)},a.prototype.interfaces_=function(){return[F,tt]},a.prototype.getClass=function(){return a},a.mostPrecise=function(t,e){return 0<=t.compareTo(e)?t:e},t.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},t.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(a,t);function Ke(t){this.geometryFactory=t||new w}function Qe(t){this.geometryFactory=t||new w,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ke(this.geometryFactory)}function Ze(){this.parser=new Ke(this.geometryFactory)}function x(){}function tn(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}function en(){this.array_=[]}var nn,rn=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},t={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}},w=(rn.prototype.readResolve=function(){return rn.nameToTypeMap.get(this._name)},rn.prototype.toString=function(){return this._name},rn.prototype.interfaces_=function(){return[F]},rn.prototype.getClass=function(){return rn},t.serialVersionUID.get=function(){return-552860263173159e4},t.nameToTypeMap.get=function(){return new We},Object.defineProperties(rn,t),a.Type=rn,a.FIXED=new rn("FIXED"),a.FLOATING=new rn("FLOATING"),a.FLOATING_SINGLE=new rn("FLOATING SINGLE"),function t(){this._precisionModel=new a,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0!==arguments.length&&(1===arguments.length?g(arguments[0],rt)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof a&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))}),t={serialVersionUID:{configurable:!0}},on=(w.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new v(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new v(t.getMinX(),t.getMinY()),new v(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new v(t.getMinX(),t.getMinY()),new v(t.getMinX(),t.getMaxY()),new v(t.getMaxX(),t.getMaxY()),new v(t.getMaxX(),t.getMinY()),new v(t.getMinX(),t.getMinY())]),null)},w.prototype.createLineString=function(t){return t?t instanceof Array?new Oe(this.getCoordinateSequenceFactory().create(t),this):g(t,d)?new Oe(t,this):void 0:new Oe(this.getCoordinateSequenceFactory().create([]),this)},w.prototype.createMultiLineString=function(){return 0===arguments.length?new _e(null,this):1===arguments.length?new _e(arguments[0],this):void 0},w.prototype.buildGeometry=function(t){for(var e=null,n=!1,r=!1,i=t.iterator();i.hasNext();){var o=i.next(),s=o.getClass();s!==(e=null===e?s:e)&&(n=!0),o.isGeometryCollectionOrDerived()&&(r=!0)}if(null===e)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(w.toGeometryArray(t));var a=t.iterator().next();if(1<t.size()){if(a instanceof De)return this.createMultiPolygon(w.toPolygonArray(t));if(a instanceof Oe)return this.createMultiLineString(w.toLineStringArray(t));if(a instanceof Ae)return this.createMultiPoint(w.toPointArray(t));y.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},w.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},w.prototype.createPoint=function(){var t;return 0===arguments.length?this.createPoint(this.getCoordinateSequenceFactory().create([])):1===arguments.length?arguments[0]instanceof v?this.createPoint(null!==(t=arguments[0])?this.getCoordinateSequenceFactory().create([t]):null):g(arguments[0],d)?new Ae(arguments[0],this):void 0:void 0},w.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},w.prototype.createPolygon=function(){return 0===arguments.length?new De(null,null,this):1===arguments.length?g(arguments[0],d)||arguments[0]instanceof Array?this.createPolygon(this.createLinearRing(arguments[0])):arguments[0]instanceof je?this.createPolygon(arguments[0],null):void 0:2===arguments.length?new De(arguments[0],arguments[1],this):void 0},w.prototype.getSRID=function(){return this._SRID},w.prototype.createGeometryCollection=function(){return 0===arguments.length?new ve(null,this):1===arguments.length?new ve(arguments[0],this):void 0},w.prototype.createGeometry=function(t){return new Me(this).edit(t,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})},w.prototype.getPrecisionModel=function(){return this._precisionModel},w.prototype.createLinearRing=function(){var t;return 0===arguments.length?this.createLinearRing(this.getCoordinateSequenceFactory().create([])):1===arguments.length?arguments[0]instanceof Array?this.createLinearRing(null!==(t=arguments[0])?this.getCoordinateSequenceFactory().create(t):null):g(arguments[0],d)?new je(arguments[0],this):void 0:void 0},w.prototype.createMultiPolygon=function(){return 0===arguments.length?new qe(null,this):1===arguments.length?new qe(arguments[0],this):void 0},w.prototype.createMultiPoint=function(){if(0===arguments.length)return new Fe(null,this);if(1===arguments.length){var t;if(arguments[0]instanceof Array)return new Fe(arguments[0],this);if(arguments[0]instanceof Array)return this.createMultiPoint(null!==(t=arguments[0])?this.getCoordinateSequenceFactory().create(t):null);if(g(arguments[0],d)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),r=0;r<e.size();r++){var i=this.getCoordinateSequenceFactory().create(1,e.getDimension());Ee.copy(e,r,i,0,1),n[r]=this.createPoint(i)}return this.createMultiPoint(n)}}},w.prototype.interfaces_=function(){return[F]},w.prototype.getClass=function(){return w},w.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},w.toGeometryArray=function(t){var e;return null===t?null:(e=new Array(t.size()).fill(null),t.toArray(e))},w.getDefaultCoordinateSequenceFactory=function(){return Ve.instance()},w.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},w.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},w.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},w.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},w.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},w.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},w.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},t.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(w,t),["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"]),sn=(Ke.prototype.read=function(t){var e=(t="string"==typeof t?JSON.parse(t):t).type;if(sn[e])return-1!==on.indexOf(e)?sn[e].apply(this,[t.coordinates]):"GeometryCollection"===e?sn[e].apply(this,[t.geometries]):sn[e].apply(this,[t]);throw new Error("Unknown GeoJSON type: "+t.type)},Ke.prototype.write=function(t){var e=t.getGeometryType();if(an[e])return an[e].apply(this,[t]);throw new Error("Geometry is not supported")},{Feature:function(t){var e,n={};for(e in t)n[e]=t[e];if(t.geometry){var r=t.geometry.type;if(!sn[r])throw new Error("Unknown GeoJSON type: "+t.type);n.geometry=this.read(t.geometry)}return t.bbox&&(n.bbox=sn.bbox.apply(this,[t.bbox])),n},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new v(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new v(t[0],t[1]),new v(t[2],t[1]),new v(t[2],t[3]),new v(t[0],t[3]),new v(t[0],t[1])])},Point:function(t){t=new v(t[0],t[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(sn.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){t=sn.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(t)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(sn.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=sn.coordinates.apply(this,[t[0]]),e=this.geometryFactory.createLinearRing(e),n=[],r=1;r<t.length;++r){var i=t[r],i=sn.coordinates.apply(this,[i]),i=this.geometryFactory.createLinearRing(i);n.push(i)}return this.geometryFactory.createPolygon(e,n)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(sn.Polygon.apply(this,[r]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}}),an={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:an.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],r=an.Point.apply(this,[r]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),r=0;r<n.length;++r){var i=n[r];e.push(an.coordinate.apply(this,[i]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],r=an.LineString.apply(this,[r]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=an.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var r=0;r<t._holes.length;++r){var i=t._holes[r],i=an.LineString.apply(this,[i]);e.push(i.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],r=an.Polygon.apply(this,[r]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=r.getGeometryType();e.push(an[i].apply(this,[r]))}return{type:"GeometryCollection",geometries:e}}},t=(Qe.prototype.read=function(t){t=this.parser.read(t);return this.precisionModel.getType()===a.FIXED&&this.reducePrecision(t),t},Qe.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])},Ze.prototype.write=function(t){return this.parser.write(t)},{ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}}),un=(x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x.opposite=function(t){return t===x.LEFT?x.RIGHT:t===x.RIGHT?x.LEFT:t},t.ON.get=function(){return 0},t.LEFT.get=function(){return 1},t.RIGHT.get=function(){return 2},Object.defineProperties(x,t),(W.prototype=new Error).name="EmptyStackException",(H.prototype=new Vt).add=function(t){return this.array_.push(t),!0},H.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},H.prototype.push=function(t){return this.array_.push(t),t},H.prototype.pop=function(t){if(0===this.array_.length)throw new W;return this.array_.pop()},H.prototype.peek=function(){if(0===this.array_.length)throw new W;return this.array_[this.array_.length-1]},H.prototype.empty=function(){return 0===this.array_.length},H.prototype.isEmpty=function(){return this.empty()},H.prototype.search=function(t){return this.array_.indexOf(t)},H.prototype.size=function(){return this.array_.length},H.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},tn.prototype.getCoordinate=function(){return this._minCoord},tn.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return(n=n<0?this.getRightmostSideOfSegment(t,e-1):n)<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},tn.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates(),e=(y.isTrue(0<this._minIndex&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge"),t[this._minIndex-1]),t=t[this._minIndex+1],n=m.computeOrientation(this._minCoord,t,e),r=!1;(r=e.y<this._minCoord.y&&t.y<this._minCoord.y&&n===m.COUNTERCLOCKWISE||e.y>this._minCoord.y&&t.y>this._minCoord.y&&n===m.CLOCKWISE?!0:r)&&(this._minIndex=this._minIndex-1)},tn.prototype.getRightmostSideOfSegment=function(t,e){var n,t=t.getEdge().getCoordinates();return e<0||e+1>=t.length||t[e].y===t[e+1].y?-1:(n=x.LEFT,t[e].y<t[e+1].y?x.RIGHT:n)},tn.prototype.getEdge=function(){return this._orientedDe},tn.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},tn.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},tn.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}y.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===x.LEFT&&(this._orientedDe=this._minDe.getSym())},tn.prototype.interfaces_=function(){return[]},tn.prototype.getClass=function(){return tn},(nn=Et)&&(ln.__proto__=nn),((ln.prototype=Object.create(nn&&nn.prototype)).constructor=ln).prototype.getCoordinate=function(){return this.pt},ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln},ln.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},ln);function ln(t,e){nn.call(this,ln.msgWithCoord(t,e)),this.pt=e?new v(e):null,this.name="TopologyException"}en.prototype.addLast=function(t){this.array_.push(t)},en.prototype.removeFirst=function(){return this.array_.shift()},en.prototype.isEmpty=function(){return 0===this.array_.length};function cn(){this._finder=null,this._dirEdgeList=new b,this._nodes=new b,this._rightMostCoord=null,this._env=null,this._finder=new tn}function E(){var t,e;if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[x.ON]=n}else if(arguments[0]instanceof E){var r=arguments[0];if(this.init(r.location.length),null!==r)for(var i=0;i<this.location.length;i++)this.location[i]=r.location[i]}}else 3===arguments.length&&(n=arguments[0],t=arguments[1],e=arguments[2],this.init(3),this.location[x.ON]=n,this.location[x.LEFT]=t,this.location[x.RIGHT]=e)}function S(){var t,e,n,r;this.elt=new Array(2).fill(null),1===arguments.length?Number.isInteger(arguments[0])?(this.elt[0]=new E(t=arguments[0]),this.elt[1]=new E(t)):arguments[0]instanceof S&&(this.elt[0]=new E((t=arguments[0]).elt[0]),this.elt[1]=new E(t.elt[1])):2===arguments.length?(t=arguments[0],e=arguments[1],this.elt[0]=new E(h.NONE),this.elt[1]=new E(h.NONE),this.elt[t].setLocation(e)):3===arguments.length?(this.elt[0]=new E(t=arguments[0],e=arguments[1],n=arguments[2]),this.elt[1]=new E(t,e,n)):4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],this.elt[0]=new E(h.NONE,h.NONE,h.NONE),this.elt[1]=new E(h.NONE,h.NONE,h.NONE),this.elt[t].setLocations(e,n,r))}function pn(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new b,this._pts=new b,this._label=new S(h.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new b,this._geometryFactory=null;var t=arguments[0];this._geometryFactory=arguments[1],this.computePoints(t),this.computeRing()}cn.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},cn.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},cn.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var r=n.next();if(r.isVisited()||r.getSym().isVisited()){e=r;break}}if(null===e)throw new un("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var i=t.getEdges().iterator();i.hasNext();){var o=i.next();o.setVisited(!0),this.copySymDepths(o)}},cn.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(x.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},cn.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},cn.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();1<=e.getDepth(x.RIGHT)&&e.getDepth(x.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},cn.prototype.computeDepths=function(t){var e=new ae,n=new en,r=t.getNode();for(n.addLast(r),e.add(r),t.setVisited(!0);!n.isEmpty();){var i=n.removeFirst();e.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var s=o.next().getSym();s.isVisited()||(s=s.getNode(),e.contains(s))||(n.addLast(s),e.add(s))}}},cn.prototype.compareTo=function(t){return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0},cn.prototype.getEnvelope=function(){if(null===this._env){for(var t=new u,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),r=0;r<n.length-1;r++)t.expandToInclude(n[r]);this._env=t}return this._env},cn.prototype.addReachable=function(t){var e=new H;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},cn.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(x.LEFT,t.getDepth(x.RIGHT)),e.setDepth(x.RIGHT,t.getDepth(x.LEFT))},cn.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var r=n.next(),r=(this._dirEdgeList.add(r),r.getSym().getNode());r.isVisited()||e.push(r)}},cn.prototype.getNodes=function(){return this._nodes},cn.prototype.getDirectedEdges=function(){return this._dirEdgeList},cn.prototype.interfaces_=function(){return[tt]},cn.prototype.getClass=function(){return cn},E.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},E.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==h.NONE)return!1;return!0},E.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===h.NONE&&(this.location[e]=t)},E.prototype.isLine=function(){return 1===this.location.length},E.prototype.merge=function(t){var e;t.location.length>this.location.length&&((e=new Array(3).fill(null))[x.ON]=this.location[x.ON],e[x.LEFT]=h.NONE,e[x.RIGHT]=h.NONE,this.location=e);for(var n=0;n<this.location.length;n++)this.location[n]===h.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},E.prototype.getLocations=function(){return this.location},E.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[x.LEFT];this.location[x.LEFT]=this.location[x.RIGHT],this.location[x.RIGHT]=t},E.prototype.toString=function(){var t=new ot;return 1<this.location.length&&t.append(h.toLocationSymbol(this.location[x.LEFT])),t.append(h.toLocationSymbol(this.location[x.ON])),1<this.location.length&&t.append(h.toLocationSymbol(this.location[x.RIGHT])),t.toString()},E.prototype.setLocations=function(t,e,n){this.location[x.ON]=t,this.location[x.LEFT]=e,this.location[x.RIGHT]=n},E.prototype.get=function(t){return t<this.location.length?this.location[t]:h.NONE},E.prototype.isArea=function(){return 1<this.location.length},E.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===h.NONE)return!0;return!1},E.prototype.setLocation=function(){1===arguments.length?this.setLocation(x.ON,arguments[0]):2===arguments.length&&(this.location[arguments[0]]=arguments[1])},E.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(h.NONE)},E.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},E.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},E.prototype.interfaces_=function(){return[]},E.prototype.getClass=function(){return E},S.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},S.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},S.prototype.isNull=function(t){return this.elt[t].isNull()},S.prototype.setAllLocationsIfNull=function(){var t;1===arguments.length?(this.setAllLocationsIfNull(0,t=arguments[0]),this.setAllLocationsIfNull(1,t)):2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])},S.prototype.isLine=function(t){return this.elt[t].isLine()},S.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new E(t.elt[e]):this.elt[e].merge(t.elt[e])},S.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},S.prototype.getLocation=function(){return 1===arguments.length?this.elt[arguments[0]].get(x.ON):2===arguments.length?this.elt[arguments[0]].get(arguments[1]):void 0},S.prototype.toString=function(){var t=new ot;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},S.prototype.isArea=function(){return 0===arguments.length?this.elt[0].isArea()||this.elt[1].isArea():1===arguments.length?this.elt[arguments[0]].isArea():void 0},S.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},S.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(x.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])},S.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},S.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},S.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new E(this.elt[t].location[0]))},S.prototype.interfaces_=function(){return[]},S.prototype.getClass=function(){return S},S.toLineLabel=function(t){for(var e=new S(h.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};function hn(){this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length&&(this._label=arguments[0])}pn.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=m.isCCW(this._ring.getCoordinates())},pn.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},pn.prototype.computePoints=function(t){var e=this._startDe=t,n=!0;do{if(null===e)throw new un("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new un("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var r=e.getLabel()}while(y.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),(e=this.getNext(e))!==this._startDe)},pn.prototype.getLinearRing=function(){return this._ring},pn.prototype.getCoordinate=function(t){return this._pts.get(t)},pn.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this)}while(e>this._maxNodeDegree&&(this._maxNodeDegree=e),(t=this.getNext(t))!==this._startDe);this._maxNodeDegree*=2},pn.prototype.addPoints=function(t,e,n){var r=t.getCoordinates();if(e)for(var t=1,i=t=n?0:t;i<r.length;i++)this._pts.add(r[i]);else for(var e=r.length-2,o=e=n?r.length-1:e;0<=o;o--)this._pts.add(r[o])},pn.prototype.isHole=function(){return this._isHole},pn.prototype.setInResult=function(){for(var t=this._startDe;t.getEdge().setInResult(!0),(t=t.getNext())!==this._startDe;);},pn.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!m.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},pn.prototype.addHole=function(t){this._holes.add(t)},pn.prototype.isShell=function(){return null===this._shell},pn.prototype.getLabel=function(){return this._label},pn.prototype.getEdges=function(){return this._edges},pn.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},pn.prototype.getShell=function(){return this._shell},pn.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else{var e;if(2===arguments.length)return(e=arguments[0].getLocation(t=arguments[1],x.RIGHT))===h.NONE?null:this._label.getLocation(t)===h.NONE?(this._label.setLocation(t,e),null):void 0}},pn.prototype.setShell=function(t){null!==(this._shell=t)&&t.addHole(this)},pn.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},pn.prototype.interfaces_=function(){return[]},pn.prototype.getClass=function(){return pn},(dn=pn)&&(vn.__proto__=dn),((vn.prototype=Object.create(dn&&dn.prototype)).constructor=vn).prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},vn.prototype.getNext=function(t){return t.getNextMin()},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn};var fn,dn,yn=vn,gn=((fn=pn)&&(mn.__proto__=fn),((mn.prototype=Object.create(fn&&fn.prototype)).constructor=mn).prototype.buildMinimalRings=function(){var t,e=new b,n=this._startDe;do{}while(null===n.getMinEdgeRing()&&(t=new yn(n,this._geometryFactory),e.add(t)),(n=n.getNext())!==this._startDe);return e},mn.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},mn.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){for(var t=this._startDe;t.getNode().getEdges().linkMinimalDirectedEdges(this),(t=t.getNext())!==this._startDe;);},mn.prototype.getNext=function(t){return t.getNext()},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn},mn);function mn(){fn.call(this,arguments[0],arguments[1])}function vn(){dn.call(this,arguments[0],arguments[1])}hn.prototype.setVisited=function(t){this._isVisited=t},hn.prototype.setInResult=function(t){this._isInResult=t},hn.prototype.isCovered=function(){return this._isCovered},hn.prototype.isCoveredSet=function(){return this._isCoveredSet},hn.prototype.setLabel=function(t){this._label=t},hn.prototype.getLabel=function(){return this._label},hn.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},hn.prototype.updateIM=function(t){y.isTrue(2<=this._label.getGeometryCount(),"found partial label"),this.computeIM(t)},hn.prototype.isInResult=function(){return this._isInResult},hn.prototype.isVisited=function(){return this._isVisited},hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn};function _n(){this.nodeMap=new X,this.nodeFact=null,this.nodeFact=arguments[0]}(bn=hn)&&(wn.__proto__=bn),((wn.prototype=Object.create(bn&&bn.prototype)).constructor=wn).prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},wn.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},wn.prototype.getCoordinate=function(){return this._coord},wn.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},wn.prototype.computeIM=function(t){},wn.prototype.computeMergedLocation=function(t,e){var n=h.NONE,n=this._label.getLocation(e);return t.isNull(e)||(t=t.getLocation(e),n!==h.BOUNDARY&&(n=t)),n},wn.prototype.setLabel=function(){if(2!==arguments.length)return bn.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this._label?this._label=new S(t,e):this._label.setLocation(t,e)},wn.prototype.getEdges=function(){return this._edges},wn.prototype.mergeLabel=function(){if(arguments[0]instanceof wn)this.mergeLabel(arguments[0]._label);else if(arguments[0]instanceof S)for(var t=arguments[0],e=0;e<2;e++){var n=this.computeMergedLocation(t,e);this._label.getLocation(e)===h.NONE&&this._label.setLocation(e,n)}},wn.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},wn.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=h.NONE,n=null,n=(e=null!==this._label?this._label.getLocation(t):e)===h.BOUNDARY?h.INTERIOR:h.BOUNDARY;this._label.setLocation(t,n)},wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn};var bn,xn=wn;function wn(){bn.call(this),this._coord=null,this._edges=null;var t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new S(0,h.NONE)}_n.prototype.find=function(t){return this.nodeMap.get(t)},_n.prototype.addNode=function(){var t,e;return arguments[0]instanceof v?(null===(e=this.nodeMap.get(t=arguments[0]))&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e):arguments[0]instanceof xn?null===(e=this.nodeMap.get((t=arguments[0]).getCoordinate()))?(this.nodeMap.put(t.getCoordinate(),t),t):(e.mergeLabel(t),e):void 0},_n.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},_n.prototype.iterator=function(){return this.nodeMap.values().iterator()},_n.prototype.values=function(){return this.nodeMap.values()},_n.prototype.getBoundaryNodes=function(t){for(var e=new b,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===h.BOUNDARY&&e.add(r)}return e},_n.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n};function I(){}function En(){var t,e,n,r;this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length?this._edge=arguments[0]:3===arguments.length?(t=arguments[0],e=arguments[1],n=arguments[2],this._edge=t,this.init(e,n),this._label=null):4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],this._edge=t,this.init(e,n),this._label=r)}function Sn(){}var In,t={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}},Nn=(I.prototype.interfaces_=function(){return[]},I.prototype.getClass=function(){return I},I.isNorthern=function(t){return t===I.NE||t===I.NW},I.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},I.commonHalfPlane=function(t,e){var n;return t===e?t:2==(t-e+4)%4?-1:0===(n=t<e?t:e)&&3===(e<t?t:e)?3:n},I.isInHalfPlane=function(t,e){return e===I.SE?t===I.SE||t===I.SW:t===e||t===e+1},I.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new p("Cannot compute the quadrant for point ( "+t+", "+e+" )");return 0<=t?0<=e?I.NE:I.SE:0<=e?I.NW:I.SW}if(arguments[0]instanceof v&&arguments[1]instanceof v){t=arguments[0],e=arguments[1];if(e.x===t.x&&e.y===t.y)throw new p("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?I.NE:I.SE:e.y>=t.y?I.NW:I.SW}},t.NE.get=function(){return 0},t.NW.get=function(){return 1},t.SW.get=function(){return 2},t.SE.get=function(){return 3},Object.defineProperties(I,t),En.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:m.computeOrientation(t._p0,t._p1,this._p1)},En.prototype.getDy=function(){return this._dy},En.prototype.getCoordinate=function(){return this._p0},En.prototype.setNode=function(t){this._node=t},En.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),n=n.substring(r+1);t.print("  "+n+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},En.prototype.compareTo=function(t){return this.compareDirection(t)},En.prototype.getDirectedCoordinate=function(){return this._p1},En.prototype.getDx=function(){return this._dx},En.prototype.getLabel=function(){return this._label},En.prototype.getEdge=function(){return this._edge},En.prototype.getQuadrant=function(){return this._quadrant},En.prototype.getNode=function(){return this._node},En.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},En.prototype.computeLabel=function(t){},En.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=I.quadrant(this._dx,this._dy),y.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},En.prototype.interfaces_=function(){return[tt]},En.prototype.getClass=function(){return En},(In=En)&&(N.__proto__=In),((N.prototype=Object.create(In&&In.prototype)).constructor=N).prototype.getNextMin=function(){return this._nextMin},N.prototype.getDepth=function(t){return this._depth[t]},N.prototype.setVisited=function(t){this._isVisited=t},N.prototype.computeDirectedLabel=function(){this._label=new S(this._edge.getLabel()),this._isForward||this._label.flip()},N.prototype.getNext=function(){return this._next},N.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new un("assigned depths do not match",this.getCoordinate());this._depth[t]=e},N.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,x.LEFT)===h.INTERIOR&&this._label.getLocation(e,x.RIGHT)===h.INTERIOR||(t=!1);return t},N.prototype.setNextMin=function(t){this._nextMin=t},N.prototype.print=function(t){In.prototype.print.call(this,t),t.print(" "+this._depth[x.LEFT]+"/"+this._depth[x.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},N.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},N.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,h.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,h.EXTERIOR);return t&&e&&n},N.prototype.setEdgeRing=function(t){this._edgeRing=t},N.prototype.getMinEdgeRing=function(){return this._minEdgeRing},N.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return t=this._isForward?t:-t},N.prototype.setInResult=function(t){this._isInResult=t},N.prototype.getSym=function(){return this._sym},N.prototype.isForward=function(){return this._isForward},N.prototype.getEdge=function(){return this._edge},N.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},N.prototype.setSym=function(t){this._sym=t},N.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},N.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta(),r=(this._isForward||(n=-n),1),i=(t===x.LEFT&&(r=-1),x.opposite(t)),n=e+n*r;this.setDepth(t,e),this.setDepth(i,n)},N.prototype.getEdgeRing=function(){return this._edgeRing},N.prototype.isInResult=function(){return this._isInResult},N.prototype.setNext=function(t){this._next=t},N.prototype.isVisited=function(){return this._isVisited},N.prototype.interfaces_=function(){return[]},N.prototype.getClass=function(){return N},N.depthFactor=function(t,e){return t===h.EXTERIOR&&e===h.INTERIOR?1:t===h.INTERIOR&&e===h.EXTERIOR?-1:0},N);function N(){var t=arguments[0],e=arguments[1];In.call(this,t),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],(this._isForward=e)?this.init(t.getCoordinate(0),t.getCoordinate(1)):(e=t.getNumPoints()-1,this.init(t.getCoordinate(e),t.getCoordinate(e-1))),this.computeDirectedLabel()}Sn.prototype.createNode=function(t){return new xn(t,null)},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn};function On(){this._edges=new b,this._nodes=null,this._edgeEndList=new b,0===arguments.length?this._nodes=new _n(new Sn):1===arguments.length&&(this._nodes=new _n(arguments[0]))}function Cn(){this._geometryFactory=null,this._shellList=new b,this._geometryFactory=arguments[0]}function kn(){}function An(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e}function Mn(){this._size=null,this._items=null,this._size=0,this._items=new b,this._items.add(null)}function Ln(){}function Pn(){}function Tn(){this._childBoundables=new b,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length&&(this._level=arguments[0])}On.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},On.prototype.find=function(t){return this._nodes.find(t)},On.prototype.addNode=function(){return arguments[0]instanceof xn||arguments[0]instanceof v?this._nodes.addNode(arguments[0]):void 0},On.prototype.getNodeIterator=function(){return this._nodes.iterator()},On.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},On.prototype.debugPrintln=function(t){ct.out.println(t)},On.prototype.isBoundaryNode=function(t,e){var e=this._nodes.find(e);return null!==e&&null!==(e=e.getLabel())&&e.getLocation(t)===h.BOUNDARY},On.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},On.prototype.matchInSameDirection=function(t,e,n,r){return!!t.equals(n)&&m.computeOrientation(t,e,r)===m.COLLINEAR&&I.quadrant(t,e)===I.quadrant(n,r)},On.prototype.getEdgeEnds=function(){return this._edgeEndList},On.prototype.debugPrint=function(t){ct.out.print(t)},On.prototype.getEdgeIterator=function(){return this._edges.iterator()},On.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return r;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return r}return null},On.prototype.insertEdge=function(t){this._edges.add(t)},On.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},On.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=(this._edges.add(n),new Nn(n,!0)),n=new Nn(n,!1);r.setSym(n),n.setSym(r),this.add(r),this.add(n)}},On.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},On.prototype.getNodes=function(){return this._nodes.values()},On.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return r}return null},On.prototype.interfaces_=function(){return[]},On.prototype.getClass=function(){return On},On.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()},Cn.prototype.sortShellsAndHoles=function(t,e,n){for(var r=t.iterator();r.hasNext();){var i=r.next();(i.isHole()?n:e).add(i)}},Cn.prototype.computePolygons=function(t){for(var e=new b,n=t.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);e.add(r)}return e},Cn.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var i=this.findEdgeRingContaining(r,t);if(null===i)throw new un("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(i)}}},Cn.prototype.buildMinimalEdgeRings=function(t,e,n){for(var r=new b,i=t.iterator();i.hasNext();){var o,s,a=i.next();2<a.getMaxNodeDegree()?(a.linkDirectedEdgesForMinimalEdgeRings(),o=a.buildMinimalRings(),null!==(s=this.findShell(o))?(this.placePolygonHoles(s,o),e.add(s)):n.addAll(o)):r.add(a)}return r},Cn.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Cn.prototype.buildMaximalEdgeRings=function(t){for(var e=new b,n=t.iterator();n.hasNext();){var r=n.next();r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()&&(r=new gn(r,this._geometryFactory),e.add(r),r.setInResult())}return e},Cn.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}},Cn.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Cn.prototype.findEdgeRingContaining=function(t,e){for(var t=t.getLinearRing(),n=t.getEnvelopeInternal(),r=t.getCoordinateN(0),i=null,o=null,s=e.iterator();s.hasNext();){var a=s.next(),u=a.getLinearRing(),l=u.getEnvelopeInternal(),c=(null!==i&&(o=i.getLinearRing().getEnvelopeInternal()),!1);(c=l.contains(n)&&m.isPointInRing(r,u.getCoordinates())?!0:c)&&(null===i||o.contains(l))&&(i=a)}return i},Cn.prototype.findShell=function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var i=r.next();i.isHole()||(n=i,e++)}return y.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},Cn.prototype.add=function(){var t,e;1===arguments.length?this.add((e=arguments[0]).getEdgeEnds(),e.getNodes()):2===arguments.length&&(e=arguments[0],On.linkResultDirectedEdges(arguments[1]),e=this.buildMaximalEdgeRings(e),t=new b,e=this.buildMinimalEdgeRings(e,this._shellList,t),this.sortShellsAndHoles(e,this._shellList,t),this.placeFreeHoles(this._shellList,t))},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},kn.prototype.getBounds=function(){},kn.prototype.interfaces_=function(){return[]},kn.prototype.getClass=function(){return kn},An.prototype.getItem=function(){return this._item},An.prototype.getBounds=function(){return this._bounds},An.prototype.interfaces_=function(){return[kn,F]},An.prototype.getClass=function(){return An},Mn.prototype.poll=function(){var t;return this.isEmpty()?null:(t=this._items.get(1),this._items.set(1,this._items.get(this._size)),--this._size,this.reorder(1),t)},Mn.prototype.size=function(){return this._size},Mn.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Mn.prototype.clear=function(){this._size=0,this._items.clear()},Mn.prototype.isEmpty=function(){return 0===this._size},Mn.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Mn.prototype.interfaces_=function(){return[]},Mn.prototype.getClass=function(){return Mn},Ln.prototype.visitItem=function(t){},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Pn.prototype.insert=function(t,e){},Pn.prototype.remove=function(t,e){},Pn.prototype.query=function(){},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn};function Rn(){}function Dn(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()}function Fn(){var t;this._root=null,this._built=!1,this._itemBoundables=new b,this._nodeCapacity=null,0===arguments.length?this._nodeCapacity=Fn.DEFAULT_NODE_CAPACITY:1===arguments.length&&(y.isTrue(1<(t=arguments[0]),"Node capacity must be greater than 1"),this._nodeCapacity=t)}function jn(){}function qn(){}var Bn,Gn,t={serialVersionUID:{configurable:!0}},t=(Tn.prototype.getLevel=function(){return this._level},Tn.prototype.size=function(){return this._childBoundables.size()},Tn.prototype.getChildBoundables=function(){return this._childBoundables},Tn.prototype.addChildBoundable=function(t){y.isTrue(null===this._bounds),this._childBoundables.add(t)},Tn.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Tn.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Tn.prototype.interfaces_=function(){return[kn,F]},Tn.prototype.getClass=function(){return Tn},t.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Tn,t),Rn.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Rn.min=function(t){return Rn.sort(t),t.get(0)},Rn.sort=function(t,e){var n=t.toArray();e?he.sort(n,e):he.sort(n);for(var r=t.iterator(),i=0,o=n.length;i<o;i++)r.next(),r.set(n[i])},Rn.singletonList=function(t){var e=new b;return e.add(t),e},Dn.prototype.expandToQueue=function(t,e){var n=Dn.isComposite(this._boundable1),r=Dn.isComposite(this._boundable2);if(n&&r)return Dn.area(this._boundable1)>Dn.area(this._boundable2)?this.expand(this._boundable1,this._boundable2,t,e):this.expand(this._boundable2,this._boundable1,t,e),null;if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(r)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new p("neither boundable is composite")},Dn.prototype.isLeaves=function(){return!(Dn.isComposite(this._boundable1)||Dn.isComposite(this._boundable2))},Dn.prototype.compareTo=function(t){return this._distance<t._distance?-1:this._distance>t._distance?1:0},Dn.prototype.expand=function(t,e,n,r){for(var i=t.getChildBoundables().iterator();i.hasNext();){var o=i.next(),o=new Dn(o,e,this._itemDistance);o.getDistance()<r&&n.add(o)}},Dn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},Dn.prototype.getDistance=function(){return this._distance},Dn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Dn.prototype.interfaces_=function(){return[tt]},Dn.prototype.getClass=function(){return Dn},Dn.area=function(t){return t.getBounds().getArea()},Dn.isComposite=function(t){return t instanceof Tn},{IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}}),zn=(Fn.prototype.getNodeCapacity=function(){return this._nodeCapacity},Fn.prototype.lastNode=function(t){return t.get(t.size()-1)},Fn.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Tn?t+=this.size(n):n instanceof An&&(t+=1)}return t}},Fn.prototype.removeItem=function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var i=r.next();i instanceof An&&i.getItem()===e&&(n=i)}return null!==n&&(t.getChildBoundables().remove(n),!0)},Fn.prototype.itemsTree=function(){if(0===arguments.length)return this.build(),null===(t=this.itemsTree(this._root))?new b:t;if(1===arguments.length){for(var t=arguments[0],e=new b,n=t.getChildBoundables().iterator();n.hasNext();){var r,i=n.next();i instanceof Tn?null!==(r=this.itemsTree(i))&&e.add(r):i instanceof An?e.add(i.getItem()):y.shouldNeverReachHere()}return e.size()<=0?null:e}},Fn.prototype.insert=function(t,e){y.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new An(t,e))},Fn.prototype.boundablesAtLevel=function(){var t;if(1===arguments.length)return n=arguments[0],t=new b,this.boundablesAtLevel(n,this._root,t),t;if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];if(y.isTrue(-2<e),n.getLevel()===e)r.add(n);else for(var i=n.getChildBoundables().iterator();i.hasNext();){var o=i.next();o instanceof Tn?this.boundablesAtLevel(e,o,r):(y.isTrue(o instanceof An),-1===e&&r.add(o))}return null}},Fn.prototype.query=function(){if(1===arguments.length)return t=arguments[0],this.build(),e=new b,this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e;if(2===arguments.length){var t=arguments[0],e=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e)}else if(3===arguments.length)if(g(arguments[2],Ln)&&arguments[0]instanceof Object&&arguments[1]instanceof Tn)for(var n=arguments[0],t=arguments[1],r=arguments[2],i=t.getChildBoundables(),o=0;o<i.size();o++){var s=i.get(o);this.getIntersectsOp().intersects(s.getBounds(),n)&&(s instanceof Tn?this.query(n,s,r):s instanceof An?r.visitItem(s.getItem()):y.shouldNeverReachHere())}else if(g(arguments[2],Vt)&&arguments[0]instanceof Object&&arguments[1]instanceof Tn)for(var a=arguments[0],e=arguments[1],u=arguments[2],l=e.getChildBoundables(),c=0;c<l.size();c++){var p=l.get(c);this.getIntersectsOp().intersects(p.getBounds(),a)&&(p instanceof Tn?this.query(a,p,u):p instanceof An?u.add(p.getItem()):y.shouldNeverReachHere())}},Fn.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Fn.prototype.getRoot=function(){return this.build(),this._root},Fn.prototype.remove=function(){var t;if(2===arguments.length)return n=arguments[0],t=arguments[1],this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.remove(n,this._root,t);if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=this.removeItem(n,r);if(i)return!0;for(var o=null,s=n.getChildBoundables().iterator();s.hasNext();){var a=s.next();if(this.getIntersectsOp().intersects(a.getBounds(),e)&&a instanceof Tn&&(i=this.remove(e,a,r))){o=a;break}}return null!==o&&o.getChildBoundables().isEmpty()&&n.getChildBoundables().remove(o),i}},Fn.prototype.createHigherLevels=function(t,e){y.isTrue(!t.isEmpty());t=this.createParentBoundables(t,e+1);return 1===t.size()?t.get(0):this.createHigherLevels(t,e+1)},Fn.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Tn&&t<(n=this.depth(n))&&(t=n)}return t+1}},Fn.prototype.createParentBoundables=function(t,e){y.isTrue(!t.isEmpty());var n=new b,t=(n.add(this.createNode(e)),new b(t));Rn.sort(t,this.getComparator());for(var r=t.iterator();r.hasNext();){var i=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(i)}return n},Fn.prototype.isEmpty=function(){return(this._built?this._root:this._itemBoundables).isEmpty()},Fn.prototype.interfaces_=function(){return[F]},Fn.prototype.getClass=function(){return Fn},Fn.compareDoubles=function(t,e){return e<t?1:t<e?-1:0},t.IntersectsOp.get=function(){return zn},t.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},t.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Fn,t),function(){}),Un=(jn.prototype.distance=function(t,e){},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn},(Gn=Fn)&&(O.__proto__=Gn),t={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}},((O.prototype=Object.create(Gn&&Gn.prototype)).constructor=O).prototype.createParentBoundablesFromVerticalSlices=function(t,e){y.isTrue(0<t.length);for(var n=new b,r=0;r<t.length;r++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return n},O.prototype.createNode=function(t){return new Vn(t)},O.prototype.size=function(){return 0===arguments.length?Gn.prototype.size.call(this):Gn.prototype.size.apply(this,arguments)},O.prototype.insert=function(){var t,e;return 2!==arguments.length?Gn.prototype.insert.apply(this,arguments):(t=arguments[0],e=arguments[1],t.isNull()?null:void Gn.prototype.insert.call(this,t,e))},O.prototype.getIntersectsOp=function(){return O.intersectsOp},O.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),i=t.iterator(),o=0;o<e;o++){r[o]=new b;for(var s=0;i.hasNext()&&s<n;){var a=i.next();r[o].add(a),s++}}return r},O.prototype.query=function(){if(1===arguments.length)return Gn.prototype.query.call(this,arguments[0]);2===arguments.length?Gn.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(g(arguments[2],Ln)&&arguments[0]instanceof Object&&arguments[1]instanceof Tn||g(arguments[2],Vt)&&arguments[0]instanceof Object&&arguments[1]instanceof Tn)&&Gn.prototype.query.call(this,arguments[0],arguments[1],arguments[2])},O.prototype.getComparator=function(){return O.yComparator},O.prototype.createParentBoundablesFromVerticalSlice=function(t,e){return Gn.prototype.createParentBoundables.call(this,t,e)},O.prototype.remove=function(){return 2===arguments.length?Gn.prototype.remove.call(this,arguments[0],arguments[1]):Gn.prototype.remove.apply(this,arguments)},O.prototype.depth=function(){return 0===arguments.length?Gn.prototype.depth.call(this):Gn.prototype.depth.apply(this,arguments)},O.prototype.createParentBoundables=function(t,e){y.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),t=new b(t),t=(Rn.sort(t,O.xComparator),this.verticalSlices(t,Math.trunc(Math.ceil(Math.sqrt(n)))));return this.createParentBoundablesFromVerticalSlices(t,e)},O.prototype.nearestNeighbour=function(){var t,e;if(1===arguments.length)return g(arguments[0],jn)?(e=arguments[0],e=new Dn(this.getRoot(),this.getRoot(),e),this.nearestNeighbour(e)):arguments[0]instanceof Dn?this.nearestNeighbour(arguments[0],l.POSITIVE_INFINITY):void 0;if(2===arguments.length){if(arguments[0]instanceof O&&g(arguments[1],jn))return e=arguments[0],n=arguments[1],e=new Dn(this.getRoot(),e.getRoot(),n),this.nearestNeighbour(e);if(arguments[0]instanceof Dn&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1],i=null,o=new Mn;for(o.add(n);!o.isEmpty()&&0<r;){var s=o.poll(),a=s.getDistance();if(r<=a)break;s.isLeaves()?(r=a,i=s):s.expandToQueue(o,r)}return[i.getBoundable(0).getItem(),i.getBoundable(1).getItem()]}}else if(3===arguments.length)return e=arguments[0],n=arguments[1],t=arguments[2],e=new An(e,n),n=new Dn(this.getRoot(),e,t),this.nearestNeighbour(n)[0]},O.prototype.interfaces_=function(){return[Pn,F]},O.prototype.getClass=function(){return O},O.centreX=function(t){return O.avg(t.getMinX(),t.getMaxX())},O.avg=function(t,e){return(t+e)/2},O.centreY=function(t){return O.avg(t.getMinY(),t.getMaxY())},t.STRtreeNode.get=function(){return Vn},t.serialVersionUID.get=function(){return 0x39920f7d5f261e0},t.xComparator.get=function(){return{interfaces_:function(){return[nt]},compare:function(t,e){return Gn.compareDoubles(O.centreX(t.getBounds()),O.centreX(e.getBounds()))}}},t.yComparator.get=function(){return{interfaces_:function(){return[nt]},compare:function(t,e){return Gn.compareDoubles(O.centreY(t.getBounds()),O.centreY(e.getBounds()))}}},t.intersectsOp.get=function(){return{interfaces_:function(){return[Gn.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},t.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(O,t),O),Vn=((Bn=Tn)&&($n.__proto__=Bn),(($n.prototype=Object.create(Bn&&Bn.prototype)).constructor=$n).prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new u(n.getBounds()):t.expandToInclude(n.getBounds())}return t},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},$n);function $n(){Bn.call(this,arguments[0])}function O(t){Gn.call(this,t=t||O.DEFAULT_NODE_CAPACITY)}qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn},qn.relativeSign=function(t,e){return t<e?-1:e<t?1:0},qn.compare=function(t,e,n){if(!e.equals2D(n)){var r=qn.relativeSign(e.x,n.x),i=qn.relativeSign(e.y,n.y);switch(t){case 0:return qn.compareValue(r,i);case 1:return qn.compareValue(i,r);case 2:return qn.compareValue(i,-r);case 3:return qn.compareValue(-r,i);case 4:return qn.compareValue(-r,-i);case 5:return qn.compareValue(-i,-r);case 6:return qn.compareValue(-i,r);case 7:return qn.compareValue(r,-i)}y.shouldNeverReachHere("invalid octant value")}return 0},qn.compareValue=function(t,e){return t<0?-1:0<t?1:e<0?-1:0<e?1:0};function Xn(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._segString=t,this.coord=new v(e),this.segmentIndex=n,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))}function Yn(){this._nodeMap=new X,this._edge=null,this._edge=arguments[0]}function Jn(){}function Wn(){}function Hn(){}Xn.prototype.getCoordinate=function(){return this.coord},Xn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},Xn.prototype.compareTo=function(t){return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:qn.compare(this._segmentOctant,this.coord,t.coord)},Xn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},Xn.prototype.isInterior=function(){return this._isInterior},Xn.prototype.interfaces_=function(){return[tt]},Xn.prototype.getClass=function(){return Xn},Yn.prototype.getSplitCoordinates=function(){var t=new Ht;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(n,r,t),n=r}return t.toCoordinateArray()},Yn.prototype.addCollapsedNodes=function(){var t=new b;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},Yn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Yn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),r=this._edge.getCoordinate(e+2);n.equals2D(r)&&t.add(new st(e+1))}},Yn.prototype.addEdgeCoordinates=function(t,e,n){var r=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(r);n.add(new v(t.coord),!1);for(var i=t.segmentIndex+1;i<=e.segmentIndex;i++)n.add(this._edge.getCoordinate(i));r&&n.add(new v(e.coord))},Yn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Yn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},Yn.prototype.findCollapseIndex=function(t,e,n){var r;return!!t.coord.equals2D(e.coord)&&(r=e.segmentIndex-t.segmentIndex,e.isInterior()||r--,1===r)&&(n[0]=t.segmentIndex+1,!0)},Yn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),r=n.next();n.hasNext();){var i=n.next();this.findCollapseIndex(r,i,e)&&t.add(new st(e[0])),r=i}},Yn.prototype.getEdge=function(){return this._edge},Yn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},Yn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(r),i=(r||n--,new Array(n).fill(null)),o=0;i[o++]=new v(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)i[o++]=this._edge.getCoordinate(s);return r&&(i[o]=new v(e.coord)),new ir(i,this._edge.getData())},Yn.prototype.add=function(t,e){var e=new Xn(this._edge,t,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(e);return null!==n?(y.isTrue(n.coord.equals2D(t),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(e,e),e)},Yn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new Et("bad split edge start point at "+n);n=t.get(t.size()-1).getCoordinates(),t=n[n.length-1];if(!t.equals2D(e[e.length-1]))throw new Et("bad split edge end point at "+t)},Yn.prototype.interfaces_=function(){return[]},Yn.prototype.getClass=function(){return Yn},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn},Jn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new p("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return 0<=t?0<=e?r<=n?0:1:r<=n?7:6:0<=e?r<=n?3:2:r<=n?4:5}if(arguments[0]instanceof v&&arguments[1]instanceof v){t=arguments[0],e=arguments[1],r=e.x-t.x,n=e.y-t.y;if(0==r&&0==n)throw new p("Cannot compute the octant for two identical points "+t);return Jn.octant(r,n)}},Wn.prototype.getCoordinates=function(){},Wn.prototype.size=function(){},Wn.prototype.getCoordinate=function(t){},Wn.prototype.isClosed=function(){},Wn.prototype.setData=function(t){},Wn.prototype.getData=function(){},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};function C(){var t,e,n,r;this.p0=null,this.p1=null,0===arguments.length?(this.p0=new v,this.p1=new v):1===arguments.length?(this.p0=new v((t=arguments[0]).p0),this.p1=new v(t.p1)):2===arguments.length?(this.p0=arguments[0],this.p1=arguments[1]):4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],this.p0=new v(t,e),this.p1=new v(n,r))}function Kn(){this.tempEnv1=new u,this.tempEnv2=new u,this._overlapSeg1=new C,this._overlapSeg2=new C}function Qn(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=r}function Zn(){}function tr(){}function er(){this._segInt=null,0!==arguments.length&&1===arguments.length&&this.setSegmentIntersector(arguments[0])}function k(){var t,e,n,r;this._quadrantSegments=k.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=k.CAP_ROUND,this._joinStyle=k.JOIN_ROUND,this._mitreLimit=k.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=k.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length&&(1===arguments.length?this.setQuadrantSegments(arguments[0]):2===arguments.length?(t=arguments[0],e=arguments[1],this.setQuadrantSegments(t),this.setEndCapStyle(e)):4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],this.setQuadrantSegments(t),this.setEndCapStyle(e),this.setJoinStyle(n),this.setMitreLimit(r)))}Hn.prototype.addIntersection=function(t,e){},Hn.prototype.interfaces_=function(){return[Wn]},Hn.prototype.getClass=function(){return Hn};var nr,rr,ir=function(){this._nodeList=new Yn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e},t=(ir.prototype.getCoordinates=function(){return this._pts},ir.prototype.size=function(){return this._pts.length},ir.prototype.getCoordinate=function(t){return this._pts[t]},ir.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},ir.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},ir.prototype.setData=function(t){this._data=t},ir.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:Jn.octant(t,e)},ir.prototype.getData=function(){return this._data},ir.prototype.addIntersection=function(){var t,e;2===arguments.length?this.addIntersectionNode(arguments[0],arguments[1]):4===arguments.length&&(e=arguments[0],t=arguments[1],e=new v(e.getIntersection(arguments[3])),this.addIntersection(e,t))},ir.prototype.toString=function(){return mt.toLineString(new Ue(this._pts))},ir.prototype.getNodeList=function(){return this._nodeList},ir.prototype.addIntersectionNode=function(t,e){var n,r=e+1;return r<this._pts.length&&(n=this._pts[r],t.equals2D(n))&&(e=r),this._nodeList.add(t,e)},ir.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},ir.prototype.interfaces_=function(){return[Hn]},ir.prototype.getClass=function(){return ir},ir.getNodedSubstrings=function(){var t;if(1===arguments.length)return e=arguments[0],t=new b,ir.getNodedSubstrings(e,t),t;if(2===arguments.length)for(var e=arguments[0],n=arguments[1],r=e.iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)},{serialVersionUID:{configurable:!0}}),or=(C.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},C.prototype.orientationIndex=function(){var t,e;return arguments[0]instanceof C?(t=m.orientationIndex(this.p0,this.p1,(e=arguments[0]).p0),e=m.orientationIndex(this.p0,this.p1,e.p1),0<=t&&0<=e||t<=0&&e<=0?Math.max(t,e):0):arguments[0]instanceof v?m.orientationIndex(this.p0,this.p1,arguments[0]):void 0},C.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},C.prototype.isVertical=function(){return this.p0.x===this.p1.x},C.prototype.equals=function(t){return t instanceof C&&this.p0.equals((t=t).p0)&&this.p1.equals(t.p1)},C.prototype.intersection=function(t){var e=new At;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},C.prototype.project=function(){var t,e,n,r;return arguments[0]instanceof v?(t=arguments[0]).equals(this.p0)||t.equals(this.p1)?new v(t):(t=this.projectionFactor(t),(r=new v).x=this.p0.x+t*(this.p1.x-this.p0.x),r.y=this.p0.y+t*(this.p1.y-this.p0.y),r):arguments[0]instanceof C?(r=this.projectionFactor((t=arguments[0]).p0),e=this.projectionFactor(t.p1),1<=r&&1<=e||r<=0&&e<=0?null:(n=this.project(t.p0),r<0&&(n=this.p0),1<r&&(n=this.p1),r=this.project(t.p1),e<0&&(r=this.p0),1<e&&(r=this.p1),new C(n,r))):void 0},C.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},C.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},C.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},C.prototype.distancePerpendicular=function(t){return m.distancePointLinePerpendicular(t,this.p0,this.p1)},C.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},C.prototype.midPoint=function(){return C.midPoint(this.p0,this.p1)},C.prototype.projectionFactor=function(t){var e,n,r;return t.equals(this.p0)?0:t.equals(this.p1)?1:(r=(e=this.p1.x-this.p0.x)*e+(n=this.p1.y-this.p0.y)*n)<=0?l.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r},C.prototype.closestPoints=function(t){var e,n,r,i=this.intersection(t);return null!==i?[i,i]:(i=new Array(2).fill(null),n=l.MAX_VALUE,e=null,n=(r=this.closestPoint(t.p0)).distance(t.p0),i[0]=r,i[1]=t.p0,(e=(r=this.closestPoint(t.p1)).distance(t.p1))<n&&(n=e,i[0]=r,i[1]=t.p1),(e=(r=t.closestPoint(this.p0)).distance(this.p0))<n&&(n=e,i[0]=this.p0,i[1]=r),(e=(r=t.closestPoint(this.p1)).distance(this.p1))<n&&(n=e,i[0]=this.p1,i[1]=r),i)},C.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return 0<e&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},C.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},C.prototype.getLength=function(){return this.p0.distance(this.p1)},C.prototype.compareTo=function(t){var e=this.p0.compareTo(t.p0);return 0!==e?e:this.p1.compareTo(t.p1)},C.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},C.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},C.prototype.lineIntersection=function(t){try{return yt.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof ft))throw t}return null},C.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},C.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),t=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,o=Math.sqrt(r*r+i*i),s=0,a=0;if(0!==e){if(o<=0)throw new Error("Cannot compute offset from zero-length line segment");s=e*r/o,a=e*i/o}return new v(n-a,t+s)},C.prototype.setCoordinates=function(){var t,e;1===arguments.length?this.setCoordinates((t=arguments[0]).p0,t.p1):2===arguments.length&&(t=arguments[0],e=arguments[1],this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y)},C.prototype.segmentFraction=function(t){t=this.projectionFactor(t);return t<0?t=0:(1<t||l.isNaN(t))&&(t=1),t},C.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},C.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},C.prototype.distance=function(){var t;return arguments[0]instanceof C?m.distanceLineLine(this.p0,this.p1,(t=arguments[0]).p0,t.p1):arguments[0]instanceof v?m.distancePointLine(arguments[0],this.p0,this.p1):void 0},C.prototype.pointAlong=function(t){var e=new v;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},C.prototype.hashCode=function(){var t=l.doubleToLongBits(this.p0.x),t=(t^=31*l.doubleToLongBits(this.p0.y),Math.trunc(t)^Math.trunc(t>>32)),e=l.doubleToLongBits(this.p1.x);return e^=31*l.doubleToLongBits(this.p1.y),t^(Math.trunc(e)^Math.trunc(e>>32))},C.prototype.interfaces_=function(){return[tt,F]},C.prototype.getClass=function(){return C},C.midPoint=function(t,e){return new v((t.x+e.x)/2,(t.y+e.y)/2)},t.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(C,t),Kn.prototype.overlap=function(){var t,e,n,r;2!==arguments.length&&4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(r,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2))},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn},Qn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},Qn.prototype.computeSelect=function(t,e,n,r){var i=this._pts[e],o=this._pts[n];return r.tempEnv1.init(i,o),n-e==1?(r.select(this,e),null):t.intersects(r.tempEnv1)?(e<(i=Math.trunc((e+n)/2))&&this.computeSelect(t,e,i,r),void(i<n&&this.computeSelect(t,i,n,r))):null},Qn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},Qn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},Qn.prototype.setId=function(t){this._id=t},Qn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},Qn.prototype.getEnvelope=function(){var t,e;return null===this._env&&(t=this._pts[this._start],e=this._pts[this._end],this._env=new u(t,e)),this._env},Qn.prototype.getEndIndex=function(){return this._end},Qn.prototype.getStartIndex=function(){return this._start},Qn.prototype.getContext=function(){return this._context},Qn.prototype.getId=function(){return this._id},Qn.prototype.computeOverlapsInternal=function(t,e,n,r,i,o){var s=this._pts[t],a=this._pts[e],u=n._pts[r],l=n._pts[i];return e-t==1&&i-r==1?(o.overlap(this,t,n,r),null):(o.tempEnv1.init(s,a),o.tempEnv2.init(u,l),o.tempEnv1.intersects(o.tempEnv2)?(s=Math.trunc((t+e)/2),a=Math.trunc((r+i)/2),t<s&&(r<a&&this.computeOverlapsInternal(t,s,n,r,a,o),a<i)&&this.computeOverlapsInternal(t,s,n,a,i,o),void(s<e&&(r<a&&this.computeOverlapsInternal(s,e,n,r,a,o),a<i)&&this.computeOverlapsInternal(s,e,n,a,i,o))):null)},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn},Zn.prototype.interfaces_=function(){return[]},Zn.prototype.getClass=function(){return Zn},Zn.getChainStartIndices=function(t){var e=0,n=new b;n.add(new st(e));do{var r=Zn.findChainEnd(t,e)}while(n.add(new st(r)),(e=r)<t.length-1);return Zn.toIntArray(n)},Zn.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=I.quadrant(t[n],t[n+1]),i=e+1;i<t.length&&(t[i-1].equals2D(t[i])||I.quadrant(t[i-1],t[i])===r);)i++;return i-1},Zn.getChains=function(){if(1===arguments.length)return Zn.getChains(arguments[0],null);if(2===arguments.length){for(var t=arguments[0],e=arguments[1],n=new b,r=Zn.getChainStartIndices(t),i=0;i<r.length-1;i++){var o=new Qn(t,r[i],r[i+1],e);n.add(o)}return n}},Zn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},tr.prototype.computeNodes=function(t){},tr.prototype.getNodedSubstrings=function(){},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.prototype.setSegmentIntersector=function(t){this._segInt=t},er.prototype.interfaces_=function(){return[tr]},er.prototype.getClass=function(){return er},(rr=er)&&(ur.__proto__=rr),t={SegmentOverlapAction:{configurable:!0}},((ur.prototype=Object.create(rr&&rr.prototype)).constructor=ur).prototype.getMonotoneChains=function(){return this._monoChains},ur.prototype.getNodedSubstrings=function(){return ir.getNodedSubstrings(this._nodedSegStrings)},ur.prototype.getIndex=function(){return this._index},ur.prototype.add=function(t){for(var e=Zn.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},ur.prototype.computeNodes=function(t){for(var e=(this._nodedSegStrings=t).iterator();e.hasNext();)this.add(e.next());this.intersectChains()},ur.prototype.intersectChains=function(){for(var t=new sr(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),r=this._index.query(n.getEnvelope()).iterator();r.hasNext();){var i=r.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}},ur.prototype.interfaces_=function(){return[]},ur.prototype.getClass=function(){return ur},t.SegmentOverlapAction.get=function(){return sr},Object.defineProperties(ur,t),ur),sr=((nr=Kn)&&(ar.__proto__=nr),((ar.prototype=Object.create(nr&&nr.prototype)).constructor=ar).prototype.overlap=function(){if(4!==arguments.length)return nr.prototype.overlap.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],t=t.getContext(),n=n.getContext();this._si.processIntersections(t,e,n,r)},ar.prototype.interfaces_=function(){return[]},ar.prototype.getClass=function(){return ar},ar),t={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};function ar(){nr.call(this),this._si=null,this._si=arguments[0]}function ur(t){t?rr.call(this,t):rr.call(this),this._monoChains=new b,this._index=new Un,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}k.prototype.getEndCapStyle=function(){return this._endCapStyle},k.prototype.isSingleSided=function(){return this._isSingleSided},k.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=k.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=k.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==k.JOIN_ROUND&&(this._quadrantSegments=k.DEFAULT_QUADRANT_SEGMENTS)},k.prototype.getJoinStyle=function(){return this._joinStyle},k.prototype.setJoinStyle=function(t){this._joinStyle=t},k.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},k.prototype.getSimplifyFactor=function(){return this._simplifyFactor},k.prototype.getQuadrantSegments=function(){return this._quadrantSegments},k.prototype.setEndCapStyle=function(t){this._endCapStyle=t},k.prototype.getMitreLimit=function(){return this._mitreLimit},k.prototype.setMitreLimit=function(t){this._mitreLimit=t},k.prototype.setSingleSided=function(t){this._isSingleSided=t},k.prototype.interfaces_=function(){return[]},k.prototype.getClass=function(){return k},k.bufferDistanceError=function(t){t=Math.PI/2/t;return 1-Math.cos(t/2)},t.CAP_ROUND.get=function(){return 1},t.CAP_FLAT.get=function(){return 2},t.CAP_SQUARE.get=function(){return 3},t.JOIN_ROUND.get=function(){return 1},t.JOIN_MITRE.get=function(){return 2},t.JOIN_BEVEL.get=function(){return 3},t.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},t.DEFAULT_MITRE_LIMIT.get=function(){return 5},t.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(k,t);function lr(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=m.COUNTERCLOCKWISE,this._inputLine=t||null}function cr(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new b}function A(){}function M(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new C,this._seg1=new C,this._offset0=new C,this._offset1=new C,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new At,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),8<=e.getQuadrantSegments()&&e.getJoinStyle()===k.JOIN_ROUND&&(this._closingSegLengthFactor=M.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}function pr(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}function hr(){this._subgraphs=null,this._seg=new C,this._cga=new m,this._subgraphs=arguments[0]}function L(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null}function fr(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new b;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n}function dr(){}function yr(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}function gr(){this._geom=null,this._geom=arguments[0]}function mr(){this._edgeMap=new X,this._edgeList=null,this._ptInAreaLocation=[h.NONE,h.NONE]}function vr(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=vr.orientation(t)}var _r,br,t={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}},t=(lr.prototype.isDeletable=function(t,e,n,r){var i=this._inputLine[t],e=this._inputLine[e],o=this._inputLine[n];return!!this.isConcave(i,e,o)&&!!this.isShallow(i,e,o,r)&&this.isShallowSampled(i,e,t,n,r)},lr.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),r=!1;n<this._inputLine.length;){var i=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=lr.DELETE,r=i=!0),e=this.findNextNonDeletedIndex(t=i?n:e),n=this.findNextNonDeletedIndex(e)}return r},lr.prototype.isShallowConcavity=function(t,e,n,r){return m.computeOrientation(t,e,n)===this._angleOrientation&&m.distancePointLine(e,t,n)<r},lr.prototype.isShallowSampled=function(t,e,n,r,i){var o=Math.trunc((r-n)/lr.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<r;s+=o)if(!this.isShallow(t,e,this._inputLine[s],i))return!1;return!0},lr.prototype.isConcave=function(t,e,n){return m.computeOrientation(t,e,n)===this._angleOrientation},lr.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=m.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);for(;this.deleteShallowConcavities(););return this.collapseLine()},lr.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===lr.DELETE;)e++;return e},lr.prototype.isShallow=function(t,e,n,r){return m.distancePointLine(e,t,n)<r},lr.prototype.collapseLine=function(){for(var t=new Ht,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==lr.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr},lr.simplify=function(t,e){return new lr(t).simplify(e)},t.INIT.get=function(){return 0},t.DELETE.get=function(){return 1},t.KEEP.get=function(){return 1},t.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(lr,t),{COORDINATE_ARRAY_TYPE:{configurable:!0}}),t=(cr.prototype.getCoordinates=function(){return this._ptList.toArray(cr.COORDINATE_ARRAY_TYPE)},cr.prototype.setPrecisionModel=function(t){this._precisionModel=t},cr.prototype.addPt=function(t){t=new v(t);if(this._precisionModel.makePrecise(t),this.isRedundant(t))return null;this._ptList.add(t)},cr.prototype.revere=function(){},cr.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var r=t.length-1;0<=r;r--)this.addPt(t[r])},cr.prototype.isRedundant=function(t){var e;return!(this._ptList.size()<1)&&(e=this._ptList.get(this._ptList.size()-1),t.distance(e)<this._minimimVertexDistance)},cr.prototype.toString=function(){return(new w).createLineString(this.getCoordinates()).toString()},cr.prototype.closeRing=function(){var t,e;return this._ptList.size()<1||(t=new v(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1),t.equals(e))?null:void this._ptList.add(t)},cr.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},t.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(cr,t),{PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}}),t=(A.prototype.interfaces_=function(){return[]},A.prototype.getClass=function(){return A},A.toDegrees=function(t){return 180*t/Math.PI},A.normalize=function(t){for(;t>Math.PI;)t-=A.PI_TIMES_2;for(;t<=-Math.PI;)t+=A.PI_TIMES_2;return t},A.angle=function(){var t,e,n;return 1===arguments.length?(t=arguments[0],Math.atan2(t.y,t.x)):2===arguments.length?(t=arguments[0],e=(n=arguments[1]).x-t.x,n=n.y-t.y,Math.atan2(n,e)):void 0},A.isAcute=function(t,e,n){var r=t.x-e.x,t=t.y-e.y;return 0<r*(n.x-e.x)+t*(n.y-e.y)},A.isObtuse=function(t,e,n){var r=t.x-e.x,t=t.y-e.y;return r*(n.x-e.x)+t*(n.y-e.y)<0},A.interiorAngle=function(t,e,n){t=A.angle(e,t),e=A.angle(e,n);return Math.abs(e-t)},A.normalizePositive=function(t){if(t<0){for(;t<0;)t+=A.PI_TIMES_2;A.PI_TIMES_2<=t&&(t=0)}else{for(;A.PI_TIMES_2<=t;)t-=A.PI_TIMES_2;t<0&&(t=0)}return t},A.angleBetween=function(t,e,n){t=A.angle(e,t),e=A.angle(e,n);return A.diff(t,e)},A.diff=function(t,e){var n=null;return n=(n=t<e?e-t:t-e)>Math.PI?2*Math.PI-n:n},A.toRadians=function(t){return t*Math.PI/180},A.getTurn=function(t,e){e=Math.sin(e-t);return 0<e?A.COUNTERCLOCKWISE:e<0?A.CLOCKWISE:A.NONE},A.angleBetweenOriented=function(t,e,n){t=A.angle(e,t),e=A.angle(e,n)-t;return e<=-Math.PI?e+A.PI_TIMES_2:e>Math.PI?e-A.PI_TIMES_2:e},t.PI_TIMES_2.get=function(){return 2*Math.PI},t.PI_OVER_2.get=function(){return Math.PI/2},t.PI_OVER_4.get=function(){return Math.PI/4},t.COUNTERCLOCKWISE.get=function(){return m.COUNTERCLOCKWISE},t.CLOCKWISE.get=function(){return m.CLOCKWISE},t.NONE.get=function(){return m.COLLINEAR},Object.defineProperties(A,t),{OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}}),t=(M.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var t=m.computeOrientation(this._s0,this._s1,this._s2),n=t===m.CLOCKWISE&&this._side===x.LEFT||t===m.COUNTERCLOCKWISE&&this._side===x.RIGHT;0===t?this.addCollinear(e):n?this.addOutsideTurn(t,e):this.addInsideTurn(t,e)},M.prototype.addLineEndCap=function(t,e){var n=new C(t,e),r=new C,i=(this.computeOffsetSegment(n,x.LEFT,this._distance,r),new C),n=(this.computeOffsetSegment(n,x.RIGHT,this._distance,i),e.x-t.x),t=e.y-t.y,o=Math.atan2(t,n);switch(this._bufParams.getEndCapStyle()){case k.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(e,o+Math.PI/2,o-Math.PI/2,m.CLOCKWISE,this._distance),this._segList.addPt(i.p1);break;case k.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(i.p1);break;case k.CAP_SQUARE:var s=new v,a=(s.x=Math.abs(this._distance)*Math.cos(o),s.y=Math.abs(this._distance)*Math.sin(o),new v(r.p1.x+s.x,r.p1.y+s.y)),s=new v(i.p1.x+s.x,i.p1.y+s.y);this._segList.addPt(a),this._segList.addPt(s)}},M.prototype.getCoordinates=function(){return this._segList.getCoordinates()},M.prototype.addMitreJoin=function(t,e,n,r){var i=!0,o=null;try{o=yt.intersection(e.p0,e.p1,n.p0,n.p1),(r<=0?1:o.distance(t)/Math.abs(r))>this._bufParams.getMitreLimit()&&(i=!1)}catch(t){if(!(t instanceof ft))throw t;o=new v(0,0),i=!1}i?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,r,this._bufParams.getMitreLimit())},M.prototype.addFilletCorner=function(t,e,n,r,i){var o=e.x-t.x,s=e.y-t.y,s=Math.atan2(s,o),o=n.x-t.x,a=n.y-t.y,a=Math.atan2(a,o);r===m.CLOCKWISE?s<=a&&(s+=2*Math.PI):a<=s&&(s-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,s,a,r,i),this._segList.addPt(n)},M.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*M.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===k.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===k.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},M.prototype.createSquare=function(t){this._segList.addPt(new v(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new v(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new v(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new v(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},M.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},M.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},M.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},M.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},M.prototype.addLimitedMitreJoin=function(t,e,n,r){var i=this._seg0.p1,o=A.angle(i,this._seg0.p0),s=A.angleBetweenOriented(this._seg0.p0,i,this._seg1.p1)/2,o=A.normalize(o+s),o=A.normalize(o+Math.PI),r=r*n,n=n-r*Math.abs(Math.sin(s)),s=i.x+r*Math.cos(o),r=i.y+r*Math.sin(o),o=new v(s,r),s=new C(i,o),r=s.pointAlongOffset(1,n),i=s.pointAlongOffset(1,-n);this._side===x.LEFT?(this._segList.addPt(r),this._segList.addPt(i)):(this._segList.addPt(i),this._segList.addPt(r))},M.prototype.computeOffsetSegment=function(t,e,n,r){var e=e===x.LEFT?1:-1,i=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,s=Math.sqrt(i*i+o*o),i=e*n*i/s,e=e*n*o/s;r.p0.x=t.p0.x-e,r.p0.y=t.p0.y+i,r.p1.x=t.p1.x-e,r.p1.y=t.p1.y+i},M.prototype.addFilletArc=function(t,e,n,r,i){var o=r===m.CLOCKWISE?-1:1,s=Math.abs(e-n),r=Math.trunc(s/this._filletAngleQuantum+.5);if(r<1)return null;for(var a=s/r,u=0,l=new v;u<s;){var c=e+o*u;l.x=t.x+i*Math.cos(c),l.y=t.y+i*Math.sin(c),this._segList.addPt(l),u+=a}},M.prototype.addInsideTurn=function(t,e){var n;this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection()?this._segList.addPt(this._li.getIntersection(0)):(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*M.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR?this._segList.addPt(this._offset0.p1):(this._segList.addPt(this._offset0.p1),0<this._closingSegLengthFactor?(n=new v((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1)),this._segList.addPt(n),n=new v((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1)),this._segList.addPt(n)):this._segList.addPt(this._s1),this._segList.addPt(this._offset1.p0)))},M.prototype.createCircle=function(t){var e=new v(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},M.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},M.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new cr,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*M.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},M.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),2<=this._li.getIntersectionNum()&&(this._bufParams.getJoinStyle()===k.JOIN_BEVEL||this._bufParams.getJoinStyle()===k.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,m.CLOCKWISE,this._distance))},M.prototype.closeRing=function(){this._segList.closeRing()},M.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},M.prototype.interfaces_=function(){return[]},M.prototype.getClass=function(){return M},t.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},t.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},t.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},t.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(M,t),pr.prototype.getOffsetCurve=function(t,e){var n;return 0===(this._distance=e)?null:(n=e<0,e=Math.abs(e),e=this.getSegGen(e),t.length<=1?this.computePointCurve(t[0],e):this.computeOffsetCurve(t,n,e),t=e.getCoordinates(),n&&c.reverse(t),t)},pr.prototype.computeSingleSidedBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var i=lr.simplify(t,-r),e=i.length-1;n.initSideSegments(i[e],i[e-1],x.LEFT),n.addFirstSegment();for(var o=e-2;0<=o;o--)n.addNextSegment(i[o],!0)}else{n.addSegments(t,!1);var s=lr.simplify(t,r),a=s.length-1;n.initSideSegments(s[0],s[1],x.LEFT),n.addFirstSegment();for(var u=2;u<=a;u++)n.addNextSegment(s[u],!0)}n.addLastSegment(),n.closeRing()},pr.prototype.computeRingBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance),i=lr.simplify(t,r=e===x.RIGHT?-r:r),o=i.length-1;n.initSideSegments(i[o-1],i[0],e);for(var s=1;s<=o;s++)n.addNextSegment(i[s],1!==s);n.closeRing()},pr.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),r=lr.simplify(t,n),i=r.length-1;e.initSideSegments(r[0],r[1],x.LEFT);for(var o=2;o<=i;o++)e.addNextSegment(r[o],!0);e.addLastSegment(),e.addLineEndCap(r[i-1],r[i]);var s=lr.simplify(t,-n),t=s.length-1;e.initSideSegments(s[t],s[t-1],x.LEFT);for(var a=t-2;0<=a;a--)e.addNextSegment(s[a],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},pr.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case k.CAP_ROUND:e.createCircle(t);break;case k.CAP_SQUARE:e.createSquare(t)}},pr.prototype.getLineCurve=function(t,e){var n;return(this._distance=e)<0&&!this._bufParams.isSingleSided()||0===e?null:(n=Math.abs(e),n=this.getSegGen(n),t.length<=1?this.computePointCurve(t[0],n):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(t,e<0,n):this.computeLineBufferCurve(t,n),n.getCoordinates())},pr.prototype.getBufferParameters=function(){return this._bufParams},pr.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},pr.prototype.getRingCurve=function(t,e,n){return this._distance=n,t.length<=2?this.getLineCurve(t,n):0===n?pr.copyCoordinates(t):(n=this.getSegGen(n),this.computeRingBufferCurve(t,e,n),n.getCoordinates())},pr.prototype.computeOffsetCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){var i=lr.simplify(t,-r),e=i.length-1;n.initSideSegments(i[e],i[e-1],x.LEFT),n.addFirstSegment();for(var o=e-2;0<=o;o--)n.addNextSegment(i[o],!0)}else{var s=lr.simplify(t,r),a=s.length-1;n.initSideSegments(s[0],s[1],x.LEFT),n.addFirstSegment();for(var u=2;u<=a;u++)n.addNextSegment(s[u],!0)}n.addLastSegment()},pr.prototype.getSegGen=function(t){return new M(this._precisionModel,this._bufParams,t)},pr.prototype.interfaces_=function(){return[]},pr.prototype.getClass=function(){return pr},pr.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new v(t[n]);return e},{DepthSegment:{configurable:!0}}),xr=(hr.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new b,n=this._subgraphs.iterator();n.hasNext();){var r=n.next(),i=r.getEnvelope();t.y<i.getMinY()||t.y>i.getMaxY()||this.findStabbedSegments(t,r.getDirectedEdges(),e)}return e}if(3===arguments.length)if(g(arguments[2],Vt)&&arguments[0]instanceof v&&arguments[1]instanceof Nn)for(var o=arguments[0],s=arguments[1],a=arguments[2],u=s.getEdge().getCoordinates(),l=0;l<u.length-1;l++){var c;this._seg.p0=u[l],this._seg.p1=u[l+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||m.computeOrientation(this._seg.p0,this._seg.p1,o)===m.RIGHT||(c=s.getDepth(x.LEFT),this._seg.p0.equals(u[l])||(c=s.getDepth(x.RIGHT)),c=new xr(this._seg,c),a.add(c))}else if(g(arguments[2],Vt)&&arguments[0]instanceof v&&g(arguments[1],Vt))for(var p=arguments[0],h=arguments[1],f=arguments[2],d=h.iterator();d.hasNext();){var y=d.next();y.isForward()&&this.findStabbedSegments(p,y,f)}},hr.prototype.getDepth=function(t){t=this.findStabbedSegments(t);return 0===t.size()?0:Rn.min(t)._leftDepth},hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr},t.DepthSegment.get=function(){return xr},Object.defineProperties(hr,t),function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new C(t),this._leftDepth=e}),wr=(xr.prototype.compareTo=function(t){var e;return this._upwardSeg.minX()>=t._upwardSeg.maxX()?1:this._upwardSeg.maxX()<=t._upwardSeg.minX()?-1:0!==(e=this._upwardSeg.orientationIndex(t._upwardSeg))||0!=(e=-1*t._upwardSeg.orientationIndex(this._upwardSeg))?e:this._upwardSeg.compareTo(t._upwardSeg)},xr.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},xr.prototype.toString=function(){return this._upwardSeg.toString()},xr.prototype.interfaces_=function(){return[tt]},xr.prototype.getClass=function(){return xr},L.prototype.area=function(){return L.area(this.p0,this.p1,this.p2)},L.prototype.signedArea=function(){return L.signedArea(this.p0,this.p1,this.p2)},L.prototype.interpolateZ=function(t){if(null===t)throw new p("Supplied point is null.");return L.interpolateZ(t,this.p0,this.p1,this.p2)},L.prototype.longestSideLength=function(){return L.longestSideLength(this.p0,this.p1,this.p2)},L.prototype.isAcute=function(){return L.isAcute(this.p0,this.p1,this.p2)},L.prototype.circumcentre=function(){return L.circumcentre(this.p0,this.p1,this.p2)},L.prototype.area3D=function(){return L.area3D(this.p0,this.p1,this.p2)},L.prototype.centroid=function(){return L.centroid(this.p0,this.p1,this.p2)},L.prototype.inCentre=function(){return L.inCentre(this.p0,this.p1,this.p2)},L.prototype.interfaces_=function(){return[]},L.prototype.getClass=function(){return L},L.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},L.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},L.det=function(t,e,n,r){return t*r-e*n},L.interpolateZ=function(t,e,n,r){var i=e.x,o=e.y,s=n.x-i,a=r.x-i,u=n.y-o,l=r.y-o,c=s*l-a*u,i=t.x-i,t=t.y-o;return e.z+(l*i-a*t)/c*(n.z-e.z)+(-u*i+s*t)/c*(r.z-e.z)},L.longestSideLength=function(t,e,n){var r=t.distance(e),e=e.distance(n),n=n.distance(t),t=r;return t=(t=r<e?e:r)<n?n:t},L.isAcute=function(t,e,n){return!!A.isAcute(t,e,n)&&!!A.isAcute(e,n,t)&&!!A.isAcute(n,t,e)},L.circumcentre=function(t,e,n){var r=n.x,n=n.y,i=t.x-r,t=t.y-n,o=e.x-r,e=e.y-n,s=2*L.det(i,t,o,e),a=L.det(t,i*i+t*t,e,o*o+e*e),i=L.det(i,i*i+t*t,o,o*o+e*e);return new v(r-a/s,n+i/s)},L.perpendicularBisector=function(t,e){var n=e.x-t.x,e=e.y-t.y,r=new yt(t.x+n/2,t.y+e/2,1),t=new yt(t.x-e+n/2,t.y+n+e/2,1);return new yt(r,t)},L.angleBisector=function(t,e,n){var r=e.distance(t),r=r/(r+e.distance(n)),e=n.x-t.x,n=n.y-t.y;return new v(t.x+r*e,t.y+r*n)},L.area3D=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,e=e.z-t.z,o=n.x-t.x,s=n.y-t.y,n=n.z-t.z,t=i*n-e*s,e=e*o-r*n,n=r*s-i*o;return Math.sqrt(t*t+e*e+n*n)/2},L.centroid=function(t,e,n){var r=(t.x+e.x+n.x)/3,t=(t.y+e.y+n.y)/3;return new v(r,t)},L.inCentre=function(t,e,n){var r=e.distance(n),i=t.distance(n),o=t.distance(e),s=r+i+o,a=(r*t.x+i*e.x+o*n.x)/s,r=(r*t.y+i*e.y+o*n.y)/s;return new v(a,r)},fr.prototype.addPoint=function(t){if(this._distance<=0)return null;t=t.getCoordinates(),t=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(t,h.EXTERIOR,h.INTERIOR)},fr.prototype.addPolygon=function(t){var e=this._distance,n=x.LEFT,r=(this._distance<0&&(e=-this._distance,n=x.RIGHT),t.getExteriorRing()),i=c.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&i.length<3)return null;this.addPolygonRing(i,e,n,h.EXTERIOR,h.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=c.removeRepeatedPoints(s.getCoordinates());0<this._distance&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,x.opposite(n),h.INTERIOR,h.EXTERIOR)}},fr.prototype.isTriangleErodedCompletely=function(t,e){var t=new L(t[0],t[1],t[2]),n=t.inCentre();return m.distancePointLine(n,t.p0,t.p1)<Math.abs(e)},fr.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;t=c.removeRepeatedPoints(t.getCoordinates()),t=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(t,h.EXTERIOR,h.INTERIOR)},fr.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;t=new ir(t,new S(0,h.BOUNDARY,e,n));this._curveList.add(t)},fr.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},fr.prototype.addPolygonRing=function(t,e,n,r,i){if(0===e&&t.length<je.MINIMUM_VALID_SIZE)return null;var o=r,s=i,i=(t.length>=je.MINIMUM_VALID_SIZE&&m.isCCW(t)&&(o=i,s=r,n=x.opposite(n)),this._curveBuilder.getRingCurve(t,n,e));this.addCurve(i,o,s)},fr.prototype.add=function(t){if(t.isEmpty())return null;t instanceof De?this.addPolygon(t):t instanceof Oe?this.addLineString(t):t instanceof Ae?this.addPoint(t):(t instanceof Fe||t instanceof _e||t instanceof qe||t instanceof ve)&&this.addCollection(t)},fr.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();return n.length<4?e<0:4===n.length?this.isTriangleErodedCompletely(n,e):(n=t.getEnvelopeInternal(),t=Math.min(n.getHeight(),n.getWidth()),e<0&&2*Math.abs(e)>t)},fr.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},fr.prototype.interfaces_=function(){return[]},fr.prototype.getClass=function(){return fr},dr.prototype.locate=function(t){},dr.prototype.interfaces_=function(){return[]},dr.prototype.getClass=function(){return dr},yr.prototype.next=function(){if(this._atStart)return this._atStart=!1,yr.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new q;var t=this._parent.getGeometryN(this._index++);return t instanceof ve?(this._subcollectionIterator=new yr(t),this._subcollectionIterator.next()):t},yr.prototype.remove=function(){throw new Error(this.getClass().getName())},yr.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},yr.prototype.interfaces_=function(){return[Ft]},yr.prototype.getClass=function(){return yr},yr.isAtomic=function(t){return!(t instanceof ve)},gr.prototype.locate=function(t){return gr.locate(t,this._geom)},gr.prototype.interfaces_=function(){return[dr]},gr.prototype.getClass=function(){return gr},gr.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&m.isPointInRing(t,e.getCoordinates())},gr.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!gr.isPointInRing(t,n))return!1;for(var r=0;r<e.getNumInteriorRing();r++){var i=e.getInteriorRingN(r);if(gr.isPointInRing(t,i))return!1}return!0},gr.containsPoint=function(t,e){if(e instanceof De)return gr.containsPointInPolygon(t,e);if(e instanceof ve)for(var n=new yr(e);n.hasNext();){var r=n.next();if(r!==e&&gr.containsPoint(t,r))return!0}return!1},gr.locate=function(t,e){return!e.isEmpty()&&gr.containsPoint(t,e)?h.INTERIOR:h.EXTERIOR},mr.prototype.getNextCW=function(t){this.getEdges();var t=this._edgeList.indexOf(t),e=t-1;return 0===t&&(e=this._edgeList.size()-1),this._edgeList.get(e)},mr.prototype.propagateSideLabels=function(t){for(var e=h.NONE,n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.isArea(t)&&r.getLocation(t,x.LEFT)!==h.NONE&&(e=r.getLocation(t,x.LEFT))}if(e===h.NONE)return null;for(var i=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,x.ON)===h.NONE&&a.setLocation(t,x.ON,i),a.isArea(t)){var u=a.getLocation(t,x.LEFT),l=a.getLocation(t,x.RIGHT);if(l!==h.NONE){if(l!==i)throw new un("side location conflict",s.getCoordinate());u===h.NONE&&y.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),i=u}else y.isTrue(a.getLocation(t,x.LEFT)===h.NONE,"found single null side"),a.setLocation(t,x.RIGHT,i),a.setLocation(t,x.LEFT,i)}}},mr.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},mr.prototype.print=function(t){ct.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},mr.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},mr.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(!(e.size()<=0)){var n=e.size()-1,e=e.get(n).getLabel().getLocation(t,x.LEFT);y.isTrue(e!==h.NONE,"Found unlabelled area edge");for(var r=e,i=this.iterator();i.hasNext();){var o=i.next().getLabel(),s=(y.isTrue(o.isArea(t),"Found non-area edge"),o.getLocation(t,x.LEFT)),o=o.getLocation(t,x.RIGHT);if(s===o)return!1;if(o!==r)return!1;r=s}}return!0},mr.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},mr.prototype.iterator=function(){return this.getEdges().iterator()},mr.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new b(this._edgeMap.values())),this._edgeList},mr.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===h.NONE&&(this._ptInAreaLocation[t]=gr.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},mr.prototype.toString=function(){var t=new ot;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},mr.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},mr.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var r=n.next().getLabel(),i=0;i<2;i++)r.isLine(i)&&r.getLocation(i)===h.BOUNDARY&&(e[i]=!0);for(var o,s,a=this.iterator();a.hasNext();)for(var u=a.next(),l=u.getLabel(),c=0;c<2;c++)l.isAnyNull(c)&&(s=h.NONE,s=e[c]?h.EXTERIOR:(o=u.getCoordinate(),this.getLocation(c,o,t)),l.setAllLocationsIfNull(c,s))},mr.prototype.getDegree=function(){return this._edgeMap.size()},mr.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr},(br=mr)&&(Ir.__proto__=br),((Ir.prototype=Object.create(br&&br.prototype)).constructor=Ir).prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var i=this._resultAreaEdgeList.get(r),o=i.getSym();if(i.getLabel().isArea())switch(null===t&&i.isInResult()&&(t=i),n){case this._SCANNING_FOR_INCOMING:o.isInResult()&&(e=o,n=this._LINKING_TO_OUTGOING);break;case this._LINKING_TO_OUTGOING:i.isInResult()&&(e.setNext(i),n=this._SCANNING_FOR_INCOMING)}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new un("no outgoing dirEdge found",this.getCoordinate());y.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},Ir.prototype.insert=function(t){this.insertEdgeEnd(t,t)},Ir.prototype.getRightmostEdge=function(){var t,e,n=this.getEdges(),r=n.size();return r<1?null:(t=n.get(0),1===r||(n=n.get(r-1),r=t.getQuadrant(),e=n.getQuadrant(),I.isNorthern(r)&&I.isNorthern(e))?t:I.isNorthern(r)||I.isNorthern(e)?0!==t.getDy()?t:0!==n.getDy()?n:(y.shouldNeverReachHere("found two horizontal edges incident on node"),null):n)},Ir.prototype.print=function(t){ct.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},Ir.prototype.getResultAreaEdges=function(){if(null===this._resultAreaEdgeList){this._resultAreaEdgeList=new b;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}}return this._resultAreaEdgeList},Ir.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},Ir.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;0<=n;n--){var r=this._edgeList.get(n),i=r.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=r}e.setNext(t)},Ir.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(x.LEFT),r=t.getDepth(x.RIGHT),n=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,n)!==r)throw new un("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var e=arguments[0],i=arguments[1],o=arguments[2],s=e;s<i;s++){var a=this._edgeList.get(s);a.setEdgeDepths(x.RIGHT,o),o=a.getDepth(x.LEFT)}return o}},Ir.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},Ir.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,r=this._SCANNING_FOR_INCOMING,i=this._resultAreaEdgeList.size()-1;0<=i;i--){var o=this._resultAreaEdgeList.get(i),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),r){case this._SCANNING_FOR_INCOMING:s.getEdgeRing()===t&&(n=s,r=this._LINKING_TO_OUTGOING);break;case this._LINKING_TO_OUTGOING:o.getEdgeRing()===t&&(n.setNextMin(o),r=this._SCANNING_FOR_INCOMING)}}r===this._LINKING_TO_OUTGOING&&(y.isTrue(null!==e,"found null for first outgoing dirEdge"),y.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},Ir.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],r=0,i=this.iterator();i.hasNext();)i.next().getEdgeRing()===n&&r++;return r}},Ir.prototype.getLabel=function(){return this._label},Ir.prototype.findCoveredLineEdges=function(){for(var t=h.NONE,e=this.iterator();e.hasNext();){var n=e.next(),r=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=h.INTERIOR;break}if(r.isInResult()){t=h.EXTERIOR;break}}}if(t===h.NONE)return null;for(var i=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(i===h.INTERIOR):(s.isInResult()&&(i=h.EXTERIOR),a.isInResult()&&(i=h.INTERIOR))}},Ir.prototype.computeLabelling=function(t){br.prototype.computeLabelling.call(this,t),this._label=new S(h.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),r=0;r<2;r++){var i=n.getLocation(r);i!==h.INTERIOR&&i!==h.BOUNDARY||this._label.setLocation(r,h.INTERIOR)}},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir},Ir),Er=((_r=Sn)&&(Sr.__proto__=_r),((Sr.prototype=Object.create(_r&&_r.prototype)).constructor=Sr).prototype.createNode=function(t){return new xn(t,new wr)},Sr.prototype.interfaces_=function(){return[]},Sr.prototype.getClass=function(){return Sr},Sr);function Sr(){_r.apply(this,arguments)}function Ir(){br.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}vr.prototype.compareTo=function(t){return vr.compareOriented(this._pts,this._orientation,t._pts,t._orientation)},vr.prototype.interfaces_=function(){return[tt]},vr.prototype.getClass=function(){return vr},vr.orientation=function(t){return 1===c.increasingDirection(t)},vr.compareOriented=function(t,e,n,r){for(var i=e?1:-1,o=r?1:-1,s=e?t.length:-1,a=r?n.length:-1,u=e?0:t.length-1,l=r?0:n.length-1;;){var c=t[u].compareTo(n[l]);if(0!==c)return c;var c=(u+=i)===s,p=(l+=o)===a;if(c&&!p)return-1;if(!c&&p)return 1;if(c&&p)return 0}};function Nr(){this._edges=new b,this._ocaMap=new X}function Or(){}function Cr(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0,this._li=arguments[0]}function kr(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new v(t),this.segmentIndex=e,this.dist=n}function Ar(){this._nodeMap=new X,this.edge=null,this.edge=arguments[0]}function Mr(){}function Lr(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new u,this.env2=new u;var t=arguments[0],t=(this.e=t,this.pts=t.getCoordinates(),new Mr);this.startIndex=t.getChainStartIndices(this.pts)}function Pr(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=Pr.NULL_VALUE}Nr.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);0<e&&t.print(","),t.print("(");for(var r=n.getCoordinates(),i=0;i<r.length;i++)0<i&&t.print(","),t.print(r[i].x+" "+r[i].y);t.println(")")}t.print(")  ")},Nr.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Nr.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Nr.prototype.iterator=function(){return this._edges.iterator()},Nr.prototype.getEdges=function(){return this._edges},Nr.prototype.get=function(t){return this._edges.get(t)},Nr.prototype.findEqualEdge=function(t){t=new vr(t.getCoordinates());return this._ocaMap.get(t)},Nr.prototype.add=function(t){this._edges.add(t);var e=new vr(t.getCoordinates());this._ocaMap.put(e,t)},Nr.prototype.interfaces_=function(){return[]},Nr.prototype.getClass=function(){return Nr},Or.prototype.processIntersections=function(t,e,n,r){},Or.prototype.isDone=function(){},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or},Cr.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(Cr.isAdjacentSegments(e,r))return!0;if(t.isClosed()){n=t.size()-1;if(0===e&&r===n||0===r&&e===n)return!0}}return!1},Cr.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Cr.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Cr.prototype.getLineIntersector=function(){return this._li},Cr.prototype.hasProperIntersection=function(){return this._hasProper},Cr.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Cr.prototype.hasIntersection=function(){return this._hasIntersection},Cr.prototype.isDone=function(){return!1},Cr.prototype.hasInteriorIntersection=function(){return this._hasInterior},Cr.prototype.interfaces_=function(){return[Or]},Cr.prototype.getClass=function(){return Cr},Cr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},kr.prototype.getSegmentIndex=function(){return this.segmentIndex},kr.prototype.getCoordinate=function(){return this.coord},kr.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},kr.prototype.compareTo=function(t){return this.compare(t.segmentIndex,t.dist)},kr.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},kr.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},kr.prototype.getDistance=function(){return this.dist},kr.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},kr.prototype.interfaces_=function(){return[tt]},kr.prototype.getClass=function(){return kr},Ar.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Ar.prototype.iterator=function(){return this._nodeMap.values().iterator()},Ar.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},Ar.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Ar.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],r=0<e.dist||!e.coord.equals2D(r),i=(r||n--,new Array(n).fill(null)),o=0;i[o++]=new v(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)i[o++]=this.edge.pts[s];return r&&(i[o]=e.coord),new Dr(i,new S(this.edge._label))},Ar.prototype.add=function(t,e,n){t=new kr(t,e,n),e=this._nodeMap.get(t);return null!==e?e:(this._nodeMap.put(t,t),t)},Ar.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Ar.prototype.interfaces_=function(){return[]},Ar.prototype.getClass=function(){return Ar},Mr.prototype.getChainStartIndices=function(t){var e=0,n=new b;n.add(new st(e));do{var r=this.findChainEnd(t,e)}while(n.add(new st(r)),(e=r)<t.length-1);return Mr.toIntArray(n)},Mr.prototype.findChainEnd=function(t,e){for(var n=I.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&I.quadrant(t[r-1],t[r])===n;)r++;return r-1},Mr.prototype.interfaces_=function(){return[]},Mr.prototype.getClass=function(){return Mr},Mr.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},Lr.prototype.getCoordinates=function(){return this.pts},Lr.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,t=this.pts[this.startIndex[t+1]].x;return t<e?e:t},Lr.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,t=this.pts[this.startIndex[t+1]].x;return e<t?e:t},Lr.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],arguments[3])}else{var r,i,o,s,a,u,l;if(6===arguments.length)return t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],i=arguments[4],o=arguments[5],u=this.pts[t],l=this.pts[e],s=n.pts[r],a=n.pts[i],e-t==1&&i-r==1?(o.addIntersections(this.e,t,n.e,r),null):(this.env1.init(u,l),this.env2.init(s,a),this.env1.intersects(this.env2)?(u=Math.trunc((t+e)/2),l=Math.trunc((r+i)/2),t<u&&(r<l&&this.computeIntersectsForChain(t,u,n,r,l,o),l<i)&&this.computeIntersectsForChain(t,u,n,l,i,o),void(u<e&&(r<l&&this.computeIntersectsForChain(u,e,n,r,l,o),l<i)&&this.computeIntersectsForChain(u,e,n,l,i,o))):null)}},Lr.prototype.getStartIndexes=function(){return this.startIndex},Lr.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(n,t,r,e)},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr};function Tr(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Nr,this._bufParams=t||null}var Rr,t={NULL_VALUE:{configurable:!0}},Dr=(Pr.prototype.getDepth=function(t,e){return this._depth[t][e]},Pr.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},Pr.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==Pr.NULL_VALUE)return!1;return!0}return 1===arguments.length?this._depth[arguments[0]][1]===Pr.NULL_VALUE:2===arguments.length?this._depth[arguments[0]][arguments[1]]===Pr.NULL_VALUE:void 0},Pr.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];(e=this._depth[t][2]<e?this._depth[t][2]:e)<0&&(e=0);for(var n=1;n<3;n++){var r=0;this._depth[t][n]>e&&(r=1),this._depth[t][n]=r}}},Pr.prototype.getDelta=function(t){return this._depth[t][x.RIGHT]-this._depth[t][x.LEFT]},Pr.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?h.EXTERIOR:h.INTERIOR},Pr.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Pr.prototype.add=function(){var t,e;if(1===arguments.length)for(var n=arguments[0],r=0;r<2;r++)for(var i=1;i<3;i++){var o=n.getLocation(r,i);o!==h.EXTERIOR&&o!==h.INTERIOR||(this.isNull(r,i)?this._depth[r][i]=Pr.depthAtLocation(o):this._depth[r][i]+=Pr.depthAtLocation(o))}else 3===arguments.length&&(t=arguments[0],e=arguments[1],arguments[2]===h.INTERIOR)&&this._depth[t][e]++},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr},Pr.depthAtLocation=function(t){return t===h.EXTERIOR?0:t===h.INTERIOR?1:Pr.NULL_VALUE},t.NULL_VALUE.get=function(){return-1},Object.defineProperties(Pr,t),(Rr=hn)&&(P.__proto__=Rr),((P.prototype=Object.create(Rr&&Rr.prototype)).constructor=P).prototype.getDepth=function(){return this._depth},P.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new P(t,S.toLineLabel(this._label))},P.prototype.isIsolated=function(){return this._isIsolated},P.prototype.getCoordinates=function(){return this.pts},P.prototype.setIsolated=function(t){this._isIsolated=t},P.prototype.setName=function(t){this._name=t},P.prototype.equals=function(t){if(!(t instanceof P))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,r=!0,i=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--i])||(r=!1),!n&&!r)return!1;return!0},P.prototype.getCoordinate=function(){return 0===arguments.length?0<this.pts.length?this.pts[0]:null:1===arguments.length?this.pts[arguments[0]]:void 0},P.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},P.prototype.computeIM=function(t){P.updateIM(this._label,t)},P.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},P.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},P.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},P.prototype.getDepthDelta=function(){return this._depthDelta},P.prototype.getNumPoints=function(){return this.pts.length},P.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;0<=e;e--)t.print(this.pts[e]+" ");t.println("")},P.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Lr(this)),this._mce},P.prototype.getEnvelope=function(){if(null===this._env){this._env=new u;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},P.prototype.addIntersection=function(t,e,n,r){var i=new v(t.getIntersection(r)),t=t.getEdgeDistance(n,r),n=e+1;n<this.pts.length&&(r=this.pts[n],i.equals2D(r))&&(e=n,t=0),this.eiList.add(i,e,t)},P.prototype.toString=function(){var t=new ot;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},P.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},P.prototype.setDepthDelta=function(t){this._depthDelta=t},P.prototype.getEdgeIntersectionList=function(){return this.eiList},P.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},P.prototype.interfaces_=function(){return[]},P.prototype.getClass=function(){return P},P.updateIM=function(){if(2!==arguments.length)return Rr.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,x.ON),t.getLocation(1,x.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,x.LEFT),t.getLocation(1,x.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,x.RIGHT),t.getLocation(1,x.RIGHT),2))},P);function P(){var t,e;Rr.call(this),this.pts=null,this._env=null,this.eiList=new Ar(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Pr,this._depthDelta=0,1===arguments.length?P.call(this,arguments[0],null):2===arguments.length&&(t=arguments[0],e=arguments[1],this.pts=t,this._label=e)}Tr.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},Tr.prototype.insertUniqueEdge=function(t){var e,n,r=this._edgeList.findEqualEdge(t);null!==r?(e=r.getLabel(),n=t.getLabel(),r.isPointwiseEqual(t)||(n=new S(t.getLabel())).flip(),e.merge(n),e=Tr.depthDelta(n),n=r.getDepthDelta()+e,r.setDepthDelta(n)):(this._edgeList.add(t),t.setDepthDelta(Tr.depthDelta(t.getLabel())))},Tr.prototype.buildSubgraphs=function(t,e){for(var n=new b,r=t.iterator();r.hasNext();){var i=r.next(),o=i.getRightmostCoordinate(),o=new hr(n).getDepth(o);i.computeDepth(o),i.findResultEdges(),n.add(i),e.add(i.getDirectedEdges(),i.getNodes())}},Tr.prototype.createSubgraphs=function(t){for(var e=new b,n=t.getNodes().iterator();n.hasNext();){var r,i=n.next();i.isVisited()||((r=new cn).create(i),e.add(r))}return Rn.sort(e,Rn.reverseOrder()),e},Tr.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Tr.prototype.getNoder=function(t){var e,n;return null!==this._workingNoder?this._workingNoder:(e=new or,(n=new At).setPrecisionModel(t),e.setSegmentIntersector(new Cr(n)),e)},Tr.prototype.buffer=function(t,e){var n=this._workingPrecisionModel,r=(null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory(),new pr(n,this._bufParams)),t=new fr(t,e,r).getCurves();if(t.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(t,n),this._graph=new On(new Er),this._graph.addEdges(this._edgeList.getEdges());e=this.createSubgraphs(this._graph),r=new Cn(this._geomFact),this.buildSubgraphs(e,r),t=r.getPolygons();return t.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(t)},Tr.prototype.computeNodedEdges=function(t,e){e=this.getNoder(e);e.computeNodes(t);for(var n=e.getNodedSubstrings().iterator();n.hasNext();){var r=n.next(),i=r.getCoordinates();2===i.length&&i[0].equals2D(i[1])||(i=r.getData(),r=new Dr(r.getCoordinates(),new S(i)),this.insertUniqueEdge(r))}},Tr.prototype.setNoder=function(t){this._workingNoder=t},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr},Tr.depthDelta=function(t){var e=t.getLocation(0,x.LEFT),t=t.getLocation(0,x.RIGHT);return e===h.INTERIOR&&t===h.EXTERIOR?1:e===h.EXTERIOR&&t===h.INTERIOR?-1:0},Tr.convertSegStrings=function(t){for(var e=new w,n=new b;t.hasNext();){var r=t.next(),r=e.createLineString(r.getCoordinates());n.add(r)}return e.buildGeometry(n)};function Fr(){var t,e,n,r;this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length?(t=arguments[0],e=arguments[1],this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()):4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],this._noder=t,this._scaleFactor=e,this._offsetX=n,this._offsetY=r,this._isScaled=!this.isIntegerPrecision())}function jr(){this._li=new At,this._segStrings=null,this._segStrings=arguments[0]}Fr.prototype.rescale=function(){if(g(arguments[0],Dt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/this._scaleFactor+this._offsetX,n[r].y=n[r].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&ct.out.println(n)}},Fr.prototype.scale=function(){if(g(arguments[0],Dt)){for(var t=arguments[0],e=new b,n=t.iterator();n.hasNext();){var r=n.next();e.add(new ir(this.scale(r.getCoordinates()),r.getData()))}return e}if(arguments[0]instanceof Array){for(var i=arguments[0],o=new Array(i.length).fill(null),s=0;s<i.length;s++)o[s]=new v(Math.round((i[s].x-this._offsetX)*this._scaleFactor),Math.round((i[s].y-this._offsetY)*this._scaleFactor),i[s].z);return c.removeRepeatedPoints(o)}},Fr.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Fr.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},Fr.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},Fr.prototype.interfaces_=function(){return[tr]},Fr.prototype.getClass=function(){return Fr};function qr(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new p("Scale factor must be non-zero");1!==e&&(this._pt=new v(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new v,this._p1Scaled=new v),this.initCorners(this._pt)}function Br(){this.tempEnv1=new u,this.selectedSegment=new C}function Gr(){this._index=null,this._index=arguments[0]}function zr(){this._li=null,this._interiorIntersections=null,this._li=arguments[0],this._interiorIntersections=new b}var Ur,t={fact:{configurable:!0}},t=(jr.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var i=r.next().getCoordinates(),o=1;o<i.length-1;o++)if(i[o].equals(n))throw new Et("found endpt/interior pt intersection at index "+o+" :pt "+n)},jr.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(e,r)}else if(2===arguments.length)for(var i=arguments[0],o=arguments[1],s=i.getCoordinates(),a=o.getCoordinates(),u=0;u<s.length-1;u++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(i,u,o,l);else if(4===arguments.length){var c=arguments[0],p=arguments[1],h=arguments[2],f=arguments[3];if(c===h&&p===f)return null;var d=c.getCoordinates()[p],c=c.getCoordinates()[p+1],p=h.getCoordinates()[f],h=h.getCoordinates()[f+1];if(this._li.computeIntersection(d,c,p,h),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,c)||this.hasInteriorIntersection(this._li,p,h)))throw new Et("found non-noded intersection at "+d+"-"+c+" and "+p+"-"+h)}},jr.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},jr.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)this.checkCollapse(n[r],n[r+1],n[r+2])},jr.prototype.hasInteriorIntersection=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var i=t.getIntersection(r);if(!i.equals(e)&&!i.equals(n))return!0}return!1},jr.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new Et("found non-noded collapse at "+jr.fact.createLineString([t,e,n]))},jr.prototype.interfaces_=function(){return[]},jr.prototype.getClass=function(){return jr},t.fact.get=function(){return new w},Object.defineProperties(jr,t),{SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}}),t=(qr.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.y,e.y),n=this._maxx<n||this._minx>r||this._maxy<i||this._miny>o;return!n&&(r=this.intersectsToleranceSquare(t,e),y.isTrue(!(n&&r),"Found bad envelope test"),r)},qr.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new v(this._maxx,this._maxy),this._corner[1]=new v(this._minx,this._maxy),this._corner[2]=new v(this._minx,this._miny),this._corner[3]=new v(this._maxx,this._miny)},qr.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},qr.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},qr.prototype.getCoordinate=function(){return this._originalPt},qr.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},qr.prototype.getSafeEnvelope=function(){var t;return null===this._safeEnv&&(t=qr.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor,this._safeEnv=new u(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)),this._safeEnv},qr.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))},qr.prototype.intersectsToleranceSquare=function(t,e){var n=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&r||t.equals(this._pt)||e.equals(this._pt)))},qr.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(n,r)&&(t.addIntersection(this.getCoordinate(),e),!0)},qr.prototype.interfaces_=function(){return[]},qr.prototype.getClass=function(){return qr},t.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(qr,t),Br.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))},Br.prototype.interfaces_=function(){return[]},Br.prototype.getClass=function(){return Br},{HotPixelSnapAction:{configurable:!0}}),Vr=(Gr.prototype.snap=function(){var t,e,n,r,i;return 1===arguments.length?this.snap(arguments[0],null,-1):3===arguments.length?(t=arguments[0],e=arguments[1],n=arguments[2],r=t.getSafeEnvelope(),i=new Vr(t,e,n),this._index.query(r,{interfaces_:function(){return[Ln]},visitItem:function(t){t.select(r,i)}}),i.isNodeAdded()):void 0},Gr.prototype.interfaces_=function(){return[]},Gr.prototype.getClass=function(){return Gr},t.HotPixelSnapAction.get=function(){return Vr},Object.defineProperties(Gr,t),(Ur=Br)&&($r.__proto__=Ur),(($r.prototype=Object.create(Ur&&Ur.prototype)).constructor=$r).prototype.isNodeAdded=function(){return this._isNodeAdded},$r.prototype.select=function(){var t,e;return 2!==arguments.length?Ur.prototype.select.apply(this,arguments):(e=arguments[0],t=arguments[1],e=e.getContext(),null!==this._parentEdge&&e===this._parentEdge&&t===this._hotPixelVertexIndex?null:void(this._isNodeAdded=this._hotPixel.addSnappedNode(e,t)))},$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r);function $r(){Ur.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}zr.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];if(this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)}},zr.prototype.isDone=function(){return!1},zr.prototype.getInteriorIntersections=function(){return this._interiorIntersections},zr.prototype.interfaces_=function(){return[Or]},zr.prototype.getClass=function(){return zr};function Xr(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new At,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()}function Yr(){var t,e;this._argGeom=null,this._distance=null,this._bufParams=new k,this._resultGeometry=null,this._saveException=null,1===arguments.length?this._argGeom=arguments[0]:2===arguments.length&&(t=arguments[0],e=arguments[1],this._argGeom=t,this._bufParams=e)}Xr.prototype.checkCorrectness=function(t){var e=ir.getNodedSubstrings(t),e=new jr(e);try{e.checkValid()}catch(t){if(!(t instanceof lt))throw t;t.printStackTrace()}},Xr.prototype.getNodedSubstrings=function(){return ir.getNodedSubstrings(this._nodedSegStrings)},Xr.prototype.snapRound=function(t,e){e=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(e),this.computeVertexSnaps(t)},Xr.prototype.findInteriorIntersections=function(t,e){e=new zr(e);return this._noder.setSegmentIntersector(e),this._noder.computeNodes(t),e.getInteriorIntersections()},Xr.prototype.computeVertexSnaps=function(){if(g(arguments[0],Dt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof ir)for(var n=arguments[0],r=n.getCoordinates(),i=0;i<r.length;i++){var o=new qr(r[i],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,i)&&n.addIntersection(r[i],i)}},Xr.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new or,this._pointSnapper=new Gr(this._noder.getIndex()),this.snapRound(t,this._li)},Xr.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),n=new qr(n,this._scaleFactor,this._li);this._pointSnapper.snap(n)}},Xr.prototype.interfaces_=function(){return[tr]},Xr.prototype.getClass=function(){return Xr};function Jr(){this._pt=[new v,new v],this._distance=l.NaN,this._isNull=!0}function Wr(){}function Hr(t){this._maxPtDist=new Jr,this._inputGeom=t||null}function Kr(t){this._comps=t||null}function Qr(){var t,e;this._lines=null,this._isForcedToLineString=!1,1===arguments.length?this._lines=arguments[0]:2===arguments.length&&(t=arguments[0],e=arguments[1],this._lines=t,this._isForcedToLineString=e)}function Zr(){if(this._boundaryRule=Rt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var t=arguments[0];if(null===t)throw new p("Rule must be non-null");this._boundaryRule=t}}function ti(){var t,e,n;this._component=null,this._segIndex=null,this._pt=null,2===arguments.length?ti.call(this,arguments[0],ti.INSIDE_AREA,arguments[1]):3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],this._component=t,this._segIndex=e,this._pt=n)}function ei(t){this._pts=t||null}function ni(){this._locations=null,this._locations=arguments[0]}function ri(){var t,e,n;this._geom=null,this._terminateDistance=0,this._ptLocator=new Zr,this._minDistanceLocation=null,this._minDistance=l.MAX_VALUE,2===arguments.length?(this._geom=[arguments[0],arguments[1]],this._terminateDistance=0):3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e,this._terminateDistance=n)}function ii(){this._pt=[new v,new v],this._distance=l.NaN,this._isNull=!0}function oi(){}function si(){this._g0=null,this._g1=null,this._ptDist=new ii;var t=arguments[this._densifyFrac=0],e=arguments[1];this._g0=t,this._g1=e}function ai(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null}function ui(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null}function li(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e}function ci(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new b,this._intersectionCount=0,this._keepIntersections=!0,this._li=arguments[0],this._interiorIntersection=null}function pi(){this._li=new At,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0,this._segStrings=arguments[0]}function hi(){this._nv=null,this._nv=new pi(hi.toSegmentStrings(arguments[0]))}function fi(t){this._mapOp=t}function di(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new b,this._resultLineList=new b;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n}function yi(){this._op=null,this._geometryFactory=null,this._resultPointList=new b;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e}function gi(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}function mi(){var t,e;this._snapTolerance=0,this._srcPts=null,this._seg=new C,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Oe&&"number"==typeof arguments[1]?(t=arguments[0],e=arguments[1],mi.call(this,t.getCoordinates(),e)):arguments[0]instanceof Array&&"number"==typeof arguments[1]&&(t=arguments[0],e=arguments[1],this._srcPts=t,this._isClosed=mi.isClosed(t),this._snapTolerance=e)}function vi(t){this._srcGeom=t||null}function _i(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null}var bi,t={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}},t=(Yr.prototype.bufferFixedPrecision=function(t){var e=new Fr(new Xr(new a(1)),t.getScale()),n=new Tr(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},Yr.prototype.bufferReducedPrecision=function(){var t;if(0===arguments.length){for(var e=Yr.MAX_PRECISION_DIGITS;0<=e;e--){try{this.bufferReducedPrecision(e)}catch(e){if(!(e instanceof un))throw e;this._saveException=e}if(null!==this._resultGeometry)return null}throw this._saveException}1===arguments.length&&(t=Yr.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),t=new a(t),this.bufferFixedPrecision(t))},Yr.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===a.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},Yr.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},Yr.prototype.bufferOriginalPrecision=function(){try{var t=new Tr(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof Et))throw t;this._saveException=t}},Yr.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},Yr.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},Yr.prototype.interfaces_=function(){return[]},Yr.prototype.getClass=function(){return Yr},Yr.bufferOp=function(){var t,e,n,r;return 2===arguments.length?(e=arguments[0],r=arguments[1],new Yr(e).getResultGeometry(r)):3===arguments.length?Number.isInteger(arguments[2])&&arguments[0]instanceof _&&"number"==typeof arguments[1]?(e=arguments[0],r=arguments[1],t=arguments[2],(e=new Yr(e)).setQuadrantSegments(t),e.getResultGeometry(r)):arguments[2]instanceof k&&arguments[0]instanceof _&&"number"==typeof arguments[1]?(t=arguments[0],e=arguments[1],new Yr(t,arguments[2]).getResultGeometry(e)):void 0:4===arguments.length?(r=arguments[0],t=arguments[1],e=arguments[2],n=arguments[3],(r=new Yr(r)).setQuadrantSegments(e),r.setEndCapStyle(n),r.getResultGeometry(t)):void 0},Yr.precisionScaleFactor=function(t,e,n){t=t.getEnvelopeInternal(),t=it.max(Math.abs(t.getMaxX()),Math.abs(t.getMaxY()),Math.abs(t.getMinX()),Math.abs(t.getMinY()))+2*(0<e?e:0),e=n-Math.trunc(Math.log(t)/Math.log(10)+1);return Math.pow(10,e)},t.CAP_ROUND.get=function(){return k.CAP_ROUND},t.CAP_BUTT.get=function(){return k.CAP_FLAT},t.CAP_FLAT.get=function(){return k.CAP_FLAT},t.CAP_SQUARE.get=function(){return k.CAP_SQUARE},t.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Yr,t),Jr.prototype.getCoordinates=function(){return this._pt},Jr.prototype.getCoordinate=function(t){return this._pt[t]},Jr.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];if(this._isNull)return this.initialize(t,e),null;var n=t.distance(e);n<this._distance&&this.initialize(t,e,n)}},Jr.prototype.initialize=function(){var t,e,n;0===arguments.length?this._isNull=!0:2===arguments.length?(t=arguments[0],e=arguments[1],this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1):3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=n,this._isNull=!1)},Jr.prototype.getDistance=function(){return this._distance},Jr.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];if(this._isNull)return this.initialize(t,e),null;var n=t.distance(e);n>this._distance&&this.initialize(t,e,n)}},Jr.prototype.interfaces_=function(){return[]},Jr.prototype.getClass=function(){return Jr},Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr},Wr.computeDistance=function(){if(arguments[2]instanceof Jr&&arguments[0]instanceof Oe&&arguments[1]instanceof v)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=t.getCoordinates(),i=new C,o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Jr&&arguments[0]instanceof De&&arguments[1]instanceof v){var a=arguments[0],u=arguments[1],l=arguments[2];Wr.computeDistance(a.getExteriorRing(),u,l);for(var c=0;c<a.getNumInteriorRing();c++)Wr.computeDistance(a.getInteriorRingN(c),u,l)}else if(arguments[2]instanceof Jr&&arguments[0]instanceof _&&arguments[1]instanceof v){var t=arguments[0],p=arguments[1],h=arguments[2];if(t instanceof Oe)Wr.computeDistance(t,p,h);else if(t instanceof De)Wr.computeDistance(t,p,h);else if(t instanceof ve)for(var f=t,d=0;d<f.getNumGeometries();d++){var y=f.getGeometryN(d);Wr.computeDistance(y,p,h)}else h.setMinimum(t.getCoordinate(),p)}else{var g,m;arguments[2]instanceof Jr&&arguments[0]instanceof C&&arguments[1]instanceof v&&(t=arguments[0],g=arguments[1],m=arguments[2],t=t.closestPoint(g),m.setMinimum(t,g))}},{MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}}),xi=(Hr.prototype.computeMaxMidpointDistance=function(t){var e=new wi(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Hr.prototype.computeMaxVertexDistance=function(t){var e=new xi(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Hr.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},Hr.prototype.getDistancePoints=function(){return this._maxPtDist},Hr.prototype.interfaces_=function(){return[]},Hr.prototype.getClass=function(){return Hr},t.MaxPointDistanceFilter.get=function(){return xi},t.MaxMidpointDistanceFilter.get=function(){return wi},Object.defineProperties(Hr,t),function(t){this._maxPtDist=new Jr,this._minPtDist=new Jr,this._geom=t||null}),wi=(xi.prototype.filter=function(t){this._minPtDist.initialize(),Wr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xi.prototype.getMaxPointDistance=function(){return this._maxPtDist},xi.prototype.interfaces_=function(){return[Tt]},xi.prototype.getClass=function(){return xi},function(t){this._maxPtDist=new Jr,this._minPtDist=new Jr,this._geom=t||null}),t=(wi.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),t=t.getCoordinate(e),e=new v((n.x+t.x)/2,(n.y+t.y)/2);this._minPtDist.initialize(),Wr.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},wi.prototype.isDone=function(){return!1},wi.prototype.isGeometryChanged=function(){return!1},wi.prototype.getMaxPointDistance=function(){return this._maxPtDist},wi.prototype.interfaces_=function(){return[de]},wi.prototype.getClass=function(){return wi},Kr.prototype.filter=function(t){t instanceof De&&this._comps.add(t)},Kr.prototype.interfaces_=function(){return[fe]},Kr.prototype.getClass=function(){return Kr},Kr.getPolygons=function(){var t,e;return 1===arguments.length?Kr.getPolygons(arguments[0],new b):2===arguments.length?(t=arguments[0],e=arguments[1],t instanceof De?e.add(t):t instanceof ve&&t.apply(new Kr(e)),e):void 0},Qr.prototype.filter=function(t){var e;if(this._isForcedToLineString&&t instanceof je)return e=t.getFactory().createLineString(t.getCoordinateSequence()),this._lines.add(e),null;t instanceof Oe&&this._lines.add(t)},Qr.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Qr.prototype.interfaces_=function(){return[Pt]},Qr.prototype.getClass=function(){return Qr},Qr.getGeometry=function(){var t,e;return 1===arguments.length?(t=arguments[0]).getFactory().buildGeometry(Qr.getLines(t)):2===arguments.length?(t=arguments[0],e=arguments[1],t.getFactory().buildGeometry(Qr.getLines(t,e))):void 0},Qr.getLines=function(){var t;if(1===arguments.length)return Qr.getLines(arguments[0],!1);if(2===arguments.length){if(g(arguments[0],Dt)&&g(arguments[1],Dt)){for(var e=arguments[0],n=arguments[1],r=e.iterator();r.hasNext();){var i=r.next();Qr.getLines(i,n)}return n}return arguments[0]instanceof _&&"boolean"==typeof arguments[1]?(e=arguments[0],t=arguments[1],o=new b,e.apply(new Qr(o,t)),o):arguments[0]instanceof _&&g(arguments[1],Dt)?(e=arguments[0],t=arguments[1],e instanceof Oe?t.add(e):e.apply(new Qr(t)),t):void 0}if(3===arguments.length){if("boolean"==typeof arguments[2]&&g(arguments[0],Dt)&&g(arguments[1],Dt)){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=o.iterator();u.hasNext();){var l=u.next();Qr.getLines(l,s,a)}return s}if("boolean"==typeof arguments[2]&&arguments[0]instanceof _&&g(arguments[1],Dt))return arguments[0].apply(new Qr(e=arguments[1],arguments[2])),e}},Zr.prototype.locateInternal=function(){if(arguments[0]instanceof v&&arguments[1]instanceof De){var t=arguments[0],e=arguments[1];if(e.isEmpty())return h.EXTERIOR;var n=e.getExteriorRing(),n=this.locateInPolygonRing(t,n);if(n===h.EXTERIOR)return h.EXTERIOR;if(n===h.BOUNDARY)return h.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var i=e.getInteriorRingN(r),i=this.locateInPolygonRing(t,i);if(i===h.INTERIOR)return h.EXTERIOR;if(i===h.BOUNDARY)return h.BOUNDARY}return h.INTERIOR}var o,s;return arguments[0]instanceof v&&arguments[1]instanceof Oe?(n=arguments[0],(s=arguments[1]).getEnvelopeInternal().intersects(n)?(o=s.getCoordinates(),s.isClosed()||!n.equals(o[0])&&!n.equals(o[o.length-1])?m.isOnLine(n,o)?h.INTERIOR:h.EXTERIOR:h.BOUNDARY):h.EXTERIOR):arguments[0]instanceof v&&arguments[1]instanceof Ae?(s=arguments[0],arguments[1].getCoordinate().equals2D(s)?h.INTERIOR:h.EXTERIOR):void 0},Zr.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?m.locatePointInRing(t,e.getCoordinates()):h.EXTERIOR},Zr.prototype.intersects=function(t,e){return this.locate(t,e)!==h.EXTERIOR},Zr.prototype.updateLocationInfo=function(t){t===h.INTERIOR&&(this._isIn=!0),t===h.BOUNDARY&&this._numBoundaries++},Zr.prototype.computeLocation=function(t,e){if(e instanceof Ae&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Oe)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof De)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof _e)for(var n=e,r=0;r<n.getNumGeometries();r++){var i=n.getGeometryN(r);this.updateLocationInfo(this.locateInternal(t,i))}else if(e instanceof qe)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof ve)for(var u=new yr(e);u.hasNext();){var l=u.next();l!==e&&this.computeLocation(t,l)}},Zr.prototype.locate=function(t,e){return e.isEmpty()?h.EXTERIOR:e instanceof Oe||e instanceof De?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?h.BOUNDARY:0<this._numBoundaries||this._isIn?h.INTERIOR:h.EXTERIOR)},Zr.prototype.interfaces_=function(){return[]},Zr.prototype.getClass=function(){return Zr},{INSIDE_AREA:{configurable:!0}}),t=(ti.prototype.isInsideArea=function(){return this._segIndex===ti.INSIDE_AREA},ti.prototype.getCoordinate=function(){return this._pt},ti.prototype.getGeometryComponent=function(){return this._component},ti.prototype.getSegmentIndex=function(){return this._segIndex},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},t.INSIDE_AREA.get=function(){return-1},Object.defineProperties(ti,t),ei.prototype.filter=function(t){t instanceof Ae&&this._pts.add(t)},ei.prototype.interfaces_=function(){return[fe]},ei.prototype.getClass=function(){return ei},ei.getPoints=function(){var t,e;return 1===arguments.length?(t=arguments[0])instanceof Ae?Rn.singletonList(t):ei.getPoints(t,new b):2===arguments.length?(t=arguments[0],e=arguments[1],t instanceof Ae?e.add(t):t instanceof ve&&t.apply(new ei(e)),e):void 0},ni.prototype.filter=function(t){(t instanceof Ae||t instanceof Oe||t instanceof De)&&this._locations.add(new ti(t,0,t.getCoordinate()))},ni.prototype.interfaces_=function(){return[fe]},ni.prototype.getClass=function(){return ni},ni.getLocations=function(t){var e=new b;return t.apply(new ni(e)),e},ri.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var t=arguments[0],e=arguments[1],n=1-t,r=Kr.getPolygons(this._geom[t]);if(0<r.size()){var i=ni.getLocations(this._geom[n]);if(this.computeContainmentDistance(i,r,e),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[n]=e[0],this._minDistanceLocation[t]=e[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&g(arguments[0],Vt)&&g(arguments[1],Vt)){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=0;u<o.size();u++)for(var l=o.get(u),c=0;c<s.size();c++)if(this.computeContainmentDistance(l,s.get(c),a),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof ti&&arguments[1]instanceof De){i=arguments[0],r=arguments[1],n=arguments[2],t=i.getCoordinate();if(h.EXTERIOR!==this._ptLocator.locate(t,r))return n[this._minDistance=0]=i,n[1]=new ti(r,t),null}},ri.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(i,s,n),this._minDistance<=this._terminateDistance)return null}},ri.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Qr.getLines(this._geom[0]),n=Qr.getLines(this._geom[1]),r=ei.getPoints(this._geom[0]),i=ei.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,r,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance)?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(r,i,t),void this.updateMinDistance(t,!1))},ri.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},ri.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},ri.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},ri.prototype.computeMinDistance=function(){if(0===arguments.length)return null!==this._minDistanceLocation||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)?null:void this.computeFacetDistance();if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Oe&&arguments[1]instanceof Ae){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var r=t.getCoordinates(),i=e.getCoordinate(),o=0;o<r.length-1;o++){var s=m.distancePointLine(i,r[o],r[o+1]);if(s<this._minDistance&&(this._minDistance=s,s=new C(r[o],r[o+1]).closestPoint(i),n[0]=new ti(t,o,s),n[1]=new ti(e,0,i)),this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Oe&&arguments[1]instanceof Oe){var a=arguments[0],u=arguments[1],l=arguments[2];if(a.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var c=a.getCoordinates(),p=u.getCoordinates(),h=0;h<c.length-1;h++)for(var f=0;f<p.length-1;f++){var d,y=m.distanceLineLine(c[h],c[h+1],p[f],p[f+1]);if(y<this._minDistance&&(this._minDistance=y,y=new C(c[h],c[h+1]),d=new C(p[f],p[f+1]),y=y.closestPoints(d),l[0]=new ti(a,h,y[0]),l[1]=new ti(u,f,y[1])),this._minDistance<=this._terminateDistance)return null}}},ri.prototype.computeMinDistancePoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o),a=i.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new ti(i,0,i.getCoordinate()),n[1]=new ti(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},ri.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new p("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},ri.prototype.computeMinDistanceLines=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(i,s,n),this._minDistance<=this._terminateDistance)return null}},ri.prototype.interfaces_=function(){return[]},ri.prototype.getClass=function(){return ri},ri.distance=function(t,e){return new ri(t,e).distance()},ri.isWithinDistance=function(t,e,n){return new ri(t,e,n).distance()<=n},ri.nearestPoints=function(t,e){return new ri(t,e).nearestPoints()},ii.prototype.getCoordinates=function(){return this._pt},ii.prototype.getCoordinate=function(t){return this._pt[t]},ii.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];if(this._isNull)return this.initialize(t,e),null;var n=t.distance(e);n<this._distance&&this.initialize(t,e,n)}},ii.prototype.initialize=function(){var t,e,n;0===arguments.length?this._isNull=!0:2===arguments.length?(t=arguments[0],e=arguments[1],this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1):3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=n,this._isNull=!1)},ii.prototype.toString=function(){return mt.toLineString(this._pt[0],this._pt[1])},ii.prototype.getDistance=function(){return this._distance},ii.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];if(this._isNull)return this.initialize(t,e),null;var n=t.distance(e);n>this._distance&&this.initialize(t,e,n)}},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},oi.computeDistance=function(){if(arguments[2]instanceof ii&&arguments[0]instanceof Oe&&arguments[1]instanceof v)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=new C,i=t.getCoordinates(),o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof ii&&arguments[0]instanceof De&&arguments[1]instanceof v){var a=arguments[0],u=arguments[1],l=arguments[2];oi.computeDistance(a.getExteriorRing(),u,l);for(var c=0;c<a.getNumInteriorRing();c++)oi.computeDistance(a.getInteriorRingN(c),u,l)}else if(arguments[2]instanceof ii&&arguments[0]instanceof _&&arguments[1]instanceof v){var t=arguments[0],p=arguments[1],h=arguments[2];if(t instanceof Oe)oi.computeDistance(t,p,h);else if(t instanceof De)oi.computeDistance(t,p,h);else if(t instanceof ve)for(var f=t,d=0;d<f.getNumGeometries();d++){var y=f.getGeometryN(d);oi.computeDistance(y,p,h)}else h.setMinimum(t.getCoordinate(),p)}else{var g,m;arguments[2]instanceof ii&&arguments[0]instanceof C&&arguments[1]instanceof v&&(t=arguments[0],g=arguments[1],m=arguments[2],t=t.closestPoint(g),m.setMinimum(t,g))}},{MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}}),Ei=(si.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},si.prototype.setDensifyFraction=function(t){if(1<t||t<=0)throw new p("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},si.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},si.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},si.prototype.computeOrientedDistance=function(t,e,n){var r=new Ei(e);t.apply(r),n.setMaximum(r.getMaxPointDistance()),0<this._densifyFrac&&(r=new Si(e,this._densifyFrac),t.apply(r),n.setMaximum(r.getMaxPointDistance()))},si.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},si.prototype.interfaces_=function(){return[]},si.prototype.getClass=function(){return si},si.distance=function(){var t,e,n;return 2===arguments.length?new si(arguments[0],arguments[1]).distance():3===arguments.length?(n=arguments[0],t=arguments[1],e=arguments[2],(n=new si(n,t)).setDensifyFraction(e),n.distance()):void 0},t.MaxPointDistanceFilter.get=function(){return Ei},t.MaxDensifiedByFractionDistanceFilter.get=function(){return Si},Object.defineProperties(si,t),function(){this._maxPtDist=new ii,this._minPtDist=new ii,this._euclideanDist=new oi,this._geom=null,this._geom=arguments[0]}),Si=(Ei.prototype.filter=function(t){this._minPtDist.initialize(),oi.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ei.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ei.prototype.interfaces_=function(){return[Tt]},Ei.prototype.getClass=function(){return Ei},function(){this._maxPtDist=new ii,this._minPtDist=new ii,this._geom=null;var t=arguments[this._numSubSegs=0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))}),t=(Si.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),t=t.getCoordinate(e),r=(t.x-n.x)/this._numSubSegs,i=(t.y-n.y)/this._numSubSegs,o=0;o<this._numSubSegs;o++){var s=n.x+o*r,a=n.y+o*i,s=new v(s,a);this._minPtDist.initialize(),oi.computeDistance(this._geom,s,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Si.prototype.isDone=function(){return!1},Si.prototype.isGeometryChanged=function(){return!1},Si.prototype.getMaxPointDistance=function(){return this._maxPtDist},Si.prototype.interfaces_=function(){return[de]},Si.prototype.getClass=function(){return Si},{VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}}),t=(ai.prototype.checkMaximumDistance=function(t,e,n){e=new si(e,t);e.setDensifyFraction(.25),this._maxDistanceFound=e.orientedDistance(),this._maxDistanceFound>n&&(this._isValid=!1,n=e.getCoordinates(),this._errorLocation=n[1],this._errorIndicator=t.getFactory().createLineString(n),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+mt.toLineString(n[0],n[1])+")")},ai.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=ai.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(0<this._bufDistance?this.checkPositiveValid():this.checkNegativeValid(),ai.VERBOSE&&ct.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ai.prototype.checkNegativeValid=function(){var t;return(this._input instanceof De||this._input instanceof qe||this._input instanceof ve)&&(t=this.getPolygonLines(this._input),this.checkMinimumDistance(t,this._result,this._minValidDistance),this._isValid)?void this.checkMaximumDistance(t,this._result,this._maxValidDistance):null},ai.prototype.getErrorIndicator=function(){return this._errorIndicator},ai.prototype.checkMinimumDistance=function(t,e,n){e=new ri(t,e,n);this._minDistanceFound=e.distance(),this._minDistanceFound<n&&(this._isValid=!1,n=e.nearestPoints(),this._errorLocation=e.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(n),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+mt.toLineString(n[0],n[1])+" )")},ai.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},ai.prototype.getErrorLocation=function(){return this._errorLocation},ai.prototype.getPolygonLines=function(t){for(var e=new b,n=new Qr(e),r=Kr.getPolygons(t).iterator();r.hasNext();)r.next().apply(n);return t.getFactory().buildGeometry(e)},ai.prototype.getErrorMessage=function(){return this._errMsg},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},t.VERBOSE.get=function(){return!1},t.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ai,t),{VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}}),t=(ui.prototype.isValid=function(){return this.checkPolygonal(),this._isValid&&(this.checkExpectedEmpty(),this._isValid)&&(this.checkEnvelope(),this._isValid)&&(this.checkArea(),this._isValid)&&(this.checkDistance(),this._isValid)},ui.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*ui.MAX_ENV_DIFF_FRAC,e=(0===t&&(t=.001),new u(this._input.getEnvelopeInternal())),n=(e.expandBy(this._distance),new u(this._result.getEnvelopeInternal()));n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},ui.prototype.checkDistance=function(){var t=new ai(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},ui.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();0<this._distance&&e<t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},ui.prototype.checkPolygonal=function(){this._result instanceof De||this._result instanceof qe||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},ui.prototype.getErrorIndicator=function(){return this._errorIndicator},ui.prototype.getErrorLocation=function(){return this._errorLocation},ui.prototype.checkExpectedEmpty=function(){return 2<=this._input.getDimension()||0<this._distance?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},ui.prototype.report=function(t){if(!ui.VERBOSE)return null;ct.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},ui.prototype.getErrorMessage=function(){return this._errorMsg},ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui},ui.isValidMsg=function(t,e,n){t=new ui(t,e,n);return t.isValid()?null:t.getErrorMessage()},ui.isValid=function(t,e,n){return!!new ui(t,e,n).isValid()},t.VERBOSE.get=function(){return!1},t.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ui,t),li.prototype.getCoordinates=function(){return this._pts},li.prototype.size=function(){return this._pts.length},li.prototype.getCoordinate=function(t){return this._pts[t]},li.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},li.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:Jn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},li.prototype.setData=function(t){this._data=t},li.prototype.getData=function(){return this._data},li.prototype.toString=function(){return mt.toLineString(new Ue(this._pts))},li.prototype.interfaces_=function(){return[Wn]},li.prototype.getClass=function(){return li},ci.prototype.getInteriorIntersection=function(){return this._interiorIntersection},ci.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},ci.prototype.getIntersectionSegments=function(){return this._intSegments},ci.prototype.count=function(){return this._intersectionCount},ci.prototype.getIntersections=function(){return this._intersections},ci.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},ci.prototype.setKeepIntersections=function(t){this._keepIntersections=t},ci.prototype.processIntersections=function(t,e,n,r){var i;return(this._findAllIntersections||!this.hasIntersection())&&(t!==n||e!==r)&&(!this._isCheckEndSegmentsOnly||this.isEndSegment(t,e)||this.isEndSegment(n,r))?(i=t.getCoordinates()[e],t=t.getCoordinates()[e+1],e=n.getCoordinates()[r],n=n.getCoordinates()[r+1],this._li.computeIntersection(i,t,e,n),void(this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=i,this._intSegments[1]=t,this._intSegments[2]=e,this._intSegments[3]=n,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++))):null},ci.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},ci.prototype.hasIntersection=function(){return null!==this._interiorIntersection},ci.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},ci.prototype.interfaces_=function(){return[Or]},ci.prototype.getClass=function(){return ci},ci.createAllIntersectionsFinder=function(t){t=new ci(t);return t.setFindAllIntersections(!0),t},ci.createAnyIntersectionFinder=function(t){return new ci(t)},ci.createIntersectionCounter=function(t){t=new ci(t);return t.setFindAllIntersections(!0),t.setKeepIntersections(!1),t},pi.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},pi.prototype.getIntersections=function(){return this._segInt.getIntersections()},pi.prototype.isValid=function(){return this.execute(),this._isValid},pi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},pi.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new ci(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new or;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},pi.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new un(this.getErrorMessage(),this._segInt.getInteriorIntersection())},pi.prototype.getErrorMessage=function(){var t;return this._isValid?"no intersections found":(t=this._segInt.getIntersectionSegments(),"found non-noded intersection between "+mt.toLineString(t[0],t[1])+" and "+mt.toLineString(t[2],t[3]))},pi.prototype.interfaces_=function(){return[]},pi.prototype.getClass=function(){return pi},pi.computeIntersections=function(t){t=new pi(t);return t.setFindAllIntersections(!0),t.isValid(),t.getIntersections()},hi.prototype.checkValid=function(){this._nv.checkValid()},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi},hi.toSegmentStrings=function(t){for(var e=new b,n=t.iterator();n.hasNext();){var r=n.next();e.add(new li(r.getCoordinates(),r))}return e},hi.checkValid=function(t){new hi(t).checkValid()},fi.prototype.map=function(t){for(var e=new b,n=0;n<t.getNumGeometries();n++){var r=this._mapOp.map(t.getGeometryN(n));r.isEmpty()||e.add(r)}return t.getFactory().createGeometryCollection(w.toGeometryArray(e))},fi.prototype.interfaces_=function(){return[]},fi.prototype.getClass=function(){return fi},fi.map=function(t,e){return new fi(e).map(t)},di.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},di.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},di.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},di.prototype.collectLineEdge=function(t,e,n){var r=t.getLabel(),i=t.getEdge();t.isLineEdge()&&!t.isVisited()&&R.isResultOfOp(r,e)&&!i.isCovered()&&(n.add(i),t.setVisitedEdge(!0))},di.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getEdge();n.isLineEdge()&&!r.isCoveredSet()&&(n=this._op.isCoveredByA(n.getCoordinate()),r.setCovered(n))}},di.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getLabel();n.isIsolated()&&(r.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},di.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),r=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(r),n.setInResult(!0)}},di.prototype.collectBoundaryTouchEdge=function(t,e,n){var r=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(y.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(R.isResultOfOp(r,e)&&e===R.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},di.prototype.interfaces_=function(){return[]},di.prototype.getClass=function(){return di},yi.prototype.filterCoveredNodeToPoint=function(t){var t=t.getCoordinate();this._op.isCoveredByLA(t)||(t=this._geometryFactory.createPoint(t),this._resultPointList.add(t))},yi.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n,r=e.next();r.isInResult()||r.isIncidentEdgeInResult()||0!==r.getEdges().getDegree()&&t!==R.INTERSECTION||(n=r.getLabel(),R.isResultOfOp(n,t)&&this.filterCoveredNodeToPoint(r))}},yi.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi},gi.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},gi.prototype.transformPolygon=function(t,e){var n=!0,r=this.transformLinearRing(t.getExteriorRing(),t);null!==r&&r instanceof je&&!r.isEmpty()||(n=!1);for(var i,o=new b,s=0;s<t.getNumInteriorRing();s++){var a=this.transformLinearRing(t.getInteriorRingN(s),t);null===a||a.isEmpty()||(a instanceof je||(n=!1),o.add(a))}return n?this._factory.createPolygon(r,o.toArray([])):(i=new b,null!==r&&i.add(r),i.addAll(o),this._factory.buildGeometry(i))},gi.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},gi.prototype.getInputGeometry=function(){return this._inputGeom},gi.prototype.transformMultiLineString=function(t,e){for(var n=new b,r=0;r<t.getNumGeometries();r++){var i=this.transformLineString(t.getGeometryN(r),t);null===i||i.isEmpty()||n.add(i)}return this._factory.buildGeometry(n)},gi.prototype.transformCoordinates=function(t,e){return this.copy(t)},gi.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},gi.prototype.transformMultiPoint=function(t,e){for(var n=new b,r=0;r<t.getNumGeometries();r++){var i=this.transformPoint(t.getGeometryN(r),t);null===i||i.isEmpty()||n.add(i)}return this._factory.buildGeometry(n)},gi.prototype.transformMultiPolygon=function(t,e){for(var n=new b,r=0;r<t.getNumGeometries();r++){var i=this.transformPolygon(t.getGeometryN(r),t);null===i||i.isEmpty()||n.add(i)}return this._factory.buildGeometry(n)},gi.prototype.copy=function(t){return t.copy()},gi.prototype.transformGeometryCollection=function(t,e){for(var n=new b,r=0;r<t.getNumGeometries();r++){var i=this.transform(t.getGeometryN(r));null===i||this._pruneEmptyGeometry&&i.isEmpty()||n.add(i)}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(w.toGeometryArray(n)):this._factory.buildGeometry(n)},gi.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Ae)return this.transformPoint(t,null);if(t instanceof Fe)return this.transformMultiPoint(t,null);if(t instanceof je)return this.transformLinearRing(t,null);if(t instanceof Oe)return this.transformLineString(t,null);if(t instanceof _e)return this.transformMultiLineString(t,null);if(t instanceof De)return this.transformPolygon(t,null);if(t instanceof qe)return this.transformMultiPolygon(t,null);if(t instanceof ve)return this.transformGeometryCollection(t,null);throw new p("Unknown Geometry subtype: "+t.getClass().getName())},gi.prototype.transformLinearRing=function(t,e){var n,t=this.transformCoordinates(t.getCoordinateSequence(),t);return null===t?this._factory.createLinearRing(null):0<(n=t.size())&&n<4&&!this._preserveType?this._factory.createLineString(t):this._factory.createLinearRing(t)},gi.prototype.interfaces_=function(){return[]},gi.prototype.getClass=function(){return gi},mi.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),r=0;r<n;r++){var i=t.get(r),i=this.findSnapForVertex(i,e);null!==i&&(t.set(r,new v(i)),0===r)&&this._isClosed&&t.set(t.size()-1,new v(i))}},mi.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},mi.prototype.snapTo=function(t){var e=new Ht(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},mi.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var r=0;r<n;r++){var i=e[r],o=this.findSegmentIndexToSnap(i,t);0<=o&&t.add(o+1,new v(i),!1)}},mi.prototype.findSegmentIndexToSnap=function(t,e){for(var n=l.MAX_VALUE,r=-1,i=0;i<e.size()-1;i++){if(this._seg.p0=e.get(i),this._seg.p1=e.get(i+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,r=i)}return r},mi.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},mi.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])},{SNAP_PRECISION_FACTOR:{configurable:!0}}),Ii=(vi.prototype.snapTo=function(t,e){t=this.extractTargetCoordinates(t);return new Ii(e,t).transform(this._srcGeom)},vi.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),t=new Ii(t,n,!0).transform(this._srcGeom),n=t;return n=e&&g(t,Ce)?t.buffer(0):n},vi.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},vi.prototype.extractTargetCoordinates=function(t){for(var e=new J,n=t.getCoordinates(),r=0;r<n.length;r++)e.add(n[r]);return e.toArray(new Array(0).fill(null))},vi.prototype.computeMinimumSegmentLength=function(t){for(var e=l.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi},vi.snap=function(t,e,n){var r=new Array(2).fill(null),t=new vi(t),t=(r[0]=t.snapTo(e,n),new vi(e));return r[1]=t.snapTo(r[0],n),r},vi.computeOverlaySnapTolerance=function(){var t,e;return 1===arguments.length?(e=vi.computeSizeBasedSnapTolerance(t=arguments[0]),(t=t.getPrecisionModel()).getType()===a.FIXED&&e<(t=1/t.getScale()*2/1.415)?t:e):2===arguments.length?(t=arguments[0],e=arguments[1],Math.min(vi.computeOverlaySnapTolerance(t),vi.computeOverlaySnapTolerance(e))):void 0},vi.computeSizeBasedSnapTolerance=function(t){t=t.getEnvelopeInternal();return Math.min(t.getHeight(),t.getWidth())*vi.SNAP_PRECISION_FACTOR},vi.snapToSelf=function(t,e,n){return new vi(t).snapToSelf(e,n)},t.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(vi,t),(bi=gi)&&(Ni.__proto__=bi),((Ni.prototype=Object.create(bi&&bi.prototype)).constructor=Ni).prototype.snapLine=function(t,e){t=new mi(t,this._snapTolerance);return t.setAllowSnappingToSourceVertices(this._isSelfSnap),t.snapTo(e)},Ni.prototype.transformCoordinates=function(t,e){t=t.toCoordinateArray(),t=this.snapLine(t,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(t)},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni},Ni);function Ni(t,e,n){bi.call(this),this._snapTolerance=t||null,this._snapPts=e||null,this._isSelfSnap=void 0!==n&&n}_i.prototype.getCommon=function(){return l.longBitsToDouble(this._commonBits)},_i.prototype.add=function(t){t=l.doubleToLongBits(t);return this._isFirst?(this._commonBits=t,this._commonSignExp=_i.signExpBits(this._commonBits),this._isFirst=!1,null):_i.signExpBits(t)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=_i.numCommonMostSigMantissaBits(this._commonBits,t),void(this._commonBits=_i.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},_i.prototype.toString=function(){var t,e;if(1===arguments.length)return t=l.longBitsToDouble(e=arguments[0]),(e=(e="0000000000000000000000000000000000000000000000000000000000000000"+l.toBinaryString(e)).substring(e.length-64)).substring(0,1)+"  "+e.substring(1,12)+"(exp) "+e.substring(12)+" [ "+t+" ]"},_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i},_i.getBit=function(t,e){return 0!=(t&1<<e)?1:0},_i.signExpBits=function(t){return t>>52},_i.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},_i.numCommonMostSigMantissaBits=function(t,e){for(var n=0,r=52;0<=r;r--){if(_i.getBit(t,r)!==_i.getBit(e,r))return n;n++}return 52};function Oi(){this._commonCoord=null,this._ccFilter=new Di}function Ci(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()}function ki(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e}function Ai(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}function Mi(){var t,e,n;this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length?(t=arguments[0],e=arguments[1],this._eventType=Mi.DELETE,this._xValue=t,this._insertEvent=e):3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],this._eventType=Mi.INSERT,this._label=t,this._xValue=e,this._obj=n)}function Li(){}function Pi(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n}function Ti(){this._min=l.POSITIVE_INFINITY,this._max=l.NEGATIVE_INFINITY}var Ri,t={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}},Di=(Oi.prototype.addCommonBits=function(t){var e=new Fi(this._commonCoord);t.apply(e),t.geometryChanged()},Oi.prototype.removeCommonBits=function(t){var e;return 0===this._commonCoord.x&&0===this._commonCoord.y||((e=new v(this._commonCoord)).x=-e.x,e.y=-e.y,e=new Fi(e),t.apply(e),t.geometryChanged()),t},Oi.prototype.getCommonCoordinate=function(){return this._commonCoord},Oi.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Oi.prototype.interfaces_=function(){return[]},Oi.prototype.getClass=function(){return Oi},t.CommonCoordinateFilter.get=function(){return Di},t.Translater.get=function(){return Fi},Object.defineProperties(Oi,t),function(){this._commonBitsX=new _i,this._commonBitsY=new _i}),Fi=(Di.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},Di.prototype.getCommonCoordinate=function(){return new v(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Di.prototype.interfaces_=function(){return[Tt]},Di.prototype.getClass=function(){return Di},function(){this.trans=null,this.trans=arguments[0]}),t=(Fi.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,r)},Fi.prototype.isDone=function(){return!1},Fi.prototype.isGeometryChanged=function(){return!0},Fi.prototype.interfaces_=function(){return[de]},Fi.prototype.getClass=function(){return Fi},Ci.prototype.selfSnap=function(t){return new vi(t).snapTo(t,this._snapTolerance)},Ci.prototype.removeCommonBits=function(t){this._cbr=new Oi,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},Ci.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},Ci.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),e=R.overlayOp(e[0],e[1],t);return this.prepareResult(e)},Ci.prototype.checkValid=function(t){t.isValid()||ct.out.println("Snapped geometry is invalid")},Ci.prototype.computeSnapTolerance=function(){this._snapTolerance=vi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Ci.prototype.snap=function(t){t=this.removeCommonBits(t);return vi.snap(t[0],t[1],this._snapTolerance)},Ci.prototype.interfaces_=function(){return[]},Ci.prototype.getClass=function(){return Ci},Ci.overlayOp=function(t,e,n){return new Ci(t,e).getResultGeometry(n)},Ci.union=function(t,e){return Ci.overlayOp(t,e,R.UNION)},Ci.intersection=function(t,e){return Ci.overlayOp(t,e,R.INTERSECTION)},Ci.symDifference=function(t,e){return Ci.overlayOp(t,e,R.SYMDIFFERENCE)},Ci.difference=function(t,e){return Ci.overlayOp(t,e,R.DIFFERENCE)},ki.prototype.getResultGeometry=function(t){var e=null,n=!1,r=null;try{e=R.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof Et))throw t;r=t}if(!n)try{e=Ci.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof Et?r:t}return e},ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki},ki.overlayOp=function(t,e,n){return new ki(t,e).getResultGeometry(n)},ki.union=function(t,e){return ki.overlayOp(t,e,R.UNION)},ki.intersection=function(t,e){return ki.overlayOp(t,e,R.INTERSECTION)},ki.symDifference=function(t,e){return ki.overlayOp(t,e,R.SYMDIFFERENCE)},ki.difference=function(t,e){return ki.overlayOp(t,e,R.DIFFERENCE)},Ai.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},Ai.prototype.interfaces_=function(){return[]},Ai.prototype.getClass=function(){return Ai},{INSERT:{configurable:!0},DELETE:{configurable:!0}}),ji=(Mi.prototype.isDelete=function(){return this._eventType===Mi.DELETE},Mi.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},Mi.prototype.getObject=function(){return this._obj},Mi.prototype.compareTo=function(t){return this._xValue<t._xValue?-1:this._xValue>t._xValue?1:this._eventType<t._eventType?-1:this._eventType>t._eventType?1:0},Mi.prototype.getInsertEvent=function(){return this._insertEvent},Mi.prototype.isInsert=function(){return this._eventType===Mi.INSERT},Mi.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},Mi.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Mi.prototype.interfaces_=function(){return[tt]},Mi.prototype.getClass=function(){return Mi},t.INSERT.get=function(){return 1},t.DELETE.get=function(){return 2},Object.defineProperties(Mi,t),Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Pi.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(Pi.isAdjacentSegments(e,r))return!0;if(t.isClosed()){n=t.getNumPoints()-1;if(0===e&&r===n||0===r&&e===n)return!0}}return!1},Pi.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Pi.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},Pi.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Pi.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next().getCoordinate();if(t.isIntersection(r))return!0}return!1},Pi.prototype.hasProperIntersection=function(){return this._hasProper},Pi.prototype.hasIntersection=function(){return this._hasIntersection},Pi.prototype.isDone=function(){return this._isDone},Pi.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},Pi.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},Pi.prototype.addIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Pi.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},(Ri=Li)&&(qi.__proto__=Ri),((qi.prototype=Object.create(Ri&&Ri.prototype)).constructor=qi).prototype.prepareEvents=function(){Rn.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},qi.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else{var r,i,o;3===arguments.length&&(arguments[2]instanceof Pi&&g(arguments[0],Vt)&&g(arguments[1],Vt)?(i=arguments[0],o=arguments[1],r=arguments[2],this.addEdges(i,i),this.addEdges(o,o),this.computeIntersections(r)):"boolean"==typeof arguments[2]&&g(arguments[0],Vt)&&arguments[1]instanceof Pi&&(i=arguments[0],o=arguments[1],arguments[2]?this.addEdges(i,null):this.addEdges(i),this.computeIntersections(o)))}},qi.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),r=n.getStartIndexes(),i=0;i<r.length-1;i++){var o=new Ai(n,i),o=new Mi(e,n.getMinX(i),o);this.events.add(o),this.events.add(new Mi(n.getMaxX(i),o))}},qi.prototype.processOverlaps=function(t,e,n,r){for(var i=n.getObject(),o=t;o<e;o++){var s,a=this.events.get(o);a.isInsert()&&(s=a.getObject(),n.isSameLabel(a)||(i.computeIntersections(s,r),this.nOverlaps++))}},qi.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1],i=n.iterator();i.hasNext();){var o=i.next();this.addEdge(o,r)}},qi.prototype.interfaces_=function(){return[]},qi.prototype.getClass=function(){return qi},qi),t={NodeComparator:{configurable:!0}};function qi(){Ri.call(this),this.events=new b,this.nOverlaps=null}Ti.prototype.getMin=function(){return this._min},Ti.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},Ti.prototype.getMax=function(){return this._max},Ti.prototype.toString=function(){return mt.toLineString(new v(this._min,0),new v(this._max,0))},Ti.prototype.interfaces_=function(){return[]},Ti.prototype.getClass=function(){return Ti},t.NodeComparator.get=function(){return Ui},Object.defineProperties(Ti,t);function Bi(){this._leaves=new b,this._root=null,this._level=0}var Gi,zi,Ui=function(){},Vi=(Ui.prototype.compare=function(t,e){t=(t._min+t._max)/2,e=(e._min+e._max)/2;return t<e?-1:e<t?1:0},Ui.prototype.interfaces_=function(){return[nt]},Ui.prototype.getClass=function(){return Ui},(zi=Ti)&&(Yi.__proto__=zi),((Yi.prototype=Object.create(zi&&zi.prototype)).constructor=Yi).prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi},Yi),$i=((Gi=Ti)&&(Xi.__proto__=Gi),((Xi.prototype=Object.create(Gi&&Gi.prototype)).constructor=Xi).prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},Xi.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi},Xi);function Xi(){Gi.call(this),this._node1=null,this._node2=null;var t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)}function Yi(){zi.call(this),this._item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n}Bi.prototype.buildTree=function(){Rn.sort(this._leaves,new Ti.NodeComparator);for(var t,e=this._leaves,n=new b;;){if(this.buildLevel(e,n),1===n.size())return n.get(0);t=e,e=n,n=t}},Bi.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Vi(t,e,n))},Bi.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},Bi.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},Bi.prototype.printNode=function(t){ct.out.println(mt.toLineString(new v(t._min,this._level),new v(t._max,this._level)))},Bi.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},Bi.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var r=t.get(n);null===(n+1<t.size()?t.get(n):null)?e.add(r):(r=new $i(t.get(n),t.get(n+1)),e.add(r))}},Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi};function Ji(){this._items=new b}function Wi(){this._index=null;var t=arguments[0];if(!g(t,Ce))throw new p("Argument must be Polygonal");this._index=new Zi(t)}Ji.prototype.visitItem=function(t){this._items.add(t)},Ji.prototype.getItems=function(){return this._items},Ji.prototype.interfaces_=function(){return[Ln]},Ji.prototype.getClass=function(){return Ji};function Hi(){var t,e,n;this._li=new At,this._resultPrecisionModel=null,this._arg=null,1===arguments.length?(this.setComputationPrecision((t=arguments[0]).getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new to(0,t)):2===arguments.length?(t=arguments[0],e=arguments[1],n=Rt.OGC_SFS_BOUNDARY_RULE,0<=t.getPrecisionModel().compareTo(e.getPrecisionModel())?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new to(0,t,n),this._arg[1]=new to(1,e,n)):3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],0<=t.getPrecisionModel().compareTo(e.getPrecisionModel())?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new to(0,t,n),this._arg[1]=new to(1,e,n))}var Ki,t={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}},Qi=(Wi.prototype.locate=function(t){var e=new Lt(t),n=new Qi(e);return this._index.query(t.y,t.y,n),e.getLocation()},Wi.prototype.interfaces_=function(){return[dr]},Wi.prototype.getClass=function(){return Wi},t.SegmentVisitor.get=function(){return Qi},t.IntervalIndexedGeometry.get=function(){return Zi},Object.defineProperties(Wi,t),function(){this._counter=null,this._counter=arguments[0]}),Zi=(Qi.prototype.visitItem=function(t){this._counter.countSegment(t.getCoordinate(0),t.getCoordinate(1))},Qi.prototype.interfaces_=function(){return[Ln]},Qi.prototype.getClass=function(){return Qi},function(){this._index=new Bi,this.init(arguments[0])}),to=(Zi.prototype.init=function(t){for(var e=Qr.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},Zi.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new C(t[e-1],t[e]),r=Math.min(n.p0.y,n.p1.y),i=Math.max(n.p0.y,n.p1.y);this._index.insert(r,i,n)}},Zi.prototype.query=function(){var t,e,n;if(2===arguments.length)return t=arguments[0],e=arguments[1],n=new Ji,this._index.query(t,e,n),n.getItems();3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi},(Ki=On)&&(T.__proto__=Ki),((T.prototype=Object.create(Ki&&Ki.prototype)).constructor=T).prototype.insertBoundaryPoint=function(t,e){var e=this._nodes.addNode(e).getLabel(),n=1,n=(e.getLocation(t,x.ON)===h.BOUNDARY&&n++,T.determineBoundary(this._boundaryNodeRule,n));e.setLocation(t,n)},T.prototype.computeSelfNodes=function(){var t,e,n,r;return 2===arguments.length?this.computeSelfNodes(arguments[0],arguments[1],!1):3===arguments.length?(e=arguments[0],t=arguments[1],n=arguments[2],(e=new Pi(e,!0,!1)).setIsDoneIfProperInt(n),n=this.createEdgeSetIntersector(),r=this._parentGeom instanceof je||this._parentGeom instanceof De||this._parentGeom instanceof qe,n.computeIntersections(this._edges,e,t||!r),this.addSelfIntersectionNodes(this._argIndex),e):void 0},T.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},T.prototype.computeEdgeIntersections=function(t,e,n){e=new Pi(e,n,!0);return e.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,e),e},T.prototype.getGeometry=function(){return this._parentGeom},T.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},T.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},T.prototype.addPoint=function(){var t;arguments[0]instanceof Ae?(t=arguments[0].getCoordinate(),this.insertPoint(this._argIndex,t,h.INTERIOR)):arguments[0]instanceof v&&this.insertPoint(this._argIndex,arguments[0],h.INTERIOR)},T.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),h.EXTERIOR,h.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,h.INTERIOR,h.EXTERIOR)}},T.prototype.addEdge=function(t){this.insertEdge(t);t=t.getCoordinates();this.insertPoint(this._argIndex,t[0],h.BOUNDARY),this.insertPoint(this._argIndex,t[t.length-1],h.BOUNDARY)},T.prototype.addLineString=function(t){var e=c.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new Dr(e,new S(this._argIndex,h.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),y.isTrue(2<=e.length,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},T.prototype.getInvalidPoint=function(){return this._invalidPoint},T.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,r=t.iterator();r.hasNext();){var i=r.next();e[n++]=i.getCoordinate().copy()}return e},T.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},T.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===h.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},T.prototype.addPolygonRing=function(t,e,n){var r,i,o;return t.isEmpty()?null:(r=c.removeRepeatedPoints(t.getCoordinates())).length<4?(this._hasTooFewPoints=!0,this._invalidPoint=r[0],null):(i=e,o=n,m.isCCW(r)&&(i=n,o=e),n=new Dr(r,new S(this._argIndex,h.BOUNDARY,i,o)),this._lineEdgeMap.put(t,n),this.insertEdge(n),void this.insertPoint(this._argIndex,r[0],h.BOUNDARY))},T.prototype.insertPoint=function(t,e,n){var e=this._nodes.addNode(e),r=e.getLabel();null===r?e._label=new S(t,n):r.setLocation(t,n)},T.prototype.createEdgeSetIntersector=function(){return new ji},T.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),i=n.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(t,o.coord,r)}},T.prototype.add=function(){if(1!==arguments.length)return Ki.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof qe&&(this._useBoundaryDeterminationRule=!1),t instanceof De)this.addPolygon(t);else if(t instanceof Oe)this.addLineString(t);else if(t instanceof Ae)this.addPoint(t);else{if(!(t instanceof Fe||t instanceof _e||t instanceof qe||t instanceof ve))throw new Error(t.getClass().getName());this.addCollection(t)}},T.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},T.prototype.locate=function(t){return g(this._parentGeom,Ce)&&50<this._parentGeom.getNumGeometries()?(null===this._areaPtLocator&&(this._areaPtLocator=new Wi(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},T.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):Ki.prototype.findEdge.apply(this,arguments)},T.prototype.interfaces_=function(){return[]},T.prototype.getClass=function(){return T},T.determineBoundary=function(t,e){return t.isInBoundary(e)?h.BOUNDARY:h.INTERIOR},T);function T(){var t,e,n;Ki.call(this),this._parentGeom=null,this._lineEdgeMap=new We,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Zr,2===arguments.length?(t=arguments[0],n=arguments[1],e=Rt.OGC_SFS_BOUNDARY_RULE,this._argIndex=t,this._parentGeom=n,this._boundaryNodeRule=e,null!==n&&this.add(n)):3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=n,null!==e)&&this.add(e)}Hi.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Hi.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Hi.prototype.interfaces_=function(){return[]},Hi.prototype.getClass=function(){return Hi};function eo(){}eo.prototype.interfaces_=function(){return[]},eo.prototype.getClass=function(){return eo},eo.map=function(){if(arguments[0]instanceof _&&g(arguments[1],eo.MapOp)){for(var t=arguments[0],e=arguments[1],n=new b,r=0;r<t.getNumGeometries();r++){var i=e.map(t.getGeometryN(r));null!==i&&n.add(i)}return t.getFactory().buildGeometry(n)}if(g(arguments[0],Dt)&&g(arguments[1],eo.MapOp)){for(var o=arguments[0],s=arguments[1],a=new b,u=o.iterator();u.hasNext();){var l=u.next(),l=s.map(l);null!==l&&a.add(l)}return a}},eo.MapOp=function(){},(no=Hi)&&(ro.__proto__=no),((ro.prototype=Object.create(no&&no.prototype)).constructor=ro).prototype.insertUniqueEdge=function(t){var e,n,r=this._edgeList.findEqualEdge(t);null!==r?(e=r.getLabel(),n=t.getLabel(),r.isPointwiseEqual(t)||(n=new S(t.getLabel())).flip(),(r=r.getDepth()).isNull()&&r.add(e),r.add(n),e.merge(n)):this._edgeList.add(t)},ro.prototype.getGraph=function(){return this._graph},ro.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},ro.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},ro.prototype.computeGeometry=function(t,e,n,r){var i=new b;return i.addAll(t),i.addAll(e),i.addAll(n),i.isEmpty()?ro.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(i)},ro.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},ro.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(this._ptLocator.locate(t,r)!==h.EXTERIOR)return!0}return!1},ro.prototype.replaceCollapsedEdges=function(){for(var t=new b,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},ro.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},ro.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},ro.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},ro.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new b,e=(this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),hi.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges(),new Cn(this._geomFact)),e=(e.add(this._graph),this._resultPolyList=e.getPolygons(),new di(this,this._geomFact,this._ptLocator)),e=(this._resultLineList=e.build(t),new yi(this,this._geomFact,this._ptLocator));this._resultPointList=e.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},ro.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},ro.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},ro.prototype.findResultAreaEdges=function(t){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getLabel();r.isArea()&&!n.isInteriorAreaEdge()&&ro.isResultOfOp(r.getLocation(0,x.RIGHT),r.getLocation(1,x.RIGHT),t)&&n.setInResult(!0)}},ro.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),r=e.getDepth();if(!r.isNull()){r.normalize();for(var i=0;i<2;i++)n.isNull(i)||!n.isArea()||r.isNull(i)||(0===r.getDelta(i)?n.toLine(i):(y.isTrue(!r.isNull(i,x.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(i,x.LEFT,r.getLocation(i,x.LEFT)),y.isTrue(!r.isNull(i,x.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(i,x.RIGHT,r.getLocation(i,x.RIGHT))))}}},ro.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},ro.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},ro.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},ro.prototype.interfaces_=function(){return[]},ro.prototype.getClass=function(){return ro};var no,R=ro;function ro(){var t=arguments[0];no.call(this,t,arguments[1]),this._ptLocator=new Zr,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Nr,this._resultPolyList=new b,this._resultLineList=new b,this._resultPointList=new b,this._graph=new On(new Er),this._geomFact=t.getFactory()}R.overlayOp=function(t,e,n){return new R(t,e).getResultGeometry(n)},R.intersection=function(t,e){var n;return t.isEmpty()||e.isEmpty()?R.createEmptyResult(R.INTERSECTION,t,e,t.getFactory()):t.isGeometryCollection()?(n=e,fi.map(t,{interfaces_:function(){return[eo.MapOp]},map:function(t){return t.intersection(n)}})):(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ki.overlayOp(t,e,R.INTERSECTION))},R.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return R.createEmptyResult(R.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ki.overlayOp(t,e,R.SYMDIFFERENCE)},R.resultDimension=function(t,e,n){var r=e.getDimension(),i=n.getDimension(),o=-1;switch(t){case R.INTERSECTION:o=Math.min(r,i);break;case R.UNION:o=Math.max(r,i);break;case R.DIFFERENCE:o=r;break;case R.SYMDIFFERENCE:o=Math.max(r,i)}return o},R.createEmptyResult=function(t,e,n,r){var i=null;switch(R.resultDimension(t,e,n)){case-1:i=r.createGeometryCollection(new Array(0).fill(null));break;case 0:i=r.createPoint();break;case 1:i=r.createLineString();break;case 2:i=r.createPolygon()}return i},R.difference=function(t,e){return t.isEmpty()?R.createEmptyResult(R.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ki.overlayOp(t,e,R.DIFFERENCE))},R.isResultOfOp=function(){var t,e,n;if(2===arguments.length)return n=arguments[0],t=arguments[1],e=n.getLocation(0),n=n.getLocation(1),R.isResultOfOp(e,n,t);if(3===arguments.length){var r=arguments[0],i=arguments[1];switch(r===h.BOUNDARY&&(r=h.INTERIOR),i===h.BOUNDARY&&(i=h.INTERIOR),arguments[2]){case R.INTERSECTION:return r===h.INTERIOR&&i===h.INTERIOR;case R.UNION:return r===h.INTERIOR||i===h.INTERIOR;case R.DIFFERENCE:return r===h.INTERIOR&&i!==h.INTERIOR;case R.SYMDIFFERENCE:return r===h.INTERIOR&&i!==h.INTERIOR||r!==h.INTERIOR&&i===h.INTERIOR}return!1}},R.INTERSECTION=1,R.UNION=2,R.DIFFERENCE=3,R.SYMDIFFERENCE=4;function io(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Zr,this._seg=new C;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)}function oo(){this._g=null,this._doLeft=!0,this._doRight=!0,this._g=arguments[0]}function so(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=so.TOLERANCE,this._testCoords=new b;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundaryDistanceTolerance=so.computeBoundaryDistanceTolerance(t,e),this._geom=[t,e,n],this._locFinder=[new io(this._geom[0],this._boundaryDistanceTolerance),new io(this._geom[1],this._boundaryDistanceTolerance),new io(this._geom[2],this._boundaryDistanceTolerance)]}function ao(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=ao.extractFactory(t),this._inputGeoms=t}function uo(){this._inputPolys=null,this._geomFactory=null,this._inputPolys=arguments[0],null===this._inputPolys&&(this._inputPolys=new b)}function lo(){}io.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),r=0;r<n.size()-1;r++)if(n.getCoordinate(r,this._seg.p0),n.getCoordinate(r+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},io.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?h.BOUNDARY:this._ptLocator.locate(t,this._g)},io.prototype.extractLinework=function(t){var e=new co,e=(t.apply(e),e.getLinework()),e=w.toLineStringArray(e);return t.getFactory().createMultiLineString(e)},io.prototype.interfaces_=function(){return[]},io.prototype.getClass=function(){return io};var co=function(){this._linework=null,this._linework=new b},t=(co.prototype.getLinework=function(){return this._linework},co.prototype.filter=function(t){if(t instanceof De){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},co.prototype.interfaces_=function(){return[fe]},co.prototype.getClass=function(){return co},oo.prototype.extractPoints=function(t,e,n){for(var r=t.getCoordinates(),i=0;i<r.length-1;i++)this.computeOffsetPoints(r[i],r[i+1],e,n)},oo.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},oo.prototype.getPoints=function(t){for(var e=new b,n=Qr.getLines(this._g).iterator();n.hasNext();){var r=n.next();this.extractPoints(r,t,e)}return e},oo.prototype.computeOffsetPoints=function(t,e,n,r){var i=e.x-t.x,o=e.y-t.y,s=Math.sqrt(i*i+o*o),i=n*i/s,n=n*o/s,o=(e.x+t.x)/2,s=(e.y+t.y)/2;this._doLeft&&(e=new v(o-n,s+i),r.add(e)),this._doRight&&(t=new v(o+n,s-i),r.add(t))},oo.prototype.interfaces_=function(){return[]},oo.prototype.getClass=function(){return oo},{TOLERANCE:{configurable:!0}}),t=(so.prototype.reportResult=function(t,e,n){ct.out.println("Overlay result invalid - A:"+h.toLocationSymbol(e[0])+" B:"+h.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+h.toLocationSymbol(e[2]))},so.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},so.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}var r,i;if(2===arguments.length)return r=arguments[0],this._location[0]=this._locFinder[0].getLocation(i=arguments[1]),this._location[1]=this._locFinder[1].getLocation(i),this._location[2]=this._locFinder[2].getLocation(i),!!so.hasLocation(this._location,h.BOUNDARY)||this.isValidResult(r,this._location)},so.prototype.addTestPts=function(t){t=new oo(t);this._testCoords.addAll(t.getPoints(5*this._boundaryDistanceTolerance))},so.prototype.isValidResult=function(t,e){var n=R.isResultOfOp(e[0],e[1],t),r=!(n^e[2]===h.INTERIOR);return r||this.reportResult(t,e,n),r},so.prototype.getInvalidLocation=function(){return this._invalidLocation},so.prototype.interfaces_=function(){return[]},so.prototype.getClass=function(){return so},so.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},so.computeBoundaryDistanceTolerance=function(t,e){return Math.min(vi.computeSizeBasedSnapTolerance(t),vi.computeSizeBasedSnapTolerance(e))},so.isValid=function(t,e,n,r){return new so(t,e,r).isValid(n)},t.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(so,t),ao.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);this._skipEmpty&&r.isEmpty()||e.add(r)}},ao.prototype.combine=function(){for(var t=new b,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},ao.prototype.interfaces_=function(){return[]},ao.prototype.getClass=function(){return ao},ao.combine=function(){return 1===arguments.length?new ao(arguments[0]).combine():2===arguments.length?new ao(ao.createList(arguments[0],arguments[1])).combine():3===arguments.length?new ao(ao.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},ao.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},ao.createList=function(){var t,e,n,r;return 2===arguments.length?(t=arguments[0],e=arguments[1],(n=new b).add(t),n.add(e),n):3===arguments.length?(t=arguments[0],e=arguments[1],n=arguments[2],(r=new b).add(t),r.add(e),r.add(n),r):void 0},{STRTREE_NODE_CAPACITY:{configurable:!0}});uo.prototype.reduceToGeometries=function(t){for(var e=new b,n=t.iterator();n.hasNext();){var r=n.next(),i=null;g(r,Vt)?i=this.unionTree(r):r instanceof _&&(i=r),e.add(i)}return e},uo.prototype.extractByEnvelope=function(t,e,n){for(var r=new b,i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);(o.getEnvelopeInternal().intersects(t)?r:n).add(o)}return this._geomFactory.buildGeometry(r)},uo.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();return n.intersects(r)?t.getNumGeometries()<=1&&e.getNumGeometries()<=1?this.unionActual(t,e):(n=n.intersection(r),this.unionUsingEnvelopeIntersection(t,e,n)):ao.combine(t,e)},uo.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new Un(uo.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var r=t.itemsTree();return this.unionTree(r)},uo.prototype.binaryUnion=function(){var t,e,n,r;return 1===arguments.length?this.binaryUnion(r=arguments[0],0,r.size()):3===arguments.length?(r=arguments[0],n=arguments[1],(t=arguments[2])-n<=1?(e=uo.getGeometry(r,n),this.unionSafe(e,null)):t-n==2?this.unionSafe(uo.getGeometry(r,n),uo.getGeometry(r,n+1)):(e=Math.trunc((t+n)/2),n=this.binaryUnion(r,n,e),r=this.binaryUnion(r,e,t),this.unionSafe(n,r))):void 0},uo.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();)var r=n.next(),e=null===e?r.copy():e.union(r);return e},uo.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},uo.prototype.unionActual=function(t,e){return uo.restrictToPolygons(t.union(e))},uo.prototype.unionTree=function(t){t=this.reduceToGeometries(t);return this.binaryUnion(t)},uo.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var r=new b,t=this.extractByEnvelope(n,t,r),n=this.extractByEnvelope(n,e,r),e=this.unionActual(t,n);return r.add(e),ao.combine(r)},uo.prototype.bufferUnion=function(){var t,e;return 1===arguments.length?(t=arguments[0]).get(0).getFactory().buildGeometry(t).buffer(0):2===arguments.length?(t=arguments[0],e=arguments[1],t.getFactory().createGeometryCollection([t,e]).buffer(0)):void 0},uo.prototype.interfaces_=function(){return[]},uo.prototype.getClass=function(){return uo},uo.restrictToPolygons=function(t){var e;return g(t,Ce)?t:1===(e=Kr.getPolygons(t)).size()?e.get(0):t.getFactory().createMultiPolygon(w.toPolygonArray(e))},uo.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},uo.union=function(t){return new uo(t).union()},t.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(uo,t);lo.prototype.interfaces_=function(){return[]},lo.prototype.getClass=function(){return lo},lo.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return R.createEmptyResult(R.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ki.overlayOp(t,e,R.UNION)},D.GeoJSONReader=Qe,D.GeoJSONWriter=Ze,D.OverlayOp=R,D.UnionOp=lo,D.BufferOp=Yr,Object.defineProperty(D,"__esModule",{value:!0})},"object"==_typeof3(n)&&void 0!==e?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i(r.jsts={})},{}],288:[function(o,r,i){!function(n){!function(){var t,e;t=n,e=function(){return n=[function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(t){return typeof t}:e.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}e.exports=n},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e,n){"use strict";t.exports=function(){function g(t,e,n,r,i,o){return t=b((t>>>0).toString(e),i||0,"0",!1),x(t,"",n,r,o)}function m(t,e,n,r,i){return null!=r&&(t=t.slice(0,r)),x(t,"",e,n,i)}var v=arguments,_=0,t=v[_++],b=function(t,e,n,r){n=n||" ";e=t.length>=e?"":new Array(1+e-t.length>>>0).join(n);return r?t+e:e+t},x=function(t,e,n,r,i){var o=r-t.length;return t=0<o?n||"0"!==i?b(t,r,i,n):[t.slice(0,e.length),b("",o,"0",!0),t.slice(e.length)].join(""):t};try{return t.replace(/%%|%(?:(\d+)\$)?((?:[-+#0 ]|'[\s\S])*)(\d+)?(?:\.(\d*))?([\s\S])/g,function(t,e,n,r,i,o){var s,a,u,l,c;if("%%"===t)return"%";for(var p=" ",h=!1,f="",d=0,y=n.length;d<y;d++)switch(n.charAt(d)){case" ":case"0":p=n.charAt(d);break;case"+":f="+";break;case"-":h=!0;break;case"'":d+1<y&&(p=n.charAt(d+1),d++)}if(r=r?+r:0,!isFinite(r))throw new Error("Width must be finite");if(i=i?+i:"d"===o?0:-1<"fFeE".indexOf(o)?6:void 0,e&&0==+e)throw new Error("Argument number must be greater than zero");if(e&&v.length<=+e)throw new Error("Too few arguments");switch(c=e?v[+e]:v[_++],o){case"%":return"%";case"s":return m(c+"",h,r,i,p);case"c":return m(String.fromCharCode(+c),h,r,i,p);case"b":return g(c,2,h,r,i,p);case"o":return g(c,8,h,r,i,p);case"x":return g(c,16,h,r,i,p);case"X":return g(c,16,h,r,i,p).toUpperCase();case"u":return g(c,10,h,r,i,p);case"i":case"d":return s=+c||0,c=(a=(s=Math.round(s-s%1))<0?"-":f)+b(String(Math.abs(s)),i,"0",!1),x(c,a,h,r,p=h&&"0"===p?" ":p);case"e":case"E":case"f":case"F":case"g":case"G":return a=(s=+c)<0?"-":f,u=["toExponential","toFixed","toPrecision"]["efg".indexOf(o.toLowerCase())],l=["toString","toUpperCase"]["eEfFgG".indexOf(o)%2],c=a+Math.abs(s)[u](i),x(c,a,h,r,p)[l]();default:return""}})}catch(t){return!1}}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(t){return _typeof3(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof3(t)};t.exports=function(t){switch(void 0===t?"undefined":r(t)){case"number":return isNaN(t)||!isFinite(t)?0:t<0?Math.ceil(t):Math.floor(t);case"string":return parseInt(t,10)||0;default:return+!!t}}},function(t,e){t.exports=o("path")},function(t,e,n){"use strict";t.exports=n(8)()},function(t,e,n){"use strict";t.exports=function t(){var e={VERSION:"1.14.0"};return n(9)(e),n(10)(e),n(11)(e),n(18)(e),n(19)(e),n(20)(e),n(31)(e),n(32)(e),n(34)(e),n(35)(e),n(36)(e),n(37)(e),n(38)(e),n(39)(e),n(40)(e),e.exports.factory=t,e.exports}},function(t,e,n){"use strict";var r=n(0)(n(2));function i(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){(0,r.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}t.exports=function(v){function c(t,e){if(t.template.options.rethrow)throw"TwigException"!==(e="string"==typeof e?new v.Error(e):e).type||e.file||(e.file=t.template.id),e;if(v.log.error("Error parsing twig template "+t.template.id+": "),e.stack?v.log.error(e.stack):v.log.error(e.toString()),v.debug)return e.toString()}return v.trace=!1,v.debug=!1,v.cache=!0,v.noop=function(){},v.merge=function(e,n,r){return Object.keys(n).forEach(function(t){(!r||t in e)&&(e[t]=n[t])}),e},v.Error=function(t,e){this.message=t,this.name="TwigException",this.type="TwigException",this.file=e},v.Error.prototype.toString=function(){return this.name+": "+this.message},v.log={trace:function(){if(v.trace&&console){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log(Array.prototype.slice.call(e))}},debug:function(){if(v.debug&&console){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log(Array.prototype.slice.call(e))}}},"undefined"==typeof console?v.log.error=function(){}:void 0!==console.error?v.log.error=function(){var t;(t=console).error.apply(t,arguments)}:void 0!==console.log&&(v.log.error=function(){var t;(t=console).log.apply(t,arguments)}),v.token={},v.token.type={output:"output",logic:"logic",comment:"comment",raw:"raw",outputWhitespacePre:"output_whitespace_pre",outputWhitespacePost:"output_whitespace_post",outputWhitespaceBoth:"output_whitespace_both",logicWhitespacePre:"logic_whitespace_pre",logicWhitespacePost:"logic_whitespace_post",logicWhitespaceBoth:"logic_whitespace_both"},v.token.definitions=[{type:v.token.type.raw,open:"{% raw %}",close:"{% endraw %}"},{type:v.token.type.raw,open:"{% verbatim %}",close:"{% endverbatim %}"},{type:v.token.type.outputWhitespacePre,open:"{{-",close:"}}"},{type:v.token.type.outputWhitespacePost,open:"{{",close:"-}}"},{type:v.token.type.outputWhitespaceBoth,open:"{{-",close:"-}}"},{type:v.token.type.logicWhitespacePre,open:"{%-",close:"%}"},{type:v.token.type.logicWhitespacePost,open:"{%",close:"-%}"},{type:v.token.type.logicWhitespaceBoth,open:"{%-",close:"-%}"},{type:v.token.type.output,open:"{{",close:"}}"},{type:v.token.type.logic,open:"{%",close:"%}"},{type:v.token.type.comment,open:"{#",close:"#}"}],v.token.strings=['"',"'"],v.token.findStart=function(t){for(var e,n,r,i={position:null,def:null},o=null,s=v.token.definitions.length,a=0;a<s;a++)e=v.token.definitions[a],n=t.indexOf(e.open),r=t.indexOf(e.close),v.log.trace("Twig.token.findStart: ","Searching for ",e.open," found at ",n),0<=n&&e.open.length!==e.close.length&&r<0||(0<=n&&(null===i.position||n<i.position)||0<=n&&null!==i.position&&n===i.position&&(e.open.length>i.def.open.length||e.open.length===i.def.open.length&&(e.close.length,i.def.close.length,0<=r)&&r<o))&&(i.position=n,i.def=e,o=r);return i},v.token.findEnd=function(t,e,n){for(var r,i,o,s,a,u=null,l=!1,c=0,p=null,h=null,f=null;!l;){if(h=p=null,!(0<=(r=t.indexOf(e.close,c))))throw new v.Error("Unable to find closing bracket '"+e.close+"' opened near template position "+n);if(u=r,l=!0,e.type===v.token.type.comment)break;if(e.type===v.token.type.raw)break;for(a=v.token.strings.length,s=0;s<a;s+=1)0<(i=t.indexOf(v.token.strings[s],c))&&i<r&&(null===p||i<p)&&(p=i,h=v.token.strings[s]);if(null!==p)for(f=p+1,u=null,l=!1;;){if((o=t.indexOf(h,f))<0)throw v.Error("Unclosed string in template");if("\\"!==t.slice(o-1,o)){c=o+1;break}f=o+1}}return u},v.tokenize=function(t){for(var e,n=[],r=0,i=null;0<t.length;)if(e=v.token.findStart(t),v.log.trace("Twig.tokenize: ","Found token: ",e),null===e.position)n.push({type:v.token.type.raw,value:t}),t="";else{if(0<e.position&&n.push({type:v.token.type.raw,value:t.slice(0,Math.max(0,e.position))}),t=t.slice(e.position+e.def.open.length),r+=e.position+e.def.open.length,i=v.token.findEnd(t,e.def,r),v.log.trace("Twig.tokenize: ","Token ends at ",i),n.push({type:e.def.type,value:t.slice(0,Math.max(0,i)).trim()}),"\n"===t.slice(i+e.def.close.length,i+e.def.close.length+1))switch(e.def.type){case"logic_whitespace_pre":case"logic_whitespace_post":case"logic_whitespace_both":case"logic":i+=1}t=t.slice(i+e.def.close.length),r+=i+e.def.close.length}return n},v.compile=function(t){var e=this;try{for(var n,r,i=[],o=[],s=[],a=null,u=null,l=null,c=null,p=null,h=null,f=null,d=null,y=null,g=function(t){v.expression.compile.call(e,t),(0<o.length?s:i).push(t)},m=function(t){if(a=v.logic.compile.call(e,t),f=a.type,d=v.logic.handler[f].open,y=v.logic.handler[f].next,v.log.trace("Twig.compile: ","Compiled logic token to ",a," next is: ",y," open is : ",d),void 0!==d&&!d){if(u=o.pop(),!v.logic.handler[u.type].next.includes(f))throw new Error(f+" not expected after a "+u.type);u.output=u.output||[],u.output=u.output.concat(s),s=[],h={type:v.token.type.logic,token:u},(0<o.length?s:i).push(h)}void 0!==y&&0<y.length?(v.log.trace("Twig.compile: ","Pushing ",a," to logic stack."),0<o.length&&((u=o.pop()).output=u.output||[],u.output=u.output.concat(s),o.push(u),s=[]),o.push(a)):void 0!==d&&d&&(h={type:v.token.type.logic,token:a},(0<o.length?s:i).push(h))};0<t.length;){switch(n=t.shift(),l=i[i.length-1],c=s[s.length-1],p=t[0],v.log.trace("Compiling token ",n),n.type){case v.token.type.raw:(0<o.length?s:i).push(n);break;case v.token.type.logic:m.call(e,n);break;case v.token.type.comment:break;case v.token.type.output:g.call(e,n);break;case v.token.type.logicWhitespacePre:case v.token.type.logicWhitespacePost:case v.token.type.logicWhitespaceBoth:case v.token.type.outputWhitespacePre:case v.token.type.outputWhitespacePost:case v.token.type.outputWhitespaceBoth:switch(n.type!==v.token.type.outputWhitespacePost&&n.type!==v.token.type.logicWhitespacePost&&(l&&l.type===v.token.type.raw&&(i.pop(),l.value=l.value.trimEnd(),i.push(l)),c)&&c.type===v.token.type.raw&&(s.pop(),c.value=c.value.trimEnd(),s.push(c)),n.type){case v.token.type.outputWhitespacePre:case v.token.type.outputWhitespacePost:case v.token.type.outputWhitespaceBoth:g.call(e,n);break;case v.token.type.logicWhitespacePre:case v.token.type.logicWhitespacePost:case v.token.type.logicWhitespaceBoth:m.call(e,n)}n.type!==v.token.type.outputWhitespacePre&&n.type!==v.token.type.logicWhitespacePre&&p&&p.type===v.token.type.raw&&(t.shift(),p.value=p.value.trimStart(),t.unshift(p))}v.log.trace("Twig.compile: "," Output: ",i," Logic Stack: ",o," Pending Output: ",s)}if(0<o.length)throw r=o.pop(),new Error("Unable to find an end tag for "+r.type+", expecting one of "+r.next);return i}catch(t){if(e.options.rethrow)throw"TwigException"!==t.type||t.file||(t.file=e.id),t;v.log.error("Error compiling twig template "+e.id+": "),t.stack?v.log.error(t.stack):v.log.error(t.toString())}},v.prepare=function(t){v.log.debug("Twig.prepare: ","Tokenizing ",t);t=v.tokenize.call(this,t),v.log.debug("Twig.prepare: ","Compiling ",t),t=v.compile.call(this,t);return v.log.debug("Twig.prepare: ","Compiled ",t),t},v.output=function(t){var e,n=this.options.autoescape;return n?(e="string"==typeof n?n:"html",0===(n=t.map(function(t){return t=!t||!0===t.twigMarkup||t.twigMarkup===e||"html"===e&&"html_attr"===t.twigMarkup?t:v.filters.escape(t,[e])})).length||0===(n=n.join("")).length?"":new v.Markup(n,!0)):t.join("")},v.Templates={loaders:{},parsers:{},registry:{}},v.validateId=function(t){if("prototype"===t)throw new v.Error(t+" is not a valid twig identifier");if(v.cache&&Object.hasOwnProperty.call(v.Templates.registry,t))throw new v.Error("There is already a template with the ID "+t);return!0},v.Templates.registerLoader=function(t,e,n){if("function"!=typeof e)throw new v.Error("Unable to add loader for "+t+": Invalid function reference given.");n&&(e=e.bind(n)),this.loaders[t]=e},v.Templates.unRegisterLoader=function(t){this.isRegisteredLoader(t)&&delete this.loaders[t]},v.Templates.isRegisteredLoader=function(t){return Object.hasOwnProperty.call(this.loaders,t)},v.Templates.registerParser=function(t,e,n){if("function"!=typeof e)throw new v.Error("Unable to add parser for "+t+": Invalid function regerence given.");n&&(e=e.bind(n)),this.parsers[t]=e},v.Templates.unRegisterParser=function(t){this.isRegisteredParser(t)&&delete this.parsers[t]},v.Templates.isRegisteredParser=function(t){return Object.hasOwnProperty.call(this.parsers,t)},v.Templates.save=function(t){if(void 0===t.id)throw new v.Error("Unable to save template with no id");v.Templates.registry[t.id]=t},v.Templates.load=function(t){return Object.hasOwnProperty.call(v.Templates.registry,t)?v.Templates.registry[t]:null},v.Templates.loadRemote=function(t,e,n,r){var i=void 0===e.id?t:e.id,o=v.Templates.registry[i];return v.cache&&void 0!==o?("function"==typeof n&&n(o),o):(e.parser=e.parser||"twig",e.id=i,void 0===e.async&&(e.async=!0),(this.loaders[e.method]||this.loaders.fs).call(this,t,e,n,r))},v.Block=function(t,e){this.template=t,this.token=e},v.Block.prototype.render=function(e,n){var r=e.template;return e.template=this.template,(this.token.expression?v.expression.parseAsync.call(e,this.token.output,n):e.parseAsync(this.token.output,n)).then(function(t){return v.expression.parseAsync.call(e,{type:v.expression.type.string,value:t},n)}).then(function(t){return e.template=r,t})},v.ParseState=function(t,e){this.renderedBlocks={},this.overrideBlocks=void 0===e?{}:e,this.context={},this.macros={},this.nestingStack=[],this.template=t},v.ParseState.prototype.getBlock=function(t,e){var n;return n=void 0===(n=void 0===(n=!0!==e?this.overrideBlocks[t]:n)?this.template.getBlock(t,e):n)&&null!==this.template.parentTemplate?this.template.parentTemplate.getBlock(t):n},v.ParseState.prototype.getBlocks=function(t){var e={};return e=o(o(o({},e=!1!==t&&null!==this.template.parentTemplate&&this.template.parentTemplate!==this.template?this.template.parentTemplate.getBlocks():e),this.template.getBlocks()),this.overrideBlocks)},v.ParseState.prototype.getNestingStackToken=function(e){var n;return this.nestingStack.forEach(function(t){void 0===n&&t.type===e&&(n=t)}),n},v.ParseState.prototype.parse=function(t,e,n){var r=this,i=[],o=null,s=!0,a=!0;function u(t){i.push(t)}function l(t){void 0!==t.chain&&(a=t.chain),void 0!==t.context&&(r.context=t.context),void 0!==t.output&&i.push(t.output)}if(e&&(r.context=e),e=v.async.forEach(t,function(t){switch(v.log.debug("Twig.ParseState.parse: ","Parsing token: ",t),t.type){case v.token.type.raw:i.push(v.filters.raw(t.value));break;case v.token.type.logic:return v.logic.parseAsync.call(r,t.token,r.context,a).then(l);case v.token.type.comment:break;case v.token.type.outputWhitespacePre:case v.token.type.outputWhitespacePost:case v.token.type.outputWhitespaceBoth:case v.token.type.output:return v.log.debug("Twig.ParseState.parse: ","Output token: ",t.stack),v.expression.parseAsync.call(r,t.stack,r.context).then(u)}}).then(function(){return i=v.output.call(r.template,i),s=!1,i}).catch(function(t){n&&c(r,t),o=t}),n)return e;if(null!==o)return c(r,o);if(s)throw new v.Error("You are using Twig.js in sync mode in combination with async extensions.");return i},v.Template=function(t){var e=t.data,n=t.id,r=t.base,i=t.path,o=t.url,s=t.name,a=t.method,t=t.options;this.base=r,this.blocks={defined:{},imported:{}},this.id=n,this.method=a,this.name=s,this.options=t,this.parentTemplate=null,this.path=i,this.url=o,r="String",a=e,s=Object.prototype.toString.call(a).slice(8,-1),this.tokens=null!=a&&s===r?v.prepare.call(this,e):e,void 0!==n&&v.Templates.save(this)},v.Template.prototype.getBlock=function(t,e){var n;return!0!==e&&(n=this.blocks.defined[t]),n=void 0===(n=(!(2<arguments.length&&void 0!==arguments[2])||arguments[2])&&void 0===n?this.blocks.imported[t]:n)&&null!==this.parentTemplate?this.parentTemplate.getBlock(t,e,!1):n},v.Template.prototype.getBlocks=function(){return o(o(o({},{}),this.blocks.imported),this.blocks.defined)},v.Template.prototype.render=function(t,i,e){var o=this;return i=i||{},v.async.potentiallyAsync(o,e,function(){var r=new v.ParseState(o,i.blocks);return r.parseAsync(o.tokens,t).then(function(t){var e,n;return null!==o.parentTemplate?(o.options.allowInlineIncludes&&(e=v.Templates.load(o.parentTemplate))&&(e.options=o.options),e||(n=v.path.parsePath(o,o.parentTemplate),e=v.Templates.loadRemote(n,{method:o.getLoaderMethod(),base:o.base,async:!1,id:n,options:o.options})),o.parentTemplate=e,o.parentTemplate.renderAsync(r.context,{blocks:r.getBlocks(!1),isInclude:!0})):!0===i.isInclude?t:t.valueOf()})})},v.Template.prototype.importFile=function(t){var e;if(this.url||!this.options.allowInlineIncludes)return e=v.path.parsePath(this,t),e=v.Templates.loadRemote(e,{method:this.getLoaderMethod(),base:this.base,async:!1,options:this.options,id:e});if(t=this.path?v.path.parsePath(this,t):t,e=(e=v.Templates.load(t))||v.Templates.loadRemote(null,{id:t,method:this.getLoaderMethod(),async:!1,path:t,options:this.options}))return e.options=this.options,e;throw new v.Error("Unable to find the template "+t)},v.Template.prototype.getLoaderMethod=function(){return this.path?"fs":this.url?"ajax":this.method||"fs"},v.Template.prototype.compile=function(t){return v.compiler.compile(this,t)},v.Markup=function(t,e){return"string"!=typeof t||((t=new String(t)).twigMarkup=void 0===e||e),t},v}},function(t,e,n){"use strict";t.exports=function(i){return i.compiler={module:{}},i.compiler.compile=function(t,e){var n=JSON.stringify(t.tokens),t=t.id,r=null;if(e.module){if(void 0===i.compiler.module[e.module])throw new i.Error("Unable to find module type "+e.module);r=i.compiler.module[e.module](t,n,e.twig)}else r=i.compiler.wrap(t,n);return r},i.compiler.module={amd:function(t,e,n){return'define(["'+n+'"], function (Twig) {\n\tvar twig, templates;\ntwig = Twig.twig;\ntemplates = '+i.compiler.wrap(t,e)+"\n\treturn templates;\n});"},node:function(t,e){return'var twig = require("twig").twig;\nexports.template = '+i.compiler.wrap(t,e)},cjs2:function(t,e,n){return'module.declare([{ twig: "'+n+'" }], function (require, exports, module) {\n\tvar twig = require("twig").twig;\n\texports.template = '+i.compiler.wrap(t,e)+"\n});"}},i.compiler.wrap=function(t,e){return'twig({id:"'+t.replace('"','\\"')+'", data:'+e+", precompiled: true});\n"},i}},function(t,e,n){"use strict";var r=n(0),c=r(n(1)),s=r(n(12));t.exports=function(f){function l(t,e,n){return e?f.expression.parseAsync.call(t,e,n):f.Promise.resolve(!1)}for(f.expression={},n(17)(f),f.expression.reservedWords=["true","false","null","TRUE","FALSE","NULL","_context","and","b-and","or","b-or","b-xor","in","not in","if","matches","starts","ends","with"],f.expression.type={comma:"Twig.expression.type.comma",operator:{unary:"Twig.expression.type.operator.unary",binary:"Twig.expression.type.operator.binary"},string:"Twig.expression.type.string",bool:"Twig.expression.type.bool",slice:"Twig.expression.type.slice",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},subexpression:{start:"Twig.expression.type.subexpression.start",end:"Twig.expression.type.subexpression.end"},key:{period:"Twig.expression.type.key.period",brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",_function:"Twig.expression.type._function",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",_null:"Twig.expression.type.null",context:"Twig.expression.type.context",test:"Twig.expression.type.test"},f.expression.set={operations:[f.expression.type.filter,f.expression.type.operator.unary,f.expression.type.operator.binary,f.expression.type.array.end,f.expression.type.object.end,f.expression.type.parameter.end,f.expression.type.subexpression.end,f.expression.type.comma,f.expression.type.test],expressions:[f.expression.type._function,f.expression.type.bool,f.expression.type.string,f.expression.type.variable,f.expression.type.number,f.expression.type._null,f.expression.type.context,f.expression.type.parameter.start,f.expression.type.array.start,f.expression.type.object.start,f.expression.type.subexpression.start,f.expression.type.operator.unary]},f.expression.set.operationsExtended=f.expression.set.operations.concat([f.expression.type.key.period,f.expression.type.key.brackets,f.expression.type.slice]),f.expression.fn={compile:{push:function(t,e,n){n.push(t)},pushBoth:function(t,e,n){n.push(t),e.push(t)}},parse:{push:function(t,e){e.push(t)},pushValue:function(t,e){e.push(t.value)}}},f.expression.definitions=[{type:f.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_]\w*(\s?as)?)/,next:f.expression.set.operations.concat([f.expression.type.parameter.start]),compile:function(t,e,n){t.filter=t.match[2],t.modifier=t.match[1],delete t.match,delete t.value,n.push(t)},parse:function(e,n,t){var r=n.pop();return l(this,e.params,t).then(function(t){t=f.test(e.filter,r,t);"not"===e.modifier?n.push(!t):n.push(t)})}},{type:f.expression.type.comma,regex:/^,/,next:f.expression.set.expressions.concat([f.expression.type.array.end,f.expression.type.object.end]),compile:function(t,e,n){var r,i=e.length-1;for(delete t.match,delete t.value;0<=i;i--){if((r=e.pop()).type===f.expression.type.object.start||r.type===f.expression.type.parameter.start||r.type===f.expression.type.array.start){e.push(r);break}n.push(r)}n.push(t)}},{type:f.expression.type.number,regex:/^-?\d+(\.\d+)?/,next:f.expression.set.operations,compile:function(t,e,n){t.value=Number(t.value),n.push(t)},parse:f.expression.fn.parse.pushValue},{type:f.expression.type.operator.binary,regex:/(^\?\?|^\?:|^(b-and)|^(b-or)|^(b-xor)|^[+\-~%?]|^[:](?!\d\])|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^(and)[(|\s+]|^(or)[(|\s+]|^(in)[(|\s+]|^(not in)[(|\s+]|^(matches)|^(starts with)|^(ends with)|^\.\.)/,next:f.expression.set.expressions,transform:function(t,e){switch(t[0]){case"and(":case"or(":case"in(":case"not in(":return e[e.length-1].value=t[2],t[0];default:return""}},compile:function(t,e,n){delete t.match,t.value=t.value.trim();var r=t.value,i=f.expression.operator.lookup(r,t);for(f.log.trace("Twig.expression.compile: ","Operator: ",i," from ",r);0<e.length&&(e[e.length-1].type===f.expression.type.operator.unary||e[e.length-1].type===f.expression.type.operator.binary)&&(i.associativity===f.expression.operator.leftToRight&&i.precidence>=e[e.length-1].precidence||i.associativity===f.expression.operator.rightToLeft&&i.precidence>e[e.length-1].precidence);){var o=e.pop();n.push(o)}if(":"===r){if(!e[e.length-1]||"?"!==e[e.length-1].value){r=n.pop();if(r.type===f.expression.type.string||r.type===f.expression.type.variable)t.key=r.value;else if(r.type===f.expression.type.number)t.key=r.value.toString();else{if(!r.expression||r.type!==f.expression.type.parameter.end&&r.type!==f.expression.type.subexpression.end)throw new f.Error("Unexpected value before ':' of "+r.type+" = "+r.value);t.params=r.params}n.push(t)}}else e.push(i)},parse:function(e,n,r){if(e.key)n.push(e);else{if(e.params)return f.expression.parseAsync.call(this,e.params,r).then(function(t){e.key=t,n.push(e),r.loop||delete e.params});f.expression.operator.parse(e.value,n)}}},{type:f.expression.type.operator.unary,regex:/(^not\s+)/,next:f.expression.set.expressions,compile:function(t,e,n){delete t.match,t.value=t.value.trim();var r=t.value,i=f.expression.operator.lookup(r,t);for(f.log.trace("Twig.expression.compile: ","Operator: ",i," from ",r);0<e.length&&(e[e.length-1].type===f.expression.type.operator.unary||e[e.length-1].type===f.expression.type.operator.binary)&&(i.associativity===f.expression.operator.leftToRight&&i.precidence>=e[e.length-1].precidence||i.associativity===f.expression.operator.rightToLeft&&i.precidence>e[e.length-1].precidence);){var o=e.pop();n.push(o)}e.push(i)},parse:function(t,e){f.expression.operator.parse(t.value,e)}},{type:f.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2[\s\S])*?\1/,next:f.expression.set.operationsExtended,compile:function(t,e,n){var r=t.value;delete t.match,r='"'===r.slice(0,1)?r.replace('\\"','"'):r.replace("\\'","'"),t.value=r.slice(1,-1).replace(/\\n/g,"\n").replace(/\\r/g,"\r"),f.log.trace("Twig.expression.compile: ","String value: ",t.value),n.push(t)},parse:f.expression.fn.parse.pushValue},{type:f.expression.type.subexpression.start,regex:/^\(/,next:f.expression.set.expressions.concat([f.expression.type.subexpression.end]),compile:function(t,e,n){t.value="(",n.push(t),e.push(t)},parse:f.expression.fn.parse.push},{type:f.expression.type.subexpression.end,regex:/^\)/,next:f.expression.set.operationsExtended,validate:function(t,e){for(var n=e.length-1,r=!1,i=!1,o=0;!r&&0<=n;){var s=e[n];(r=s.type===f.expression.type.subexpression.start)&&i&&(r=i=!1),s.type===f.expression.type.parameter.start?o++:s.type===f.expression.type.parameter.end?o--:s.type===f.expression.type.subexpression.end&&(i=!0),n--}return r&&0===o},compile:function(t,e,n){for(var r=t,i=e.pop();0<e.length&&i.type!==f.expression.type.subexpression.start;)n.push(i),i=e.pop();for(var o=[];t.type!==f.expression.type.subexpression.start;)o.unshift(t),t=n.pop();o.unshift(t),void 0===(i=e[e.length-1])||i.type!==f.expression.type._function&&i.type!==f.expression.type.filter&&i.type!==f.expression.type.test&&i.type!==f.expression.type.key.brackets?(r.expression=!0,o.pop(),o.shift(),r.params=o,n.push(r)):(r.expression=!1,i.params=o)},parse:function(t,e,n){if(t.expression)return f.expression.parseAsync.call(this,t.params,n).then(function(t){e.push(t)});throw new f.Error("Unexpected subexpression end when token is not marked as an expression")}},{type:f.expression.type.parameter.start,regex:/^\(/,next:f.expression.set.expressions.concat([f.expression.type.parameter.end]),validate:function(t,e){e=e[e.length-1];return e&&!f.expression.reservedWords.includes(e.value.trim())},compile:f.expression.fn.compile.pushBoth,parse:f.expression.fn.parse.push},{type:f.expression.type.parameter.end,regex:/^\)/,next:f.expression.set.operationsExtended,compile:function(t,e,n){for(var r=t,i=e.pop();0<e.length&&i.type!==f.expression.type.parameter.start;)n.push(i),i=e.pop();for(var o=[];t.type!==f.expression.type.parameter.start;)o.unshift(t),t=n.pop();o.unshift(t),void 0===(t=n[n.length-1])||t.type!==f.expression.type._function&&t.type!==f.expression.type.filter&&t.type!==f.expression.type.test&&t.type!==f.expression.type.key.brackets?(r.expression=!0,o.pop(),o.shift(),r.params=o,n.push(r)):(r.expression=!1,t.params=o)},parse:function(t,e,n){var r,i=[],o=!1;if(t.expression)return f.expression.parseAsync.call(this,t.params,n).then(function(t){e.push(t)});for(;0<e.length;){if((r=e.pop())&&r.type&&r.type===f.expression.type.parameter.start){o=!0;break}i.unshift(r)}if(!o)throw new f.Error("Expected end of parameter set.");e.push(i)}},{type:f.expression.type.slice,regex:/^\[(\d*:\d*)\]/,next:f.expression.set.operationsExtended,compile:function(t,e,n){var r=t.match[1].split(":"),i=r[0]?parseInt(r[0],10):void 0,r=r[1]?parseInt(r[1],10):void 0;t.value="slice",t.params=[i,r],r||(t.params=[i]),n.push(t)},parse:function(t,e){var n=e.pop(),r=t.params;e.push(f.filter.call(this,t.value,n,r))}},{type:f.expression.type.array.start,regex:/^\[/,next:f.expression.set.expressions.concat([f.expression.type.array.end]),compile:f.expression.fn.compile.pushBoth,parse:f.expression.fn.parse.push},{type:f.expression.type.array.end,regex:/^\]/,next:f.expression.set.operationsExtended,compile:function(t,e,n){for(var r,i=e.length-1;0<=i&&(r=e.pop()).type!==f.expression.type.array.start;i--)n.push(r);n.push(t)},parse:function(t,e){for(var n,r=[],i=!1;0<e.length;){if((n=e.pop())&&n.type&&n.type===f.expression.type.array.start){i=!0;break}r.unshift(n)}if(!i)throw new f.Error("Expected end of array.");e.push(r)}},{type:f.expression.type.object.start,regex:/^\{/,next:f.expression.set.expressions.concat([f.expression.type.object.end]),compile:f.expression.fn.compile.pushBoth,parse:f.expression.fn.parse.push},{type:f.expression.type.object.end,regex:/^\}/,next:f.expression.set.operationsExtended,compile:function(t,e,n){for(var r,i=e.length-1;0<=i&&(!(r=e.pop())||r.type!==f.expression.type.object.start);i--)n.push(r);n.push(t)},parse:function(t,e){for(var n,r={},i=!1,o=!1,s=null;0<e.length;){if((n=e.pop())&&n.type&&n.type===f.expression.type.object.start){i=!0;break}if(n&&n.type&&(n.type===f.expression.type.operator.binary||n.type===f.expression.type.operator.unary)&&n.key){if(!o)throw new f.Error("Missing value for key '"+n.key+"' in object definition.");r[n.key]=s,void 0===r._keys&&(r._keys=[]),r._keys.unshift(n.key),s=null,o=!1}else o=!0,s=n}if(!i)throw new f.Error("Unexpected end of object.");e.push(r)}},{type:f.expression.type.filter,regex:/^\|\s?([a-zA-Z_][a-zA-Z0-9_-]*)/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:function(t,e,n){t.value=t.match[1],n.push(t)},parse:function(e,n,t){var r=n.pop(),i=this;return l(i,e.params,t).then(function(t){return f.filter.call(i,e.value,r,t)}).then(function(t){n.push(t)})}},{type:f.expression.type._function,regex:/^([a-zA-Z_]\w*)\s*\(/,next:f.expression.type.parameter.start,validate:function(t){return t[1]&&!f.expression.reservedWords.includes(t[1])},transform:function(){return"("},compile:function(t,e,n){var r=t.match[1];t.fn=r,delete t.match,delete t.value,n.push(t)},parse:function(t,e,n){var r,i=this,o=t.fn;return l(i,t.params,n).then(function(t){if(f.functions[o])r=f.functions[o].apply(i,t);else{if("function"!=typeof n[o])throw new f.Error(o+" function does not exist and is not defined in the context");r=n[o].apply(n,(0,s.default)(t))}return r}).then(function(t){e.push(t)})}},{type:f.expression.type.variable,regex:/^[a-zA-Z_]\w*/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:f.expression.fn.compile.push,validate:function(t){return!f.expression.reservedWords.includes(t[0])},parse:function(e,n,t){var r=this;return f.expression.resolveAsync.call(r,t[e.value],t).then(function(t){if(r.template.options.strictVariables&&void 0===t)throw new f.Error('Variable "'+e.value+'" does not exist.');n.push(t)})}},{type:f.expression.type.key.period,regex:/^\.(\w+)/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:function(t,e,n){t.key=t.match[1],delete t.match,delete t.value,n.push(t)},parse:function(t,e,n,r){var i,o=this,s=t.key,a=e.pop();if(a&&!Object.prototype.hasOwnProperty.call(a,s)&&o.template.options.strictVariables)throw 0<Object.keys(a).length?new f.Error('Key "'+s+'" for object with keys "'+Object.keys(a).join(", ")+'" does not exist.'):new f.Error('Key "'+s+'" does not exist as the object is empty.');return l(o,t.params,n).then(function(t){var e;return i=null==a?void 0:(e=function(t){return t.slice(0,1).toUpperCase()+t.slice(1)},"object"===(0,c.default)(a)&&s in a?a[s]:a["get"+e(s)]?a["get"+e(s)]:a["is"+e(s)]?a["is"+e(s)]:void 0),f.expression.resolveAsync.call(o,i,n,t,r,a)}).then(function(t){e.push(t)})}},{type:f.expression.type.key.brackets,regex:/^\[([^\]:]*)\]/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:function(t,e,n){var r=t.match[1];delete t.value,delete t.match,t.stack=f.expression.compile({value:r}).stack,n.push(t)},parse:function(e,n,r,i){var o,s,a=this,u=null;return l(a,e.params,r).then(function(t){return u=t,f.expression.parseAsync.call(a,e.stack,r)}).then(function(t){var e;if((o=n.pop())&&!Object.prototype.hasOwnProperty.call(o,t)&&a.template.options.strictVariables)throw 0<(e=Object.keys(o)).length?new f.Error('Key "'+t+'" for array with keys "'+e.join(", ")+'" does not exist.'):new f.Error('Key "'+t+'" does not exist as the array is empty.');return null==o?null:(s="object"===(0,c.default)(o)&&t in o?o[t]:null,f.expression.resolveAsync.call(a,s,o,u,i))}).then(function(t){n.push(t)})}},{type:f.expression.type._null,regex:/^(null|NULL|none|NONE)/,next:f.expression.set.operations,compile:function(t,e,n){delete t.match,t.value=null,n.push(t)},parse:f.expression.fn.parse.pushValue},{type:f.expression.type.context,regex:/^_context/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:f.expression.fn.compile.push,parse:function(t,e,n){e.push(n)}},{type:f.expression.type.bool,regex:/^(true|TRUE|false|FALSE)/,next:f.expression.set.operations,compile:function(t,e,n){t.value="true"===t.match[0].toLowerCase(),delete t.match,n.push(t)},parse:f.expression.fn.parse.pushValue}],f.expression.resolveAsync=function(e,n,t,r,i){var o=this;return"function"!=typeof e?f.Promise.resolve(e):(t=f.Promise.resolve(t),r&&r.type===f.expression.type.parameter.end&&(t=t.then(function(){return r.params&&f.expression.parseAsync.call(o,r.params,n,!0)}).then(function(t){return r.cleanup=!0,t})),t.then(function(t){return e.apply(i||n,t||[])}))},f.expression.resolve=function(t,e,n,r,i){return f.async.potentiallyAsync(this,!1,function(){return f.expression.resolveAsync.call(this,t,e,n,r,i)})},f.expression.handler={},f.expression.extendType=function(t){f.expression.type[t]="Twig.expression.type."+t},f.expression.extend=function(t){if(!t.type)throw new f.Error("Unable to extend logic definition. No type provided for "+t);f.expression.handler[t.type]=t};0<f.expression.definitions.length;)f.expression.extend(f.expression.definitions.shift());return f.expression.tokenize=function(t){function e(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r,i=arguments.length-2,o=new Array(i);0<i--;)o[i]=e[i];return f.log.trace("Twig.expression.tokenize","Matched a ",s," regular expression of ",o),p&&!p.includes(s)?(h.push(s+" cannot follow a "+l[l.length-1].type+" at template:"+c+" near '"+o[0].slice(0,20)+"...'"),o[0]):(r=f.expression.handler[s]).validate&&!r.validate(o,l)?o[0]:(h=[],l.push({type:s,value:o[0],match:o}),u=!0,p=a,c+=o[0].length,r.transform?r.transform(o,l):"")}var s,n,r,a,u,l=[],c=0,p=null,h=[];for(f.log.debug("Twig.expression.tokenize","Tokenizing expression ",t);0<t.length;){for(s in t=t.trim(),f.expression.handler)if(Object.hasOwnProperty.call(f.expression.handler,s)){if(a=f.expression.handler[s].next,n=f.expression.handler[s].regex,f.log.trace("Checking type ",s," on ",t),u=!1,Array.isArray(n))for(r=n.length;0<r--;)t=t.replace(n[r],e);else t=t.replace(n,e);if(u)break}if(!u)throw 0<h.length?new f.Error(h.join(" OR ")):new f.Error("Unable to parse '"+t+"' at template position"+c)}return f.log.trace("Twig.expression.tokenize","Tokenized to ",l),l},f.expression.compile=function(t){var e,n=t.value,r=f.expression.tokenize(n),i=[],o=[],s=null;for(f.log.trace("Twig.expression.compile: ","Compiling ",n);0<r.length;)e=r.shift(),s=f.expression.handler[e.type],f.log.trace("Twig.expression.compile: ","Compiling ",e),s.compile(e,o,i),f.log.trace("Twig.expression.compile: ","Stack is",o),f.log.trace("Twig.expression.compile: ","Output is",i);for(;0<o.length;)i.push(o.pop());return f.log.trace("Twig.expression.compile: ","Final output is",i),t.stack=i,delete t.value,t},f.expression.parse=function(o,s,r,t){var a=this,u=(Array.isArray(o)||(o=[o]),[]),l=[],c=f.expression.type.operator.binary;return f.async.potentiallyAsync(a,t,function(){return f.async.forEach(o,function(t,e){var n,r=null,i=null;if(!t.cleanup)return o.length>e+1&&(i=o[e+1]),(r=f.expression.handler[t.type]).parse&&(n=r.parse.call(a,t,u,s,i)),t.type===c&&s.loop&&l.push(t),n}).then(function(){for(var t,e=l.length,n=null;0<e--;)(n=l[e]).params&&n.key&&delete n.key;return r&&(t=u.splice(0),u.push(t)),u.pop()})})},f}},function(t,e,n){var r=n(13),i=n(14),o=n(15),s=n(16);t.exports=function(t){return r(t)||i(t)||o(t)||s()}},function(t,e,n){var r=n(3);t.exports=function(t){if(Array.isArray(t))return r(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e,n){var r=n(3);t.exports=function(t,e){var n;if(t)return"string"==typeof t?r(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){"use strict";t.exports=function(a){a.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};function u(t,e){if(null==e)return null;if(void 0!==e.indexOf)return(t===e||""!==t)&&e.includes(t);for(var n in e)if(Object.hasOwnProperty.call(e,n)&&e[n]===t)return!0;return!1}return a.expression.operator.lookup=function(t,e){switch(t){case"..":e.precidence=20,e.associativity=a.expression.operator.leftToRight;break;case",":e.precidence=18,e.associativity=a.expression.operator.leftToRight;break;case"?:":case"?":case":":e.precidence=16,e.associativity=a.expression.operator.rightToLeft;break;case"??":e.precidence=15,e.associativity=a.expression.operator.rightToLeft;break;case"or":e.precidence=14,e.associativity=a.expression.operator.leftToRight;break;case"and":e.precidence=13,e.associativity=a.expression.operator.leftToRight;break;case"b-or":e.precidence=12,e.associativity=a.expression.operator.leftToRight;break;case"b-xor":e.precidence=11,e.associativity=a.expression.operator.leftToRight;break;case"b-and":e.precidence=10,e.associativity=a.expression.operator.leftToRight;break;case"==":case"!=":e.precidence=9,e.associativity=a.expression.operator.leftToRight;break;case"<":case"<=":case">":case">=":case"not in":case"in":e.precidence=8,e.associativity=a.expression.operator.leftToRight;break;case"~":case"+":case"-":e.precidence=6,e.associativity=a.expression.operator.leftToRight;break;case"//":case"**":case"*":case"/":case"%":e.precidence=5,e.associativity=a.expression.operator.leftToRight;break;case"not":e.precidence=3,e.associativity=a.expression.operator.rightToLeft;break;case"matches":case"starts with":case"ends with":e.precidence=8,e.associativity=a.expression.operator.leftToRight;break;default:throw new a.Error("Failed to lookup operator: "+t+" is an unknown operator.")}return e.operator=t,e},a.expression.operator.parse=function(t,e){var n,r,i,o,s;switch(a.log.trace("Twig.expression.operator.parse: ","Handling ",t),"?"===t&&(r=e.pop()),s=e.pop(),"not"!==t&&(n=e.pop()),"in"!==t&&"not in"!==t&&"??"!==t&&(n&&Array.isArray(n)&&(n=n.length),"?"!==t)&&s&&Array.isArray(s)&&(s=s.length),"matches"===t&&s&&"string"==typeof s&&(i=(o=s.match(/^\/(.*)\/([gims]?)$/))[1],o=o[2],s=new RegExp(i,o)),t){case":":break;case"??":void 0===n&&(n=s,s=r,r=void 0),null!=n?e.push(n):e.push(s);break;case"?:":a.lib.boolval(n)?e.push(n):e.push(s);break;case"?":void 0===n&&(n=s,s=r,r=void 0),a.lib.boolval(n)?e.push(s):e.push(r);break;case"+":s=parseFloat(s),n=parseFloat(n),e.push(n+s);break;case"-":s=parseFloat(s),n=parseFloat(n),e.push(n-s);break;case"*":s=parseFloat(s),n=parseFloat(n),e.push(n*s);break;case"/":s=parseFloat(s),n=parseFloat(n),e.push(n/s);break;case"//":s=parseFloat(s),n=parseFloat(n),e.push(Math.floor(n/s));break;case"%":s=parseFloat(s),n=parseFloat(n),e.push(n%s);break;case"~":e.push((null!=n?n.toString():"")+(null!=s?s.toString():""));break;case"not":case"!":e.push(!a.lib.boolval(s));break;case"<":e.push(n<s);break;case"<=":e.push(n<=s);break;case">":e.push(s<n);break;case">=":e.push(s<=n);break;case"===":e.push(n===s);break;case"==":e.push(n==s);break;case"!==":e.push(n!==s);break;case"!=":e.push(n!=s);break;case"or":e.push(a.lib.boolval(n)||a.lib.boolval(s));break;case"b-or":e.push(n|s);break;case"b-xor":e.push(n^s);break;case"and":e.push(a.lib.boolval(n)&&a.lib.boolval(s));break;case"b-and":e.push(n&s);break;case"**":e.push(Math.pow(n,s));break;case"not in":e.push(!u(n,s));break;case"in":e.push(u(n,s));break;case"matches":e.push(s.test(n));break;case"starts with":e.push("string"==typeof n&&0===n.indexOf(s));break;case"ends with":e.push("string"==typeof n&&n.includes(s,n.length-s.length));break;case"..":e.push(a.functions.range(n,s));break;default:throw new a.Error("Failed to parse operator: "+t+" is an unknown operator.")}},a}},function(t,e,n){"use strict";var i=n(0)(n(1));t.exports=function(y){function o(t,e){var n=Object.prototype.toString.call(e).slice(8,-1);return null!=e&&n===t}return y.filters={upper:function(t){return"string"!=typeof t?t:t.toUpperCase()},lower:function(t){return"string"!=typeof t?t:t.toLowerCase()},capitalize:function(t){return"string"!=typeof t?t:t.slice(0,1).toUpperCase()+t.toLowerCase().slice(1)},title:function(t){return"string"!=typeof t?t:t.toLowerCase().replace(/(^|\s)([a-z])/g,function(t,e,n){return e+n.toUpperCase()})},length:function(t){return y.lib.is("Array",t)||"string"==typeof t?t.length:y.lib.is("Object",t)?(void 0===t._keys?Object.keys(t):t._keys).length:0},reverse:function(t){var e;return o("Array",t)?t.reverse():o("String",t)?t.split("").reverse().join(""):o("Object",t)?(e=t._keys||Object.keys(t).reverse(),t._keys=e,t):void 0},sort:function(i){var t;return o("Array",i)?i.sort():o("Object",i)?(delete i._keys,t=Object.keys(i).sort(function(t,e){var n,r;return i[t]>i[e]==!(i[t]<=i[e])?i[t]>i[e]?1:i[t]<i[e]?-1:0:isNaN(n=parseFloat(i[t]))||isNaN(r=parseFloat(i[e]))?"string"==typeof i[t]?i[t]>i[e].toString()?1:i[t]<i[e].toString()?-1:0:"string"==typeof i[e]?i[t].toString()>i[e]?1:i[t].toString()<i[e]?-1:0:null:r<n?1:n<r?-1:0}),i._keys=t,i):void 0},keys:function(e){var t,n;if(null!=e)return t=e._keys||Object.keys(e),n=[],t.forEach(function(t){"_keys"!==t&&Object.hasOwnProperty.call(e,t)&&n.push(t)}),n},url_encode:function(t){if(null!=t)return y.lib.is("Object",t)?function n(r,i){var o=[];return(r._keys||Object.keys(r)).forEach(function(t){var e;Object.prototype.hasOwnProperty.call(r,t)&&(e=i?i+"["+t+"]":t,t=r[t],o.push(y.lib.is("Object",t)||Array.isArray(t)?n(t,e):encodeURIComponent(e)+"="+encodeURIComponent(t)))}),o.join("&amp;")}(t):encodeURIComponent(t).replace("'","%27")},join:function(e,t){var n,r;if(null!=e)return n="",r=[],t&&t[0]&&(n=t[0]),o("Array",e)?r=e:(e._keys||Object.keys(e)).forEach(function(t){"_keys"!==t&&Object.hasOwnProperty.call(e,t)&&r.push(e[t])}),r.join(n)},default:function(t,e){if(void 0!==e&&1<e.length)throw new y.Error("default filter expects one argument");return null==t||""===t?void 0===e?"":e[0]:t},json_encode:function(e){var n,t,r;return null==e?"null":"object"===(0,i.default)(e)&&o("Array",e)?(n=[],e.forEach(function(t){n.push(y.filters.json_encode(t))}),"["+n.join(",")+"]"):"object"===(0,i.default)(e)&&o("Date",e)?'"'+e.toISOString()+'"':"object"===(0,i.default)(e)?(t=e._keys||Object.keys(e),r=[],t.forEach(function(t){r.push(JSON.stringify(t)+":"+y.filters.json_encode(e[t]))}),"{"+r.join(",")+"}"):JSON.stringify(e)},merge:function(e,t){var n=[],r=0;if(o("Array",e)?t.forEach(function(t){o("Array",t)||(n={})}):n={},o("Array",n)||(n._keys=[]),o("Array",e)?e.forEach(function(t){n._keys&&n._keys.push(r),n[r]=t,r++}):(e._keys||Object.keys(e)).forEach(function(t){n[t]=e[t],n._keys.push(t);t=parseInt(t,10);!isNaN(t)&&r<=t&&(r=t+1)}),t.forEach(function(e){o("Array",e)?e.forEach(function(t){n._keys&&n._keys.push(r),n[r]=t,r++}):(e._keys||Object.keys(e)).forEach(function(t){n[t]||n._keys.push(t),n[t]=e[t];t=parseInt(t,10);!isNaN(t)&&r<=t&&(r=t+1)})}),0===t.length)throw new y.Error("Filter merge expects at least one parameter");return n},date:function(t,e){t=y.functions.date(t),e=e&&Boolean(e.length)?e[0]:"F j, Y H:i";return y.lib.date(e.replace(/\\\\/g,"\\"),t)},date_modify:function(t,e){if(null!=t){if(void 0===e||1!==e.length)throw new y.Error("date_modify filter expects 1 argument");var n,e=e[0];return y.lib.is("Date",t)&&(n=y.lib.strtotime(e,t.getTime()/1e3)),y.lib.is("String",t)&&(n=y.lib.strtotime(e,y.lib.strtotime(t))),y.lib.is("Number",t)&&(n=y.lib.strtotime(e,t)),new Date(1e3*n)}},replace:function(t,e){if(null!=t){var n,r=e[0];for(n in r)Object.hasOwnProperty.call(r,n)&&"_keys"!==n&&(t=y.lib.replaceAll(t,n,r[n]));return t}},format:function(t,e){if(null!=t)return y.lib.vsprintf(t,e)},striptags:function(t,e){if(null!=t)return y.lib.stripTags(t,e)},escape:function(t,e){if(null!=t&&""!==t){var n="html";if("html"===(n=e&&Boolean(e.length)&&!0!==e[0]?e[0]:n))return e=t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),new y.Markup(e,"html");if("js"===n){for(var r,i,o=t.toString(),s="",a=0;a<o.length;a++)o[a].match(/^[a-zA-Z0-9,._]$/)?s+=o[a]:(r=o.charAt(a),i=o.charCodeAt(a),s+={"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"}[r]||y.lib.sprintf("\\u%04s",i.toString(16).toUpperCase()));return new y.Markup(s,"js")}if("css"===n){for(var u=t.toString(),l="",c=0;c<u.length;c++)u[c].match(/^[a-zA-Z0-9]$/)?l+=u[c]:l+="\\"+u.charCodeAt(c).toString(16).toUpperCase()+" ";return new y.Markup(l,"css")}if("url"===n)return e=y.filters.url_encode(t),new y.Markup(e,"url");if("html_attr"!==n)throw new y.Error("escape strategy unsupported");for(var p,h=t.toString(),f="",d=0;d<h.length;d++)h[d].match(/^[a-zA-Z0-9,.\-_]$/)?f+=h[d]:h[d].match(/^[&<>"]$/)?f+=h[d].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):f+=(p=h.charCodeAt(d))<=31&&9!==p&&10!==p&&13!==p?"&#xFFFD;":p<128?y.lib.sprintf("&#x%02s;",p.toString(16).toUpperCase()):y.lib.sprintf("&#x%04s;",p.toString(16).toUpperCase());return new y.Markup(f,"html_attr")}},e:function(t,e){return y.filters.escape(t,e)},nl2br:function(t){var e,n;if(null!=t&&""!==t)return n="<br />"+(e="BACKSLASH_n_replace"),t=y.filters.escape(t).replace(/\r\n/g,n).replace(/\r/g,n).replace(/\n/g,n),t=y.lib.replaceAll(t,e,"\n"),new y.Markup(t)},number_format:function(t,e){var n=e&&e[0]?e[0]:void 0,r=e&&void 0!==e[1]?e[1]:".",e=e&&void 0!==e[2]?e[2]:",",t=String(t).replace(/[^0-9+\-Ee.]/g,""),t=isFinite(Number(t))?Number(t):0,n=isFinite(Number(n))?Math.abs(n):0,i="";return 3<(i=(n?function(t,e){e=Math.pow(10,e);return String(Math.round(t*e)/e)}(t,n):String(Math.round(t))).split("."))[0].length&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,e)),(i[1]||"").length<n&&(i[1]=i[1]||"",i[1]+=new Array(n-i[1].length+1).join("0")),i.join(r)},trim:function(t,e){if(null!=t){for(var n=String(t),r=e&&e[0]?String(e[0]):" \n\r\t\f\vÂ ââââââââââââ\u2028\u2029ã",i=0;i<n.length;i++)if(!r.includes(n.charAt(i))){n=n.slice(Math.max(0,i));break}for(var o=n.length-1;0<=o;o--)if(!r.includes(n.charAt(o))){n=n.slice(0,Math.max(0,o+1));break}return r.includes(n.charAt(0))?"":n}},truncate:function(t,e){var n=30,r=!1,i="...";if(t=String(t),e&&(e[0]&&(n=e[0]),e[1]&&(r=e[1]),e[2])&&(i=e[2]),t.length>n){if(r&&-1===(n=t.indexOf(" ",n)))return t;t=t.slice(0,n)+i}return t},slice:function(t,e){if(null!=t){if(void 0===e||0===e.length)throw new y.Error("slice filter expects at least 1 argument");var n=e[0]||0,r=1<e.length?e[1]:t.length,i=0<=n?n:Math.max(t.length+n,0);if(y.lib.is("Array",t)){for(var o=[],s=i;s<i+r&&s<t.length;s++)o.push(t[s]);return o}if(y.lib.is("String",t))return t.slice(i,i+r);throw new y.Error("slice filter expects value to be an array or string")}},abs:function(t){if(null!=t)return Math.abs(t)},first:function(t){if(o("Array",t))return t[0];if(o("Object",t)){if("_keys"in t)return t[t._keys[0]]}else if("string"==typeof t)return t.slice(0,1)},split:function(t,e){if(null!=t){if(void 0===e||0===e.length||2<e.length)throw new y.Error("split filter expects 1 or 2 argument");if(y.lib.is("String",t)){var n=e[0],r=e[1],i=t.split(n);if(void 0===r)return i;if(r<0)return t.split(n,i.length+r);var o=[];if(""===n)for(;0<i.length;){for(var s="",a=0;a<r&&0<i.length;a++)s+=i.shift();o.push(s)}else{for(var u=0;u<r-1&&0<i.length;u++)o.push(i.shift());0<i.length&&o.push(i.join(n))}return o}throw new y.Error("split filter expects value to be a string")}},last:function(t){var e;return y.lib.is("Object",t)?t[(e=void 0===t._keys?Object.keys(t):t._keys)[e.length-1]]:y.lib.is("Number",t)?t.toString().slice(-1):t[t.length-1]},raw:function(t){return new y.Markup(t||"")},batch:function(t,e){var n,r,i=e.shift(),o=e.shift();if(!y.lib.is("Array",t))throw new y.Error("batch filter expects items to be an array");if(!y.lib.is("Number",i))throw new y.Error("batch filter expects size to be a number");i=Math.ceil(i),e=y.lib.chunkArray(t,i);if(o&&t.length%i!=0){for(r=i-(n=e.pop()).length;r--;)n.push(o);e.push(n)}return e},round:function(t,e){var n=0<(e=e||[]).length?e[0]:0,e=1<e.length?e[1]:"common";if(t=parseFloat(t),n&&!y.lib.is("Number",n))throw new y.Error("round filter expects precision to be a number");if("common"===e)return y.lib.round(t,n);if(y.lib.is("Function",Math[e]))return Math[e](t*Math.pow(10,n))/Math.pow(10,n);throw new y.Error("round filter expects method to be 'floor', 'ceil', or 'common'")},spaceless:function(t){return t.replace(/>\s+</g,"><").trim()}},y.filter=function(t,e,n){if(y.filters[t])return y.filters[t].call(this,e,n);throw new y.Error("Unable to find filter "+t)},y.filter.extend=function(t,e){y.filters[t]=e},y}},function(s,t,e){"use strict";var p=e(0)(e(1));s.exports=function(o){return o.functions={range:function(t,e,n){var r,i=[],o=n||1,s=!1,a=isNaN(t)||isNaN(e)?isNaN(t)&&isNaN(e)?(s=!0,r=t.charCodeAt(0),e.charCodeAt(0)):(r=isNaN(t)?0:t,isNaN(e)?0:e):(r=parseInt(t,10),parseInt(e,10));if(!(a<r))for(;r<=a;)i.push(s?String.fromCharCode(r):r),r+=o;else for(;a<=r;)i.push(s?String.fromCharCode(r):r),r-=o;return i},cycle:function(t,e){return t[e%t.length]},dump:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),i="\n",o="  ",s=0,a="",u=function(t){for(var e="";0<t;)t--,e+=o;return e},l=function(t){a+=u(s),"object"===(0,p.default)(t)?c(t):"function"==typeof t?a+="function()"+i:"string"==typeof t?a+="string("+t.length+') "'+t+'"'+i:"number"==typeof t?a+="number("+t+")"+i:"boolean"==typeof t&&(a+="bool("+t+")"+i)},c=function(t){if(null===t)a+="NULL"+i;else if(void 0===t)a+="undefined"+i;else if("object"===(0,p.default)(t)){for(var e in a+=u(s)+(0,p.default)(t),s++,a+="("+function(t){var e,n=0;for(e in t)Object.hasOwnProperty.call(t,e)&&n++;return n}(t)+") {"+i,t)Object.hasOwnProperty.call(t,e)&&(a+=u(s)+"["+e+"]=> "+i,l(t[e]));a+=u(--s)+"}"+i}else l(t)};return 0===r.length&&r.push(this.context),r.forEach(function(t){c(t)}),a},date:function(t){var e;if(null==t||""===t)e=new Date;else if(o.lib.is("Date",t))e=t;else if(o.lib.is("String",t))e=t.match(/^\d+$/)?new Date(1e3*t):new Date(1e3*o.lib.strtotime(t));else{if(!o.lib.is("Number",t))throw new o.Error("Unable to parse date "+t);e=new Date(1e3*t)}return e},block:function(t){if(void 0!==(t=this.getBlock(t)))return t.render(this,this.context)},parent:function(){return this.getBlock(this.getNestingStackToken(o.logic.type.block).blockName,!0).render(this,this.context)},attribute:function(t,e,n){return o.lib.is("Object",t)&&Object.hasOwnProperty.call(t,e)?"function"==typeof t[e]?t[e].apply(void 0,n):t[e]:t&&t[e]||void 0},max:function(t){if(o.lib.is("Object",t))return delete t._keys,o.lib.max(t);for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Reflect.apply(o.lib.max,null,[t].concat(n))},min:function(t){if(o.lib.is("Object",t))return delete t._keys,o.lib.min(t);for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Reflect.apply(o.lib.min,null,[t].concat(n))},template_from_string:function(t){return o.Templates.parsers.twig({options:this.template.options,data:t=void 0===t?"":t})},random:function(t){var r=2147483648;function e(t){var e=Math.floor(Math.random()*r),n=Math.min.call(null,0,t),t=Math.max.call(null,0,t);return n+Math.floor((t-n+1)*e/r)}return o.lib.is("Number",t)?e(t):o.lib.is("String",t)?t.charAt(e(t.length-1)):o.lib.is("Array",t)?t[e(t.length-1)]:o.lib.is("Object",t)?t[(t=Object.keys(t))[e(t.length-1)]]:e(r-1)},source:function(t,e){var n,r=!1,i=void 0!==s.exports&&"undefined"==typeof window?"fs":"ajax",i={id:t,path:t,method:i,parser:"source",async:!1,fetchTemplateSource:!0};void 0===e&&(e=!1);try{null==(n=o.Templates.loadRemote(t,i))?n="":r=!0}catch(t){o.log.debug("Twig.functions.source: ","Problem loading template  ",t)}return r||e?n:'Template "{name}" is not defined.'.replace("{name}",t)}},o._function=function(t,e,n){if(o.functions[t])return o.functions[t](e,n);throw new o.Error("Unable to find function "+t)},o._function.extend=function(t,e){o.functions[t]=e},o}},function(t,e,n){"use strict";t.exports=function(t){return t.lib={},t.lib.sprintf=n(4),t.lib.vsprintf=n(21),t.lib.round=n(22),t.lib.max=n(24),t.lib.min=n(25),t.lib.stripTags=n(26),t.lib.strtotime=n(28),t.lib.date=n(29),t.lib.boolval=n(30),t.lib.is=function(t,e){if(null==e)return!1;switch(t){case"Array":return Array.isArray(e);case"Date":return e instanceof Date;case"String":return"string"==typeof e||e instanceof String;case"Number":return"number"==typeof e||e instanceof Number;case"Function":return"function"==typeof e;case"Object":return e instanceof Object;default:return!1}},t.lib.replaceAll=function(t,e,n){e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return t.replace(new RegExp(e,"g"),n)},t.lib.chunkArray=function(t,e){var n=[],r=0,i=t.length;if(e<1||!Array.isArray(t))return[];for(;r<i;)n.push(t.slice(r,r+=e));return n},t}},function(t,e,n){"use strict";t.exports=function(t,e){return n(4).apply(this,[t].concat(e))}},function(t,e,o){"use strict";function s(t,e){var n=Math.floor(Math.abs(t)+.5);return("PHP_ROUND_HALF_DOWN"===e&&t===n-.5||"PHP_ROUND_HALF_EVEN"===e&&t===.5+2*Math.floor(n/2)||"PHP_ROUND_HALF_ODD"===e&&t===.5+2*Math.floor(n/2)-1)&&--n,t<0?-n:n}t.exports=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"PHP_ROUND_HALF_UP",r=o(23),i=o(5);return t=r(t),e=i(e),r=Math.pow(10,e),isNaN(t)||!isFinite(t)||Math.trunc(t)===t&&0<=e?t:(e<(i=14-Math.floor(Math.log10(Math.abs(t))))&&i-15<e?(t=s(t*Math.pow(10,i),n),t/=Math.pow(10,Math.abs(e-i))):t*=r,(t=s(t,n))/r)}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(t){return _typeof3(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof3(t)};t.exports=function(t){switch(void 0===t?"undefined":r(t)){case"number":return t;case"string":return parseFloat(t)||0;default:return n(5)(t)}}},function(t,e,n){"use strict";var l="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(t){return _typeof3(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof3(t)};t.exports=function(){function a(t){if("[object Array]"===Object.prototype.toString.call(t))return t;var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n}function u(t,e){var n,r,i,o,s=0;if(t!==e){if("object"!==(void 0===t?"undefined":l(t)))return"object"===(void 0===e?"undefined":l(e))?1:isNaN(e)&&!isNaN(t)?0===t?0:t<0?1:-1:isNaN(t)&&!isNaN(e)?0===e?0:0<e?1:-1:e===t?0:t<e?1:-1;if("object"!==(void 0===e?"undefined":l(e)))return-1;if(t=a(t),e=a(e),(o=t.length)<(i=e.length))return 1;if(i<o)return-1;for(s=0,n=o;s<n;++s){if(1===(r=u(t[s],e[s])))return 1;if(-1===r)return-1}}return 0}var t,e,n,r=0,i=arguments,o=i.length;if(0===o)throw new Error("At least one value should be passed to max()");if(1===o){if("object"!==l(i[0]))throw new Error("Wrong parameter count for max()");if(0===(t=a(i[0])).length)throw new Error("Array must contain at least one element for max()")}else t=i;for(e=t[0],r=1,n=t.length;r<n;++r)1===u(e,t[r])&&(e=t[r]);return e}},function(t,e,n){"use strict";var l="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(t){return _typeof3(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof3(t)};t.exports=function(){function a(t){if("[object Array]"===Object.prototype.toString.call(t))return t;var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n}function u(t,e){var n,r,i,o,s=0;if(t!==e){if("object"!==(void 0===t?"undefined":l(t)))return"object"===(void 0===e?"undefined":l(e))?1:isNaN(e)&&!isNaN(t)?0===t?0:t<0?1:-1:isNaN(t)&&!isNaN(e)?0===e?0:0<e?1:-1:e===t?0:t<e?1:-1;if("object"!==(void 0===e?"undefined":l(e)))return-1;if(t=a(t),e=a(e),(o=t.length)<(i=e.length))return 1;if(i<o)return-1;for(s=0,n=o;s<n;++s){if(1===(r=u(t[s],e[s])))return 1;if(-1===r)return-1}}return 0}var t,e,n,r=0,i=arguments,o=i.length;if(0===o)throw new Error("At least one value should be passed to min()");if(1===o){if("object"!==l(i[0]))throw new Error("Wrong parameter count for min()");if(0===(t=a(i[0])).length)throw new Error("Array must contain at least one element for min()")}else t=i;for(e=t[0],r=1,n=t.length;r<n;++r)-1===u(e,t[r])&&(e=t[r]);return e}},function(t,e,a){"use strict";t.exports=function(t,n){var e=a(27),r=(n=(((n||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),/<\/?([a-z0-9]*)\b[^>]*>?/gi),i=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;for(s="<"===(s=e(t)).substring(s.length-1)?s.substring(0,s.length-1):s;;){var o=s,s=o.replace(i,"").replace(r,function(t,e){return-1<n.indexOf("<"+e.toLowerCase()+">")?t:""});if(o===s)return s}}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(t){return _typeof3(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof3(t)};t.exports=function(t){switch(void 0===t?"undefined":r(t)){case"boolean":return t?"1":"";case"string":return t;case"number":return isNaN(t)?"NAN":isFinite(t)?t+"":(t<0?"-":"")+"INF";case"undefined":return"";case"object":return Array.isArray(t)?"Array":null!==t?"Object":"";default:throw new Error("Unsupported value type")}}},function(t,D,F){"use strict";var e="[ \\t]+",n="[ \\t]*",r="(?:([ap])\\.?m\\.?([\\t ]|$))",i="(2[0-4]|[01]?[0-9])",o="([01][0-9]|2[0-4])",s="(0?[1-9]|1[0-2])",a="([0-5]?[0-9])",u="([0-5][0-9])",l="(60|[0-5]?[0-9])",c="(60|[0-5][0-9])",p="(?:\\.([0-9]+))",h="sunday|monday|tuesday|wednesday|thursday|friday|saturday",f="sun|mon|tue|wed|thu|fri|sat",d=h+"|"+f+"|weekdays?",y="first|second|third|fourth|fifth|sixth|seventh|eighth?|ninth|tenth|eleventh|twelfth",g="next|last|previous|this",m="(?:second|sec|minute|min|hour|day|fortnight|forthnight|month|year)s?|weeks|"+d,v="([0-9]{1,4})",_="([0-9]{4})",b="(1[0-2]|0?[0-9])",x="(0[0-9]|1[0-2])",w="(?:(3[01]|[0-2]?[0-9])(?:st|nd|rd|th)?)",E="(0[0-9]|[1-2][0-9]|3[01])",S="january|february|march|april|may|june|july|august|september|october|november|december",I="jan|feb|mar|apr|may|jun|jul|aug|sept?|oct|nov|dec",N="("+S+"|"+I+"|i[vx]|vi{0,3}|xi{0,2}|i{1,3})",O="((?:GMT)?([+-])"+i+":?"+a+"?)",C=N+"[ .\\t-]*"+w+"[,.stndrh\\t ]*";function k(t,e){switch(e=e&&e.toLowerCase()){case"a":t+=12===t?-12:0;break;case"p":t+=12!==t?12:0}return t}function A(t){var e=+t;return t.length<4&&e<100&&(e+=e<70?2e3:1900),e}function M(t){return{jan:0,january:0,i:0,feb:1,february:1,ii:1,mar:2,march:2,iii:2,apr:3,april:3,iv:3,may:4,v:4,jun:5,june:5,vi:5,jul:6,july:6,vii:6,aug:7,august:7,viii:7,sep:8,sept:8,september:8,ix:8,oct:9,october:9,x:9,nov:10,november:10,xi:10,dec:11,december:11,xii:11}[t.toLowerCase()]}function L(t,e){e=1<arguments.length&&void 0!==e?e:0;return{mon:1,monday:1,tue:2,tuesday:2,wed:3,wednesday:3,thu:4,thursday:4,fri:5,friday:5,sat:6,saturday:6,sun:0,sunday:0}[t.toLowerCase()]||e}function P(t,e){var n,r,i;return(t=t&&t.match(/(?:GMT)?([+-])(\d+)(:?)(\d{0,2})/i))?(n="-"===t[1]?1:-1,r=+t[2],i=+t[4],t[4]||t[3]||(i=Math.floor(r%100),r=Math.floor(r/100)),n*(60*r+i)):e}var T={yesterday:{regex:/^yesterday/i,name:"yesterday",callback:function(){return--this.rd,this.resetTime()}},now:{regex:/^now/i,name:"now"},noon:{regex:/^noon/i,name:"noon",callback:function(){return this.resetTime()&&this.time(12,0,0,0)}},midnightOrToday:{regex:/^(midnight|today)/i,name:"midnight | today",callback:function(){return this.resetTime()}},tomorrow:{regex:/^tomorrow/i,name:"tomorrow",callback:function(){return this.rd+=1,this.resetTime()}},timestamp:{regex:/^@(-?\d+)/i,name:"timestamp",callback:function(t,e){return this.rs+=+e,this.y=1970,this.m=0,this.d=1,this.dates=0,this.resetTime()&&this.zone(0)}},firstOrLastDay:{regex:/^(first|last) day of/i,name:"firstdayof | lastdayof",callback:function(t,e){"first"===e.toLowerCase()?this.firstOrLastDayOfMonth=1:this.firstOrLastDayOfMonth=-1}},backOrFrontOf:{regex:RegExp("^(back|front) of "+i+n+r+"?","i"),name:"backof | frontof",callback:function(t,e,n,r){var n=+n,i=15;return"back"===e.toLowerCase()||(--n,i=45),n=k(n,r),this.resetTime()&&this.time(n,i,0,0)}},weekdayOf:{regex:RegExp("^("+y+"|"+g+")"+e+"("+h+"|"+f+")"+e+"of","i"),name:"weekdayof"},mssqltime:{regex:RegExp("^"+s+":"+u+":"+c+"[:.]([0-9]+)"+r,"i"),name:"mssqltime",callback:function(t,e,n,r,i,o){return this.time(k(+e,o),+n,+r,+i.substr(0,3))}},timeLong12:{regex:RegExp("^"+s+"[:.]"+a+"[:.]"+c+n+r,"i"),name:"timelong12",callback:function(t,e,n,r,i){return this.time(k(+e,i),+n,+r,0)}},timeShort12:{regex:RegExp("^"+s+"[:.]"+u+n+r,"i"),name:"timeshort12",callback:function(t,e,n,r){return this.time(k(+e,r),+n,0,0)}},timeTiny12:{regex:RegExp("^"+s+n+r,"i"),name:"timetiny12",callback:function(t,e,n){return this.time(k(+e,n),0,0,0)}},soap:{regex:RegExp("^"+_+"-"+x+"-"+E+"T"+o+":"+u+":"+c+p+O+"?","i"),name:"soap",callback:function(t,e,n,r,i,o,s,a,u){return this.ymd(+e,n-1,+r)&&this.time(+i,+o,+s,+a.substr(0,3))&&this.zone(P(u))}},wddx:{regex:RegExp("^"+_+"-"+b+"-"+w+"T"+i+":"+a+":"+l),name:"wddx",callback:function(t,e,n,r,i,o,s){return this.ymd(+e,n-1,+r)&&this.time(+i,+o,+s,0)}},exif:{regex:RegExp("^"+_+":"+x+":"+E+" "+o+":"+u+":"+c,"i"),name:"exif",callback:function(t,e,n,r,i,o,s){return this.ymd(+e,n-1,+r)&&this.time(+i,+o,+s,0)}},xmlRpc:{regex:RegExp("^"+_+x+E+"T"+i+":"+u+":"+c),name:"xmlrpc",callback:function(t,e,n,r,i,o,s){return this.ymd(+e,n-1,+r)&&this.time(+i,+o,+s,0)}},xmlRpcNoColon:{regex:RegExp("^"+_+x+E+"[Tt]"+i+u+c),name:"xmlrpcnocolon",callback:function(t,e,n,r,i,o,s){return this.ymd(+e,n-1,+r)&&this.time(+i,+o,+s,0)}},clf:{regex:RegExp("^"+w+"/("+I+")/"+_+":"+o+":"+u+":"+c+e+O,"i"),name:"clf",callback:function(t,e,n,r,i,o,s,a){return this.ymd(+r,M(n),+e)&&this.time(+i,+o,+s,0)&&this.zone(P(a))}},iso8601long:{regex:RegExp("^t?"+i+"[:.]"+a+"[:.]"+l+p,"i"),name:"iso8601long",callback:function(t,e,n,r,i){return this.time(+e,+n,+r,+i.substr(0,3))}},dateTextual:{regex:RegExp("^"+N+"[ .\\t-]*"+w+"[,.stndrh\\t ]+"+v,"i"),name:"datetextual",callback:function(t,e,n,r){return this.ymd(A(r),M(e),+n)}},pointedDate4:{regex:RegExp("^"+w+"[.\\t-]"+b+"[.-]"+_),name:"pointeddate4",callback:function(t,e,n,r){return this.ymd(+r,n-1,+e)}},pointedDate2:{regex:RegExp("^"+w+"[.\\t]"+b+"\\.([0-9]{2})"),name:"pointeddate2",callback:function(t,e,n,r){return this.ymd(A(r),n-1,+e)}},timeLong24:{regex:RegExp("^t?"+i+"[:.]"+a+"[:.]"+l),name:"timelong24",callback:function(t,e,n,r){return this.time(+e,+n,+r,0)}},dateNoColon:{regex:RegExp("^"+_+x+E),name:"datenocolon",callback:function(t,e,n,r){return this.ymd(+e,n-1,+r)}},pgydotd:{regex:RegExp("^"+_+"\\.?(00[1-9]|0[1-9][0-9]|[12][0-9][0-9]|3[0-5][0-9]|36[0-6])"),name:"pgydotd",callback:function(t,e,n){return this.ymd(+e,0,+n)}},timeShort24:{regex:RegExp("^t?"+i+"[:.]"+a,"i"),name:"timeshort24",callback:function(t,e,n){return this.time(+e,+n,0,0)}},iso8601noColon:{regex:RegExp("^t?"+o+u+c,"i"),name:"iso8601nocolon",callback:function(t,e,n,r){return this.time(+e,+n,+r,0)}},iso8601dateSlash:{regex:RegExp("^"+_+"/"+x+"/"+E+"/"),name:"iso8601dateslash",callback:function(t,e,n,r){return this.ymd(+e,n-1,+r)}},dateSlash:{regex:RegExp("^"+_+"/"+b+"/"+w),name:"dateslash",callback:function(t,e,n,r){return this.ymd(+e,n-1,+r)}},american:{regex:RegExp("^"+b+"/"+w+"/"+v),name:"american",callback:function(t,e,n,r){return this.ymd(A(r),e-1,+n)}},americanShort:{regex:RegExp("^"+b+"/"+w),name:"americanshort",callback:function(t,e,n){return this.ymd(this.y,e-1,+n)}},gnuDateShortOrIso8601date2:{regex:RegExp("^"+v+"-"+b+"-"+w),name:"gnudateshort | iso8601date2",callback:function(t,e,n,r){return this.ymd(A(e),n-1,+r)}},iso8601date4:{regex:RegExp("^([+-]?[0-9]{4})-"+x+"-"+E),name:"iso8601date4",callback:function(t,e,n,r){return this.ymd(+e,n-1,+r)}},gnuNoColon:{regex:RegExp("^t?"+o+u,"i"),name:"gnunocolon",callback:function(t,e,n){switch(this.times){case 0:return this.time(+e,+n,0,this.f);case 1:return this.y=100*e+ +n,this.times++,!0;default:return!1}}},gnuDateShorter:{regex:RegExp("^"+_+"-"+b),name:"gnudateshorter",callback:function(t,e,n){return this.ymd(+e,n-1,1)}},pgTextReverse:{regex:RegExp("^(\\d{3,4}|[4-9]\\d|3[2-9])-("+I+")-"+E,"i"),name:"pgtextreverse",callback:function(t,e,n,r){return this.ymd(A(e),M(n),+r)}},dateFull:{regex:RegExp("^"+w+"[ \\t.-]*"+N+"[ \\t.-]*"+v,"i"),name:"datefull",callback:function(t,e,n,r){return this.ymd(A(r),M(n),+e)}},dateNoDay:{regex:RegExp("^"+N+"[ .\\t-]*"+_,"i"),name:"datenoday",callback:function(t,e,n){return this.ymd(+n,M(e),1)}},dateNoDayRev:{regex:RegExp("^"+_+"[ .\\t-]*"+N,"i"),name:"datenodayrev",callback:function(t,e,n){return this.ymd(+e,M(n),1)}},pgTextShort:{regex:RegExp("^("+I+")-"+E+"-"+v,"i"),name:"pgtextshort",callback:function(t,e,n,r){return this.ymd(A(r),M(e),+n)}},dateNoYear:{regex:RegExp("^"+C,"i"),name:"datenoyear",callback:function(t,e,n){return this.ymd(this.y,M(e),+n)}},dateNoYearRev:{regex:RegExp("^"+w+"[ .\\t-]*"+N,"i"),name:"datenoyearrev",callback:function(t,e,n){return this.ymd(this.y,M(n),+e)}},isoWeekDay:{regex:RegExp("^"+_+"-?W(0[1-9]|[1-4][0-9]|5[0-3])(?:-?([0-7]))?"),name:"isoweekday | isoweek",callback:function(t,e,n,r){if(r=r?+r:1,!this.ymd(+e,0,1))return!1;e=new Date(this.y,this.m,this.d).getDay();this.rd+=0-(4<e?e-7:e)+7*(n-1)+r}},relativeText:{regex:RegExp("^("+y+"|"+g+")"+e+"("+m+")","i"),name:"relativetext",callback:function(t,e,n){var e={amount:{last:-1,previous:-1,this:0,first:1,next:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eight:8,eighth:8,ninth:9,tenth:10,eleventh:11,twelfth:12}[e=(e=e).toLowerCase()],behavior:{this:1}[e]||0},r=e.amount;switch(n.toLowerCase()){case"sec":case"secs":case"second":case"seconds":this.rs+=r;break;case"min":case"mins":case"minute":case"minutes":this.ri+=r;break;case"hour":case"hours":this.rh+=r;break;case"day":case"days":this.rd+=r;break;case"fortnight":case"fortnights":case"forthnight":case"forthnights":this.rd+=14*r;break;case"week":case"weeks":this.rd+=7*r;break;case"month":case"months":this.rm+=r;break;case"year":case"years":this.ry+=r;break;case"mon":case"monday":case"tue":case"tuesday":case"wed":case"wednesday":case"thu":case"thursday":case"fri":case"friday":case"sat":case"saturday":case"sun":case"sunday":this.resetTime(),this.weekday=L(n,7),this.weekdayBehavior=1,this.rd+=7*(0<r?r-1:r)}}},relative:{regex:RegExp("^([+-]*)[ \\t]*(\\d+)[ \\t]*("+m+"|week)","i"),name:"relative",callback:function(t,e,n,r){var e=e.replace(/[^-]/g,"").length,i=+n*Math.pow(-1,e);switch(r.toLowerCase()){case"sec":case"secs":case"second":case"seconds":this.rs+=i;break;case"min":case"mins":case"minute":case"minutes":this.ri+=i;break;case"hour":case"hours":this.rh+=i;break;case"day":case"days":this.rd+=i;break;case"fortnight":case"fortnights":case"forthnight":case"forthnights":this.rd+=14*i;break;case"week":case"weeks":this.rd+=7*i;break;case"month":case"months":this.rm+=i;break;case"year":case"years":this.ry+=i;break;case"mon":case"monday":case"tue":case"tuesday":case"wed":case"wednesday":case"thu":case"thursday":case"fri":case"friday":case"sat":case"saturday":case"sun":case"sunday":this.resetTime(),this.weekday=L(r,7),this.weekdayBehavior=1,this.rd+=7*(0<i?i-1:i)}}},dayText:{regex:RegExp("^("+d+")","i"),name:"daytext",callback:function(t,e){this.resetTime(),this.weekday=L(e,0),2!==this.weekdayBehavior&&(this.weekdayBehavior=1)}},relativeTextWeek:{regex:RegExp("^("+g+")"+e+"week","i"),name:"relativetextweek",callback:function(t,e){switch(this.weekdayBehavior=2,e.toLowerCase()){case"this":this.rd+=0;break;case"next":this.rd+=7;break;case"last":case"previous":this.rd-=7}isNaN(this.weekday)&&(this.weekday=1)}},monthFullOrMonthAbbr:{regex:RegExp("^("+S+"|"+I+")","i"),name:"monthfull | monthabbr",callback:function(t,e){return this.ymd(this.y,M(e),this.d)}},tzCorrection:{regex:RegExp("^"+O,"i"),name:"tzcorrection",callback:function(t){return this.zone(P(t))}},ago:{regex:/^ago/i,name:"ago",callback:function(){this.ry=-this.ry,this.rm=-this.rm,this.rd=-this.rd,this.rh=-this.rh,this.ri=-this.ri,this.rs=-this.rs,this.rf=-this.rf}},year4:{regex:RegExp("^"+_),name:"year4",callback:function(t,e){return this.y=+e,!0}},whitespace:{regex:/^[ .,\t]+/,name:"whitespace"},dateShortWithTimeLong:{regex:RegExp("^"+C+"t?"+i+"[:.]"+a+"[:.]"+l,"i"),name:"dateshortwithtimelong",callback:function(t,e,n,r,i,o){return this.ymd(this.y,M(e),+n)&&this.time(+r,+i,+o,0)}},dateShortWithTimeLong12:{regex:RegExp("^"+C+s+"[:.]"+a+"[:.]"+c+n+r,"i"),name:"dateshortwithtimelong12",callback:function(t,e,n,r,i,o,s){return this.ymd(this.y,M(e),+n)&&this.time(k(+r,s),+i,+o,0)}},dateShortWithTimeShort:{regex:RegExp("^"+C+"t?"+i+"[:.]"+a,"i"),name:"dateshortwithtimeshort",callback:function(t,e,n,r,i){return this.ymd(this.y,M(e),+n)&&this.time(+r,+i,0,0)}},dateShortWithTimeShort12:{regex:RegExp("^"+C+s+"[:.]"+u+n+r,"i"),name:"dateshortwithtimeshort12",callback:function(t,e,n,r,i,o){return this.ymd(this.y,M(e),+n)&&this.time(k(+r,o),+i,0,0)}}},R={y:NaN,m:NaN,d:NaN,h:NaN,i:NaN,s:NaN,f:NaN,ry:0,rm:0,rd:0,rh:0,ri:0,rs:0,rf:0,weekday:NaN,weekdayBehavior:0,firstOrLastDayOfMonth:0,z:NaN,dates:0,times:0,zones:0,ymd:function(t,e,n){return!(0<this.dates||(this.dates++,this.y=t,this.m=e,this.d=n,0))},time:function(t,e,n,r){return!(0<this.times||(this.times++,this.h=t,this.i=e,this.s=n,this.f=r,0))},resetTime:function(){return this.h=0,this.i=0,this.s=0,this.f=0,!(this.times=0)},zone:function(t){return this.zones<=1&&(this.zones++,this.z=t,!0)},toDate:function(t){switch(this.dates&&!this.times&&(this.h=this.i=this.s=this.f=0),isNaN(this.y)&&(this.y=t.getFullYear()),isNaN(this.m)&&(this.m=t.getMonth()),isNaN(this.d)&&(this.d=t.getDate()),isNaN(this.h)&&(this.h=t.getHours()),isNaN(this.i)&&(this.i=t.getMinutes()),isNaN(this.s)&&(this.s=t.getSeconds()),isNaN(this.f)&&(this.f=t.getMilliseconds()),this.firstOrLastDayOfMonth){case 1:this.d=1;break;case-1:this.d=0,this.m+=1}isNaN(this.weekday)||((e=new Date(t.getTime())).setFullYear(this.y,this.m,this.d),e.setHours(this.h,this.i,this.s,this.f),e=e.getDay(),2===this.weekdayBehavior?(0===e&&0!==this.weekday&&(this.weekday=-6),0===this.weekday&&0!==e&&(this.weekday=7),this.d-=e,this.d+=this.weekday):(n=this.weekday-e,(this.rd<0&&n<0||0<=this.rd&&n<=-this.weekdayBehavior)&&(n+=7),0<=this.weekday?this.d+=n:this.d-=7-(Math.abs(this.weekday)-e),this.weekday=NaN)),this.y+=this.ry,this.m+=this.rm,this.d+=this.rd,this.h+=this.rh,this.i+=this.ri,this.s+=this.rs,this.f+=this.rf,this.ry=this.rm=this.rd=0,this.rh=this.ri=this.rs=this.rf=0;var e,n,r=new Date(t.getTime());switch(r.setFullYear(this.y,this.m,this.d),r.setHours(this.h,this.i,this.s,this.f),this.firstOrLastDayOfMonth){case 1:r.setDate(1);break;case-1:r.setMonth(r.getMonth()+1,0)}return isNaN(this.z)||r.getTimezoneOffset()===this.z||(r.setUTCFullYear(r.getFullYear(),r.getMonth(),r.getDate()),r.setUTCHours(r.getHours(),r.getMinutes()+this.z,r.getSeconds(),r.getMilliseconds())),r}};t.exports=function(t,e){null==e&&(e=Math.floor(Date.now()/1e3));for(var n=[T.yesterday,T.now,T.noon,T.midnightOrToday,T.tomorrow,T.timestamp,T.firstOrLastDay,T.backOrFrontOf,T.timeTiny12,T.timeShort12,T.timeLong12,T.mssqltime,T.timeShort24,T.timeLong24,T.iso8601long,T.gnuNoColon,T.iso8601noColon,T.americanShort,T.american,T.iso8601date4,T.iso8601dateSlash,T.dateSlash,T.gnuDateShortOrIso8601date2,T.gnuDateShorter,T.dateFull,T.pointedDate4,T.pointedDate2,T.dateNoDay,T.dateNoDayRev,T.dateTextual,T.dateNoYear,T.dateNoYearRev,T.dateNoColon,T.xmlRpc,T.xmlRpcNoColon,T.soap,T.wddx,T.exif,T.pgydotd,T.isoWeekDay,T.pgTextShort,T.pgTextReverse,T.clf,T.year4,T.ago,T.dayText,T.relativeTextWeek,T.relativeText,T.monthFullOrMonthAbbr,T.tzCorrection,T.dateShortWithTimeShort12,T.dateShortWithTimeLong12,T.dateShortWithTimeShort,T.dateShortWithTimeLong,T.relative,T.whitespace],r=Object.create(R);t.length;){for(var i=null,o=null,s=0,a=n.length;s<a;s++){var u=n[s],l=t.match(u.regex);l&&(!i||l[0].length>i[0].length)&&(i=l,o=u)}if(!o||o.callback&&!1===o.callback.apply(r,i))return!1;t=t.substr(i[0].length),i=o=null}return Math.floor(r.toDate(new Date(1e3*e))/1e3)}},function(t,e,n){"use strict";t.exports=function(t,e){function n(t,e){return a[t]?a[t]():e}function r(t,e){for(t=String(t);t.length<e;)t="0"+t;return t}var i,o=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],s=/\\?(.?)/gi,a={d:function(){return r(a.j(),2)},D:function(){return a.l().slice(0,3)},j:function(){return i.getDate()},l:function(){return o[a.w()]+"day"},N:function(){return a.w()||7},S:function(){var t=a.j(),e=t%10;return["st","nd","rd"][(e=e<=3&&1===parseInt(t%100/10,10)?0:e)-1]||"th"},w:function(){return i.getDay()},z:function(){var t=new Date(a.Y(),a.n()-1,a.j()),e=new Date(a.Y(),0,1);return Math.round((t-e)/864e5)},W:function(){var t=new Date(a.Y(),a.n()-1,a.j()-a.N()+3),e=new Date(t.getFullYear(),0,4);return r(1+Math.round((t-e)/864e5/7),2)},F:function(){return o[6+a.n()]},m:function(){return r(a.n(),2)},M:function(){return a.F().slice(0,3)},n:function(){return i.getMonth()+1},t:function(){return new Date(a.Y(),a.n(),0).getDate()},L:function(){var t=a.Y();return t%4==0&t%100!=0|t%400==0},o:function(){var t=a.n(),e=a.W();return a.Y()+(12===t&&e<9?1:1===t&&9<e?-1:0)},Y:function(){return i.getFullYear()},y:function(){return a.Y().toString().slice(-2)},a:function(){return 11<i.getHours()?"pm":"am"},A:function(){return a.a().toUpperCase()},B:function(){var t=3600*i.getUTCHours(),e=60*i.getUTCMinutes(),n=i.getUTCSeconds();return r(Math.floor((t+e+n+3600)/86.4)%1e3,3)},g:function(){return a.G()%12||12},G:function(){return i.getHours()},h:function(){return r(a.g(),2)},H:function(){return r(a.G(),2)},i:function(){return r(i.getMinutes(),2)},s:function(){return r(i.getSeconds(),2)},u:function(){return r(1e3*i.getMilliseconds(),6)},e:function(){throw new Error("Not supported (see source code of date() for timezone on how to add support)")},I:function(){return new Date(a.Y(),0)-Date.UTC(a.Y(),0)!=new Date(a.Y(),6)-Date.UTC(a.Y(),6)?1:0},O:function(){var t=i.getTimezoneOffset(),e=Math.abs(t);return(0<t?"-":"+")+r(100*Math.floor(e/60)+e%60,4)},P:function(){var t=a.O();return t.substr(0,3)+":"+t.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-i.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(s,n)},r:function(){return"D, d M Y H:i:s O".replace(s,n)},U:function(){return i/1e3|0}};return t=t,i=void 0===(e=e)?new Date:e instanceof Date?new Date(e):new Date(1e3*e),t.replace(s,n)}},function(t,e,n){"use strict";t.exports=function(t){return!1!==t&&0!==t&&""!==t&&"0"!==t&&(!Array.isArray(t)||0!==t.length)&&null!=t}},function(t,e,n){"use strict";t.exports=function(l){l.Templates.registerLoader("ajax",function(e,n,r,i){var o,s=n.precompiled,a=this.parsers[n.parser]||this.parser.twig;if("undefined"==typeof XMLHttpRequest)throw new l.Error('Unsupported platform: Unable to do ajax requests because there is no "XMLHTTPRequest" implementation');var u=new XMLHttpRequest;return u.onreadystatechange=function(){var t=null;4===u.readyState&&(200===u.status||window.cordova&&0===u.status?(l.log.debug("Got template ",u.responseText),t=!0===s?JSON.parse(u.responseText):u.responseText,n.url=e,n.data=t,o=a.call(this,n),"function"==typeof r&&r(o)):"function"==typeof i&&i(u))},u.open("GET",e,Boolean(n.async)),u.overrideMimeType("text/plain"),u.send(),!!n.async||o})}},function(t,e,n){"use strict";t.exports=function(c){var p,e;try{p=n(33),e=n(6)}catch(t){console.warn("Missing fs and path modules. "+t)}c.Templates.registerLoader("fs",function(n,r,i,o){var s,t,a=r.precompiled,u=this.parsers[r.parser]||this.parser.twig;if(!p||!e)throw new c.Error('Unsupported platform: Unable to load from file because there is no "fs" or "path" implementation');function l(t,e){t?"function"==typeof o&&o(t):(!0===a&&(e=JSON.parse(e)),r.data=e,r.path=r.path||n,s=u.call(this,r),"function"==typeof i&&i(s))}if(r.path=r.path||n,r.async)return p.stat(r.path,function(t,e){t||!e.isFile()?"function"==typeof o&&o(new c.Error("Unable to find template file "+r.path)):p.readFile(r.path,"utf8",l)}),!0;try{if(!p.statSync(r.path).isFile())throw new c.Error("Unable to find template file "+r.path)}catch(t){throw new c.Error("Unable to find template file "+r.path+". "+t)}return t=p.readFileSync(r.path,"utf8"),l(void 0,t),s})}},function(t,e){t.exports=o("fs")},function(t,e,n){"use strict";var r=n(0)(n(2));function a(t,e){var n,r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){var n;if(t)return"string"==typeof t?u(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}(t))||e&&t&&"number"==typeof t.length)return n&&(t=n),r=0,{s:e=function(){},n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){(0,r.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}t.exports=function(h){for(h.logic={},h.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set",setcapture:"Twig.logic.type.setcapture",endset:"Twig.logic.type.endset",filter:"Twig.logic.type.filter",endfilter:"Twig.logic.type.endfilter",apply:"Twig.logic.type.apply",endapply:"Twig.logic.type.endapply",do:"Twig.logic.type.do",shortblock:"Twig.logic.type.shortblock",block:"Twig.logic.type.block",endblock:"Twig.logic.type.endblock",extends_:"Twig.logic.type.extends",use:"Twig.logic.type.use",include:"Twig.logic.type.include",spaceless:"Twig.logic.type.spaceless",endspaceless:"Twig.logic.type.endspaceless",macro:"Twig.logic.type.macro",endmacro:"Twig.logic.type.endmacro",import_:"Twig.logic.type.import",from:"Twig.logic.type.from",embed:"Twig.logic.type.embed",endembed:"Twig.logic.type.endembed",with:"Twig.logic.type.with",endwith:"Twig.logic.type.endwith",deprecated:"Twig.logic.type.deprecated"},h.logic.definitions=[{type:h.logic.type.if_,regex:/^if\s?([\s\S]+)$/,next:[h.logic.type.else_,h.logic.type.elseif,h.logic.type.endif],open:!0,compile:function(t){var e=t.match[1];return t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack,delete t.match,t},parse:function(e,n,r){var i=this;return h.expression.parseAsync.call(i,e.stack,n).then(function(t){return r=!0,h.lib.boolval(t)?(r=!1,i.parseAsync(e.output,n)):""}).then(function(t){return{chain:r,output:t}})}},{type:h.logic.type.elseif,regex:/^elseif\s?([^\s].*)$/,next:[h.logic.type.else_,h.logic.type.elseif,h.logic.type.endif],open:!1,compile:function(t){var e=t.match[1];return t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack,delete t.match,t},parse:function(e,n,r){var i=this;return h.expression.parseAsync.call(i,e.stack,n).then(function(t){return r&&h.lib.boolval(t)?(r=!1,i.parseAsync(e.output,n)):""}).then(function(t){return{chain:r,output:t}})}},{type:h.logic.type.else_,regex:/^else$/,next:[h.logic.type.endif,h.logic.type.endfor],open:!1,parse:function(t,e,n){var r=h.Promise.resolve("");return(r=n?this.parseAsync(t.output,e):r).then(function(t){return{chain:n,output:t}})}},{type:h.logic.type.endif,regex:/^endif$/,next:[],open:!1},{type:h.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([\S\s]+?)(?:\s+if\s+([^\s].*))?$/,next:[h.logic.type.else_,h.logic.type.endfor],open:!0,compile:function(t){var e=t.match[1],n=t.match[2],r=t.match[3],i=null;if(t.keyVar=null,t.valueVar=null,e.includes(",")){if(2!==(i=e.split(",")).length)throw new h.Error("Invalid expression in for loop: "+e);t.keyVar=i[0].trim(),t.valueVar=i[1].trim()}else t.valueVar=e.trim();return t.expression=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack,r&&(t.conditional=h.expression.compile.call(this,{type:h.expression.type.expression,value:r}).stack),delete t.match,t},parse:function(r,i,t){function n(t,e){var n=f({},i);return n[r.valueVar]=e,r.keyVar&&(n[r.keyVar]=t),n.loop=p(u,o),(void 0===c?h.Promise.resolve(!0):h.expression.parseAsync.call(l,c,n)).then(function(t){if(t)return l.parseAsync(r.output,n).then(function(t){a.push(t),u+=1})}).then(function(){delete n.loop,delete n[r.valueVar],delete n[r.keyVar],h.merge(i,n,!0)})}var o,s,a=[],u=0,l=this,c=r.conditional,p=function(t,e){var n=void 0!==c;return{index:t+1,index0:t,revindex:n?void 0:e-t,revindex0:n?void 0:e-t-1,first:0===t,last:n?void 0:t===e-1,length:n?void 0:e,parent:i}};return h.expression.parseAsync.call(l,r.expression,i).then(function(e){return Array.isArray(e)?(o=e.length,h.async.forEach(e,function(t){return n(u,t)})):h.lib.is("Object",e)?(s=void 0===e._keys?Object.keys(e):e._keys,o=s.length,h.async.forEach(s,function(t){if("_keys"!==t)return n(t,e[t])})):void 0}).then(function(){return{chain:0===a.length,context:i,output:h.output.call(l.template,a)}})}},{type:h.logic.type.endfor,regex:/^endfor$/,next:[],open:!1},{type:h.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*([\s\S]+)$/,next:[],open:!0,compile:function(t){var e=t.match[1].trim(),n=t.match[2],n=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack;return t.key=e,t.expression=n,delete t.match,t},parse:function(t,e,n){var r=t.key;return h.expression.parseAsync.call(this,t.expression,e).then(function(t){return t===e&&(t=f({},t)),e[r]=t,{chain:n,context:e}})}},{type:h.logic.type.setcapture,regex:/^set\s+([a-zA-Z0-9_,\s]+)$/,next:[h.logic.type.endset],open:!0,compile:function(t){var e=t.match[1].trim();return t.key=e,delete t.match,t},parse:function(t,e,n){var r=this,i=t.key;return r.parseAsync(t.output,e).then(function(t){return r.context[i]=t,e[i]=t,{chain:n,context:e}})}},{type:h.logic.type.endset,regex:/^endset$/,next:[],open:!1},{type:h.logic.type.filter,regex:/^filter\s+(.+)$/,next:[h.logic.type.endfilter],open:!0,compile:function(t){var e="|"+t.match[1].trim();return t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack,delete t.match,t},parse:function(e,n,r){var i=this;return i.parseAsync(e.output,n).then(function(t){t=[{type:h.expression.type.string,value:t}].concat(e.stack);return h.expression.parseAsync.call(i,t,n)}).then(function(t){return{chain:r,output:t}})}},{type:h.logic.type.endfilter,regex:/^endfilter$/,next:[],open:!1},{type:h.logic.type.apply,regex:/^apply\s+(.+)$/,next:[h.logic.type.endapply],open:!0,compile:function(t){var e="|"+t.match[1].trim();return t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack,delete t.match,t},parse:function(e,n,r){var i=this;return i.parseAsync(e.output,n).then(function(t){t=[{type:h.expression.type.string,value:t}].concat(e.stack);return h.expression.parseAsync.call(i,t,n)}).then(function(t){return{chain:r,output:t}})}},{type:h.logic.type.endapply,regex:/^endapply$/,next:[],open:!1},{type:h.logic.type.do,regex:/^do\s+([\S\s]+)$/,next:[],open:!0,compile:function(t){var e=t.match[1],e=h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack;return t.expression=e,delete t.match,t},parse:function(t,e,n){return h.expression.parseAsync.call(this,t.expression,e).then(function(){return{chain:n,context:e}})}},{type:h.logic.type.block,regex:/^block\s+(\w+)$/,next:[h.logic.type.endblock],open:!0,compile:function(t){return t.blockName=t.match[1].trim(),delete t.match,t},parse:function(t,e,n){var r=h.Promise.resolve();return this.template.blocks.defined[t.blockName]=new h.Block(this.template,t),(r=null===this.template.parentTemplate||this.template.parentTemplate instanceof h.Template?this.getBlock(t.blockName).render(this,e):r).then(function(t){return{chain:n,output:t}})}},{type:h.logic.type.shortblock,regex:/^block\s+(\w+)\s+(.+)$/,next:[],open:!0,compile:function(t){return t.expression=t.match[2].trim(),t.output=h.expression.compile({type:h.expression.type.expression,value:t.expression}).stack,h.logic.handler[h.logic.type.block].compile.apply(this,[t])},parse:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return h.logic.handler[h.logic.type.block].parse.apply(this,e)}},{type:h.logic.type.endblock,regex:/^endblock(?:\s+(\w+))?$/,next:[],open:!1},{type:h.logic.type.extends_,regex:/^extends\s+(.+)$/,next:[],open:!0,compile:function(t){var e=t.match[1].trim();return delete t.match,t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack,t},parse:function(t,e,n){var r=this;return h.expression.parseAsync.call(r,t.stack,e).then(function(t){var e;return Array.isArray(t)?null!==(e=t.reverse().reduce(function(e,t){try{return{render:r.template.importFile(t),fileName:t}}catch(t){return e}},{render:null,fileName:null})).fileName&&(r.template.parentTemplate=e.fileName):r.template.parentTemplate=t,{chain:n,output:""}})}},{type:h.logic.type.use,regex:/^use\s+(.+)$/,next:[],open:!0,compile:function(t){var e=t.match[1].trim();return delete t.match,t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack,t},parse:function(t,e,n){var r=this;return h.expression.parseAsync.call(r,t.stack,e).then(function(t){var t=r.template.importFile(t),e=new h.ParseState(t);return e.parseAsync(t.tokens).then(function(){r.template.blocks.imported=f(f({},r.template.blocks.imported),e.getBlocks())})}).then(function(){return{chain:n,output:""}})}},{type:h.logic.type.include,regex:/^include\s+(.+?)(?:\s|$)(ignore missing(?:\s|$))?(?:with\s+([\S\s]+?))?(?:\s|$)(only)?$/,next:[],open:!0,compile:function(t){var e=t.match,n=e[1].trim(),r=void 0!==e[2],i=e[3],e=void 0!==e[4]&&e[4].length;return delete t.match,t.only=e,t.ignoreMissing=r,t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack,void 0!==i&&(t.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:i.trim()}).stack),t},parse:function(t,e,n){var r=t.only?{}:f({},e),i=t.ignoreMissing,o=this,s={chain:n,output:""};return(void 0===t.withStack?h.Promise.resolve():h.expression.parseAsync.call(o,t.withStack,e).then(function(t){r=f(f({},r),t)})).then(function(){return h.expression.parseAsync.call(o,t.stack,e)}).then(function(t){t=Array.isArray(t)?t:[t],t=t.reduce(function(t,e){if(null===t.render){if(e instanceof h.Template)return{render:e.renderAsync(r,{isInclude:!0}),lastError:null};try{return{render:o.template.importFile(e).renderAsync(r,{isInclude:!0}),lastError:null}}catch(t){return{render:null,lastError:t}}}return t},{render:null,lastError:null});if(null!==t.render)return t.render;if(null===t.render&&i)return"";throw t.lastError}).then(function(t){return""!==t&&(s.output=t),s})}},{type:h.logic.type.spaceless,regex:/^spaceless$/,next:[h.logic.type.endspaceless],open:!0,parse:function(t,e,n){return this.parseAsync(t.output,e).then(function(t){t=t.replace(/>\s+</g,"><").trim(),t=new h.Markup(t);return{chain:n,output:t}})}},{type:h.logic.type.endspaceless,regex:/^endspaceless$/,next:[],open:!1},{type:h.logic.type.macro,regex:/^macro\s+(\w+)\s*\(\s*((?:\w+(?:\s*=\s*([\s\S]+))?(?:,\s*)?)*)\s*\)$/,next:[h.logic.type.endmacro],open:!0,compile:function(t){var e=t.match[1],n=t.match[2].split(/\s*,\s*/),r=n.map(function(t){return t.split(/\s*=\s*/)[0]}),i=r.length;if(1<i)for(var o={},s=0;s<i;s++){var a=r[s];if(o[a])throw new h.Error("Duplicate arguments for parameter: "+a);o[a]=1}return t.macroName=e,t.parameters=r,t.defaults=n.reduce(function(t,e){var e=e.split(/\s*=\s*/),n=e[0],e=e[1];return t[n]=e?h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack:void 0,t},{}),delete t.match,t},parse:function(i,o,t){var s=this;return s.macros[i.macroName]=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];var r=f(f({},o),{},{_self:s.macros});return h.async.forEach(i.parameters,function(e,t){if(void 0!==n[t])r[e]=n[t];else{if(void 0!==i.defaults[e])return h.expression.parseAsync.call(this,i.defaults[e],o).then(function(t){return r[e]=t,h.Promise.resolve()});r[e]=void 0}return!0}).then(function(){return s.parseAsync(i.output,r)})},{chain:t,output:""}}},{type:h.logic.type.endmacro,regex:/^endmacro$/,next:[],open:!1},{type:h.logic.type.import_,regex:/^import\s+(.+)\s+as\s+(\w+)$/,next:[],open:!0,compile:function(t){var e=t.match[1].trim(),n=t.match[2].trim();return delete t.match,t.expression=e,t.contextName=n,t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:e}).stack,t},parse:function(n,r,t){var e=this,i={chain:t,output:""};return"_self"===n.expression?(r[n.contextName]=e.macros,i):h.expression.parseAsync.call(e,n.stack,r).then(function(t){return e.template.importFile(t||n.expression)}).then(function(t){var e=new h.ParseState(t);return e.parseAsync(t.tokens).then(function(){return r[n.contextName]=e.macros,i})})}},{type:h.logic.type.from,regex:/^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,next:[],open:!0,compile:function(t){var e,n=t.match[1].trim(),r={},i=a(t.match[2].trim().split(/\s*,\s*/));try{for(i.s();!(e=i.n()).done;){var o=e.value,s=o.match(/^(\w+)\s+as\s+(\w+)$/);s?r[s[1].trim()]=s[2].trim():o.match(/^(\w+)$/)&&(r[o]=o)}}catch(t){i.e(t)}finally{i.f()}return delete t.match,t.expression=n,t.macroNames=r,t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack,t},parse:function(n,r,i){var e=this,t="_self"===n.expression?h.Promise.resolve(e.macros):h.expression.parseAsync.call(e,n.stack,r).then(function(t){return e.template.importFile(t||n.expression)}).then(function(t){var e=new h.ParseState(t);return e.parseAsync(t.tokens).then(function(){return e.macros})});return t.then(function(t){for(var e in n.macroNames)void 0!==t[e]&&(r[n.macroNames[e]]=t[e]);return{chain:i,output:""}})}},{type:h.logic.type.embed,regex:/^embed\s+(.+?)(?:\s+(ignore missing))?(?:\s+with\s+([\S\s]+?))?(?:\s+(only))?$/,next:[h.logic.type.endembed],open:!0,compile:function(t){var e=t.match,n=e[1].trim(),r=void 0!==e[2],i=e[3],e=void 0!==e[4]&&e[4].length;return delete t.match,t.only=e,t.ignoreMissing=r,t.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack,void 0!==i&&(t.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:i.trim()}).stack),t},parse:function(n,t,e){var r={},i=h.Promise.resolve(),o=this;return n.only||(r=f({},t)),(i=void 0!==n.withStack?h.expression.parseAsync.call(o,n.withStack,t).then(function(t){r=f(f({},r),t)}):i).then(function(){return h.expression.parseAsync.call(o,n.stack,r)}).then(function(t){var e=new h.Template({data:n.output,id:o.template.id,base:o.template.base,path:o.template.path,url:o.template.url,name:o.template.name,method:o.template.method,options:o.template.options});try{e.importFile(t)}catch(t){if(n.ignoreMissing)return"";throw o=null,t}return e.parentTemplate=t,e.renderAsync(r,{isInclude:!0})}).then(function(t){return{chain:e,output:t}})}},{type:h.logic.type.endembed,regex:/^endembed$/,next:[],open:!1},{type:h.logic.type.with,regex:/^(?:with\s+([\S\s]+?))(?:\s|$)(only)?$/,next:[h.logic.type.endwith],open:!0,compile:function(t){var e=t.match,n=e[1],e=void 0!==e[2]&&e[2].length;return delete t.match,t.only=e,void 0!==n&&(t.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:n.trim()}).stack),t},parse:function(t,e,n){var r,i={},o=this,s=h.Promise.resolve();return t.only||(i=f({},e)),(s=void 0!==t.withStack?h.expression.parseAsync.call(o,t.withStack,e).then(function(t){for(r in t)Object.hasOwnProperty.call(t,r)&&(i[r]=t[r])}):s).then(function(){return o.parseAsync(t.output,i)}).then(function(t){return{chain:n,output:t}})}},{type:h.logic.type.endwith,regex:/^endwith$/,next:[],open:!1},{type:h.logic.type.deprecated,regex:/^deprecated\s+(.+)$/,next:[],open:!0,compile:function(t){return console.warn("Deprecation notice: "+t.match[1]),t},parse:function(){return{}}}],h.logic.handler={},h.logic.extendType=function(t,e){h.logic.type[t]=e=e||"Twig.logic.type"+t},h.logic.extend=function(t){if(!t.type)throw new h.Error("Unable to extend logic definition. No type provided for "+t);h.logic.extendType(t.type),h.logic.handler[t.type]=t};0<h.logic.definitions.length;)h.logic.extend(h.logic.definitions.shift());return h.logic.compile=function(t){var t=t.value.trim(),t=h.logic.tokenize.call(this,t),e=h.logic.handler[t.type];return e.compile&&(t=e.compile.call(this,t),h.log.trace("Twig.logic.compile: ","Compiled logic token to ",t)),t},h.logic.tokenize=function(t){var e,n,r,i,o=null,s=null,a=null;for(o in t=t.trim(),h.logic.handler)if(Object.hasOwnProperty.call(h.logic.handler,o))for(e=h.logic.handler[o].type,s=n=h.logic.handler[o].regex,r=(s=Array.isArray(n)?s:[n]).length,a=0;a<r;a++)if(null!==(i=s[a].exec(t)))return h.log.trace("Twig.logic.tokenize: ","Matched a ",e," regular expression of ",i),{type:e,match:i};throw new h.Error("Unable to parse '"+t.trim()+"'")},h.logic.parse=function(n,r,i,t){return h.async.potentiallyAsync(this,t,function(){h.log.debug("Twig.logic.parse: ","Parsing logic token ",n);var t=h.logic.handler[n.type],e=this;return t.parse?(e.nestingStack.unshift(n),t=t.parse.call(e,n,r||{},i),h.isPromise(t)?t=t.then(function(t){return e.nestingStack.shift(),t}):e.nestingStack.shift(),t):""})},h}},function(t,e,n){"use strict";t.exports=function(t){t.Templates.registerParser("source",function(t){return t.data||""})}},function(t,e,n){"use strict";t.exports=function(e){e.Templates.registerParser("twig",function(t){return new e.Template(t)})}},function(t,e,p){"use strict";var u=p(0)(p(1));t.exports=function(c){return c.path={},c.path.parsePath=function(t,e){var n=null,r=t.options.namespaces,i=e||"";if(r&&"object"===(0,u.default)(r))for(n in r)if(i.includes(n)){var o=new RegExp("^"+n+"::"),s=new RegExp("^@"+n+"/"),a=r[n].replace(/([^/])$/,"$1/");if(o.test(i))return i=i.replace(o,a);if(s.test(i))return i=i.replace(s,a)}return c.path.relativePath(t,i)},c.path.relativePath=function(t,e){var n,r,i="/",o=[],e=e||"";if(t.url)s=void 0===t.base?t.url:t.base.replace(/([^/])$/,"$1/");else if(t.path){var s,a=p(6),u=a.sep||i,l=new RegExp("^\\.{1,2}"+u.replace("\\","\\\\")),e=e.replace(/\//g,u);s=(s=void 0!==t.base&&null===e.match(l)?(e=e.replace(t.base,""),t.base+u):a.normalize(t.path)).replace(u+u,u),i=u}else{if(!t.name&&!t.id||!t.method||"fs"===t.method||"ajax"===t.method)throw new c.Error("Cannot extend an inline template.");s=t.base||t.name||t.id}for((n=s.split(i)).pop(),n=n.concat(e.split(i));0<n.length;)"."!==(r=n.shift())&&(".."===r&&0<o.length&&".."!==o[o.length-1]?o.pop():o.push(r));return o.join(i)},c}},function(t,e,n){"use strict";t.exports=function(r){return r.tests={empty:function(t){if(null!=t){if("number"==typeof t)return!1;if(0<t.length)return!1;for(var e in t)if(Object.hasOwnProperty.call(t,e))return!1}return!0},odd:function(t){return t%2==1},even:function(t){return t%2==0},divisibleby:function(t,e){return t%e[0]==0},defined:function(t){return void 0!==t},none:function(t){return null===t},null:function(t){return this.none(t)},"same as":function(t,e){return t===e[0]},sameas:function(t,e){return console.warn("`sameas` is deprecated use `same as`"),r.tests["same as"](t,e)},iterable:function(t){return t&&(r.lib.is("Array",t)||r.lib.is("Object",t))}},r.test=function(t,e,n){if(r.tests[t])return r.tests[t](e,n);throw r.Error("Test "+t+" is not defined.")},r.test.extend=function(t,e){r.tests[t]=e},r}},function(t,e,n){"use strict";t.exports=function(u){return u.ParseState.prototype.parseAsync=function(t,e){return this.parse(t,e,!0)},u.expression.parseAsync=function(t,e,n){return u.expression.parse.call(this,t,e,n,!0)},u.logic.parseAsync=function(t,e,n){return u.logic.parse.call(this,t,e,n,!0)},u.Template.prototype.renderAsync=function(t,e){return this.render(t,e,!0)},u.async={},u.isPromise=function(t){return t&&t.then&&"function"==typeof t.then},u.async.potentiallyAsync=function(t,e,n){if(e)return u.Promise.resolve(n.call(t));var e=t,r=n.call(e),i=null,o=!0;if(u.isPromise(r)){if(r.then(function(t){r=t,o=!1}).catch(function(t){i=t}),null!==i)throw i;if(o)throw new u.Error("You are using Twig.js in sync mode in combination with async extensions.")}return r},u.Thenable=function(t,e,n){this.then=t,this._value=n?e:null,this._state=n||0},u.Thenable.prototype.catch=function(t){return 1===this._state?this:this.then(null,t)},u.Thenable.resolvedThen=function(t){try{return u.Promise.resolve(t(this._value))}catch(t){return u.Promise.reject(t)}},u.Thenable.rejectedThen=function(t,e){if(!e||"function"!=typeof e)return this;var n,r=this._value;try{n=e(r)}catch(t){n=u.Promise.reject(t)}return u.Promise.resolve(n)},u.Promise=function(t){var n=0,r=null,e=function(t,e){n=t,r=e};var i=function(t){e(1,t)},o=function(t){e(2,t)};try{t(i,o)}catch(t){o(t)}return 1===n?u.Promise.resolve(r):2===n?u.Promise.reject(r):(e=new u.FullPromise).promise},u.FullPromise=function(){var n=null;function r(t){t(a._value)}function i(t,e){e(a._value)}var s=function(t,e){t=[t=t,e,-2],(e=n)?-2===e[2]?e=[e,t]:e.push(t):e=t,n=e};function t(t,e){a._state||(a._value=e,a._state=t,s=1===t?r:i,n=n&&(-2===n[2]?s(n[0],n[1]):n.forEach(function(t){s(t[0],t[1])}),null))}var a=new u.Thenable(function(r,i){var t="function"==typeof r;if(1===a._state&&!t)return u.Promise.resolve(a._value);if(1===a._state)try{return u.Promise.resolve(r(a._value))}catch(t){return u.Promise.reject(t)}var o="function"==typeof i;return new u.Promise(function(e,n){s(t?function(t){try{e(r(t))}catch(t){n(t)}}:e,o?function(t){try{e(i(t))}catch(t){n(t)}}:n)})});return t.promise=a,t},u.Promise.defaultResolved=new u.Thenable(u.Thenable.resolvedThen,void 0,1),u.Promise.emptyStringResolved=new u.Thenable(u.Thenable.resolvedThen,"",1),u.Promise.resolve=function(t){return 0===arguments.length||void 0===t?u.Promise.defaultResolved:u.isPromise(t)?t:""===t?u.Promise.emptyStringResolved:new u.Thenable(u.Thenable.resolvedThen,t,1)},u.Promise.reject=function(t){return new u.Thenable(u.Thenable.rejectedThen,t,2)},u.Promise.all=function(t){var n=new Array(t.length);return u.async.forEach(t,function(t,e){if(u.isPromise(t)){if(1!==t._state)return t.then(function(t){n[e]=t});n[e]=t._value}else n[e]=t}).then(function(){return n})},u.async.forEach=function(n,r){var i=n?n.length:0,o=0;return function t(){var e=null;do{if(o===i)return u.Promise.resolve()}while(e=r(n[o],o),o++,!e||!u.isPromise(e)||1===e._state);return e.then(t)}()},u}},function(t,e,n){"use strict";t.exports=function(a){return a.exports={VERSION:a.VERSION},a.exports.twig=function(t){var e=t.id,n={strictVariables:t.strict_variables||!1,autoescape:null!==t.autoescape&&t.autoescape||!1,allowInlineIncludes:t.allowInlineIncludes||!1,rethrow:t.rethrow||!1,namespaces:t.namespaces};if(a.cache&&e&&a.validateId(e),void 0!==t.debug&&(a.debug=t.debug),void 0!==t.trace&&(a.trace=t.trace),void 0!==t.data)return a.Templates.parsers.twig({data:t.data,path:Object.hasOwnProperty.call(t,"path")?t.path:void 0,module:t.module,id:e,options:n});if(void 0!==t.ref){if(void 0!==t.id)throw new a.Error("Both ref and id cannot be set on a twig.js template.");return a.Templates.load(t.ref)}if(void 0===t.method)return void 0!==t.href?a.Templates.loadRemote(t.href,{id:e,method:"ajax",parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:n},t.load,t.error):void 0!==t.path?a.Templates.loadRemote(t.path,{id:e,method:"fs",parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:n},t.load,t.error):void 0;if(a.Templates.isRegisteredLoader(t.method))return a.Templates.loadRemote(t.name||t.href||t.path||e||void 0,{id:e,method:t.method,parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:n},t.load,t.error);throw new a.Error('Loader for "'+t.method+'" is not defined.')},a.exports.extendFilter=function(t,e){a.filter.extend(t,e)},a.exports.extendFunction=function(t,e){a._function.extend(t,e)},a.exports.extendTest=function(t,e){a.test.extend(t,e)},a.exports.extendTag=function(t){a.logic.extend(t)},a.exports.extend=function(t){t(a)},a.exports.compile=function(t,e){var n=e.filename,r=e.filename,i=new a.Template({data:t,path:r,id:n,options:e.settings["twig options"]});return function(t){return i.render(t)}},a.exports.renderFile=function(t,e,n){"function"==typeof e&&(n=e,e={});var r=(e=e||{}).settings||{},i=r["twig options"],o={path:t,base:r.views,load:function(t){i&&i.allowAsync?t.renderAsync(e).then(function(t){return n(null,t)},n):n(null,String(t.render(e)))},error:function(t){n(t)}};if(i)for(var s in i)Object.hasOwnProperty.call(i,s)&&(o[s]=i[s]);a.exports.twig(o)},a.exports.__express=a.exports.renderFile,a.exports.cache=function(t){a.cache=t},a.exports.path=a.path,a.exports.filters=a.filters,a.exports.tests=a.tests,a.exports.functions=a.functions,a.exports.Promise=a.Promise,a}}],r={},i.m=n,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===_typeof3(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7);function i(t){var e;return(r[t]||(e=r[t]={i:t,l:!1,exports:{}},n[t].call(e.exports,e,e.exports,i),e.l=!0,e)).exports}var n,r},"object"===_typeof3(i)&&"object"===_typeof3(r)?r.exports=e():"function"==typeof define&&define.amd?define([],e):"object"===_typeof3(i)?i.Twig=e():t.Twig=e()}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{fs:55,path:281}],289:[function(t,e,n){"use strict";var r=t("../prototype/is");e.exports=function(t){if("function"!=typeof t)return!1;if(!hasOwnProperty.call(t,"length"))return!1;try{if("number"!=typeof t.length)return!1;if("function"!=typeof t.call)return!1;if("function"!=typeof t.apply)return!1}catch(t){return!1}return!r(t)}},{"../prototype/is":292}],290:[function(t,e,n){"use strict";var r=t("../value/is"),i={object:!0,function:!0,undefined:!0};e.exports=function(t){return!!r(t)&&hasOwnProperty.call(i,_typeof3(t))}},{"../value/is":293}],291:[function(t,e,n){"use strict";var r=t("../function/is"),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;e.exports=function(t){return!!r(t)&&!i.test(o.call(t))}},{"../function/is":289}],292:[function(t,e,n){"use strict";var r=t("../object/is");e.exports=function(t){if(!r(t))return!1;try{return t.constructor?t.constructor.prototype===t:!1}catch(t){return!1}}},{"../object/is":290}],293:[function(t,e,n){"use strict";e.exports=function(t){return null!=t}},{}],294:[function(t,e,n){function r(t,e){function n(t){return!isNaN(parseFloat(t))&&isFinite(t)}var r,i={},o=("key"in(e="string"==typeof e?{key:e}:e||{key:"weight"})||(e.key="weight"),"compareFunction"in e||(e.compareFunction=function(t,e){return t===e?0:n(t)&&n(e)?parseFloat(t)<parseFloat(e)?-1:1:t<e?-1:1}),!1);if(void 0===t.length){var s=[],o=!0;for(h in t)t[h].__weightSort_index=h,s.push(t[h]);t=s}for(h=0;h<t.length;h++){var a,u=t[h],u=u.length?(a=u[0],u[1]):(a=u[e.key],u);i[a=(a="function"==typeof a?a():a)||0]||(i[a]=[]),i[a].push(u)}var l,c=[];for(l in i)c.push(l);c.sort(e.compareFunction),e.reverse&&c.reverse();for(var p=[],h=0;h<c.length;h++)for(r=0;r<i[c[h]].length;r++)p.push(i[c[h]][r]);if(o){for(s={},h=0;h<p.length;h++){var f=p[h],d=f.__weightSort_index;delete f.__weightSort_index,s[d]=f}p=s}return p}void 0!==e&&e.exports&&(e.exports=r),"undefined"!=typeof window&&(window.weightSort=r,window.weight_sort=r)},{}],295:[function(t,e,n){var r=t("./isTrue"),d=t("./styleToLeaflet"),i=t("./parseLength"),t=function(){"use strict";function e(t){_classCallCheck2(this,e),this.layer=t,L.polylineDecorator&&(this.layer.on("update",this.processObject.bind(this)),this.layer.on("remove",this.removeObject.bind(this)))}return _createClass2(e,[{key:"parseType",value:function(t,e,n){switch(t){case"polygon":case"rotate":return r(e);case"pixelSize":case"repeat":case"offset":case"endOffset":case"lineOffset":return i(e,n.map.metersPerPixel);case"angleCorrection":case"headAngle":return parseFloat(e);default:return e}}},{key:"processObject",value:function(t,p){var h,f=this;p.patternFeatures||(p.patternFeatures={});for(h in p.features)!function(){var t="default"===h?p.data.style:p.data["style:"+h];if(p.styles.includes(h)){var e,n,r={},i=[],o={};for(e in t){var s=e.match(/^pattern([^-]*)$/);s&&(r[s[1]]=t[e],i[s[1]]={},o[s[1]]={})}for(n in t){var a=n.match(/^pattern([^-]*)-path-(.*)$/),u=n.match(/^pattern([^-]*)-(.*)$/);a?o[a[1]][a[2]]=t[n]:u&&(i[u[1]][u[2]]=f.parseType(u[2],t[n],p.twigData))}var l=Object.keys(r),c=[];l.forEach(function(t){var e,n=i[t];switch(r[t]){case"dash":n.pathOptions=d(o[t],p.twigData),e=L.Symbol.dash(n);break;case"streak":n.pathOptions=d(o[t],p.twigData),e=L.Symbol.streak(n);break;case"arrowHead":n.pathOptions=d(o[t],p.twigData),e=L.Symbol.arrowHead(n);break;case"marker":n.markerOptions=o[t],e=L.Symbol.marker(n)}e&&(i[t].symbol=e,c.push(i[t]))}),p.patternFeatures[h]||(p.patternFeatures[h]=L.polylineDecorator(p.features[h]),p.patternFeatures[h].addTo(f.layer.map)),p.patternFeatures[h].setPatterns(c),f.layer._shallBindPopupToStyle(h)&&p.patternFeatures[h].bindPopup(p.popup)}else p.patternFeatures[h]&&(f.layer.map.removeLayer(p.patternFeatures[h]),delete p.patternFeatures[h])}()}},{key:"removeObject",value:function(t,e){if(e.patternFeatures)for(var n in e.features)e.patternFeatures[n]&&(this.layer.map.removeLayer(e.patternFeatures[n]),delete e.patternFeatures[n])}}]),e}();e.exports=t},{"./isTrue":306,"./parseLength":307,"./styleToLeaflet":310}],296:[function(t,e,n){var r=t("./SublayerFeature"),t=function(){"use strict";_inherits(n,r);var t=_createSuper(n);function n(){return _classCallCheck2(this,n),t.apply(this,arguments)}return _createClass2(n,[{key:"compileTwigData",value:function(){var t,e=this,r=this.object,i=_get(_getPrototypeOf(n.prototype),"compileTwigData",this).call(this);for(t in this.sublayer.masterlayer.visibleFeatures)!function(){var n=e.sublayer.masterlayer.visibleFeatures[t];n.object.members&&n.object.members.forEach(function(t,e){t.id===r.id&&("masters"in i||(i.masters=[]),i.masters.push({id:n.id,type:n.object.type,osm_id:n.object.osm_id,tags:n.object.tags,meta:n.object.meta,role:t.role,dir:t.dir,connectedPrev:t.connectedPrev,connectedNext:t.connectedNext,flags:n.flags,sequence:e}))})}();return i}}]),n}();e.exports=t},{"./SublayerFeature":303}],297:[function(t,e,n){var i=t("./Sublayer"),o=t("./MemberFeature");e.exports=function(){"use strict";_inherits(r,i);var n=_createSuper(r);function r(t,e){return _classCallCheck2(this,r),(t=n.call(this,t,e)).masterlayer=t.master.mainlayer,t.featureClass=o,t.masterlayer.on("add",t.featureOnMainModified.bind(_assertThisInitialized(t))),t.masterlayer.on("remove",t.featureOnMainModified.bind(_assertThisInitialized(t))),t.masterlayer.on("update",t.featureOnMainModified.bind(_assertThisInitialized(t))),t.on("add",t.featureMemberModified.bind(_assertThisInitialized(t))),t.on("remove",t.featureMemberModified.bind(_assertThisInitialized(t))),t}return _createClass2(r,[{key:"featureMemberModified",value:function(t,e){var n=this;t.memberOf.forEach(function(t){n.masterlayer.scheduleReprocess(t.id)})}},{key:"featureOnMainModified",value:function(t){var e=this;t.members&&t.members.forEach(function(t){t.id in e.visibleFeatures&&e.scheduleReprocess(t.id)})}}]),r}()},{"./MemberFeature":296,"./Sublayer":302}],298:[function(t,e,n){var r=".leaflet-popup-content {\n  max-height: 250px;\n  overflow: auto;\n}\n.leaflet-popup-content pre {\n  font-size: 8px;\n}\n.overpass-layer-icon > img,\n.overpass-layer-icon > svg {\n  display: block;\n}\n.overpass-layer-icon div.sign {\n  position: relative;\n  font-size: 12px;\n  text-align: center;\n  transform: translate(-50%, -50%);\n  display: flex;\n  justify-content: center;\n}\n/*  top: -37px; */\n";t("browserify-css").createStyle(r,{href:"src/OverpassLayer.css"},{insertAt:"bottom"}),e.exports=r},{"browserify-css":56}],299:[function(l,f,t){!function(u){!function(){l("./OverpassLayer.css");var t=l("event-emitter"),c=l("boundingbox"),n=l("twig"),p=l("overpass-frontend"),r=l("html-escape"),h={intersect:l("@turf/intersect").default},i=l("./Sublayer"),o=l("./Memberlayer"),s=l("./compileFeature"),a=l("./compileTemplate"),e=function(){"use strict";function e(t){_classCallCheck2(this,e),this.options=t=t||{},this.overpassFrontend=("overpassFrontend"in this.options?this.options:u).overpassFrontend,this.options.minZoom="minZoom"in this.options?this.options.minZoom:16,this.options.maxZoom="maxZoom"in this.options?this.options.maxZoom:void 0,this.options.feature="feature"in this.options?this.options.feature:{},this.options.feature.style="style"in this.options.feature?this.options.feature.style:{},this.options.feature.title="title"in this.options.feature?this.options.feature.title:function(t){return r(t.tags.name||t.tags.operator||t.tags.ref||t.id)},this.options.feature.body="body"in this.options.feature?this.options.feature.body:"",this.options.feature.markerSymbol="markerSymbol"in this.options.feature?this.options.feature.markerSymbol:'<img anchorX="13" anchorY="42" width="25" height="42" signAnchorX="0" signAnchorY="-30" src="img/map_pointer.png">',this.options.feature.markerSign="markerSign"in this.options.feature?this.options.feature.markerSign:null,this.options.queryOptions="queryOptions"in this.options?this.options.queryOptions:{},"properties"in this.options.queryOptions||(this.options.queryOptions.properties=p.ALL),this.options.styleNoBindPopup=this.options.styleNoBindPopup||[],this.options.stylesNoAutoShow=this.options.stylesNoAutoShow||[],this.options.layouts=this.options.layouts||{},this.options.layouts.popup=this.options.layouts.popup||'<h1>{{ object.popupTitle|default(object.title) }}</h1>{% if object.popupDescription or object.description %}<div class="description">{{ object.popupDescription|default(object.description) }}</div>{% endif %}{% if object.popupBody or object.body %}<div class="body">{{ object.popupBody|default(object.body) }}</div>{% endif %}',s(this.options.feature,n,{autoescape:!0}),s(this.options.layouts,n,{autoescape:!1}),this.currentRequest=null,this.lastZoom=null,this.mainlayer=new i(this,t),this.subLayers={main:this.mainlayer},this.options.members&&(this.options.queryOptions.properties=p.TAGS|p.META|p.MEMBERS|p.BBOX,this.options.queryOptions.memberProperties=p.ALL,this.options.queryOptions.members=!0,t={id:this.options.id,sublayer_id:"member",minZoom:this.options.minZoom,maxZoom:this.options.maxZoom,feature:this.options.memberFeature,styleNoBindPopup:this.options.styleNoBindPopup||[],stylesNoAutoShow:this.options.stylesNoAutoShow||[],layouts:this.options.layouts,const:this.options.const},this.options.updateAssets&&(t.updateAssets=this.options.updateAssets),s(t.feature,n),this.memberlayer=new o(this,t),this.subLayers.member=this.memberlayer)}return _createClass2(e,[{key:"setBounds",value:function(t){this.options.bounds=t,this.check_update_map()}},{key:"setLayout",value:function(t,e){this.options.layouts[t]=a(e,n,{autoescape:!1})}},{key:"_layerAdd",value:function(t){this.addTo(t.target)}},{key:"onRemove",value:function(){this.remove()}},{key:"fire",value:function(){}},{key:"addTo",value:function(t){for(var e in this.map=t,this.map.on("moveend",this.check_update_map,this),this.subLayers)this.subLayers[e].addTo(t);this.check_update_map(),this.map.createPane("hover"),this.map.getPane("hover").style.zIndex=499}},{key:"hideAll",value:function(t){for(var e in this.subLayers)this.subLayers[e].hideAll(t)}},{key:"remove",value:function(){for(var t in this.subLayers)this.subLayers[t].hideAll(!0),this.subLayers[t].remove();this.abortRequest(),this.map.off("moveend",this.check_update_map,this),this.map=null}},{key:"abortRequest",value:function(){this.currentRequest&&(this.onLoadEnd&&this.onLoadEnd({request:this.currentRequest,error:null}),this.currentRequest.abort(),this.currentRequest=null)}},{key:"setFilter",value:function(t){this.filter=t,this.check_update_map(),this.recalc()}},{key:"calcGlobalTwigData",value:function(){this.globalTwigData={map:{zoom:this.map.getZoom(),metersPerPixel:40075016.686*Math.abs(Math.cos(this.map.getCenter().lat/180*Math.PI))/Math.pow(2,this.map.getZoom()+8)}},this.emit("globalTwigData",this.globalTwigData)}},{key:"check_update_map",value:function(){var n=this;if(this.map&&this.map._loaded){var t=JSON.parse(JSON.stringify(this.options.queryOptions)),e=new c(this.map.getBounds());if(this.options.bounds&&!(e=h.intersect(e.toGeoJSON(),this.options.bounds)))for(var r in this.subLayers)this.subLayers[r].hideAll();else if(this.map.getZoom()<this.options.minZoom||void 0!==this.options.maxZoom&&this.map.getZoom()>this.options.maxZoom){for(var i in this.subLayers)this.subLayers[i].hideAll();this.abortRequest()}else{for(var o in this.subLayers)this.subLayers[o].hideNonVisible(e);var s,a=this.options.query;if((a="object"===_typeof3(a)?a[Object.keys(a).filter(function(t){return t<=this.map.getZoom()}.bind(this)).reverse()[0]]:a)!==this.lastQuery&&(s=new p.Filter(a),this.mainlayer.hideNonVisibleFilter(s),this.lastQuery=a),t.filter=this.filter,this.filter!==this.lastFilter&&(s=new p.Filter(this.filter),this.mainlayer.hideNonVisibleFilter(s),this.lastFilter=this.filter),this.lastZoom!==this.map.getZoom()){for(var u in this.calcGlobalTwigData(),this.subLayers)this.subLayers[u].zoomChange();this.lastZoom=this.map.getZoom()}if(this.abortRequest(),a){for(var l in this.subLayers)this.subLayers[l].startAdding();this.options.members&&(t.memberBounds=e,t.memberCallback=function(t,e){if(t)return console.error("unexpected error",t);n.memberlayer.add(e)}),this.currentRequest=this.overpassFrontend.BBoxQuery(a,e,t,function(t,e){t&&console.log("unexpected error",t),n.mainlayer.add(e)},function(t){for(var e in this.onLoadEnd&&this.onLoadEnd({request:this.currentRequest,error:t}),this.subLayers)this.subLayers[e].finishAdding();this.currentRequest=null}.bind(this)),this.onLoadStart&&this.onLoadStart({request:this.currentRequest})}}}}},{key:"recalc",value:function(){if(this.map&&this.map._loaded)for(var t in this.calcGlobalTwigData(),this.subLayers)this.subLayers[t].recalc()}},{key:"scheduleReprocess",value:function(t){for(var e in this.subLayers)this.subLayers[e].scheduleReprocess(t)}},{key:"updateAssets",value:function(t,e){for(var n in this.subLayers)this.subLayers[n].updateAssets(t,e)}},{key:"get",value:function(t,n){var r=!1;this.overpassFrontend.get(t,{properties:p.ALL},function(t,e){null===t&&n(t,e),r=!0},function(t){r||n(t,null)})}},{key:"show",value:function(t,e,n){var r=this.mainlayer,r=(r=e.sublayer_id?this.subLayers[e.sublayer_id]:r).show(t,e,n);return{id:t,sublayer_id:e.sublayer_id,options:e,hide:r.hide}}},{key:"hide",value:function(t){this.mainlayer.hide(t)}},{key:"openPopupOnObject",value:function(t){this.subLayers[1<arguments.length&&void 0!==arguments[1]?arguments[1]:"main"].openPopupOnObject(t)}},{key:"getShiftWorld",value:function(){return[360*Math.floor((this.map.getCenter().lng+270)/360),360*Math.floor((this.map.getCenter().lng+90)/360)]}}]),e}();t(e.prototype),e.twig=n,f.exports=e}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Memberlayer":297,"./OverpassLayer.css":298,"./Sublayer":302,"./compileFeature":304,"./compileTemplate":305,"@turf/intersect":31,boundingbox:54,"event-emitter":76,"html-escape":80,"overpass-frontend":220,twig:288}],300:[function(t,e,n){var r="ul.overpass-layer-list {\n  margin-top: 0;\n  margin-bottom: 0;\n  padding-left: 0;\n}\nul.overpass-layer-list > li {\n  position: relative;\n  list-style: none;\n  min-height: 30px;\n  padding-left: 40px;\n}\nul.overpass-layer-list > li.selected {\n  background: #e0e0e0;\n}\nul.overpass-layer-list > li > .marker {\n  position: absolute;\n  margin-left: -35px;\n  width: 30px;\n  height: 30px;\n  text-align: center;\n  display: block;\n  color: black;\n  text-decoration: none;\n}\n\nul.overpass-layer-list > li > .marker > .sign {\n  text-align: center;\n  position: absolute;\n  top: 3px;\n  font-size: 15px;\n  left: 0;\n  right: 0;\n  z-index: 1;\n  display: inline-block;\n}\nul.overpass-layer-list > li > .content > a.title {\n  display: inline-block;\n  color: black;\n  text-decoration: none;\n}\nul.overpass-layer-list > li > .content > a.title:hover,\nul.overpass-layer-list > li > .content > a.title:active {\n  text-decoration: underline;\n}\nul.overpass-layer-list > li > .content > div.description {\n  font-style: italic;\n  color: #707070;\n  float: right;\n  text-align: right;\n}\nul.overpass-layer-list > li:after {\n  content: '';\n  display: table;\n  clear: both;\n}\n.hoverable {\n  cursor: pointer;\n}\n";t("browserify-css").createStyle(r,{href:"src/OverpassLayerList.css"},{insertAt:"bottom"}),e.exports=r},{"browserify-css":56}],301:[function(t,e,n){t("./OverpassLayerList.css");var o=t("./isTrue"),t=function(){"use strict";function i(t,e){var n,r=this,t=(_classCallCheck2(this,i),1<arguments.length&&"OverpassLayer"===e.constructor.name&&(n=arguments[0],t=e,console.error('overpass-layer: class OverpassLayerList() accepts only one parameter, "layer"')),this.dom=document.createElement("ul"),this.dom.className="overpass-layer-list",this.layer=t,this.options=e||{},this.options.prefix=this.options.prefix||"list",this.selectedId=null,this.options.prefix);t in this.layer.options.layouts||this.layer.setLayout(t,'<div class="marker">{% if object.'+t+'MarkerSymbol or object.markerSymbol %}<div class="symbol">{{ object.'+t+'MarkerSymbol|default(object.markerSymbol) }}</div>{% elseif object.marker and object.marker.iconUrl %}<img class="symbol" src="{{ object.marker.iconUrl|e }}">{% endif %}{% if object.'+t+'MarkerSign or object.markerSign %}<div class="sign">{{ object.'+t+'MarkerSign|default(object.markerSign) }}</div>{% endif %}</div><div class="content"><a class="title" href="{{ object.appUrl|default("#") }}">{{ object.'+t+"Title|default(object.title) }}</a>{% if object."+t+'Description or object.description %}<div class="description">{{ object.'+t+"Description|default(object.description) }}</div>{% endif %}</div>"),this.layer.on("add",function(t,e){return r.addObject(e)}),this.layer.on("update",function(t,e){return r.updateObject(e)}),this.layer.on("remove",function(t,e){return r.delObject(e)}),this.layer.on("selectObject",function(t,e){r.selectedId=t.id,r.updateObject(e)}),this.layer.on("unselectObject",function(t,e){r.selectedId=null,r.updateObject(e)}),this.items={},n&&this.addTo(n)}return _createClass2(i,[{key:"addTo",value:function(t){t.appendChild(this.dom)}},{key:"addObject",value:function(t){var e=o(t.data[this.options.prefix+"Exclude"])||!(this.options.prefix+"Exclude"in t.data)&&o(t.data.exclude);if(!(e||t.id in this.items)){for(var n=document.createElement("li"),e=(this.selectedId===t.id&&n.classList.add("selected"),this.items[t.id]=n,t[this.options.prefix+"Item"]=n,t.layouts[this.options.prefix]||t.layouts.list||""),r=(n.innerHTML=e,n.currentHTML=e,n.priority="priority"in t.data?parseFloat(t.data.priority):0,this.dom.firstChild);r&&r.priority<=n.priority;)r=r.nextSibling;r?this.dom.insertBefore(n,r):this.dom.appendChild(n),t.sublayer.updateAssets(n,t.data),n.onmouseover=function(t,e){this.currentHover&&this.currentHover.hide(),this.currentHover=this.layer.show(t,{styles:["hover"],flags:["hover"],sublayer_id:e},function(){})}.bind(this,t.id,t.sublayer_id),n.onmouseout=function(t,e){this.currentHover&&this.currentHover.hide(),this.currentHover=null}.bind(this,t.id,t.sublayer_id),n.onclick=function(t){return this.layer.openPopupOnObject(t),!1}.bind(this,t)}}},{key:"updateObject",value:function(t){var e,n=o(t.data[this.options.prefix+"Exclude"])||!(this.options.prefix+"Exclude"in t.data)&&o(t.data.exclude);return t.id in this.items||n?n?this.delObject(t):(n=this.items[t.id],this.selectedId===t.id?n.classList.add("selected"):n.classList.remove("selected"),e=t.layouts[this.options.prefix]||t.layouts.list||"",n.currentHTML!==e&&(n.innerHTML=e,n.currentHTML=e),void t.sublayer.updateAssets(n,t.data)):this.addObject(t)}},{key:"delObject",value:function(t){var e=this.items[t.id];e&&this.dom.removeChild(e),delete this.items[t.id],delete t[this.options.prefix+"Item"]}},{key:"remove",value:function(){for(;this.dom.firstChild;)this.dom.removeChild(this.dom.lastChild);for(var t in this.items)delete this.items[t][this.options.prefix+"Item"];this.items={}}}]),i}();e.exports=t},{"./OverpassLayerList.css":300,"./isTrue":306}],302:[function(t,e,n){var r=t("event-emitter"),l=t("overpass-frontend"),o=t("nearest-point-on-geometry"),s=t("boundingbox"),i=t("./SublayerFeature"),a=[t("./DecoratorPattern")],t=function(){"use strict";function r(t,e){var n=this;_classCallCheck2(this,r),this.master=t,e.sublayer_id=e.sublayer_id||"main",this.options=e,this.featureClass=i,this.visibleFeatures={},this.shownFeatures={},this.shownFeatureOptions={},this.lastZoom=null,this._scheduledReprocesses={},e.feature["style:hover"]||(e.feature["style:hover"]={color:"black",width:3,opacity:1,radius:12,pane:"hover"}),e.styleNoBindPopup?e.styleNoBindPopup.push("hover"):e.styleNoBindPopup=["hover"],e.stylesNoAutoShow?e.stylesNoAutoShow.push("hover"):e.stylesNoAutoShow=["hover"],a.forEach(function(t){return new t(n)})}return _createClass2(r,[{key:"addTo",value:function(t){this.map=t,this.map.on("popupopen",this._popupOpen.bind(this)),this.map.on("popupclose",this._popupClose.bind(this))}},{key:"_popupOpen",value:function(t){var e;t.popup.sublayer===this&&(e=t.popup.object,this.emit("selectObject",e.object,e),this.master.emit("selectObject",e.object,e),this.updateAssets(t.popup._contentNode))}},{key:"_popupClose",value:function(t){var e;t.popup.sublayer===this&&(e=t.popup.object,this.emit("unselectObject",e.object,e),this.master.emit("unselectObject",e.object,e),this.updateAssets(t.popup._contentNode))}},{key:"domUpdateHooks",value:function(t){for(var e,n,r,i=this,o=(t.getAttribute&&(e=t.getAttribute("data-object"))&&(n=t.getAttribute("data-sublayer")||"main",t.classList.add("hoverable"),r={properties:l.ALL},this.master.overpassFrontend.getCached(e,r)||this.master.overpassFrontend.get(e,r,function(){},function(){}),t.onmouseover=function(){if(i.currentHover){if(i.currentHover.id===e)return;i.currentHover.hide()}i.currentHover=i.master.subLayers[n].show(e,{styles:["hover"]},function(){})},t.onmouseout=function(){i.currentHover&&i.currentHover.hide(),i.currentHover=null},t.onclick=function(){i.currentHover&&i.currentHover.hide(),i.master.subLayers[n].openPopupOnObject(e)}),t.firstChild);o;)this.domUpdateHooks(o),o=o.nextSibling}},{key:"remove",value:function(){this.map.off("popupopen",this._popupOpen.bind(this)),this.map=null}},{key:"startAdding",value:function(){this.currentRequestFeatures={}}},{key:"add",value:function(t){var e;this.currentRequestFeatures[t.id]=!0,t.id in this.visibleFeatures||(t.id in this.shownFeatures?e=this.shownFeatures[t.id]:((e=new this.featureClass(t,this)).processObject(),e.show()),this.visibleFeatures[t.id]=e,this.master.onAppear&&this.master.onAppear(e),this.master.emit("add",t,e),this.emit("add",t,e))}},{key:"finishAdding",value:function(){for(var t in this.visibleFeatures)t in this.currentRequestFeatures||(t in this.shownFeatures||this.visibleFeatures[t].hide(),delete this.visibleFeatures[t])}},{key:"hideAll",value:function(t){for(var e in this.visibleFeatures){e=this.visibleFeatures[e];!t&&e.id in this.shownFeatures||e.hide()}this.visibleFeatures={}}},{key:"hideNonVisible",value:function(t){for(var e in this.visibleFeatures){var n=this.visibleFeatures[e];n.object.intersects(t)||(n.id in this.shownFeatures||n.hide(),delete this.visibleFeatures[e])}}},{key:"hideNonVisibleFilter",value:function(t){for(var e in this.visibleFeatures){var n=this.visibleFeatures[e];t.match(n.object)||(n.id in this.shownFeatures||n.hide(),delete this.visibleFeatures[e])}}},{key:"get",value:function(n,t,r){var i=this,o=!1,s=!1,e={id:n,options:t,abort:function(){s?console.log("abort called, although done"):(s=o=!0,e.request&&e.request.abort())}};return n in this.visibleFeatures?window.setTimeout(function(){s=!0,o||r(null,i.visibleFeatures[n])},0):n in this.shownFeatures?window.setTimeout(function(){s=!0,o||r(null,i.shownFeatures[n])},0):e.request=this.master.get(n,function(t,e){if(s=!0,t)return r(t);if(!o){if(null===e)return console.log("object does not exist",n);t=n in i.visibleFeatures?i.visibleFeatures[n]:n in i.shownFeatures?i.shownFeatures[n]:new i.featureClass(e,i);r(null,t)}}),e}},{key:"show",value:function(n,e,r){function i(){s=n.id,u.id=s,o.shownFeatures[s]=n,s in o.shownFeatureOptions||(o.shownFeatureOptions[s]=[]),o.shownFeatureOptions[s].push(e),n.isShown=!0,n.updateFlags(),n.processObject(),n.show(),r(null,n.object,n)}var o=this,s="string"==typeof n?n:n.id,a=!1,u={options:e,hide:function(){var t;a&&console.log("already hidden"),a=!0,u.request?(u.request.abort(),delete u.request):s in o.shownFeatures&&(-1!==(t=o.shownFeatureOptions[s].indexOf(e))&&o.shownFeatureOptions[s].splice(t,1),n.updateFlags(),0===o.shownFeatureOptions[s].length?o.hide(n):o.shownFeatures[s].processObject())}};return e.priority=-1,e.properties=l.ALL,"string"==typeof n?u.request=this.get(n,e,function(t,e){delete u.request,a||(t?r(t):(n=e,i()))}):i(),u}},{key:"hide",value:function(t){var e;(t="object"===_typeof3(t)?t.id:t)in this.shownFeatures&&(e=this.shownFeatures[t],delete this.shownFeatures[t],delete this.shownFeatureOptions[t],t in this.visibleFeatures?e.processObject():e.hide())}},{key:"zoomChange",value:function(){for(var t in this.recalc(),this.visibleFeatures){t=this.visibleFeatures[t];this.master.emit("zoomChange",t.object,t),this.emit("zoomChange",t.object,t),this.master.onZoomChange&&this.master.onZoomChange(t)}this.lastZoom=this.map.getZoom()}},{key:"recalc",value:function(){for(var t in this.visibleFeatures)this.visibleFeatures[t].processObject()}},{key:"_shallBindPopupToStyle",value:function(t){return-1===this.options.styleNoBindPopup.indexOf(t)}},{key:"scheduleReprocess",value:function(t){var e=this;t in this._scheduledReprocesses||(this._scheduledReprocesses[t]=window.setTimeout(function(){delete e._scheduledReprocesses[t],t in e.visibleFeatures&&e.visibleFeatures[t].processObject()},0))}},{key:"updateAssets",value:function(t,e){this.domUpdateHooks(t),this.options.updateAssets&&this.options.updateAssets(t,e,this)}},{key:"openPopupOnObject",value:function(t,n){var e,r,i=this;return"string"==typeof t?this.get(t,n,function(t,e){if(t)return console.log(t);e.processObject(),e.show(),i.openPopupOnObject(e,n)}):(e=new s(this.map.getBounds()),.75*new s(t.object.bounds).diagonalLength()<e.diagonalLength()?t.feature.openPopup():(e=this.map.getCenter(),r=t.object.GeoJSON(),(r=o(r,{type:"Feature",geometry:{type:"Point",coordinates:[e.lng,e.lat]}}))?(r=r.geometry.coordinates,t.feature.openPopup([r[1],r[0]])):void t.feature.openPopup()))}},{key:"evaluate",value:function(t){return new i(t,this).evaluate()}}]),r}();r(t.prototype),e.exports=t},{"./DecoratorPattern":295,"./SublayerFeature":303,boundingbox:54,"event-emitter":76,"nearest-point-on-geometry":208,"overpass-frontend":220}],303:[function(e,n,t){!function(u){!function(){var c=e("./styleToLeaflet"),p=e("./pointOnFeature"),a=e("./strToStyle"),h=e("./isTrue"),t=function(){"use strict";function n(t,e){_classCallCheck2(this,n),this.object=t,this.id=t.id,this.sublayer=e,this.isShown=!1,this.flags={}}return _createClass2(n,[{key:"updateFlags",value:function(){var e=this,t=this.sublayer.shownFeatureOptions[this.id];this.flags={},t.forEach(function(t){t.flags&&t.flags.forEach(function(t){e.flags[t]=!0})})}},{key:"processObject",value:function(){var t,e=this.object,n={styles:[]},r={shiftWorld:this.sublayer.master.getShiftWorld()},i=(e.id in this.sublayer.shownFeatureOptions&&this.sublayer.shownFeatureOptions[e.id].forEach(function(t){"styles"in t&&(n.styles=n.styles.concat(t.styles))}),this.evaluate());for(t in this.feature||(this.feature=e.leafletFeature(Object.assign({weight:0,opacity:0,fillOpacity:0,interactive:!1,radius:0},r))),i){var o,s=t.match(/^style(|:(.*))$/);s&&(s=void 0===s[2]?"default":s[2],o=c(i[t],this.sublayer.master.globalTwigData),this.features[s]?this.features[s].setStyle(o):this.features[s]=e.leafletFeature(Object.assign(o,r)),"text"in o&&"setText"in this.features[s]&&(this.features[s].setText(null),this.features[s].setText(o.text,{repeat:o.textRepeat,offset:o.textOffset,below:o.textBelow,attributes:{fill:o.textFill,"fill-opacity":o.textFillOpacity,"font-weight":o.textFontWeight,"font-size":o.textFontSize,"letter-spacing":o.textLetterSpacing}})),"offset"in o)&&"setOffset"in this.features[s]&&this.features[s].setOffset(o.offset)}"styles"in n&&(i.styles=i.styles.concat(n.styles)),i.marker={html:"",iconAnchor:[0,0],iconSize:[0,0],signAnchor:[0,0],popupAnchor:[0,0]},i.markerSymbol&&(i.marker.html+=i.markerSymbol,(l=document.createElement("div")).innerHTML=i.markerSymbol,l.firstChild&&(u=l.firstChild,i.marker.iconSize=[u.offsetWidth,u.offsetHeight],u.hasAttribute("width")&&(i.marker.iconSize[0]=parseFloat(u.getAttribute("width"))),u.hasAttribute("height")&&(i.marker.iconSize[1]=parseFloat(u.getAttribute("height"))),i.marker.iconAnchor=[i.marker.iconSize[0]/2,i.marker.iconSize[1]/2],u.hasAttribute("anchorx")&&(i.marker.iconAnchor[0]=parseFloat(u.getAttribute("anchorx"))),u.hasAttribute("anchory")&&(i.marker.iconAnchor[1]=parseFloat(u.getAttribute("anchory"))),u.hasAttribute("signanchorx")&&(i.marker.signAnchor[0]=parseFloat(u.getAttribute("signanchorx"))),u.hasAttribute("signanchory")&&(i.marker.signAnchor[1]=parseFloat(u.getAttribute("signanchory"))),u.hasAttribute("popupanchory")&&(i.marker.popupAnchor[0]=parseFloat(u.getAttribute("popupanchorx"))),u.hasAttribute("popupanchory"))&&(i.marker.popupAnchor[1]=parseFloat(u.getAttribute("popupanchory"))),this.sublayer.updateAssets(l,i)),i.markerSign&&(u=i.marker.iconAnchor[0]+i.marker.signAnchor[0],l=-i.marker.iconSize[1]+i.marker.iconAnchor[1]+i.marker.signAnchor[1],i.marker.html+='<div class="sign" style="margin-left: '+u+"px; margin-top: "+l+'px;">'+i.markerSign+"</div>");var a,u=h(i.exclude);if(i.marker.html&&(i.marker.className="overpass-layer-icon",l=L.divIcon(i.marker),this.featureMarker?(u?this.map.removeLayer(this.featureMarker):this.featureMarker.addTo(this.map),this.featureMarker.setIcon(l),this.featureMarker._icon&&this.sublayer.updateAssets(this.featureMarker._icon)):(this.pointOnFeature||(this.pointOnFeature=p(e,r)),this.pointOnFeature&&(this.featureMarker=L.marker(this.pointOnFeature,{icon:l})))),u&&(i.styles=[]),this.isShown)for(t in this.feature.addTo(this.sublayer.map),this.features)i.styles&&-1!==i.styles.indexOf(t)&&this.styles&&-1===this.styles.indexOf(t)&&this.features[t].addTo(this.sublayer.map),i.styles&&-1===i.styles.indexOf(t)&&this.styles&&-1!==this.styles.indexOf(t)&&this.sublayer.map.removeLayer(this.features[t]);for(a in this.styles=i.styles,this.layouts={},this.sublayer.options.layouts)"function"==typeof this.sublayer.options.layouts[a]?this.layouts[a]=this.sublayer.options.layouts[a]({object:i}):this.layouts[a]=this.sublayer.options.layouts[a];var l=this.layouts.popup;if(this.popup)this.popup._contentNode?null!==l&&this.popup.currentHTML!==l&&(this.popup._contentNode.innerHTML=l,this.sublayer.updateAssets(this.popup._contentNode,i)):null!==l&&this.popup.setContent(l),this.popup.currentHTML=l;else{for(t in this.popup=L.popup(),(this.popup.object=this).popup.sublayer=this.sublayer,null!==l&&this.popup.setContent(l),this.feature.bindPopup(this.popup),this.features)this.sublayer._shallBindPopupToStyle(t)&&this.features[t].bindPopup(this.popup);this.featureMarker&&this.featureMarker.bindPopup(this.popup)}this.id=e.id,this.layer_id=this.sublayer.options.id,this.sublayer_id=this.sublayer.options.sublayer_id,this.data=i,this.sublayer.master.onUpdate&&this.sublayer.master.onUpdate(this),this.sublayer.master.emit("update",this.object,this),this.sublayer.emit("update",this.object,this)}},{key:"evaluate",value:function(){this.twigData=this.compileTwigData();var t,e={};for(t in(u.currentMapFeature=this).sublayer.options.feature)"function"==typeof this.sublayer.options.feature[t]?e[t]=this.sublayer.options.feature[t](this.twigData):e[t]=this.sublayer.options.feature[t];delete u.currentMapFeature;var n,r,i=[];for(n in e){var o,s=n.match(/^style(|:(.*))$/);s&&(s=void 0===s[2]?"default":s[2],("string"==typeof(o=e[n])||"twig_markup"in o)&&(e[n]=a(o)),-1===this.sublayer.options.stylesNoAutoShow.indexOf(s))&&i.push(s)}return"features"in this||(this.features={}),e.styles="styles"in e?e.styles:"styles"in this.sublayer.options?this.sublayer.options.styles:i,("string"==typeof e.styles||"twig_markup"in e.styles)&&(r=e.styles.trim(),e.styles=""===r?[]:r.split(/,/).map(function(t){return t.trim()})),e}},{key:"compileTwigData",value:function(){var t,n=this.object,r={id:n.id,sublayer_id:this.sublayer.options.sublayer_id,osm_id:n.osm_id,type:n.type,tags:n.tags,meta:n.meta,flags:this.flags,members:[],const:this.sublayer.options.const};for(t in n.memberFeatures&&n.memberFeatures.forEach(function(t,e){e={id:t.id,sequence:e,type:t.type,osm_id:t.osm_id,role:n.members[e].role,tags:t.tags,meta:t.meta,dir:t.dir,connectedPrev:t.connectedPrev,connectedNext:t.connectedNext};r.members.push(e)}),this.sublayer.master.globalTwigData)r[t]=this.sublayer.master.globalTwigData[t];return this.sublayer.emit("twigData",n,this,r),this.sublayer.master.emit("twigData",n,this,r),r}},{key:"show",value:function(){if(this.sublayer.map){this.map=this.sublayer.map,this.feature.addTo(this.map);for(var t=0;t<this.styles.length;t++){var e=this.styles[t];e in this.features&&this.features[e].addTo(this.map)}this.featureMarker&&!h(this.data.exclude)&&(this.featureMarker.addTo(this.map),this.sublayer.updateAssets(this.featureMarker._icon)),this.object.on("update",this.sublayer.scheduleReprocess.bind(this.sublayer,this.id)),this.isShown=!0}}},{key:"hide",value:function(){for(var t in this.sublayer.master.emit("remove",this.object,this),this.sublayer.emit("remove",this.object,this),this.map.removeLayer(this.feature),this.features)this.map.removeLayer(this.features[t]);this.featureMarker&&this.map.removeLayer(this.featureMarker),this.sublayer.master.onDisappear&&this.sublayer.master.onDisappear(this),this.object.off("update",this.sublayer.scheduleReprocess.bind(this.sublayer,this.id)),this.isShown=!1}},{key:"recalc",value:function(){this.sublayer.scheduleReprocess(this.id)}}]),n}();n.exports=t}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./isTrue":306,"./pointOnFeature":308,"./strToStyle":309,"./styleToLeaflet":310}],304:[function(t,e,n){var s=t("./compileTemplate");e.exports=function(e,t){var n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};for(n in"autoescape"in r||(r.autoescape=!0),e)if("string"==typeof e[n]&&-1!==e[n].search("{"))e[n]=s(e[n],t,r);else if("object"===_typeof3(e[n])&&(-1!==["style"].indexOf(n)||n.match(/^style:/))){var i,o={};for(i in e[n])if("string"==typeof e[n][i]&&-1!==e[n][i].search("{"))try{o[i]=t.twig({data:e[n][i],autoescape:r.autoescape,rethrow:!0})}catch(t){console.error("Can't compile template:\n"+e[n][i]+"\n\n",t.message)}else o[i]=e[n][i];e[n]=function(t,e){var n,r={};for(n in t)"object"===_typeof3(t[n])&&null!==t[n]&&"render"in t[n]?r[n]=t[n].render(e):r[n]=t[n];return r}.bind(this,o)}return e}},{"./compileTemplate":305}],305:[function(t,e,n){e.exports=function(e,t){var n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if("string"!=typeof e||-1===e.search("{"))return e;try{n=t.twig({data:e,autoescape:r.autoescape})}catch(t){return console.log("Error compiling twig template",e,t),e}return function(t){try{return n.render(t)}catch(t){console.log("Error rendering twig template",e,t)}return null}}},{}],306:[function(t,e,n){function r(t){if(null==t)return!1;if("boolean"==typeof t)return t;if("string"==typeof t||"object"===_typeof3(t)&&"twig_markup"in t){if("false"===t.trim())return!1;if("true"===t.trim())return!0}return 0!==t&&"0"!==t.toString()&&""!==t.toString()}window.isTrue=r,e.exports=r},{}],307:[function(t,e,n){e.exports=function(t,e){var n=(""+t).trim().match(/^([+-]?[0-9]+(?:\.[0-9]+)?)\s*(px|m|%)$/);if(n)switch(n[2]){case"%":return t;case"m":return parseFloat(n[1])/e;default:return parseFloat(n[1])}return parseFloat(t)}},{}],308:[function(t,e,n){var r={along:t("@turf/along").default,length:t("@turf/length").default,pointOnFeature:t("@turf/point-on-feature").default};e.exports=function(t,e){var n,t=t.GeoJSON();if("LineString"===t.geometry.type)n=r.along(t,r.length(t)/2);else{if("GeometryCollection"===t.geometry.type&&0===t.geometry.geometries.length)return null;n=r.pointOnFeature(t)}return{lat:n.geometry.coordinates[1],lon:n.geometry.coordinates[0]+e.shiftWorld[n.geometry.coordinates[0]<0?0:1]}}},{"@turf/along":3,"@turf/length":33,"@turf/point-on-feature":43}],309:[function(t,e,n){e.exports=function(t){var e=t.split("\n");t={};for(var n=0;n<e.length;n++){var r,i=e[n].match(/^\s*([a-zA-Z0-9_]+)\s*:\s*(.*)\s*$/);i&&((r=i[2].trim()).match(/^-?[0-9]+(\.[0-9]+)?/)&&(r=parseFloat(r)),t[i[1]]=r)}return t}},{}],310:[function(t,e,n){var s=t("./isTrue"),a=t("./parseLength"),u={stroke:{type:"boolean"},fill:{type:"boolean"},textRepeat:{type:"boolean"},textBelow:{type:"boolean"},noClip:{type:"boolean"},width:{rename:"weight",type:"length"},opacity:{type:"float"},fillOpacity:{type:"float"},offset:{type:"length"},dashArray:{type:"multiple-length"},dashOffset:{type:"length"}};e.exports=function(t,e){var n,r=JSON.parse(JSON.stringify(t));for(n in r){var i=r[n];if(n in u){var o=u[n];switch(o.type){case"boolean":i=s(r[n]);break;case"float":i=parseFloat(r[n]);break;case"length":i=e&&e.map?a(r[n],e.map.metersPerPixel):parseFloat(r[n]);break;case"multiple-length":i=r[n].split(/,/g).map(function(t){return a(t,e.map.metersPerPixel)}).join(",")}o.rename&&(delete r[n],n=o.rename)}r[n]=i}return r}},{"./isTrue":306,"./parseLength":307}]},{},[1]);
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Popper=t()}(this,function(){"use strict";var n="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,S=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(n&&0<=navigator.userAgent.indexOf(e[t]))return 1;return 0}();var W=n&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},S))}};function s(e){return e&&"[object Function]"==={}.toString.call(e)}function d(e,t){return 1!==e.nodeType?[]:(e=e.ownerDocument.defaultView.getComputedStyle(e,null),t?e[t]:e)}function f(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function l(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=d(e),n=t.overflow,o=t.overflowX,t=t.overflowY;return/(auto|scroll|overlay)/.test(n+t+o)?e:l(f(e))}function p(e){return e&&e.referenceNode?e.referenceNode:e}var t=n&&!(!window.MSInputMethodContext||!document.documentMode),j=n&&/MSIE 10/.test(navigator.userAgent);function c(e){return 11===e?t:10!==e&&t||j}function u(e){if(!e)return document.documentElement;for(var t=c(10)?document.body:null,n=e.offsetParent||null;n===t&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var o=n&&n.nodeName;return o&&"BODY"!==o&&"HTML"!==o?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===d(n,"position")?u(n):n:(e?e.ownerDocument:document).documentElement}function i(e){return null!==e.parentNode?i(e.parentNode):e}function h(e,t){var n,o,r;return e&&e.nodeType&&t&&t.nodeType?(o=(r=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING)?e:t,r=r?t:e,(n=document.createRange()).setStart(o,0),n.setEnd(r,0),e!==(n=n.commonAncestorContainer)&&t!==n||o.contains(r)?"BODY"===(r=(o=n).nodeName)||"HTML"!==r&&u(o.firstElementChild)!==o?u(n):n:(r=i(e)).host?h(r.host,t):h(e,i(t).host)):document.documentElement}function m(e,t){var t="top"===(1<arguments.length&&void 0!==t?t:"top")?"scrollTop":"scrollLeft",n=e.nodeName;return("BODY"===n||"HTML"===n?(n=e.ownerDocument.documentElement,e.ownerDocument.scrollingElement||n):e)[t]}function r(e,t){var t="x"===t?"Left":"Top",n="Left"==t?"Right":"Bottom";return parseFloat(e["border"+t+"Width"])+parseFloat(e["border"+n+"Width"])}function o(e,t,n,o){return Math.max(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],c(10)?parseInt(n["offset"+e])+parseInt(o["margin"+("Height"===e?"Top":"Left")])+parseInt(o["margin"+("Height"===e?"Bottom":"Right")]):0)}function g(e){var t=e.body,e=e.documentElement,n=c(10)&&getComputedStyle(e);return{height:o("Height",t,e,n),width:o("Width",t,e,n)}}var e=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e};function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e};function w(e){return b({},e,{right:e.left+e.width,bottom:e.top+e.height})}function y(e){var t={};try{c(10)?(t=e.getBoundingClientRect(),n=m(e,"top"),o=m(e,"left"),t.top+=n,t.left+=o,t.bottom+=n,t.right+=o):t=e.getBoundingClientRect()}catch(e){}var n={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},o="HTML"===e.nodeName?g(e.ownerDocument):{},t=o.width||e.clientWidth||n.width,o=o.height||e.clientHeight||n.height,t=e.offsetWidth-t,o=e.offsetHeight-o;return(t||o)&&(t-=r(e=d(e),"x"),o-=r(e,"y"),n.width-=t,n.height-=o),w(n)}function x(e,t,n){var n=2<arguments.length&&void 0!==n&&n,o=c(10),r="HTML"===t.nodeName,i=y(e),s=y(t),e=l(e),a=d(t),f=parseFloat(a.borderTopWidth),p=parseFloat(a.borderLeftWidth),s=(n&&r&&(s.top=Math.max(s.top,0),s.left=Math.max(s.left,0)),w({top:i.top-s.top-f,left:i.left-s.left-p,width:i.width,height:i.height}));return s.marginTop=0,s.marginLeft=0,!o&&r&&(i=parseFloat(a.marginTop),r=parseFloat(a.marginLeft),s.top-=f-i,s.bottom-=f-i,s.left-=p-r,s.right-=p-r,s.marginTop=i,s.marginLeft=r),s=(o&&!n?t.contains(e):t===e&&"BODY"!==e.nodeName)?function(e,t,n){var n=2<arguments.length&&void 0!==n&&n,o=m(t,"top"),t=m(t,"left"),n=n?-1:1;return e.top+=o*n,e.bottom+=o*n,e.left+=t*n,e.right+=t*n,e}(s,t):s}function E(e){if(!e||!e.parentElement||c())return document.documentElement;for(var t=e.parentElement;t&&"none"===d(t,"transform");)t=t.parentElement;return t||document.documentElement}function O(e,t,n,o,r){var i,r=4<arguments.length&&void 0!==r&&r,s={top:0,left:0},a=r?E(e):h(e,p(t)),a=("viewport"===o?s=function(e,t){var t=1<arguments.length&&void 0!==t&&t,n=e.ownerDocument.documentElement,e=x(e,n),o=Math.max(n.clientWidth,window.innerWidth||0),r=Math.max(n.clientHeight,window.innerHeight||0),i=t?0:m(n),t=t?0:m(n,"left");return w({top:i-e.top+e.marginTop,left:t-e.left+e.marginLeft,width:o,height:r})}(a,r):(i=void 0,"scrollParent"===o?"BODY"===(i=l(f(t))).nodeName&&(i=e.ownerDocument.documentElement):i="window"===o?e.ownerDocument.documentElement:o,t=x(i,a,r),"HTML"!==i.nodeName||function e(t){var n=t.nodeName;return"BODY"!==n&&"HTML"!==n&&("fixed"===d(t,"position")||!!(n=f(t))&&e(n))}(a)?s=t:(r=(o=g(e.ownerDocument)).height,i=o.width,s.top+=t.top-t.marginTop,s.bottom=r+t.top,s.left+=t.left-t.marginLeft,s.right=i+t.left)),"number"==typeof(n=n||0));return s.left+=a?n:n.left||0,s.top+=a?n:n.top||0,s.right-=a?n:n.right||0,s.bottom-=a?n:n.bottom||0,s}function L(e,t,n,o,r,i){var s,i=5<arguments.length&&void 0!==i?i:0;return-1===e.indexOf("auto")?e:(o=O(n,o,i,r),s={top:{width:o.width,height:t.top-o.top},right:{width:o.right-t.right,height:o.height},bottom:{width:o.width,height:o.bottom-t.bottom},left:{width:t.left-o.left,height:o.height}},(0<(r=(i=Object.keys(s).map(function(e){return b({key:e},s[e],{area:(e=s[e]).width*e.height})}).sort(function(e,t){return t.area-e.area})).filter(function(e){var t=e.width,e=e.height;return t>=n.clientWidth&&e>=n.clientHeight})).length?r:i)[0].key+((t=e.split("-")[1])?"-"+t:""))}function T(e,t,n,o){o=3<arguments.length&&void 0!==o?o:null;return x(n,o?E(t):h(t,p(n)),o)}function D(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),n=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),t=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+t,height:e.offsetHeight+n}}function M(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(e){return t[e]})}function N(e,t,n){n=n.split("-")[0];var e=D(e),o={width:e.width,height:e.height},r=-1!==["right","left"].indexOf(n),i=r?"top":"left",s=r?"left":"top",a=r?"height":"width",r=r?"width":"height";return o[i]=t[i]+t[a]/2-e[a]/2,o[s]=n===s?t[s]-e[r]:t[M(s)],o}function F(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function H(e,n,t){var o,r;return(void 0===t?e:e.slice(0,(e=e,o="name",r=t,Array.prototype.findIndex?e.findIndex(function(e){return e[o]===r}):(t=F(e,function(e){return e[o]===r}),e.indexOf(t))))).forEach(function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var t=e.function||e.fn;e.enabled&&s(t)&&(n.offsets.popper=w(n.offsets.popper),n.offsets.reference=w(n.offsets.reference),n=t(n,e))}),n}function I(e,n){return e.some(function(e){var t=e.name;return e.enabled&&t===n})}function C(e){for(var t=[!1,"ms","Webkit","Moz","O"],n=e.charAt(0).toUpperCase()+e.slice(1),o=0;o<t.length;o++){var r=t[o],r=r?""+r+n:e;if(void 0!==document.body.style[r])return r}return null}function R(e){e=e.ownerDocument;return e?e.defaultView:window}function U(e,t,n,o){n.updateBound=o,R(e).addEventListener("resize",n.updateBound,{passive:!0});o=l(e);return function e(t,n,o,r){var i="BODY"===t.nodeName,t=i?t.ownerDocument.defaultView:t;t.addEventListener(n,o,{passive:!0}),i||e(l(t.parentNode),n,o,r),r.push(t)}(o,"scroll",n.updateBound,n.scrollParents),n.scrollElement=o,n.eventsEnabled=!0,n}function Y(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,R(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function k(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function B(n,o){Object.keys(o).forEach(function(e){var t="";-1!==["width","height","top","right","bottom","left"].indexOf(e)&&k(o[e])&&(t="px"),n.style[e]=o[e]+t})}function V(e,t){function n(e){return e}var o=e.offsets,r=o.popper,o=o.reference,i=Math.round,s=Math.floor,o=i(o.width),a=i(r.width),f=-1!==["left","right"].indexOf(e.placement),e=-1!==e.placement.indexOf("-"),f=t?f||e||o%2==a%2?i:s:n,s=t?i:n;return{left:f(o%2==1&&a%2==1&&!e&&t?r.left-1:r.left),top:s(r.top),bottom:s(r.bottom),right:f(r.right)}}var q=n&&/Firefox/i.test(navigator.userAgent);function z(e,t,n){var o,r=F(e,function(e){return e.name===t}),e=!!r&&e.some(function(e){return e.name===n&&e.enabled&&e.order<r.order});return e||(o="`"+t+"`",console.warn("`"+n+"`"+" modifier is required by "+o+" modifier in order to work, be sure to include it before "+o+"!")),e}var G=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],A=G.slice(3);function _(e,t){t=1<arguments.length&&void 0!==t&&t,e=A.indexOf(e),e=A.slice(e+1).concat(A.slice(0,e));return t?e.reverse():e}var X="flip",J="clockwise",K="counterclockwise";function Q(e,a,f,t){var r=[0,0],o=-1!==["right","left"].indexOf(t),t=e.split(/(\+|\-)/).map(function(e){return e.trim()}),e=t.indexOf(F(t,function(e){return-1!==e.search(/,|\s/)})),n=(t[e]&&-1===t[e].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead."),/\s*,\s*|\s+/);return(-1!==e?[t.slice(0,e).concat([t[e].split(n)[0]]),[t[e].split(n)[1]].concat(t.slice(e+1))]:[t]).map(function(e,t){var s=(1===t?!o:o)?"height":"width",n=!1;return e.reduce(function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,n=!0,e):n?(e[e.length-1]+=t,n=!1,e):e.concat(t)},[]).map(function(e){return t=s,n=a,o=f,r=+(i=(e=e).match(/((?:\-|\+)?\d*\.?\d*)(.*)/))[1],i=i[2],r?0===i.indexOf("%")?w("%p"===i?n:o)[t]/100*r:"vh"===i||"vw"===i?("vh"===i?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*r:r:e;var t,n,o,r,i})}).forEach(function(n,o){n.forEach(function(e,t){k(e)&&(r[o]+=e*("-"===n[t-1]?-1:1))})}),r}var Z={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t,n,o,r=e.placement,i=r.split("-")[0];return(r=r.split("-")[1])&&(t=(n=e.offsets).reference,n=n.popper,o=(i=-1!==["bottom","top"].indexOf(i))?"width":"height",i={start:v({},i=i?"left":"top",t[i]),end:v({},i,t[i]+t[o]-n[o])},e.offsets.popper=b({},n,i[r])),e}},offset:{order:200,enabled:!0,fn:function(e,t){var t=t.offset,n=e.placement,o=(r=e.offsets).popper,r=r.reference,n=n.split("-")[0],i=void 0,i=k(+t)?[+t,0]:Q(t,o,r,n);return"left"===n?(o.top+=i[0],o.left-=i[1]):"right"===n?(o.top+=i[0],o.left+=i[1]):"top"===n?(o.left+=i[0],o.top-=i[1]):"bottom"===n&&(o.left+=i[0],o.top+=i[1]),e.popper=o,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,o){var t=o.boundariesElement||u(e.instance.popper),n=(e.instance.reference===t&&(t=u(t)),C("transform")),r=e.instance.popper.style,i=r.top,s=r.left,a=r[n],f=(r.top="",r.left="",r[n]="",O(e.instance.popper,e.instance.reference,o.padding,t,e.positionFixed)),t=(r.top=i,r.left=s,r[n]=a,o.boundaries=f,o.priority),p=e.offsets.popper,l={primary:function(e){var t=p[e];return p[e]<f[e]&&!o.escapeWithReference&&(t=Math.max(p[e],f[e])),v({},e,t)},secondary:function(e){var t="right"===e?"left":"top",n=p[t];return p[e]>f[e]&&!o.escapeWithReference&&(n=Math.min(p[t],f[e]-("right"===e?p.width:p.height))),v({},t,n)}};return t.forEach(function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";p=b({},p,l[t](e))}),e.offsets.popper=p,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=(n=e.offsets).popper,n=n.reference,o=e.placement.split("-")[0],r=Math.floor,i=(o=-1!==["top","bottom"].indexOf(o))?"right":"bottom",s=o?"left":"top",o=o?"width":"height";return t[i]<r(n[s])&&(e.offsets.popper[s]=r(n[s])-t[o]),t[s]>r(n[i])&&(e.offsets.popper[s]=r(n[i])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){if(z(e.instance.modifiers,"arrow","keepTogether")){t=t.element;if("string"==typeof t){if(!(t=e.instance.popper.querySelector(t)))return e}else if(!e.instance.popper.contains(t))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var n=e.placement.split("-")[0],o=e.offsets,r=o.popper,o=o.reference,n=-1!==["left","right"].indexOf(n),i=n?"height":"width",s=n?"Top":"Left",a=s.toLowerCase(),f=n?"left":"top",n=n?"bottom":"right",p=D(t)[i],n=(o[n]-p<r[a]&&(e.offsets.popper[a]-=r[a]-(o[n]-p)),o[a]+p>r[n]&&(e.offsets.popper[a]+=o[a]+p-r[n]),e.offsets.popper=w(e.offsets.popper),o[a]+o[i]/2-p/2),o=d(e.instance.popper),l=parseFloat(o["margin"+s]),o=parseFloat(o["border"+s+"Width"]),s=n-e.offsets.popper[a]-l-o,s=Math.max(Math.min(r[i]-p,s),0);e.arrowElement=t,e.offsets.arrow=(v(n={},a,Math.round(s)),v(n,f,""),n)}return e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(p,l){if(!(I(p.instance.modifiers,"inner")||p.flipped&&p.placement===p.originalPlacement)){var d=O(p.instance.popper,p.instance.reference,l.padding,l.boundariesElement,p.positionFixed),c=p.placement.split("-")[0],u=M(c),h=p.placement.split("-")[1]||"",m=[];switch(l.behavior){case X:m=[c,u];break;case J:m=_(c);break;case K:m=_(c,!0);break;default:m=l.behavior}m.forEach(function(e,t){if(c!==e||m.length===t+1)return p;c=p.placement.split("-")[0],u=M(c);var e=p.offsets.popper,n=p.offsets.reference,o=Math.floor,n="left"===c&&o(e.right)>o(n.left)||"right"===c&&o(e.left)<o(n.right)||"top"===c&&o(e.bottom)>o(n.top)||"bottom"===c&&o(e.top)<o(n.bottom),r=o(e.left)<o(d.left),i=o(e.right)>o(d.right),s=o(e.top)<o(d.top),e=o(e.bottom)>o(d.bottom),o="left"===c&&r||"right"===c&&i||"top"===c&&s||"bottom"===c&&e,a=-1!==["top","bottom"].indexOf(c),f=!!l.flipVariations&&(a&&"start"===h&&r||a&&"end"===h&&i||!a&&"start"===h&&s||!a&&"end"===h&&e),i=!!l.flipVariationsByContent&&(a&&"start"===h&&i||a&&"end"===h&&r||!a&&"start"===h&&e||!a&&"end"===h&&s),r=f||i;(n||o||r)&&(p.flipped=!0,(n||o)&&(c=m[t+1]),r&&(h="end"===(e=h)?"start":"start"===e?"end":e),p.placement=c+(h?"-"+h:""),p.offsets.popper=b({},p.offsets.popper,N(p.instance.popper,p.offsets.reference,p.placement)),p=H(p.instance.modifiers,p,"flip"))})}return p},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,n=t.split("-")[0],o=(r=e.offsets).popper,r=r.reference,i=-1!==["left","right"].indexOf(n),s=-1===["top","left"].indexOf(n);return o[i?"left":"top"]=r[n]-(s?o[i?"width":"height"]:0),e.placement=M(t),e.offsets.popper=w(o),e}},hide:{order:800,enabled:!0,fn:function(e){if(z(e.instance.modifiers,"hide","preventOverflow")){var t=e.offsets.reference,n=F(e.instance.modifiers,function(e){return"preventOverflow"===e.name}).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var n=t.x,o=t.y,r=e.offsets.popper,i=(void 0!==(i=F(e.instance.modifiers,function(e){return"applyStyle"===e.name}).gpuAcceleration)&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!"),void 0!==i?i:t.gpuAcceleration),s=y(t=u(e.instance.popper)),r={position:r.position},a=V(e,window.devicePixelRatio<2||!q),n="bottom"===n?"top":"bottom",o="right"===o?"left":"right",f=C("transform"),p=void 0,l=void 0,l="bottom"==n?"HTML"===t.nodeName?-t.clientHeight+a.bottom:-s.height+a.bottom:a.top,p="right"==o?"HTML"===t.nodeName?-t.clientWidth+a.right:-s.width+a.right:a.left,s=(i&&f?(r[f]="translate3d("+p+"px, "+l+"px, 0)",r[n]=0,r[o]=0,r.willChange="transform"):(t="right"==o?-1:1,r[n]=l*("bottom"==n?-1:1),r[o]=p*t,r.willChange=n+", "+o),{"x-placement":e.placement});return e.attributes=b({},s,e.attributes),e.styles=b({},r,e.styles),e.arrowStyles=b({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){var t,n;return B(e.instance.popper,e.styles),t=e.instance.popper,n=e.attributes,Object.keys(n).forEach(function(e){!1!==n[e]?t.setAttribute(e,n[e]):t.removeAttribute(e)}),e.arrowElement&&Object.keys(e.arrowStyles).length&&B(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,n,o,r){return r=T(r,t,e,n.positionFixed),r=L(n.placement,r,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding),t.setAttribute("x-placement",r),B(t,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}}},e=(e(P,[{key:"update",value:function(){return function(){var e;this.state.isDestroyed||((e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}}).offsets.reference=T(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=L(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=N(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=H(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e)))}.call(this)}},{key:"destroy",value:function(){return function(){return this.state.isDestroyed=!0,I(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[C("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}.call(this)}},{key:"enableEventListeners",value:function(){return function(){this.state.eventsEnabled||(this.state=U(this.reference,this.options,this.state,this.scheduleUpdate))}.call(this)}},{key:"disableEventListeners",value:function(){return Y.call(this)}}]),P);function P(e,t){var n=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=this,i=P;if(!(r instanceof i))throw new TypeError("Cannot call a class as a function");this.scheduleUpdate=function(){return requestAnimationFrame(n.update)},this.update=W(this.update.bind(this)),this.options=b({},P.Defaults,o),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=e&&e.jquery?e[0]:e,this.popper=t&&t.jquery?t[0]:t,this.options.modifiers={},Object.keys(b({},P.Defaults.modifiers,o.modifiers)).forEach(function(e){n.options.modifiers[e]=b({},P.Defaults.modifiers[e]||{},o.modifiers?o.modifiers[e]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(e){return b({name:e},n.options.modifiers[e])}).sort(function(e,t){return e.order-t.order}),this.modifiers.forEach(function(e){e.enabled&&s(e.onLoad)&&e.onLoad(n.reference,n.popper,n.options,e,n.state)}),this.update();r=this.options.eventsEnabled;r&&this.enableEventListeners(),this.state.eventsEnabled=r}return e.Utils=("undefined"!=typeof window?window:global).PopperUtils,e.placements=G,e.Defaults=Z,e});
var QRCode;!function(){function e(t){this.mode=n.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,r=this.data.length;e<r;e++){var o=[],i=this.data.charCodeAt(e);65536<i?(o[0]=240|(1835008&i)>>>18,o[1]=128|(258048&i)>>>12,o[2]=128|(4032&i)>>>6,o[3]=128|63&i):2048<i?(o[0]=224|(61440&i)>>>12,o[1]=128|(4032&i)>>>6,o[2]=128|63&i):128<i?(o[0]=192|(1984&i)>>>6,o[1]=128|63&i):o[0]=i,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function h(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,r=this.parsedData.length;e<r;e++)t.put(this.parsedData[e],8)}},h.prototype={addData:function(t){t=new e(t);this.dataList.push(t),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[r][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),7<=this.typeNumber&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=h.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(var o=-1;o<=7;o++)e+o<=-1||this.moduleCount<=e+o||(this.modules[t+r][e+o]=0<=r&&r<=6&&(0==o||6==o)||0<=o&&o<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=o&&o<=4)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;r<8;r++){this.makeImpl(!0,r);var o=m.getLostPoint(this);(0==r||o<t)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){var o=t.createEmptyMovieClip(e,r);this.make();for(var i=0;i<this.modules.length;i++)for(var n=+i,a=0;a<this.modules[i].length;a++){var s=+a;this.modules[i][a]&&(o.beginFill(0,100),o.moveTo(s,n),o.lineTo(1+s,n),o.lineTo(1+s,1+n),o.lineTo(s,1+n),o.endFill())}return o},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=m.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],i=t[r];if(null==this.modules[o][i])for(var n=-2;n<=2;n++)for(var a=-2;a<=2;a++)this.modules[o+n][i+a]=-2==n||2==n||-2==a||2==a||0==n&&0==a}},setupTypeNumber:function(t){for(var e=m.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(r=0;r<18;r++){o=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}},setupTypeInfo:function(t,e){for(var e=this.errorCorrectLevel<<3|e,r=m.getBCHTypeInfo(e),o=0;o<15;o++){var i=!t&&1==(r>>o&1);o<6?this.modules[o][8]=i:o<8?this.modules[o+1][8]=i:this.modules[this.moduleCount-15+o][8]=i}for(o=0;o<15;o++){i=!t&&1==(r>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=i:o<9?this.modules[8][15-o-1+1]=i:this.modules[8][15-o-1]=i}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,i=7,n=0,a=this.moduleCount-1;0<a;a-=2)for(6==a&&a--;;){for(var s,h,l=0;l<2;l++)null==this.modules[o][a-l]&&(s=!1,n<t.length&&(s=1==(t[n]>>>i&1)),h=m.getMask(e,o,a-l),this.modules[o][a-l]=s=h?!s:s,-1==--i)&&(n++,i=7);if((o+=r)<0||this.moduleCount<=o){o-=r,r=-r;break}}}},h.PAD0=236,h.PAD1=17,h.createData=function(t,e,r){for(var o=p.getRSBlocks(t,e),i=new v,n=0;n<r.length;n++){var a=r[n];i.put(a.mode,4),i.put(a.getLength(),m.getLengthInBits(a.mode,t)),a.write(i)}for(var s=0,n=0;n<o.length;n++)s+=o[n].dataCount;if(i.getLengthInBits()>8*s)throw new Error("code length overflow. ("+i.getLengthInBits()+">"+8*s+")");for(i.getLengthInBits()+4<=8*s&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;;){if(i.getLengthInBits()>=8*s)break;if(i.put(h.PAD0,8),i.getLengthInBits()>=8*s)break;i.put(h.PAD1,8)}return h.createBytes(i,o)},h.createBytes=function(t,e){for(var r=0,o=0,i=0,n=new Array(e.length),a=new Array(e.length),s=0;s<e.length;s++){var h=e[s].dataCount,l=e[s].totalCount-h,o=Math.max(o,h),i=Math.max(i,l);n[s]=new Array(h);for(var u=0;u<n[s].length;u++)n[s][u]=255&t.buffer[u+r];r+=h;var h=m.getErrorCorrectPolynomial(l),g=new _(n[s],h.getLength()-1).mod(h);a[s]=new Array(h.getLength()-1);for(u=0;u<a[s].length;u++){var f=u+g.getLength()-a[s].length;a[s][u]=0<=f?g.get(f):0}}for(var d=0,u=0;u<e.length;u++)d+=e[u].totalCount;for(var c=new Array(d),p=0,u=0;u<o;u++)for(s=0;s<e.length;s++)u<n[s].length&&(c[p++]=n[s][u]);for(u=0;u<i;u++)for(s=0;s<e.length;s++)u<a[s].length&&(c[p++]=a[s][u]);return c};for(var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},l={L:1,M:0,Q:3,H:2},o=0,i=1,a=2,s=3,u=4,g=5,f=6,d=7,m={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=m.getBCHDigit(e)-m.getBCHDigit(m.G15);)e^=m.G15<<m.getBCHDigit(e)-m.getBCHDigit(m.G15);return(t<<10|e)^m.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=m.getBCHDigit(e)-m.getBCHDigit(m.G18);)e^=m.G18<<m.getBCHDigit(e)-m.getBCHDigit(m.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return m.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case o:return(e+r)%2==0;case i:return e%2==0;case a:return r%3==0;case s:return(e+r)%3==0;case u:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case g:return e*r%2+e*r%3==0;case f:return(e*r%2+e*r%3)%2==0;case d:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new _([1],0),r=0;r<t;r++)e=e.multiply(new _([1,c.gexp(r)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:case n.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;o<e;o++)for(var i=0;i<e;i++){for(var n=0,a=t.isDark(o,i),s=-1;s<=1;s++)if(!(o+s<0||e<=o+s))for(var h=-1;h<=1;h++)i+h<0||e<=i+h||0==s&&0==h||a==t.isDark(o+s,i+h)&&n++;5<n&&(r+=3+n-5)}for(o=0;o<e-1;o++)for(i=0;i<e-1;i++){var l=0;t.isDark(o,i)&&l++,t.isDark(o+1,i)&&l++,t.isDark(o,i+1)&&l++,t.isDark(o+1,i+1)&&l++,0!=l&&4!=l||(r+=3)}for(o=0;o<e;o++)for(i=0;i<e-6;i++)t.isDark(o,i)&&!t.isDark(o,i+1)&&t.isDark(o,i+2)&&t.isDark(o,i+3)&&t.isDark(o,i+4)&&!t.isDark(o,i+5)&&t.isDark(o,i+6)&&(r+=40);for(i=0;i<e;i++)for(o=0;o<e-6;o++)t.isDark(o,i)&&!t.isDark(o+1,i)&&t.isDark(o+2,i)&&t.isDark(o+3,i)&&t.isDark(o+4,i)&&!t.isDark(o+5,i)&&t.isDark(o+6,i)&&(r+=40);for(var u=0,i=0;i<e;i++)for(o=0;o<e;o++)t.isDark(o,i)&&u++;return r+=10*(Math.abs(100*u/e/e-50)/5)}},c={glog:function(t){if(t<1)throw new Error("glog("+t+")");return c.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return c.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},t=0;t<8;t++)c.EXP_TABLE[t]=1<<t;for(t=8;t<256;t++)c.EXP_TABLE[t]=c.EXP_TABLE[t-4]^c.EXP_TABLE[t-5]^c.EXP_TABLE[t-6]^c.EXP_TABLE[t-8];for(t=0;t<255;t++)c.LOG_TABLE[c.EXP_TABLE[t]]=t;function _(t,e){if(null==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function p(t,e){this.totalCount=t,this.dataCount=e}function v(){this.buffer=[],this.length=0}_.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),r=0;r<this.getLength();r++)for(var o=0;o<t.getLength();o++)e[r+o]^=c.gexp(c.glog(this.get(r))+c.glog(t.get(o)));return new _(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=c.glog(this.get(0))-c.glog(t.get(0)),r=new Array(this.getLength()),o=0;o<this.getLength();o++)r[o]=this.get(o);for(o=0;o<t.getLength();o++)r[o]^=c.gexp(c.glog(t.get(o))+e);return new _(r,0).mod(t)}},p.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],p.getRSBlocks=function(t,e){var r=p.getRsBlockTable(t,e);if(null==r)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var o=r.length/3,i=[],n=0;n<o;n++)for(var a=r[3*n+0],s=r[3*n+1],h=r[3*n+2],l=0;l<a;l++)i.push(new p(s,h));return i},p.getRsBlockTable=function(t,e){switch(e){case l.L:return p.RS_BLOCK_TABLE[4*(t-1)+0];case l.M:return p.RS_BLOCK_TABLE[4*(t-1)+1];case l.Q:return p.RS_BLOCK_TABLE[4*(t-1)+2];case l.H:return p.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},v.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var C=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function w(){var t=!1,e=navigator.userAgent;return t=/android/i.test(e)&&(t=!0,e=e.toString().match(/android ([0-9]\.[0-9])/i))&&e[1]?parseFloat(e[1]):t}r.prototype.draw=function(t){var e=this._htOption,r=this._el,o=t.getModuleCount();Math.floor(e.width/o),Math.floor(e.height/o);function i(t,e){var r,o=document.createElementNS("http://www.w3.org/2000/svg",t);for(r in e)e.hasOwnProperty(r)&&o.setAttribute(r,e[r]);return o}this.clear();var n=i("svg",{viewBox:"0 0 "+String(o)+" "+String(o),width:"100%",height:"100%",fill:e.colorLight});n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),r.appendChild(n),n.appendChild(i("rect",{fill:e.colorLight,width:"100%",height:"100%"})),n.appendChild(i("rect",{fill:e.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;a<o;a++)for(var s,h=0;h<o;h++)t.isDark(a,h)&&((s=i("use",{x:String(a),y:String(h)})).setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),n.appendChild(s))},r.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};var D=r;function r(t,e){this._el=t,this._htOption=e}var A="svg"===document.documentElement.tagName.toLowerCase()?D:"undefined"==typeof CanvasRenderingContext2D?(L.prototype.draw=function(t){for(var e=this._htOption,r=this._el,o=t.getModuleCount(),i=Math.floor(e.width/o),n=Math.floor(e.height/o),a=['<table style="border:0;border-collapse:collapse;">'],s=0;s<o;s++){a.push("<tr>");for(var h=0;h<o;h++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+n+"px;background-color:"+(t.isDark(s,h)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),r.innerHTML=a.join("");var r=r.childNodes[0],l=(e.width-r.offsetWidth)/2,u=(e.height-r.offsetHeight)/2;0<l&&0<u&&(r.style.margin=u+"px "+l+"px")},L.prototype.clear=function(){this._el.innerHTML=""},L):function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}var u,g;this._android&&this._android<=2.1&&(u=1/window.devicePixelRatio,g=CanvasRenderingContext2D.prototype.drawImage,CanvasRenderingContext2D.prototype.drawImage=function(t,e,r,o,i,n,a,s,h){if("nodeName"in t&&/img/i.test(t.nodeName))for(var l=arguments.length-1;1<=l;l--)arguments[l]=arguments[l]*u;else void 0===s&&(arguments[1]*=u,arguments[2]*=u,arguments[3]*=u,arguments[4]*=u);g.apply(this,arguments)});function e(t,e){this._bIsPainted=!1,this._android=w(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null}return e.prototype.draw=function(t){var e=this._elImage,r=this._oContext,o=this._htOption,i=t.getModuleCount(),n=o.width/i,a=o.height/i,s=Math.round(n),h=Math.round(a);e.style.display="none",this.clear();for(var l=0;l<i;l++)for(var u=0;u<i;u++){var g=t.isDark(l,u),f=u*n,d=l*a;r.strokeStyle=g?o.colorDark:o.colorLight,r.lineWidth=1,r.fillStyle=g?o.colorDark:o.colorLight,r.fillRect(f,d,n,a),r.strokeRect(Math.floor(f)+.5,Math.floor(d)+.5,s,h),r.strokeRect(Math.ceil(f)-.5,Math.ceil(d)-.5,s,h)}this._bIsPainted=!0},e.prototype.makeImage=function(){this._bIsPainted&&!function(t,e){var r=this;r._fFail=e,r._fSuccess=t,null===r._bSupportDataURI?((e=document.createElement("img")).onabort=t=function(){r._bSupportDataURI=!1,r._fFail&&r._fFail.call(r)},e.onerror=t,e.onload=function(){r._bSupportDataURI=!0,r._fSuccess&&r._fSuccess.call(r)},e.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="):!0===r._bSupportDataURI&&r._fSuccess?r._fSuccess.call(r):!1===r._bSupportDataURI&&r._fFail&&r._fFail.call(r)}.call(this,t)},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(t){return t&&Math.floor(1e3*t)/1e3},e}();function L(t,e){this._el=t,this._htOption=e}function E(t,e){for(var r,o=1,i=(t=t,(r=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a")).length+(r.length!=t?3:0)),n=0,a=C.length;n<=a;n++){var s=0;switch(e){case l.L:s=C[n][0];break;case l.M:s=C[n][1];break;case l.Q:s=C[n][2];break;case l.H:s=C[n][3]}if(i<=s)break;o++}if(C.length<o)throw new Error("Too long data");return o}(QRCode=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:l.H},e="string"==typeof e?{text:e}:e)for(var r in e)this._htOption[r]=e[r];"string"==typeof t&&(t=document.getElementById(t)),this._htOption.useSVG&&(A=D),this._android=w(),this._el=t,this._oQRCode=null,this._oDrawing=new A(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(t){this._oQRCode=new h(E(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=l}();
!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).togpx=e()}(function(){return function n(o,i,a){function s(t,e){if(!i[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=i[t]={exports:{}},o[t][0].call(r.exports,function(e){return s(o[t][1][e]||e)},r,r.exports,n,o,i,a)}return i[t].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){var n=e("jxon");function p(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}n.config({attrPrefix:"@"}),t.exports=function(e,i){var t,r;function a(e,t,r){var n={},t=(n["@lat"]=t[1],n["@lon"]=t[0],void 0!==t[2]&&(n.ele=t[2]),i.featureCoordTimes(e));return t&&void 0!==t[r]&&(n.time=t[r]),n}function s(e,t,r){var n,o=p((o=e,(n={}).name=i.featureTitle(o.properties),n.desc=i.featureDescription(o.properties),i.featureLink&&(n.link={"@href":i.featureLink(o.properties)}),n),a(e,t,r));return i.transform.wpt&&i.transform.wpt(o,e,t,r)||o}function u(o,e){var t={rtept:e.map(function(e,t){return n=a(r=o,e=e,t=t),i.transform.rtept&&i.transform.rtept(n,r,e,t)||n;var r,n})};return i.transform.rte&&i.transform.rte(t,o,e)||t}function f(o,e){var t={trkseg:e.map(function(e){return{trkpt:e.map(function(e,t){return n=a(r=o,e=e,t=t),i.transform.trkpt&&i.transform.trkpt(n,r,e,t)||n;var r,n})}})};return i.transform.trk&&i.transform.trk(t,o,e)||t}return"string"==typeof(i=p({creator:"togpx",metadata:void 0,featureTitle:function e(t){if(!t)return"";if("object"==typeof t.tags){var r=e(t.tags);if(""!==r)return r}if(t.name)return t.name;if(t.ref)return t.ref;if(t.id)return t.id;return""},featureDescription:function e(t){if(!t)return"";if("object"==typeof t.tags)return e(t.tags);var r="";for(var n in t)"object"!=typeof t[n]&&(r+=n+"="+t[n]+"\n");return r.substr(0,r.length-1)},featureLink:void 0,featureCoordTimes:function(e){return e.properties&&(e.properties.times||e.properties.coordTimes)||null},transform:{},"gpx.wpt":!0,"gpx.trk":!0,"gpx.rte":!1},i||{})).featureCoordTimes&&(t=i.featureCoordTimes,i.featureCoordTimes=function(e){return e.properties[t]}),e="FeatureCollection"===e.type?e.features:"Feature"===e.type?[e]:[{type:"Feature",properties:{},geometry:e}],n.stringify({gpx:(e=e,r={"@xmlns":"http://www.topografix.com/GPX/1/1","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xsi:schemaLocation":"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd","@version":"1.1",metadata:null,wpt:[],rte:[],trk:[]},i.creator&&(r["@creator"]=i.creator),i.metadata?r.metadata=i.metadata:delete i.metadata,e.forEach(function(e){!function r(n,o,i){n.hasOwnProperty("properties")||(n.properties={});switch(n.geometry.type){case"Point":case"MultiPoint":o["gpx.wpt"]&&(t=n.geometry.coordinates,(t="Point"==n.geometry.type?[t]:t).forEach(function(e,t){e=s(n,e,t);i.wpt.push(e)}));break;case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":var e,t;switch(n.geometry.type){case"LineString":e=[n.geometry.coordinates];break;case"MultiPolygon":e=[].concat.apply([],n.geometry.coordinates);break;default:e=n.geometry.coordinates}o["gpx.rte"]&&(1===e.length?(t=u(n,e[0]),i.rte.push(t)):e.forEach(function(e){var e={properties:n.properties,geometry:{type:"LineString",coordinates:e}},t=p({},o);t=p(t,{"gpx.trk":!1}),r(e,t,i)})),o["gpx.trk"]&&(t=f(n,e),i.trk.push(t));break;case"GeometryCollection":n.geometry.geometries.forEach(function(e){e={properties:n.properties,geometry:e};r(e,o,i)});break;default:console.log("warning: unsupported geometry type: "+n.geometry.type)}}(e,i,r)}),i.transform.gpx&&i.transform.gpx(r,e)||r)})}},{jxon:2}],2:[function(e,t,r){var n,o;n=this,o=function(o,e){var r,C={valueKey:"_",attrKey:"$",attrPrefix:"$",lowerCaseTags:!1,trueIsEmpty:!1,autoDate:!1,ignorePrefixedNodes:!1,parseValues:!1},N=[],t=/^\s*$/,n=/^(?:true|false)$/i;return new function(){function P(e){return C.parseValues?t.test(e)?null:n.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):C.autoDate&&isFinite(Date.parse(e))?new Date(e):e:e}function S(){}function k(e,t,r,n){var o,i,a=N.length,s=e.hasChildNodes(),u=e.nodeType===e.ELEMENT_NODE&&e.hasAttributes(),f=Boolean(2&t),p=0,c="",l=f?{}:!!C.trueIsEmpty||"";if(s)for(var m,d=0;d<e.childNodes.length;d++)4===(m=e.childNodes.item(d)).nodeType?c+=m.nodeValue:3===m.nodeType?c+=m.nodeValue.trim():1!==m.nodeType||C.ignorePrefixedNodes&&m.prefix||N.push(m);var g=N.length,y=P(c);if(f||!s&&!u||(l=0===t?null===(s=y)?new S:s instanceof Object?s:new s.constructor(s):{}),u){for(var h,w,x=e.attributes.length,v=n?"":C.attrPrefix,T=n?{}:l,b=0;b<x;p++,b++)w=(h=e.attributes.item(b)).name,T[v+(w=C.lowerCaseTags?w.toLowerCase():w)]=P(h.value.trim());n&&(r&&Object.freeze(T),l[C.attrKey]=T,p-=x-1)}for(var O=a;O<g;O++)o=N[O].nodeName,C.lowerCaseTags&&(o=o.toLowerCase()),i=k(N[O],t,r,n),l.hasOwnProperty(o)?(l[o].constructor!==Array&&(l[o]=[l[o]]),l[o].push(i)):(l[o]=i,p++);return 3===t||(2===t||1===t&&0<p)&&c?l[C.valueKey]=y:!f&&0===p&&c&&(l=y),r&&(f||0<p)&&Object.freeze(l),N.length=a,l}function f(e,t,r,n){t=function(e,t,r){var n,o=C.attrPrefix+"xmlns",i=t&&t instanceof Object;if(-1!==e.indexOf(":")){if(e=e.split(":")[0],i&&(n=t[o+":"+e]))return n;if(n=r.lookupNamespaceURI(e))return n}return(n=i?t[o]:n)||r.lookupNamespaceURI(null)}(e,t,r),r=t?n.createElementNS(t,e):n.createElement(e);return r}this.config=function(e){for(var t in e)C[t]=e[t];C.parserErrorHandler&&(r=new o.DOMParser({errorHandler:C.parserErrorHandler,locator:{}}))},S.prototype.toString=function(){return"null"},S.prototype.valueOf=function(){return null},this.xmlToJs=this.build=function(e,t,r,n){var o=1<arguments.length&&"number"==typeof t?3&t:1;return k(e,o,r||!1,3<arguments.length?n:3==o)},this.jsToXml=this.unbuild=function(e,t,r,n){t=(o.document&&o.document.implementation||new o.DOMImplementation).createDocument(t||null,r||"",n||null);return function e(t,r,n){var o,i,a;if(n.constructor===String||n.constructor===Number||n.constructor===Boolean){if(r.appendChild(t.createTextNode(n.toString())),n===n.valueOf())return}else n.constructor===Date&&r.appendChild(t.createTextNode(n.toISOString()));for(a in n)if(void 0!==(o=n[a])&&(null===o&&(o={}),!(isFinite(a)||o instanceof Function)))if(a===C.valueKey)null!==o&&!0!==o&&r.appendChild(t.createTextNode(o.constructor===Date?o.toISOString():String(o)));else if(a===C.attrKey)for(var s in o)r.setAttribute(s,o[s]);else if(0===a.indexOf(C.attrPrefix+"xmlns"))r.setAttributeNS("http://www.w3.org/2000/xmlns/",a.slice(1),o);else if(a.charAt(0)===C.attrPrefix)r.setAttribute(a.slice(1),o);else if(o.constructor===Array)for(var u in o)o.hasOwnProperty(u)&&(i=f(a,o[u],r,t),r.appendChild(i),e(t,i,o[u]||{}));else i=f(a,o,r,t),r.appendChild(i),o instanceof Object?e(t,i,o):null===o||!0===o&&C.trueIsEmpty||i.appendChild(t.createTextNode(o.toString()))}(t,t.documentElement||t,e),t},this.stringToXml=function(e){return(r=r||new o.DOMParser).parseFromString(e,"application/xml")},this.xmlToString=function(e){return void 0!==e.xml?e.xml:(new o.XMLSerializer).serializeToString(e)},this.stringToJs=function(e){e=this.stringToXml(e);return this.xmlToJs(e)},this.jsToString=this.stringify=function(e,t,r,n){return this.xmlToString(this.jsToXml(e,t,r,n))},this.each=function(e,t,r){(e instanceof Array?e:[e]).forEach(t,r)}}},"object"==typeof r?"object"==typeof window&&window.DOMImplementation&&window.XMLSerializer&&window.DOMParser?t.exports=o(window):t.exports=o(e("xmldom")):n.JXON=o(window)},{xmldom:3}],3:[function(e,t,r){},{}]},{},[1])(1)});
!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).tokml=e()}(function(){return function n(o,i,u){function a(r,e){if(!i[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(c)return c(r,!0);e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}t=i[r]={exports:{}};o[r][0].call(t.exports,function(e){var t=o[r][1][e];return a(t||e)},t,t.exports,n,o,i,u)}return i[r].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,t,r){var e=e("strxml"),s=e.tag,l=e.encode;function n(a,c){return function(e){var t,r,n,o,i,u;return e.properties&&p.valid(e.geometry)&&(t=p.any(e.geometry))?(r=o="",a.simplestyle&&(n=function(e){var t="";e["marker-symbol"]&&(t=t+"ms"+e["marker-symbol"]);e["marker-color"]&&(t=t+"mc"+e["marker-color"].replace("#",""));e["marker-size"]&&(t=t+"ms"+e["marker-size"]);e.stroke&&(t=t+"s"+e.stroke.replace("#",""));e["stroke-width"]&&(t=t+"sw"+e["stroke-width"].toString().replace(".",""));e["stroke-opacity"]&&(t=t+"mo"+e["stroke-opacity"].toString().replace(".",""));e.fill&&(t=t+"f"+e.fill.replace("#",""));e["fill-opacity"]&&(t=t+"fo"+e["fill-opacity"].toString().replace(".",""));return t}(e.properties))&&(p.isPoint(e.geometry)&&((i=e.properties)["marker-size"]||i["marker-symbol"]||i["marker-color"])?(-1===c.indexOf(n)&&(i=e.properties,u=n,o=s("Style",s("IconStyle",s("Icon",s("href",function(e){var t=e["marker-size"]||"medium",r=e["marker-symbol"]?"-"+e["marker-symbol"]:"",e=(e["marker-color"]||"7e7e7e").replace("#","");return"https://api.tiles.mapbox.com/v3/marker/pin-"+t.charAt(0)+r+"+"+e+".png"}(i))))+s("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]]),[["id",u]]),c.push(n)),r=s("styleUrl","#"+n)):(p.isPolygon(e.geometry)||p.isLine(e.geometry))&&function(e){for(var t in e)if({stroke:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,"fill-opacity":!0}[t])return 1}(e.properties)&&(-1===c.indexOf(n)&&(o=function(e,t){var r=s("LineStyle",[s("color",m(e.stroke,e["stroke-opacity"])||"ff555555")+s("width",void 0===e["stroke-width"]?2:e["stroke-width"])]),n="";(e.fill||e["fill-opacity"])&&(n=s("PolyStyle",[s("color",m(e.fill,e["fill-opacity"])||"88555555")]));return s("Style",r+n,[["id",t]])}(e.properties,n),c.push(n)),r=s("styleUrl","#"+n))),o+s("Placemark",((i=e.properties)[(u=a).name]?s("name",l(i[u.name])):"")+((n=e.properties)[(o=a).description]?s("description",l(n[o.description])):"")+(o=e.properties,s("ExtendedData",function(e){var t,r=[];for(t in e)r.push([t,e[t]]);return r}(o).map(f).join("")))+((o=e.properties)[(e=a).timestamp]?s("TimeStamp",s("when",l(o[e.timestamp]))):"")+t+r)):""}}t.exports=function(e,t){return'<?xml version="1.0" encoding="UTF-8"?>'+s("kml",s("Document",(void 0!==(r=t=t||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"}).documentName?s("name",r.documentName):"")+(void 0!==(r=t).documentDescription?s("description",r.documentDescription):"")+function(e,t){if(!e.type)return"";var r=[];switch(e.type){case"FeatureCollection":return e.features?e.features.map(n(t,r)).join(""):"";case"Feature":return n(t,r)(e);default:return n(t,r)({type:"Feature",geometry:e,properties:{}})}}(e,t)),[["xmlns","http://www.opengis.net/kml/2.2"]]);var r};var p={Point:function(e){return s("Point",s("coordinates",e.coordinates.join(",")))},LineString:function(e){return s("LineString",s("coordinates",o(e.coordinates)))},Polygon:function(e){var t;return e.coordinates.length?(t=e.coordinates[0],e=e.coordinates.slice(1),t=s("outerBoundaryIs",s("LinearRing",s("coordinates",o(t)))),e=e.map(function(e){return s("innerBoundaryIs",s("LinearRing",s("coordinates",o(e))))}).join(""),s("Polygon",t+e)):""},MultiPoint:function(e){return e.coordinates.length?s("MultiGeometry",e.coordinates.map(function(e){return p.Point({coordinates:e})}).join("")):""},MultiPolygon:function(e){return e.coordinates.length?s("MultiGeometry",e.coordinates.map(function(e){return p.Polygon({coordinates:e})}).join("")):""},MultiLineString:function(e){return e.coordinates.length?s("MultiGeometry",e.coordinates.map(function(e){return p.LineString({coordinates:e})}).join("")):""},GeometryCollection:function(e){return s("MultiGeometry",e.geometries.map(p.any).join(""))},valid:function(e){return e&&e.type&&(e.coordinates||"GeometryCollection"===e.type&&e.geometries&&e.geometries.every(p.valid))},any:function(e){return p[e.type]?p[e.type](e):""},isPoint:function(e){return"Point"===e.type||"MultiPoint"===e.type},isPolygon:function(e){return"Polygon"===e.type||"MultiPolygon"===e.type},isLine:function(e){return"LineString"===e.type||"MultiLineString"===e.type}};function o(e){return e.map(function(e){return e.join(",")}).join(" ")}function f(e){return s("Data",s("value",l(e[1])),[["name",l(e[0])]])}function m(e,t){if("string"!=typeof e)return"";if(3===(e=e.replace("#","").toLowerCase()).length)e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2];else if(6!==e.length)return"";var r=e[0]+e[1],n=e[2]+e[3],e=e[4]+e[5],o="ff";return(o="number"==typeof t&&0<=t&&t<=1&&(o=-1<(o=(255*t).toString(16)).indexOf(".")?o.substr(0,o.indexOf(".")):o).length<2?"0"+o:o)+e+n+r}},{strxml:2}],2:[function(e,t,r){function n(e){return e&&e.length?" "+e.map(function(e){return e[0]+'="'+e[1]+'"'}).join(" "):""}t.exports.attr=n,t.exports.tagClose=function(e,t){return"<"+e+n(t)+"/>"},t.exports.tag=function(e,t,r){return"<"+e+n(r)+">"+t+"</"+e+">"},t.exports.encode=function(e){return(null===e?"":e.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}},{}]},{},[1])(1)});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.WHATWGFetch={})}(this,function(a){"use strict";var e,r,h="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==h&&h,o="URLSearchParams"in h,n="Symbol"in h&&"iterator"in Symbol,u="FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in h,f="ArrayBuffer"in h;function s(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function c(t){return t="string"!=typeof t?String(t):t}function t(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function y(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(r){return new Promise(function(t,e){r.onload=function(){t(r.result)},r.onerror=function(){e(r.error)}})}function l(t){var e=new FileReader,r=p(e);return e.readAsArrayBuffer(t),r}function b(t){var e;return t.slice?t.slice(0):((e=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),e.buffer)}function m(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,(this._bodyInit=t)?"string"==typeof t?this._bodyText=t:u&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:o&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():f&&u&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=b(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f&&(ArrayBuffer.prototype.isPrototypeOf(t)||r(t))?this._bodyArrayBuffer=b(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u&&(this.blob=function(){var t=y(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer)):this.blob().then(l)}),this.text=function(){var t,e,r=y(this);if(r)return r;if(this._bodyBlob)return r=this._bodyBlob,t=new FileReader,e=p(t),t.readAsText(r),e;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),o=0;o<e.length;o++)r[o]=String.fromCharCode(e[o]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(T)}),this.json=function(){return this.text().then(JSON.parse)},this}f&&(e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(t){return t&&-1<e.indexOf(Object.prototype.toString.call(t))}),d.prototype.append=function(t,e){t=s(t),e=c(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},d.prototype.delete=function(t){delete this.map[s(t)]},d.prototype.get=function(t){return t=s(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},d.prototype.set=function(t,e){this.map[s(t)]=c(e)},d.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},d.prototype.keys=function(){var r=[];return this.forEach(function(t,e){r.push(e)}),t(r)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),t(e)},d.prototype.entries=function(){var r=[];return this.forEach(function(t,e){r.push([e,t])}),t(r)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function E(t,e){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,o=(e=e||{}).body;if(t instanceof E){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=(t=e.method||this.method||"GET",r=t.toUpperCase(),-1<w.indexOf(r)?r:t),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o),"GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache||((r=/([?&])_=[^&]*/).test(this.url)?this.url=this.url.replace(r,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime())}function T(t){var r=new FormData;return t.trim().split("&").forEach(function(t){var e;t&&(e=(t=t.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),r.append(decodeURIComponent(e),decodeURIComponent(t)))}),r}function A(t,e){if(!(this instanceof A))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{},this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},m.call(E.prototype),m.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},A.error=function(){var t=new A(null,{status:0,statusText:""});return t.type="error",t};var _=[301,302,303,307,308];A.redirect=function(t,e){if(-1===_.indexOf(e))throw new RangeError("Invalid status code");return new A(null,{status:e,headers:{location:t}})},a.DOMException=h.DOMException;try{new a.DOMException}catch(t){a.DOMException=function(t,e){this.message=t,this.name=e;e=Error(t);this.stack=e.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function g(o,s){return new Promise(function(n,t){var e=new E(o,s);if(e.signal&&e.signal.aborted)return t(new a.DOMException("Aborted","AbortError"));var i=new XMLHttpRequest;function r(){i.abort()}i.onload=function(){var t,r,e={status:i.status,statusText:i.statusText,headers:(t=i.getAllResponseHeaders()||"",r=new d,t.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t}).forEach(function(t){var t=t.split(":"),e=t.shift().trim();e&&(t=t.join(":").trim(),r.append(e,t))}),r)},o=(e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL"),"response"in i?i.response:i.responseText);setTimeout(function(){n(new A(o,e))},0)},i.onerror=function(){setTimeout(function(){t(new TypeError("Network request failed"))},0)},i.ontimeout=function(){setTimeout(function(){t(new TypeError("Network request failed"))},0)},i.onabort=function(){setTimeout(function(){t(new a.DOMException("Aborted","AbortError"))},0)},i.open(e.method,function(e){try{return""===e&&h.location.href?h.location.href:e}catch(t){return e}}(e.url),!0),"include"===e.credentials?i.withCredentials=!0:"omit"===e.credentials&&(i.withCredentials=!1),"responseType"in i&&(u?i.responseType="blob":f&&e.headers.get("Content-Type")&&-1!==e.headers.get("Content-Type").indexOf("application/octet-stream")&&(i.responseType="arraybuffer")),!s||"object"!=typeof s.headers||s.headers instanceof d?e.headers.forEach(function(t,e){i.setRequestHeader(e,t)}):Object.getOwnPropertyNames(s.headers).forEach(function(t){i.setRequestHeader(t,c(s.headers[t]))}),e.signal&&(e.signal.addEventListener("abort",r),i.onreadystatechange=function(){4===i.readyState&&e.signal.removeEventListener("abort",r)}),i.send(void 0===e._bodyInit?null:e._bodyInit)})}g.polyfill=!0,h.fetch||(h.fetch=g,h.Headers=d,h.Request=E,h.Response=A),a.Headers=d,a.Request=E,a.Response=A,a.fetch=g,Object.defineProperty(a,"__esModule",{value:!0})});
!function(){n=null,"maxTouchPoints"in navigator?n=0<navigator.maxTouchPoints:window.matchMedia&&window.matchMedia("(any-pointer:coarse),(any-pointer:fine),(any-pointer:none)").matches?n=window.matchMedia("(any-pointer:coarse)").matches:"msMaxTouchPoints"in navigator&&(n=0<navigator.msMaxTouchPoints);var n,o=null!==n,a=o?n:L.Browser.touch;BR.Browser={touchScreen:n,touchScreenDetectable:o,touch:a,download:"Blob"in window&&"FileReader"in window&&"readAsDataURL"in FileReader.prototype&&"download"in document.createElement("a")}}();
BR.WhatsNew={newOnly:void 0,init:function(){var e=this;e.dismissableMessage=new BR.Message("whats_new_message",{onClosed:function(){document.getElementsByClassName("version")[0].classList.remove("version-new"),BR.Util.localStorageAvailable()&&localStorage.setItem("changelogVersion",e.getLatestVersion())}}),$("#whatsnew").on("shown.bs.modal",function(){e.dismissableMessage.hide()}),$("#whatsnew").on("hidden.bs.modal",function(){e.prepare(!1)}),!e.getCurrentVersion()&&BR.Util.localStorageAvailable()&&localStorage.setItem("changelogVersion",e.getLatestVersion()),e.prepare(e.hasNewVersions()),e.hasNewVersions()&&(e.dismissableMessage.showInfo(i18next.t("whatsnew.new-version")),document.getElementsByClassName("version")[0].classList.add("version-new"))},getLatestVersion:function(){return BR.changelog.match('<h2 id="(.*)">')[1]},getCurrentVersion:function(){return BR.Util.localStorageAvailable()?localStorage.getItem("changelogVersion"):null},hasNewVersions:function(){return this.getCurrentVersion()&&this.getCurrentVersion()!==this.getLatestVersion()},prepare:function(e){var s,n;e!==this.newOnly&&(this.newOnly=e,s=document.querySelector("#whatsnew .modal-body"),n=BR.changelog,e&&this.getCurrentVersion()&&(e='<h2 id="'+this.getCurrentVersion()+'">',0<=(e=n.indexOf(e)))&&(n=n.substring(0,e)),s.innerHTML=n)}};
BR.Util={get:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){200!==n.status&&0!==n.status||!n.responseText?t(BR.Util.getError(n)):t(null,n.responseText)},n.onerror=function(){t(BR.Util.getError(n))};try{n.send()}catch(e){t(e)}},getError:function(e){var t=i18next.t("warning.no-response");return e.responseText?t=e.responseText:(e.status||e.statusText)&&(t=e.status+": "+e.statusText),new Error(t)},getJson:function(e,r,o){BR.Util.get(e,function(e,t){if(e)return BR.message.showError("Error getting "+r+": "+e),o(e);try{var n=JSON.parse(t);o(null,n)}catch(e){BR.message.showError("Error parsing "+r+": "+e),console.error(e),o(e)}})},getGeoJson:function(e,t,r){BR.Util.getJson(e,t,function(e,t){if(e)return r(e);var n,e=t;t&&t.type&&"Topology"===t.type&&(n=Object.keys(t.objects)[0],e=topojson.feature(t,t.objects[n])),r(null,e)})},localStorageAvailable:function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}},getResponsiveBreakpoint:function(){var e={"1xs":"d-none","2sm":"d-sm-none","3md":"d-md-none","4lg":"d-lg-none","5xl":"d-xl-none"},t="",n=$("<div>");n.appendTo($("body"));for(var r=Object.keys(e).length-1;0<=r&&(t=Object.keys(e)[r],n.addClass(e[t]),!n.is(":hidden"));r--);return n.remove(),t},keyboardShortcutsAllowed:function(e){return!e.repeat&&"number"!=document.activeElement.type&&"text"!=document.activeElement.type&&"textarea"!=document.activeElement.type&&!(e.ctrlKey||e.metaKey||e.altKey||$(".modal.show").length||$(".dropdown.show").length)},sanitizeHTMLContent:function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML},isCountry:function(e,t){var n=i18next.languages[0].split("-");return 1<n.length?n[1]===e:!!t&&n[0]===t}};
function _createForOfIteratorHelper(t,e){var o,r,a,n,i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return r=!(o=!0),{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){r=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw a}}};if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length)return i&&(t=i),n=0,{s:e=function(){},n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var o;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(o="Object"===(o=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:o)||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}BR.Map={initMap:function(){L.setOptions(this,{shortcut:{locate:76}}),BR.keys=BR.keys||{};BR.Browser.touch&&(L.Draggable.prototype.options.clickTolerance=10),t=new L.Map("map",{zoomControl:!1,worldCopyJump:!0,minZoom:0,maxZoom:19}),"3md"<=BR.Util.getResponsiveBreakpoint()&&L.control.zoom({zoomInTitle:i18next.t("keyboard.generic-shortcut",{action:"$t(map.zoomInTitle)",key:"+"}),zoomOutTitle:i18next.t("keyboard.generic-shortcut",{action:"$t(map.zoomOutTitle)",key:"-"})}).addTo(t),t.restoreView()||t.setView(BR.conf.initialMapLocation||[50.99,9.86],BR.conf.initialMapZoom||5);var t,e=400<=$(t.getContainer()).outerWidth()?i18next.t("map.attribution-osm-long"):i18next.t("map.attribution-osm-short"),o=BR.conf.privacyPolicyUrl||"https://brouter.de/privacypolicy.html",e=(t.attributionControl.setPrefix('&copy; <a target="_blank" href="https://www.openstreetmap.org/copyright">'+e+'</a> &middot; <a href="" data-toggle="modal" data-target="#credits">'+i18next.t("map.copyright")+'</a> &middot; <a target="_blank" href="'+o+'">'+i18next.t("map.privacy")+"</a>"),$("#credits").on("show.bs.modal",function(t){BR.Map._renderLayerCredits(l._layers);var e,o=new URL(BR.conf.overpassBaseUrl||"https://overpass-api.de").origin,r=_createForOfIteratorHelper(document.getElementsByClassName("overpass-url"));try{for(r.s();!(e=r.n()).done;)e.value.href=o}catch(t){r.e(t)}finally{r.f()}}),(new L.Control.PermalinkAttribution).addTo(t),t.attributionControl.setPrefix(!1),BR.layersConfig(t)),r=e.getBaseLayers(),a=e.getOverlays();for(i in BR.keys.bing&&(r[i18next.t("map.layer.bing")]=new BR.BingLayer(BR.keys.bing)),BR.keys.digitalGlobe&&(o=new L.tileLayer("https://{s}.tiles.mapbox.com/v4/digitalglobe.nal0g75k/{z}/{x}/{y}.png?access_token="+BR.keys.digitalGlobe,{minZoom:1,maxZoom:19,attribution:'&copy; <a href="https://www.digitalglobe.com/platforms/mapsapi">DigitalGlobe</a> (<a href="https://bit.ly/mapsapiview">Terms of Use</a>)'}),r[i18next.t("map.layer.digitalglobe")]=o),BR.conf.clearBaseLayers&&(r={}),BR.conf.baseLayers)BR.conf.baseLayers.hasOwnProperty(i)&&(r[i]=L.tileLayer(BR.conf.baseLayers[i]));for(i in BR.conf.overlays)BR.conf.overlays.hasOwnProperty(i)&&(a[i]=L.tileLayer(BR.conf.overlays[i]));var n,l=BR.layersTab(e,r,a).addTo(t);return("isSecureContext"in window?isSecureContext:"https:"===location.protocol)&&(n=L.control.locate({strings:{title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.locate-me)",key:"L"})},icon:"fa fa-location-arrow",iconLoading:"fa fa-spinner fa-pulse"}).addTo(t),L.DomEvent.addListener(document,"keydown",function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.locate&&(n._active?n.stop():n.start())},this)),L.control.scale().addTo(t),(new BR.Layers).init(t,l,r,a),BR.debug=BR.debug||{},{map:BR.debug.map=t,layersControl:l}},_renderLayerCredits:function(t){var e,o,r,a,n=document.getElementById("credits-maps");for(L.DomUtil.empty(n),e=0;e<t.length;e++)(o=t[e]).layer.options.attribution&&((r=document.createElement("dt")).innerHTML=o.name,(a=document.createElement("dd")).innerHTML=o.layer.options.attribution,n.appendChild(r),n.appendChild(a))}};
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return i};var i={},e=Object.prototype,l=e.hasOwnProperty,u=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",a=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a,o,i,s,t=t&&t.prototype instanceof y?t:y,t=Object.create(t.prototype),n=new w(n||[]);return u(t,"_invoke",{value:(a=e,o=r,i=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return _()}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){r=function e(t,r){var n=r.method,a=t.iterator[n];if(void 0===a)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;n=c(a,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;a=n.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,i);if(r){if(r===f)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===s)throw s="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s="executing";r=c(a,o,i);if("normal"===r.type){if(s=i.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(s="completed",i.method="throw",i.arg=r.arg)}})}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=s;var f={};function y(){}function p(){}function d(){}var t={},h=(o(t,n,function(){return this}),Object.getPrototypeOf),h=h&&h(h(x([]))),v=(h&&h!==e&&l.call(h,n)&&(t=h),d.prototype=y.prototype=Object.create(t));function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function g(i,s){var t;u(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,a){var o,e=c(i[e],i,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==_typeof(r)&&l.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,a)},function(e){t("throw",e,n,a)}):s.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,a)});a(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function x(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(l.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:_}}function _(){return{value:void 0,done:!0}}return u(v,"constructor",{value:p.prototype=d,configurable:!0}),u(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,a,"GeneratorFunction"),i.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},i.awrap=function(e){return{__await:e}},m(g.prototype),o(g.prototype,r,function(){return this}),i.AsyncIterator=g,i.async=function(e,t,r,n,a){void 0===a&&(a=Promise);var o=new g(s(e,t,r,n),a);return i.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(v),o(v,a,"Generator"),o(v,n,function(){return this}),o(v,"toString",function(){return"[object Generator]"}),i.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var a=this.tryEntries[t],o=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var i=l.call(a,"catchLoc"),s=l.call(a,"finallyLoc");if(i&&s){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&l.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}var o=(a=a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc?null:a)?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),b(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,a=this.tryEntries[t];if(a.tryLoc===e)return"throw"===(r=a.completion).type&&(n=r.arg,b(a)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},i}function asyncGeneratorStep(e,t,r,n,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(s){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=s.apply(e,i);function a(e){asyncGeneratorStep(n,t,r,a,o,"next",e)}function o(e){asyncGeneratorStep(n,t,r,a,o,"throw",e)}a(void 0)})}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var r,n,a,o,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return n=!(r=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){n=!0,a=e},f:function(){try{r||null==i.return||i.return()}finally{if(n)throw a}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}BR.LayersConfig=L.Class.extend({overpassFrontend:new OverpassFrontend(BR.conf.overpassBaseUrl||"//overpass-api.de/api/interpreter"),defaultBaseLayers:BR.confLayers.defaultBaseLayers,defaultOverlays:BR.confLayers.defaultOverlays,legacyNameToIdMap:BR.confLayers.legacyNameToIdMap,builtInLayers:["route-quality"],initialize:function(e){this._map=e,this._overpassLoadingIndicator=new BR.Message("overpass_loading_indicator",{alert:!1}),this._overpassActiveRequestCount=0,this._addLeafletProvidersLayers(),this._customizeLayers(),this.loadDefaultLayers(),this._addLanguageDefaultLayer()},loadDefaultLayers:function(){var e;BR.Util.localStorageAvailable()&&(e=localStorage.getItem("map/defaultLayers"))&&(e=JSON.parse(e),this.defaultBaseLayers=this._replaceLegacyIds(e.baseLayers),this.defaultOverlays=this._replaceLegacyIds(e.overlays))},storeDefaultLayers:function(e,t){BR.Util.localStorageAvailable()&&localStorage.setItem("map/defaultLayers",JSON.stringify({baseLayers:e,overlays:t}))},_replaceLegacyIds:function(e){var t=this;return e.map(function(e){return e in t.legacyNameToIdMap?t.legacyNameToIdMap[e]:e})},_addLeafletProvidersLayers:function(){for(var e=BR.confLayers.leafletProvidersIncludeList,t=0;t<e.length;t++){var r=e[t],n={geometry:null,properties:{id:r,name:r.replace("."," "),dataSource:"leaflet-providers"},type:"Feature"};BR.layerIndex[r]=n}},_customizeLayers:function(){var e,t=BR.confLayers.getPropertyOverrides();for(e in t){var r=BR.layerIndex[e];if(r){var n,a=t[e];for(n in a){var o=a[n];r.properties[n]=o}}else console.error("Layer not found: "+e)}BR.layerIndex.MtbMap.geometry=BR.confLayers.europeGeofabrik,BR.layerIndex[1069].geometry=BR.confLayers.europeGeofabrik,BR.layerIndex["OpenStreetMap.CH"].geometry=BR.confLayers.switzerlandPadded,BR.layerIndex["swisstopo-landeskarte"].geometry=BR.confLayers.switzerlandPadded,BR.layerIndex["swisstopo-aerial"].geometry=BR.confLayers.switzerlandPadded,BR.layerIndex[1017].geometry=BR.confLayers.osmapaPl,BR.layerIndex["ignf-aerial"].geometry=BR.confLayers.franceBbox,BR.layerIndex["ignf-map"].geometry=BR.confLayers.franceBbox,BR.layerIndex["ignf-scan25"].geometry=BR.confLayers.franceBbox},_addLanguageDefaultLayer:function(){for(var e={},t=0;t<BR.confLayers.languageDefaultLayers.length;t++){var r=BR.confLayers.languageDefaultLayers[t],n=BR.layerIndex[r];n&&(n=n.properties.language_code||n.properties.pseudo_language_code)&&(e[n]=r)}for(t=0;t<i18next.languages.length;t++){var a=e[i18next.languages[t]];if(a){this.defaultBaseLayers.unshift(a);break}}},isDefaultLayer:function(e,t){return t?-1<this.defaultOverlays.indexOf(e):-1<this.defaultBaseLayers.indexOf(e)},getBaseLayers:function(){return this._getLayers(this.defaultBaseLayers)},getOverlays:function(){return this._getLayers(this.defaultOverlays)},_getLayers:function(e){for(var t={},r=0;r<e.length;r++){var n,a=e[r],o=BR.layerIndex[a];o?(n=this.getKeyName(o.properties.url))&&!BR.keys[n.name]||(t[o.properties.name]=this.createLayer(o)):console.error("Layer not found: "+a)}return t},getKeyName:function(e){var t=null,r=new RegExp("{keys_([^}]*)}");return t=e&&(e=e.match(r))?{name:r=e[1],urlVar:"keys_"+r}:t},_showOverpassLoadingIndicator:function(){this._overpassActiveRequestCount++,this._overpassLoadingIndicator.showLoading(i18next.t("layers.overpass-loading-indicator"))},_hideOverpassLoadingIndicator:function(){0==--this._overpassActiveRequestCount&&this._overpassLoadingIndicator.hide()},getOverpassIconUrl:function(e){var t=/^(maki|temaki|fas)-/,r=null;return e&&t.test(e)&&(e=e.replace(t,""),r="dist/images/".concat(e,".svg")),r},createOverpassLayer:function(e,t){var r='<i class="fa fa-search icon-white" style="width: 25px;"></i>',t=this.getOverpassIconUrl(t);return t&&(r='<img class="icon-invert" src="'.concat(t,'" width="11" />')),Object.assign(new OverpassLayer({overpassFrontend:this.overpassFrontend,query:e,minZoom:12,feature:{title:"{{ tags.name }}",body:this.renderOverpassPopupBody,markerSymbol:'<svg width="25px" height="41px" anchorX="12" anchorY="41" viewBox="0 0 32 52" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M16,1 C7.7146,1 1,7.65636364 1,15.8648485 C1,24.0760606 16,51 16,51 C16,51 31,24.0760606 31,15.8648485 C31,7.65636364 24.2815,1 16,1 L16,1 Z" fill="#436978"></path></svg>',markerSign:r,style:function(e){return{color:"node"===e.type?"#00000000":"cyclosm"===(null==(e=this.defaultBaseLayers)?void 0:e[0])?"darkorange":"#3388ff"}}.bind(this)}}),{onLoadStart:this._showOverpassLoadingIndicator.bind(this),onLoadEnd:this._hideOverpassLoadingIndicator.bind(this)})},renderOverpassPopupBody:function(e){var t,r,n=(n=(n=(n="")+'<table class="overpass-tags">'+"<thead>")+('<tr><th class="overpass-label-key">'+i18next.t("layers.overpass-table-key")+'</th><th class="overpass-label-value">'+i18next.t("layers.overpass-table-value")+"</th></tr>"))+"</thead>"+"<tbody>";for(r in e.tags)"addr:"!==r.substring(0,5)&&(t=BR.Util.sanitizeHTMLContent(e.tags[r]),(r=BR.Util.sanitizeHTMLContent(r)).match(/email/)&&(t='<a href="mailto:'+t+'">'+t+"</a>"),n=(n=n+"<tr><th>"+r+"</th>")+"<td>"+(t=(t=t.match(/^https?:\/\//)?'<a href="'+t+'">'+t+"</a>":t).match(/^www/)?'<a href="https://'+t+'">'+t+"</a>":t)+"</td></tr>");return n=(n=(n=(n=(n+="</tbody>")+"</table>"+'<div class="overpass-osm-link">')+('<a href="https://www.openstreetmap.org/'+e.type+"/"+e.osm_id+'" target="_blank" title="'+i18next.t("layers.overpass-inspect-at-openstreetmap")+'">'))+i18next.t("layers.overpass-osm"))+"</a>"+"</div>"},createOpenStreetMapNotesLayer:function(){return new leafletOsmNotes},createMvtLayer:function(e,t){var r=null==(r=e.url)?void 0:r.split("?")[0];return r in BR.layerIndex?(t.style=BR.layerIndex[r],this._replaceMvtTileKey(t.style)):t.style=e.url,BR.maplibreGlLazyLoader(t)},_replaceMvtTileKey:function(e){if(e)for(var t=0,r=Object.values(e.sources);t<r.length;t++){var n,a=r[t];if(a.url&&(n=this.getKeyName(a.url))&&BR.keys[n.name]&&(a.url=a.url.replace("{".concat(n.urlVar,"}"),BR.keys[n.name])),a.tiles){var o,i=a.tiles,s=_createForOfIteratorHelper(null==i?void 0:i.entries());try{for(s.s();!(o=s.n()).done;){var l=_slicedToArray(o.value,2),u=l[0],c=l[1],f=this.getKeyName(c);f&&BR.keys[f.name]&&(i[u]=c.replace("{".concat(f.urlVar,"}"),BR.keys[f.name]))}}catch(e){s.e(e)}finally{s.f()}}}},createGeoJsonLayer:function(e){var n=L.geoJSON(void 0,BR.Track.getGeoJsonOptions());return fetch(e.url).then(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:r=e.sent,n.addData(r);case 4:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),n},createLayer:function(e){var t=e.properties,r=t.url;var n,a,e={maxZoom:this._map.getMaxZoom(),bounds:e.geometry&&!t.worldTiles?L.geoJson(e.geometry).getBounds():null},o=(t.mapUrl&&(e.mapLink='<a target="_blank" href="'+t.mapUrl+'">'+(t.nameShort||t.name)+"</a>"),t.attribution&&(e.attribution=t.attribution),this.getKeyName(r));o&&BR.keys[o.name]&&(e[o.urlVar]=BR.keys[o.name]),"leaflet-providers"===t.dataSource?(n=L.tileLayer.provider(t.id),o=L.Util.extend(e,{maxNativeZoom:n.options.maxZoom}),L.setOptions(n,o)):"LayersCollection"===t.dataSource?(n=L.tileLayer(r,L.Util.extend(e,{minZoom:t.minZoom||0,maxNativeZoom:t.maxZoom})),t.subdomains&&(n.subdomains=t.subdomains)):n="OverpassAPI"===t.dataSource?this.createOverpassLayer(t.query,t.icon):"OpenStreetMapNotesAPI"===t.dataSource?this.createOpenStreetMapNotesLayer():"mvt"===t.type?this.createMvtLayer(t,e):"geojson"===t.type?this.createGeoJsonLayer(t):(r=(o=r).replace(/{switch:[^}]*}/,"{s}").replace(/{zoom}/g,"{z}"),a=L.Util.extend(e,{minZoom:t.min_zoom||0,maxNativeZoom:t.max_zoom,subdomains:(e="abc",o=(o=o).match(/{switch:([^}]*)}/),e=o?o[1].split(","):e),attribution:(o="",(a=(e=t).attribution)&&(a.html?o=a.html:a.url&&a.text?o='<a href="'+a.url+'" target="_blank" rel="noopener">'+a.text+"</a>":a.text&&(o=a.text)),o||console.warn("No attribution: "+e.id),o)}),t.type&&"wms"===t.type?L.tileLayer.wms(r,L.Util.extend(a,{layers:t.layers,format:t.format,transparent:t.transparent||!1})):L.tileLayer(r,a));return n.getAttribution=function(){return this.options.mapLink},n.id=t.id,n}}),BR.layersConfig=function(e){return new BR.LayersConfig(e)};
function _createForOfIteratorHelper(t,e){var o,n,r,s,i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return n=!(o=!0),{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){n=!0,r=t},f:function(){try{o||null==i.return||i.return()}finally{if(n)throw r}}};if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length)return i&&(t=i),s=0,{s:e=function(){},n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var o;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(o="Object"===(o=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:o)||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}L.BRouter=L.Class.extend({statics:{URL_TEMPLATE:"/brouter?lonlats={lonlats}&profile={profile}&alternativeidx={alternativeidx}&format={format}&nogos={nogos}&polylines={polylines}&polygons={polygons}",URL_PROFILE_UPLOAD:BR.conf.host+"/brouter/profile",PRECISION:6,NUMBER_SEPARATOR:",",GROUP_SEPARATOR:"|",ABORTED_ERROR:"aborted",CUSTOM_PREFIX:"custom_",SUPPORTED_BROUTER_VERSIONS:"< 1.7.0 || >=1.7.2",isCustomProfile:function(t){return t&&t.substring(0,7)===L.BRouter.CUSTOM_PREFIX}},options:{},initialize:function(t){L.setOptions(this,t),this.queue=async.queue(L.bind(function(t,e){this.getRoute(t.segment,e)},this),1)},setOptions:function(t){L.setOptions(this,t)},getUrlParams:function(t,e,o,n,r){return params={},null!=this._getLonLatsString(t)&&(params.lonlats=this._getLonLatsString(t)),e&&0<e.length&&0<(t=this._getBeelineString(e)).length&&(params.straight=t),this.options.nogos&&0<this._getNogosString(this.options.nogos).length&&(params.nogos=this._getNogosString(this.options.nogos)),this.options.polylines&&0<this._getNogosPolylinesString(this.options.polylines).length&&(params.polylines=this._getNogosPolylinesString(this.options.polylines)),this.options.polygons&&0<this._getNogosPolygonsString(this.options.polygons).length&&(params.polygons=this._getNogosPolygonsString(this.options.polygons)),null!=this.options.profile&&(params.profile=this.options.profile),o&&null!=this._getLonLatsNameString(o)&&(params.pois=this._getLonLatsNameString(o)),n&&(params.circlego=n),params.alternativeidx=this.options.alternative,null!=r?params.format=r:(params.profile===BR.conf.profiles[0]&&delete params.profile,0==params.alternativeidx&&delete params.alternativeidx,params.profile&&L.BRouter.isCustomProfile(params.profile)&&delete params.profile),params},parseUrlParams:function(t){var e={};return t.lonlats&&(e.lonlats=this._parseLonLats(t.lonlats)),t.straight&&(e.beelineFlags=this._parseBeelines(t.straight,e.lonlats)),t.nogos&&(e.nogos=this._parseNogos(t.nogos)),t.polylines&&(e.polylines=this._parseNogosPolylines(t.polylines)),t.polygons&&(e.polygons=this._parseNogosPolygons(t.polygons)),t.alternativeidx&&(e.alternative=t.alternativeidx),t.profile&&(e.profile=this._parseProfile(t.profile)),t.pois&&(e.pois=this._parseLonLatNames(t.pois)),(t.ringgo||t.circlego)&&3==(t=(t.ringgo||t.circlego).split(",")).length&&(t=[Number.parseFloat(t[0]),Number.parseFloat(t[1]),Number.parseInt(t[2])],e.circlego=t),e},getUrl:function(t,e,o,n,r,s,i){t=this.getUrlParams(t,e,o,n,r),e=[];return null!=t.lonlats&&0<t.lonlats.length&&e.push(L.Util.template("lonlats={lonlats}",t)),null!=t.straight&&e.push(L.Util.template("straight={straight}",t)),null!=t.pois&&0<t.pois.length&&e.push(L.Util.template("pois={pois}",t)),null!=t.circlego&&e.push(L.Util.template("ringgo={circlego}",t)),null!=t.nogos&&e.push(L.Util.template("nogos={nogos}",t)),null!=t.polylines&&e.push(L.Util.template("polylines={polylines}",t)),null!=t.polygons&&e.push(L.Util.template("polygons={polygons}",t)),null!=t.profile&&e.push(L.Util.template("profile={profile}",t)),null!=t.alternativeidx&&e.push(L.Util.template("alternativeidx={alternativeidx}",t)),null!=t.format&&e.push(L.Util.template("format={format}",t)),s&&e.push(L.Util.template("trackname={trackname}",{trackname:s})),i&&e.push("exportWaypoints=1"),(null!=r?BR.conf.host:"")+"/brouter?"+e.join("&")},getRoute:function(t,e){var t=this.getUrl(t,null,null,null,"geojson"),o=new XMLHttpRequest;if(!t)return e(new Error(i18next.t("warning.cannot-get-route")));o.open("GET",t,!0),o.onload=L.bind(this._handleRouteResponse,this,o,e),o.onerror=L.bind(function(t,e){e(BR.Util.getError(t))},this,o,e),o.send()},_handleRouteResponse:function(e,o){var t,n;if(200!==e.status||!e.responseText||"application/geo+json"!==e.getResponseHeader("Content-Type").split(";")[0]&&"application/vnd.geo+json"!==e.getResponseHeader("Content-Type").split(";")[0])o(BR.Util.getError(e));else try{return n=JSON.parse(e.responseText),t=this._assignFeatures(L.geoJSON(n).getLayers()[0]),this.checkBRouterVersion(t.feature.properties.creator),o(null,t)}catch(t){return console.error(t,e.responseText),o(t)}},versionCheckDone:!1,checkBRouterVersion:function(t){if(!this.versionCheckDone){this.versionCheckDone=!0;try{var e=t.replace(/^BRouter-/,"");compareVersions.satisfies(e,L.BRouter.SUPPORTED_BROUTER_VERSIONS)||console.warn("BRouter-Web "+BR.version+" requires BRouter versions "+L.BRouter.SUPPORTED_BROUTER_VERSIONS+", but only "+t+" was found.")}catch(t){console.error(t)}}},getRouteSegment:function(t,e,o){this.queue.push({segment:[t,e]},o)},uploadProfile:function(t,e,o){var n=L.BRouter.URL_PROFILE_UPLOAD;t&&(n+="/"+t),(xhr=new XMLHttpRequest).open("POST",n,!0),xhr.onload=L.bind(this._handleProfileResponse,this,xhr,o),xhr.onerror=function(t){o(i18next.t("warning.upload-error",{error:this.statusText}))},xhr.send(e)},_assignFeatures:function(t){if(t.feature.properties.messages)for(var e=t.feature.properties.messages,o=t.getLatLngs(),n=o.length,r=0,s=1;s<e.length;s++)for(var i=this._getFeatureLatLng(e[s]),l=r;l<n;l++){var a=o[l],g=e[s];if(a.feature=BR.TrackEdges.getFeature(g),a.message=g,i.equals(o[l])){r=l+1;break}}return t},_getFeatureLatLng:function(t){var e=t[0]/1e6,t=t[1]/1e6;return L.latLng(t,e)},_handleProfileResponse:function(t,e){200===t.status&&t.responseText&&0<t.responseText.length?e((t=JSON.parse(t.responseText)).error,t.profileid):e(i18next.t("warning.profile-error"))},_getLonLatsString:function(t){for(var e="",o=0;o<t.length;o++)e+=this._formatLatLng(t[o]),o<t.length-1&&(e+=L.BRouter.GROUP_SEPARATOR);return e},_parseLonLats:function(t){var e,o=[];if(t)for(var n=t.split(L.BRouter.GROUP_SEPARATOR),r=0;r<n.length;r++)e=n[r].split(L.BRouter.NUMBER_SEPARATOR),o.push(L.latLng(e[1],e[0]));return o},_getBeelineString:function(t){for(var e=[],o=0;o<t.length;o++)t[o]&&e.push(o);return e.join(",")},_parseBeelines:function(t,e){if(!e||e.length<2)return[];var o,n=new Array(e.length-1),r=(n.fill(!1),_createForOfIteratorHelper(t.split(",")));try{for(r.s();!(o=r.n()).done;)n[o.value]=!0}catch(t){r.e(t)}finally{r.f()}return n},_getLonLatsNameString:function(t){for(var e="",o=0;o<t.length;o++)e=(e=(e+=this._formatLatLng(t[o].latlng))+L.BRouter.NUMBER_SEPARATOR)+encodeURIComponent(t[o].name),o<t.length-1&&(e+=L.BRouter.GROUP_SEPARATOR);return e},_parseLonLatNames:function(t){var e,o=[];if(t)for(var n=t.split(L.BRouter.GROUP_SEPARATOR),r=0;r<n.length;r++)e=n[r].split(L.BRouter.NUMBER_SEPARATOR),o.push({latlng:L.latLng(e[1],e[0]),name:decodeURIComponent(e[2])});return o},_getNogosString:function(t){for(var e,o="",n=0;n<t.length;n++)e=t[n],o=(o=(o+=this._formatLatLng(e.getLatLng()))+L.BRouter.NUMBER_SEPARATOR)+Math.round(e.getRadius()),void 0!==e.options.nogoWeight&&null!==e.options.nogoWeight&&-1!==e.options.nogoWeight&&(o=(o+=L.BRouter.NUMBER_SEPARATOR)+e.options.nogoWeight),n<t.length-1&&(o+=L.BRouter.GROUP_SEPARATOR);return o},_parseNogos:function(t){var e=[];if(t)for(var o=t.split(L.BRouter.GROUP_SEPARATOR),n=0;n<o.length;n++){var r,s={radius:(r=o[n].split(L.BRouter.NUMBER_SEPARATOR))[2]};3<r.length&&(s.nogoWeight=r[3]),e.push(L.circle([r[1],r[0]],s))}return e},_getNogosPolylinesString:function(t){for(var e="",o=0;o<t.length;o++){for(var n,r=(n=t[o]).getLatLngs(),s=0;s<r.length;s++)0<s&&(e+=L.BRouter.NUMBER_SEPARATOR),e+=this._formatLatLng(r[s]);void 0!==n.options.nogoWeight&&null!==n.options.nogoWeight&&-1!==n.options.nogoWeight&&(e=(e+=L.BRouter.NUMBER_SEPARATOR)+n.options.nogoWeight),o<t.length-1&&(e+=L.BRouter.GROUP_SEPARATOR)}return e},_parseNogosPolylines:function(t){for(var e,o=[],n=t.split(L.BRouter.GROUP_SEPARATOR),r=0;r<n.length;r++)if(1<(e=n[r].split(L.BRouter.NUMBER_SEPARATOR)).length){for(var s,i=[],l=0;l<e.length-1;){var a=Number.parseFloat(e[l++]),g=Number.parseFloat(e[l++]);i.push([g,a])}l<e.length&&(s=Number.parseFloat(e[l++]));var p=L.extend(BR.NogoAreas.prototype.polylineOptions,{nogoWeight:s});o.push(L.polyline(i,p))}return o},_getNogosPolygonsString:function(t){for(var e="",o=0;o<t.length;o++){for(var n,r=(n=t[o]).getLatLngs()[0],s=0;s<r.length;s++)0<s&&(e+=L.BRouter.NUMBER_SEPARATOR),e+=this._formatLatLng(r[s]);void 0!==n.options.nogoWeight&&null!==n.options.nogoWeight&&-1!==n.options.nogoWeight&&(e=(e+=L.BRouter.NUMBER_SEPARATOR)+n.options.nogoWeight),o<t.length-1&&(e+=L.BRouter.GROUP_SEPARATOR)}return e},_parseNogosPolygons:function(t){for(var e,o=[],n=t.split(L.BRouter.GROUP_SEPARATOR),r=0;r<n.length;r++)if(1<(e=n[r].split(L.BRouter.NUMBER_SEPARATOR)).length){for(var s,i=[],l=0;l<e.length-1;){var a=Number.parseFloat(e[l++]),g=Number.parseFloat(e[l++]);i.push([g,a])}l<e.length&&(s=Number.parseFloat(e[l++])),o.push(L.polygon(i,{nogoWeight:s}))}return o},_parseProfile:function(t){var e;return null!=(e=BR.conf.profilesRename)&&e[t]?BR.conf.profilesRename[t]:t},_formatLatLng:function(t){var e,o="";return(o+=L.Util.formatNum(null!=(e=t.lng)?e:t[1],L.BRouter.PRECISION))+L.BRouter.NUMBER_SEPARATOR+L.Util.formatNum(null!=(e=t.lat)?e:t[0],L.BRouter.PRECISION)}}),L.bRouter=function(t){return new L.BRouter(t)};
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0===i)return("string"===e?String:Number)(t);i=i.call(t,e||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(t){var e;t=t.util||(t.util={}),(e=function(){"use strict";function o(){_classCallCheck(this,o)}return _createClass(o,null,[{key:"__static_initialize",value:function(){o.__static_initialized||(o.__static_initialized=!0,o.__static_initializer_0())}},{key:"DEG_TO_RAD_$LI$",value:function(){return o.__static_initialize(),o.DEG_TO_RAD=null==o.DEG_TO_RAD?Math.PI/180:o.DEG_TO_RAD}},{key:"SCALE_CACHE_$LI$",value:function(){return o.__static_initialize(),o.SCALE_CACHE=null==o.SCALE_CACHE?function(t){for(var e=[];0<t--;)e.push(null);return e}(o.SCALE_CACHE_LENGTH):o.SCALE_CACHE}},{key:"__static_initializer_0",value:function(){for(var t=0;t<o.SCALE_CACHE_LENGTH;t++)o.SCALE_CACHE_$LI$()[t]=o.calcKxKyFromILat(t*o.SCALE_CACHE_INCREMENT+(o.SCALE_CACHE_INCREMENT/2|0))}},{key:"calcKxKyFromILat",value:function(t){var t=o.DEG_TO_RAD_$LI$()*(t*o.ILATLNG_TO_LATLNG-90),t=Math.cos(t),e=2*t*t-1,i=2*t*e-t,n=2*t*i-e,r=[0,0];return r[0]=(111.41513*t-.09455*i+12e-5*(2*t*n-i))*o.ILATLNG_TO_LATLNG*o.KILOMETERS_TO_METERS,r[1]=(111.13209-.56605*e+.0012*n)*o.ILATLNG_TO_LATLNG*o.KILOMETERS_TO_METERS,r}},{key:"getLonLatToMeterScales",value:function(t){return o.SCALE_CACHE_$LI$()[t/o.SCALE_CACHE_INCREMENT|0]}},{key:"distance",value:function(t,e,i,n){var r=o.getLonLatToMeterScales(e+n>>1),t=(t-i)*r[0],i=(e-n)*r[1];return Math.sqrt(i*i+t*t)}}]),o}()).__static_initialized=!1,e.ILATLNG_TO_LATLNG=1e-6,e.KILOMETERS_TO_METERS=1e3,e.SCALE_CACHE_LENGTH=1800,e.SCALE_CACHE_INCREMENT=1e5,(t.CheapRuler=e).__class="btools.util.CheapRuler"}(btools=(btools={})||{}),btools.util.CheapRuler.__static_initialize(),btools.util.CheapRuler.toIntegerLngLat=function(t){return[Math.round(1e6*(t[0]+180)),Math.round(1e6*(t[1]+90))]},btools.util.CheapRuler.calcDistance=function(t,e,i,n){t=btools.util.CheapRuler.distance(t,e,i,n);return Math.trunc(t+1)};
BR.ClickTolerantBoxZoom=L.Map.BoxZoom.extend({clickTolerance:L.Draggable.prototype.options.clickTolerance,dragTolerance:15,tolerant:!0,_preMoved:!1,moved:function(){return this._preMoved||this._moved},_resetState:function(){L.Map.BoxZoom.prototype._resetState.call(this),this._preMoved=!1},_onMouseMove:function(e){if(!this._moved){var t=this._map.mouseEventToContainerPoint(e).clone()._subtract(this._startPoint),t=Math.abs(t.x||0)+Math.abs(t.y||0);if(this.tolerant&&t<this.dragTolerance)return void(!this._preMoved&&t>=this.clickTolerance&&(this._preMoved=!0))}L.Map.BoxZoom.prototype._onMouseMove.call(this,e)},_onMouseUp:function(e){L.Map.BoxZoom.prototype._onMouseUp.call(this,e),!this._moved&&this._preMoved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(L.Util.bind(this._resetState,this),0))}});
L.Draggable.prototype._onMoveOrig=L.Draggable.prototype._onMove,L.Draggable.prototype._onMove=function(t){var o=!this._moved;this._onMoveOrig.call(this,t),o&&this._moved&&(t=this._newPos.subtract(this._startPos),this._startPos=this._startPos.add(t),this._newPos=this._newPos.add(t))};
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return a};var a={},t=Object.prototype,u=t.hasOwnProperty,l=Object.defineProperty||function(t,e,r){t[e]=r.value},e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function i(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{i({},"")}catch(t){i=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o,i,a,c,e=e&&e.prototype instanceof f?e:f,e=Object.create(e.prototype),n=new b(n||[]);return l(e,"_invoke",{value:(o=t,i=r,a=n,c="suspendedStart",function(t,e){if("executing"===c)throw new Error("Generator is already running");if("completed"===c){if("throw"===t)throw e;return _()}for(a.method=t,a.arg=e;;){var r=a.delegate;if(r){r=function t(e,r){var n=r.method,o=e.iterator[n];if(void 0===o)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;n=s(o,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,h;o=n.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}(r,a);if(r){if(r===h)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===c)throw c="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);c="executing";r=s(o,i,a);if("normal"===r.type){if(c=a.done?"completed":"suspendedYield",r.arg===h)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(c="completed",a.method="throw",a.arg=r.arg)}})}),e}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}a.wrap=c;var h={};function f(){}function p(){}function y(){}var e={},d=(i(e,n,function(){return this}),Object.getPrototypeOf),d=d&&d(d(x([]))),g=(d&&d!==t&&u.call(d,n)&&(e=d),y.prototype=f.prototype=Object.create(e));function v(t){["next","throw","return"].forEach(function(e){i(t,e,function(t){return this._invoke(e,t)})})}function m(a,c){var e;l(this,"_invoke",{value:function(r,n){function t(){return new c(function(t,e){!function e(t,r,n,o){var i,t=s(a[t],a,r);if("throw"!==t.type)return(r=(i=t.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):c.resolve(r).then(function(t){i.value=t,n(i)},function(t){return e("throw",t,n,o)});o(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}})}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function x(e){if(e){var r,t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:_}}function _(){return{value:void 0,done:!0}}return l(g,"constructor",{value:p.prototype=y,configurable:!0}),l(y,"constructor",{value:p,configurable:!0}),p.displayName=i(y,o,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,i(t,o,"GeneratorFunction")),t.prototype=Object.create(g),t},a.awrap=function(t){return{__await:t}},v(m.prototype),i(m.prototype,r,function(){return this}),a.AsyncIterator=m,a.async=function(t,e,r,n,o){void 0===o&&(o=Promise);var i=new m(c(t,e,r,n),o);return a.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},v(g),i(g,o,"Generator"),i(g,n,function(){return this}),i(g,"toString",function(){return"[object Generator]"}),a.keys=function(t){var e,r=Object(t),n=[];for(e in r)n.push(e);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=x,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return i.type="throw",i.arg=r,n.next=t,e&&(n.method="next",n.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var i=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,n,o=this.tryEntries[e];if(o.tryLoc===t)return"throw"===(r=o.completion).type&&(n=r.arg,w(o)),n}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:x(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},a}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(c){return function(){var t=this,a=arguments;return new Promise(function(e,r){var n=c.apply(t,a);function o(t){asyncGeneratorStep(n,e,r,o,i,"next",t)}function i(t){asyncGeneratorStep(n,e,r,o,i,"throw",t)}o(void 0)})}}!function(){var t,a=(null==(t=document.currentScript)?void 0:t.src.split("/").slice(0,-1).join("/"))||window.location.origin+"/dist";function r(i){return new Promise(function(e,r){try{new Function('return import("'+i+'")')().then(function(){return e()})}catch(t){var n=new URL(i,a+"/").href,o=document.createElement("script");o.onload=function(){e()},o.onerror=function(){r(new Error('Error importing: "'.concat(n,'"'))),o.remove()},o.src=n,document.body.appendChild(o)}})}BR.MaplibreGlLazyLoader=L.Layer.extend({initialize:function(t){this.options=t},onAdd:function(t){return"maplibreGL"in L?this._addGlLayer():this._load(),this},onRemove:function(t){return this.glLayer&&this._map.removeLayer(this.glLayer),this.glLayer=null,this},setZIndex:function(t){return this.options.zIndex=t,this},setOpacity:function(t){var e;this.glLayer&&((e=this.glLayer.getMaplibreMap()).getLayer("hillshading")?e.setPaintProperty("hillshading","hillshade-exaggeration",t):e.getCanvas().style.opacity=t)},_load:function(){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r("./maplibre-gl.js");case 2:return t.next=4,r("./leaflet-maplibre-gl.js");case 4:e._addGlLayer();case 5:case"end":return t.stop()}},t)}))()},_addGlLayer:function(){this.glLayer=L.maplibreGL(this.options),this.glLayer.getAttribution=function(){return this.options.mapLink},this._map.addLayer(this.glLayer),this._updateZIndex()},_updateZIndex:function(){this.glLayer&&this.glLayer.getContainer()&&null!=this.options.zIndex&&(this.glLayer.getContainer().style.zIndex=this.options.zIndex)}}),BR.maplibreGlLazyLoader=function(t){return new BR.MaplibreGlLazyLoader(t)}}();
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0===i)return("string"===t?String:Number)(e);i=i.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){var i=function(){"use strict";function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:45,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;_classCallCheck(this,i),this.maxspeed=e,this.costfactor=t}return _createClass(i,[{key:"getMaxspeed",value:function(){return this.maxspeed}},{key:"getCostfactor",value:function(){return this.costfactor}}]),i}(),o=function(){"use strict";function t(e){_classCallCheck(this,t),this.profile=e}return _createClass(t,[{key:"getVariableValue",value:function(e,t){var i,e=null!=(i=null==(i=this.profile)?void 0:i.getProfileVar(e))?i:t;return"true"===e?e=1:"false"===e&&(e=0),+e}}]),t}(),e=_createClass(function e(t){"use strict";_classCallCheck(this,e),this.expctxGlobal=new o(t),this.expctxWay=new i,this.bikeMode=0!==this.expctxGlobal.getVariableValue("validForBikes",0),this.footMode=0!==this.expctxGlobal.getVariableValue("validForFoot",0),this.totalMass=this.expctxGlobal.getVariableValue("totalMass",90),this.maxSpeed=this.expctxGlobal.getVariableValue("maxSpeed",this.footMode?6:45)/3.6,this.S_C_x=this.expctxGlobal.getVariableValue("S_C_x",.225),this.defaultC_r=this.expctxGlobal.getVariableValue("C_r",.01),this.bikerPower=this.expctxGlobal.getVariableValue("bikerPower",100)}),t=function(){"use strict";function n(){_classCallCheck(this,n),this.totalTime=0,this.totalEnergy=0,this.elevation_buffer=0}return _createClass(n,[{key:"resetState",value:function(){this.totalTime=0,this.totalEnergy=0,this.elevation_buffer=0}},{key:"calcIncline",value:function(e){var t,i;return 3<this.elevation_buffer||this.elevation_buffer<3?(i=-3,t=n.exp(-e/100),t=(this.elevation_buffer+i)*t-i,i=(this.elevation_buffer-t)/e,this.elevation_buffer=t,i):0}},{key:"computeKinematic",value:function(e,t,i,o){var r,a;o&&(this.elevation_buffer+=i,o=this.calcIncline(t),0===(i=e.expctxWay.getMaxspeed()/3.6)&&(i=e.maxSpeed),i=Math.min(i,e.maxSpeed),r=e.totalMass*n.GRAVITY*(e.defaultC_r+o),a=e.footMode||4.9<e.expctxWay.getCostfactor()?(a=3.6*e.maxSpeed)*n.exp(-3.5*Math.abs(o+.05))/3.6:e.bikeMode?(a=n.solveCubic(e.S_C_x,r,e.bikerPower),Math.min(a,i)):i,this.totalTime+=t/a,0<(o=t*(e.S_C_x*a*a+r)))&&(this.totalEnergy+=o)}},{key:"getTotalTime",value:function(){return this.totalTime}},{key:"getTotalEnergy",value:function(){return this.totalEnergy}}],[{key:"exp",value:function(e){for(var t=e,i=1;e<-1;)e+=1,i*=.367879;return i*(1+t*(1+t*(.5+t*(.166667+.0416667*t))))}},{key:"solveCubic",value:function(e,t,i){for(var o=8,r=!0,a=0;a<10;a++){var n=(e*o*o+t)*o-i;if(n<.1){if(r){o*=2;continue}break}r=!1;o-=n/(3*e*o*o+t)}return o}}]),n}();t.GRAVITY=9.81,BR.StdPath=t,BR.RoutingContext=e,BR.BExpressionContextWay=i}();
function _slicedToArray(r,t){return _arrayWithHoles(r)||_iterableToArrayLimit(r,t)||_unsupportedIterableToArray(r,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,t){var e;if(r)return"string"==typeof r?_arrayLikeToArray(r,t):"Map"===(e="Object"===(e=Object.prototype.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:e)||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(r,t):void 0}function _arrayLikeToArray(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,o=new Array(t);e<t;e++)o[e]=r[e];return o}function _iterableToArrayLimit(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var o,n,i,a,l=[],u=!0,c=!1;try{if(i=(e=e.call(r)).next,0===t){if(Object(e)!==e)return;u=!1}else for(;!(u=(o=i.call(e)).done)&&(l.push(o.value),l.length!==t);u=!0);}catch(r){c=!0,n=r}finally{try{if(!u&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(c)throw n}}return l}}function _arrayWithHoles(r){if(Array.isArray(r))return r}BR.Track={getGeoJsonOptions:function(l){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],u=[["stroke","color"],["stroke-width","weight"],["stroke-opacity","opacity"],["fill","fillColor"],["fill-opacity","fillOpacity"]];return{style:function(r){for(var t={color:"cyclosm"===(null==l?void 0:l.getActiveBaseLayer().layer.id)?"yellow":"blue",weight:4},e=0,o=u;e<o.length;e++){var n,i=_slicedToArray(o[e],2),a=i[0],i=i[1];null!=r&&null!=(n=r.properties)&&n[a]&&(t[i]=r.properties[a])}return t},interactive:!1,filter:function(r){return!t||!BR.Track.isPoiPoint(r)},pointToLayer:function(r,t){return L.marker(t,{interactive:!1,opacity:.7,zIndexOffset:-1e3})},pane:"tracks"}},addPoiMarkers:function(n,r){turf.featureEach(r,function(r,t){var e,o;BR.Track.isPoiPoint(r)&&(e=turf.getCoord(r),e=L.GeoJSON.coordsToLatLng(e),o="",r.properties&&r.properties.name&&(o=r.properties.name),n.addMarker(e,o))})},isRouteWaypoint:function(r){r=r.properties;if(r&&r.type){r=r.type;if("from"===r||"via"===r||"to"===r)return!0}return!1},isPoiPoint:function(r){return"Point"===turf.getType(r)&&!BR.Track.isRouteWaypoint(r)}};
BR.TrackEdges=L.Class.extend({statics:{getFeature:function(e){return{cost:{perKm:parseInt(e[4]),elev:parseInt(e[5]),turn:parseInt(e[6]),node:parseInt(e[7]),initial:parseInt(e[8])},distance:parseInt(e[3]),wayTags:e[9],nodeTags:e[10]}}},edges:[],initialize:function(e){this.edges=this.getTrackEdges(e)},getTrackEdges:function(e){for(var t,s,n,a,r,g,i,u=0,o=[],c=0;c<e.length;c++){for(t=e[c].feature.properties.messages,n=(s=e[c].getLatLngs()).length,i=0,a=1;a<t.length;a++){for(r=this.getMessageLatLng(t[a]),g=i;g<n&&!r.equals(s[g]);g++);i=(g=g===n?n-1:g)+1,o.push(u+g)}u+=n}return o},getMessageLatLng:function(e){var t=e[0]/1e6,e=e[1]/1e6;return L.latLng(e,t)}});
function _createForOfIteratorHelper(r,t){var e,n,o,a,i="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(i)return n=!(e=!0),{s:function(){i=i.call(r)},n:function(){var r=i.next();return e=r.done,r},e:function(r){n=!0,o=r},f:function(){try{e||null==i.return||i.return()}finally{if(n)throw o}}};if(Array.isArray(r)||(i=_unsupportedIterableToArray(r))||t&&r&&"number"==typeof r.length)return i&&(r=i),a=0,{s:t=function(){},n:function(){return a>=r.length?{done:!0}:{done:!1,value:r[a++]}},e:function(r){throw r},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,t){var e;if(r)return"string"==typeof r?_arrayLikeToArray(r,t):"Map"===(e="Object"===(e=Object.prototype.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:e)||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(r,t):void 0}function _arrayLikeToArray(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}BR.Csv={format:function(r){var t,e="",n=_createForOfIteratorHelper(r.features[0].properties.messages);try{for(n.s();!(t=n.n()).done;)e+=t.value.join("\t")+"\n"}catch(r){n.e(r)}finally{n.f()}return e}};
function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){var t;if(r)return"string"==typeof r?_arrayLikeToArray(r,e):"Map"===(t="Object"===(t=Object.prototype.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var n,o,a,i,l=[],u=!0,s=!1;try{if(a=(t=t.call(r)).next,0===e){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=a.call(t)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(r){s=!0,o=r}finally{try{if(!u&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}function _arrayWithHoles(r){if(Array.isArray(r))return r}BR.Fit={format:function(r){if(null==r||!r.features)return"";var e=r.features[0],t=e.geometry.coordinates,n=t[0],o=t[t.length-1],a=e.properties.times||e.properties.coordTimes||[],i=0,a=a.map(function(r){return r=Math.round(r),1e3*(631065600+(i=r=r<=i?i+1:r))}),l=new FITCourseFile(e.properties.name,a[0],e.properties["total-time"],n,o,e.properties["filtered-ascend"]),u=0,s=[0];l.point(a[0],t[0],t[0][2],0);for(var c,f,y,p,d=1;d<t.length;d++)u+=(c=t[d-1],f=t[d],p=y=void 0,y=(c=_slicedToArray(btools.util.CheapRuler.toIntegerLngLat(c),2))[0],c=c[1],p=(f=_slicedToArray(btools.util.CheapRuler.toIntegerLngLat(f),2))[0],f=f[1],btools.util.CheapRuler.distance(y,c,p,f)),s[d]=u,l.point(a[d],t[d],t[d][2],u);return BR.voiceHints(r,2)._loopHints(function(r,e,t){l.turn(a[r.indexInTrack],t,e.fit,"generic"===e.fit?e.message:void 0,s[r.indexInTrack])}),l.finalize(a[a.length-1])}};
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);r=r.call(t,e||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}BR.Gpx={format:function(t){var i,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"bike";return null!=t&&t.features?(e=new(function(){"use strict";function r(t){var e=this;_classCallCheck(this,r),this.voiceHintsTransform=t,this.comment=(null==t?void 0:t.comment)||"",this.voiceHintsTransform&&Object.keys(this.voiceHintsTransform).forEach(function(t){r.prototype.hasOwnProperty(t)||(e[t]=e.voiceHintsTransform[t])})}return _createClass(r,[{key:"wpt",value:function(t,e,r,n){t=(null==(o=i)?void 0:o.wpt)&&i.wpt(t,e,r,n)||t,e.properties.name&&(t.name=e.properties.name);var o=e.properties.type;return o&&"poi"!==o&&(t.type=o),t}},{key:"trk",value:function(t,e,r){var n;return t=(null==(n=i)?void 0:n.trk)&&i.trk(t,e,r)||t,Object.assign({name:e.properties.name,link:{"@href":location.href,text:BR.conf.appName||"BRouter-Web"}},t)}}]),r}())(i=1<e?BR.voiceHints(t,e,r).getGpxTransform():i),r=togpx(t,{creator:(BR.conf.appName||"BRouter-Web")+" "+BR.version,featureTitle:function(){},featureDescription:function(){},featureCoordTimes:function(){},transform:e}),r='<?xml version="1.0" encoding="UTF-8"?>'+BR.Gpx._statsComment(t)+e.comment+r,BR.Xml.pretty(r)):""},_statsComment:function(t){var e,t=null==(t=t.features)?void 0:t[0].properties;return t?(e="\x3c!--",e=(e=(e=(e+=" track-length = "+t["track-length"])+" filtered ascend = "+t["filtered ascend"])+" plain-ascend = "+t["plain-ascend"])+" cost="+t.cost,t["total-energy"]&&(e+=" energy="+(t["total-energy"]/36e5).toFixed(1)+"kwh"),t["total-time"]&&(e+=" time="+BR.Gpx.formatTime(t["total-time"])),e+" --\x3e"):""},formatTime:function(t){var e=Math.trunc(t/3600),r=Math.trunc((t-3600*e)/60),n="";return 0!=e&&(n+=e+"h "),0!=r&&(n+=r+"m "),0!=(t=t-3600*e-60*r)&&(n+=t+"s"),n}};
BR.Kml={format:function(e){return e.features[0].properties={name:e.features[0].properties.name},BR.Xml.pretty(tokml(e))}};
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,s,a=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw o}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r,n,o,i,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return n=!(r=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return r=t.done,t},e:function(t){n=!0,o=t},f:function(){try{r||null==s.return||s.return()}finally{if(n)throw o}}};if(Array.isArray(t)||(s=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),i=0,{s:e=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var r;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(r="Object"===(r=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);r=r.call(t,e||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(){var t=_createClass(function t(e,r,n,o,i,s){"use strict";_classCallCheck(this,t),this.name=e,this.locus=r,this.orux=n,this.symbol=o,this.fit=i,this.message=s}),o=function(){"use strict";_inherits(n,t);var r=_createSuper(n);function n(t,e){return _classCallCheck(this,n),r.call(this,t.name+e,t.locus+e,t.orux+e,t.symbol+e,t.fit,t.message+e)}return _createClass(n)}(),i=function(){"use strict";_inherits(n,t);var r=_createSuper(n);function n(t,e){return _classCallCheck(this,n),r.call(this,t.name+-e,t.locus+-e,t.orux+e,t.symbol+-e,t.fit,t.message+-e)}return _createClass(n)}(),n=function(){"use strict";function n(t,e,r){_classCallCheck(this,n),this.geoJson=t,this.turnInstructionMode=e,this.transportMode=r,this.track=null==(e=t.features)?void 0:e[0],this.voicehints=null==(r=this.track)||null==(t=r.properties)?void 0:t.voicehints}return _createClass(n,[{key:"getGpxTransform",value:function(){var t={comment:"",trk:function(t,e,r){var n=this._getTrk();return Object.assign(n,t)}.bind(this)};return this._addToTransform(t),t}},{key:"_getDuration",value:function(t){var e,r=this.track.properties.times;return r?(e=r[this.voicehints[t][0]],r[t<this.voicehints.length-1?this.voicehints[t+1][0]:r.length-1]-e):0}},{key:"_loopHints",value:function(t){if(this.voicehints){var e,r=_createForOfIteratorHelper(this.voicehints.entries());try{for(r.s();!(e=r.n()).done;){var n=_slicedToArray(e.value,2),o=n[0],i=n[1],s=_slicedToArray(i,6),a=s[0],u=s[1],c=s[2],l=s[3],f={indexInTrack:a,commandId:u,exitNumber:c,distance:l,angle:s[4],geometry:s[5]},p=(f.time=this._getDuration(o),0<f.time&&(f.speed=l/f.time),this.track.geometry.coordinates[a]),h=this.getCommand(u,c);h?t(f,h,p):console.error("no voicehint command for id: ".concat(u," (").concat(i,")"))}}catch(t){r.e(t)}finally{r.f()}}}},{key:"getCommand",value:function(t,e){var r=n.commands[t];return 13===t?r=new o(r,e):14===t&&(r=new i(r,e)),r}},{key:"_addToTransform",value:function(t){}},{key:"_getTrk",value:function(){return{}}}]),n}(),r=(n.commands={1:new t("C",1,1002,"Straight","straight","straight"),2:new t("TL",4,1e3,"Left","left","left"),3:new t("TSLL",3,1017,"TSLL","slight_left","slight left"),4:new t("TSHL",5,1019,"TSHL","sharp_left","sharp left"),5:new t("TR",7,1001,"Right","right","right"),6:new t("TSLR",6,1016,"TSLR","slight_right","slight right"),7:new t("TSHR",8,1018,"TSHR","sharp_right","sharp right"),8:new t("KL",9,1015,"TSLL","left_fork","keep left"),9:new t("KR",10,1014,"TSLR","right_fork","keep right"),10:new t("TU",13,1003,"TU","u_turn","u-turn"),11:new t("TRU",14,1003,"TU","u_turn","u-turn"),12:new t("OFFR",void 0,void 0,"OFFR","danger",void 0),13:new t("RNDB",26,1008,"RNDB","generic","Take exit "),14:new t("RNLB",26,1008,"RNLB","generic","Take exit "),15:new t("TU",12,1003,"TU","u_turn","u-turn"),16:new t("BL",void 0,void 0,"BL","danger",void 0)},function(){"use strict";_inherits(e,n);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_addToTransform",value:function(t){t.gpx=function(t,e){return this._addWaypoints(t),t}.bind(this)}},{key:"_addWaypoints",value:function(t){var n=this,o=[];this._loopHints(function(t,e,r){t=n._getWpt(t,e,r),e=n._createWpt(r,t);o.push(e)}),(t=t.wpt).unshift.apply(t,o)}},{key:"_createWpt",value:function(t,e){return Object.assign({"@lat":t[1],"@lon":t[0]},e)}},{key:"_getWpt",value:function(t,e,r){return{}}}]),e}()),s=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_getWpt",value:function(t,e,r){var n;return{name:e.message,sym:null==(n=e.symbol)?void 0:n.toLowerCase(),type:e.symbol}}}]),e}(),a=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_getWpt",value:function(t,e,r){r={ele:r[2],extensions:{"om:oruxmapsextensions":{"@xmlns:om":"http://www.oruxmaps.com/oruxmapsextensions/1/0","om:ext":{"@type":"ICON","@subtype":0,_:e.orux}}}};return null==r.ele&&delete r.ele,r}}]),e}(),u=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_addToTransform",value:function(t){t.gpx=function(t,e){return t=Object.assign({"@xmlns":t["@xmlns"],"@xmlns:xsi":t["@xmlns:xsi"],"@xmlns:locus":"http://www.locusmap.eu"},t),this._addWaypoints(t),t}.bind(this)}},{key:"_getWpt",value:function(t,e,r){var n={},t=(n["locus:rteDistance"]=t.distance,0<t.time&&(n["locus:rteTime"]=t.time.toFixed(3),n["locus:rteSpeed"]=t.speed.toFixed(3)),n["locus:rtePointAction"]=e.locus,{ele:r[2],name:e.message,extensions:n});return null==t.ele&&delete t.ele,t}},{key:"_getTrk",value:function(){return{extensions:{"locus:rteComputeType":this._getLocusRouteType(this.transportMode),"locus:rteSimpleRoundabouts":1}}}},{key:"_getLocusRouteType",value:function(t){switch(t){case"car":return 0;case"bike":return 5;default:return 3}}}]),e}(),c=function(){"use strict";_inherits(e,n);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_addToTransform",value:function(t){var i="\n\x3c!-- $transport-mode$".concat(this.transportMode,"$ --\x3e\n\x3c!--          cmd    idx        lon        lat d2next  geometry --\x3e\n\x3c!-- $turn-instruction-start$");this._loopHints(function(t,e,r){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length?arguments[1]:void 0;return new String(t).padStart(e)+";"}var o="",o=(o=(o=(o=(o=(o+=n(e.name,6))+n(t.indexInTrack,6))+n(r[0],10))+n(r[1],10))+n(t.distance,6))+t.geometry;i+="\n     $turn$".concat(o,"$")}),i+="\n    $turn-instruction-end$ --\x3e\n",t.comment=i}}]),e}(),l=function(){"use strict";_inherits(e,n);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_addToTransform",value:function(t){t.gpx=function(t,e){return t["@creator"]="OsmAndRouter",t.rte.push({rtept:this._createRoutePoints(t)}),t}.bind(this)}},{key:"_createRoutePoints",value:function(t){var n=[],t=t.trk[0].trkseg[0],e={"@lat":(o=t.trkpt[0])["@lat"],"@lon":o["@lon"],desc:"start"},r=null==(r=this.track)||null==(r=r.properties)?void 0:r.times,r=(this.voicehints&&r&&(r=r[this.voicehints[0][0]],e.extensions={time:Math.round(r),offset:0}),n.push(e),this._loopHints(function(t,e,r){r={"@lat":r[1],"@lon":r[0],desc:e.message,extensions:{time:Math.round(t.time),turn:e.name,"turn-angle":t.angle,offset:t.indexInTrack}};0===t.time&&delete properties.extensions.time,n.push(r)}),t.trkpt.length-1),o=t.trkpt[r];return n.push({"@lat":o["@lat"],"@lon":o["@lon"],desc:"destination",extensions:{time:0,offset:r}}),n}}]),e}();BR.voiceHints=function(t,e,r){switch(e){case 2:return new u(t,e,r);case 3:return new l(t,e,r);case 4:return new c(t,e,r);case 5:return new s(t,e,r);case 6:return new a(t,e,r);case 7:return new u(t,e,r);default:return console.error("unhandled turnInstructionMode: "+e),new n(t,e,r)}}}();
function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var n,a,o,i,l=[],u=!0,c=!1;try{if(o=(t=t.call(r)).next,0===e){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=o.call(t)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(r){c=!0,a=r}finally{try{if(!u&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _createForOfIteratorHelper(r,e){var t,n,a,o,i="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(i)return n=!(t=!0),{s:function(){i=i.call(r)},n:function(){var r=i.next();return t=r.done,r},e:function(r){n=!0,a=r},f:function(){try{t||null==i.return||i.return()}finally{if(n)throw a}}};if(Array.isArray(r)||(i=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length)return i&&(r=i),o=0,{s:e=function(){},n:function(){return o>=r.length?{done:!0}:{done:!1,value:r[o++]}},e:function(r){throw r},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){var t;if(r)return"string"==typeof r?_arrayLikeToArray(r,e):"Map"===(t="Object"===(t=Object.prototype.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}BR.Xml={pretty:function(r){for(var e,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=" ".repeat(t),a="\n",o=(r=(r=r.replace(/>\s*(\r\n|\n|\r)\s*</gm,"><").replace(/>\s+</g,"><")).replace("<metadata/>",""),/><(\/?)([\w!?][^ />]*)/g),i=["trkpt","wpt"],l=[],u=null,c=0;null!==(e=o.exec(r));){var f,y=e[2];u?u===y&&(u=null):(i.includes(y)&&(f=r.indexOf(">",e.index+1),"/"!==r.charAt(f-1))&&(u=y),f=e.index+1,l.push(r.substring(c,f)),c=f)}l.push(r.substring(c));var s,p=/.+<\/\w[^>]*>$/,d=/^<\/\w/,b=/^<\w[^>]*[^\/]>.*$/,h=0,m=_createForOfIteratorHelper((l=l.map(function(r,e){var t=0;return r.match(p)?t=0:r.match(d)&&0<h?--h:t=r.match(b)?1:0,h+=t,n.repeat(h-t)+r})).entries());try{for(m.s();!(s=m.n()).done;){var v=_slicedToArray(s.value,2),A=v[0],g=v[1];if(g.includes("<gpx ")&&!g.includes(a)){l[A]=g.replace(/ (\w[^=" ]*=")/g," ".concat(a).concat(n,"$1"));break}}}catch(r){m.e(r)}finally{m.f()}return l.join(a)}};
BR.BingLayer=L.BingLayer.extend({options:{maxZoom:19,attribution:'<a target="_blank" href="https://www.bing.com/maps/">Bing Maps</a> (<a target="_blank" href="https://go.microsoft.com/?linkid=9710837">TOU</a>)'},initialize:function(o,i){L.BingLayer.prototype.initialize.call(this,o,i),this._logo=L.control({position:"bottomleft"}),this._logo.onAdd=function(o){return this._div=L.DomUtil.create("div","bing-logo"),this._div.innerHTML='<img src="https://www.microsoft.com/maps/images/branding/Bing%20logo%20white_50px-19px.png">',this._div}},onAdd:function(o){L.BingLayer.prototype.onAdd.call(this,o),o.addControl(this._logo)},onRemove:function(o){L.BingLayer.prototype.onRemove.call(this,o),o.removeControl(this._logo)}});
BR.CircleGoArea=L.Control.extend({radius:null,circleLayer:null,boundaryLayer:null,maskRenderer:L.svg({padding:2}),countries:null,countriesMask:null,states:null,statesLoading:!1,options:{countriesUrl:BR.conf.countriesUrl||"dist/boundaries/countries.topo.json",statesUrl:BR.conf.statesUrl||"dist/boundaries/germany-states.topo.json",overpassDataUrl:(BR.conf.overpassBaseUrl||"https://overpass-api.de/api/interpreter")+"?data=",shortcut:{draw:{enable:73,disable:27}}},initialize:function(t,e,o,i){this.routing=t,this.nogos=e,this.pois=o,L.setOptions(this,i)},onAdd:function(t){var e=this;return this.map=t,this.circleLayer=L.layerGroup([]).addTo(t),this.drawButton=L.easyButton({states:[{stateName:"activate-circlego",icon:"fa-circle-o",onClick:function(){e.draw(!0)},title:i18next.t("keyboard.generic-shortcut",{action:i18next.t("map.draw-circlego-start"),key:"I"})},{stateName:"deactivate-circlego",icon:"fa-circle-o active",onClick:function(){e.draw(!1)},title:i18next.t("keyboard.generic-shortcut",{action:i18next.t("map.draw-circlego-stop"),key:"$t(keyboard.escape)"})}]}),this.drawButton.disable(),this.once("countries:loaded",function(){this.drawButton.enable(),this.marker&&!this.marker.dragging.enabled()&&this.marker.dragging.enable()},this),this._loadCountries(),t.on("routing:draw-start",function(){e.draw(!1)}),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),new L.DomUtil.create("div")},draw:function(t){this.drawButton.state(t?"deactivate-circlego":"activate-circlego"),t?(this.routing.draw(!1),this.pois.draw(!1),this.map.on("click",this.onMapClick,this),this.countriesMask&&this.map.addLayer(this.countriesMask),this._unlockOutsideArea(),L.DomUtil.addClass(this.map.getContainer(),"circlego-draw-enabled")):(this.map.off("click",this.onMapClick,this),this.countriesMask&&this.map.hasLayer(this.countriesMask)&&this.map.removeLayer(this.countriesMask),this._lockOutsideArea(),L.DomUtil.removeClass(this.map.getContainer(),"circlego-draw-enabled"))},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(t.keyCode===this.options.shortcut.draw.disable?this.draw(!1):t.keyCode===this.options.shortcut.draw.enable&&this.draw(!0))},_getBoundary:function(o,i,t){i=i||8;var e="[out:json]; is_in("+o[1]+", "+o[0]+')->.a;(area.a[admin_level="'+i+'"];)->.p; relation(pivot.p); out geom;',t=(t&&(e+='(area.a[admin_level="'+t+'"];)->.p; relation(pivot.p); out geom;'),this.options.overpassDataUrl+encodeURIComponent(e));this.marker.setIcon(this.iconSpinner),BR.Util.getJson(t,'boundary for coordinate "'+o+'"',L.bind(function(t,e){if(!t){if(0===e.elements.length)return void(8===i||7===i?this._getBoundary(o,6):BR.message.showError('No boundary found for coordinate "'+o+'"'));t=osmtogeojson(e);this._setBoundary(t)}this.marker.setIcon(this.icon)},this))},_setBoundary:function(t){t.features=t.features.filter(function(t){return"Point"!==t.geometry.type});var e=turf.polygonToLine(t.features[0]),e=(this.boundaryLayer=L.geoJson(e,{style:function(t){return{weight:1,color:"black",opacity:.6,interactive:!1}}}).addTo(this.map),turf.buffer(t,this.radius,{units:"meters"})),t=turf.polygonToLine(e.features[0]),e=("FeatureCollection"!==t.type&&(t=turf.featureCollection([t])),turf.lineChunk(t,62,{units:"kilometers"}));this._setNogo(e),this.setOutsideArea(t)},_getPolygonForPoint:function(t,e){for(var o=null,i=turf.point(t),n=e.features,s=0;s<n.length;s++){var r=n[s];if(turf.booleanPointInPolygon(i,r)){o=r;break}}return o},_getState:function(t){return this._getPolygonForPoint(t,this.states)},_getCountry:function(t){return this._getPolygonForPoint(t,this.countries)},_applyStateRules:function(t){var e,o=this._getState(t);o?(e=o.properties.all_tags.ref,-1!==["MV","NDS","SL","SN"].indexOf(e)?this._setNogoCircle(t):"ST"===e?this._getBoundary(t,7,8):"BB"===e?this._getBoundary(t,6):"HH"===e||-62422===o.properties.id?this._setBoundary(turf.featureCollection([o])):(console.error("unhandled state: "+e+", id: "+o.properties.id),this._getBoundary(t))):this._getBoundary(t)},_applyCountryRules:function(t){var e=this._getCountry(t);e?"Germany"===(e=e.properties.name)?(this.radius=15e3,this.states?this._applyStateRules(t):(this.marker.setIcon(this.iconSpinner),this.once("states:loaded",function(){this.marker.setIcon(this.icon),this.states&&this._applyStateRules(t)},this),this._loadStates())):"Metropolitan France"===e?(this.radius=1e4,this._setNogoCircle(t)):(console.error("unhandled country: "+e),this.radius=null):this.radius=null},_logStates:function(t){for(var e=0;e<t.features.length;e++){var o=t.features[e];console.log(o.properties.all_tags.ref+", "+o.properties.all_tags.name+", "+o.properties.id)}},_addGeoJsonLayer:function(t,e){setTimeout(L.bind(function(){L.geoJson(t,{style:function(t){return L.extend({weight:1,color:"navy",opacity:.8,fill:!1,interactive:!1},e)}}).addTo(this.map)},this),100)},_loadStates:function(){this.statesLoading||(this.statesLoading=!0,BR.Util.getGeoJson(this.options.statesUrl,"states",L.bind(function(t,e){t||(this.states=e),this.statesLoading=!1,this.fire("states:loaded")},this)))},_loadCountries:function(){BR.Util.getJson(this.options.countriesUrl,"countries",L.bind(function(t,e){t||(t=Object.keys(e.objects)[0],this.countries=topojson.feature(e,e.objects[t]),e=topojson.merge(e,[e.objects[t]]),this.countriesMask=L.geoJson(e,{renderer:this.maskRenderer,invert:!0,style:function(t){return{weight:1,color:"darkgreen",opacity:.8,fillColor:"#020",fillOpacity:.2,className:"circlego-outside"}}}),this.countriesMask.on("click",L.DomEvent.stop),this.countriesMask.bindTooltip(i18next.t("map.not-applicable-here"),{sticky:!0,offset:[10,0],direction:"right",opacity:.8}),this.fire("countries:loaded"))},this))},_setNogo:function(t){this.nogoPolylines=L.geoJson(t,BR.NogoAreas.prototype.polylineOptions),this.nogos.addNogos(null,this.nogoPolylines.getLayers(),null)},_removeNogo:function(){this.nogoPolylines&&(this.nogos.removeNogos(null,this.nogoPolylines.getLayers(),null),this.nogoPolylines=null)},_setNogoCircle:function(t){t=this.circleToPolygon(t,this.radius);this._setNogo(t),this.setOutsideArea(t)},setNogoRing:function(t){this._clearLayers(),this._removeNogo(),t&&(this.countries?this._applyCountryRules(t):(this.marker.setIcon(this.iconSpinner),this.once("countries:loaded",function(){this.marker.setIcon(this.icon),this._applyCountryRules(t)},this)))},_lockOutsideArea:function(){this.outsideArea&&(this.outsideArea.eachLayer(function(t){t._path.classList.add("circlego-outside")}),this.outsideArea.on("click",L.DomEvent.stop))},_unlockOutsideArea:function(){this.outsideArea&&(this.outsideArea.eachLayer(function(t){t._path.classList.remove("circlego-outside")}),this.outsideArea.off("click",L.DomEvent.stop))},setOutsideArea:function(t){t=turf.mask(turf.polygonize(t));this.outsideArea=L.geoJson(t,{renderer:this.maskRenderer,style:function(t){return{weight:4,color:"black",opacity:.4,fillColor:"black",fillOpacity:.4}},smoothFactor:.5}).addTo(this.map),this._lockOutsideArea()},onMapClick:function(t){this.setCircle([t.latlng.lng,t.latlng.lat])},setOptions:function(t){this.radius=t.circlego[2],t.polylines&&(this.nogoPolylines=L.featureGroup(t.polylines,BR.NogoAreas.prototype.polylineOptions)),this.setCircle([t.circlego[0],t.circlego[1]],t.polylines)},setCircle:function(t,e){var o=this.marker=this._createMarker(t);if(this.clear(),o.addTo(this.circleLayer),this.countries||o.dragging.disable(),e){for(var i=[],n=0;n<e.length;n++)i.push(e[n].toGeoJSON());o=turf.featureCollection(i);this.setOutsideArea(o)}else this.setNogoRing(t);this.draw(!1)},_createMarker:function(t){var e=this,o=this.icon=L.VectorMarkers.icon({icon:"home",markerColor:BR.conf.markerColors.circlego}),i=(this.iconSpinner=L.VectorMarkers.icon({icon:"spinner",spin:!0,markerColor:BR.conf.markerColors.circlego}),'<button id="remove-ringgo-marker" class="btn btn-secondary"><i class="fa fa-trash"></i></button>'),n=L.marker([t[1],t[0]],{icon:o,draggable:!0,zIndexOffset:-500}).bindPopup(i).on("dragend",function(t){e.setNogoRing([t.target.getLatLng().lng,t.target.getLatLng().lat])}).on("click",function(){"deactivate-circlego"==e.drawButton.state()&&(e.circleLayer.removeLayer(n),e.setNogoRing(void 0))}).on("popupopen",function(t){this._onPopupOpen(t.popup,i)},this).on("popupclose",this._onPopupClose,this);return n},_onPopupOpen:function(t,e){var o,i="",n="<p>";this.radius?(this.boundaryLayer&&(i+=(o=this.boundaryLayer.getLayers()[0].feature.properties.name)+" + ",n+=BR.Util.sanitizeHTMLContent(o)+"<br />+ "),i+=(o=(this.radius/1e3).toFixed())+" km",n+=o+"&#8239;km",this.nogoPolylines&&(n=(n=(n+="</p><p>")+'<a id="ringgo-download-gpx" href="javascript:;" download="radius.gpx">'+i18next.t("export.format_gpx")+"</a><br />")+'<a id="ringgo-download-geojson" href="javascript:;" download="radius.geojson">'+i18next.t("export.format_geojson")+"</a>")):n+=i18next.t("map.not-applicable-here"),t.setContent((n+="</p>")+e),this.nogoPolylines&&(o=location.href.replace(/&polylines=[^&]*/,""),t=this.nogoPolylines.toGeoJSON(),n=togpx(t,{metadata:{name:i,link:o}}),this._setDownloadUrl(n,"application/gpx+xml","ringgo-download-gpx"),this._setDownloadUrl(JSON.stringify(t,null,2),"application/vnd.geo+json","ringgo-download-geojson")),$("#remove-ringgo-marker").on("click",L.bind(function(t){t.preventDefault(),this.circleLayer.removeLayer(this.marker),this.setNogoRing(void 0)},this))},_onPopupClose:function(t){this._revokeDownloadUrl("ringgo-download-gpx"),this._revokeDownloadUrl("ringgo-download-geojson")},_setDownloadUrl:function(t,e,o){t=new Blob([t],{type:e+";charset=utf-8"}),e=URL.createObjectURL(t);document.getElementById(o).href=e},_revokeDownloadUrl:function(t){t=document.getElementById(t);t&&URL.revokeObjectURL(t.href)},_clearLayers:function(){this.outsideArea&&(this.map.removeLayer(this.outsideArea),this.outsideArea=null),this.boundaryLayer&&(this.map.removeLayer(this.boundaryLayer),this.boundaryLayer=null)},clear:function(){this.circleLayer.clearLayers(),this._clearLayers()},getButton:function(){return this.drawButton},getCircle:function(){var t=this.circleLayer.getLayers().map(function(t){return t.getLatLng()});return t&&t.length?[t[0].lng.toFixed(6),t[0].lat.toFixed(6),this.radius].join(","):null},toRadians:function(t){return t*Math.PI/180},toDegrees:function(t){return 180*t/Math.PI},offset:function(t,e,o){var i=this.toRadians(t[0]),t=this.toRadians(t[1]),e=e/6378137,n=Math.asin(Math.sin(t)*Math.cos(e)+Math.cos(t)*Math.sin(e)*Math.cos(o)),i=i+Math.atan2(Math.sin(o)*Math.sin(e)*Math.cos(t),Math.cos(e)-Math.sin(t)*Math.sin(n));return[this.toDegrees(i),this.toDegrees(n)]},circleToPolygon:function(t,e,o){for(var i=o||64,n=[],s=0;s<i;++s)n.push(this.offset(t,e,2*Math.PI*-s/i));return n.push(n[0]),{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:n.slice(i/2)}},{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:n.slice(0,i/2+1)}}]}}}),BR.CircleGoArea.include(L.Evented.prototype),BR.circleGoArea=function(t,e,o){return new BR.CircleGoArea(t,e,o)};
BR.Heightgraph=function(t,e,o,i){return new(Heightgraph=L.Control.Heightgraph.extend({options:{width:$("#map").outerWidth(),margins:{top:15,right:30,bottom:30,left:70},expandControls:!1,mappings:{gradient:{"-16":{text:"< -15%",color:"#81A850"},"-15":{text:"-15%",color:"#89AA55"},"-14":{text:"-14%",color:"#91AD59"},"-13":{text:"-13%",color:"#99AF5E"},"-12":{text:"-12%",color:"#A1B162"},"-11":{text:"-11%",color:"#A8B367"},"-10":{text:"-10%",color:"#B0B66B"},"-9":{text:"-9%",color:"#B8B870"},"-8":{text:"-8%",color:"#C0BA75"},"-7":{text:"-7%",color:"#C8BC79"},"-6":{text:"-6%",color:"#D0BF7E"},"-5":{text:"-5%",color:"#D8C182"},"-4":{text:"-4%",color:"#E0C387"},"-3":{text:"-3%",color:"#E7C58B"},"-2":{text:"-2%",color:"#EFC890"},"-1":{text:"-1%",color:"#F7CA94"},0:{text:"0%",color:"#FFCC99"},1:{text:"1%",color:"#FCC695"},2:{text:"2%",color:"#FAC090"},3:{text:"3%",color:"#F7BA8C"},4:{text:"4%",color:"#F5B588"},5:{text:"5%",color:"#F2AF83"},6:{text:"6%",color:"#F0A97F"},7:{text:"7%",color:"#EDA37A"},8:{text:"8%",color:"#EB9D76"},9:{text:"9%",color:"#E89772"},10:{text:"10%",color:"#E5916D"},11:{text:"11%",color:"#E38B69"},12:{text:"12%",color:"#E08665"},13:{text:"13%",color:"#DE8060"},14:{text:"14%",color:"#DB7A5C"},15:{text:"15%",color:"#D97457"},16:{text:"> 15%",color:"#D66E53"}}},shortcut:{toggle:69}},addBelow:function(t){this.options.width=$("#content").outerWidth(),null!=this.getContainer()&&this.remove(t),this.addTo(t),e=this.getContainer(),document.getElementById("elevation-chart").appendChild(e),this._mouseMoveHandlerBound=this.mapMousemoveHandler.bind(this),this._mouseoutHandlerBound=this._mouseoutHandler.bind(this),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),this.initCollapse(t);var e,o=this,i=$("#elevation-chart");$(window).resize(function(){i.is(":visible")&&o.resize({width:i.width(),height:i.height()})}),i.on("shown.bs.collapse",function(){o.resize({width:i.width(),height:i.height()})}),this.update()},initCollapse:function(t){var e=this;$("#elevation-chart").on("hidden.bs.collapse",function(){$("#elevation-btn").removeClass("active"),t._onResize(),this.id&&BR.Util.localStorageAvailable()&&!e.shouldRestoreChart&&localStorage.removeItem(this.id)}).on("shown.bs.collapse",function(){$("#elevation-btn").addClass("active"),this.id&&BR.Util.localStorageAvailable()&&(localStorage[this.id]="true")}).each(function(){this.id&&BR.Util.localStorageAvailable()&&"true"===localStorage[this.id]&&(e.shouldRestoreChart=!0)})},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.toggle&&$("#elevation-btn").click()},update:function(t,e){var o;this._mouseHeightFocus&&(o=this._mouseHeightFocus._groups[0][0].parentNode).parentNode.appendChild(o),t&&0<t.getLatLngs().length?(0==t.getLatLngs().filter(function(t){return void 0!==t.alt}).length?$("#no-elevation-data").show():$("#no-elevation-data").hide(),o=geoDataExchange.buildGeojsonFeatures(t.getLatLngs(),{interpolate:!1,normalize:!1}),this.addData(o),e&&(e.on("mousemove",this._mouseMoveHandlerBound),e.on("mouseout",this._mouseoutHandlerBound)),!0===this.shouldRestoreChart&&$("#elevation-chart").collapse("show"),this.shouldRestoreChart=void 0):(this._removeMarkedSegmentsOnMap(),this._resetDrag(),this.addData([]),e&&(e.off("mousemove",this._mouseMoveHandlerBound),e.off("mouseout",this._mouseoutHandlerBound)),$("#elevation-chart").hasClass("show")&&(this.shouldRestoreChart=!0),$("#elevation-chart").collapse("hide"))},_createLegend:function(){if(0<this._categories.length){var t=16,e=-16;for(key in this._categories[this.options.selectedAttributeIdx].legend){var o=parseInt(key);o<t&&(t=o),e<o&&(e=o)}for(var i=[{type:-16,text:this.options.mappings.gradient[-16].text,color:this.options.mappings.gradient[-16].color},{type:-10,text:this.options.mappings.gradient[-10].text,color:this.options.mappings.gradient[-10].color},{type:-5,text:this.options.mappings.gradient[-5].text,color:this.options.mappings.gradient[-5].color},{type:0,text:this.options.mappings.gradient[0].text,color:this.options.mappings.gradient[0].color},{type:5,text:this.options.mappings.gradient[5].text,color:this.options.mappings.gradient[5].color},{type:10,text:this.options.mappings.gradient[10].text,color:this.options.mappings.gradient[10].color},{type:16,text:this.options.mappings.gradient[16].text,color:this.options.mappings.gradient[16].color}],n=0;n<i.length;n++)if(i[n].type>t){i.splice(0,n-1);break}for(n=i.length-1;-1<n;n--)if(i[n].type<e){i.splice(n+2);break}this._categories[this.options.selectedAttributeIdx].legend=i}var s=document.querySelector(".legend-container"),r=(null!==s&&s.remove(),L.DomUtil.create("div","legend-container",this._container));r.style.setProperty("position","absolute"),r.style.setProperty("margin-left","65px"),r.style.setProperty("margin-top","-18px"),L.DomUtil.create("span","legend-hover legend-text",r).textContent=this._getTranslation("legend")+":",this._categories[this.options.selectedAttributeIdx].legend.forEach(function(t){var e=L.DomUtil.create("span","legend-rect",r);e.style.setProperty("padding-left","10px"),e.style.setProperty("padding-right","3px"),e.style.setProperty("width","6px"),e.style.setProperty("height","6px"),e.style.setProperty("color",t.color),e.innerHTML="&#9632;",L.DomUtil.create("span","legend-text",r).textContent=t.text})}}))};
BR.NogoAreas=L.Control.extend({options:{shortcut:{draw:{enable:78,disable:27},import:78}},statics:{MSG_BUTTON:"Draw no-go area (circle)",MSG_BUTTON_CANCEL:"Cancel drawing no-go area",MSG_CREATE:"Click and drag to draw circle",MSG_DISABLED:"Click to edit",MSG_ENABLED:'&square; = move / resize, <span class="fa fa-trash-o"></span> = delete,<br>click nogo to quit editing',STATE_CREATE:"no-go-create",STATE_CANCEL:"cancel-no-go-create"},style:{color:"#f06eaa",weight:4,opacity:.5,fillColor:null,fillOpacity:.2,dashArray:null},editStyle:{color:"#fe57a1",opacity:.6,dashArray:"10, 10",fillOpacity:.1},polylineOptions:{smoothFactor:.5},initialize:function(){this._wasRouteDrawing=!1},onAdd:function(t){var o=this,i=($("#submitNogos").on("click",L.bind(this.uploadNogos,this)),this.drawnItems=(new L.FeatureGroup).addTo(t),this.drawnItems.on("click",function(t){L.DomEvent.stop(t),t.layer.toggleEdit()}),this.editTools=t.editTools=new BR.Editable(t,{circleEditorClass:BR.DeletableCircleEditor,editLayer:(new L.FeatureGroup).addTo(t),featuresLayer:this.drawnItems}));return this.startDrawing=function(t){var e=L.extend({radius:0},o.style);i.startCircle(null,e),t.state("cancel-no-go-create")},this.stopDrawing=function(t){i.stopDrawing(),t.state("no-go-create")},this.button=L.easyButton({states:[{stateName:BR.NogoAreas.STATE_CREATE,icon:"fa-ban",title:BR.NogoAreas.MSG_BUTTON,onClick:this.startDrawing},{stateName:BR.NogoAreas.STATE_CANCEL,icon:"fa-ban active",title:BR.NogoAreas.MSG_BUTTON_CANCEL,onClick:this.stopDrawing}]}),L.DomEvent.addListener(this.button.button,"pointerdown",L.DomEvent.stop),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),L.DomUtil.get("nogoFile").onchange=L.bind(this.onFileChanged,this),this.editTools.on("editable:drawing:end",function(t){o.button.state(BR.NogoAreas.STATE_CREATE),setTimeout(L.bind(function(){t.layer.disableEdit()},this),0)},this),this.editTools.on("editable:vertex:dragend editable:vertex:deleted editable:deleted",function(t){this._fireUpdate()},this),this.editTools.on("editable:enable",function(t){t.layer.setStyle(this.editStyle)},this),this.editTools.on("editable:disable",function(t){t.layer.setStyle(this.style)},this),this.tooltip=new BR.EditingTooltip(t,i,this.button),this.tooltip.enable(),L.DomUtil.create("div")},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(!0===t.shiftKey&&t.keyCode===this.options.shortcut.import?$("#loadNogos").modal("show"):t.keyCode===this.options.shortcut.draw.disable&&this.button.state()===BR.NogoAreas.STATE_CANCEL?this.stopDrawing(this.button):t.keyCode===this.options.shortcut.draw.enable&&this.button.state()===BR.NogoAreas.STATE_CREATE&&this.startDrawing(this.button))},displayUploadError:function(t){$("#nogoError").text(t||""),$("#nogoError").css("display",t?"block":"none")},onFileChanged:function(t){t.target.files[0]&&$(t.target).next("label").text(t.target.files[0].name)},uploadNogos:function(){var t,i=this,e=$("#nogoJSON").val(),o=$("#nogoURL").val(),n=$("#nogoFile")[0].files[0];if(e)t=Promise.resolve(JSON.parse(e)),$("#nogoJSON").val(void 0);else if(o)t=fetch(o).then(function(t){return t.json()});else{if(!n)return i.displayUploadError(i18next.t("loadNogos.error.missing-file-url")),!1;t=new Promise(function(t,e){var o=new FileReader;o.onload=function(){t(o.result)},o.onerror=function(){i.displayUploadError(i18next.t("loadNogos.error.loading-file-error",{err:o.error.message}))},o.readAsText(n)}).then(function(t){return JSON.parse(t)})}var a,s,r=parseFloat($("#nogoWeight").val());return isNaN(r)?i.displayUploadError(i18next.t("loadNogos.error.missing-default-nogo-weight")):(a=parseFloat($("#nogoRadius").val()),isNaN(a)||a<0?i.displayUploadError(i18next.t("loadNogos.error.invalid-default-nogo-radius")):(s=parseFloat($("#nogoBuffer").val()),isNaN(s)?i.displayUploadError(i18next.t("loadNogos.error.invalid-nogo-buffering-radius")):t.then(function(t){var o=[];if(turf.flattenEach(t,function(t){var e;turf.getGeom(t)&&(e=t,0!==s&&(e=turf.buffer(t,s,{units:"meters"})),o.push(e))}),0===o.length)return i.displayUploadError(i18next.t("loadNogos.error.no-valid-area")),!1;var t=L.geoJson(turf.featureCollection(o),{onEachFeature:function(t,e){e.options.nogoWeight=t.properties.nogoWeight||r,"LineString"===t.geometry.type&&L.setOptions(e,i.polylineOptions)}}),e=t.getLayers().filter(function(t){return"Point"===t.feature.geometry.type});e=(e=e.map(function(t){var e=t.feature.properties.radius||a;return 0<e?L.circle(t.getLatLng(),{radius:e}):null})).filter(function(t){return t});try{i.setOptions({nogos:e,polygons:t.getLayers().filter(function(t){return"Polygon"===t.feature.geometry.type}),polylines:t.getLayers().filter(function(t){return"LineString"===t.feature.geometry.type})}),i._fireUpdate(),i.displayUploadError(void 0),$("#loadNogos").modal("hide")}catch(t){"NS_ERROR_MALFORMED_URI"===t.name?i.displayUploadError(i18next.t("loadNogos.error.loading-file-too-big")):i.displayUploadError(i18next.t("loadNogos.error.loading-file-unexpected")),i.fire("update",{options:{nogos:[],polygons:[],polylines:[]}}),i._clear()}}))),!1},preventRoutePointOnCreate:function(e){this.editTools.on("editable:drawing:start",function(t){this._wasRouteDrawing=e.isDrawing(),e.draw(!1)},this),this.editTools.on("editable:drawing:end",function(t){this._wasRouteDrawing&&setTimeout(function(){e.draw(!0)},0)},this)},getOptions:function(){return{nogos:this.drawnItems.getLayers().filter(function(t){return t instanceof L.Circle}),polygons:this.drawnItems.getLayers().filter(function(t){return t instanceof L.Polygon}),polylines:this.drawnItems.getLayers().filter(function(t){return t instanceof L.Polyline&&!(t instanceof L.Polygon)})}},setOptions:function(t){var e=t.nogos,o=t.polylines,t=t.polygons;this._clear(),this._addNogos(e,o,t)},addNogos:function(t,e,o){this._addNogos(t,e,o),this._fireUpdate()},_addNogos:function(t,e,o){if(t)for(var i=0;i<t.length;i++)t[i].setStyle(this.style),this.drawnItems.addLayer(t[i]);if(e)for(i=0;i<e.length;i++)e[i].setStyle(this.style),this.drawnItems.addLayer(e[i]);if(o)for(i=0;i<o.length;i++)o[i].setStyle(this.style),this.drawnItems.addLayer(o[i])},removeNogos:function(t,e,o){if(t)for(var i=0;i<t.length;i++)this.drawnItems.removeLayer(t[i]);if(e)for(i=0;i<e.length;i++)this.drawnItems.removeLayer(e[i]);if(o)for(i=0;i<o.length;i++)this.drawnItems.removeLayer(o[i]);this._fireUpdate()},_clear:function(){this.drawnItems.clearLayers()},clear:function(){this._clear(),this._fireUpdate()},_fireUpdate:function(){this.fire("update",{options:this.getOptions()})},getFeatureGroup:function(){return this.drawnItems},getEditGroup:function(){return this.editTools.editLayer},getButton:function(){return this.button}}),BR.NogoAreas.include(L.Evented.prototype),BR.Editable=L.Editable.extend({initialize:function(t,e){L.Editable.prototype.initialize.call(this,t,e),this.map.tap||(this.map.addHandler("tap",L.Map.Tap),this.map.tap.disable())},registerForDrawing:function(t){this._tapEnabled=this.map.tap.enabled(),this._tapEnabled||this.map.tap.enable(),L.Editable.prototype.registerForDrawing.call(this,t)},unregisterForDrawing:function(t){this._tapEnabled||this.map.tap.disable(),L.Editable.prototype.unregisterForDrawing.call(this,t)},createVertexIcon:function(t){return new(BR.Browser.touch?L.Editable.TouchVertexIcon:L.Editable.VertexIcon)(t)}}),BR.EditingTooltip=L.Handler.extend({options:{closeTimeout:2e3},initialize:function(t,e,o){this.map=t,this.editTools=e,this.button=o},addHooks:function(){L.DomEvent.addListener(this.button.button,"click",this._addCreate,this),this.editTools.featuresLayer.on("layeradd",this._bind,this),this.editTools.on("editable:drawing:end",this._postCreate,this),this.editTools.on("editable:enable",this._enable,this),this.editTools.on("editable:disable",this._disable,this)},removeHooks:function(){L.DomEvent.removeListener(this.button.button,"click",this._addCreate,this),this.editTools.featuresLayer.off("layeradd",this._bind,this),this.editTools.off("editable:drawing:end",this._postCreate,this),this.editTools.off("editable:enable",this._enable,this),this.editTools.off("editable:disable",this._disable,this)},_bind:function(t){t=t.layer;t.bindTooltip(BR.NogoAreas.MSG_DISABLED,{direction:"bottom",className:"editing-tooltip"}),t.openTooltip=function(t,e){!e&&t instanceof L.Layer&&(e=L.latLng(t.getBounds().getSouth(),.5*(t.getBounds().getWest()+t.getBounds().getEast()))),L.Layer.prototype.openTooltip.call(this,t,e)}},_addCreate:function(t){var e,o;this.editTools.drawing()&&(t=this.map.mouseEventToLatLng(t),(e=L.tooltip({sticky:!0,direction:"right",offset:L.point(5,28),className:"editing-tooltip-create"}))._tooltip=e,o=function(t){t="tooltipclose"===t.type?"off":"on";this._map[t]("mousemove",this._moveTooltip,this)},this.map.on("tooltipopen",o,e),this.map.on("tooltipclose",o,e),this.map.on("tooltipclose",function t(e){this.map.off("tooltipopen",o,e.tooltip),this.map.off("tooltipclose",o,e.tooltip),this.map.off("tooltipclose",t,this),e.tooltip._tooltip=null},this),e.setTooltipContent(BR.NogoAreas.MSG_CREATE),this.map.openTooltip(e,t),this.editTools.once("editable:editing editable:drawing:cancel",t=function(){this.map.closeTooltip(e)},this),BR.Browser.touch)&&setTimeout(L.bind(t,this),this.options.closeTimeout)},_setCloseTimeout:function(t){var e=setTimeout(function(){t.closeTooltip()},this.options.closeTimeout);t.once("tooltipopen",function(t){clearTimeout(e)})},_postCreate:function(){this.editTools.once("editable:disable",function(t){t.layer.openTooltip(t.layer),this._setCloseTimeout(t.layer)},this)},_enable:function(t){t.layer.setTooltipContent(BR.NogoAreas.MSG_ENABLED),this.editTools.once("editable:editing",function(t){t.layer.closeTooltip()},this)},_disable:function(t){t.layer.setTooltipContent(BR.NogoAreas.MSG_DISABLED),this._setCloseTimeout(t.layer)}}),BR.DeletableCircleEditor=L.Editable.CircleEditor.extend({_computeDeleteLatLng:function(){var t=(this.feature._radius||this.feature._mRadius)*Math.cos(Math.PI/4),e=this.map.project(this.feature._latlng);return this.map.unproject([e.x-t,e.y-t])},_updateDeleteLatLng:function(){this._deleteLatLng.update(this._computeDeleteLatLng()),this._deleteLatLng.__vertex.update()},_addDeleteMarker:function(){if(this.enabled())return this._deleteLatLng=this._computeDeleteLatLng(),new BR.DeleteMarker(this._deleteLatLng,this)},_delete:function(){this.disable(),this.tools.featuresLayer.removeLayer(this.feature)},delete:function(){this._delete(),this.fireAndForward("editable:deleted")},initialize:function(t,e,o){L.Editable.CircleEditor.prototype.initialize.call(this,t,e,o),this._deleteLatLng=this._computeDeleteLatLng(),this.editLayer=new L.FeatureGroup},addHooks:function(){return L.Editable.CircleEditor.prototype.addHooks.call(this),this.feature&&this._addDeleteMarker(),this},reset:function(){L.Editable.CircleEditor.prototype.reset.call(this),this._addDeleteMarker()},onDrawingMouseDown:function(t){this._deleteLatLng.update(t.latlng),L.Editable.CircleEditor.prototype.onDrawingMouseDown.call(this,t)},onDrawingMouseUp:function(t){0<this.feature.getRadius()?this.commitDrawing(t):(this.cancelDrawing(t),this._delete()),t.originalEvent._simulated=!1,L.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,t)},onVertexMarkerDrag:function(t){this._updateDeleteLatLng(),L.Editable.CircleEditor.prototype.onVertexMarkerDrag.call(this,t)}}),BR.DeleteMarker=L.Marker.extend({options:{draggable:!1,icon:L.divIcon({iconSize:BR.Browser.touch?new L.Point(24,24):new L.Point(16,16),className:"leaflet-div-icon fa fa-trash-o nogo-delete-marker"})},initialize:function(t,e,o){this.latlng=t,this.editor=e,L.Marker.prototype.initialize.call(this,t,o),(this.latlng.__vertex=this).editor.editLayer.addLayer(this),this.setZIndexOffset(e.tools._lastZIndex)},onAdd:function(t){L.Marker.prototype.onAdd.call(this,t),this.on("click",this.onClick)},onRemove:function(t){delete this.latlng.__vertex,this.off("click",this.onClick),L.Marker.prototype.onRemove.call(this,t)},onClick:function(t){this.editor.delete()}});
BR.PoiMarkers=L.Control.extend({markersLayer:null,circlego:null,options:{shortcut:{draw:{enable:80,disable:27}}},initialize:function(t){this.routing=t,this.circlego=null},onAdd:function(t){var e=this;return this.map=t,this.markersLayer=L.layerGroup([]).addTo(t),this.drawButton=L.easyButton({states:[{stateName:"activate-poi",icon:"fa-hand-o-right",onClick:function(){e.draw(!0)},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.draw-poi-start)",key:"P"})},{stateName:"deactivate-poi",icon:"fa-hand-o-right active",onClick:function(){e.draw(!1)},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.draw-poi-stop)",key:"$t(keyboard.escape)"})}]}),L.easyBar([this.drawButton],{id:"pois-button"}).addTo(t),t.on("routing:draw-start",function(){e.draw(!1)}),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),new L.DomUtil.create("div")},draw:function(t){this.drawButton.state(t?"deactivate-poi":"activate-poi"),t?(this.routing.draw(!1),this.circlego&&this.circlego.draw(!1),this.map.on("click",this.onMapClick,this),L.DomUtil.addClass(this.map.getContainer(),"pois-draw-enabled")):(this.map.off("click",this.onMapClick,this),L.DomUtil.removeClass(this.map.getContainer(),"pois-draw-enabled"))},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(t.keyCode===this.options.shortcut.draw.disable?this.draw(!1):t.keyCode===this.options.shortcut.draw.enable&&this.draw(!0))},onMapClick:function(e){var a=this;bootbox.prompt({title:i18next.t("map.enter-poi-name"),required:!BR.Browser.download,callback:function(t){null!==t&&a.addMarker(e.latlng,t)}})},addMarker:function(t,e){var a=L.VectorMarkers.icon({icon:"star",markerColor:BR.conf.markerColors.poi}),o=BR.Util.sanitizeHTMLContent(e),i="<p>"+o+'</p><p><button id="remove-poi-marker" class="btn btn-secondary"><i class="fa fa-trash"></i></button></p>',r=this,n=L.marker(t,{icon:a,draggable:!0,name:e}).bindPopup(i).on("dragend",function(){r.fire("update")}).on("popupopen",function(){this.unbindTooltip(),$("#remove-poi-marker").on("click",function(t){r.markersLayer.removeLayer(n),t.preventDefault(),r.fire("update")})}).on("popupclose",function(){!1===BR.Browser.touch&&this.bindTooltip(o)}).addTo(this.markersLayer);!1===BR.Browser.touch&&n.bindTooltip(o)},clear:function(){this.markersLayer.clearLayers()},setMarkers:function(t){if(this.clear(),t)for(var e=0;e<t.length;e++){var a=t[e];this.addMarker(a.latlng,a.name)}},getMarkers:function(){return this.markersLayer.getLayers().map(function(t){return{latlng:t.getLatLng(),name:t.options.name}})}}),BR.PoiMarkers.include(L.Evented.prototype);
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}BR.routeLoader=function(s,e,a,n){(RouteLoader=L.Control.extend({_layerName:"Tracklayer",_trackLayer:void 0,_bounds:void 0,_testLayer:L.layerGroup().addTo(s),_trackPoints:[],_maxTrackPoints:200,_closeCanceled:!0,_currentGeoJSON:{},_options:{format:void 0,showTrackLayer:!0,showPointAsPoi:!0,simplifyTolerance:-1,isTestMode:!1,simplifyLastKnownGood:.001,shortcut:{open:79}},setDialogDraggable:function(t){t.on("mousedown",function(t){var e=$(this),o=t.pageX-e.offset().left,i=t.pageY-e.offset().top;$("body").on("mousemove.draggable",function(t){e.closest(".modal-dialog").offset({left:t.pageX-o,top:t.pageY-i})}),$("body").one("mouseup",function(){$("body").off("mousemove.draggable")}),e.closest(".modal").one("bs.modal.hide",function(){$("body").off("mousemove.draggable")})})},getSimplifiedCoords:function(t){return turf.simplify(this._trackPoints.geometry,{tolerance:t,highQuality:!0}).coordinates},refreshTestLayer:function(){this.onBusyChanged(!0),this._testLayer.clearLayers();var t=L.GeoJSON.coordsToLatLngs(this.getSimplifiedCoords(this._options.simplifyTolerance));if(t.length>this._maxTrackPoints)return this.onBusyChanged(!1),!1;for(var e=0;e<t.length;e++)this._testLayer.addLayer(L.circleMarker(t[e],{radius:6,fill:!1,color:"#FF0000"}));return this.onBusyChanged(!1),!0},cleanup:function(t){this._testLayer.clearLayers(),this._trackLayer&&s.hasLayer(this._trackLayer)&&(!this._options.showTrackLayer||this._closeCanceled)&&(s.removeLayer(this._trackLayer),e.removeLayer(this._trackLayer),this._trackLayer=void 0),this._bounds=void 0,this._trackPoints=[],this._currentGeoJSON={},this._options={showTrackLayer:!0,showPointAsPoi:!0,simplifyTolerance:-1,isTestMode:!1,simplifyLastKnownGood:.001,shortcut:{open:79}}},setSliderRange:function(){($slider=$("#simplify_tolerance")).prop("min",-500);var t=this.guessSimplifyTolerance(this._trackPoints),e=this.getSimplifiedCoords(t).length;e>this._maxTrackPoints&&(this._maxTrackPoints=e,$slider.prop("min",0)),$slider.data("lastknowngood",0),$slider.data("guess",t.toFixed(20)),$slider.val(0),this._options.simplifyTolerance=t,this.refreshTestLayer()},onToleranceSlider:function(t){var e=parseFloat($(t.target).data("guess")),o=parseFloat(t.target.value),i=parseFloat($(t.target).prop("max"));this._options.simplifyTolerance=e<o?e+Math.pow(o,2)*(e/(Math.pow(i,2)/10)):Math.abs(e+Math.pow(o,3)*(e/Math.pow(i,3))),this.refreshTestLayer()?(this._options.simplifyLastKnownGood=this._options.simplifyTolerance,$(t.target).data("lastknowngood",t.target.value)):(o=this.findLowestTolerance(parseInt(t.target.value),parseInt($(t.target).data("lastknowngood")),e,i),$(t.target).prop("min",o),$(t.target).data("lastknowngood",o),t.target.value=$(t.target).data("lastknowngood"),this._options.simplifyTolerance=this._options.simplifyLastKnownGood=Math.abs(e+Math.pow(o,3)*(e/Math.pow(i,3))),this.refreshTestLayer())},findLowestTolerance:function(t,e,o,i){var s,a;return Math.abs(e-t)<=2?e:(s=Math.round((e+t)/2),a=Math.abs(o+Math.pow(s,3)*(o/Math.pow(i,3))),this.getSimplifiedCoords(a).length>this._maxTrackPoints?this.findLowestTolerance(s,e,o,i):this.findLowestTolerance(t,s,o,i))},onBusyChanged:function(t){!0===(t=void 0===_typeof(t)?!1:t)?$("#loadedittrack #msg_busy").removeClass("invisible"):$("#loadedittrack #msg_busy").addClass("invisible")},onManualCollapse:function(t){$("#loadedittrack").is(":hidden")||(this._options.isTestMode=$(t.target).hasClass("show"),this._options.isTestMode?(this.once("file:loaded",this.setSliderRange,this),this.convertTrackLocal()):this.cleanup())},onAdd:function(t){$("#loadedittrack").on("hidden.bs.modal",function(t){this.cleanup()}.bind(this)),$("#loadedittrack").on("show.bs.modal",function(t){$("#manual_collapse").collapse("hide"),this._closeCanceled=!0}.bind(this)),L.DomUtil.get("submitLoadEditTrack").onclick=L.bind(function(t){t.preventDefault(),this._closeCanceled=!1,this.onBusyChanged(!0),0<this._testLayer.getLayers().length?(this._testLayer.clearLayers(),setTimeout(function(){this.addRoutingPoints(),this.onBusyChanged(!1),$("#loadedittrack").modal("hide")}.bind(this),0)):setTimeout(function(){this.convertTrackLocal(),$("#loadedittrack").modal("hide")}.bind(this),0)},this),L.DomUtil.get("simplify_tolerance").oninput=L.bind(this.onToleranceSlider,this),L.DomUtil.get("loadedittrackFile").onchange=L.bind(this.onFileChanged,this),this.onFileChanged({target:L.DomUtil.get("loadedittrackFile")}),this.setDialogDraggable($("#loadedittrack .modal-header")),$("#manual_collapse").collapse("hide"),$("#manual_collapse").on("hidden.bs.collapse shown.bs.collapse",function(t){this.onManualCollapse(t)}.bind(this)),L.DomEvent.addListener(document,"keydown",this.keydownListener,this);var e=L.DomUtil.create("div");return e.hidden=!0,e},onRemove:function(t){},onFileChanged:function(t){t.target.files[0]&&($(t.target).next("label").text(t.target.files[0].name),t=this._options.isTestMode,this.cleanup(),this._options.isTestMode=t,this._options.isTestMode)&&(this.once("file:loaded",this.setSliderRange,this),this.convertTrackLocal())},setLayerNameFromGeojson:function(t){if("Feature"==t.type&&t.properties&&t.properties.name)this._layerName=t.properties.name;else if("FeatureCollection"==t.type)for(var e=0;e<t.features.length;e++)if(t.features[e].properties&&t.features[e].properties.name)return void(this._layerName=t.features[e].properties.name)},getOptions:function(){this._options.showTrackLayer=$("#cb_showtracklayer")[0].checked,this._options.showPointAsPoi=$("#cb_showpois")[0].checked,this._options.simplifyTolerance=-1,this._bounds=void 0},convertTrackLocal:function(){var t,e;0!=$("#loadedittrackFile")[0].files.length&&(this.onBusyChanged(!0),this.getOptions(),t=$("#loadedittrackFile")[0].files[0],this._layerName=t.name.replace(/\.[^\.]*$/,""),this._options.format||(this._options.format=t.name.split(".").pop()),(e=new FileReader).onload=L.bind(this.processFile,this),e.readAsText(t))},addTrackOverlay:function(t){this._trackLayer=L.geoJSON(t,BR.Track.getGeoJsonOptions(e,!0)).addTo(s),e.addOverlay(this._trackLayer,BR.Util.sanitizeHTMLContent(this._layerName)),this._bounds=this._trackLayer.getBounds(),this._bounds&&s.fitBounds(this._bounds)},getLineStringsFromGeoJSON:function(t){var o=[],t=turf.flatten(t),t=(turf.featureEach(t,function(t,e){"LineString"==turf.getType(t)&&(t=turf.cleanCoords(t),t=turf.coordAll(t),o=o.concat(t))}),turf.lineString(o));return t.length=o.length,t},guessSimplifyTolerance:function(t){t=t.length/1e6;return t=.8<t?.8:t},addRoutingPoints:function(t){this._options.simplifyTolerance<0&&(this._options.simplifyTolerance=this.guessSimplifyTolerance(this._trackPoints));for(var e=[],o=L.GeoJSON.coordsToLatLngs(this.getSimplifiedCoords(this._options.simplifyTolerance)),i=0;i<o.length;i++)e.push(o[i]);0<e.length&&(a.setWaypoints(e,null,function(t){t&&(t=t.error,BR.message.showError(i18next.t("warning.tracks-load-error",{error:t&&t.message?t.message:t})))}),this._bounds||(this._bounds=L.latLngBounds(e))),this._bounds||s.fitBounds(this._bounds),this._options.showPointAsPoi&&BR.Track.addPoiMarkers(n,this._currentGeoJSON)},processFile:function(t){var e=t.target.result,o=null;switch(this._options.format){case"kml":case"gpx":var i=(new DOMParser).parseFromString(e,"text/xml"),o=toGeoJSON[this._options.format](i);break;default:o=JSON.parse(e)}this._currentGeoJSON=o,this.setLayerNameFromGeojson(o),this._trackPoints=this.getLineStringsFromGeoJSON(o);t=turf.length(this._trackPoints,{units:"kilometers"});this._maxTrackPoints=Math.min(t*Math.max(-.14*t+10,1),200),this.fire("file:loaded"),(this._options.showTrackLayer||this._options.isTestMode)&&this.addTrackOverlay(o),this._options.isTestMode||this.addRoutingPoints(),this.onBusyChanged(!1)},keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this._options.shortcut.open&&!0===t.shiftKey&&$("#navbarLoadEditTracks").click()}})).include(L.Evented.prototype);var t=new RouteLoader;return t.addTo(s),t};
function _createForOfIteratorHelper(t,e){var n,i,o,r,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,o=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw o}}};if(Array.isArray(t)||(s=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),r=0,{s:e=function(){},n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var n;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r,s,a=[],l=!0,u=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=r.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(t){u=!0,o=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}L.Routing.Draw.prototype._hideTrailer=function(){0!==this._trailer.options.opacity&&this._trailer.setStyle({opacity:0})},BR.Routing=L.Routing.extend({statics:{hasBeeline:function(t){return 0<(null==t?void 0:t.filter(function(t){return null==t||null==(t=t._routing)?void 0:t.beeline}).length)}},options:{position:"topright",icons:{start:L.VectorMarkers.icon({icon:"play",markerColor:BR.conf.markerColors.start}),normal:L.VectorMarkers.icon({icon:"circle",markerColor:BR.conf.markerColors.via}),end:L.VectorMarkers.icon({icon:"stop",markerColor:BR.conf.markerColors.stop}),draw:!1,opacity:1},snapping:null,zIndexOffset:-2e3,distanceMarkers:{iconSize:[6,18],offset:5e3,textFunction:function(t){return t/1e3}},shortcut:{draw:{enable:68,disable:27,beelineMode:66,beelineModifier:16,beelineModifierName:"shiftKey"},reverse:82,deleteLastPoint:90}},initialize:function(t,e){L.Routing.prototype.initialize.call(this,e),this.profile=t},onAdd:function(t){this.options.tooltips.waypoint=i18next.t("map.route-tooltip-waypoint"),this.options.tooltips.segment=i18next.t("map.route-tooltip-segment"),this._segmentsCasing=(new L.FeatureGroup).addTo(t),this._loadingTrailerGroup=(new L.FeatureGroup).addTo(t);function e(t){this._mouseMarker._feature&&(this._mouseMarker._feature.fire("mouseout",t,!0),this._mouseMarker._feature=null)}var n=L.Routing.prototype.onAdd.call(this,t);this._segments.on("layeradd",this._addSegmentCasing,this),this._segments.on("layerremove",this._removeSegmentCasing,this),this._waypoints.on("layeradd",this._setMarkerOpacity,this),this._routingAll=!1,this.on("routing:rerouteAllSegmentsStart routing:setWaypointsStart",function(t){this._routingAll=!0}),this.on("routing:rerouteAllSegmentsEnd routing:setWaypointsEnd",function(t){this._routingAll=!1}),this.on("routing:routeWaypointStart routing:rerouteAllSegmentsStart routing:rerouteSegmentStart",function(t){this._routingAll&&"routing:rerouteAllSegmentsStart"!==t.type||this._removeDistanceMarkers()}),this.on("routing:routeWaypointEnd routing:setWaypointsEnd routing:rerouteAllSegmentsEnd routing:rerouteSegmentEnd",function(t){this._routingAll&&"routing:rerouteAllSegmentsEnd"!==t.type&&"routing:setWaypointsEnd"!==t.type||this._updateDistanceMarkers(t)}),this.on("waypoint:mouseover",function(t){this._dragging||(this._hideMouseMarker(),this._map.off("mousemove",this._segmentOnMousemove,this),this._suspended=!0)},this._edit),this.on("waypoint:mouseout",function(t){this._segmentOnMouseover(t),this._suspended=!1},this._edit),this._edit._mouseMarker.setIcon(L.divIcon({className:"line-mouse-marker",iconAnchor:[8,8],iconSize:[16,16]})),this._edit._mouseMarker.on("move",L.bind(function(t){var e=t.latlng;e._feature&&(this._mouseMarker._feature=e._feature,e._feature.fire("mousemove",t,!0))},this._edit));function i(){this._hidden&&this._parent._waypoints._first&&this._show()}this._edit.on("segment:mouseout",e,this._edit),this._edit._mouseMarker.on("dragstart",e,this._edit),this.on("waypoint:mouseover",e,this._edit),this._draw.on("enabled",function(){L.DomUtil.addClass(t.getContainer(),"routing-draw-enabled"),this._marker._icon.style.pointerEvents="none",this._parent.off("waypoint:mouseout",this._catchWaypointEvent,this),this.on("waypoint:mouseout",function(t){this._parent._edit._suspended||this._catchWaypointEvent(t)},this)}),this._draw.on("disabled",function(){L.DomUtil.removeClass(t.getContainer(),"routing-draw-enabled")});var o=function(){!this._hidden&&this._parent._waypoints._first&&this._hide()}.bind(this._draw);function r(t){o(),L.DomEvent.stopPropagation(t)}return this._draw.on("enabled",function(){this._map.on("mouseout",o,this),this._map.on("mouseover",i,this),this._parent._segments.on("mouseover",L.DomEvent.stopPropagation,this),this._parent._segments.on("mouseout",L.DomEvent.stopPropagation,this),L.DomEvent.on(this._map._controlContainer,"mouseout",i,this),L.DomEvent.on(this._map._controlContainer,"mouseover",r,this)}),this._draw.on("disabled",function(){this._map.off("mouseout",o,this),this._map.off("mouseover",i,this),this._parent._segments.off("mouseover",L.DomEvent.stopPropagation,this),this._parent._segments.off("mouseout",L.DomEvent.stopPropagation,this),L.DomEvent.off(this._map._controlContainer,"mouseout",i,this),L.DomEvent.off(this._map._controlContainer,"mouseover",r,this)}),this.on("waypoint:click",function(){this._hidden&&!this._parent._waypoints._first&&(this._show(),this._hideTrailer())},this._draw),this._map.boxZoom.disable(),this._map.addHandler("boxZoom",BR.ClickTolerantBoxZoom),this._draw.on("enabled",function(){this._map.boxZoom.tolerant=!0}),this._draw.on("disabled",function(){this._map.boxZoom.tolerant=!1}),L.DomEvent.removeListener(this._container,"keydown",this._keydownListener,this),L.DomEvent.removeListener(this._container,"keyup",this._keyupListener,this),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),L.DomEvent.addListener(document,"keyup",this._keyupListener,this),n},_addSegmentCasing:function(t){var e=Object.assign({},t.layer.options,this.options.styles.trackCasing),e=L.polyline(t.layer.getLatLngs(),Object.assign({},e,{interactive:!1}));this._segmentsCasing.addLayer(e),t.layer._casing=e,this._segments.bringToFront()},_removeSegmentCasing:function(t){this._segmentsCasing.removeLayer(t.layer._casing)},setOpacity:function(e){var t=1-Math.sqrt(1-e);this.options.styles.track.opacity=t,this.options.styles.trackCasing.opacity=t,this.options.icons.opacity=e,this._segments.setStyle({opacity:t}),this._segmentsCasing.setStyle({opacity:t}),this._waypoints.eachLayer(function(t){t.setOpacity(e)}),this._distanceMarkers&&this._distanceMarkers.setOpacity(e)},_setMarkerOpacity:function(t){t.layer.setOpacity(this.options.icons.opacity)},_removeMarkerEvents:function(t){t.off("mouseover",this._fireWaypointEvent,this),t.off("mouseout",this._fireWaypointEvent,this),t.off("dragstart",this._fireWaypointEvent,this),t.off("dragend",this._fireWaypointEvent,this),t.off("drag",this._fireWaypointEvent,this),t.off("click",this._fireWaypointEvent,this)},clear:function(){var t=this._draw._enabled,e=this._waypoints._first;if(this.draw(!1),null!==e){for(this._removeMarkerEvents(e);e._routing.nextMarker;){var n=e._routing.nextMarker;this._removeMarkerEvents(n),e=n}this._waypoints._first=null,this._waypoints._last=null,this._waypoints.clearLayers(),this._segments.clearLayers(),this._removeDistanceMarkers(),t&&this.draw(!0)}},setWaypoints:function(n,t,i){function e(t,e){r=r||t,++s>=n.length&&(a.fire("routing:setWaypointsEnd",{err:r}),i)&&i(r)}var o,r,s=0,a=this;for(this.fire("routing:setWaypointsStart"),this._waypoints.remove(),this._waypoints._map=null,this._loadingTrailerGroup.remove(),this._loadingTrailerGroup._map=null,o=0;n&&o<n.length;o++){var l=t&&o<t.length?t[o]:null;this.addWaypoint(n[o],l,this._waypoints._last,null,e)}this._loadingTrailerGroup._map=this._map,this._loadingTrailerGroup.addTo(this._map),this._waypoints._map=this._map,this._waypoints.addTo(this._map)},toPolyline:function(){var i=[];return this._eachSegment(function(t,e,n){n&&n.feature&&(i=i.concat(n.getLatLngs()))}),L.polyline(i)},_routeSegment:function(t,e,n){var i;t&&null!==t._routing.nextLine&&t._routing.nextLine.setStyle({color:"dimgray"}),t&&e&&(i=new L.Polyline([t.getLatLng(),e.getLatLng()],{color:this.options.styles.track.color,opacity:this.options.styles.trailer.opacity,dashArray:[10,10],className:"loading-trailer"}),this._loadingTrailerGroup.addLayer(i)),L.Routing.prototype._routeSegment.call(this,t,e,L.bind(function(t,e){i&&this._loadingTrailerGroup.removeLayer(i),n(t,e)},this))},getSegments:function(){var i=[];return this._eachSegment(function(t,e,n){n&&n.feature&&i.push(n)}),i},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(t.keyCode===this.options.shortcut.draw.disable?this._draw.disable():t.keyCode===this.options.shortcut.draw.enable?this._draw.enable():t.keyCode===this.options.shortcut.reverse?this.reverse():t.keyCode===this.options.shortcut.deleteLastPoint?this.deleteLastPoint():t.keyCode===this.options.shortcut.draw.beelineMode?this.toggleBeelineDrawing():t.keyCode===this.options.shortcut.draw.beelineModifier&&this._draw._setTrailerStyle(!0))},_keyupListener:function(t){t.keyCode===this.options.shortcut.draw.beelineModifier&&this._draw._setTrailerStyle(!1)},isDrawing:function(){return this._draw._enabled},reverse:function(){var t=this.getWaypoints(),e=this.getBeelineFlags();t.reverse(),e.reverse(),this.clear(),this.setWaypoints(t,e)},deleteLastPoint:function(){(lastPoint=this.getLast())&&this.removeWaypoint(lastPoint,function(t,e){})},_removeDistanceMarkers:function(){this._map&&this._distanceMarkers&&this._map.removeLayer(this._distanceMarkers)},_updateDistanceMarkers:function(t){var e;this._removeDistanceMarkers(),this._map&&(e=this.options.distanceMarkers||{},this._distanceMarkers=new L.DistanceMarkers(this.toPolyline(),this._map,e),this._map.addLayer(this._distanceMarkers))},_distance:function(t,e){var t=_slicedToArray(btools.util.CheapRuler.toIntegerLngLat([t.lng,t.lat]),2),n=t[0],t=t[1],e=_slicedToArray(btools.util.CheapRuler.toIntegerLngLat([e.lng,e.lat]),2),i=e[0],e=e[1];return btools.util.CheapRuler.calcDistance(n,t,i,e)},_computeKinematic:function(t,e,n){var i=new BR.RoutingContext(this.profile),n=(i.expctxWay=new BR.BExpressionContextWay(void 0,n),new BR.StdPath);return n.computeKinematic(i,t,e,!0),n},_getCostFactor:function(t){var e,n;return e=t&&(n=(t=t.feature.properties)["track-length"],t=t.cost,n)?t/n:e},_interpolateBeelines:function(t,e,n){var i,o=null==e?void 0:e.getLatLngs()[e.getLatLngs().length-1].alt,r=null!=(r=null==n?void 0:n.getLatLngs()[0].alt)?r:o,s=0,a=(null!=(o=null!=o?o:r)&&null!=r&&(s=r-o),t.reduce(function(t,e){return t+e.feature.properties["track-length"]},0)),r=this._getCostFactor(e),o=this._getCostFactor(n),l=null!=r&&null!=o?Math.max(r,o):null!=r?r:o,u=_createForOfIteratorHelper(t);try{for(u.s();!(i=u.n()).done;){var h,c=i.value.feature.properties,_=c["track-length"],d=s*_/a,p=this._computeKinematic(_,d,l);c["total-energy"]=p.getTotalEnergy(),c["total-time"]=p.getTotalTime(),0<d&&(c["filtered ascend"]=Math.trunc(d)),c["plain-ascend"]=Math.trunc(.5+d),c.cost=Math.round(_*(null!=(h=l)?h:0))}}catch(t){u.e(t)}finally{u.f()}},_updateBeelines:function(){L.Routing.prototype._updateBeelines.call(this);var o=[],r=null;this._eachSegment(function(t,e,n){var i;null!=n&&null!=(i=n._routing)&&i.beeline?o.push(n):(0<o.length&&this._interpolateBeelines(o,r,n),r=n,o=[])}),0<o.length&&this._interpolateBeelines(o,r,null)},createBeeline:function(t,e){var n,i=L.Routing.prototype.createBeeline.call(this,t,e),o=(delete i.getLatLngs()[0].alt,delete i.getLatLngs()[1].alt,this._distance(t,e)),r={cost:0,"filtered ascend":0,"plain-ascend":0,"total-energy":0,"total-time":0,"track-length":o,messages:[["Longitude","Latitude","Elevation","Distance","CostPerKm","ElevCost","TurnCost","NodeCost","InitialCost","WayTags","NodeTags","Time","Energy"],[1e6*e.lng,1e6*e.lat,null,o,null,null,null,null,null,"","",null,null]]},s=(i.feature=turf.lineString([[t.lng,t.lat],[e.lng,e.lat]],r),_createForOfIteratorHelper(i.getLatLngs()));try{for(s.s();!(n=s.n()).done;){var a=n.value,l=r.messages[1];a.feature=BR.TrackEdges.getFeature(l),a.message=l}}catch(t){s.e(t)}finally{s.f()}return i}});
BR.RoutingPathQuality=L.Control.extend({options:{shortcut:{toggle:67,muteKeyCode:77}},initialize:function(t,e,i){L.setOptions(this,i),t.createPane("routingQualityPane"),t.getPane("routingQualityPane").style.zIndex=450,t.getPane("routingQualityPane").style.pointerEvents="none";var a,i=new L.Hotline.Renderer({pane:"routingQualityPane"});this._routingSegments=L.featureGroup(),this._routingSegments.id="route-quality",e.addOverlay(this._routingSegments,i18next.t("map.layer.route-quality")),this.providers={incline:{title:i18next.t("map.route-quality-shortcut",{action:"$t(map.route-quality-incline)",key:"C"}),icon:"fa-line-chart",provider:new HotLineQualityProvider({hotlineOptions:{min:-8.5,max:8.5,palette:{0:"#0000ff",.25:"#00ffff",.5:"#00ff00",.75:"#ffff00",1:"#ff0000"},outlineColor:"dimgray",renderer:i},valueFunction:function(t,e){var i=t.alt-e.alt,e=e.distanceTo(t);return 0===e?0:180*Math.atan(i/e)/Math.PI}})},altitude:{title:i18next.t("map.route-quality-shortcut",{action:"$t(map.route-quality-altitude)",key:"C"}),icon:"fa-area-chart",provider:new HotLineQualityProvider({hotlineOptions:{outlineColor:"dimgray",renderer:i},valueFunction:function(t){return t.alt}})},surface:{title:i18next.t("map.route-quality-surface"),icon:"fa-road",provider:new HotLineQualityProvider({hotlineOptions:{renderer:i,palette:{0:"red",.45:"yellow",.9:"green",1:"#888888"},min:0,max:1,discreteStrokes:!0},valueFunction:(a=[],function(t){t=t.feature;if(!t.wayTags)return 1;if(a[t.wayTags])return a[t.wayTags];var e=new URLSearchParams(t.wayTags.replace(/\s+/g,"&")),i=null;switch(e.get("surface")){case"paved":case"chipseal":i=.8;break;case"asphalt":case"concrete":i=1;break;case"concrete:lanes":case"concrete:plates":i=.6;break;case"sett":case"gravel":case"pebblestone":case"unpaved":i=.5;break;case"paving_stones":case"compacted":case"fine_gravel":i=.7;break;case"cobblestone":case"dirt":case"grass":i=.2;break;case"unhewn_cobblestone":i=.01;break;case"ground":case"earth":i=.3;break;case"mud":case"sand":i=.01}if("track"===e.get("highway"))switch(e.get("tracktype")||"unknown"){case"grade1":null===i&&(i=.9);break;case"grade2":null===i?i=.7:i*=.9;break;case"grade3":null===i?i=.4:i*=.8;break;case"grade4":null===i?i=.1:i*=.6;break;case"grade5":null===i?i=.01:i*=.4}if(null!==i)switch(e.get("smoothness")){case"excellent":i=Math.min(1.1*i,1);break;case"good":i=Math.min(1.05*i,1);break;case"intermediate":i*=.9;break;case"bad":i*=.7;break;case"very_bad":i*=.5;break;case"horrible":i*=.4;break;case"very_horrible":i*=.2;break;case"impassable":i*=.01}e=null===i?1:.9*i;return a[t.wayTags]=e})})},cost:{title:i18next.t("map.route-quality-shortcut",{action:"$t(map.route-quality-cost)",key:"C"}),icon:"fa-usd",provider:new HotLineQualityProvider({hotlineOptions:{pct:.95,discreteStrokes:!0,smoothFactor:0,outlineColor:"dimgray",renderer:i},valueFunction:function(t){var t=t.feature,e=t.cost.perKm,i=t.distance/1e3;return 0<i&&(e+=(t.cost.elev+t.cost.turn+t.cost.node+t.cost.initial)/i),e}})}},this._initialProvider=this.options.initialProvider||"incline",this.selectedProvider=this._initialProvider,this._active=!1,this._muted=!1},onAdd:function(t){(this._map=t).on("overlayadd",function(t){t.layer===this._routingSegments&&this._activate(this.routingPathButton)},this),t.on("overlayremove",function(t){t.layer===this._routingSegments&&this._deactivate(this.routingPathButton)},this);for(var e=[],i=Object.keys(this.providers),a=i.length,n=0;n<a;++n){var r=this.providers[i[n]],o=i[(n+1)%a];e.push({stateName:i[n],icon:r.icon,title:r.title,onClick:L.bind(function(e){return L.bind(function(t){this._active?(t.state(e),this.setProvider(e),e===this._initialProvider?this._deactivate(t):this._getIcon(t).classList.add("active")):this._activate(t)},this)},this)(o)})}return(this.options.shortcut.muteKeyCode||this.options.shortcut.toggle)&&(L.DomEvent.addListener(document,"keydown",this._keydownListener,this),L.DomEvent.addListener(document,"keyup",this._keyupListener,this)),this.routingPathButton=new L.easyButton({states:e}).addTo(t),new L.DomUtil.create("div")},_activate:function(t){this._active=!0,this._getIcon(t).classList.add("active"),this._routingSegments.addTo(this._map)},_deactivate:function(t){this._active=!1,this._getIcon(t).classList.remove("active"),this._map.removeLayer(this._routingSegments)},_getIcon:function(t){return t.button.firstChild.firstChild},update:function(t,e){var i=[];e.eachLayer(function(t){i.push(t)}),this.segments=i,this._update(this.segments)},setProvider:function(t){this.selectedProvider=t,this._update(this.segments)},_update:function(t){this._routingSegments.clearLayers();var e=this.providers[this.selectedProvider].provider.computeLayers(t);if(e)for(var i=0;i<e.length;i++)this._routingSegments.addLayer(e[i])},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(this._active&&t.keyCode===this.options.shortcut.muteKeyCode&&(this._muted=!0,this._deactivate(this.routingPathButton)),this._muted||t.keyCode!==this.options.shortcut.toggle||this.routingPathButton.button.click())},_keyupListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&this._muted&&t.keyCode===this.options.shortcut.muteKeyCode&&(this._muted=!1,this._activate(this.routingPathButton))}});var HotLineQualityProvider=L.Class.extend({initialize:function(t){this.hotlineOptions=t.hotlineOptions,this.valueFunction=t.valueFunction},computeLayers:function(t){var e=[];if(t){for(var i=[],a=[],n=0;t&&n<t.length;n++){var r,o=t[n];null!=(r=o._routing)&&r.beeline||(r=this._computeLatLngVals(o),i.push(r),Array.prototype.push.apply(a,r))}if(0<a.length){var s,u=L.extend({},this.hotlineOptions);u.min||u.max||(u.pct=u.pct||1,s=this._calcMinMaxValues(a,u.pct),u.min=s.min,u.max=s.max);for(n=0;n<i.length;n++){var c=L.hotline(i[n],u);e.push(c)}}}return e},_computeLatLngVals:function(t){for(var e=[],i=t.getLatLngs(),a=i.length,n=0;n<a;n++){var r=this.valueFunction.call(this,i[n],i[Math.max(n-1,0)],n,i);e.push(this._convertToArray(i[n],r))}return e},_convertToArray:function(t,e){return[t.lat,t.lng,e]},_calcMinMaxValues:function(t,e){t.sort(function(t,e){return t[2]-e[2]});var i=t[0][2],e=t[Math.ceil(e*t.length)-1][2];return{min:i,max:e=i===e?i+1:e}}});
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var o;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(o="Object"===(o=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:o)||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,e):void 0}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0===o)return("string"===e?String:Number)(t);o=o.call(t,e||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var r=_superPropBase(t,e);if(r)return(r=Object.getOwnPropertyDescriptor(r,e)).get?r.get.call(arguments.length<3?t:o):r.value}).apply(this,arguments)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(o){var r=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(o);return _possibleConstructorReturn(this,r?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}BR.Search=function(){"use strict";_inherits(o,L.Control.Geocoder);var e=_createSuper(o);function o(t){return _classCallCheck(this,o),t=e.call(this,Object.assign({geocoder:new L.Control.Geocoder.LatLng({next:new L.Control.Geocoder.Nominatim({serviceUrl:"https://nominatim.openstreetmap.org/"}),sizeInMeters:800}),position:"topleft",expand:"click",shortcut:{search:70},placeholder:i18next.t("map.geocoder-placeholder")},t)),L.DomEvent.addListener(document,"keydown",t._keydownListener,_assertThisInitialized(t)),t}return _createClass(o,[{key:"markGeocode",value:function(t){return this._map.fitBounds(t.geocode.bbox,{maxZoom:17}),this.clear(),this._geocodeMarker=new L.CircleMarker(t.geocode.center,{interactive:!1,color:"red",opacity:1,weight:3}).addTo(this._map),this}},{key:"clear",value:function(){this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker)}},{key:"_keydownListener",value:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.search&&($("#map .leaflet-control-geocoder")[0].dispatchEvent(new MouseEvent("click")),t.preventDefault())}},{key:"onAdd",value:function(t){var e;return BR.Util.localStorageAvailable()?(e=_get(_getPrototypeOf(o.prototype),"onAdd",this).call(this,t),new SearchFavorites(this,e),e):_get(_getPrototypeOf(o.prototype),"onAdd",this).call(this,t)}}]),o}();var SearchFavorites=function(){"use strict";function r(t,e){var o=this,t=(_classCallCheck(this,r),this.searchInput=void 0,this.autocompleteContainer=void 0,this.autocompleteSelect=void 0,this.autocompleteMenu=void 0,this.geocoderForm=void 0,this.geocoder=void 0,this.favElements=void 0,this.isFiltered=!0,this.arFavitems=[],this.arFavitemsLC=[],this.geocoder=t,this.searchInput=$(e).find(".leaflet-control-geocoder-form input[type=text]"),this.searchInput.after('<span class="search-fav-ctrls btn-group btn-group-sm">\n\t\t\t\t<button \tid="search-fav-add"  \n\t\t\t\t\ttitle="'.concat(i18next.t("searchfav.addfavorite"),'" \n\t\t\t\t\tclass="fa fa-star-o  border-0">\n\t\t\t\t</button><button \tdata-toggle="collapse" \n\t\t\t\t\thref="#search-autocomplete-container"  \n\t\t\t\t\tid="search-fav-expand" \n\t\t\t\t\ttitle="').concat(i18next.t("searchfav.openfavorites"),'"  \n\t\t\t\t\tclass="fa fa-angle-double-down  border-0">\n\t\t\t\t</button>\n\t\t\t</span>\n\t\t')),$(e).find(".leaflet-control-geocoder-form .search-fav-ctrls").on("mousedown",function(t){t.stopPropagation(),t.preventDefault()}),$(e).find(".leaflet-control-geocoder-form .search-fav-ctrls").click(function(t){return o.onCtrlsClick(t)}),$(e).find(".leaflet-control-geocoder-form").append('\n\t\t\t<div class="collapse autocomplete-container filtered" id="search-autocomplete-container">\n\t\t\t\t<div class="autocomplete-select-container">\n\t\t\t\t\t<div class="list-group autocomplete-select" id="search-autocomplete-select" ></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="autocomplete-menu  bg-light rounded-bottom">\n\t\t\t\t\t<div id="search-fav-menu-toggle" class="" data-toggle="collapse" href="#autocomplete-btngroup">\n\t\t\t\t\t <span class="bt-more align-top">...</span>\n\t\t\t\t\t</div>\n\t\t\t\t  <div class="btn-group btn-group-sm collapse" id="autocomplete-btngroup">\n\t\t\t\t\t\t<button id="search-fav-deleteall"  \n\t\t\t\t\t\t\ttitle="'.concat(i18next.t("searchfav.removeall"),'"  \n\t\t\t\t\t\t\tclass="fa fa-eraser  border">\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button id="search-fav-export"  \n\t\t\t\t\t\t\ttitle="').concat(i18next.t("searchfav.export"),'"  \n\t\t\t\t\t\t\tclass="fa fa-floppy-o  border">\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button id="search-fav-import"\n\t\t\t\t\t\t\tclass="fa fa-folder-open-o  border"\n\t\t\t\t\t\t\ttitle="').concat(i18next.t("searchfav.import"),'" >\n\t\t\t\t\t\t\t\t<input id="search-fav-file" type="file" class="d-none" accept=".json">\n\t\t\t\t\t\t</button>\n\t\t\t\t  </div>\n\t\t\t\t</div>\t\t\t\t\n\t\t')),this.autocompleteContainer=$(e).find("#search-autocomplete-container"),this.autocompleteSelect=this.autocompleteContainer.find("#search-autocomplete-select"),this.autocompleteMenu=this.autocompleteContainer.find("#autocomplete-btngroup"),this.geocoderForm=$(e).find(".leaflet-control-geocoder-form"),this.autocompleteContainer.on("mousedown",function(t){t.stopPropagation(),t.preventDefault()}),this.autocompleteContainer.find("#search-fav-menu-toggle").on("mousedown touchend",function(t){t.stopPropagation(),t.preventDefault()}),this.autocompleteContainer.find("#search-fav-menu-toggle").on("click touchend",function(t){t.stopPropagation(),t.preventDefault(),o.autocompleteMenu.collapse("toggle")}),this.autocompleteContainer.find(".autocomplete-select-container").on("wheel",function(t){t.stopPropagation()}),this.autocompleteContainer.on("shown.bs.collapse",function(t){return o.geocoderForm.addClass("stayvisible")}),this.autocompleteContainer.on("hidden.bs.collapse",function(t){o.geocoderForm.removeClass("stayvisible"),o.autocompleteMenu.collapse("hide")}),this.autocompleteSelect.click(function(t){return o.onFavItemClicked(t)}),this.autocompleteContainer.find(".autocomplete-menu").click(function(t){return o.onFavMenuClicked(t)}),this.autocompleteContainer.find("#search-fav-file").on("change",function(t){return o.onImportFavFile(t)}),localStorage.searchFavItems);t&&(this.arFavitems=JSON.parse(t),this.arFavitemsLC=this.arFavitems.map(function(t){return t.toLowerCase()})),this.updateFavList(),this.searchInput.on("keyup",function(t){return o.onInput(t)})}return _createClass(r,[{key:"updateFavList",value:function(){var t;0<this.arFavitems.length?(t=this.arFavitems.join('</button><button class="list-group-item list-group-item-action rounded-0 favitem"><span class="fa fa-trash-o mr-1 del-favitem"></span>'),this.autocompleteSelect.html('<button class="list-group-item list-group-item-action rounded-0 favitem"><span class="fa fa-trash-o mr-1 del-favitem"></span>'.concat(t,"</button>"))):this.autocompleteSelect.empty(),this.favElements=this.autocompleteSelect.find("button")}},{key:"appendFavorite",value:function(t){""!==t&&(this.arFavitems.push(t),this.arFavitems=_toConsumableArray(new Set(this.arFavitems)),this.arFavitems.sort(),this.arFavitemsLC=this.arFavitems.map(function(t){return t.toLowerCase()}),localStorage.searchFavItems=JSON.stringify(this.arFavitems),this.updateFavList())}},{key:"deleteFavorite",value:function(t){t=this.arFavitems.indexOf(t);0<=t&&(this.arFavitems.splice(t,1),this.arFavitems=_toConsumableArray(new Set(this.arFavitems)),this.arFavitems.sort(),this.arFavitemsLC=this.arFavitems.map(function(t){return t.toLowerCase()}),localStorage.searchFavItems=JSON.stringify(this.arFavitems),this.updateFavList())}},{key:"onInput",value:function(t){var o,r,a=this;13==t.keyCode?this.autocompleteContainer.collapse("hide"):t.keyCode<=45&&8!=t.keyCode||((o=this.searchInput.val().toLowerCase())&&!(o.length<2)&&(this.isFiltered||(this.autocompleteContainer.addClass("filtered"),this.isFiltered=!0),r=!1,this.favElements.removeClass("match"),this.arFavitemsLC.forEach(function(t,e){-1!=t.indexOf(o)&&(a.favElements.eq(e).addClass("match"),r=!0)}),r)?this.autocompleteContainer.collapse("show"):this.autocompleteContainer.collapse("hide"))}},{key:"onCtrlsClick",value:function(t){switch(t.stopPropagation(),t.preventDefault(),t.target.id){case"search-fav-add":this.appendFavorite(this.searchInput.val());break;case"search-fav-expand":this.autocompleteContainer.hasClass("show")?this.isFiltered?(this.autocompleteContainer.removeClass("filtered"),this.isFiltered=!1):(this.autocompleteContainer.collapse("hide"),this.autocompleteContainer.addClass("filtered"),this.isFiltered=!0):(this.autocompleteContainer.removeClass("filtered"),this.isFiltered=!1,this.autocompleteContainer.collapse("show"))}}},{key:"onFavItemClicked",value:function(t){t.stopPropagation(),t.preventDefault(),$(t.target).hasClass("favitem")?(this.autocompleteContainer.collapse("hide"),this.geocoder.setQuery(t.target.innerText),this.searchInput.focus(),this.geocoder._keydown({keyCode:13})):$(t.target).hasClass("del-favitem")&&this.deleteFavorite($(t.target).closest("button").text())}},{key:"onFavMenuClicked",value:function(t){switch(t.target.id){case"search-fav-deleteall":confirm(i18next.t("searchfav.ask_removeall"))&&(this.arFavitems=[],this.arFavitemsLC=[],localStorage.searchFavItems=JSON.stringify(this.arFavitems),this.updateFavList());break;case"search-fav-export":var e=JSON.stringify(this.arFavitems,null,2),e=new Blob([e],{type:"application/json;charset=utf-8"}),e=URL.createObjectURL(e),o=document.createElement("a");o.href=e,o.download="SearchFavorites.json",o.click();break;case"search-fav-import":$(t.target).find("input[type=file]").click(),t.preventDefault()}}},{key:"onImportFavFile",value:function(t){var e,o=this;t.target.files[0]&&((e=new FileReader).onload=function(t){t=JSON.parse(t.target.result);o.arFavitems=o.arFavitems.concat(t),o.arFavitems=_toConsumableArray(new Set(o.arFavitems)),o.arFavitems.sort(),o.arFavitemsLC=o.arFavitems.map(function(t){return t.toLowerCase()}),localStorage.searchFavItems=JSON.stringify(o.arFavitems),o.updateFavList()},e.readAsText(t.target.files[0]),t.target.value="")}}]),r}();
BR.Sidebar=L.Control.Sidebar.extend({storageId:"sidebar-control",options:{position:"right",container:"sidebar",tabContainer:"sidebarTabs",autopan:!1,defaultTabId:"",shortcut:{toggleTabs:84},listeningTabs:{}},initialize:function(t,i){L.Control.Sidebar.prototype.initialize.call(this,t,i),this.oldTab=null,L.DomEvent.addListener(document,"keydown",this._keydownListener,this)},addTo:function(t){return L.Control.Sidebar.prototype.addTo.call(this,t),this.on("content",this._notifyOnContent,this),this.on("closing",this._notifyOnClose,this),this.on("toggleExpand",this._notifyOnResize,this),this.on("closing",function(){this._map.getContainer().focus()},this),this.recentTab=this.options.defaultTabId,this.on("content",function(t){this.recentTab=t.id},this),this._rememberTabState(),L.Browser.touch&&BR.Browser.touchScreenDetectable&&!BR.Browser.touchScreen&&(L.DomUtil.removeClass(this._container,"leaflet-touch"),L.DomUtil.removeClass(this._tabContainer,"leaflet-touch")),this},showPanel:function(t){return this._getTab(t).hidden=!1,this},_rememberTabState:function(){var t;BR.Util.localStorageAvailable()&&(this.on("content closing",this._storeActiveTab,this),"true"===(t=localStorage.getItem(this.storageId))?t=this.options.defaultTabId:null===t&&(t=""),""!==t)&&this._getTab(t)&&this.open(t)},_notifyShow:function(t){t&&t.show&&t.show()},_notifyHide:function(t){t&&t.hide&&t.hide()},_notifyOnContent:function(t){t=this.options.listeningTabs[t.id];this._notifyHide(this.oldTab),this._notifyShow(t),this.oldTab=t},_notifyOnClose:function(t){this._notifyHide(this.oldTab),this.oldTab=null},_notifyOnResize:function(t){var i=this.oldTab;i&&i.onResize&&i.onResize()},_storeActiveTab:function(t){localStorage.setItem(this.storageId,t.id||"")},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.toggleTabs&&($("#sidebarTabs > ul > li[class=active]").length?t.shiftKey||this.close():this.open(this.recentTab),t.shiftKey)&&((t=$("#sidebarTabs > ul > li[class=active] ~ li:not([hidden]) > a")).length||(t=$("#sidebarTabs > ul > li:not([hidden]) > a")),this.open(t.attr("href").slice(1)))}}),BR.sidebar=function(t,i){return new BR.Sidebar(t,i)};
BR.tracksLoader=function(t,a,e,n){TracksLoader=L.Control.FileLayerLoad.extend({options:{layer:function(e,o){return BR.Track.addPoiMarkers(n,e),L.geoJSON(e,o)},layerOptions:BR.Track.getGeoJsonOptions(a,!0),addToMap:!1,fileSizeLimit:BR.conf.trackSizeLimit||10240,shortcut:{open:79}},_initContainer:function(){var o,e=this.loader,t=L.DomUtil.get("navbarLoadTracksContainer"),t=(L.DomEvent.addListener(document,"keydown",this._keydownListener,this),(o=L.DomUtil.create("input","hidden",t)).type="file",o.multiple="multiple",this.options.formats?o.accept=this.options.formats.join(","):o.accept=".gpx,.kml,.json,.geojson",o.style.display="none",o.addEventListener("change",function(){e.loadMultiple(this.files),this.value=""},!1),L.DomUtil.get("navbarLoadTracks")),t=(L.DomEvent.disableClickPropagation(t),L.DomEvent.on(t,"click",function(e){o.click(),e.preventDefault()}),L.DomUtil.create("div"));return t.hidden=!0,t},_keydownListener:function(e){BR.Util.keyboardShortcutsAllowed(e)&&e.keyCode===this.options.shortcut.open&&!1===e.shiftKey&&$("#navbarLoadTracks")[0].click()}}),t.createPane("tracks"),t.getPane("tracks").style.zIndex=350;var o=new TracksLoader;return o.addTo(t),o.loader.on("data:loaded",function(e){var o=e.layer;a.addOverlay(o,e.filename),o.addTo(t)}),o.loader.on("data:error",function(e){e=e.error;BR.message.showError(i18next.t("warning.tracks-load-error",{error:e&&e.message?e.message:e})),console.error(e)}),o};
L.DistanceMarkers=L.LayerGroup.extend({initialize:function(e,i,t){for(var o=(t=t||{}).offset||1e3,n=Math.min(i.getMaxZoom(),t.showAll||12),r=t.cssClass||"dist-marker",a=void 0!==t.iconSize?t.iconSize:[12,12],s=t.textFunction||function(e,t){return t},l={},m=e,c=("function"==typeof e.getLatLngs&&(m=e.getLatLngs()),L.GeometryUtil.accumulatedLengths(e)),t=0<c.length?c[c.length-1]:0,f=0,h=Math.floor(t/o),v=1;v<=h;++v){for(var y=o*v;f<c.length-1&&c[f]<y;)++f;var u=s.call(this,y,v,o),d=m[f-1],g=m[f],d=L.polyline([d,g]),g=(y-c[f-1])/(c[f]-c[f-1]),d=L.GeometryUtil.interpolateOnLine(i,d,g),g=[a[0]+a[0]*(""+u).length,a[1]],g=L.divIcon({className:r,html:u,iconSize:g}),d=L.marker(d.latLng,{title:u,icon:g,interactive:!1}),u=this._minimumZoomLevelForItem(v,n);void 0===l[u]&&(l[u]=L.layerGroup()),l[u].addLayer(d)}function z(){var e=p,t=p=i.getZoom();if(e<t)for(var o=e+1;o<=t;++o)void 0!==l[o]&&_.addLayer(l[o]);else if(t<e)for(o=e;t<o;--o)void 0!==l[o]&&_.removeLayer(l[o])}var p=0,_=this;i.on("zoomend",z),this._zoomLayers=l,this._layers={},z()},setOpacity:function(t){for(var e=Object.keys(this._zoomLayers),o=e.length,i=0;i<o;++i)this._zoomLayers[e[i]].eachLayer(function(e){e.setOpacity(t)})},_minimumZoomLevelForItem:function(e,t){for(var o=t,i=e;0<i&&i%2==0;)--o,i=Math.floor(i/2);return o}});
!function(t){a=t.documentMode;var a,n="onhashchange"in t&&(void 0===a||7<a);L.Hash=function(t,a){this.onHashChange=L.Util.bind(this.onHashChange,this),t&&this.init(t,a)},L.Hash.parseHash=function(t){var a,n,e,t=(t=0===t.indexOf("#map=")?t.substr(5):t).split(/\&(.+)/),s=t[0].split("/");return 4==s.length&&(a=parseInt(s[0],10),n=parseFloat(s[1]),e=parseFloat(s[2]),s=this.parseLayers(s[3]),t=t[1],!(isNaN(a)||isNaN(n)||isNaN(e)))&&{center:new L.LatLng(n,e),zoom:a,layers:s,additional:t}},L.Hash.formatHash=function(t){var a=t.getCenter(),t=t.getZoom(),n=Math.max(0,Math.ceil(Math.log(t)/Math.LN2)),e=this.formatLayers(),t=[t,a.lat.toFixed(n),a.lng.toFixed(n),e];if(url="#map="+t.join("/"),null!=this.additionalCb){a=this.additionalCb();if(null!=a)return url+a}return url},L.Hash.prototype={options:{layerSeparator:","},map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(t,a){this.map=t,L.Util.setOptions(this,a),this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},_parseLayers:function(t,a){return t.split(a).map(L.bind(function(t){var a=null,t=decodeURIComponent(t);return a=t?this.options.layersControl.getLayerFromString(t):a},this))},parseLayers:function(t){function a(t,a){return a&&t++,t}var n=this._parseLayers(t,this.options.layerSeparator),e=n.reduce(a,0);return n=e<n.length&&e<(e=this._parseLayers(t,"-")).reduce(a,0)?e:n},activateLayers:function(t){var e=this.options.layersControl,s=!1;e.removeActiveLayers(),t.forEach(L.bind(function(t,a,n){t&&(e.activateLayer(t),t.layer instanceof OverpassLayer&&e._update(),t)&&!t.overlay&&(s=!0)},this)),s||e.activateDefaultBaseLayer()},formatLayers:function(){return this.options.layersControl.getActiveLayers().filter(function(t){return t.layer instanceof L.GridLayer||t.layer.id}).map(L.bind(function(t){return encodeURIComponent(this.options.layersControl.toLayerString(t))},this)).join(this.options.layerSeparator)},removeFrom:function(t){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var t=this.formatHash(this.map);this.lastHash!=t&&(location.replace(t),this.lastHash=t)},movingMap:!1,update:function(){var t,a,n=location.hash;n!==this.lastHash&&((t=this.parseHash(n))||null!=this.onInvalidHashChangeCb&&null!=(a=this.onInvalidHashChangeCb(n))&&a!=n&&(t=this.parseHash(a)),t?(this.movingMap=!0,this.map.setView(t.center,t.zoom),this.activateLayers(t.layers),null!=this.onHashChangeCb&&this.onHashChangeCb(t.additional),this.movingMap=!1):this.onMapMove(this.map))},changeDefer:100,changeTimeout:null,onHashChange:function(){var t;this.changeTimeout||((t=this).changeTimeout=setTimeout(function(){t.update(),t.changeTimeout=null},this.changeDefer))},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend layeradd layerremove",this.onMapMove,this),n?L.DomEvent.addListener(t,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend layeradd layerremove",this.onMapMove,this),n?L.DomEvent.removeListener(t,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1},_keyByValue:function(t,a){for(var n in t)if(t.hasOwnProperty(n))return t[n]===a?n:null}},L.hash=function(t,a){return new L.Hash(t,a)},L.Map.prototype.addHash=function(){this._hash=L.hash(this,this.options)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}}(window);
BR.stravaSegments=function(a,t){function e(){var t=r.runningButton.button.parentElement;t.hidden=!t.hidden}var r=L.control.stravaSegments({runningTitle:i18next.t("map.strava-shortcut",{action:"$t(map.strava-running)",key:"S"}),bikingTitle:i18next.t("map.strava-shortcut",{action:"$t(map.strava-biking)",key:"S"}),loadingTitle:i18next.t("map.loading"),stravaToken:BR.keys.strava}).addTo(a);t.addOverlay(r.stravaLayer,i18next.t("map.layer.strava-segments")),r.onError=function(t){BR.message.showError(i18next.t("warning.strava-error",{error:t&&t.message?t.message:t}))},L.setOptions(this,{shortcut:{toggleLayer:83}});return e(),r.stravaLayer.on("add remove",e),L.DomEvent.addListener(document,"keydown",function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.toggleLayer&&(a.hasLayer(r.stravaLayer)?a.removeLayer(r.stravaLayer):a.addLayer(r.stravaLayer))},this),r};
BR.ControlLayers=L.Control.Layers.extend({getActiveLayers:function(){for(var e=[],a=0;a<this._layers.length;a++){var r=this._layers[a];this._map.hasLayer(r.layer)&&(r.overlay?e.push(r):e.unshift(r))}return e},getActiveBaseLayer:function(){for(var e=this.getActiveLayers(),a=0;a<e.length;a++){var r=e[a];if(!r.overlay)return r}return null},removeActiveLayers:function(){for(var e=[],a=0;a<this._layers.length;a++){var r=this._layers[a];this._map.hasLayer(r.layer)&&(this._map.removeLayer(r.layer),e.push(r))}return e},getLayer:function(e){for(var a=0;a<this._layers.length;a++){var r=this._layers[a];if(r.name===e)return r}return null},getBaseLayers:function(){return this._layers.filter(function(e){return!e.overlay})},activateLayer:function(e){this._map.hasLayer(e.layer)||this._map.addLayer(e.layer)},activateFirstLayer:function(){for(var e=0;e<this._layers.length;e++){var a=this._layers[e];if(!a.overlay){this.activateLayer(a);break}}},activateBaseLayerIndex:function(e){e=this.getBaseLayers()[e];this.activateLayer(e)},_addLayer:function(e,a,r){L.Control.Layers.prototype._addLayer.call(this,e,a,r),this.options.autoZIndex&&e.setZIndex&&(r||(this._lastZIndex--,e.setZIndex(0)))}});
function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,s=[],l=!0,c=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r,n,o,a,i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return n=!(r=!0),{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){n=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(n)throw o}}};if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length)return i&&(t=i),a=0,{s:e=function(){},n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var r;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(r="Object"===(r=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}BR.Export=L.Class.extend({latLngs:[],options:{shortcut:{export:88}},initialize:function(t,e,r){this.router=t,this.pois=e,this.profile=r,this.exportButton=$("#exportButton");t=this.trackname=document.getElementById("trackname");this.tracknameAllowedChars=BR.conf.tracknameAllowedChars,!BR.Browser.download&&this.tracknameAllowedChars&&(this.tracknameMessage=document.getElementById("trackname-message"),e=new RegExp("["+this.tracknameAllowedChars+"]+"),t.pattern=e.toString().slice(1,-1),t.addEventListener("input",L.bind(this._validationMessage,this))),this.exportButton.on("click",L.bind(this._generateTrackname,this)),L.DomUtil.get("submitExport").onclick=L.bind(this._export,this),L.DomUtil.get("serverExport").onclick=L.bind(this._exportServer,this),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),$("#export").on("show.bs.modal",this._warnDownload.bind(this)),$("#export input[name=format]").on("change",this._warnDownload.bind(this)),$("#export").on("show.bs.modal",this._turnInstructionInfo.bind(this)),this.update([])},update:function(t,e){this.latLngs=t,this.segments=e,t.length<2?this.exportButton.addClass("disabled"):this.exportButton.removeClass("disabled")},_warnDownload:function(){var t=BR.Routing.hasBeeline(this.segments),e=$("#format-fit").prop("checked"),r=($("#export-download-warning").prop("hidden",!t&&!e),"Download from server (deprecated)");t&&(r="[Warning: straight lines not supported] "+r),e&&(r="[Warning: FIT not supported] "+r),document.getElementById("serverExport").title=r},_turnInstructionInfo:function(){var t=+this.profile.getProfileVar("turnInstructionMode");$(".format-turns-enabled").prop("hidden",t<=1).attr("title",i18next.t("export.turns_enabled"))},_getMimeType:function(t){return{gpx:"application/gpx+xml;charset=utf-8",kml:"application/vnd.google-earth.kml+xml;charset=utf-8",geojson:"application/vnd.geo+json;charset=utf-8",csv:"text/tab-separated-values;charset=utf-8",fit:"application/vnd.ant.fit"}[t]},_triggerDownload:function(t,e){var r=document.createElement("a");r.href=t,e&&(r.download=e),r.hidden=!0,document.body.appendChild(r),r.click(),r.remove()},_exportServer:function(t){this._export(t,!0)},_export:function(t){var e,r,n=this,o=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=document.forms.export,i=a.format.value||$("#export-format input:radio:checked").val(),s=a.trackname.value,l=encodeURIComponent(s),a=a["include-waypoints"].checked;t.preventDefault(),!o&&BR.Browser.download?(o=this._formatTrack(i,s,a),e=(s||"brouter")+"."+i,s=new Blob([o],{type:this._getMimeType(i)}),(r=new FileReader).onload=function(t){return n._triggerDownload(r.result,e)},r.readAsDataURL(s)):("fit"===i&&(i="gpx"),o=this.router.getUrl(this.latLngs,null,this.pois.getMarkers(),null,i,l,a),this._triggerDownload(o))},_formatTrack:function(t,e,r){var n=BR.Export._concatTotalTrack(this.segments);switch(e&&(n.features[0].properties.name=e),this._addPois(n),r&&this._addRouteWaypoints(n),t){case"gpx":var o=+this.profile.getProfileVar("turnInstructionMode"),a=this.profile.getTransportMode();return BR.Gpx.format(n,o,a);case"kml":return BR.Kml.format(n);case"geojson":return JSON.stringify(n,null,2);case"csv":return BR.Csv.format(n);case"fit":return BR.Fit.format(n)}console.error("Export format not implemented: "+t)},_addPois:function(t){var e,r=_createForOfIteratorHelper(this.pois.getMarkers());try{for(r.s();!(e=r.n()).done;){var n=e.value,o={name:n.name,type:"poi"},a=turf.point([n.latlng.lng,n.latlng.lat],o);t.features.push(a)}}catch(t){r.e(t)}finally{r.f()}},_addRouteWaypoints:function(t){var e,r=_createForOfIteratorHelper(this.latLngs.entries());try{for(r.s();!(e=r.n()).done;){var n=_slicedToArray(e.value,2),o=n[0],a=n[1],i="via"+o,s="via",l=(0===o?s=i="from":o===this.latLngs.length-1&&(s=i="to"),{name:i,type:s}),c=turf.point([a.lng,a.lat],l);t.features.push(c)}}catch(t){r.e(t)}finally{r.f()}},_validationMessage:function(){var t=this.trackname,e=new RegExp("[^"+this.tracknameAllowedChars+"]","g");t.validity.patternMismatch?(t=t.value.replace(e,""),e=this.tracknameAllowedChars.replace(/\\/g,""),this.tracknameMessage.textContent="["+e+"] --\x3e "+t):this.tracknameMessage.textContent=""},_selectTrackname:function(){trackname.setSelectionRange(0,trackname.value.lastIndexOf(BR.Browser.download?" (":" - "))},_generateTrackname:function(){var n=this.trackname;this._getCityAtPosition(this.latLngs[0],L.bind(function(r){this._getCityAtPosition(this.latLngs[this.latLngs.length-1],L.bind(function(t){var e=document.getElementById("distance").innerHTML;!BR.Browser.download&&this.tracknameAllowedChars&&(e=e.replace(",",".")),n.value=r&&t?r===t?i18next.t("export.route-loop",{from:r,distance:e}):i18next.t("export.route-from-to",{from:r,to:t,distance:e}):null,!BR.Browser.download&&this.tracknameAllowedChars&&(n.value=n.value.replace(/[>)]/g,"").replace(/ \(/g," - "),this._validationMessage()),this._selectTrackname()},this))},this))},_getCityAtPosition:function(n,o){var t=L.Util.template("https://nominatim.openstreetmap.org/reverse?lon={lng}&lat={lat}&format=json",n);BR.Util.get(t,L.bind(function(t,e){try{var r=JSON.parse(e).address;o(r.village||r.town||r.hamlet||r.city_district||r.city)}catch(t){return BR.message.showError('Error getting position city "'+n+'": '+t),o(null)}}))},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.export&&!this.exportButton.hasClass("disabled")&&(this._generateTrackname(),$("#export").modal("show"))}}),BR.export=function(){return new BR.Export},BR.Export._concatTotalTrack=function(t){var e,r,n=[],o=_createForOfIteratorHelper(t.entries());try{for(o.s();!(r=o.n()).done;){var a=_slicedToArray(r.value,2),i=a[0],s=a[1].feature;if(s){var l=0<n.length?n.length-1:0;if(e){var c,u=e,d=s.properties,h=(m=c=f=void 0,u),p=d,f=_createForOfIteratorHelper(["cost","filtered ascend","plain-ascend","total-energy","total-time","track-length"]);try{for(f.s();!(c=f.n()).done;){var m=c.value;h[m]=(+h[m]+ +p[m]).toString()}}catch(t){f.e(t)}finally{f.f()}if(u.messages=u.messages.concat(d.messages.slice(1)),u.times&&d.times){var g,v=u.times[u.times.length-1],y=_createForOfIteratorHelper(d.times.entries());try{for(y.s();!(g=y.n()).done;){var _=_slicedToArray(g.value,2),w=_[0],x=_[1];0<w&&u.times.push(+(v+x).toFixed(3))}}catch(t){y.e(t)}finally{y.f()}}if(d.voicehints){u.voicehints||(u.voicehints=[]);var b,k=_createForOfIteratorHelper(d.voicehints);try{for(k.s();!(b=k.n()).done;){var B=b.value.slice();B[0]+=l,u.voicehints.push(B)}}catch(t){k.e(t)}finally{k.f()}}}else(e=Object.assign({},s.properties)).voicehints&&(e.voicehints=e.voicehints.slice()),e.times&&(e.times=e.times.slice());var A,L,I=s.geometry.coordinates;0<i&&(A=n[n.length-1],L=I[0],A.length<L.length?n.pop():I=I.slice(1)),n=n.concat(I)}}}catch(t){o.e(t)}finally{o.f()}return turf.featureCollection([turf.lineString(n,e)])};
BR.Itinerary=L.Class.extend({initialize:function(){this._content=document.getElementById("itinerary"),this.update()},update:function(t,e){var n,i,r,a="";for(a+='<pre class="flexgrow">',n=0;e&&n<e.length;n++)for(r=e[n].feature.iternity,i=0;r&&i<r.length;i++)a+=r[i]+"\n";this._content.innerHTML=a+="</pre>"}});
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var r,a=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)),a}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _createForOfIteratorHelper(e,t){var r,a,o,l,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return a=!(r=!0),{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){a=!0,o=e},f:function(){try{r||null==n.return||n.return()}finally{if(a)throw o}}};if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),l=0,{s:t=function(){},n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}BR.Layers=L.Class.extend({_loadLayers:function(){if(this._customLayers={},BR.Util.localStorageAvailable()){var e=JSON.parse(localStorage.getItem("map/customLayers"));if("FeatureCollection"==(null==e?void 0:e.type)){var t,r=_createForOfIteratorHelper(e.features);try{for(r.s();!(t=r.n()).done;){var o=t.value;this._addLayer(o)}}catch(e){r.e(e)}finally{r.f()}}else for(a in e){var l={geometry:null,properties:{name:a,overlay:e[a].isOverlay,dataSource:e[a].dataSource,query:"OverpassAPI"===e[a].dataSource?e[a].layer:void 0,url:e[a].layer}};this._addLayer(l)}}},_loadTable:function(){var e=[];for(layer in this._customLayers){var t,r=this._customLayers[layer].layerData.properties;"OverpassAPI"===r.dataSource?e.push([layer,r.query,i18next.t("sidebar.layers.table.type_overpass_query")]):(t=r.overlay,e.push([layer,r.url,t?i18next.t("sidebar.layers.table.type_overlay"):i18next.t("sidebar.layers.table.type_layer")]))}null!=this._layersTable&&this._layersTable.destroy(),this._layersTable=$("#custom_layers_table").DataTable({data:e,info:!1,searching:!1,bAutoWidth:!1,paging:!1,language:{emptyTable:i18next.t("sidebar.layers.table.empty")},columns:[{title:i18next.t("sidebar.layers.table.name")},{title:i18next.t("sidebar.layers.table.URL"),className:"custom_layers_url"},{title:i18next.t("sidebar.layers.table.type")}]})},init:function(e,t,r,a){for(var o in this._layersControl=t,this._map=e,this._layers={},a)this._layers[o]=[a[o],!0];for(var o in r)this._layers[o]=[r[o],!1];L.DomUtil.get("custom_layers_add_base").onclick=L.bind(this._addBaseLayer,this),L.DomUtil.get("custom_layers_add_overlay").onclick=L.bind(this._addOverlay,this),L.DomUtil.get("custom_layers_add_overpass").onclick=L.bind(this._addOverpassQuery,this),L.DomUtil.get("custom_layers_remove").onclick=L.bind(this._remove,this),this._loadLayers(),this._loadTable();var l=this._layersTable;$("#custom_layers_table tbody").on("click","tr",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):(l.$("tr.selected").removeClass("selected"),$(this).addClass("selected"))}),L.DomUtil.get("custom_layers_button").onclick=function(){$("#custom_layers").modal()}},_remove:function(e){var t=this._layersTable.row(".selected").data();null!=t&&(t=t[0],this._layersControl.removeLayer(this._customLayers[t].layer),this._map.removeLayer(this._customLayers[t].layer),delete this._customLayers[t],this._layersTable.row(".selected").remove().draw(!1),this._sync())},_addFromInput:function(e){var t=L.DomUtil.get("layer_name").value,r=L.DomUtil.get("layer_url").value,e={geometry:null,properties:_objectSpread(_objectSpread({},e),{},{name:L.DomUtil.get("layer_name").value}),type:"Feature"};0<t.length&&0<r.length&&this._addLayer(e)},_addBaseLayer:function(e){var t={type:"tms",url:L.DomUtil.get("layer_url").value};this._addFromInput(t)},_addOverlay:function(e){var t={type:"tms",url:L.DomUtil.get("layer_url").value,overlay:!0};this._addFromInput(t)},_addOverpassQuery:function(e){var t={overlay:!0,dataSource:"OverpassAPI",query:L.DomUtil.get("layer_url").value};this._addFromInput(t)},_createTmsProps:function(e){return _objectSpread({type:"tms"},e)},_addLayer:function(e){var t=e.properties,r=t.name;if(!(r in this._layers||r in this._customLayers))try{var a=this._layersControl.layersConfig.createLayer(e);return this._customLayers[r]={layer:a,layerData:e},t.overlay?this._layersControl.addOverlay(a,r):this._layersControl.addBaseLayer(a,r),this._loadTable(),this._sync(),a}catch(e){console.warn("Oops:",e)}},_sync:function(){var e;BR.Util.localStorageAvailable()&&(e={type:"FeatureCollection",features:Object.values(this._customLayers).map(function(e){return e.layerData})},localStorage.setItem("map/customLayers",JSON.stringify(e)))}});
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}BR.LayersTab=BR.ControlLayers.extend({previewLayer:null,previewBounds:null,saveLayers:[],initialize:function(e,t,r,i){L.Control.Layers.prototype.initialize.call(this,t,r,i),this.layersConfig=e},addTo:function(e){return this._map=e,this.onAdd(e),L.DomUtil.get("layers-control-wrapper").appendChild(this._section),this.initOpacitySlider(e),this.initButtons(),this.initJsTree(),this},onAdd:function(e){BR.ControlLayers.prototype.onAdd.call(this,e),e.on("baselayerchange overlayadd overlayremove",this.storeActiveLayers,this),e.on("overlayadd overlayremove",this.updateOpacityLabel,this)},onRemove:function(e){BR.ControlLayers.prototype.onRemove.call(this,e),e.off("baselayerchange overlayadd overlayremove",this.storeActiveLayers,this),e.off("overlayadd overlayremove",this.updateOpacityLabel,this)},initOpacitySlider:function(i){var a=this,e=new BR.OpacitySlider({id:"overlay",reversed:!1,orientation:"horizontal",defaultValue:1,title:i18next.t("layers.opacity-slider"),callback:function(e){for(var t=0;t<a._layers.length;t++){var r=a._layers[t].layer;a._layers[t].overlay&&i.hasLayer(r)&&(r.setOpacity?r.setOpacity(e):r.setStyle&&r.setStyle({opacity:e}))}}});L.DomUtil.get("leaflet-control-layers-overlays-opacity-slider").appendChild(e.getElement())},initButtons:function(){L.DomUtil.get("expand_tree_button").onclick=L.bind(function(e){this.jstree.open_all()},this),L.DomUtil.get("collapse_tree_button").onclick=L.bind(function(e){this.jstree.close_all()},this),L.DomUtil.get("optional_layers_button").onclick=L.bind(function(e){var t=L.DomUtil.get("optional_layers_button"),r=L.DomUtil.get("tree-button-group"),i=L.DomUtil.get("optional-layers");i.hidden=!i.hidden,r.hidden=!r.hidden,t.classList.toggle("active"),i.hidden&&this.deselectNode()},this)},initJsTree:function(){var o=BR.layerIndex,e=this.toJsTree(BR.confLayers.tree),a=null;$("#optional-layers-tree").on("select_node.jstree",L.bind(function(e,t){var r=o[t.node.id],i=t.selected[0];i!==a?(this.showPreview(r),a=i):t.instance.deselect_node(t.node)},this)).on("deselect_node.jstree",L.bind(function(e,t){this.hidePreview(),a=null},this)).on("check_node.jstree",L.bind(function(e,t){var r=o[t.node.id],i=this.createLayer(r),a=r.properties.name,s=(r.properties.overlay?this.addOverlay(i,a):this.addBaseLayer(i,a),this.storeDefaultLayers(),document.getElementById(t.node.a_attr.id));s.classList.add("added"),setTimeout(function(){s.classList.remove("added")},1e3)},this)).on("uncheck_node.jstree",L.bind(function(e,t){var r,i=this.getLayerById(t.node.id);i&&(this.removeLayer(i.layer),this._map.hasLayer(i.layer)&&(this._map.removeLayer(i.layer),i.overlay||this.activateFirstLayer()),this.storeDefaultLayers(),(r=document.getElementById(t.node.a_attr.id)).classList.add("removed"),setTimeout(function(){r.classList.remove("removed")},1e3))},this)).on("ready.jstree",function(e,t){t.instance.open_all()}).jstree({plugins:["checkbox"],checkbox:{whole_node:!1,tie_selection:!1},core:{multiple:!1,themes:{icons:!0,dots:!1},data:e}}),this.jstree=$("#optional-layers-tree").jstree(!0)},toJsTree:function(e){var t={children:[]},v=this;return function i(e,a){function t(e){for(var t in e){var r=e[t],t={text:i18next.t("sidebar.layers.category."+t,t),icon:!1,state:{disabled:!0},children:[]};a.children.push(t),i(r,t)}}if(Array.isArray(e))for(var r=0;r<e.length;r++){var s=e[r];"object"===_typeof(s)?t(s):(n=BR.layerIndex[s])?(o=s,l=a,c=y=void 0,h=d=void 0,d=(n=n.properties).url,d=v.layersConfig.getKeyName(d),h=null,(d=h=d&&!BR.keys[d.name]?h:{id:o,text:(d=l,l='<span class="tree-text">',(c=(y=n).country_code||y.language_code)&&d.text!==c&&(l+='<span class="tree-code">'+c+"</span>"),(l+=y.name)+"</span>"),icon:v.layersConfig.getOverpassIconUrl(n.icon)||!1,state:{checked:v.layersConfig.isDefaultLayer(o,n.overlay)}})&&a.children.push(d)):console.error('Layer "'+s+'" not found')}else t(e);var o,n,l,y,c,d,h}(e,t),t.children},storeDefaultLayers:function(){for(var e=[],t=[],r=0;r<this._layers.length;r++){var i=this._layers[r],a=i.layer.id;a&&-1===this.layersConfig.builtInLayers.indexOf(a)&&(i.overlay?t:e).push(a)}this.layersConfig.storeDefaultLayers(e,t)},createLayer:function(e){var t=this.layersConfig.createLayer(e),e=e.properties.overlay;return t.options.zIndex=e?this._lastZIndex+1:0,t},getLayerById:function(e){for(var t=0;t<this._layers.length;t++){var r=this._layers[t];if(r.layer.id===e)return r}return null},getLayerByLegacyName:function(e){var t=null,e=this.layersConfig.legacyNameToIdMap[e];return t=e?this.getLayerById(e):t},activateDefaultBaseLayer:function(){var e=BR.conf.defaultBaseLayerIndex||0;this.getActiveBaseLayer()||this.activateBaseLayerIndex(e)},saveRemoveActiveLayers:function(){this.saveLayers=this.removeActiveLayers()},restoreActiveLayers:function(e){for(var t=0;t<this.saveLayers.length;t++){var r=this.saveLayers[t];e&&!r.overlay||(!!this._getLayer(L.Util.stamp(r.layer))?this.activateLayer(r):r.overlay||this.activateFirstLayer())}this.saveLayers=[]},removePreviewLayer:function(){return!(!this.previewLayer||!this._map.hasLayer(this.previewLayer)||(this._map.removeLayer(this.previewLayer),this.previewLayer=null))},showPreviewBounds:function(e){e.geometry&&(this.previewBounds=L.geoJson(e.geometry,{invert:!0,renderer:L.svg({padding:1}),color:"#333",fillOpacity:.4,weight:2}).addTo(this._map))},removePreviewBounds:function(){this.previewBounds&&this._map.hasLayer(this.previewBounds)&&(this._map.removeLayer(this.previewBounds),this.previewBounds=null)},deselectNode:function(){var e=this.jstree.get_selected();0<e.length&&this.jstree.deselect_node(e[0])},onBaselayerchange:function(){setTimeout(L.Util.bind(function(){this.removePreviewBounds(),this.removePreviewLayer(),this.restoreActiveLayers(!0),this.deselectNode()},this),0)},showPreview:function(e){var t=this.createLayer(e);this._map.addLayer(t),this.removePreviewBounds(),this.removePreviewLayer()||(this.saveRemoveActiveLayers(),this._map.once("baselayerchange",this.onBaselayerchange,this)),this.previewLayer=t,this.showPreviewBounds(e),L.DomUtil.get("preview").hidden=!1},hidePreview:function(e){this._map.off("baselayerchange",this.onBaselayerchange,this),this.removePreviewBounds(),this.removePreviewLayer(),this.restoreActiveLayers(),L.DomUtil.get("preview").hidden=!0},toLayerString:function(e){return e.layer.id||e.name},getLayerFromString:function(e){var t=this.getLayerById(e);return t=(t=t||this.getLayer(e))||this.getLayerByLegacyName(e)},storeActiveLayers:function(){var e;BR.Util.localStorageAvailable()&&(e=this.getActiveLayers().map(L.bind(function(e){return this.toLayerString(e)},this)),e=JSON.stringify(e),localStorage.setItem("map/activeLayers",e))},loadActiveLayers:function(){if(BR.Util.localStorageAvailable()){var e=localStorage.getItem("map/activeLayers");if(e)for(var t=JSON.parse(e),r=0;r<t.length;r++){var i=t[r],i=this.getLayerFromString(i);i&&this.activateLayer(i)}}},updateOpacityLabel:function(){var e=$("#leaflet-control-layers-overlays-opacity-slider"),t=this.getActiveLayers().length-1;0==t?e.hide():(e.show(),e.children()[1].innerText=i18next.t("sidebar.layers.overlay-opacity",{count:t}))}}),BR.layersTab=function(e,t,r){return new BR.LayersTab(e,t,r)};
BR.Message=L.Class.extend({options:{alert:!1,onClosed:null},initialize:function(i,n){L.setOptions(this,n),this.id=i},_show:function(i,n){var t,e,a=L.DomUtil.get(this.id);switch(n){case"error":t="fa-times-circle",e="alert-danger";break;case"warning":t="fa-exclamation-triangle",e="alert-warning";break;case"loading":t="fa-spinner fa-pulse",e="alert-secondary";break;default:t="fa-info-circle",e="alert-info"}L.DomEvent.disableClickPropagation(a),a.innerHTML='<div class="alert '+e+' alert-dismissible fade show" role="alert">  <button type="button" class="close" data-dismiss="alert" aria-label="Close">    <span aria-hidden="true">&times;</span>  </button>  <span class="fa '+t+'" aria-hidden="true"/></span>'+i+"</div>",this.options.onClosed&&$("#"+this.id+" .alert").on("closed.bs.alert",this.options.onClosed),this.options.alert&&$("#"+this.id+" .alert").alert()},hide:function(){$("#"+this.id+" .alert").alert("close")},showError:function(i){"target island detected for section 0\n"==(i=i&&i.message?i.message:i)||"no track found at pass=0\n"==i?i=i18next.t("warning.no-route-found"):"to-position not mapped in existing datafile\n"==i?i=i18next.t("warning.invalid-route-to"):"from-position not mapped in existing datafile\n"==i?i=i18next.t("warning.invalid-route-from"):i&&i.startsWith("null description for: ")&&(i=i18next.t("warning.no-route-found")),this._show(i,"error")},showWarning:function(i){this._show(i,"warning")},showInfo:function(i){this._show(i,"info")},showLoading:function(i){this._show(i,"loading")}}),BR.message=new BR.Message("message");
BR.OpacitySlider=L.Class.extend({options:{id:"",reversed:!0,orientation:"vertical",defaultValue:BR.conf.defaultOpacity,title:"",callback:function(t){}},initialize:function(t){L.setOptions(this,t);var t=this.input=$('<input id="slider-'+this.options.id+'" type="text"/>'),e=BR.Util.localStorageAvailable()?localStorage["opacitySliderValue"+this.options.id]:null,e=e?parseInt(e):100*this.options.defaultValue,i=100*(BR.conf.minOpacity||0);t.slider({id:this.options.id,min:0,max:100,step:1,value:e=e<i?i:e,orientation:this.options.orientation,reversed:this.options.reversed,selection:this.options.reversed?"before":"after",tooltip:"hide"}).on("slide slideStop",{self:this},function(t){t.data.self.options.callback(t.value/100)}).on("slideStop",{self:this},function(t){BR.Util.localStorageAvailable()&&(localStorage["opacitySliderValue"+t.data.self.options.id]=t.value)}),this.getElement().title=this.options.title,this.options.callback(e/100),this.options.muteKeyCode&&(L.DomEvent.addListener(document,"keydown",this._keydownListener,this),L.DomEvent.addListener(document,"keyup",this._keyupListener,this))},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.muteKeyCode&&this.options.callback(0)},_keyupListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.muteKeyCode&&this.options.callback(this.input.val()/100)},getElement:function(){return this.input.slider("getElement")}});
BR.OpacitySliderControl=L.Control.extend({options:{position:"topleft"},onAdd:function(e){var t=L.DomUtil.create("div","leaflet-bar control-slider"),o=(t.id="opacity-slider",L.DomEvent.disableClickPropagation(t),BR.Util.localStorageAvailable()&&null!==(o=localStorage.getItem("opacitySliderValue"))&&(localStorage.setItem("opacitySliderValue"+this.options.id,o),localStorage.removeItem("opacitySliderValue")),new BR.OpacitySlider(this.options)),i=(t.appendChild(o.getElement()),function(e){L.DomEvent.stop(e),n()}),n=function e(){document.removeEventListener("click",i,!0),document.removeEventListener("mousedown",e,!0)};return o.input.on("slideStart",function(e){L.DomUtil.disableTextSelection()}).on("slideStop",{self:this},function(e){L.DomUtil.enableTextSelection(),document.addEventListener("click",i,!0),document.addEventListener("mousedown",n,!0)}),t}});
BR.Profile=L.Evented.extend({cache:{},saveWarningShown:!1,initialize:function(){var e=L.DomUtil.get("profile_upload");this.editor=CodeMirror.fromTextArea(e,{lineNumbers:!0}),$('#profileEditorTabs a[data-toggle="tab"]').on("shown.bs.tab",L.bind(function(e){this._activateSecondaryTab()},this)),L.DomUtil.get("save").onclick=L.bind(this._save,this),L.DomUtil.get("upload").onclick=L.bind(this._upload,this),L.DomUtil.get("clear").onclick=L.bind(this.clear,this),this.pinned=L.DomUtil.get("profile-pinned"),this.message=new BR.Message("profile_message",{alert:!0})},clear:function(e){var t=e.target||e.srcElement;e.preventDefault(),this.editor.markClean(),this._setValue(""),this.fire("clear"),t.blur()},update:function(e,i){var r,a=e.profile,e=!1;a&&BR.conf.profilesUrl&&((this.selectedProfileName=a)in this.cache?this._updateProfile(a,this.cache[a]):(r=BR.conf.profilesUrl+a+".brf",e=!0,BR.Util.get(r,L.bind(function(e,t){e?console.warn('Error getting profile from "'+r+'": '+e):(this.cache[a]=t,this.profileName&&this.selectedProfileName!==a||this._updateProfile(a,t)),i&&i()},this)))),i&&!e&&i()},show:function(){this.editor.refresh()},onResize:function(){this.editor.refresh()},getProfileVar:function(e){var t;if(this._isParamsFormActive()){var i=this._getFormValues();if(i.hasOwnProperty(e))return i[e]}var i=this._getSelectedProfileText();return t=i&&(e=new RegExp("assign\\s*".concat(e,"\\s*=?\\s*([\\w\\.]*)")),i=i.match(e))?i[1]:t},getTransportMode:function(){var e=!!this.getProfileVar("validForCars"),t=!!this.getProfileVar("validForBikes");return e?"car":t?"bike":"foot"},_upload:function(e){var r=e.target||e.srcElement,t=this._getProfileText();this.message.hide(),e.preventDefault(),this.fire("update",{profileText:t,callback:L.bind(function(e,t,i){$(r).blur(),e||(this.profileName=t,this.cache[t]=i,this.saveWarningShown)||(this.message.showWarning(i18next.t("warning.temporary-profile")),this.saveWarningShown=!0)},this)})},_buildCustomProfile:function(t){var i=this._getFormValues();return Object.keys(i).forEach(function(e){var a=i[e],e=new RegExp("(assign\\s*"+e+"\\s*=?\\s*)([\\w.]*)(\\s*#\\s*%(.*)%\\s*(\\|\\s*(.*)\\s*\\|\\s*(.*)\\s*)?[\\r\\n])");t=t.replace(e,function(e,t,i,r){return t+a+r})}),t},_getFormValues:function(){var i={};return document.querySelectorAll("#profile_params input, #profile_params select").forEach(function(e){var t=e.name,e="checkbox"==e.type?e.checked:e.value;i[t]=e}),i},_save:function(e){var t=this._buildCustomProfile(this._getProfileText()),r=this;this.fire("update",{profileText:t,callback:function(e,t,i){e||(r.profileName=t,r.cache[t]=i)}})},_updateProfile:function(e,t){var i=!this.editor.getValue(),r=this.editor.isClean();i||r?(this.profileName=e,this._setValue(t),this.pinned.hidden||(this.pinned.hidden=!0)):this.pinned.hidden&&(this.pinned.hidden=!1)},_setValue:function(e){e=e||"";var t=this.editor.isClean();this.editor.setValue(e),t&&this.editor.markClean(),this._isParamsFormActive()&&this._buildParamsForm(e)},_buildParamsForm:function(e){var l,s,c;e&&(l={},(e=e.split("---context:").filter(function(e){return e.startsWith("global")}))&&0<e.length&&(e=e[0].split("\n").slice(1),s=/assign\s*(\w*)\s*=?\s*([\w\.]*)\s*#\s*%(.*)%\s*(\|\s*(.*)\s*\|\s*(.*)\s*)?$/,e.forEach(function(e){e=e.match(s);if(e){var t=e[1],i=e[2],r=e[5],e=e[6],a={};if(e.match(/\[.*\]/)&&(e.slice(1,-1).split(",").forEach(function(e){var e=e.split("="),t=(e[0]||"").replace(/^\s+|\s+$/g,""),e=(e[1]||"").replace(/^\s+|\s+$/g,"");a[t]=e}),e="select"),"boolean"==(e=e||("true"==i||"false"==i?"boolean":"number")))i="true"==i;else if("number"==e&&(i=Number.parseFloat(i),Number.isNaN(i)))return;l[t]={description:r,type:e,value:i,possible_values:a}}})),(c=L.DomUtil.get("profile_params")).innerHTML="",Object.keys(l).length||c.append(i18next.t("sidebar.profile.no_easy_configuration_warning")),Object.keys(l).forEach(function(i){var e=document.createElement("div"),t=document.createElement("label"),r=l[i].type,a=i18next.exists("profileParameters."+i+".name")?i18next.t("profileParameters."+i+".name"):i;if("select"==r){var s=document.createElement("select"),n=(s.name=a,s.className="form-control form-control-sm",t.htmlFor=s.id="customize-profile-"+a,l[i].possible_values);Object.keys(n).forEach(function(e){var t=document.createElement("option");(t.value=e)==l[i].value&&(t.selected=!0),t.append(n[e]),s.appendChild(t)}),t.append(a),e.appendChild(t),e.appendChild(s)}else{var o=document.createElement("input");if(o.name=a,t.htmlFor=o.id="customize-profile-"+a,"number"==r)o.type="number",o.value=l[i].value,o.className="form-control form-control-sm",t.append(a),e.appendChild(t),e.appendChild(o),e.className="form-group";else{if("boolean"!=r)return;o.type="checkbox",o.checked=l[i].value,e.appendChild(o),t.append(a),e.appendChild(t)}}r=document.createElement("p"),o=i18next.exists("profileParameters."+i+".description")?i18next.t("profileParameters."+i+".description"):l[i].description.replace(/^\s+|\s+$/g,"");r.innerHTML=o,r.className="help-block",e.appendChild(r),c.appendChild(e)}))},_isParamsFormActive:function(){return L.DomUtil.get("profile_params_container").classList.contains("active")},_activateSecondaryTab:function(){var e=this._getProfileText();this._isParamsFormActive()?this._buildParamsForm(e):this._setValue(this._buildCustomProfile(e))},_getProfileText:function(){return this.editor.getValue()},_getSelectedProfileText:function(){var e;return null!=(e=this.cache[this.selectedProfileName])?e:this.editor.getValue()}});
BR.RoutingOptions=L.Evented.extend({options:{shortcut:{switch:71}},initialize:function(){$("#profile-alternative").on("changed.bs.select",this._getChangeHandler());for(var e=this.getRememberedProfile(),t=!1,i=BR.conf.profiles,o=L.DomUtil.get("profile"),l=0;l<i.length;l++){var r=document.createElement("option");r.value=i[l],r.text=i18next.t("navbar.profile."+i[l]),location.hash||null===e||e!==i[l]||(t=r.selected=!0),o.appendChild(r)}o.children[0].value="Custom",t||(o.children[1].selected=!0),L.DomEvent.addListener(document,"keydown",this._keydownListener,this)},refreshUI:function(){$("#profile-alternative").find("option:disabled").each(function(e){$(this).prop("disabled",!1)}),$("#profile-alternative").find("option:selected").each(function(e){$(this).prop("disabled",!0)});var e=L.DomUtil.get("profile").children[0],e=("Custom"===e.value&&(e.disabled=!0),$(".selectpicker").selectpicker("refresh"),$("#profile-alternative-form button")[0]);e.title=e.title+i18next.t("navbar.profile-tooltip",{key:"G"})},getOptions:function(){var e=$("#profile option:selected"),t=$("#alternative option:selected");return this.refreshUI(),{profile:e.val(),alternative:t.val()}},setOptions:function(e){var t=[e.profile||$("#profile option:selected").val(),e.alternative||$("#alternative option:selected").val()];$(".selectpicker").selectpicker("val",t),this.refreshUI(),e.profile&&L.BRouter.isCustomProfile(e.profile)&&this.setCustomProfile(e.profile,!0)},setCustomProfile:function(e,t){var i=L.DomUtil.get("profile"),o=i.children[0];o.value=e||"Custom",o.disabled=!e,e?$("#profile").find("option:selected").each(function(e){$(this).prop("selected",!1)}):o.selected&&(i.children[1].selected=!0),o.selected=!!e,t||this.fire("update",{options:this.getOptions()})},getCustomProfile:function(){var e=L.DomUtil.get("profile").children[0],t=null;return t="Custom"!==e.value?e.value:t},rememberProfile:function(e){!BR.Util.localStorageAvailable()||L.BRouter.isCustomProfile(e)||localStorage.setItem("routingprofile",e)},getRememberedProfile:function(){return BR.Util.localStorageAvailable()?localStorage.getItem("routingprofile"):null},_getChangeHandler:function(){return L.bind(function(e){this.rememberProfile(e.target.options[e.target.options.selectedIndex].value),this.fire("update",{options:this.getOptions()})},this)},_keydownListener:function(e){!BR.Util.keyboardShortcutsAllowed(e)||e.keyCode!==this.options.shortcut.switch||$("#profile-alternative-form .dropdown").hasClass("show")||$("#profile-alternative-form button").click()}});
BR.ShareRoute=L.Class.extend({options:{services:{mastodon:!0},shortcut:{share_action:65}},initialize:function(){L.DomUtil.get("shareButton").onclick=L.bind(this.share,this),L.DomEvent.addListener(document,"keydown",this._keydownListener,this)},share:function(e){e.preventDefault(),this.services(),this.qrcode()},services:function(){var t,o=this;$(".share-copy-link").on("click",function(){navigator.clipboard.writeText(o.getShareUrl())}),$("a.share-service").each(function(){$(this).attr("href",$(this).attr("href").replace("{url}",encodeURIComponent(o.getShareUrl())))}),!0===this.options.services.mastodon&&(BR.Util.localStorageAvailable()&&(t=localStorage.getItem("share/mastodonInstance")),$(".share-service-mastodon").removeAttr("hidden").on("click",function(){var e=window.prompt(i18next.t("share.mastodon-enter-server-name"),null!=(e=t)?e:"mastodon.social");if(0!==e.indexOf("http")&&(e="https://"+e),BR.Util.localStorageAvailable())try{localStorage.setItem("share/mastodonInstance",new URL(e).hostname)}catch(e){console.error("Cannot store Mastodon instance",e)}window.open(e+"/share?text="+encodeURIComponent(o.getShareUrl()),"_blank")}))},qrcode:function(){var e=this.createQrCodeUrl();this.renderQrCode("share-qrcode-img",e,this.getQrCodeSizeForUrl(e)),$(".qrcode-size-button").on("click",{shareRoute:this,url:e},function(e){e.data.shareRoute.renderQrCode("share-qrcode-img",e.data.url,$(this).data("qrcodeSize"))})},getQrCodeSizeForUrl:function(e){return e.length<500?256:e.length<1700?384:512},renderQrCode:function(e,t,o){$("#share-qrcode-img").empty(),$("#qrcode-buttons").show(),$("#qrcode-msg-unknown-error").hide(),$("#qrcode-msg-too-long").hide();try{new QRCode(document.getElementById(e),{text:t,width:o,height:o,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.M})}catch(e){$("#share-qrcode-img").empty(),$("#qrcode-buttons").hide(),"Too long data"===e.message?$("#qrcode-msg-too-long").show():(console.error("Cannot create QR Code",e),$("#qrcode-msg-unknown-error").show())}},createQrCodeUrl:function(){var e=new URL(document.location.href),t=new URLSearchParams(e.search);return t.set("export","dialog"),e.search=t.toString(),e.toString()},getShareUrl:function(){var e=new URL(document.location.href),t=new URLSearchParams(e.search);return t.delete("export"),e.search=t.toString(),e.toString()},_keydownListener:function(e){BR.Util.keyboardShortcutsAllowed(e)&&e.keyCode===this.options.shortcut.share_action&&!$("#shareButton").hasClass("disabled")&&($("#share-dialog").modal("show"),this.share(e))}});
BR.TrackAnalysis=L.Class.extend({options:{overlayStyle:{color:"yellow",opacity:.8,weight:8,pane:"routingQualityPane"}},totalRouteDistance:0,initialize:function(e,t){this.map=e,L.setOptions(this,t)},trackEdges:null,trackPolyline:null,active:!1,show:function(){this.active=!0,this.options.requestUpdate(this)},hide:function(){this.active=!1},update:function(e,t){this.active&&(0===t.length?($("#track_statistics").html(""),this.highlightedSegments&&(this.map.removeLayer(this.highlightedSegments),this.highlightedSegments=null),this.highlightedSegment&&(this.map.removeLayer(this.highlightedSegment),this.highlightedSegment=null)):(this.trackPolyline=e,this.trackEdges=new BR.TrackEdges(t),e=this.calcStats(e,t),this.render(e),$(".track-analysis-table tr").hover(L.bind(this.handleHover,this),L.bind(this.handleHoverOut,this)),$(".track-analysis-table tbody").on("click","tr",L.bind(this.toggleSelected,this))))},calcStats:function(e,t){for(var a={highway:{},maxspeed:{},surface:{},smoothness:{}},s=this.totalRouteDistance=0;t&&s<t.length;s++)for(var n=1;n<t[s].feature.properties.messages.length;n++){this.totalRouteDistance+=parseFloat(t[s].feature.properties.messages[n][3]);for(var i=t[s].feature.properties.messages[n][9].split(" "),i=this.normalizeWayTags(i,"cycling"),r=0;r<i.length;r++){var c=i[r].split("="),o=c[0];switch(o){case"highway":var h=c[1],d="";"track"===h&&(h="Track "+(d=this.getTrackType(i))),void 0===a.highway[h]&&(a.highway[h]={formatted_name:i18next.t("sidebar.analysis.data.highway."+h,h),name:c[1],subtype:d,distance:0}),a.highway[h].distance+=parseFloat(t[s].feature.properties.messages[n][3]);break;case"maxspeed":case"surface":case"smoothness":void 0===a[o][c[1]]&&(d=void 0,d=0===o.indexOf("maxspeed")?i18next.t("sidebar.analysis.data.maxspeed",{maxspeed:c[1]}):i18next.t(["sidebar.analysis.data."+o+"."+c[1],c[1]]),a[o][c[1]]={formatted_name:d,name:c[1],subtype:"",distance:0}),a[o][c[1]].distance+=parseFloat(t[s].feature.properties.messages[n][3])}}}return this.sortAnalysisData(a)},normalizeWayTags:function(e,t){for(var a={},s={},n={},i=0;i<e.length;i++){var r=e[i].split("="),c=r[0],r=r[1];"surface"===c?s.default=r:-1!==c.indexOf(":surface")?s[c.split(":")[0]]=r:"smoothness"===c?n.default=r:-1!==c.indexOf(":smoothness")?n[c.split(":")[0]]=r:"maxspeed:forward"===c&&!e.includes("reversedirection=yes")||"maxspeed:backward"===c&&e.includes("reversedirection=yes")?a.maxspeed=r:a[c]=r}return"cycling"===t?("string"==typeof s.cycleway?a.surface=s.cycleway:"string"==typeof s.default&&(a.surface=s.default),"string"==typeof n.cycleway?a.smoothness=n.cycleway:"string"==typeof n.default&&(a.smoothness=n.default)):("string"==typeof s.default&&(a.surface=s.default),"string"==typeof n.default&&(a.smoothness=n.default)),this.wayTagsToArray(a)},sortAnalysisData:function(e){var t,a={},s={};for(t in e)if(e.hasOwnProperty(t)){for(var n in s[t]={},a[t]=[],e[t])e[t].hasOwnProperty(n)&&a[t].push(e[t][n]);"maxspeed"===t?a[t].sort(function(e,t){return parseInt(e.name)-parseInt(t.name)}):a[t].sort(function(e,t){return t.distance-e.distance});for(var i=0;i<a[t].length;i++)s[t][a[t][i].formatted_name]=a[t][i]}return s},getTrackType:function(e){for(var t=0;t<e.length;t++){var a=e[t].split("=");if("tracktype"===a[0])return a[1]}return"unknown"},render:function(e){var t=$("#track_statistics");t.html(""),t.append($('<h4 class="track-analysis-heading">'.concat(i18next.t("sidebar.analysis.header.highway"),"</h4>"))),t.append(this.renderTable("highway",e.highway)),t.append($('<h4 class="track-analysis-heading">'.concat(i18next.t("sidebar.analysis.header.surface"),"</h4>"))),t.append(this.renderTable("surface",e.surface)),t.append($('<h4 class="track-analysis-heading">'.concat(i18next.t("sidebar.analysis.header.smoothness"),"</h4>"))),t.append(this.renderTable("smoothness",e.smoothness)),t.append($('<h4 class="track-analysis-heading">'.concat(i18next.t("sidebar.analysis.header.maxspeed"),"</h4>"))),t.append(this.renderTable("maxspeed",e.maxspeed))},renderTable:function(e,t){var a,s,e=$('<table data-type="'.concat(e,'" class="mini stripe dataTable track-analysis-table"></table>')),n=$("<thead></thead>"),i=(n.append($("<tr>").append('<th class="track-analysis-header-category">'.concat(i18next.t("sidebar.analysis.table.category"),"</th>")).append($('<th class="track-analysis-header-distance">'.concat(i18next.t("sidebar.analysis.table.length"),"</th>")))),e.append(n),$("<tbody></tbody>")),r=0;for(a in t)t.hasOwnProperty(a)&&((s=$('<tr data-name="'.concat(t[a].name,'"                 data-subtype="').concat(t[a].subtype,'"                 data-distance="').concat(t[a].distance,'"></tr>'))).append('<td class="track-analysis-title">'.concat(t[a].formatted_name,"</td>")),s.append('<td class="track-analysis-distance">'.concat(this.formatDistance(t[a].distance)," km</td>")),i.append(s),r+=t[a].distance);return r<this.totalRouteDistance&&i.append($('<tr data-name="internal-unknown" data-distance="'.concat(this.totalRouteDistance-r,'"></tr>')).append($('<td class="track-analysis-title">'.concat(i18next.t("sidebar.analysis.table.unknown"),"</td>"))).append($('<td class="track-analysis-distance">'.concat(this.formatDistance(this.totalRouteDistance-r)," km</td>")))),e.append(i),e.append($("<tfoot></tfoot>").append("<tr></tr>").append($("<td>".concat(i18next.t("sidebar.analysis.table.total_known"),"</td>"))).append($('<td class="track-analysis-distance track-analysis-distance-total">'.concat(this.formatDistance(r)," km</td>")))),e},formatDistance:function(e){return(e/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})},handleHover:function(e){var e=$(e.currentTarget),t=e.parents("table").first().data("type"),a=e.data("name"),e=e.data("subtype"),t=this.getPolylinesForDataType(t,a,e);this.highlightedSegments=L.layerGroup(t).addTo(this.map)},handleHoverOut:function(){this.map.removeLayer(this.highlightedSegments)},toggleSelected:function(e){var e=e.currentTarget,t=$(e).parents("table").first().data("type"),a=$(e).data("name"),s=$(e).data("subtype");e.classList.toggle("selected")?(this.highlightedSegment&&(this.map.removeLayer(this.highlightedSegment),this.selectedTableRow.classList.remove("selected")),this.highlightedSegment=L.layerGroup(this.getPolylinesForDataType(t,a,s)).addTo(this.map),this.selectedTableRow=e):(this.map.removeLayer(this.highlightedSegment),this.selectedTableRow=null,this.highlightedSegment=null)},getPolylinesForDataType:function(e,t,a){for(var s,n,i=[],r=this.trackPolyline.getLatLngs(),c=0;c<this.trackEdges.edges.length;c++)this.wayTagsMatchesData(r[this.trackEdges.edges[c]],e,t,a)&&(s=0<c?this.trackEdges.edges[c-1]:0,n=this.trackEdges.edges[c]+1,i.push(L.polyline(r.slice(s,n),this.options.overlayStyle)));return i},wayTagsMatchesData:function(e,t,a,s){var n=this.wayTagsToObject(e);switch(t){case"highway":return"track"===a?"unknown"===s&&"track"===n.highway&&!n.tracktype||"string"==typeof n.tracktype&&n.tracktype===s:"internal-unknown"===a&&"string"!=typeof n.highway||"string"==typeof n.highway&&n.highway===a;case"surface":return this.singleWayTagMatchesData("surface",n,a);case"smoothness":return this.singleWayTagMatchesData("smoothness",n,a);case"maxspeed":return this.singleWayTagMatchesData("maxspeed",n,a)}return!1},singleWayTagMatchesData:function(e,t,a){"number"==typeof a&&(a=a.toString());var s=null;return"maxspeed"===e&&t.hasOwnProperty("maxspeed:forward")&&!t.hasOwnProperty("reversedirection")&&(s=t["maxspeed:forward"]),null===(s="maxspeed"===e&&t.hasOwnProperty("maxspeed:backward")&&t.hasOwnProperty("reversedirection")&&"yes"===t.reversedirection?t["maxspeed:backward"]:s)&&t.hasOwnProperty(e)&&(s=t[e]),"internal-unknown"===a&&null===s||s===a},wayTagsToObject:function(e){for(var t={},a=e.feature.wayTags.split(" "),s=0;s<a.length;s++){var n=a[s].split("=");t[n[0]]=n[1]}return t},wayTagsToArray:function(e){var t,a=[];for(t in e)a.push(t+"="+e[t]);return a}});
function _createForOfIteratorHelper(e,t){var s,o,a,n,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return o=!(s=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),n=0,{s:t=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var s;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(s="Object"===(s=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:s)||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,o=new Array(t);s<t;s++)o[s]=e[s];return o}BR.TrackMessages=L.Class.extend({options:{edgeStyle:{color:"yellow",opacity:.8,weight:8,pane:"routingQualityPane"},syncMap:!0},active:!1,columnOptions:{Longitude:{visible:!1},Latitude:{visible:!1},Elevation:{title:"elev.",className:"dt-body-right"},Distance:{title:"dist.",className:"dt-body-right"},CostPerKm:{title:"$/km",className:"dt-body-right"},ElevCost:{title:"elev$",className:"dt-body-right"},TurnCost:{title:"turn$",className:"dt-body-right"},NodeCost:{title:"node$",className:"dt-body-right"},InitialCost:{title:"initial$",className:"dt-body-right"}},trackEdges:null,trackPolyline:null,segments:null,initialize:function(e,t){L.setOptions(this,t),this._map=e;t=document.getElementById("datatable"),this.tableClassName=t.className,this.tableParent=t.parentElement,e=document.getElementById("data-sync-map");L.DomEvent.on(e,"click",this._toggleSyncMap,this),this._mapMouseMoveHandlerBound=this.mapMouseMoveHandler.bind(this),this._mapMouseOutHandlerBound=this.mapMouseOutHandler.bind(this)},update:function(e,t,s){var o,a,n=[];if(this.active){for(this.trackPolyline=e,this.trackEdges=new BR.TrackEdges(t),this.segments=t,o=0;t&&o<t.length;o++)(a=t[o].feature.properties.messages)&&(n=n.concat(a.slice(1)));this._destroyTable(),this._destroyEdges(),0===n.length?this.listenMapEvents(s,!1):(e=a[0],e=this._getColumns(e,n),this._table=$("#datatable").DataTable({destroy:!0,data:n,columns:e,paging:!1,searching:!1,info:!1,scrollY:50,scrollX:!0,order:[]}),$("#datatable tbody tr").hover(L.bind(this._handleHover,this),L.bind(this._handleHoverOut,this)),$("#datatable tbody").on("click","tr",L.bind(this._toggleSelected,this)),this.listenMapEvents(s,!0))}else this.listenMapEvents(s,!1)},listenMapEvents:function(e,t){e&&(t?(e.on("mousemove",this._mapMouseMoveHandlerBound),e.on("mouseout",this._mapMouseOutHandlerBound)):(e.off("mousemove",this._mapMouseMoveHandlerBound),e.off("mouseout",this._mapMouseOutHandlerBound)))},show:function(){this.active=!0,this.options.requestUpdate(this)},hide:function(){this.active=!1},_destroyTable:function(){var e;return $.fn.DataTable.isDataTable("#datatable")&&($("#datatable").DataTable().destroy(!0),(e=document.createElement("table")).id="datatable",e.className=this.tableClassName,this.tableParent.appendChild(e)),e||document.getElementById("datatable")},_destroyEdges:function(){this._selectedEdge&&(this._map.removeLayer(this._selectedEdge),this._selectedEdge=null),this._hoveredEdge&&(this._map.removeLayer(this._hoveredEdge),this._hoveredEdge=null)},_getColumns:function(e,t){var s,o=[],a=this._getEmptyColumns(t);for(k=0;k<e.length;k++)s={title:e[k],visible:!a[k]},s=L.extend(s,this.columnOptions[e[k]]),o.push(s);return o},_getEmptyColumns:function(e){for(var s=new Array(e[0].length),t=0;t<s.length;t++)s[t]=!0;return e.forEach(function(e){e.forEach(function(e,t){s[t]=s[t]&&!e})}),s},_getRowEdge:function(e){var e=this._table.row($(e)),t=this.trackPolyline.getLatLngs(),s=0<e.index()?this.trackEdges.edges[e.index()-1]:0,e=this.trackEdges.edges[e.index()],t=t.slice(s,e+1);return L.polyline(t,this.options.edgeStyle)},_handleHover:function(e){e=e.currentTarget;this._hoveredEdge=this._getRowEdge(e).addTo(this._map),this.options.syncMap&&!this._selectedEdge&&this._map.panTo(this._hoveredEdge.getCenter())},_handleHoverOut:function(e){this._map.removeLayer(this._hoveredEdge),this._hoveredEdge=null},_toggleSelected:function(e){e=e.currentTarget;e.classList.toggle("selected")?(this._selectedEdge&&(this._map.removeLayer(this._selectedEdge),this._selectedRow.classList.remove("selected")),this._selectedEdge=this._getRowEdge(e).addTo(this._map),this._selectedRow=e,this._map.panTo(this._selectedEdge.getCenter())):(this._map.removeLayer(this._selectedEdge),this._selectedEdge=null,this._selectedRow=null)},_toggleSyncMap:function(e){e.currentTarget.classList.toggle("active"),this.options.syncMap=!this.options.syncMap},mapMouseMoveHandler:function(e){var t,s=null,o=2*Math.pow(100,2),a=turf.point([e.latlng.lng,e.latlng.lat]),n=0,i=_createForOfIteratorHelper(this.segments);try{for(i.s();!(t=i.n()).done;){var r=t.value,l=turf.nearestPointOnLine(r.feature,a);l.properties.dist<o&&(s=n+l.properties.index,o=l.properties.dist),n+=r.feature.geometry.coordinates.length}}catch(e){i.e(e)}finally{i.f()}if(null!==s){for(var d=-1,h=0;h<this.trackEdges.edges.length;h++)if(s<this.trackEdges.edges[h]){d=h;break}-1!=d&&(e=this._table.row(d))&&e!=this._mapHoveredRow&&(this._mapHoveredRow&&this._mapHoveredRow.classList.remove("hoverRoute"),this._mapHoveredRow=e.node(),this._mapHoveredRow.classList.add("hoverRoute"),this._mapHoveredRow.scrollIntoView(!1))}else this._mapHoveredRow&&this._mapHoveredRow.classList.remove("hoverRoute")},mapMouseOutHandler:function(){this._mapHoveredRow&&this._mapHoveredRow.classList.remove("hoverRoute")}});
BR.TrackStats=L.Class.extend({update:function(t,e){var a,n,i,l,o,c,r,s;0==e.length?($("#stats-container").hide(),$("#stats-info").show()):($("#stats-container").show(),$("#stats-info").hide(),document.getElementById("beeline-warning").hidden=!BR.Routing.hasBeeline(e),t=this.calcStats(t,e),e=L.Util.formatNum(t.trackLength/1e3,1).toLocaleString(),a=L.Util.formatNum(t.trackLength/1e3,3).toLocaleString(void 0,{minimumFractionDigits:3}),n=t.filteredAscend.toLocaleString(),i=t.plainAscend.toLocaleString(),l=t.cost.toLocaleString(),o=t.trackLength?L.Util.formatNum(t.cost/t.trackLength,2).toLocaleString():"0",r=(c=Math.trunc(t.totalTime/3600)+":"+("0"+Math.trunc(t.totalTime%3600/60)).slice(-2))+":"+("0"+Math.trunc(t.totalTime%60)).slice(-2),s=L.Util.formatNum(t.totalEnergy/36e5,2).toLocaleString(),t=t.trackLength?L.Util.formatNum(t.totalEnergy/36/t.trackLength,2).toLocaleString():"0",$("#distance").html(e),$("#distance").attr("title",a+" km"),$("#ascend").html(n),$("#plainascend").html(i),$("#cost").html(l),$("#meancostfactor").html(o),$("#totaltime").html(c),$("#totaltime").attr("title",r+" h"),$("#totalenergy").html(s),$("#meanenergy").html(t))},calcStats:function(t,e){for(var a,n={trackLength:0,filteredAscend:0,plainAscend:0,totalTime:0,totalEnergy:0,cost:0},i=0;e&&i<e.length;i++)a=e[i].feature.properties,n.trackLength+=+a["track-length"],n.filteredAscend+=+a["filtered ascend"],n.plainAscend+=+a["plain-ascend"],n.totalTime+=+a["total-time"],n.totalEnergy+=+a["total-energy"],n.cost+=+a.cost;return n}});
!function(){var n;function o(t){function e(e){var t=o.toggleBeelineDrawing();e.state(t?"deactivate-beeline":"activate-beeline")}var a,n,o,i,r,s,l,c,u,d,g,p,m,f,y,h,b,k=t.map,w=t.layersControl,B=($(".selectpicker").selectpicker({iconBase:"fa",tickIcon:"fa-check",windowPadding:[0,0,40,0]}),a=new BR.Search,k.addControl(a),$("#map .leaflet-control-geocoder > button")[0].title=i18next.t("keyboard.generic-shortcut",{action:"$t(map.geocoder)",key:"F"}),n=L.bRouter(),m=L.easyButton({states:[{stateName:"editing-disabled",icon:"fa-lock active",onClick:function(e){L.DomUtil.removeClass(t.map.getContainer(),"disable-editing"),e.state("editing-enabled")},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.enable-editing)",key:"V"})},{stateName:"editing-enabled",icon:"fa-lock",onClick:function(e){L.DomUtil.addClass(t.map.getContainer(),"disable-editing"),o.draw(!1),e.state("editing-disabled")},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.disable-editing)",key:"V"})}]}),L.DomUtil.addClass(t.map.getContainer(),"disable-editing"),f=L.easyButton({states:[{stateName:"activate-draw",icon:"fa-pencil",onClick:function(e){o.draw(!0),e.state("deactivate-draw")},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.draw-route-start)",key:"D"})},{stateName:"deactivate-draw",icon:"fa-pencil active",onClick:function(e){o.draw(!1),e.state("activate-draw")},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.draw-route-stop)",key:"$t(keyboard.escape)"})}]}),'\n            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"\n                id="mdi-vector-line" width="24" height="24" viewBox="0 0 24 24" class="mdi active">\n                <path d="M15,3V7.59L7.59,15H3V21H9V16.42L16.42,9H21V3M17,5H19V7H17M5,17H7V19H5" />\n            </svg>'),v=i18next.t("keyboard.generic-shortcut",{action:"$t(map.toggle-beeline)",key:"B"}),R=L.easyButton({states:[{stateName:"activate-beeline",icon:B.replace(" active",""),onClick:e,title:v},{stateName:"deactivate-beeline",icon:B,onClick:e,title:v}]}),B=(k.on("routing:beeline-start",function(){return R.state("deactivate-beeline")}),k.on("routing:beeline-end",function(){return R.state("activate-beeline")}),L.easyButton("fa-random",function(){o.reverse()},i18next.t("keyboard.generic-shortcut",{action:"$t(map.reverse-route)",key:"R"}))),v=L.easyButton('<span><i class="fa fa-caret-left"></i><i class="fa fa-map-marker" style="margin-left: 1px; color: gray;"></i></span>',function(){o.deleteLastPoint()},i18next.t("keyboard.generic-shortcut",{action:"$t(map.delete-last-point)",key:"Z"}));function x(){bootbox.prompt({size:"small",title:i18next.t("map.clear-route"),inputType:"checkbox",inputOptions:[{text:i18next.t("map.delete-route"),value:"route"},{text:i18next.t("map.delete-nogo-areas"),value:"nogo"},{text:i18next.t("map.delete-pois"),value:"pois"}],value:["route"],onShown:function(){$("button.bootbox-accept",$(this)).focus()},callback:function(e){null!==e&&(-1!==e.indexOf("route")&&o.clear(),-1!==e.indexOf("nogo")&&r.clear(),-1!==e.indexOf("pois")&&h.clear(),S(),T.onMapMove())}})}function C(e){n.setOptions(e.options),n.queue.idle()||n.queue.remove(function(e){return e.callback(L.BRouter.ABORTED_ERROR),!0}),o.rerouteAllSegments(S)}function M(e){var t=o.toPolyline(),a=o.getSegments(),n=o._segments;e.update(t,a,n)}y=L.easyButton("fa-trash-o",function(){x()},i18next.t("keyboard.generic-shortcut",{action:"$t(map.clear-route)",key:"$t(keyboard.backspace)"})),L.DomEvent.addListener(document,"keydown",function(e){BR.Util.keyboardShortcutsAllowed(e)&&!$(".modal.show").length&&(8===e.keyCode?x():72===e.keyCode?$("#about").modal("show"):"?"===e.key&&$("#help").modal("show"))},this),(i=new BR.RoutingOptions).on("update",function(e){T.movingMap||d.update(e.options,function(){C(e)})}),BR.NogoAreas.MSG_BUTTON=i18next.t("keyboard.generic-shortcut",{action:"$t(map.nogo.draw)",key:"N"}),BR.NogoAreas.MSG_BUTTON_CANCEL=i18next.t("keyboard.generic-shortcut",{action:"$t(map.nogo.cancel)",key:"$t(keyboard.escape)"}),BR.NogoAreas.MSG_CREATE=i18next.t("map.nogo.click-drag"),BR.NogoAreas.MSG_DISABLED=i18next.t("map.nogo.edit"),BR.NogoAreas.MSG_ENABLED=i18next.t("map.nogo.help"),(r=new BR.NogoAreas).on("update",C),BR.conf.transit?l=new BR.Itinerary:s=new BR.TrackStats,c=new BR.Heightgraph,(d=new BR.Profile).on("update",function(a){BR.message.hide();var e=i.getCustomProfile();n.uploadProfile(e,a.profileText,function(e,t){e?(d.message.showError(e),t&&(i.setCustomProfile(t,!0),n.setOptions(i.getOptions()))):(i.setCustomProfile(t,!0),C({options:i.getOptions()})),a.callback&&a.callback(e,t,a.profileText)})}),d.on("clear",function(e){d.message.hide(),i.setCustomProfile(null)}),g=new BR.TrackMessages(k,{requestUpdate:M}),p=new BR.TrackAnalysis(k,{requestUpdate:M}),routingPathQuality=new BR.RoutingPathQuality(k,w),o=new BR.Routing(d,{routing:{router:L.bind(n.getRouteSegment,n)},styles:BR.conf.routingStyles}),h=new BR.PoiMarkers(o),u=new BR.Export(n,h,d),new BR.ShareRoute,o.on("routing:routeWaypointEnd routing:setWaypointsEnd routing:rerouteSegmentEnd",function(e){a.clear(),S(e&&e.err)});var O=new URLSearchParams(window.location.search);function S(e){var t,a,n;e?e!==L.BRouter.ABORTED_ERROR&&BR.message.showError(e):(BR.message.hide(),e=o.toPolyline(),t=o.getSegments(),a=o.getWaypoints(),n=o._segments,c.update(e,n),routingPathQuality.update(e,n),(BR.conf.transit?l:s).update(e,t),g.update(e,t,n),p.update(e,t),u.update(a,t))}O.has("export")&&"dialog"===O.get("export")&&new URLSearchParams(window.location.hash).has("lonlats")&&o.once("routing:setWaypointsEnd",function(e){!e.err&&1<o.getWaypoints().length&&$("#exportButton").trigger("click")}),k.on("routing:draw-start",function(){f.state("deactivate-draw"),R.enable()}),k.on("routing:draw-end",function(){f.state("activate-draw"),R.disable()}),o.addTo(k),c.addBelow(k),O=BR.sidebar({defaultTabId:BR.conf.transit?"tab_itinerary":"tab_profile",listeningTabs:{tab_profile:d,tab_data:g,tab_analysis:p}}).addTo(k),BR.conf.transit&&O.showPanel("tab_itinerary"),r.addTo(k),null!=b&&(h.circlego=b).addTo(k),m.addTo(k);var T,O=[f,R,B,r.getButton()];b&&O.push(b.getButton()),O.push(v,y),L.easyBar(O,{id:"editing-buttons"}).addTo(k),r.preventRoutePointOnCreate(o),BR.keys.strava&&BR.stravaSegments(k,w),BR.tracksLoader(k,w,o,h),BR.routeLoader(k,w,o,h),h.addTo(k),routingPathQuality.addTo(k),k.addControl(new BR.OpacitySliderControl({id:"route",title:i18next.t("map.opacity-slider-shortcut",{action:"$t(map.opacity-slider)",key:"M"}),muteKeyCode:77,callback:L.bind(o.setOpacity,o)})),n.setOptions(r.getOptions()),n.setOptions(i.getOptions()),location.hash||(d.update(i.getOptions()),w.activateLayer(w.getLayerFromString("route-quality")),w.loadActiveLayers());(T=new L.Hash(null,null)).additionalCb=function(){var e=n.getUrl(o.getWaypoints(),o.getBeelineFlags(),h.getMarkers(),b?b.getCircle():null,null).substr("brouter?".length+1);return 0<(e=e.replace(/\|/g,";")).length?"&"+e:null},T.onHashChangeCb=function(e){var t=n.parseUrlParams(function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t={},a="&",n=(-1!==(e=e.replace(/;/g,"|")).search("&amp;")&&(a="&amp;"),e.split(a)),o=0;o<n.length;o++){var i=n[o].split("=");2===i.length&&(t[i[0]]=decodeURIComponent(i[1]))}return t}(e)),e=(n.setOptions(t),i.setOptions(t),r.setOptions(t),Object.assign({},i.getOptions(),t));d.update(e,function(){t.lonlats&&(o.draw(!1),o.clear(),o.setWaypoints(t.lonlats,t.beelineFlags))}),t.pois&&h.setMarkers(t.pois),b&&t.circlego&&b.setOptions(t)},T.onInvalidHashChangeCb=function(e){return e=(e=(e=(e=e.replace("zoom=","map=")).replace("&lat=","/")).replace("&lon=","/")).replace("&layer=","/")},T.init(k,{layersControl:w}),setTimeout(function(){w.activateDefaultBaseLayer()},T.changeDefer),i.on("update",T.onMapMove,T),r.on("update",T.onMapMove,T),h.on("update",T.onMapMove,T),o.on("routing:routeWaypointEnd",T.onMapMove,T),o.on("waypoint:click",function(e){e=e.marker._routing;e.prevMarker||e.nextMarker||T.onMapMove()},T),BR.WhatsNew.init(),$(".modal").on("shown.bs.modal",function(e){$("input:visible:enabled:first",e.target).focus()})}i18next.on("languageChanged",function(e){for(i=0;i<i18next.languages.length;i++){var t=i18next.languages[i];if(i18next.hasResourceBundle(t,"translation")){var a=document.documentElement;a.getAttribute("lang")!==t&&a.setAttribute("lang",t);break}}}),i18next.use(window.i18nextXHRBackend).use(window.i18nextBrowserLanguageDetector).init({fallbackLng:"en",backend:{loadPath:"dist/locales/{{lng}}.json"}},function(e,t){var a;jqueryI18next.init(i18next,$,{useOptionsAttr:!0}),$("html").localize(),$("#aboutLinks").localize({privacyPolicyUrl:BR.conf.privacyPolicyUrl||"https://brouter.de/privacypolicy.html"}),n=BR.Map.initMap(),a=n,L.Browser.touch&&BR.Browser.touchScreenDetectable&&!BR.Browser.touchScreen&&L.DomUtil.removeClass(a.map.getContainer(),"leaflet-touch"),o(n)})}();
//# sourceMappingURL=brouter-web.js.map
